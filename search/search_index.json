{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"index.html","title":"\u9996\u9875","text":"<p>\u6b22\u8fce\u6765\u5230 Lifu Blog \u7684 MkDocs \u91cd\u6784\u7248\u672c\u3002</p> <p>\u8bf4\u660e\uff1a - \u6240\u6709\u6587\u7ae0\u4ecd\u7136\u4fdd\u5b58\u5728 <code>posts/</code> \u76ee\u5f55\u4e0b\uff1b - \u73b0\u5728\u7531 MkDocs \u5728\u6784\u5efa\u9636\u6bb5\u628a Markdown \u8f6c\u6210\u9759\u6001 HTML\uff1b - \u5de6\u4fa7\u5bfc\u822a\u4f1a\u6839\u636e\u76ee\u5f55\u7ed3\u6784\u81ea\u52a8\u751f\u6210\uff0c\u4f60\u53ef\u4ee5\u4ece\u5bfc\u822a\u8fdb\u5165\u4efb\u610f\u6587\u7ae0\u3002</p>"},{"location":"index.html#_2","title":"\u5feb\u901f\u5165\u53e3","text":"<ul> <li>\u535a\u5ba2\u67b6\u6784\u8bf4\u660e</li> <li>CI/CD\uff1a\u672c\u5730-GitHub-\u963f\u91cc\u4e91 ECS \u9759\u6001\u7ad9\u70b9\u65b9\u6848</li> </ul>"},{"location":"index.html#_3","title":"\u4e3b\u8981\u5206\u7c7b","text":""},{"location":"index.html#dba","title":"DBA","text":"<ul> <li>Oracle DBA \u6559\u5b66\uff0801\uff09\u90e8\u7f72\u4e0e\u67b6\u6784\u8bbe\u8ba1</li> <li>Oracle-21c \u4e13\u9898\u7d22\u5f15</li> </ul> <p>\u66f4\u591a DBA \u6587\u7ae0\u8bf7\u901a\u8fc7\u5de6\u4fa7\u5bfc\u822a\u6d4f\u89c8 <code>dba/</code> \u76ee\u5f55\u3002</p>"},{"location":"index.html#biopharma","title":"Biopharma\uff08\u751f\u7269\u5236\u836f / \u5b9e\u9a8c\u5ba4\u4fe1\u606f\u5b66\uff09","text":"<ul> <li>\u5b9e\u9a8c\u5ba4\u4fe1\u606f\u5b66\u67b6\u6784\uff0801\uff09\u603b\u89c8\u4e0e\u8bbe\u8ba1\u539f\u5219</li> </ul>"},{"location":"index.html#csv","title":"CSV\uff08\u8ba1\u7b97\u673a\u5316\u7cfb\u7edf\u9a8c\u8bc1\uff09","text":"<ul> <li>CSV \u8d44\u6599\u7d22\u5f15</li> </ul>"},{"location":"index.html#enterprise-devops-notes","title":"Enterprise / DevOps / Notes","text":"<p>\u8fd9\u4e9b\u5206\u7c7b\u4e0b\u6709\u5927\u91cf\u4f01\u4e1a IT\u3001DevOps\u3001\u5de5\u5177\u4e0e\u811a\u672c\u8bf4\u660e\u7b49\u6587\u7ae0\uff0c\u53ef\u4ee5\u4ece\u5de6\u4fa7\u5bfc\u822a\u76f4\u63a5\u8fdb\u5165\uff1a</p> <ul> <li><code>enterprise/</code>\uff1a\u4f01\u4e1a IT \u57fa\u7840\u67b6\u6784\u3001\u8fd0\u7ef4\u65b9\u6848\u3001\u5b89\u5168\u6cbb\u7406\u7b49</li> <li><code>devops/</code>\uff1aK8s\u3001CI/CD\u3001\u76d1\u63a7\u4e0e\u65e5\u5fd7\u7b49</li> <li><code>notes/</code>\uff1a\u5404\u79cd\u6280\u672f\u7b14\u8bb0\u3001\u9879\u76ee\u590d\u73b0\u4e0e\u91cd\u6784\u65b9\u6848</li> </ul> <p>\u5982\u679c\u4f60\u5728\u672c\u5730\u4fee\u6539 <code>posts/</code> \u91cc\u7684 Markdown \u6587\u4ef6\uff0c\u53ea\u9700\u8981\u91cd\u65b0\u8fd0\u884c\uff1a</p> <pre><code>mkdocs build\n</code></pre> <p>\u5c31\u53ef\u4ee5\u5728 <code>site/</code> \u76ee\u5f55\u4e2d\u5f97\u5230\u66f4\u65b0\u540e\u7684\u9759\u6001\u7ad9\u70b9\u3002</p>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html","title":"Werum PAS-X MES \u7cfb\u7edf\u65e5\u5e38\u8fd0\u7ef4\u624b\u518c","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aMES \u7cfb\u7edf\u7ba1\u7406\u5458\u3001IT \u8fd0\u7ef4\u5de5\u7a0b\u5e08\u3001\u5e94\u7528\u652f\u6301\u5de5\u7a0b\u5e08 \u76ee\u6807\uff1a\u638c\u63e1 PAS-X MES \u7cfb\u7edf\u7684\u65e5\u5e38\u8fd0\u7ef4\u64cd\u4f5c\uff0c\u5305\u62ec\u76d1\u63a7\u3001\u5907\u4efd\u3001\u6545\u969c\u5904\u7406\u3001\u6027\u80fd\u4f18\u5316\uff0c\u786e\u4fdd\u7cfb\u7edf\u7a33\u5b9a\u8fd0\u884c\u3002</p>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#1","title":"1. \u65e5\u5e38\u8fd0\u7ef4\u6982\u8ff0","text":""},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#11","title":"1.1 \u8fd0\u7ef4\u804c\u8d23","text":"<pre><code>\u7cfb\u7edf\u7ba1\u7406\u5458\u804c\u8d23\uff1a\n\u25a1 \u76d1\u63a7\u7cfb\u7edf\u8fd0\u884c\u72b6\u6001\n\u25a1 \u6267\u884c\u65e5\u5e38\u5907\u4efd\n\u25a1 \u5904\u7406\u7528\u6237\u8bf7\u6c42\uff08\u8d26\u53f7\u3001\u6743\u9650\uff09\n\u25a1 \u6545\u969c\u6392\u67e5\u4e0e\u5904\u7406\n\u25a1 \u6027\u80fd\u76d1\u63a7\u4e0e\u4f18\u5316\n\u25a1 \u8865\u4e01\u548c\u66f4\u65b0\u7ba1\u7406\n\u25a1 \u5ba1\u8ba1\u65e5\u5fd7\u5ba1\u67e5\n\u25a1 \u6587\u6863\u7ef4\u62a4\n\u25a1 \u53d8\u66f4\u7ba1\u7406\n\u25a1 \u707e\u96be\u6062\u590d\u6f14\u7ec3\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#12","title":"1.2 \u8fd0\u7ef4\u65f6\u95f4\u8868","text":"\u9891\u7387 \u4efb\u52a1 \u65f6\u95f4 \u6bcf\u65e5 \u68c0\u67e5\u7cfb\u7edf\u72b6\u6001\u3001\u5907\u4efd\u9a8c\u8bc1\u3001\u65e5\u5fd7\u5ba1\u67e5 09:00 \u6bcf\u5468 \u6027\u80fd\u62a5\u544a\u3001\u78c1\u76d8\u7a7a\u95f4\u68c0\u67e5\u3001\u8865\u4e01\u68c0\u67e5 \u5468\u4e00 09:00 \u6bcf\u6708 \u5ba1\u8ba1\u65e5\u5fd7\u5ba1\u67e5\u3001\u7528\u6237\u6743\u9650\u5ba1\u67e5\u3001DR \u6d4b\u8bd5 \u6bcf\u6708\u7b2c\u4e00\u4e2a\u5468\u4e00 \u6bcf\u5b63\u5ea6 \u7cfb\u7edf\u5065\u5eb7\u68c0\u67e5\u3001\u5bb9\u91cf\u89c4\u5212\u3001\u57f9\u8bad \u6bcf\u5b63\u5ea6\u7b2c\u4e00\u5468 \u6bcf\u5e74 \u5e74\u5ea6\u5ba1\u8ba1\u3001\u7cfb\u7edf\u5347\u7ea7\u3001\u5408\u89c4\u5ba1\u67e5 \u6bcf\u5e74 Q1"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#2","title":"2. \u7cfb\u7edf\u76d1\u63a7","text":""},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#21-tomcat","title":"2.1 \u76d1\u63a7 Tomcat \u670d\u52a1","text":"<pre><code># \u68c0\u67e5 Tomcat \u670d\u52a1\u72b6\u6001\nGet-Service -Name \"Tomcat9\"\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\n# Status   Name               DisplayName\n# ------   ----               -----------\n# Running  Tomcat9            Apache Tomcat 9.0 Tomcat9\n\n# \u5982\u679c\u670d\u52a1\u505c\u6b62\uff0c\u542f\u52a8\u670d\u52a1\nif ((Get-Service -Name \"Tomcat9\").Status -ne \"Running\") {\n    Start-Service -Name \"Tomcat9\"\n    Write-Host \"Tomcat service started\" -ForegroundColor Green\n}\n\n# \u68c0\u67e5 Tomcat \u8fdb\u7a0b\nGet-Process -Name \"tomcat*\" | Select-Object Name, Id, CPU, WorkingSet\n\n# \u68c0\u67e5 Tomcat \u7aef\u53e3\nTest-NetConnection -ComputerName localhost -Port 8080\nTest-NetConnection -ComputerName localhost -Port 8443\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#22","title":"2.2 \u76d1\u63a7\u6570\u636e\u5e93\u8fde\u63a5","text":"<pre><code>-- \u8fde\u63a5\u5230 Oracle \u6570\u636e\u5e93\nsqlplus pasx_owner/PasxOwner@2025@PASXDB\n\n-- \u68c0\u67e5\u6570\u636e\u5e93\u72b6\u6001\nSELECT status FROM v$instance;\n-- \u8f93\u51fa\uff1aOPEN\n\n-- \u68c0\u67e5\u5f53\u524d\u4f1a\u8bdd\u6570\nSELECT COUNT(*) AS session_count FROM v$session WHERE username = 'PASX_OWNER';\n\n-- \u68c0\u67e5\u6d3b\u52a8\u4f1a\u8bdd\nSELECT sid, serial#, username, status, program, machine\nFROM v$session\nWHERE username = 'PASX_OWNER'\nORDER BY status;\n\n-- \u68c0\u67e5\u9501\u7b49\u5f85\nSELECT s.sid, s.serial#, s.username, s.program, w.event, w.wait_time\nFROM v$session s, v$session_wait w\nWHERE s.sid = w.sid\nAND s.username = 'PASX_OWNER'\nAND w.wait_time &gt; 0;\n\n-- \u68c0\u67e5\u8868\u7a7a\u95f4\u4f7f\u7528\u7387\nSELECT\n    tablespace_name,\n    ROUND(used_space * 8192 / 1024 / 1024 / 1024, 2) AS used_gb,\n    ROUND(tablespace_size * 8192 / 1024 / 1024 / 1024, 2) AS total_gb,\n    ROUND(used_percent, 2) AS used_percent\nFROM dba_tablespace_usage_metrics\nWHERE tablespace_name IN ('PASX_DATA', 'PASX_INDEX');\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#23","title":"2.3 \u76d1\u63a7\u5e94\u7528\u65e5\u5fd7","text":"<pre><code># \u67e5\u770b Tomcat \u65e5\u5fd7\nGet-Content -Path \"C:\\PAS-X\\Tomcat\\logs\\catalina.$(Get-Date -Format 'yyyy-MM-dd').log\" -Tail 50\n\n# \u67e5\u627e\u9519\u8bef\u65e5\u5fd7\nSelect-String -Path \"C:\\PAS-X\\Tomcat\\logs\\catalina.*.log\" -Pattern \"ERROR|SEVERE|Exception\" | Select-Object -Last 20\n\n# \u67e5\u770b PAS-X \u5e94\u7528\u65e5\u5fd7\nGet-Content -Path \"C:\\PAS-X\\Logs\\pasx.log\" -Tail 50 -Wait\n\n# \u67e5\u627e\u7279\u5b9a\u9519\u8bef\nSelect-String -Path \"C:\\PAS-X\\Logs\\pasx.log\" -Pattern \"OutOfMemoryError|SQLException|NullPointerException\"\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#24","title":"2.4 \u76d1\u63a7\u7cfb\u7edf\u8d44\u6e90","text":"<pre><code># CPU \u4f7f\u7528\u7387\nGet-Counter '\\Processor(_Total)\\% Processor Time' -SampleInterval 1 -MaxSamples 5\n\n# \u5185\u5b58\u4f7f\u7528\u7387\n$os = Get-CimInstance Win32_OperatingSystem\n$totalMemory = $os.TotalVisibleMemorySize / 1MB\n$freeMemory = $os.FreePhysicalMemory / 1MB\n$usedMemory = $totalMemory - $freeMemory\n$memoryUsagePercent = [math]::Round(($usedMemory / $totalMemory) * 100, 2)\nWrite-Host \"Memory Usage: $memoryUsagePercent% ($usedMemory GB / $totalMemory GB)\"\n\n# \u78c1\u76d8\u7a7a\u95f4\nGet-PSDrive -PSProvider FileSystem | Where-Object {$_.Used -gt 0} | Select-Object Name, @{Name=\"UsedGB\";Expression={[math]::Round($_.Used/1GB,2)}}, @{Name=\"FreeGB\";Expression={[math]::Round($_.Free/1GB,2)}}, @{Name=\"UsedPercent\";Expression={[math]::Round(($_.Used/($_.Used+$_.Free))*100,2)}}\n\n# \u7f51\u7edc\u8fde\u63a5\nGet-NetTCPConnection -State Established | Where-Object {$_.LocalPort -eq 8080 -or $_.LocalPort -eq 8443} | Measure-Object | Select-Object -ExpandProperty Count\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#25","title":"2.5 \u76d1\u63a7\u811a\u672c\uff08\u81ea\u52a8\u5316\uff09","text":"<pre><code># \u4fdd\u5b58\u4e3a\uff1aC:\\PAS-X\\Scripts\\Monitor-PASX.ps1\n\nparam(\n    [string]$EmailTo = \"it.admin@pharma.com\",\n    [string]$SmtpServer = \"smtp.pharma.local\"\n)\n\n$report = @()\n\n# \u68c0\u67e5 Tomcat \u670d\u52a1\n$tomcatStatus = (Get-Service -Name \"Tomcat9\").Status\nif ($tomcatStatus -ne \"Running\") {\n    $report += \"\u274c Tomcat service is $tomcatStatus\"\n    Start-Service -Name \"Tomcat9\"\n} else {\n    $report += \"\u2705 Tomcat service is running\"\n}\n\n# \u68c0\u67e5\u6570\u636e\u5e93\u8fde\u63a5\ntry {\n    $conn = New-Object System.Data.OracleClient.OracleConnection(\"Data Source=PASXDB;User Id=pasx_owner;Password=PasxOwner@2025;\")\n    $conn.Open()\n    $conn.Close()\n    $report += \"\u2705 Database connection successful\"\n} catch {\n    $report += \"\u274c Database connection failed: $($_.Exception.Message)\"\n}\n\n# \u68c0\u67e5\u78c1\u76d8\u7a7a\u95f4\n$drives = Get-PSDrive -PSProvider FileSystem | Where-Object {$_.Used -gt 0}\nforeach ($drive in $drives) {\n    $usedPercent = [math]::Round(($drive.Used/($drive.Used+$drive.Free))*100, 2)\n    if ($usedPercent -gt 90) {\n        $report += \"\u26a0\ufe0f  Drive $($drive.Name): $usedPercent% used (critical)\"\n    } elseif ($usedPercent -gt 80) {\n        $report += \"\u26a0\ufe0f  Drive $($drive.Name): $usedPercent% used (warning)\"\n    } else {\n        $report += \"\u2705 Drive $($drive.Name): $usedPercent% used\"\n    }\n}\n\n# \u68c0\u67e5\u5185\u5b58\u4f7f\u7528\n$os = Get-CimInstance Win32_OperatingSystem\n$memoryUsagePercent = [math]::Round((($os.TotalVisibleMemorySize - $os.FreePhysicalMemory) / $os.TotalVisibleMemorySize) * 100, 2)\nif ($memoryUsagePercent -gt 90) {\n    $report += \"\u26a0\ufe0f  Memory usage: $memoryUsagePercent% (critical)\"\n} else {\n    $report += \"\u2705 Memory usage: $memoryUsagePercent%\"\n}\n\n# \u53d1\u9001\u62a5\u544a\n$body = $report -join \"`n\"\nSend-MailMessage -From \"pasx-monitor@pharma.com\" -To $EmailTo -Subject \"PAS-X Daily Health Check - $(Get-Date -Format 'yyyy-MM-dd')\" -Body $body -SmtpServer $SmtpServer\n\n# \u8f93\u51fa\u5230\u63a7\u5236\u53f0\nWrite-Host $body\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#3","title":"3. \u5907\u4efd\u7ba1\u7406","text":""},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#31","title":"3.1 \u6570\u636e\u5e93\u5907\u4efd","text":"<pre><code># \u4fdd\u5b58\u4e3a\uff1aC:\\PAS-X\\Scripts\\Backup-Database.ps1\n\nparam(\n    [string]$BackupPath = \"E:\\Backup\\PAS-X\\Database\"\n)\n\n$date = Get-Date -Format \"yyyyMMdd_HHmmss\"\n$backupFile = \"$BackupPath\\PASXDB_$date.dmp\"\n$logFile = \"$BackupPath\\PASXDB_$date.log\"\n\n# \u521b\u5efa\u5907\u4efd\u76ee\u5f55\nif (!(Test-Path $BackupPath)) {\n    New-Item -Path $BackupPath -ItemType Directory\n}\n\n# \u4f7f\u7528 Data Pump \u5bfc\u51fa\n$env:ORACLE_HOME = \"C:\\Oracle\\product\\19.0.0\\dbhome_1\"\n$env:PATH = \"$env:ORACLE_HOME\\bin;$env:PATH\"\n\n$exportCmd = @\"\nexpdp pasx_owner/PasxOwner@2025@PASXDB \\\n  directory=BACKUP_DIR \\\n  dumpfile=$backupFile \\\n  logfile=$logFile \\\n  schemas=pasx_owner \\\n  compression=all \\\n  parallel=4\n\"@\n\nInvoke-Expression $exportCmd\n\n# \u9a8c\u8bc1\u5907\u4efd\nif (Test-Path $backupFile) {\n    $fileSize = (Get-Item $backupFile).Length / 1GB\n    Write-Host \"\u2705 Backup completed: $backupFile ($([math]::Round($fileSize, 2)) GB)\" -ForegroundColor Green\n\n    # \u5220\u9664 7 \u5929\u524d\u7684\u5907\u4efd\n    Get-ChildItem -Path $BackupPath -Filter \"*.dmp\" | Where-Object {$_.LastWriteTime -lt (Get-Date).AddDays(-7)} | Remove-Item -Force\n} else {\n    Write-Host \"\u274c Backup failed\" -ForegroundColor Red\n}\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#32","title":"3.2 \u5e94\u7528\u5907\u4efd","text":"<pre><code># \u4fdd\u5b58\u4e3a\uff1aC:\\PAS-X\\Scripts\\Backup-Application.ps1\n\nparam(\n    [string]$BackupPath = \"E:\\Backup\\PAS-X\\Application\"\n)\n\n$date = Get-Date -Format \"yyyyMMdd_HHmmss\"\n$backupDir = \"$BackupPath\\$date\"\n\n# \u521b\u5efa\u5907\u4efd\u76ee\u5f55\nNew-Item -Path $backupDir -ItemType Directory\n\n# \u505c\u6b62 Tomcat\uff08\u53ef\u9009\uff0c\u70ed\u5907\u4efd\u53ef\u8df3\u8fc7\uff09\n# Stop-Service -Name \"Tomcat9\"\n\n# \u5907\u4efd Tomcat \u914d\u7f6e\nCopy-Item -Path \"C:\\PAS-X\\Tomcat\\conf\" -Destination \"$backupDir\\Tomcat_conf\" -Recurse\n\n# \u5907\u4efd PAS-X \u5e94\u7528\nCopy-Item -Path \"C:\\PAS-X\\Tomcat\\webapps\\pasx\" -Destination \"$backupDir\\pasx_app\" -Recurse\n\n# \u5907\u4efd\u914d\u7f6e\u6587\u4ef6\nCopy-Item -Path \"C:\\PAS-X\\Config\" -Destination \"$backupDir\\Config\" -Recurse\n\n# \u5907\u4efd\u65e5\u5fd7\uff08\u6700\u8fd1 7 \u5929\uff09\n$logs = Get-ChildItem -Path \"C:\\PAS-X\\Logs\" | Where-Object {$_.LastWriteTime -gt (Get-Date).AddDays(-7)}\nCopy-Item -Path $logs -Destination \"$backupDir\\Logs\" -Recurse\n\n# \u542f\u52a8 Tomcat\n# Start-Service -Name \"Tomcat9\"\n\n# \u538b\u7f29\u5907\u4efd\nCompress-Archive -Path $backupDir -DestinationPath \"$backupDir.zip\"\nRemove-Item -Path $backupDir -Recurse -Force\n\nWrite-Host \"\u2705 Application backup completed: $backupDir.zip\" -ForegroundColor Green\n\n# \u5220\u9664 30 \u5929\u524d\u7684\u5907\u4efd\nGet-ChildItem -Path $BackupPath -Filter \"*.zip\" | Where-Object {$_.LastWriteTime -lt (Get-Date).AddDays(-30)} | Remove-Item -Force\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#33","title":"3.3 \u5b9a\u65f6\u5907\u4efd\u4efb\u52a1","text":"<pre><code># \u521b\u5efa\u8ba1\u5212\u4efb\u52a1\uff1a\u6bcf\u5929\u51cc\u6668 2 \u70b9\u5907\u4efd\u6570\u636e\u5e93\n$action = New-ScheduledTaskAction -Execute \"PowerShell.exe\" -Argument \"-File C:\\PAS-X\\Scripts\\Backup-Database.ps1\"\n$trigger = New-ScheduledTaskTrigger -Daily -At 2:00AM\n$principal = New-ScheduledTaskPrincipal -UserId \"PHARMA\\svc_pasx_app\" -LogonType Password\nRegister-ScheduledTask -TaskName \"PAS-X Database Backup\" -Action $action -Trigger $trigger -Principal $principal -Description \"Daily backup of PAS-X database\"\n\n# \u521b\u5efa\u8ba1\u5212\u4efb\u52a1\uff1a\u6bcf\u5468\u65e5\u51cc\u6668 3 \u70b9\u5907\u4efd\u5e94\u7528\n$action = New-ScheduledTaskAction -Execute \"PowerShell.exe\" -Argument \"-File C:\\PAS-X\\Scripts\\Backup-Application.ps1\"\n$trigger = New-ScheduledTaskTrigger -Weekly -DaysOfWeek Sunday -At 3:00AM\nRegister-ScheduledTask -TaskName \"PAS-X Application Backup\" -Action $action -Trigger $trigger -Principal $principal -Description \"Weekly backup of PAS-X application\"\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#4","title":"4. \u7528\u6237\u7ba1\u7406","text":""},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#41","title":"4.1 \u521b\u5efa\u7528\u6237","text":"<pre><code>\u6b65\u9aa4\uff1a\n1. \u767b\u5f55 PAS-X\uff1ahttps://pasx-app01:8443/pasx\n2. \u5bfc\u822a\uff1aAdministration &gt; User Management &gt; Users\n3. \u70b9\u51fb \"New User\"\n4. \u586b\u5199\u7528\u6237\u4fe1\u606f\uff1a\n   - Username: li.si\n   - First Name: \u56db\n   - Last Name: \u674e\n   - Email: li.si@pharma.com\n   - Department: \u751f\u4ea7\u90e8\n   - Initial Password: TempP@ssw0rd!\n   - Force Password Change: Yes\n5. \u5206\u914d\u89d2\u8272\uff1aOperator\n6. \u542f\u7528\u7535\u5b50\u7b7e\u540d\uff1aYes\n7. \u4fdd\u5b58\n\n\u9a8c\u8bc1\uff1a\n- \u4f7f\u7528\u65b0\u8d26\u53f7\u767b\u5f55\n- \u7cfb\u7edf\u63d0\u793a\u4fee\u6539\u5bc6\u7801\n- \u9a8c\u8bc1\u6743\u9650\u662f\u5426\u6b63\u786e\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#42","title":"4.2 \u91cd\u7f6e\u5bc6\u7801","text":"<pre><code>\u6b65\u9aa4\uff1a\n1. \u5bfc\u822a\uff1aAdministration &gt; User Management &gt; Users\n2. \u641c\u7d22\u7528\u6237\uff1ali.si\n3. \u70b9\u51fb\u7528\u6237\u540d\n4. \u70b9\u51fb \"Reset Password\"\n5. \u8bbe\u7f6e\u4e34\u65f6\u5bc6\u7801\uff1aTempP@ssw0rd!\n6. \u52fe\u9009 \"Force Password Change on Next Login\"\n7. \u4fdd\u5b58\n\n\u901a\u77e5\u7528\u6237\uff1a\n- \u53d1\u9001\u90ae\u4ef6\u901a\u77e5\u7528\u6237\u5bc6\u7801\u5df2\u91cd\u7f6e\n- \u63d0\u4f9b\u4e34\u65f6\u5bc6\u7801\n- \u63d0\u9192\u9996\u6b21\u767b\u5f55\u9700\u4fee\u6539\u5bc6\u7801\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#43","title":"4.3 \u7981\u7528/\u542f\u7528\u7528\u6237","text":"<pre><code>\u7981\u7528\u7528\u6237\uff08\u79bb\u804c\uff09\uff1a\n1. \u5bfc\u822a\uff1aAdministration &gt; User Management &gt; Users\n2. \u641c\u7d22\u7528\u6237\n3. \u70b9\u51fb\u7528\u6237\u540d\n4. \u8bbe\u7f6e Status: Inactive\n5. \u4fdd\u5b58\n6. \u8bb0\u5f55\u5230\u53d8\u66f4\u65e5\u5fd7\n\n\u542f\u7528\u7528\u6237\uff08\u8fd4\u5c97\uff09\uff1a\n1. \u641c\u7d22\u7528\u6237\n2. \u8bbe\u7f6e Status: Active\n3. \u4fdd\u5b58\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#44","title":"4.4 \u5ba1\u67e5\u7528\u6237\u6743\u9650","text":"<pre><code>-- \u67e5\u8be2\u6240\u6709\u7528\u6237\u53ca\u5176\u89d2\u8272\nSELECT\n    u.username,\n    u.first_name || ' ' || u.last_name AS full_name,\n    u.email,\n    u.department,\n    r.role_name,\n    u.status,\n    u.last_login_date\nFROM pasx_users u\nLEFT JOIN pasx_user_roles ur ON u.user_id = ur.user_id\nLEFT JOIN pasx_roles r ON ur.role_id = r.role_id\nORDER BY u.username;\n\n-- \u67e5\u8be2\u957f\u671f\u672a\u767b\u5f55\u7684\u7528\u6237\uff0890 \u5929\uff09\nSELECT\n    username,\n    first_name || ' ' || last_name AS full_name,\n    last_login_date,\n    TRUNC(SYSDATE - last_login_date) AS days_since_login\nFROM pasx_users\nWHERE last_login_date &lt; SYSDATE - 90\nAND status = 'ACTIVE'\nORDER BY last_login_date;\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#5","title":"5. \u6545\u969c\u5904\u7406","text":""},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#51-tomcat","title":"5.1 Tomcat \u65e0\u6cd5\u542f\u52a8","text":"<pre><code>\u75c7\u72b6\uff1a\n- Tomcat \u670d\u52a1\u542f\u52a8\u5931\u8d25\n- \u65e5\u5fd7\u663e\u793a\u7aef\u53e3\u5360\u7528\u6216\u5185\u5b58\u4e0d\u8db3\n\n\u6392\u67e5\u6b65\u9aa4\uff1a\n1. \u68c0\u67e5\u7aef\u53e3\u5360\u7528\n   netstat -ano | findstr \"8080\"\n   netstat -ano | findstr \"8443\"\n\n2. \u68c0\u67e5 Java \u8fdb\u7a0b\n   Get-Process -Name \"java\"\n\n3. \u68c0\u67e5\u5185\u5b58\n   Get-Counter '\\Memory\\Available MBytes'\n\n4. \u67e5\u770b Tomcat \u65e5\u5fd7\n   Get-Content C:\\PAS-X\\Tomcat\\logs\\catalina.*.log -Tail 100\n\n\u89e3\u51b3\u65b9\u6848\uff1a\n- \u7aef\u53e3\u5360\u7528\uff1a\u6740\u6b7b\u5360\u7528\u8fdb\u7a0b\u6216\u4fee\u6539 Tomcat \u7aef\u53e3\n- \u5185\u5b58\u4e0d\u8db3\uff1a\u589e\u52a0 JVM \u5185\u5b58\uff08\u7f16\u8f91 setenv.bat\uff09\n- \u914d\u7f6e\u9519\u8bef\uff1a\u68c0\u67e5 server.xml\u3001context.xml\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#52","title":"5.2 \u6570\u636e\u5e93\u8fde\u63a5\u5931\u8d25","text":"<pre><code>\u75c7\u72b6\uff1a\n- \u7528\u6237\u65e0\u6cd5\u767b\u5f55\n- \u65e5\u5fd7\u663e\u793a \"SQLException: Connection refused\"\n\n\u6392\u67e5\u6b65\u9aa4\uff1a\n1. \u68c0\u67e5\u6570\u636e\u5e93\u670d\u52a1\n   Get-Service -Name \"OracleServicePASXDB\"\n\n2. \u68c0\u67e5\u76d1\u542c\u5668\n   lsnrctl status\n\n3. \u6d4b\u8bd5\u8fde\u63a5\n   sqlplus pasx_owner/PasxOwner@2025@PASXDB\n\n4. \u68c0\u67e5\u7f51\u7edc\n   Test-NetConnection -ComputerName PASX-DB01 -Port 1521\n\n\u89e3\u51b3\u65b9\u6848\uff1a\n- \u6570\u636e\u5e93\u670d\u52a1\u505c\u6b62\uff1a\u542f\u52a8\u670d\u52a1\n- \u76d1\u542c\u5668\u505c\u6b62\uff1alsnrctl start\n- \u7f51\u7edc\u95ee\u9898\uff1a\u68c0\u67e5\u9632\u706b\u5899\u3001DNS\n- \u5bc6\u7801\u9519\u8bef\uff1a\u91cd\u7f6e\u5bc6\u7801\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#53","title":"5.3 \u5e94\u7528\u54cd\u5e94\u7f13\u6162","text":"<pre><code>\u75c7\u72b6\uff1a\n- \u9875\u9762\u52a0\u8f7d\u65f6\u95f4 &gt; 10 \u79d2\n- \u7528\u6237\u62a5\u544a\u7cfb\u7edf\u5361\u987f\n\n\u6392\u67e5\u6b65\u9aa4\uff1a\n1. \u68c0\u67e5 CPU \u4f7f\u7528\u7387\n   Get-Counter '\\Processor(_Total)\\% Processor Time'\n\n2. \u68c0\u67e5\u5185\u5b58\u4f7f\u7528\n   Get-Counter '\\Memory\\Available MBytes'\n\n3. \u68c0\u67e5\u6570\u636e\u5e93\u4f1a\u8bdd\n   SELECT COUNT(*) FROM v$session WHERE username = 'PASX_OWNER';\n\n4. \u68c0\u67e5\u6162\u67e5\u8be2\n   SELECT sql_text, elapsed_time, executions\n   FROM v$sql\n   WHERE elapsed_time &gt; 1000000\n   ORDER BY elapsed_time DESC;\n\n\u89e3\u51b3\u65b9\u6848\uff1a\n- CPU \u9ad8\uff1a\u91cd\u542f Tomcat\u3001\u4f18\u5316\u4ee3\u7801\n- \u5185\u5b58\u4e0d\u8db3\uff1a\u589e\u52a0 JVM \u5185\u5b58\u3001\u91cd\u542f\u670d\u52a1\u5668\n- \u6570\u636e\u5e93\u6162\uff1a\u4f18\u5316 SQL\u3001\u6dfb\u52a0\u7d22\u5f15\u3001\u66f4\u65b0\u7edf\u8ba1\u4fe1\u606f\n- \u4f1a\u8bdd\u8fc7\u591a\uff1a\u68c0\u67e5\u8fde\u63a5\u6c60\u914d\u7f6e\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#54","title":"5.4 \u6279\u6b21\u6267\u884c\u5931\u8d25","text":"<pre><code>\u75c7\u72b6\uff1a\n- \u6279\u6b21\u72b6\u6001\u663e\u793a \"Error\"\n- \u64cd\u4f5c\u5458\u65e0\u6cd5\u7ee7\u7eed\u6267\u884c\n\n\u6392\u67e5\u6b65\u9aa4\uff1a\n1. \u67e5\u770b\u6279\u6b21\u65e5\u5fd7\n   \u5bfc\u822a\uff1aProduction &gt; Batch Execution &gt; [Batch Number] &gt; Logs\n\n2. \u67e5\u770b\u9519\u8bef\u4fe1\u606f\n   \u68c0\u67e5\u9519\u8bef\u4ee3\u7801\u548c\u63cf\u8ff0\n\n3. \u68c0\u67e5\u8bbe\u5907\u8fde\u63a5\n   \u5bfc\u822a\uff1aAdministration &gt; Equipment &gt; [Equipment Name] &gt; Status\n\n4. \u68c0\u67e5\u5ba1\u8ba1\u65e5\u5fd7\n   \u5bfc\u822a\uff1aAdministration &gt; Audit Trail\n\n\u89e3\u51b3\u65b9\u6848\uff1a\n- \u8bbe\u5907\u79bb\u7ebf\uff1a\u68c0\u67e5\u8bbe\u5907\u8fde\u63a5\u3001\u91cd\u542f\u8bbe\u5907\n- \u6570\u636e\u9a8c\u8bc1\u5931\u8d25\uff1a\u68c0\u67e5\u8f93\u5165\u6570\u636e\u3001\u4fee\u6539\u914d\u65b9\n- \u6743\u9650\u4e0d\u8db3\uff1a\u68c0\u67e5\u7528\u6237\u89d2\u8272\n- \u7cfb\u7edf\u9519\u8bef\uff1a\u8054\u7cfb Werum \u6280\u672f\u652f\u6301\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#6","title":"6. \u6027\u80fd\u4f18\u5316","text":""},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#61-jvm","title":"6.1 JVM \u8c03\u4f18","text":"<pre><code>REM \u7f16\u8f91 C:\\PAS-X\\Tomcat\\bin\\setenv.bat\n\n@echo off\n\nREM \u5806\u5185\u5b58\u8bbe\u7f6e\uff08\u6839\u636e\u670d\u52a1\u5668\u5185\u5b58\u8c03\u6574\uff09\nset \"JAVA_OPTS=-Xms8192m -Xmx16384m\"\n\nREM Metaspace \u8bbe\u7f6e\nset \"JAVA_OPTS=%JAVA_OPTS% -XX:MetaspaceSize=512m -XX:MaxMetaspaceSize=1024m\"\n\nREM \u5783\u573e\u56de\u6536\u5668\uff08G1GC\uff0c\u63a8\u8350\u7528\u4e8e\u5927\u5185\u5b58\uff09\nset \"JAVA_OPTS=%JAVA_OPTS% -XX:+UseG1GC\"\nset \"JAVA_OPTS=%JAVA_OPTS% -XX:MaxGCPauseMillis=200\"\nset \"JAVA_OPTS=%JAVA_OPTS% -XX:ParallelGCThreads=8\"\n\nREM GC \u65e5\u5fd7\nset \"JAVA_OPTS=%JAVA_OPTS% -Xlog:gc*:file=C:/PAS-X/Logs/gc.log:time,uptime:filecount=5,filesize=10M\"\n\nREM \u5176\u4ed6\u4f18\u5316\nset \"JAVA_OPTS=%JAVA_OPTS% -Djava.awt.headless=true\"\nset \"JAVA_OPTS=%JAVA_OPTS% -Dfile.encoding=UTF-8\"\nset \"JAVA_OPTS=%JAVA_OPTS% -Duser.timezone=Asia/Shanghai\"\nset \"JAVA_OPTS=%JAVA_OPTS% -server\"\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#62","title":"6.2 \u6570\u636e\u5e93\u4f18\u5316","text":"<pre><code>-- \u66f4\u65b0\u7edf\u8ba1\u4fe1\u606f\nBEGIN\n    DBMS_STATS.GATHER_SCHEMA_STATS(\n        ownname =&gt; 'PASX_OWNER',\n        estimate_percent =&gt; DBMS_STATS.AUTO_SAMPLE_SIZE,\n        method_opt =&gt; 'FOR ALL COLUMNS SIZE AUTO',\n        degree =&gt; 4\n    );\nEND;\n/\n\n-- \u91cd\u5efa\u7d22\u5f15\uff08\u788e\u7247\u6574\u7406\uff09\nSELECT 'ALTER INDEX ' || index_name || ' REBUILD ONLINE;'\nFROM user_indexes\nWHERE tablespace_name IN ('PASX_DATA', 'PASX_INDEX');\n\n-- \u6e05\u7406\u5ba1\u8ba1\u65e5\u5fd7\uff08\u4fdd\u7559 7 \u5e74\uff09\nDELETE FROM pasx_audit_log\nWHERE audit_date &lt; ADD_MONTHS(SYSDATE, -84);\nCOMMIT;\n\n-- \u5206\u6790\u8868\u7a7a\u95f4\u788e\u7247\nSELECT\n    tablespace_name,\n    ROUND(SUM(bytes)/1024/1024/1024, 2) AS total_gb,\n    COUNT(*) AS fragment_count\nFROM dba_free_space\nGROUP BY tablespace_name\nORDER BY fragment_count DESC;\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#63-tomcat","title":"6.3 Tomcat \u8fde\u63a5\u6c60\u4f18\u5316","text":"<pre><code>&lt;!-- \u7f16\u8f91 C:\\PAS-X\\Tomcat\\conf\\context.xml --&gt;\n\n&lt;Context&gt;\n    &lt;Resource name=\"jdbc/PASXDB\"\n              auth=\"Container\"\n              type=\"javax.sql.DataSource\"\n              driverClassName=\"oracle.jdbc.OracleDriver\"\n              url=\"jdbc:oracle:thin:@PASX-DB01:1521:PASXDB\"\n              username=\"pasx_owner\"\n              password=\"PasxOwner@2025\"\n\n              &lt;!-- \u8fde\u63a5\u6c60\u5927\u5c0f --&gt;\n              initialSize=\"20\"\n              maxTotal=\"100\"\n              maxIdle=\"50\"\n              minIdle=\"20\"\n\n              &lt;!-- \u8d85\u65f6\u8bbe\u7f6e --&gt;\n              maxWaitMillis=\"10000\"\n\n              &lt;!-- \u8fde\u63a5\u9a8c\u8bc1 --&gt;\n              testOnBorrow=\"true\"\n              testWhileIdle=\"true\"\n              validationQuery=\"SELECT 1 FROM DUAL\"\n              validationQueryTimeout=\"5\"\n\n              &lt;!-- \u7a7a\u95f2\u8fde\u63a5\u56de\u6536 --&gt;\n              timeBetweenEvictionRunsMillis=\"30000\"\n              minEvictableIdleTimeMillis=\"60000\"\n\n              &lt;!-- \u8fde\u63a5\u6cc4\u6f0f\u68c0\u6d4b --&gt;\n              removeAbandonedOnBorrow=\"true\"\n              removeAbandonedTimeout=\"300\"\n              logAbandoned=\"true\" /&gt;\n&lt;/Context&gt;\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#7","title":"7. \u5ba1\u8ba1\u4e0e\u5408\u89c4","text":""},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#71","title":"7.1 \u5ba1\u8ba1\u65e5\u5fd7\u5ba1\u67e5","text":"<pre><code>-- \u67e5\u8be2\u6700\u8fd1 7 \u5929\u7684\u5ba1\u8ba1\u65e5\u5fd7\nSELECT\n    audit_date,\n    username,\n    action_type,\n    object_type,\n    object_name,\n    result,\n    ip_address\nFROM pasx_audit_log\nWHERE audit_date &gt;= SYSDATE - 7\nORDER BY audit_date DESC;\n\n-- \u67e5\u8be2\u5931\u8d25\u7684\u767b\u5f55\u5c1d\u8bd5\nSELECT\n    audit_date,\n    username,\n    ip_address,\n    COUNT(*) AS failed_attempts\nFROM pasx_audit_log\nWHERE action_type = 'LOGIN'\nAND result = 'FAILURE'\nAND audit_date &gt;= SYSDATE - 7\nGROUP BY audit_date, username, ip_address\nHAVING COUNT(*) &gt; 3\nORDER BY failed_attempts DESC;\n\n-- \u67e5\u8be2\u914d\u65b9\u4fee\u6539\u8bb0\u5f55\nSELECT\n    audit_date,\n    username,\n    action_type,\n    object_name AS recipe_name,\n    old_value,\n    new_value\nFROM pasx_audit_log\nWHERE object_type = 'RECIPE'\nAND action_type IN ('CREATE', 'MODIFY', 'DELETE')\nORDER BY audit_date DESC;\n\n-- \u5bfc\u51fa\u5ba1\u8ba1\u65e5\u5fd7\uff08CSV\uff09\nSPOOL C:\\PAS-X\\Reports\\audit_log.csv\nSELECT\n    TO_CHAR(audit_date, 'YYYY-MM-DD HH24:MI:SS') || ',' ||\n    username || ',' ||\n    action_type || ',' ||\n    object_type || ',' ||\n    object_name || ',' ||\n    result\nFROM pasx_audit_log\nWHERE audit_date &gt;= ADD_MONTHS(SYSDATE, -1);\nSPOOL OFF\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#72","title":"7.2 \u7535\u5b50\u7b7e\u540d\u5ba1\u67e5","text":"<pre><code>-- \u67e5\u8be2\u6240\u6709\u7535\u5b50\u7b7e\u540d\u8bb0\u5f55\nSELECT\n    s.signature_date,\n    s.username,\n    s.signature_meaning,\n    s.signature_reason,\n    b.batch_number,\n    b.product_code\nFROM pasx_signatures s\nJOIN pasx_batches b ON s.batch_id = b.batch_id\nWHERE s.signature_date &gt;= SYSDATE - 30\nORDER BY s.signature_date DESC;\n\n-- \u67e5\u8be2\u7f3a\u5931\u7684\u7535\u5b50\u7b7e\u540d\nSELECT\n    b.batch_number,\n    b.product_code,\n    b.status,\n    b.start_date\nFROM pasx_batches b\nWHERE b.status = 'COMPLETED'\nAND NOT EXISTS (\n    SELECT 1 FROM pasx_signatures s\n    WHERE s.batch_id = b.batch_id\n    AND s.signature_meaning = 'APPROVED'\n)\nAND b.start_date &gt;= SYSDATE - 30;\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#8","title":"8. \u8865\u4e01\u4e0e\u66f4\u65b0","text":""},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#81","title":"8.1 \u68c0\u67e5\u53ef\u7528\u8865\u4e01","text":"<pre><code>\u6b65\u9aa4\uff1a\n1. \u767b\u5f55 Werum \u5ba2\u6237\u95e8\u6237\n2. \u5bfc\u822a\uff1aDownloads &gt; PAS-X &gt; Patches\n3. \u67e5\u770b\u53ef\u7528\u8865\u4e01\u5217\u8868\n4. \u4e0b\u8f7d\u8865\u4e01\u6587\u4ef6\u548c\u53d1\u5e03\u8bf4\u660e\n5. \u9605\u8bfb\u53d1\u5e03\u8bf4\u660e\uff0c\u786e\u8ba4\u9002\u7528\u6027\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#82","title":"8.2 \u5b89\u88c5\u8865\u4e01","text":"<pre><code># \u8865\u4e01\u5b89\u88c5\u6d41\u7a0b\n\n# 1. \u5907\u4efd\u7cfb\u7edf\n.\\Backup-Database.ps1\n.\\Backup-Application.ps1\n\n# 2. \u505c\u6b62 Tomcat\nStop-Service -Name \"Tomcat9\"\n\n# 3. \u89e3\u538b\u8865\u4e01\u6587\u4ef6\nExpand-Archive -Path \"C:\\Install\\PAS-X_Patch_7.x.x.zip\" -DestinationPath \"C:\\Install\\PAS-X_Patch\"\n\n# 4. \u8fd0\u884c\u6570\u636e\u5e93\u811a\u672c\uff08\u5982\u6709\uff09\nsqlplus pasx_owner/PasxOwner@2025@PASXDB @C:\\Install\\PAS-X_Patch\\database\\patch.sql\n\n# 5. \u66ff\u6362\u5e94\u7528\u6587\u4ef6\nCopy-Item -Path \"C:\\Install\\PAS-X_Patch\\application\\*\" -Destination \"C:\\PAS-X\\Tomcat\\webapps\\pasx\\\" -Recurse -Force\n\n# 6. \u542f\u52a8 Tomcat\nStart-Service -Name \"Tomcat9\"\n\n# 7. \u9a8c\u8bc1\u8865\u4e01\n# \u767b\u5f55 PAS-X\uff0c\u68c0\u67e5\u7248\u672c\u53f7\n# \u5bfc\u822a\uff1aAdministration &gt; System Information &gt; Version\n\n# 8. \u8bb0\u5f55\u53d8\u66f4\n# \u66f4\u65b0\u53d8\u66f4\u65e5\u5fd7\uff0c\u8bb0\u5f55\u8865\u4e01\u7248\u672c\u3001\u5b89\u88c5\u65f6\u95f4\u3001\u5b89\u88c5\u4eba\u5458\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#9","title":"9. \u707e\u96be\u6062\u590d","text":""},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#91","title":"9.1 \u6062\u590d\u6570\u636e\u5e93","text":"<pre><code># 1. \u505c\u6b62 Tomcat\nStop-Service -Name \"Tomcat9\"\n\n# 2. \u4f7f\u7528 Data Pump \u5bfc\u5165\n$env:ORACLE_HOME = \"C:\\Oracle\\product\\19.0.0\\dbhome_1\"\n$env:PATH = \"$env:ORACLE_HOME\\bin;$env:PATH\"\n\nimpdp pasx_owner/PasxOwner@2025@PASXDB `\n  directory=BACKUP_DIR `\n  dumpfile=PASXDB_20251111.dmp `\n  logfile=restore.log `\n  schemas=pasx_owner `\n  table_exists_action=replace\n\n# 3. \u9a8c\u8bc1\u6570\u636e\nsqlplus pasx_owner/PasxOwner@2025@PASXDB\nSELECT COUNT(*) FROM pasx_batches;\n\n# 4. \u542f\u52a8 Tomcat\nStart-Service -Name \"Tomcat9\"\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#92","title":"9.2 \u6062\u590d\u5e94\u7528","text":"<pre><code># 1. \u505c\u6b62 Tomcat\nStop-Service -Name \"Tomcat9\"\n\n# 2. \u89e3\u538b\u5907\u4efd\nExpand-Archive -Path \"E:\\Backup\\PAS-X\\Application\\20251111.zip\" -DestinationPath \"C:\\Temp\\Restore\"\n\n# 3. \u6062\u590d\u914d\u7f6e\nCopy-Item -Path \"C:\\Temp\\Restore\\Tomcat_conf\\*\" -Destination \"C:\\PAS-X\\Tomcat\\conf\\\" -Recurse -Force\n\n# 4. \u6062\u590d\u5e94\u7528\nRemove-Item -Path \"C:\\PAS-X\\Tomcat\\webapps\\pasx\" -Recurse -Force\nCopy-Item -Path \"C:\\Temp\\Restore\\pasx_app\" -Destination \"C:\\PAS-X\\Tomcat\\webapps\\pasx\" -Recurse\n\n# 5. \u6062\u590d\u914d\u7f6e\u6587\u4ef6\nCopy-Item -Path \"C:\\Temp\\Restore\\Config\\*\" -Destination \"C:\\PAS-X\\Config\\\" -Recurse -Force\n\n# 6. \u542f\u52a8 Tomcat\nStart-Service -Name \"Tomcat9\"\n\n# 7. \u9a8c\u8bc1\n# \u8bbf\u95ee https://pasx-app01:8443/pasx\n# \u6d4b\u8bd5\u767b\u5f55\u548c\u6838\u5fc3\u529f\u80fd\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#10","title":"10. \u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u5b9a\u671f\u5907\u4efd\uff1a\u6bcf\u5929\u5907\u4efd\u6570\u636e\u5e93\uff0c\u6bcf\u5468\u5907\u4efd\u5e94\u7528</li> <li>\u76d1\u63a7\u544a\u8b66\uff1a\u914d\u7f6e\u81ea\u52a8\u76d1\u63a7\u811a\u672c\uff0c\u5f02\u5e38\u65f6\u53d1\u9001\u90ae\u4ef6</li> <li>\u65e5\u5fd7\u5ba1\u67e5\uff1a\u6bcf\u5468\u5ba1\u67e5\u7cfb\u7edf\u65e5\u5fd7\u548c\u5ba1\u8ba1\u65e5\u5fd7</li> <li>\u6027\u80fd\u76d1\u63a7\uff1a\u6bcf\u6708\u751f\u6210\u6027\u80fd\u62a5\u544a\uff0c\u8bc6\u522b\u74f6\u9888</li> <li>\u8865\u4e01\u7ba1\u7406\uff1a\u6bcf\u5b63\u5ea6\u68c0\u67e5\u5e76\u5b89\u88c5\u8865\u4e01</li> <li>\u7528\u6237\u57f9\u8bad\uff1a\u5b9a\u671f\u57f9\u8bad\u7528\u6237\u548c\u7ba1\u7406\u5458</li> <li>\u6587\u6863\u7ef4\u62a4\uff1a\u53ca\u65f6\u66f4\u65b0\u8fd0\u7ef4\u6587\u6863\u548c\u53d8\u66f4\u65e5\u5fd7</li> <li>\u707e\u96be\u6f14\u7ec3\uff1a\u6bcf\u5e74\u81f3\u5c11\u4e00\u6b21 DR \u6f14\u7ec3</li> <li>\u5bb9\u91cf\u89c4\u5212\uff1a\u76d1\u63a7\u7cfb\u7edf\u589e\u957f\uff0c\u63d0\u524d\u6269\u5bb9</li> <li>\u5408\u89c4\u5ba1\u8ba1\uff1a\u5b9a\u671f\u5ba1\u67e5\u7cfb\u7edf\u5408\u89c4\u6027\uff0821 CFR Part 11\uff09</li> </ol> <p>\u53c2\u8003\u8d44\u6e90\uff1a - Werum PAS-X \u8fd0\u7ef4\u624b\u518c - Oracle \u6570\u636e\u5e93\u7ba1\u7406\u6307\u5357 - Apache Tomcat \u8c03\u4f18\u6307\u5357 - GAMP 5 \u8fd0\u7ef4\u6307\u5357</p>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html","title":"Werum PAS-X MES \u7cfb\u7edf\u90e8\u7f72\u5b89\u88c5\u624b\u518c","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aMES \u7cfb\u7edf\u7ba1\u7406\u5458\u3001IT \u57fa\u7840\u67b6\u6784\u5de5\u7a0b\u5e08\u3001\u9a8c\u8bc1\u5de5\u7a0b\u5e08 \u76ee\u6807\uff1a\u5b8c\u6210 Werum PAS-X MES \u7cfb\u7edf\u7684\u6807\u51c6\u5316\u90e8\u7f72\uff0c\u4ece\u73af\u5883\u51c6\u5907\u5230\u7cfb\u7edf\u4e0a\u7ebf\uff0c\u786e\u4fdd\u7b26\u5408 GMP \u5408\u89c4\u8981\u6c42\u3002</p>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#1-werum-pas-x","title":"1. Werum PAS-X \u6982\u8ff0","text":""},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#11-pas-x","title":"1.1 \u4ec0\u4e48\u662f PAS-X","text":"<p>Werum PAS-X \u662f\u5168\u7403\u9886\u5148\u7684\u751f\u7269\u5236\u836f MES\uff08\u5236\u9020\u6267\u884c\u7cfb\u7edf\uff09\u89e3\u51b3\u65b9\u6848\uff0c\u4e13\u4e3a GMP \u73af\u5883\u8bbe\u8ba1\uff1a - \u7535\u5b50\u6279\u8bb0\u5f55\uff08EBR\uff09\uff1a\u65e0\u7eb8\u5316\u751f\u4ea7\u8bb0\u5f55 - \u5de5\u827a\u7ba1\u7406\uff1a\u914d\u65b9\u7ba1\u7406\u3001\u5de5\u827a\u53c2\u6570\u63a7\u5236 - \u7269\u6599\u7ba1\u7406\uff1a\u7269\u6599\u8ffd\u8e2a\u3001\u79f0\u91cf\u7ba1\u7406 - \u8bbe\u5907\u96c6\u6210\uff1a\u4e0e\u751f\u4ea7\u8bbe\u5907\u3001SCADA\u3001DCS \u96c6\u6210 - \u5408\u89c4\u6027\uff1a\u7b26\u5408 FDA 21 CFR Part 11\u3001EU Annex 11\u3001GAMP 5</p>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#12","title":"1.2 \u7cfb\u7edf\u67b6\u6784","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u7528\u6237\u5c42                                \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u2502\n\u2502  \u2502 \u64cd\u4f5c\u5458   \u2502  \u2502 \u8d28\u91cf\u4eba\u5458 \u2502  \u2502 \u7ba1\u7406\u5458   \u2502              \u2502\n\u2502  \u2502 (\u8f66\u95f4)   \u2502  \u2502 (QA)     \u2502  \u2502 (IT)     \u2502              \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502             \u2502             \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u5e94\u7528\u5c42\uff08PAS-X Server\uff09                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  PAS-X Application Server (Tomcat/JBoss)        \u2502  \u2502\n\u2502  \u2502  - Recipe Management\uff08\u914d\u65b9\u7ba1\u7406\uff09                  \u2502  \u2502\n\u2502  \u2502  - Batch Execution\uff08\u6279\u6b21\u6267\u884c\uff09                    \u2502  \u2502\n\u2502  \u2502  - Material Management\uff08\u7269\u6599\u7ba1\u7406\uff09                \u2502  \u2502\n\u2502  \u2502  - Equipment Integration\uff08\u8bbe\u5907\u96c6\u6210\uff09              \u2502  \u2502\n\u2502  \u2502  - Reporting &amp; Analytics\uff08\u62a5\u8868\u5206\u6790\uff09              \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u6570\u636e\u5c42\uff08Database Server\uff09                   \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  Oracle Database 19c / SQL Server 2019          \u2502  \u2502\n\u2502  \u2502  - \u914d\u65b9\u6570\u636e                                       \u2502  \u2502\n\u2502  \u2502  - \u6279\u6b21\u6570\u636e                                       \u2502  \u2502\n\u2502  \u2502  - \u5ba1\u8ba1\u8ffd\u8e2a                                       \u2502  \u2502\n\u2502  \u2502  - \u7528\u6237\u6743\u9650                                       \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u96c6\u6210\u5c42\uff08Integration Layer\uff09                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u2502\n\u2502  \u2502 SCADA    \u2502  \u2502 DCS      \u2502  \u2502 LIMS     \u2502              \u2502\n\u2502  \u2502 (Siemens)\u2502  \u2502 (Emerson)\u2502  \u2502 (LabWare)\u2502              \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#13","title":"1.3 \u90e8\u7f72\u6a21\u5f0f","text":"\u6a21\u5f0f \u9002\u7528\u573a\u666f \u4f18\u70b9 \u7f3a\u70b9 \u5355\u670d\u52a1\u5668 \u6d4b\u8bd5/\u9a8c\u8bc1\u73af\u5883 \u7b80\u5355\u3001\u6210\u672c\u4f4e \u6027\u80fd\u6709\u9650\u3001\u65e0\u5197\u4f59 \u53cc\u670d\u52a1\u5668 \u5c0f\u578b\u751f\u4ea7\u73af\u5883\uff08&lt;50 \u7528\u6237\uff09 \u5e94\u7528/\u6570\u636e\u5e93\u5206\u79bb \u5355\u70b9\u6545\u969c\u98ce\u9669 \u96c6\u7fa4\u90e8\u7f72 \u5927\u578b\u751f\u4ea7\u73af\u5883\uff08&gt;50 \u7528\u6237\uff09 \u9ad8\u53ef\u7528\u3001\u9ad8\u6027\u80fd \u590d\u6742\u3001\u6210\u672c\u9ad8"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#2","title":"2. \u73af\u5883\u51c6\u5907","text":""},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#21","title":"2.1 \u786c\u4ef6\u8981\u6c42","text":""},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#pas-x-server","title":"\u5e94\u7528\u670d\u52a1\u5668\uff08PAS-X Server\uff09","text":"\u7ec4\u4ef6 \u6700\u4f4e\u914d\u7f6e \u63a8\u8350\u914d\u7f6e\uff08\u751f\u4ea7\u73af\u5883\uff09 CPU 4 \u6838 8 \u6838\uff08Intel Xeon\uff09 \u5185\u5b58 16GB 32GB \u78c1\u76d8 500GB 1TB SSD\uff08RAID 10\uff09 \u7f51\u7edc 1Gbps 1Gbps\uff08\u53cc\u7f51\u5361\uff09"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#oraclesql-server","title":"\u6570\u636e\u5e93\u670d\u52a1\u5668\uff08Oracle/SQL Server\uff09","text":"\u7ec4\u4ef6 \u6700\u4f4e\u914d\u7f6e \u63a8\u8350\u914d\u7f6e\uff08\u751f\u4ea7\u73af\u5883\uff09 CPU 8 \u6838 16 \u6838\uff08Intel Xeon\uff09 \u5185\u5b58 32GB 64GB \u78c1\u76d8 1TB 2TB SSD\uff08RAID 10\uff09 \u7f51\u7edc 1Gbps 10Gbps\uff08\u53cc\u7f51\u5361\uff09"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#22","title":"2.2 \u8f6f\u4ef6\u8981\u6c42","text":""},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#_1","title":"\u64cd\u4f5c\u7cfb\u7edf","text":"<pre><code>\u652f\u6301\u7684\u64cd\u4f5c\u7cfb\u7edf\uff1a\n- Windows Server 2019 Standard/Datacenter\n- Windows Server 2022 Standard/Datacenter\n- Red Hat Enterprise Linux 8.x\uff08\u53ef\u9009\uff09\n\n\u63a8\u8350\uff1aWindows Server 2019 Datacenter\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#_2","title":"\u6570\u636e\u5e93","text":"<pre><code>\u652f\u6301\u7684\u6570\u636e\u5e93\uff1a\n- Oracle Database 19c Enterprise Edition\n- Microsoft SQL Server 2019 Enterprise Edition\n\n\u63a8\u8350\uff1aOracle Database 19c\uff08\u66f4\u597d\u7684\u6027\u80fd\u548c\u7a33\u5b9a\u6027\uff09\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#_3","title":"\u5e94\u7528\u670d\u52a1\u5668","text":"<pre><code>\u652f\u6301\u7684\u5e94\u7528\u670d\u52a1\u5668\uff1a\n- Apache Tomcat 9.x\n- Red Hat JBoss EAP 7.x\n\n\u63a8\u8350\uff1aApache Tomcat 9.0.x\uff08\u5b98\u65b9\u63a8\u8350\uff09\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#java","title":"Java \u8fd0\u884c\u73af\u5883","text":"<pre><code>\u8981\u6c42\uff1a\n- Oracle JDK 11 \u6216 OpenJDK 11\n- 64-bit \u7248\u672c\n\n\u63a8\u8350\uff1aOracle JDK 11.0.x\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#23","title":"2.3 \u7f51\u7edc\u89c4\u5212","text":"<pre><code>\u670d\u52a1\u5668\u914d\u7f6e\uff1a\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 PAS-X \u5e94\u7528\u670d\u52a1\u5668                                 \u2502\n\u2502 - \u4e3b\u673a\u540d\uff1aPASX-APP01                             \u2502\n\u2502 - IP \u5730\u5740\uff1a10.10.50.20                          \u2502\n\u2502 - \u5b50\u7f51\u63a9\u7801\uff1a255.255.255.0                        \u2502\n\u2502 - \u7f51\u5173\uff1a10.10.50.1                              \u2502\n\u2502 - DNS\uff1a10.10.40.10, 10.10.40.11                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Oracle \u6570\u636e\u5e93\u670d\u52a1\u5668                              \u2502\n\u2502 - \u4e3b\u673a\u540d\uff1aPASX-DB01                              \u2502\n\u2502 - IP \u5730\u5740\uff1a10.10.50.21                          \u2502\n\u2502 - \u5b50\u7f51\u63a9\u7801\uff1a255.255.255.0                        \u2502\n\u2502 - \u7f51\u5173\uff1a10.10.50.1                              \u2502\n\u2502 - DNS\uff1a10.10.40.10, 10.10.40.11                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u7aef\u53e3\u89c4\u5212\uff1a\n- PAS-X Web \u8bbf\u95ee\uff1a8080\uff08HTTP\uff09\u30018443\uff08HTTPS\uff09\n- Oracle \u6570\u636e\u5e93\uff1a1521\n- Oracle EM\uff1a5500\n- Tomcat \u7ba1\u7406\uff1a8005\uff08Shutdown\uff09\u30018009\uff08AJP\uff09\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#24","title":"2.4 \u57df\u8d26\u53f7\u51c6\u5907","text":"<pre><code># \u5728\u57df\u63a7\u4e0a\u521b\u5efa\u670d\u52a1\u8d26\u53f7\n\n# PAS-X \u5e94\u7528\u670d\u52a1\u8d26\u53f7\nNew-ADUser `\n    -Name \"svc_pasx_app\" `\n    -SamAccountName \"svc_pasx_app\" `\n    -UserPrincipalName \"svc_pasx_app@pharma.local\" `\n    -Path \"OU=Service Accounts,OU=Shanghai,DC=pharma,DC=local\" `\n    -AccountPassword (ConvertTo-SecureString \"ComplexP@ssw0rd!\" -AsPlainText -Force) `\n    -Enabled $true `\n    -PasswordNeverExpires $true `\n    -CannotChangePassword $true\n\n# Oracle \u6570\u636e\u5e93\u670d\u52a1\u8d26\u53f7\nNew-ADUser `\n    -Name \"svc_oracle\" `\n    -SamAccountName \"svc_oracle\" `\n    -UserPrincipalName \"svc_oracle@pharma.local\" `\n    -Path \"OU=Service Accounts,OU=Shanghai,DC=pharma,DC=local\" `\n    -AccountPassword (ConvertTo-SecureString \"ComplexP@ssw0rd!\" -AsPlainText -Force) `\n    -Enabled $true `\n    -PasswordNeverExpires $true `\n    -CannotChangePassword $true\n\n# \u5c06\u670d\u52a1\u8d26\u53f7\u6dfb\u52a0\u5230\u672c\u5730\u7ba1\u7406\u5458\u7ec4\uff08\u5728\u5e94\u7528\u670d\u52a1\u5668\u4e0a\u6267\u884c\uff09\nAdd-LocalGroupMember -Group \"Administrators\" -Member \"PHARMA\\svc_pasx_app\"\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#3-oracle","title":"3. \u5b89\u88c5 Oracle \u6570\u636e\u5e93","text":""},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#31-oracle-19c","title":"3.1 \u5b89\u88c5 Oracle 19c","text":"<pre><code># \u5728 PASX-DB01 \u4e0a\u6267\u884c\n\n# 1. \u89e3\u538b\u5b89\u88c5\u6587\u4ef6\nExpand-Archive -Path \"C:\\Install\\WINDOWS.X64_193000_db_home.zip\" -DestinationPath \"C:\\Oracle\\product\\19.0.0\\dbhome_1\"\n\n# 2. \u8fd0\u884c\u5b89\u88c5\u7a0b\u5e8f\ncd C:\\Oracle\\product\\19.0.0\\dbhome_1\n.\\setup.exe\n\n# \u5b89\u88c5\u9009\u9879\uff1a\n# - \u5b89\u88c5\u7c7b\u578b\uff1a\u670d\u52a1\u5668\u7c7b\n# - \u6570\u636e\u5e93\u7248\u672c\uff1aEnterprise Edition\n# - \u5b89\u88c5\u4f4d\u7f6e\uff1aC:\\Oracle\\product\\19.0.0\\dbhome_1\n# - \u6570\u636e\u5e93\u914d\u7f6e\uff1a\u521b\u5efa\u5e76\u914d\u7f6e\u6570\u636e\u5e93\n# - \u5168\u5c40\u6570\u636e\u5e93\u540d\uff1aPASXDB\n# - SID\uff1aPASXDB\n# - \u5b57\u7b26\u96c6\uff1aAL32UTF8\n# - \u5185\u5b58\uff1a\u81ea\u52a8\uff08\u6216\u624b\u52a8\u8bbe\u7f6e 16GB\uff09\n# - \u7ba1\u7406\u5458\u5bc6\u7801\uff1a\u8bbe\u7f6e SYS/SYSTEM \u5bc6\u7801\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#32-pas-x","title":"3.2 \u521b\u5efa PAS-X \u6570\u636e\u5e93\u7528\u6237","text":"<pre><code>-- \u4f7f\u7528 SQL*Plus \u8fde\u63a5\u5230\u6570\u636e\u5e93\nsqlplus / as sysdba\n\n-- \u521b\u5efa\u8868\u7a7a\u95f4\nCREATE TABLESPACE PASX_DATA\nDATAFILE 'C:\\Oracle\\oradata\\PASXDB\\pasx_data01.dbf' SIZE 10G\nAUTOEXTEND ON NEXT 1G MAXSIZE 50G\nEXTENT MANAGEMENT LOCAL\nSEGMENT SPACE MANAGEMENT AUTO;\n\nCREATE TABLESPACE PASX_INDEX\nDATAFILE 'C:\\Oracle\\oradata\\PASXDB\\pasx_index01.dbf' SIZE 5G\nAUTOEXTEND ON NEXT 1G MAXSIZE 20G\nEXTENT MANAGEMENT LOCAL\nSEGMENT SPACE MANAGEMENT AUTO;\n\n-- \u521b\u5efa\u7528\u6237\nCREATE USER pasx_owner IDENTIFIED BY \"PasxOwner@2025\"\nDEFAULT TABLESPACE PASX_DATA\nTEMPORARY TABLESPACE TEMP\nQUOTA UNLIMITED ON PASX_DATA\nQUOTA UNLIMITED ON PASX_INDEX;\n\n-- \u6388\u4e88\u6743\u9650\nGRANT CONNECT, RESOURCE, CREATE VIEW, CREATE SYNONYM TO pasx_owner;\nGRANT CREATE SESSION TO pasx_owner;\nGRANT CREATE TABLE TO pasx_owner;\nGRANT CREATE SEQUENCE TO pasx_owner;\nGRANT CREATE TRIGGER TO pasx_owner;\nGRANT CREATE PROCEDURE TO pasx_owner;\n\n-- \u9a8c\u8bc1\u7528\u6237\nSELECT username, default_tablespace, temporary_tablespace \nFROM dba_users \nWHERE username = 'PASX_OWNER';\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#33-oracle","title":"3.3 \u914d\u7f6e Oracle \u76d1\u542c\u5668","text":"<pre><code># \u7f16\u8f91 listener.ora\n# \u6587\u4ef6\u4f4d\u7f6e\uff1aC:\\Oracle\\product\\19.0.0\\dbhome_1\\network\\admin\\listener.ora\n\nLISTENER =\n  (DESCRIPTION_LIST =\n    (DESCRIPTION =\n      (ADDRESS = (PROTOCOL = TCP)(HOST = PASX-DB01)(PORT = 1521))\n    )\n  )\n\nSID_LIST_LISTENER =\n  (SID_LIST =\n    (SID_DESC =\n      (GLOBAL_DBNAME = PASXDB)\n      (ORACLE_HOME = C:\\Oracle\\product\\19.0.0\\dbhome_1)\n      (SID_NAME = PASXDB)\n    )\n  )\n\n# \u91cd\u542f\u76d1\u542c\u5668\nlsnrctl stop\nlsnrctl start\nlsnrctl status\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#34-tns","title":"3.4 \u914d\u7f6e TNS","text":"<pre><code># \u7f16\u8f91 tnsnames.ora\n# \u6587\u4ef6\u4f4d\u7f6e\uff1aC:\\Oracle\\product\\19.0.0\\dbhome_1\\network\\admin\\tnsnames.ora\n\nPASXDB =\n  (DESCRIPTION =\n    (ADDRESS = (PROTOCOL = TCP)(HOST = PASX-DB01)(PORT = 1521))\n    (CONNECT_DATA =\n      (SERVER = DEDICATED)\n      (SERVICE_NAME = PASXDB)\n    )\n  )\n\n# \u6d4b\u8bd5\u8fde\u63a5\ntnsping PASXDB\nsqlplus pasx_owner/PasxOwner@2025@PASXDB\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#4-java-tomcat","title":"4. \u5b89\u88c5 Java \u548c Tomcat","text":""},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#41-oracle-jdk-11","title":"4.1 \u5b89\u88c5 Oracle JDK 11","text":"<pre><code># \u5728 PASX-APP01 \u4e0a\u6267\u884c\n\n# 1. \u4e0b\u8f7d Oracle JDK 11\n# https://www.oracle.com/java/technologies/javase/jdk11-archive-downloads.html\n\n# 2. \u5b89\u88c5 JDK\nStart-Process -FilePath \"C:\\Install\\jdk-11.0.20_windows-x64_bin.exe\" -ArgumentList \"/s\" -Wait\n\n# 3. \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\n[System.Environment]::SetEnvironmentVariable(\"JAVA_HOME\", \"C:\\Program Files\\Java\\jdk-11.0.20\", \"Machine\")\n$path = [System.Environment]::GetEnvironmentVariable(\"Path\", \"Machine\")\n[System.Environment]::SetEnvironmentVariable(\"Path\", \"$path;C:\\Program Files\\Java\\jdk-11.0.20\\bin\", \"Machine\")\n\n# 4. \u9a8c\u8bc1\u5b89\u88c5\njava -version\n# \u8f93\u51fa\uff1ajava version \"11.0.20\" 2023-07-18 LTS\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#42-apache-tomcat-9","title":"4.2 \u5b89\u88c5 Apache Tomcat 9","text":"<pre><code># 1. \u4e0b\u8f7d Tomcat 9\n# https://tomcat.apache.org/download-90.cgi\n# \u4e0b\u8f7d 64-bit Windows zip\n\n# 2. \u89e3\u538b\u5230\u5b89\u88c5\u76ee\u5f55\nExpand-Archive -Path \"C:\\Install\\apache-tomcat-9.0.80-windows-x64.zip\" -DestinationPath \"C:\\PAS-X\"\nRename-Item -Path \"C:\\PAS-X\\apache-tomcat-9.0.80\" -NewName \"Tomcat\"\n\n# 3. \u914d\u7f6e Tomcat \u73af\u5883\u53d8\u91cf\n[System.Environment]::SetEnvironmentVariable(\"CATALINA_HOME\", \"C:\\PAS-X\\Tomcat\", \"Machine\")\n[System.Environment]::SetEnvironmentVariable(\"CATALINA_BASE\", \"C:\\PAS-X\\Tomcat\", \"Machine\")\n\n# 4. \u914d\u7f6e JVM \u53c2\u6570\n# \u7f16\u8f91 C:\\PAS-X\\Tomcat\\bin\\setenv.bat\uff08\u65b0\u5efa\u6587\u4ef6\uff09\n@echo off\nset \"JAVA_OPTS=-Xms4096m -Xmx8192m -XX:MetaspaceSize=512m -XX:MaxMetaspaceSize=1024m\"\nset \"JAVA_OPTS=%JAVA_OPTS% -Djava.awt.headless=true\"\nset \"JAVA_OPTS=%JAVA_OPTS% -Dfile.encoding=UTF-8\"\nset \"JAVA_OPTS=%JAVA_OPTS% -Duser.timezone=Asia/Shanghai\"\n\n# 5. \u5b89\u88c5 Tomcat \u670d\u52a1\ncd C:\\PAS-X\\Tomcat\\bin\n.\\service.bat install Tomcat9\n\n# 6. \u914d\u7f6e\u670d\u52a1\n# \u6253\u5f00 services.msc\n# \u627e\u5230 \"Apache Tomcat 9.0 Tomcat9\"\n# \u5c5e\u6027 &gt; \u767b\u5f55 &gt; \u4f7f\u7528\u6b64\u8d26\u6237\uff1aPHARMA\\svc_pasx_app\n# \u542f\u52a8\u7c7b\u578b\uff1a\u81ea\u52a8\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#43-tomcat","title":"4.3 \u914d\u7f6e Tomcat","text":"<pre><code>&lt;!-- \u7f16\u8f91 C:\\PAS-X\\Tomcat\\conf\\server.xml --&gt;\n\n&lt;!-- \u4fee\u6539 Connector \u7aef\u53e3\uff08\u53ef\u9009\uff09 --&gt;\n&lt;Connector port=\"8080\" protocol=\"HTTP/1.1\"\n           connectionTimeout=\"20000\"\n           redirectPort=\"8443\"\n           maxThreads=\"200\"\n           minSpareThreads=\"10\"\n           enableLookups=\"false\"\n           acceptCount=\"100\"\n           URIEncoding=\"UTF-8\" /&gt;\n\n&lt;!-- \u6dfb\u52a0 HTTPS Connector\uff08\u751f\u4ea7\u73af\u5883\u5fc5\u987b\uff09 --&gt;\n&lt;Connector port=\"8443\" protocol=\"org.apache.coyote.http11.Http11NioProtocol\"\n           maxThreads=\"200\" SSLEnabled=\"true\"\n           scheme=\"https\" secure=\"true\" clientAuth=\"false\"\n           sslProtocol=\"TLS\"\n           keystoreFile=\"C:/PAS-X/Tomcat/conf/pasx.jks\"\n           keystorePass=\"changeit\" /&gt;\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#5-pas-x","title":"5. \u5b89\u88c5 PAS-X \u5e94\u7528","text":""},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#51","title":"5.1 \u51c6\u5907\u5b89\u88c5\u6587\u4ef6","text":"<pre><code># 1. \u4ece Werum \u83b7\u53d6\u5b89\u88c5\u5305\n# - PAS-X_7.x_Installation.zip\n# - PAS-X_7.x_Database_Scripts.zip\n# - PAS-X_7.x_License.xml\n\n# 2. \u89e3\u538b\u5230\u4e34\u65f6\u76ee\u5f55\nExpand-Archive -Path \"C:\\Install\\PAS-X_7.x_Installation.zip\" -DestinationPath \"C:\\Install\\PAS-X\"\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#52","title":"5.2 \u8fd0\u884c\u6570\u636e\u5e93\u811a\u672c","text":"<pre><code>-- \u4f7f\u7528 SQL*Plus \u8fde\u63a5\nsqlplus pasx_owner/PasxOwner@2025@PASXDB\n\n-- \u8fd0\u884c\u5b89\u88c5\u811a\u672c\n@C:\\Install\\PAS-X\\Database\\01_create_tables.sql\n@C:\\Install\\PAS-X\\Database\\02_create_indexes.sql\n@C:\\Install\\PAS-X\\Database\\03_create_sequences.sql\n@C:\\Install\\PAS-X\\Database\\04_create_views.sql\n@C:\\Install\\PAS-X\\Database\\05_insert_base_data.sql\n\n-- \u9a8c\u8bc1\u5b89\u88c5\nSELECT table_name FROM user_tables ORDER BY table_name;\n-- \u5e94\u663e\u793a PAS-X \u6838\u5fc3\u8868\uff08\u7ea6 200+ \u5f20\u8868\uff09\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#53-pas-x-war","title":"5.3 \u90e8\u7f72 PAS-X WAR \u6587\u4ef6","text":"<pre><code># 1. \u590d\u5236 WAR \u6587\u4ef6\u5230 Tomcat\nCopy-Item -Path \"C:\\Install\\PAS-X\\Application\\pasx.war\" -Destination \"C:\\PAS-X\\Tomcat\\webapps\\\"\n\n# 2. \u914d\u7f6e\u6570\u636e\u5e93\u8fde\u63a5\n# \u7f16\u8f91 C:\\PAS-X\\Tomcat\\conf\\context.xml\n&lt;Context&gt;\n    &lt;Resource name=\"jdbc/PASXDB\"\n              auth=\"Container\"\n              type=\"javax.sql.DataSource\"\n              driverClassName=\"oracle.jdbc.OracleDriver\"\n              url=\"jdbc:oracle:thin:@PASX-DB01:1521:PASXDB\"\n              username=\"pasx_owner\"\n              password=\"PasxOwner@2025\"\n              maxTotal=\"100\"\n              maxIdle=\"30\"\n              maxWaitMillis=\"10000\" /&gt;\n&lt;/Context&gt;\n\n# 3. \u590d\u5236 Oracle JDBC \u9a71\u52a8\nCopy-Item -Path \"C:\\Install\\ojdbc8.jar\" -Destination \"C:\\PAS-X\\Tomcat\\lib\\\"\n\n# 4. \u914d\u7f6e PAS-X \u8bb8\u53ef\u8bc1\nNew-Item -Path \"C:\\PAS-X\\Config\" -ItemType Directory\nCopy-Item -Path \"C:\\Install\\PAS-X_License.xml\" -Destination \"C:\\PAS-X\\Config\\license.xml\"\n\n# 5. \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff08PAS-X \u914d\u7f6e\u8def\u5f84\uff09\n[System.Environment]::SetEnvironmentVariable(\"PASX_CONFIG_DIR\", \"C:\\PAS-X\\Config\", \"Machine\")\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#54-tomcat","title":"5.4 \u542f\u52a8 Tomcat","text":"<pre><code># \u542f\u52a8 Tomcat \u670d\u52a1\nStart-Service Tomcat9\n\n# \u67e5\u770b\u65e5\u5fd7\nGet-Content -Path \"C:\\PAS-X\\Tomcat\\logs\\catalina.$(Get-Date -Format 'yyyy-MM-dd').log\" -Tail 50 -Wait\n\n# \u7b49\u5f85\u5e94\u7528\u90e8\u7f72\u5b8c\u6210\uff08\u7ea6 2-5 \u5206\u949f\uff09\n# \u65e5\u5fd7\u4e2d\u5e94\u663e\u793a\uff1a\n# INFO: Deployment of web application archive [C:\\PAS-X\\Tomcat\\webapps\\pasx.war] has finished in [xxx] ms\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#6","title":"6. \u521d\u59cb\u914d\u7f6e","text":""},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#61","title":"6.1 \u9996\u6b21\u767b\u5f55","text":"<pre><code>\u8bbf\u95ee PAS-X\uff1a\n- URL\uff1ahttp://PASX-APP01:8080/pasx\n- \u6216\uff1ahttps://PASX-APP01:8443/pasx\uff08HTTPS\uff09\n\n\u9ed8\u8ba4\u7ba1\u7406\u5458\u8d26\u53f7\uff1a\n- \u7528\u6237\u540d\uff1aadmin\n- \u5bc6\u7801\uff1aadmin\uff08\u9996\u6b21\u767b\u5f55\u540e\u5fc5\u987b\u66f4\u6539\uff09\n\n\u9996\u6b21\u767b\u5f55\u6b65\u9aa4\uff1a\n1. \u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\n2. \u7cfb\u7edf\u63d0\u793a\u66f4\u6539\u5bc6\u7801\n3. \u8bbe\u7f6e\u65b0\u5bc6\u7801\uff08\u7b26\u5408\u5bc6\u7801\u7b56\u7565\uff09\n4. \u8fdb\u5165\u7cfb\u7edf\u4e3b\u754c\u9762\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#62","title":"6.2 \u914d\u7f6e\u7cfb\u7edf\u53c2\u6570","text":"<pre><code>\u5bfc\u822a\uff1aAdministration &gt; System Configuration\n\n\u5173\u952e\u53c2\u6570\uff1a\n1. \u65f6\u533a\u8bbe\u7f6e\uff1aAsia/Shanghai\n2. \u8bed\u8a00\u8bbe\u7f6e\uff1a\u4e2d\u6587\uff08\u7b80\u4f53\uff09/ English\n3. \u65e5\u671f\u683c\u5f0f\uff1ayyyy-MM-dd\n4. \u65f6\u95f4\u683c\u5f0f\uff1aHH:mm:ss\n5. \u5ba1\u8ba1\u65e5\u5fd7\u4fdd\u7559\u671f\uff1a7 \u5e74\uff08\u7b26\u5408 GMP \u8981\u6c42\uff09\n6. \u5bc6\u7801\u7b56\u7565\uff1a\n   - \u6700\u5c0f\u957f\u5ea6\uff1a8 \u4f4d\n   - \u590d\u6742\u5ea6\uff1a\u5927\u5c0f\u5199\u5b57\u6bcd + \u6570\u5b57 + \u7279\u6b8a\u5b57\u7b26\n   - \u6709\u6548\u671f\uff1a90 \u5929\n   - \u5386\u53f2\u5bc6\u7801\uff1a\u4e0d\u80fd\u91cd\u590d\u6700\u8fd1 5 \u6b21\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#63","title":"6.3 \u521b\u5efa\u7528\u6237\u548c\u89d2\u8272","text":"<pre><code>\u5bfc\u822a\uff1aAdministration &gt; User Management\n\n\u521b\u5efa\u89d2\u8272\uff1a\n1. \u64cd\u4f5c\u5458\uff08Operator\uff09\n   - \u6743\u9650\uff1a\u6267\u884c\u6279\u6b21\u3001\u67e5\u770b\u914d\u65b9\u3001\u8bb0\u5f55\u6570\u636e\n2. \u8d28\u91cf\u4eba\u5458\uff08QA\uff09\n   - \u6743\u9650\uff1a\u5ba1\u6838\u6279\u6b21\u3001\u67e5\u770b\u62a5\u8868\u3001\u7535\u5b50\u7b7e\u540d\n3. \u5de5\u827a\u5de5\u7a0b\u5e08\uff08Process Engineer\uff09\n   - \u6743\u9650\uff1a\u521b\u5efa/\u4fee\u6539\u914d\u65b9\u3001\u914d\u7f6e\u5de5\u827a\u53c2\u6570\n4. \u7cfb\u7edf\u7ba1\u7406\u5458\uff08System Admin\uff09\n   - \u6743\u9650\uff1a\u7cfb\u7edf\u914d\u7f6e\u3001\u7528\u6237\u7ba1\u7406\u3001\u5ba1\u8ba1\u65e5\u5fd7\n\n\u521b\u5efa\u7528\u6237\uff1a\n1. \u7528\u6237\u540d\uff1azhang.san\n2. \u59d3\u540d\uff1a\u5f20\u4e09\n3. \u90ae\u7bb1\uff1azhang.san@pharma.com\n4. \u89d2\u8272\uff1a\u64cd\u4f5c\u5458\n5. \u90e8\u95e8\uff1a\u751f\u4ea7\u90e8\n6. \u542f\u7528\u7535\u5b50\u7b7e\u540d\uff1a\u662f\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#64","title":"6.4 \u914d\u7f6e\u7535\u5b50\u7b7e\u540d","text":"<pre><code>\u5bfc\u822a\uff1aAdministration &gt; Electronic Signature\n\n\u914d\u7f6e\u9879\uff1a\n1. \u542f\u7528\u7535\u5b50\u7b7e\u540d\uff1a\u662f\n2. \u7b7e\u540d\u7c7b\u578b\uff1a\u7528\u6237\u540d + \u5bc6\u7801\n3. \u7b7e\u540d\u539f\u56e0\uff1a\u5fc5\u586b\n4. \u7b7e\u540d\u65f6\u95f4\u6233\uff1a\u81ea\u52a8\u8bb0\u5f55\n5. \u5ba1\u8ba1\u8ffd\u8e2a\uff1a\u6240\u6709\u7b7e\u540d\u64cd\u4f5c\u8bb0\u5f55\u5230\u5ba1\u8ba1\u65e5\u5fd7\n\n\u7b26\u5408 21 CFR Part 11 \u8981\u6c42\uff1a\n- \u552f\u4e00\u6027\uff1a\u6bcf\u4e2a\u7528\u6237\u552f\u4e00\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\n- \u4e0d\u53ef\u5426\u8ba4\u6027\uff1a\u7b7e\u540d\u4e0e\u7528\u6237\u7ed1\u5b9a\uff0c\u4e0d\u53ef\u8f6c\u8ba9\n- \u5b8c\u6574\u6027\uff1a\u7b7e\u540d\u6570\u636e\u52a0\u5bc6\u5b58\u50a8\n- \u5ba1\u8ba1\u8ffd\u8e2a\uff1a\u6240\u6709\u7b7e\u540d\u64cd\u4f5c\u53ef\u8ffd\u6eaf\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#7","title":"7. \u96c6\u6210\u914d\u7f6e","text":""},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#71-lims","title":"7.1 \u4e0e LIMS \u96c6\u6210","text":"<pre><code>&lt;!-- \u914d\u7f6e\u6587\u4ef6\uff1aC:\\PAS-X\\Config\\integration\\lims.xml --&gt;\n&lt;integration&gt;\n    &lt;system&gt;\n        &lt;name&gt;LabWare LIMS&lt;/name&gt;\n        &lt;type&gt;LIMS&lt;/type&gt;\n        &lt;protocol&gt;REST&lt;/protocol&gt;\n        &lt;endpoint&gt;https://lims.pharma.local/api&lt;/endpoint&gt;\n        &lt;authentication&gt;\n            &lt;type&gt;OAuth2&lt;/type&gt;\n            &lt;clientId&gt;pasx_client&lt;/clientId&gt;\n            &lt;clientSecret&gt;encrypted_secret&lt;/clientSecret&gt;\n        &lt;/authentication&gt;\n    &lt;/system&gt;\n    &lt;mapping&gt;\n        &lt;field source=\"batch_number\" target=\"sample_id\" /&gt;\n        &lt;field source=\"product_code\" target=\"material_code\" /&gt;\n    &lt;/mapping&gt;\n&lt;/integration&gt;\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#72-scadadcs","title":"7.2 \u4e0e SCADA/DCS \u96c6\u6210","text":"<pre><code>\u652f\u6301\u7684\u534f\u8bae\uff1a\n- OPC UA\uff08\u63a8\u8350\uff09\n- OPC DA\n- Modbus TCP\n- Profinet\n\n\u914d\u7f6e\u6b65\u9aa4\uff1a\n1. \u5b89\u88c5 OPC UA \u5ba2\u6237\u7aef\u7ec4\u4ef6\n2. \u914d\u7f6e OPC UA \u670d\u52a1\u5668\u5730\u5740\n3. \u6620\u5c04\u8bbe\u5907\u6807\u7b7e\u5230 PAS-X \u53c2\u6570\n4. \u914d\u7f6e\u6570\u636e\u91c7\u96c6\u9891\u7387\n5. \u6d4b\u8bd5\u8fde\u63a5\u548c\u6570\u636e\u8bfb\u53d6\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#8","title":"8. \u9a8c\u8bc1\u4e0e\u6d4b\u8bd5","text":""},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#81-iq","title":"8.1 \u5b89\u88c5\u786e\u8ba4\uff08IQ\uff09","text":"<pre><code>\u9a8c\u8bc1\u9879\u76ee\uff1a\n\u25a1 \u786c\u4ef6\u914d\u7f6e\u7b26\u5408\u89c4\u683c\n\u25a1 \u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u6b63\u786e\n\u25a1 \u6570\u636e\u5e93\u7248\u672c\u6b63\u786e\n\u25a1 Java \u7248\u672c\u6b63\u786e\n\u25a1 Tomcat \u7248\u672c\u6b63\u786e\n\u25a1 PAS-X \u7248\u672c\u6b63\u786e\n\u25a1 \u8bb8\u53ef\u8bc1\u6709\u6548\n\u25a1 \u7f51\u7edc\u8fde\u63a5\u6b63\u5e38\n\u25a1 \u9632\u706b\u5899\u89c4\u5219\u914d\u7f6e\n\u25a1 \u5907\u4efd\u7b56\u7565\u914d\u7f6e\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#82-oq","title":"8.2 \u8fd0\u884c\u786e\u8ba4\uff08OQ\uff09","text":"<pre><code>\u9a8c\u8bc1\u9879\u76ee\uff1a\n\u25a1 \u7528\u6237\u767b\u5f55/\u767b\u51fa\n\u25a1 \u5bc6\u7801\u4fee\u6539\n\u25a1 \u89d2\u8272\u6743\u9650\u9a8c\u8bc1\n\u25a1 \u914d\u65b9\u521b\u5efa/\u4fee\u6539\n\u25a1 \u6279\u6b21\u6267\u884c\n\u25a1 \u7535\u5b50\u7b7e\u540d\n\u25a1 \u5ba1\u8ba1\u8ffd\u8e2a\n\u25a1 \u62a5\u8868\u751f\u6210\n\u25a1 \u6570\u636e\u5e93\u8fde\u63a5\n\u25a1 \u96c6\u6210\u63a5\u53e3\u6d4b\u8bd5\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#83-pq","title":"8.3 \u6027\u80fd\u786e\u8ba4\uff08PQ\uff09","text":"<pre><code>\u9a8c\u8bc1\u9879\u76ee\uff1a\n\u25a1 \u5e76\u53d1\u7528\u6237\u6d4b\u8bd5\uff0850 \u7528\u6237\uff09\n\u25a1 \u6279\u6b21\u6267\u884c\u6027\u80fd\n\u25a1 \u62a5\u8868\u751f\u6210\u901f\u5ea6\n\u25a1 \u6570\u636e\u5e93\u67e5\u8be2\u6027\u80fd\n\u25a1 \u7cfb\u7edf\u54cd\u5e94\u65f6\u95f4 &lt; 3 \u79d2\n\u25a1 \u6570\u636e\u5907\u4efd/\u6062\u590d\n\u25a1 \u6545\u969c\u5207\u6362\u6d4b\u8bd5\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#9","title":"9. \u5907\u4efd\u4e0e\u6062\u590d","text":""},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#91","title":"9.1 \u6570\u636e\u5e93\u5907\u4efd","text":"<pre><code>-- \u4f7f\u7528 RMAN \u5907\u4efd Oracle \u6570\u636e\u5e93\nRMAN&gt; BACKUP DATABASE PLUS ARCHIVELOG;\n\n-- \u6216\u4f7f\u7528 Data Pump \u5bfc\u51fa\nexpdp pasx_owner/PasxOwner@2025@PASXDB \\\n  directory=BACKUP_DIR \\\n  dumpfile=pasx_backup_%U.dmp \\\n  logfile=pasx_backup.log \\\n  full=y \\\n  compression=all\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#92","title":"9.2 \u5e94\u7528\u5907\u4efd","text":"<pre><code># \u5907\u4efd Tomcat \u914d\u7f6e\u548c\u5e94\u7528\n$backupPath = \"E:\\Backup\\PAS-X\\$(Get-Date -Format 'yyyyMMdd')\"\nNew-Item -Path $backupPath -ItemType Directory\n\n# \u5907\u4efd Tomcat\nCopy-Item -Path \"C:\\PAS-X\\Tomcat\\conf\" -Destination \"$backupPath\\Tomcat_conf\" -Recurse\nCopy-Item -Path \"C:\\PAS-X\\Tomcat\\webapps\\pasx\" -Destination \"$backupPath\\pasx_app\" -Recurse\n\n# \u5907\u4efd\u914d\u7f6e\u6587\u4ef6\nCopy-Item -Path \"C:\\PAS-X\\Config\" -Destination \"$backupPath\\Config\" -Recurse\n</code></pre>"},{"location":"biopharma/Werum-PAS-X-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C.html#10","title":"10. \u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u73af\u5883\u9694\u79bb\uff1a\u5f00\u53d1\u3001\u6d4b\u8bd5\u3001\u751f\u4ea7\u73af\u5883\u4e25\u683c\u5206\u79bb</li> <li>\u53d8\u66f4\u7ba1\u7406\uff1a\u6240\u6709\u914d\u7f6e\u53d8\u66f4\u9700\u7ecf\u8fc7\u5ba1\u6279\u548c\u9a8c\u8bc1</li> <li>\u5b9a\u671f\u5907\u4efd\uff1a\u6bcf\u5929\u5907\u4efd\u6570\u636e\u5e93\uff0c\u6bcf\u5468\u5907\u4efd\u5e94\u7528</li> <li>\u76d1\u63a7\u544a\u8b66\uff1a\u76d1\u63a7\u7cfb\u7edf\u6027\u80fd\u3001\u6570\u636e\u5e93\u8fde\u63a5\u3001\u78c1\u76d8\u7a7a\u95f4</li> <li>\u8865\u4e01\u7ba1\u7406\uff1a\u5b9a\u671f\u5b89\u88c5 PAS-X \u8865\u4e01\u548c\u5b89\u5168\u66f4\u65b0</li> <li>\u5ba1\u8ba1\u65e5\u5fd7\uff1a\u5b9a\u671f\u5ba1\u67e5\u5ba1\u8ba1\u65e5\u5fd7\uff0c\u4fdd\u7559 7 \u5e74</li> <li>\u707e\u96be\u6062\u590d\uff1a\u5236\u5b9a DR \u8ba1\u5212\uff0c\u5b9a\u671f\u6f14\u7ec3</li> <li>\u6587\u6863\u5316\uff1a\u8bb0\u5f55\u6240\u6709\u914d\u7f6e\u3001\u53d8\u66f4\u3001\u6545\u969c\u5904\u7406</li> <li>\u57f9\u8bad\uff1a\u57f9\u8bad\u7ba1\u7406\u5458\u548c\u7528\u6237\u6b63\u786e\u4f7f\u7528\u7cfb\u7edf</li> <li>\u5408\u89c4\u6027\uff1a\u786e\u4fdd\u7b26\u5408 GMP\u300121 CFR Part 11\u3001Annex 11</li> </ol> <p>\u53c2\u8003\u8d44\u6e90\uff1a - Werum PAS-X \u5b98\u65b9\u6587\u6863 - GAMP 5 \u6307\u5357 - FDA 21 CFR Part 11 - EU GMP Annex 11</p>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-01-%E6%80%BB%E8%A7%88%E4%B8%8E%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99.html","title":"\u5b9e\u9a8c\u5ba4\u4fe1\u606f\u5b66\u67b6\u6784\uff0801\uff09\u603b\u89c8\u4e0e\u8bbe\u8ba1\u539f\u5219","text":"<p>\u672c\u7cfb\u5217\u9762\u5411\u751f\u7269\u533b\u836f\u7814\u53d1/\u8d28\u63a7/\u751f\u4ea7\u573a\u666f\u4e2d\u7684\u4fe1\u606f\u5b66\u4ece\u4e1a\u8005\uff0c\u76ee\u6807\u662f\u628a\u201c\u4ece\u6837\u672c\u5230\u77e5\u8bc6\u201d\u7684\u5168\u94fe\u8def\u8bb2\u6e05\u695a\uff0c\u5e76\u7ed9\u51fa\u53ef\u843d\u5730\u7684\u67b6\u6784\u4e0e\u5b9e\u65bd\u5efa\u8bae\u3002\u672c\u7bc7\u4e3a\u603b\u89c8\u4e0e\u8bbe\u8ba1\u539f\u5219\u3002</p>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-01-%E6%80%BB%E8%A7%88%E4%B8%8E%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99.html#1","title":"1. \u4e3a\u4ec0\u4e48\u9700\u8981\u201c\u5b9e\u9a8c\u5ba4\u4fe1\u606f\u5b66\u67b6\u6784\u201d","text":"<ul> <li>\u4e1a\u52a1\u590d\u6742\uff1a\u7814\u53d1\u2192\u4e34\u5e8a\u524d\u2192CMC\u2192QA/QC\u2192\u751f\u4ea7\u2192\u836f\u7269\u8b66\u6212\uff0c\u6bcf\u4e2a\u73af\u8282\u7cfb\u7edf\u6808\u4e0d\u540c\uff0c\u4f46\u6570\u636e\u5374\u9700\u8981\u8d2f\u901a\u3002</li> <li>\u6570\u636e\u5f02\u6784\uff1aCDS/LCMS/NMR/\u751f\u5316\u5206\u6790/\u6570\u5b57\u75c5\u7406/\u6d41\u5f0f\u7b49\u4eea\u5668\u6570\u636e\u683c\u5f0f\u5404\u5f02\uff0c\u65e2\u6709\u6587\u4ef6\u53c8\u6709\u6570\u636e\u5e93\u3002</li> <li>\u5408\u89c4\u8981\u6c42\uff1a\u5ba1\u8ba1\u8ffd\u8e2a\u3001\u7535\u5b50\u7b7e\u540d\u3001\u8bb0\u5f55\u751f\u547d\u5468\u671f\u3001\u6570\u636e\u5b8c\u6574\u6027\uff08ALCOA+\uff09\u7b49\u4e0d\u53ef\u59a5\u534f\u3002</li> <li>\u4ef7\u503c\u5151\u73b0\uff1a\u7ed3\u6784\u5316\u65b9\u6cd5\u3001\u53ef\u590d\u73b0\u6d41\u7a0b\u3001\u6a21\u578b\u5316\u4e3b\u6570\u636e\uff0c\u624d\u80fd\u652f\u6491\u81ea\u52a8\u5316\u4e0e\u667a\u80fd\u5316\u3002</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-01-%E6%80%BB%E8%A7%88%E4%B8%8E%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99.html#2","title":"2. \u5168\u666f\u56fe\uff08\u7cfb\u7edf\u4e0e\u6570\u636e\u6d41\uff09","text":"<ul> <li>\u8ba1\u5212\u4e0e\u77e5\u8bc6\u5c42\uff1aELN\u3001\u65b9\u6cd5\u5e93\u3001\u914d\u65b9\u4e0e\u5de5\u827a\u3001\u77e5\u8bc6\u5e93/\u8bed\u4e49\u5c42</li> <li>\u5b9e\u9a8c\u6267\u884c\u5c42\uff1aLIMS\u3001LES/\u65b9\u6cd5\u6267\u884c\u3001\u6837\u672c/\u6279\u8bb0\u5f55\u3001\u4efb\u52a1\u4e0e\u6392\u7a0b</li> <li>\u4eea\u5668\u4e0e\u6570\u636e\u5c42\uff1aCDS/Chrom\u3001SDMS\u3001\u539f\u59cb\u6570\u636e\u843d\u5730\u4e0e\u5143\u6570\u636e\u91c7\u96c6</li> <li>\u8d28\u91cf\u4e0e\u6587\u4ef6\u5c42\uff1aQMS\u3001EDMS\u3001\u53d7\u63a7\u6587\u4ef6\u3001\u53d8\u66f4/\u504f\u5dee/CAPA</li> <li>\u751f\u4ea7\u4e0e\u8d44\u6e90\u5c42\uff1aMES/EBR\u3001\u8bbe\u5907EAM/CMMS\u3001ERP \u7269\u6599/\u8d22\u52a1</li> <li>\u5206\u6790\u4e0e\u5e73\u53f0\u5c42\uff1a\u6570\u636e\u4ed3\u5e93/\u6e56\u4ed3\u3001\u7edf\u8ba1\u4e0e\u6a21\u578b\u3001\u53ef\u89c6\u5316\u4e0e\u62a5\u8868</li> <li>\u96c6\u6210\u4e0e\u6cbb\u7406\u5c42\uff1aAPI \u7f51\u5173\u3001\u4e8b\u4ef6\u603b\u7ebf\u3001MDM \u4e3b\u6570\u636e\u3001\u6570\u636e\u6cbb\u7406\u4e0e\u5b89\u5168</li> </ul> <p>\u5178\u578b\u6570\u636e\u901a\u9053\uff1aELN \u5b9a\u4e49\u65b9\u6cd5\u2192LIMS \u751f\u6210\u6837\u672c\u4efb\u52a1\u2192\u4eea\u5668\u91c7\u96c6\u2192SDMS/\u6570\u636e\u6e56\u5165\u5e93\u2192\u7ed3\u679c\u56de\u5199 LIMS/QMS\u2192\u62a5\u8868/\u770b\u677f\u3002</p>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-01-%E6%80%BB%E8%A7%88%E4%B8%8E%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99.html#3-12","title":"3. \u6838\u5fc3\u8bbe\u8ba1\u539f\u5219\uff0812 \u6761\uff09","text":"<p>1) \u4ee5\u4e3b\u6570\u636e\u4e3a\u4e2d\u5fc3\uff1a\u6837\u672c\u3001\u9879\u76ee\u3001\u65b9\u6cd5\u3001\u89c4\u683c\u3001\u8bbe\u5907\u3001\u7528\u6237/\u89d2\u8272\u7b49\u5b9e\u4f53\u6709\u7a33\u5b9a ID \u4e0e\u751f\u547d\u5468\u671f\u3002 2) \u4ee5\u6d41\u7a0b\u9a71\u52a8\uff1a\u4ece\u201c\u91c7\u6837\u2192\u68c0\u6d4b\u2192\u590d\u6838\u2192\u653e\u884c\u201d\u7684\u72b6\u6001\u673a\u53ef\u5728\u7cfb\u7edf\u95f4\u4f20\u9012\uff0c\u907f\u514d\u5b64\u5c9b\u3002 3) \u4ee5\u5143\u6570\u636e\u5148\u884c\uff1a\u4efb\u4f55\u6587\u4ef6\u578b\u539f\u59cb\u6570\u636e\uff0c\u5148\u786e\u4fdd\u201c\u5143\u6570\u636e-\u6587\u4ef6\u201d\u8026\u5408\uff08\u547d\u540d\u3001\u6e05\u5355\u3001\u6821\u9a8c\u6307\u7eb9\uff09\u3002 4) \u4ee5\u5ba1\u8ba1\u4e0e\u7b7e\u540d\u4e3a\u5e95\u5ea7\uff1a\u8bb0\u5f55\u8c01\u5728\u4f55\u65f6\u505a\u4e86\u4ec0\u4e48\u3001\u4e3a\u4ec0\u4e48\uff08\u539f\u56e0\u7801/\u6279\u6ce8\uff09\uff0c\u4ee5\u53ca\u7535\u5b50\u7b7e\u540d\u89c4\u7ea6\u3002 5) \u4ee5\u53ef\u590d\u73b0\u4e3a\u76ee\u6807\uff1a\u65b9\u6cd5\u53c2\u6570\u3001\u7248\u672c\u3001\u73af\u5883\u3001\u4eea\u5668/\u8bd5\u5242\u6279\u53f7\uff0c\u5747\u53ef\u8ffd\u6eaf\u5e76\u590d\u8dd1\u3002 6) \u4ee5\u4e8b\u4ef6\u9a71\u52a8\u4e3a\u7ebd\u5e26\uff1a\u907f\u514d\u70b9\u5bf9\u70b9\u8026\u5408\uff0c\u7528\u4e8b\u4ef6\u6216\u53d8\u66f4\u65e5\u5fd7\u5e7f\u64ad\u72b6\u6001\u3002 7) \u4ee5\u5206\u5c42\u89e3\u8026\uff1a\u65b9\u6cd5\u7f16\u8457\uff08ELN\uff09\u4e0e\u6267\u884c\uff08LES\uff09\u89e3\u8026\uff1b\u6267\u884c\u4e0e\u7ed3\u679c\u7ba1\u7406\uff08LIMS\uff09\u89e3\u8026\u3002 8) \u4ee5\u6807\u51c6\u4f18\u5148\uff1a\u4f18\u5148\u91c7\u7528\u901a\u7528\u6570\u636e\u4e0e\u63a5\u53e3\u6807\u51c6\uff08\u4f8b\u5982 AnIML/Allotrope\u3001SiLA2\u3001OPC-UA\u3001HL7/FHIR \u5b9e\u9a8c\u76f8\u5173\u6269\u5c55\u7b49\uff09\u3002 9) \u4ee5\u6700\u5c0f\u6743\u9650\u4e3a\u8fb9\u754c\uff1a\u8eab\u4efd\u3001\u6388\u6743\u3001\u6570\u636e\u5206\u533a\uff08GxP \u4e0e\u975e GxP\uff09\u660e\u786e\u9694\u79bb\u3002 10) \u4ee5\u53ef\u89c2\u6d4b\u6027\u5efa\u8bbe\uff1a\u65e5\u5fd7\u3001\u6307\u6807\u3001\u8ffd\u8e2a\u4e0e\u5ba1\u8ba1\u4e00\u4f53\u5316\uff0c\u95ee\u9898\u5b9a\u4f4d\u53ef\u8bc1\u636e\u5316\u3002 11) \u4ee5\u9a8c\u8bc1\u4e3a\u62a4\u680f\uff1a\u9700\u6c42\u2192\u98ce\u9669\u2192\u6d4b\u8bd5\u2192\u8bc1\u636e\u2192\u53d8\u66f4\uff0c\u8d2f\u7a7f\u5168\u751f\u547d\u5468\u671f\uff08CSV/CSA\uff09\u3002 12) \u4ee5\u6f14\u8fdb\u4e3a\u8def\u7ebf\uff1a\u5148\u4ece\u201c\u53ef\u7528\u201d\u5230\u201c\u597d\u7528\u201d\uff0c\u518d\u5230\u201c\u81ea\u52a8\u5316/\u667a\u80fd\u5316\u201d\u3002</p>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-01-%E6%80%BB%E8%A7%88%E4%B8%8E%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99.html#4-raci","title":"4. \u89d2\u8272\u4e0e\u8fb9\u754c\uff08RACI \u5efa\u8bae\uff09","text":"<ul> <li>\u4e1a\u52a1\u6240\u6709\u8005\uff08PO\uff09\uff1a\u786e\u5b9a\u8303\u56f4/\u4f18\u5148\u7ea7/\u9a8c\u6536\u6807\u51c6</li> <li>\u8d28\u91cf\uff08QA/QC\uff09\uff1a\u5408\u89c4\u7b56\u7565\u3001\u6587\u63a7\u3001\u9a8c\u8bc1\u65b9\u6cd5\u8bba</li> <li>IT/\u5e73\u53f0\uff1a\u96c6\u6210\u3001\u6570\u636e\u5e73\u53f0\u3001\u8fd0\u7ef4\u4e0e\u5b89\u5168</li> <li>\u5b9e\u9a8c\u56e2\u961f\uff1a\u65b9\u6cd5\u5b66\u3001\u73b0\u573a\u6d41\u7a0b\u3001\u7528\u6237\u57f9\u8bad\u4e0eUAT</li> </ul> <p>\u5efa\u8bae\u7528 RACI \u660e\u786e\uff1a\u8c01\u8d1f\u8d23\uff08R\uff09\u3001\u8c01\u6279\u51c6\uff08A\uff09\u3001\u8c01\u534f\u4f5c\uff08C\uff09\u3001\u8c01\u77e5\u4f1a\uff08I\uff09\u3002</p>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-01-%E6%80%BB%E8%A7%88%E4%B8%8E%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99.html#5","title":"5. \u53c2\u8003\u84dd\u56fe\uff08\u6309\u57df\u5206\u5c42\uff09","text":"<ul> <li>\u5b9e\u9a8c\u57df\uff1aELN/\u65b9\u6cd5\u5e93\u3001LES\u3001LIMS\u3001\u4eea\u5668\u63a5\u5165\u9002\u914d\u5668</li> <li>\u8d28\u91cf\u57df\uff1aQMS\u3001EDMS\u3001CAPA\u3001\u504f\u5dee\u3001\u53d8\u66f4\u3001\u5ba1\u8ba1\u7ba1\u7406</li> <li>\u751f\u4ea7\u57df\uff1aMES/EBR\u3001DCS/SCADA\u3001\u8bbe\u5907\u7ef4\u4fdd\uff08EAM/CMMS\uff09</li> <li>\u6570\u636e\u57df\uff1aSDMS\u3001\u6570\u636e\u6e56/\u6e56\u4ed3\u3001\u4ed3\u5e93/\u8bed\u4e49\u5c42\u3001\u7edf\u8ba1\u4e0e\u5efa\u6a21</li> <li>\u96c6\u6210\u57df\uff1aAPI \u7f51\u5173\u3001\u4e8b\u4ef6\u603b\u7ebf\u3001ETL/ELT\u3001\u4e3b\u6570\u636e\u4e0e\u6743\u9650</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-01-%E6%80%BB%E8%A7%88%E4%B8%8E%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99.html#6-12","title":"6. \u8def\u7ebf\u56fe\uff0812 \u4e2a\u6708\u6837\u4f8b\uff09","text":"<ul> <li>0-3 \u4e2a\u6708\uff1a\u4e3b\u6570\u636e\u68b3\u7406\uff0b\u6700\u5c0f\u96c6\u6210\uff08\u4eea\u5668\u2192SDMS\u2192\u7ed3\u679c\u56de\u5199\uff09\uff0b\u9996\u6279\u65b9\u6cd5\u6570\u5b57\u5316</li> <li>4-6 \u4e2a\u6708\uff1aLES \u63a8\u5e7f\uff0b\u4e8b\u4ef6\u603b\u7ebf\u843d\u5730\uff0bQMS/EDMS \u63a5\u53e3</li> <li>7-9 \u4e2a\u6708\uff1a\u6e56\u4ed3\u4e0e\u6307\u6807\u4f53\u7cfb\uff0b\u6279\u653e\u884c\u770b\u677f\uff0b\u5408\u89c4\u5ea6\u91cf</li> <li>10-12 \u4e2a\u6708\uff1a\u7aef\u5230\u7aef\u81ea\u52a8\u5316\u95ed\u73af\uff08\u4efb\u52a1\u2192\u6267\u884c\u2192\u590d\u6838\u2192\u653e\u884c\uff09\uff0b\u90e8\u5206 AI/\u7edf\u8ba1\u6a21\u5757</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-01-%E6%80%BB%E8%A7%88%E4%B8%8E%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99.html#7","title":"7. \u5e38\u89c1\u8bef\u533a\u4e0e\u5bf9\u7b56","text":"<ul> <li>\u8bef\u533a\uff1a\u5148\u201c\u5927\u5e73\u53f0\u201d\u540e\u201c\u573a\u666f\u201d\uff0c\u5bfc\u81f4\u843d\u5730\u6162\u3002\u5bf9\u7b56\uff1a\u4ee5\u201c\u65b9\u6cd5/\u6d41\u7a0b\u201d\u5207\u5165\uff0c\u7528\u4ea7\u51fa\u5012\u63a8\u3002</li> <li>\u8bef\u533a\uff1a\u6587\u4ef6\u9a71\u52a8\u3001\u65e0\u5143\u6570\u636e\u3002\u5bf9\u7b56\uff1a\u5f3a\u5236\u547d\u540d\u4e0e\u6e05\u5355\u3001\u5d4c\u5165\u5143\u6570\u636e\u6536\u96c6\u3002</li> <li>\u8bef\u533a\uff1a\u70b9\u5bf9\u70b9\u96c6\u6210\u3002\u5bf9\u7b56\uff1a\u4e8b\u4ef6/\u4e3b\u9898\u4e0e API \u7f51\u5173\u3002</li> <li>\u8bef\u533a\uff1a\u5ffd\u7565\u9a8c\u8bc1\u8bc1\u636e\u3002\u5bf9\u7b56\uff1a\u9700\u6c42\u4e0e\u6d4b\u8bd5\u53ef\u8ffd\u8e2a\uff0c\u81ea\u52a8\u6536\u96c6\u8fd0\u884c\u8bc1\u636e\u3002</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-01-%E6%80%BB%E8%A7%88%E4%B8%8E%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99.html#8","title":"8. \u4ea7\u51fa\u6e05\u5355\uff08\u843d\u5730\u5373\u5f97\uff09","text":"<ul> <li>\u7cfb\u7edf/\u6d41\u7a0b\u84dd\u56fe\u3001\u4e3b\u6570\u636e\u5b57\u5178\u3001\u4e8b\u4ef6\u4e0e\u63a5\u53e3\u76ee\u5f55\u3001\u65b9\u6cd5\u6a21\u677f\u4e0e\u53c2\u6570\u6e05\u5355\u3001\u4eea\u5668\u9002\u914d\u5668\u6e05\u5355\u3001\u9a8c\u8bc1\u77e9\u9635\u4e0e\u8bc1\u636e\u5e93\u3002</li> </ul> <p>\u2014\u2014 \u672c\u6587\u4e3a\u7cfb\u5217\u7b2c 01 \u7bc7\uff0c\u4e0b\u4e00\u7bc7\uff1aLIMS \u8bbe\u8ba1\u4e0e\u4e3b\u6570\u636e\u6cbb\u7406\u3002</p>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-02-LIMS%E4%B8%8E%E4%B8%BB%E6%95%B0%E6%8D%AE%E6%B2%BB%E7%90%86.html","title":"\u5b9e\u9a8c\u5ba4\u4fe1\u606f\u5b66\u67b6\u6784\uff0802\uff09LIMS \u4e0e\u4e3b\u6570\u636e\u6cbb\u7406","text":"<p>\u672c\u6587\u805a\u7126\u6837\u672c\u5230\u7ed3\u679c\u7684\u201c\u4e3b\u94fe\u8def\u201d\u4e0e LIMS \u6570\u636e\u6a21\u578b/\u6d41\u7a0b\u8bbe\u8ba1\uff0c\u5e76\u7ed9\u51fa\u5b9e\u4f53\u4e0e\u72b6\u6001\u673a\u793a\u4f8b\u3002</p>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-02-LIMS%E4%B8%8E%E4%B8%BB%E6%95%B0%E6%8D%AE%E6%B2%BB%E7%90%86.html#1","title":"1. \u5173\u952e\u5b9e\u4f53\uff08\u5efa\u8bae\u6700\u5c0f\u96c6\u5408\uff09","text":"<ul> <li>Project/Study\uff1a\u9879\u76ee/\u7814\u7a76</li> <li>Sample\uff1a\u6837\u672c\uff08\u5c42\u7ea7\uff1a\u7236\u6837\u672c\u2192\u5b50\u6837\u672c/\u5206\u88c5 Aliquot\uff09</li> <li>Container\uff1a\u5bb9\u5668/\u677f\u4f4d\uff08\u6761\u7801/\u4f4d\u7f6e\uff09</li> <li>Method/Procedure\uff1a\u5206\u6790\u65b9\u6cd5/\u6d41\u7a0b\uff08\u7248\u672c\u5316\uff09</li> <li>Test\uff1a\u68c0\u6d4b\u9879\uff08\u4e0e\u65b9\u6cd5/\u53c2\u6570\u7ed1\u5b9a\uff09</li> <li>Specification\uff1a\u89c4\u683c/\u5224\u5b9a\u89c4\u5219\uff08\u7248\u672c\u5316\uff09</li> <li>Instrument\uff1a\u4eea\u5668/\u901a\u9053/\u65b9\u6cd5\u6a21\u677f</li> <li>Result\uff1a\u7ed3\u679c\uff08\u539f\u59cb/\u8ba1\u7b97/\u590d\u6838\u72b6\u6001\uff09</li> <li>User/Role\uff1a\u4eba\u5458\u4e0e\u6743\u9650</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-02-LIMS%E4%B8%8E%E4%B8%BB%E6%95%B0%E6%8D%AE%E6%B2%BB%E7%90%86.html#2","title":"2. \u5178\u578b\u6d41\u7a0b\u4e0e\u72b6\u6001\u673a","text":"<ul> <li>\u63a5\u6536/\u767b\u5f55\uff08Accession\uff09\u2192 \u5206\u914d/\u6392\u7a0b \u2192 \u91c7\u96c6/\u5236\u5907 \u2192 \u6267\u884c\uff08Run\uff09\u2192 \u521d\u5ba1 \u2192 \u590d\u6838/\u653e\u884c</li> <li>\u72b6\u6001\u673a\u793a\u4f8b\uff1aCreated \u2192 Received \u2192 InProgress \u2192 PendingReview \u2192 Approved/Rejected \u2192 Archived</li> <li>CoC\uff08Chain of Custody\uff09\uff1a\u8bb0\u5f55\u6837\u672c\u5728\u6bcf\u4e00\u6b65\u7684\u8d23\u4efb\u4eba/\u65f6\u95f4/\u5730\u70b9</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-02-LIMS%E4%B8%8E%E4%B8%BB%E6%95%B0%E6%8D%AE%E6%B2%BB%E7%90%86.html#3","title":"3. \u6570\u636e\u6a21\u578b\u793a\u4f8b\uff08\u7247\u6bb5\uff09","text":"<pre><code>{\n  \"sample\": {\n    \"id\": \"S-2025-000123\",\n    \"parent_id\": null,\n    \"project\": \"P-CMC-001\",\n    \"container\": \"TUBE-000789\",\n    \"method\": \"HPLC-ASSAY@v3\",\n    \"tests\": [\"ASSAY\", \"ID\", \"IMPURITY\"],\n    \"status\": \"InProgress\"\n  },\n  \"result\": {\n    \"test\": \"ASSAY\",\n    \"value\": 99.3,\n    \"unit\": \"%\",\n    \"calc\": {\"type\": \"mean\", \"n\": 3},\n    \"spec\": {\"lower\": 97.0, \"upper\": 103.0},\n    \"review\": {\"by\": \"analystA\", \"time\": \"2025-11-11T10:20:00Z\"}\n  }\n}\n</code></pre>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-02-LIMS%E4%B8%8E%E4%B8%BB%E6%95%B0%E6%8D%AE%E6%B2%BB%E7%90%86.html#4-mdm","title":"4. \u4e3b\u6570\u636e\u6cbb\u7406\uff08MDM \u8981\u70b9\uff09","text":"<ul> <li>\u547d\u540d\u4e0e\u7f16\u7801\uff1a\u6837\u672c\u3001\u65b9\u6cd5\u3001\u89c4\u683c\u3001\u8bbe\u5907\u3001\u4f4d\u7f6e\u3001\u6279\u6b21\uff0c\u7edf\u4e00\u7f16\u7801\u89c4\u5219\u4e0e\u6821\u9a8c\u3002</li> <li>\u53d8\u66f4\u4e0e\u7248\u672c\uff1a\u65b9\u6cd5\u4e0e\u89c4\u683c\u5fc5\u987b\u7248\u672c\u5316\uff0c\u65e7\u6279\u8bb0\u5f55\u53ef\u8ffd\u6eaf\u3002</li> <li>\u5171\u4eab\u5b57\u5178\uff1a\u5355\u4f4d\u3001\u77e9\u9635\u3001\u5206\u6790\u901a\u9053\u3001\u539f\u56e0\u7801\uff0c\u96c6\u4e2d\u7ef4\u62a4\u3002</li> <li>\u6279\u5904\u7406\u4e0e\u6a21\u677f\uff1a\u6279\u8bb0\u5f55\u6a21\u677f\u4e0e\u53c2\u6570\u5316\u6267\u884c\uff08\u65b9\u6cd5\u53c2\u6570/\u8bbe\u5907\u53c2\u6570/\u8017\u6750\u6279\u53f7\uff09\u3002</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-02-LIMS%E4%B8%8E%E4%B8%BB%E6%95%B0%E6%8D%AE%E6%B2%BB%E7%90%86.html#5-lims","title":"5. \u5408\u89c4\u8981\u70b9\uff08LIMS \u89c6\u89d2\uff09","text":"<ul> <li>\u5ba1\u8ba1\u8ffd\u8e2a\uff1a\u521b\u5efa/\u4fee\u6539/\u5220\u9664\u5747\u8bb0\u5f55\u201c\u8c01/\u4f55\u65f6/\u4f55\u56e0/\u524d\u540e\u503c\u201d\u3002</li> <li>\u7535\u5b50\u7b7e\u540d\uff1a\u7b7e\u6838\u94fe\u5b9a\u4e49\uff0c\u53cc\u7b7e/\u590d\u6838\u7b56\u7565\u53ef\u914d\u7f6e\u3002</li> <li>\u8bb0\u5f55\u4fdd\u7559\uff1a\u7ed3\u679c\u3001\u539f\u59cb\u6570\u636e\u6307\u7eb9\uff08\u54c8\u5e0c\uff09\u3001\u9644\u4ef6\u4e0e\u6e05\u5355\u53d7\u63a7\u3002</li> <li>\u6743\u9650\u6700\u5c0f\u5316\uff1a\u89d2\u8272-\u6743\u9650\u77e9\u9635\uff0c\u5206\u533a GxP \u4e0e\u975e GxP \u73af\u5883\u3002</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-02-LIMS%E4%B8%8E%E4%B8%BB%E6%95%B0%E6%8D%AE%E6%B2%BB%E7%90%86.html#6","title":"6. \u4e0e\u5468\u8fb9\u7cfb\u7edf\u7684\u8fb9\u754c","text":"<ul> <li>\u4e0e ELN\uff1a\u65b9\u6cd5\u5b9a\u4e49\u4e0e\u53c2\u6570\u4e0b\u53d1</li> <li>\u4e0e LES\uff1a\u65b9\u6cd5\u6267\u884c\u4e0e\u6b65\u9aa4\u6570\u636e\u56de\u4f20</li> <li>\u4e0e SDMS\uff1a\u539f\u59cb\u6570\u636e/\u62a5\u544a\u843d\u5730\u4e0e\u94fe\u63a5</li> <li>\u4e0e QMS\uff1a\u504f\u5dee/\u53d8\u66f4/\u57f9\u8bad\u5bf9\u63a5</li> <li>\u4e0e MES\uff1a\u653e\u884c\u4e0e\u72b6\u6001\u540c\u6b65</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-02-LIMS%E4%B8%8E%E4%B8%BB%E6%95%B0%E6%8D%AE%E6%B2%BB%E7%90%86.html#7","title":"7. \u5b9e\u65bd\u6e05\u5355\uff08\u6700\u5c0f\u53ef\u7528\uff09","text":"<ul> <li>\u6837\u672c/\u65b9\u6cd5/\u89c4\u683c\u4e3b\u6570\u636e\u4e0a\u7ebf\u3001\u7f16\u7801\u89c4\u5219\u4e0e\u6821\u9a8c\u3001\u9996\u6279\u65b9\u6cd5\u6a21\u677f\u3001\u7ed3\u679c\u56de\u5199\u4e0e\u590d\u6838\u95ed\u73af\u3001\u4eea\u5668/SDMS \u8fde\u63a5\u4e00\u6761\u94fe\u8def\u3001\u62a5\u8868\u4e0e\u770b\u677f 1-2 \u4e2a\u3002</li> </ul> <p>\u2014\u2014 \u7cfb\u5217\u7b2c 02 \u7bc7\uff0c\u4e0b\u4e00\u7bc7\uff1aELN\u3001\u65b9\u6cd5\u6570\u5b57\u5316\u4e0e LES\u3002</p>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-03-ELN%E6%96%B9%E6%B3%95%E6%95%B0%E5%AD%97%E5%8C%96%E4%B8%8ELES.html","title":"\u5b9e\u9a8c\u5ba4\u4fe1\u606f\u5b66\u67b6\u6784\uff0803\uff09ELN\u3001\u65b9\u6cd5\u6570\u5b57\u5316\u4e0e LES","text":"<p>\u628a\u201c\u5b9e\u9a8c\u8bb0\u5f55\u201d\u53d8\u4e3a\u201c\u7ed3\u6784\u5316\u65b9\u6cd5\u4e0e\u6570\u636e\u201d\uff0c\u662f\u53ef\u590d\u73b0\u4e0e\u81ea\u52a8\u5316\u7684\u524d\u63d0\u3002\u672c\u7bc7\u805a\u7126 ELN\uff08\u7535\u5b50\u5b9e\u9a8c\u8bb0\u5f55\uff09\u4e0e LES\uff08\u65b9\u6cd5\u6267\u884c\u7cfb\u7edf\uff09\u3002</p>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-03-ELN%E6%96%B9%E6%B3%95%E6%95%B0%E5%AD%97%E5%8C%96%E4%B8%8ELES.html#1","title":"1. \u4ece\u81ea\u7531\u8bb0\u5f55\u5230\u7ed3\u6784\u5316\u65b9\u6cd5","text":"<ul> <li>\u81ea\u7531\u6587\u672c\u2192\u6a21\u677f\u5316\u2192\u53c2\u6570\u5316\u2192\u7a0b\u5e8f\u5316\uff08\u5e26\u6821\u9a8c\u4e0e\u8ba1\u7b97\uff09</li> <li>\u6a21\u677f\u8981\u7d20\uff1a\u76ee\u7684\u3001\u9002\u7528\u8303\u56f4\u3001\u4eea\u5668/\u8017\u6750\u3001\u8bd5\u5242/\u6807\u51c6\u54c1\u3001\u6b65\u9aa4\u4e0e\u53c2\u6570\u3001\u8ba1\u7b97\u4e0e\u5224\u5b9a\u3001\u504f\u5dee\u4e0e\u5f02\u5e38\u5904\u7406</li> <li>\u7248\u672c\u5316\uff1a\u65b9\u6cd5/\u6a21\u677f\u5fc5\u987b\u7248\u672c\u5316\uff0c\u5b9e\u9a8c\u6309\u7248\u672c\u5b9e\u4f8b\u5316</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-03-ELN%E6%96%B9%E6%B3%95%E6%95%B0%E5%AD%97%E5%8C%96%E4%B8%8ELES.html#2","title":"2. \u53c2\u6570\u4e0e\u6b65\u9aa4\u5efa\u6a21","text":"<ul> <li>\u53c2\u6570\u7c7b\u578b\uff1a\u6570\u503c\u3001\u679a\u4e3e\u3001\u5e03\u5c14\u3001\u6587\u4ef6\u3001\u5e8f\u5217\uff08\u591a\u6b21\u91c7\u96c6\uff09</li> <li>\u7ea6\u675f\uff1a\u8303\u56f4\u3001\u7cbe\u5ea6\u3001\u4f9d\u8d56\u3001\u5fc5\u586b/\u6761\u4ef6\u5fc5\u586b</li> <li>\u6b65\u9aa4\uff1a\u51c6\u5907\u2192\u6821\u51c6\u2192\u91c7\u96c6\u2192\u8ba1\u7b97\u2192\u590d\u6838</li> <li>\u8ba1\u7b97\uff1a\u5185\u7f6e\u51fd\u6570\u6216\u811a\u672c\uff08\u53d7\u63a7\uff09\uff0c\u8f93\u51fa\u53ef\u8ffd\u6eaf</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-03-ELN%E6%96%B9%E6%B3%95%E6%95%B0%E5%AD%97%E5%8C%96%E4%B8%8ELES.html#3-les","title":"3. LES\uff1a\u8ba9\u201c\u6267\u884c\u201d\u53ef\u63a7\u3001\u53ef\u8bc1\u636e\u5316","text":"<ul> <li>\u6b65\u9aa4\u9a71\u52a8\uff1a\u6307\u4ee4\u3001\u91c7\u96c6\u3001\u6821\u9a8c\u3001\u5224\u5b9a\u3001\u5206\u652f</li> <li>\u5373\u65f6\u6821\u9a8c\uff1a\u5355\u4f4d/\u8303\u56f4/\u683c\u5f0f/\u903b\u8f91\u6821\u9a8c</li> <li>\u8bbe\u5907\u8054\u52a8\uff1a\u89e6\u53d1\u4eea\u5668\u65b9\u6cd5\u3001\u8bfb\u53d6\u901a\u9053\u6570\u636e\u3001\u91c7\u96c6\u65e5\u5fd7</li> <li>\u8bc1\u636e\u6c89\u6dc0\uff1a\u6bcf\u6b65\u4ea7\u51fa\u7ed3\u6784\u5316\u8bb0\u5f55\u4e0e\u9644\u4ef6\u6e05\u5355\u3001\u81ea\u52a8\u751f\u6210\u5ba1\u8ba1\u4e0e\u62a5\u544a</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-03-ELN%E6%96%B9%E6%B3%95%E6%95%B0%E5%AD%97%E5%8C%96%E4%B8%8ELES.html#4-limssdms","title":"4. \u4e0e LIMS/SDMS \u7684\u914d\u5408","text":"<ul> <li>\u5165\u53e3\uff1aLIMS \u4e0b\u8fbe\u4efb\u52a1/\u6837\u672c\u6e05\u5355</li> <li>\u6267\u884c\uff1aLES \u7ed1\u5b9a\u65b9\u6cd5\u7248\u672c\u4e0e\u53c2\u6570\u5b9e\u4f8b</li> <li>\u4ea7\u51fa\uff1a\u7ed3\u679c\u4e0e\u6587\u4ef6\uff08\u5e26\u5143\u6570\u636e\uff09\u63a8\u9001\u56de LIMS / SDMS\uff08\u5efa\u7acb\u53ef\u8ffd\u8e2a\u94fe\u63a5\uff09</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-03-ELN%E6%96%B9%E6%B3%95%E6%95%B0%E5%AD%97%E5%8C%96%E4%B8%8ELES.html#5","title":"5. \u8d28\u91cf\u4e0e\u5408\u89c4\uff08\u65b9\u6cd5\u5c42\uff09","text":"<ul> <li>\u53cc\u4eba\u590d\u6838/\u5173\u952e\u6b65\u9aa4\u53cc\u7b7e</li> <li>\u5173\u952e\u53c2\u6570\u9501\u5b9a\u4e0e\u53d8\u66f4\u5ba1\u6279</li> <li>\u8ba1\u7b97\u811a\u672c\u53d7\u63a7\u4e0e\u9a8c\u8bc1\u8bc1\u636e</li> <li>\u504f\u5dee\u6355\u6349\u4e0e CAPA \u95ed\u73af</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-03-ELN%E6%96%B9%E6%B3%95%E6%95%B0%E5%AD%97%E5%8C%96%E4%B8%8ELES.html#6","title":"6. \u6700\u5c0f\u6a21\u677f\u793a\u4f8b\uff08\u7247\u6bb5\uff09","text":"<pre><code>{\n  \"template\": \"HPLC-Assay\",\n  \"version\": 3,\n  \"steps\": [\n    {\"name\": \"\u6821\u51c6\", \"params\": [{\"name\": \"\u6807\u51c6\u6eb6\u6db2\u6d53\u5ea6\", \"type\": \"number\", \"unit\": \"mg/mL\", \"range\": [0.8, 1.2]}]},\n    {\"name\": \"\u8fdb\u6837\", \"params\": [{\"name\": \"\u8fdb\u6837\u4f53\u79ef\", \"type\": \"number\", \"unit\": \"uL\", \"range\": [5, 20]}]},\n    {\"name\": \"\u8ba1\u7b97\", \"calc\": \"ASSAY = (\u5cf0\u9762\u79ef/\u6807\u51c6\u66f2\u7ebf)*100\"}\n  ]\n}\n</code></pre>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-03-ELN%E6%96%B9%E6%B3%95%E6%95%B0%E5%AD%97%E5%8C%96%E4%B8%8ELES.html#7","title":"7. \u843d\u5730\u5efa\u8bae","text":"<ul> <li>\u4ece 1-2 \u4e2a\u9ad8\u9891\u65b9\u6cd5\u8d77\u6b65\uff0c\u4f18\u5148\u786c\u7ea6\u675f\uff08\u8303\u56f4/\u5355\u4f4d\uff09\uff0c\u9010\u6b65\u5f15\u5165\u811a\u672c\u4e0e\u4eea\u5668\u8054\u52a8</li> <li>\u7528\u201c\u53c2\u6570-\u8bc1\u636e-\u7ed3\u679c\u201d\u4e09\u5143\u7ec4\u68c0\u67e5\u53ef\u590d\u73b0\u6027</li> </ul> <p>\u2014\u2014 \u7cfb\u5217\u7b2c 03 \u7bc7\uff0c\u4e0b\u4e00\u7bc7\uff1a\u4eea\u5668\u6570\u636e\u3001CDS \u4e0e SDMS\u3001\u6570\u636e\u6e56\u3002</p>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-04-%E4%BB%AA%E5%99%A8%E6%95%B0%E6%8D%AECDS%E4%B8%8ESDMS%E6%95%B0%E6%8D%AE%E6%B9%96.html","title":"\u5b9e\u9a8c\u5ba4\u4fe1\u606f\u5b66\u67b6\u6784\uff0804\uff09\u4eea\u5668\u6570\u636e\u3001CDS \u4e0e SDMS\u3001\u6570\u636e\u6e56","text":"<p>\u4eea\u5668\u662f\u6570\u636e\u7684\u6e90\u5934\uff1a\u5982\u4f55\u7a33\u5b9a\u91c7\u96c6\u3001\u6807\u51c6\u5316\u5143\u6570\u636e\u3001\u957f\u671f\u53ef\u7528\u4e0e\u53ef\u518d\u5206\u6790\uff0c\u662f\u672c\u7bc7\u91cd\u70b9\u3002</p>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-04-%E4%BB%AA%E5%99%A8%E6%95%B0%E6%8D%AECDS%E4%B8%8ESDMS%E6%95%B0%E6%8D%AE%E6%B9%96.html#1","title":"1. \u6570\u636e\u6765\u6e90\u4e0e\u91c7\u96c6\u6a21\u5f0f","text":"<ul> <li>\u63a7\u5236\u8f6f\u4ef6\u76f4\u51fa\uff08CDS/\u63a7\u5236\u8f6f\u4ef6\u5bfc\u51fa\uff09\uff1a\u7ed3\u679c\u4e0e\u62a5\u544a\u6587\u4ef6</li> <li>\u539f\u59cb\u901a\u9053/\u8c31\u56fe\uff1a\u9700\u4fdd\u7559\u539f\u59cb\u3001\u5904\u7406\u3001\u62a5\u544a\u591a\u5c42\u7ea7</li> <li>\u9002\u914d\u5668\uff1a\u6587\u4ef6\u5939\u76d1\u542c\u3001\u9a71\u52a8/SDK\u3001\u7f51\u7edc\u534f\u8bae\uff08\u5982 OPC-UA\u3001SiLA2\uff09</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-04-%E4%BB%AA%E5%99%A8%E6%95%B0%E6%8D%AECDS%E4%B8%8ESDMS%E6%95%B0%E6%8D%AE%E6%B9%96.html#2-sdms","title":"2. SDMS \u7684\u804c\u8d23","text":"<ul> <li>\u843d\u5730\uff1a\u5c06\u539f\u59cb\u6587\u4ef6\u6309\u7b56\u7565\u5199\u5165\u53d7\u63a7\u5b58\u50a8\uff08\u4e0d\u53ef\u7be1\u6539\u7b56\u7565+\u6307\u7eb9\uff09</li> <li>\u5143\u6570\u636e\uff1a\u6587\u4ef6\u540d\u89c4\u8303\u3001\u4f34\u968f JSON/CSV \u6e05\u5355\u3001\u76ee\u5f55\u5c42\u7ea7\u7f16\u7801</li> <li>\u6e05\u5355\u4e0e\u6eaf\u6e90\uff1a\u6837\u672c/\u65b9\u6cd5/\u6279\u6b21/\u8bbe\u5907/\u65f6\u95f4\u7b49\u952e\uff0c\u5efa\u7acb\u94fe\u63a5\u56de LIMS/LES</li> <li>\u751f\u547d\u5468\u671f\uff1a\u4fdd\u7559/\u5f52\u6863/\u51bb\u7ed3/\u9500\u6bc1\u7b56\u7565\u4e0e\u5ba1\u6279</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-04-%E4%BB%AA%E5%99%A8%E6%95%B0%E6%8D%AECDS%E4%B8%8ESDMS%E6%95%B0%E6%8D%AE%E6%B9%96.html#3","title":"3. \u5143\u6570\u636e\u4e0e\u547d\u540d\u793a\u4f8b","text":"<pre><code>/&lt;domain&gt;/&lt;year&gt;/&lt;project&gt;/&lt;instrument&gt;/&lt;method&gt;@v3/\n  S-2025-000123_ASSAY_Run001/\n    raw/  (\u5382\u5546\u539f\u59cb)\n    proc/ (\u5904\u7406\u7ed3\u679c)\n    rpt/  (\u62a5\u544a\u4e0e\u7b7e\u540d)\n    manifest.json  (\u5143\u6570\u636e\u4e0e\u6307\u7eb9)\n</code></pre> <p>manifest.json \u7247\u6bb5\uff1a</p> <pre><code>{\n  \"sample\": \"S-2025-000123\",\n  \"method\": \"HPLC-ASSAY@v3\",\n  \"instrument\": \"HPLC-01\",\n  \"run\": 1,\n  \"hash\": {\"raw\": \"sha256:...\", \"rpt\": \"sha256:...\"},\n  \"created_at\": \"2025-11-11T10:20:00Z\"\n}\n</code></pre>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-04-%E4%BB%AA%E5%99%A8%E6%95%B0%E6%8D%AECDS%E4%B8%8ESDMS%E6%95%B0%E6%8D%AE%E6%B9%96.html#4","title":"4. \u6570\u636e\u6e56/\u6e56\u4ed3\u4e0e\u518d\u5206\u6790","text":"<ul> <li>\u539f\u59cb\u4e0e\u5904\u7406\u5206\u5c42\u3001\u51b7\u70ed\u5206\u5c42</li> <li>\u7ed3\u6784\u5316/\u534a\u7ed3\u6784\u5316\uff08Parquet/Delta/Iceberg\uff09</li> <li>\u6807\u7b7e\u4e0e\u6743\u9650\uff1a\u6837\u672c/\u9879\u76ee/\u654f\u611f\u7ea7\u522b\u6807\u7b7e\u8d2f\u7a7f</li> <li>\u518d\u5206\u6790\uff1a\u91cd\u5904\u7406\u7ba1\u7ebf\u3001\u53ef\u8ffd\u6eaf\u73af\u5883\u955c\u50cf\uff08\u5bb9\u5668\u5316/Notebook\uff09</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-04-%E4%BB%AA%E5%99%A8%E6%95%B0%E6%8D%AECDS%E4%B8%8ESDMS%E6%95%B0%E6%8D%AE%E6%B9%96.html#5","title":"5. \u6807\u51c6\u4e0e\u4e92\u64cd\u4f5c","text":"<ul> <li>\u683c\u5f0f\u4e0e\u6a21\u578b\uff1aAnIML\u3001Allotrope\u3001mzML\u3001nmrML \u7b49</li> <li>\u63a5\u53e3\u4e0e\u534f\u8bae\uff1aSiLA2\u3001OPC-UA\u3001REST/Webhook\u3001\u6d88\u606f\u961f\u5217</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-04-%E4%BB%AA%E5%99%A8%E6%95%B0%E6%8D%AECDS%E4%B8%8ESDMS%E6%95%B0%E6%8D%AE%E6%B9%96.html#6","title":"6. \u8d28\u91cf\u4e0e\u5b89\u5168","text":"<ul> <li>\u9632\u7be1\u6539\u4e0e\u53ea\u8bfb\u4fdd\u7559\u7b56\u7565</li> <li>\u6307\u7eb9\u4e0e\u5b8c\u6574\u6027\u6821\u9a8c\uff08hash/\u7b7e\u540d\uff09</li> <li>\u5ba1\u8ba1\u4e0e\u8bbf\u95ee\u63a7\u5236\u65e5\u5fd7</li> </ul> <p>\u2014\u2014 \u7cfb\u5217\u7b2c 04 \u7bc7\uff0c\u4e0b\u4e00\u7bc7\uff1a\u5408\u89c4\u4e0e\u9a8c\u8bc1\uff0821 CFR Part 11 / Annex 11\u3001CSV/CSA\uff09\u3002</p>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-05-%E5%90%88%E8%A7%84%E4%B8%8E%E9%AA%8C%E8%AF%81-21CFRPart11-Annex11-CSV-CSA.html","title":"\u5b9e\u9a8c\u5ba4\u4fe1\u606f\u5b66\u67b6\u6784\uff0805\uff09\u5408\u89c4\u4e0e\u9a8c\u8bc1\uff1a21 CFR Part 11 / Annex 11 \u4e0e CSV/CSA","text":"<p>\u5408\u89c4\u4e0d\u662f\u201c\u4e0a\u7ebf\u540e\u518d\u8865\u6587\u6863\u201d\uff0c\u800c\u662f\u7cfb\u7edf\u8bbe\u8ba1\u7684\u4e00\u90e8\u5206\u3002\u672c\u7bc7\u7ed9\u51fa\u5173\u952e\u63a7\u5236\u70b9\u4e0e\u9a8c\u8bc1\u843d\u5730\u6e05\u5355\u3002</p>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-05-%E5%90%88%E8%A7%84%E4%B8%8E%E9%AA%8C%E8%AF%81-21CFRPart11-Annex11-CSV-CSA.html#1-alcoa","title":"1. \u6570\u636e\u5b8c\u6574\u6027\uff08ALCOA+\uff09\u5230\u63a7\u5236\u70b9\u6620\u5c04","text":"<ul> <li>Attributable \u53ef\u5f52\u5c5e \u2192 \u8eab\u4efd\u4e0e\u6743\u9650\u3001\u5ba1\u8ba1\u3001\u8d23\u4efb\u4eba</li> <li>Legible \u6e05\u6670\u53ef\u8bfb \u2192 \u8bb0\u5f55\u683c\u5f0f\u3001\u7248\u672c/\u7b7e\u540d\u3001\u6c34\u5370</li> <li>Contemporaneous \u540c\u6b65 \u2192 \u65f6\u95f4\u6233/\u65f6\u533a\u3001\u81ea\u52a8\u8bb0\u5f55</li> <li>Original \u539f\u59cb \u2192 \u539f\u59cb\u6587\u4ef6\u4e0e\u6307\u7eb9\u3001\u53ea\u8bfb\u4fdd\u7559</li> <li>Accurate \u51c6\u786e \u2192 \u6821\u9a8c\u89c4\u5219\u3001\u53cc\u5f55\u5165\u5bf9\u6bd4\u3001\u8ba1\u7b97\u6821\u9a8c</li> <li>+\uff08\u5b8c\u6574\u3001\u6301\u4e45\u3001\u53ef\u7528\uff09</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-05-%E5%90%88%E8%A7%84%E4%B8%8E%E9%AA%8C%E8%AF%81-21CFRPart11-Annex11-CSV-CSA.html#2-21-cfr-part-11-annex-11","title":"2. 21 CFR Part 11 / Annex 11 \u5173\u952e\u6761\u6b3e\u8981\u70b9","text":"<ul> <li>\u7535\u5b50\u7b7e\u540d\uff1a\u552f\u4e00\u6027\u3001\u4e24\u56e0\u7d20/\u53cc\u7b7e\u3001\u8bc1\u636e\u4fdd\u7559</li> <li>\u5ba1\u8ba1\u8ffd\u8e2a\uff1a\u4e0d\u53ef\u7f16\u8f91\u3001\u5185\u5bb9\u5168\u9762\u3001\u65f6\u949f\u53ef\u4fe1</li> <li>\u8bb0\u5f55\u751f\u547d\u5468\u671f\uff1a\u521b\u5efa\u2192\u4fee\u6539\u2192\u590d\u6838\u2192\u5f52\u6863/\u4fdd\u7559/\u9500\u6bc1</li> <li>\u7cfb\u7edf\u63a7\u5236\uff1a\u8bbf\u95ee\u63a7\u5236\u3001\u4f1a\u8bdd\u3001\u6743\u9650\u77e9\u9635\u3001\u914d\u7f6e\u53d7\u63a7</li> <li>\u4f9b\u5e94\u5546\u8bc4\u4f30\u4e0e\u53d8\u66f4\uff1a\u7248\u672c\u53d8\u66f4\u8bc4\u4f30\u3001\u8865\u4e01/\u6f0f\u6d1e\u7ba1\u7406</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-05-%E5%90%88%E8%A7%84%E4%B8%8E%E9%AA%8C%E8%AF%81-21CFRPart11-Annex11-CSV-CSA.html#3-csvcsa","title":"3. CSV/CSA \u5b9e\u8df5\uff08\u98ce\u9669\u4e3a\u7eb2\uff09","text":"<ul> <li>\u4ece\u201c\u5168\u90e8\u6d4b\u8bd5\u201d\u8f6c\u4e3a\u201c\u98ce\u9669\u5bfc\u5411\u6d4b\u8bd5\u201d\uff0c\u628a\u7cbe\u529b\u82b1\u5728\u9ad8\u98ce\u9669\u529f\u80fd</li> <li>V \u5f62\u6216 V&amp;V\uff1a\u9700\u6c42\u2192\u8bbe\u8ba1\u2192\u5b9e\u73b0\u2192\u6d4b\u8bd5\u2192\u4e0a\u7ebf\u2192\u8fd0\u884c\u8bc1\u636e</li> <li>\u5de5\u4ef6\u77e9\u9635\uff1aURS/FRS/DS\u3001RA\u3001TM\u3001IQ/OQ/PQ\u3001SOP\u3001\u57f9\u8bad\u8bb0\u5f55</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-05-%E5%90%88%E8%A7%84%E4%B8%8E%E9%AA%8C%E8%AF%81-21CFRPart11-Annex11-CSV-CSA.html#4","title":"4. \u9a8c\u8bc1\u8bc1\u636e\u81ea\u52a8\u5316","text":"<ul> <li>\u6784\u5efa\u53ef\u91cd\u653e\u6d4b\u8bd5\u4e0e\u73af\u5883\u3001\u81ea\u52a8\u6536\u96c6\u8fd0\u884c\u8bc1\u636e\uff08\u65e5\u5fd7\u3001\u5ba1\u8ba1\u3001\u622a\u56fe/\u62a5\u544a\uff09</li> <li>\u8ffd\u6eaf\u77e9\u9635\u81ea\u52a8\u751f\u6210\uff08\u9700\u6c42\u2192\u6d4b\u8bd5\u2192\u8bc1\u636e\u94fe\u63a5\uff09</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-05-%E5%90%88%E8%A7%84%E4%B8%8E%E9%AA%8C%E8%AF%81-21CFRPart11-Annex11-CSV-CSA.html#5","title":"5. \u4e0a\u7ebf\u540e\u6d3b\u52a8","text":"<ul> <li>\u53d8\u66f4\u63a7\u5236\uff08\u5c0f\u53d8\u66f4/\u5927\u53d8\u66f4/\u7d27\u6025\u53d8\u66f4\uff09</li> <li>\u5468\u671f\u590d\u6838\u4e0e\u56de\u5f52\u6d4b\u8bd5</li> <li>\u4f9b\u5e94\u5546\u7ba1\u7406\u4e0e SLA/KPI</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-05-%E5%90%88%E8%A7%84%E4%B8%8E%E9%AA%8C%E8%AF%81-21CFRPart11-Annex11-CSV-CSA.html#6","title":"6. \u68c0\u67e5\u6e05\u5355\uff08\u7247\u6bb5\uff09","text":"<pre><code>[ ] \u89d2\u8272-\u6743\u9650\u77e9\u9635\u5df2\u8bc4\u5ba1\u5e76\u6700\u5c0f\u5316\n[ ] \u5ba1\u8ba1\u8ffd\u8e2a\u5b57\u6bb5\u5b8c\u6574\uff08\u8c01/\u4f55\u65f6/\u4f55\u56e0/\u524d\u540e\u503c\uff09\n[ ] \u7535\u5b50\u7b7e\u540d\u53cc\u56e0\u5b50\u4e0e\u7b7e\u6838\u94fe\u914d\u7f6e\n[ ] \u65b9\u6cd5/\u89c4\u683c/\u811a\u672c\u7248\u672c\u5316\u4e0e\u53d7\u63a7\n[ ] \u539f\u59cb\u6570\u636e\u6307\u7eb9/\u6e05\u5355\u4e0e\u4fdd\u7559\u7b56\u7565\n[ ] \u9a8c\u8bc1\u5de5\u4ef6\u9f50\u5907\u5e76\u53ef\u8ffd\u6eaf\n</code></pre> <p>\u2014\u2014 \u7cfb\u5217\u7b2c 05 \u7bc7\uff0c\u4e0b\u4e00\u7bc7\uff1a\u96c6\u6210\u67b6\u6784\u4e0e\u5e73\u53f0\u5de5\u7a0b\uff08API \u7f51\u5173/\u4e8b\u4ef6\u9a71\u52a8/\u7f16\u6392\uff09\u3002</p>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-06-%E9%9B%86%E6%88%90%E6%9E%B6%E6%9E%84%E4%B8%8E%E5%B9%B3%E5%8F%B0%E5%B7%A5%E7%A8%8B.html","title":"\u5b9e\u9a8c\u5ba4\u4fe1\u606f\u5b66\u67b6\u6784\uff0806\uff09\u96c6\u6210\u67b6\u6784\u4e0e\u5e73\u53f0\u5de5\u7a0b\uff08API \u7f51\u5173 / \u4e8b\u4ef6\u9a71\u52a8 / \u7f16\u6392\uff09","text":"<p>\u96c6\u6210\u67b6\u6784\u51b3\u5b9a\u4e86\u201c\u7cfb\u7edf\u80fd\u5426\u957f\u4e45\u6f14\u8fdb\u201d\u3002\u672c\u7bc7\u7ed9\u51fa\u4e8b\u4ef6\u9a71\u52a8\u7684\u63a8\u8350\u5b9e\u8df5\u4e0e\u5e73\u53f0\u5de5\u7a0b\u5316\u601d\u8def\u3002</p>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-06-%E9%9B%86%E6%88%90%E6%9E%B6%E6%9E%84%E4%B8%8E%E5%B9%B3%E5%8F%B0%E5%B7%A5%E7%A8%8B.html#1","title":"1. \u96c6\u6210\u62d3\u6251\u9009\u578b","text":"<ul> <li>\u70b9\u5bf9\u70b9\uff1a\u521d\u671f\u5feb\uff0c\u4f46\u7ef4\u62a4\u6210\u672c\u9ad8</li> <li>\u4e2d\u5fc3\u67a2\u7ebd\uff08ESB/API \u7f51\u5173\uff09\uff1a\u7edf\u4e00\u9274\u6743/\u9650\u6d41/\u53ef\u89c2\u6d4b</li> <li>\u4e8b\u4ef6\u9a71\u52a8\uff08EDA\uff09\uff1a\u7cfb\u7edf\u89e3\u8026\uff0c\u5929\u7136\u5ba1\u8ba1\u4e0e\u91cd\u653e\u80fd\u529b</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-06-%E9%9B%86%E6%88%90%E6%9E%B6%E6%9E%84%E4%B8%8E%E5%B9%B3%E5%8F%B0%E5%B7%A5%E7%A8%8B.html#2","title":"2. \u4e8b\u4ef6\u4e0e\u4e3b\u9898\u8bbe\u8ba1","text":"<ul> <li>\u6309\u9886\u57df\u5212\u5206\u4e3b\u9898\uff1alims.sample\u3001les.execution\u3001sdms.asset\u3001qms.deviation \u7b49</li> <li>\u4e8b\u4ef6\u7ed3\u6784\u6700\u5c0f\u5316\uff1aid\u3001type\u3001source\u3001time\u3001subject\u3001data\uff08\u9075\u5faa CloudEvents \u601d\u60f3\uff09</li> <li>\u7248\u672c\u4e0e\u517c\u5bb9\uff1a\u4e8b\u4ef6 schema \u7248\u672c\u5316\uff0c\u517c\u5bb9\u6027\u7b56\u7565</li> </ul> <p>\u4e8b\u4ef6\u6d88\u606f\u793a\u4f8b\uff1a</p> <pre><code>{\n  \"id\": \"evt-9b2b...\",\n  \"type\": \"lims.sample.result.approved\",\n  \"source\": \"lims\",\n  \"time\": \"2025-11-11T10:30:00Z\",\n  \"subject\": \"S-2025-000123\",\n  \"data\": {\n    \"test\": \"ASSAY\",\n    \"value\": 99.3,\n    \"unit\": \"%\",\n    \"spec\": {\"lower\": 97, \"upper\": 103}\n  }\n}\n</code></pre>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-06-%E9%9B%86%E6%88%90%E6%9E%B6%E6%9E%84%E4%B8%8E%E5%B9%B3%E5%8F%B0%E5%B7%A5%E7%A8%8B.html#3-api","title":"3. API \u7f51\u5173\u4e0e\u5b89\u5168","text":"<ul> <li>\u7edf\u4e00\u8ba4\u8bc1\u9274\u6743\u3001\u6700\u5c0f\u6743\u9650\u3001\u7ec6\u7c92\u5ea6\u5ba1\u8ba1</li> <li>\u9650\u6d41/\u7194\u65ad/\u91cd\u8bd5/\u5e42\u7b49\u952e</li> <li>\u5317\u5411/\u5357\u5411\u63a5\u53e3\u76ee\u5f55\u4e0e\u751f\u547d\u5468\u671f\u7ba1\u7406</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-06-%E9%9B%86%E6%88%90%E6%9E%B6%E6%9E%84%E4%B8%8E%E5%B9%B3%E5%8F%B0%E5%B7%A5%E7%A8%8B.html#4","title":"4. \u7f16\u6392\u4e0e\u6cbb\u7406","text":"<ul> <li>Orchestration vs Choreography\uff1a\u4f55\u65f6\u96c6\u4e2d\u7f16\u6392\u3001\u4f55\u65f6\u201c\u8ba9\u4e8b\u4ef6\u81ea\u7136\u6d41\u52a8\u201d</li> <li>\u5de5\u4f5c\u6d41\u5f15\u64ce\u4e0e\u4f4e\u4ee3\u7801\u5e73\u53f0\u7684\u8fb9\u754c</li> <li>\u8fd0\u884c\u65f6\u53ef\u89c2\u6d4b\uff1a\u65e5\u5fd7/\u6307\u6807/\u8ffd\u8e2a\u4e0e\u4e8b\u4ef6\u6d41\u5e76\u884c</li> </ul>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-06-%E9%9B%86%E6%88%90%E6%9E%B6%E6%9E%84%E4%B8%8E%E5%B9%B3%E5%8F%B0%E5%B7%A5%E7%A8%8B.html#5","title":"5. \u7aef\u5230\u7aef\u793a\u4f8b\uff08\u7ed3\u679c\u56de\u5199\u94fe\u8def\uff09","text":"<p>1) LES \u5b8c\u6210\u2192\u53d1\u5e03 les.execution.completed 2) SDMS \u843d\u5730\u2192\u53d1\u5e03 sdms.asset.created 3) \u670d\u52a1\u6d88\u8d39\u4e24\u4e8b\u4ef6\uff0c\u805a\u5408\u5e76\u56de\u5199 LIMS\uff08API\uff09 4) LIMS \u5ba1\u6279\u901a\u8fc7\u2192\u53d1\u5e03 lims.result.approved</p>"},{"location":"biopharma/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%BF%A1%E6%81%AF%E5%AD%A6%E6%9E%B6%E6%9E%84-06-%E9%9B%86%E6%88%90%E6%9E%B6%E6%9E%84%E4%B8%8E%E5%B9%B3%E5%8F%B0%E5%B7%A5%E7%A8%8B.html#6","title":"6. \u843d\u5730\u5efa\u8bae","text":"<ul> <li>\u5148\u68b3\u7406\u201c\u5173\u952e\u4e8b\u4ef6\u6e05\u5355\u201d\uff0c\u518d\u5b9a\u4e3b\u9898\u4e0e\u6743\u9650</li> <li>\u5efa\u7acb\u4e8b\u4ef6\u517c\u5bb9\u7b56\u7565\u4e0e\u56de\u653e\u673a\u5236</li> <li>API \u4e0e\u4e8b\u4ef6\u7edf\u4e00\u76ee\u5f55\u4e0e\u7248\u672c\u6cbb\u7406</li> </ul> <p>\u2014\u2014 \u7cfb\u5217\u7b2c 06 \u7bc7\uff0c\u4e0b\u4e00\u7bc7\uff08\u53ef\u9009\uff09\uff1a\u4e3b\u6570\u636e\u4e0e\u8bed\u4e49\u6807\u51c6\u3001\u53ef\u89c2\u6d4b\u6027\u5b9e\u8df5\u3002</p>"},{"location":"csv/CSV-%E8%B5%84%E6%96%99%E7%B4%A2%E5%BC%95.html","title":"CSV\uff08\u8ba1\u7b97\u673a\u5316\u7cfb\u7edf\u9a8c\u8bc1\uff09\u8d44\u6599\u7d22\u5f15","text":""},{"location":"csv/CSV-%E8%B5%84%E6%96%99%E7%B4%A2%E5%BC%95.html#_1","title":"\u9875\u9762\u5217\u8868","text":"<ul> <li>1.CSV_model.html</li> <li>2.CSV_Law.html</li> <li>3.CSV_Lifecycle_cn.html</li> <li>4.CSV_VMP.html</li> <li>5.CSV_URS.html</li> <li>6.CSV_Design_Dev.html</li> <li>7.CSV_IQOQPQ.html</li> <li>8.CSV_Changae_Maintenance.html</li> </ul>"},{"location":"csv/CSV-%E8%B5%84%E6%96%99%E7%B4%A2%E5%BC%95.html#_2","title":"\u8bf4\u660e","text":"<ul> <li>\u6240\u6709\u9875\u9762\u5747\u4fdd\u6301\u539f\u6837\u7ed3\u6784\u4e0e\u6837\u5f0f\uff0c\u4ec5\u5bf9\u654f\u611f\u4fe1\u606f\u505a\u66ff\u6362\u3002</li> <li>\u82e5\u9700\u201c\u81ea\u6258\u7ba1\u201d\u6837\u5f0f\u4e0e\u56fe\u6807\u6587\u4ef6\u4ee5\u907f\u514d\u5916\u7f51\u4f9d\u8d56\uff0c\u53ef\u544a\u77e5\uff0c\u6211\u4f1a\u5c06 CDN \u8d44\u6e90\u4e0b\u8f7d\u5230\u4ed3\u5e93\u5e76\u6539\u5199\u5f15\u7528\u8def\u5f84\u3002</li> </ul>"},{"location":"csv/cccc.html","title":"Cccc","text":"<p>tttttt</p> <p>test</p>"},{"location":"dba/000-Oracle-21c-%E4%B8%93%E9%A2%98%E7%B4%A2%E5%BC%95.html","title":"Oracle 21c \u4e13\u9898\u7d22\u5f15","text":"<p>\u672c\u9875\u6c47\u603b Oracle 21c DBA \u5e38\u7528\u77e5\u8bc6\u4e0e\u64cd\u4f5c\u7684\u4e13\u9898\u5165\u53e3\uff0c\u63a8\u8350\u9605\u8bfb\u987a\u5e8f\u4e0e\u5feb\u901f\u94fe\u63a5\uff0c\u4fbf\u4e8e\u57f9\u8bad\u3001\u6392\u969c\u4e0e\u53d8\u66f4\u6267\u884c\u3002</p>"},{"location":"dba/000-Oracle-21c-%E4%B8%93%E9%A2%98%E7%B4%A2%E5%BC%95.html#_1","title":"\u63a8\u8350\u9605\u8bfb\u987a\u5e8f","text":"<p>1) \u67b6\u6784\u4e0e\u5173\u952e\u7ec4\u4ef6\uff08\u638c\u63e1 21c \u67b6\u6784\u5168\u8c8c\u4e0e\u8bca\u65ad\u9762\uff09 2) \u5e38\u89c1\u89c6\u56fe\u53ca\u7528\u6cd5\uff08\u4e00\u7ebf\u6392\u969c\u5fc5\u5907 SQL\uff09 3) \u6570\u636e\u6587\u4ef6\u589e\u5220\u4e0e\u5728\u7ebf\u8fc1\u79fb\uff08\u5bb9\u91cf\u4e0e\u5b58\u50a8\u53d8\u66f4\uff09 4) \u7b49\u5f85\u4e8b\u4ef6\u5904\u7406\u65b9\u6cd5\uff08\u6027\u80fd\u4e0e\u53ef\u7528\u6027\u95ee\u9898\u5b9a\u4f4d\uff09</p>"},{"location":"dba/000-Oracle-21c-%E4%B8%93%E9%A2%98%E7%B4%A2%E5%BC%95.html#_2","title":"\u5feb\u901f\u94fe\u63a5","text":"<ul> <li>\u67b6\u6784\u4e0e\u5173\u952e\u7ec4\u4ef6</li> <li>\u5e38\u89c1\u89c6\u56fe\u53ca\u7528\u6cd5</li> <li>\u589e\u52a0\u5220\u9664\u6570\u636e\u6587\u4ef6\u7684\u65b9\u6cd5</li> <li>\u7b49\u5f85\u4e8b\u4ef6\u5904\u7406\u65b9\u6cd5</li> </ul> <p>\u63d0\u793a\uff1a\u672c\u7ad9\u524d\u7aef\u6309\u201c\u6587\u4ef6\u540d\u201d\u6392\u5e8f\uff0c\u7d22\u5f15\u9875\u5df2\u901a\u8fc7\u201c000-\u201d\u524d\u7f00\u7f6e\u9876\u81f3 DBA \u5206\u7c7b\u9996\u4f4d\u3002</p>"},{"location":"dba/000-Oracle-21c-%E4%B8%93%E9%A2%98%E7%B4%A2%E5%BC%95.html#_3","title":"\u5e38\u7528\u68c0\u67e5\u6e05\u5355\uff08\u968f\u624b\u67e5\uff09","text":"<ul> <li>\u5f53\u524d\u5bb9\u5668\u4e0e PDB \u72b6\u6001   <code>sql   SHOW con_name; SELECT con_id, name, open_mode FROM v$containers ORDER BY con_id;</code></li> <li>\u7a7a\u95f4\u4e0e\u6570\u636e\u6587\u4ef6   <code>sql   SELECT tablespace_name, ROUND(SUM(bytes)/1024/1024) total_mb FROM dba_data_files GROUP BY tablespace_name;   SELECT file_id, file_name, bytes/1024/1024 mb FROM dba_data_files ORDER BY file_id;</code></li> <li>\u7b49\u5f85\u4e0e\u4f1a\u8bdd\u70ed\u70b9   <code>sql   SELECT wait_class, event, COUNT(*) samples FROM v$active_session_history   WHERE sample_time &gt; SYSTIMESTAMP - INTERVAL '10' MINUTE   GROUP BY wait_class, event ORDER BY samples DESC FETCH FIRST 10 ROWS ONLY;</code></li> </ul>"},{"location":"dba/000-Oracle-21c-%E4%B8%93%E9%A2%98%E7%B4%A2%E5%BC%95.html#_4","title":"\u9002\u7528\u7248\u672c\u4e0e\u6ce8\u610f","text":"<ul> <li>\u9002\u7528\uff1aOracle Database 21c\uff08CDB/PDB \u67b6\u6784\uff0cLocal Undo\uff0c\u5728\u7ebf\u6570\u636e\u6587\u4ef6\u79fb\u52a8\u7b49\u7279\u6027\uff09</li> <li>\u8bb8\u53ef\uff1aAWR/ASH/ADDM \u7b49\u5de5\u5177\u9700 Diagnostics/Tuning Pack</li> <li>\u751f\u4ea7\u53d8\u66f4\uff1a\u52a1\u5fc5\u7eb3\u5165\u5ba1\u6279\u3001\u53cc\u4eba\u590d\u6838\u3001\u9884\u6848/\u56de\u6eda\u3001RMAN \u9a8c\u8bc1\u4e0e\u4e0a\u7ebf\u540e\u76d1\u63a7</li> </ul>"},{"location":"dba/Apache-Doris-OLAP-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html","title":"Apache Doris\uff08\u56fd\u4ea7 OLAP\uff09\uff1a\u5165\u95e8\u4e0e\u5b89\u88c5\u5b9e\u8df5","text":"<p>\u9002\u7528\u8bfb\u8005\uff1a\u6570\u4ed3\u5de5\u7a0b\u5e08\u3001DBA\u3001\u6570\u636e\u5206\u6790\u5e73\u53f0\u5de5\u7a0b\u5e08 \u76ee\u6807\uff1a\u5b8c\u6210 Doris \u6700\u5c0f\u96c6\u7fa4\u5b89\u88c5\uff0c\u638c\u63e1\u57fa\u672c\u5efa\u8868\u3001\u5bfc\u5165\u4e0e\u67e5\u8be2\u3002</p>"},{"location":"dba/Apache-Doris-OLAP-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#1-doris","title":"1. Doris \u6982\u8ff0","text":"<ul> <li>\u7c7b\u578b\uff1aMPP \u5206\u5e03\u5f0f\u5217\u5f0f\u5206\u6790\u578b\u6570\u636e\u5e93\uff08\u56fd\u5185\u5f00\u6e90\uff0c\u524d\u8eab Baidu Palo\uff09</li> <li>\u67b6\u6784\uff1aFE\uff08\u524d\u7aef/\u5143\u6570\u636e\uff09+ BE\uff08\u8ba1\u7b97\u5b58\u50a8\uff09+ Broker\uff08\u5bfc\u5165\uff09</li> <li>\u9002\u7528\uff1a\u5b9e\u65f6/\u4ea4\u4e92\u5f0f\u5206\u6790\u3001\u660e\u7ec6\u67e5\u8be2\u3001\u805a\u5408\u62a5\u8868\u3001\u6781\u901f\u70b9\u67e5</li> </ul>"},{"location":"dba/Apache-Doris-OLAP-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#2-fe-be","title":"2. \u6700\u5c0f\u96c6\u7fa4\u5b89\u88c5\uff08\u5355 FE + \u5355 BE\uff09","text":"<p>\u73af\u5883\uff1aLinux x86_64\uff0cJDK 8/11\uff0c\u5185\u5b58 \u2265 8GB</p> <pre><code># 1) \u4e0b\u8f7d\u4e0e\u89e3\u538b\uff08\u4ee5 2.0.x \u4e3a\u4f8b\uff09\nwget https://downloads.apache.org/doris/2.0/2.0.7/apache-doris-2.0.7-bin-x64.tar.gz\nmkdir -p /opt/doris &amp;&amp; tar -xzf apache-doris-2.0.7-bin-x64.tar.gz -C /opt/doris\ncd /opt/doris/apache-doris-2.0.7-bin-x64\n\n# 2) \u542f\u52a8 FE\ncd fe &amp;&amp; sh bin/start_fe.sh --daemon\n# 3) \u542f\u52a8 BE\ncd ../be &amp;&amp; sh bin/start_be.sh --daemon\n\n# 4) \u68c0\u67e5\njps | grep -E 'DorisFE|DorisBE'\n# FE Web\uff1ahttp://&lt;host&gt;:8030 \uff1b MySQL \u534f\u8bae\uff1a9030\n</code></pre>"},{"location":"dba/Apache-Doris-OLAP-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#3","title":"3. \u8fde\u63a5\u4e0e\u5efa\u5e93\u5efa\u8868","text":"<pre><code>mysql -h127.0.0.1 -P9030 -uroot\n</code></pre> <pre><code>CREATE DATABASE demo;\nUSE demo;\n\n-- \u660e\u7ec6\u6a21\u578b\uff08Duplicate Key\uff09\nCREATE TABLE dwd_user_log (\n  user_id BIGINT,\n  ts DATETIME,\n  action VARCHAR(32)\n) DUPLICATE KEY(user_id)\nDISTRIBUTED BY HASH(user_id) BUCKETS 8\nPROPERTIES (\"replication_allocation\" = \"tag.location.default: 1\");\n</code></pre>"},{"location":"dba/Apache-Doris-OLAP-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#4","title":"4. \u6570\u636e\u5bfc\u5165","text":"<pre><code># Stream Load\uff08\u6700\u7b80\u65b9\u5f0f\uff09\ncurl -u root: -H \"label:demo_1\" -H \"column_separator:,\" \\\n  -T user_log.csv http://127.0.0.1:8030/api/demo/dwd_user_log/_stream_load\n</code></pre> <pre><code>-- \u67e5\u8be2\nSELECT action, COUNT(*) FROM dwd_user_log GROUP BY action ORDER BY 2 DESC;\n</code></pre>"},{"location":"dba/Apache-Doris-OLAP-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#5","title":"5. \u5206\u533a\u4e0e\u51b7\u70ed\u5206\u5c42\uff08\u8981\u70b9\uff09","text":"<ul> <li>\u65f6\u95f4\u5206\u533a + Hash \u5206\u6876\uff1b\u51b7\u70ed\u5206\u5c42\uff08Storage Medium SSD/HDD\uff09</li> <li>Rollup \u7269\u5316\u7d22\u5f15\uff1b\u591a\u526f\u672c\u5bb9\u9519</li> </ul> <pre><code>ALTER TABLE dwd_user_log \nADD PARTITION p202511 VALUES LESS THAN ('2025-12-01');\n</code></pre>"},{"location":"dba/Apache-Doris-OLAP-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#6","title":"6. \u5e38\u89c1\u95ee\u9898","text":"<ul> <li>\u542f\u52a8\u5931\u8d25\uff1a\u68c0\u67e5\u7aef\u53e3 8030/9030/8040/8041/9060\uff0cJDK \u7248\u672c</li> <li>\u5bfc\u5165\u62a5\u9519\uff1alabel \u51b2\u7a81\u3001\u5b57\u6bb5\u5206\u9694\u3001\u6570\u636e\u6e05\u6d17</li> <li>\u67e5\u8be2\u6162\uff1a\u5206\u533a\u88c1\u526a\u3001\u8c13\u8bcd\u4e0b\u63a8\u3001\u7269\u5316\u7d22\u5f15\u3001\u5e76\u53d1\u5ea6</li> </ul>"},{"location":"dba/Apache-Doris-OLAP-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#7","title":"7. \u6700\u4f73\u5b9e\u8df5","text":"<p>1) FE/BE \u5206\u79bb\u591a\u526f\u672c\uff1b2) \u8fdc\u7aef\u5bf9\u8c61\u5b58\u50a8\u51b7\u6570\u636e\uff1b3) \u6570\u636e\u6a21\u578b\u6b63\u786e\u9009\u62e9\uff08Aggregate/Unique/Duplicate\uff09\uff1b4) \u8d44\u6e90\u7ec4\u4e0e\u9650\u6d41\uff1b5) \u6307\u6807\u76d1\u63a7\u4e0e\u544a\u8b66</p> <p>\u53c2\u8003\uff1a - Doris \u6587\u6863 https://doris.apache.org - StarRocks\uff08\u540c\u7c7b\u56fd\u4ea7 OLAP\uff09https://starrocks.io</p>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html","title":"MySQL\u3001Redis\u3001MongoDB \u65e5\u5e38\u8fd0\u7ef4\u624b\u518c","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aDBA\u3001\u8fd0\u7ef4\u5de5\u7a0b\u5e08\u3001\u540e\u7aef\u5f00\u53d1 \u76ee\u6807\uff1a\u638c\u63e1 MySQL\u3001Redis\u3001MongoDB \u4e09\u5927\u4e3b\u6d41\u6570\u636e\u5e93\u7684\u65e5\u5e38\u8fd0\u7ef4\u6280\u80fd\uff0c\u5305\u62ec\u5b89\u88c5\u914d\u7f6e\u3001\u5907\u4efd\u6062\u590d\u3001\u6027\u80fd\u4f18\u5316\u3001\u76d1\u63a7\u544a\u8b66\u3001\u95ee\u9898\u8bca\u65ad\u4e0e\u53d8\u66f4\u5b9e\u65bd\u3002</p>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#1","title":"1. \u6982\u8ff0","text":"<p>\u672c\u624b\u518c\u8986\u76d6\u4f01\u4e1a\u7ea7\u73af\u5883\u4e2d\u6700\u5e38\u7528\u7684\u4e09\u79cd\u6570\u636e\u5b58\u50a8\u6280\u672f\uff1a - MySQL\uff1a\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0cOLTP \u6838\u5fc3 - Redis\uff1a\u5185\u5b58\u952e\u503c\u5b58\u50a8\uff0c\u7f13\u5b58\u4e0e\u6d88\u606f\u961f\u5217 - MongoDB\uff1a\u6587\u6863\u578b NoSQL\uff0c\u7075\u6d3b schema</p>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#2-mysql","title":"2. MySQL \u65e5\u5e38\u8fd0\u7ef4","text":""},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#21","title":"2.1 \u5b89\u88c5\u4e0e\u914d\u7f6e","text":"<p>\u5b89\u88c5\uff08CentOS/RHEL 8\uff09</p> <pre><code># 1) \u5b89\u88c5 MySQL 8.0\nyum install -y mysql-server\nsystemctl enable mysqld &amp;&amp; systemctl start mysqld\n\n# 2) \u83b7\u53d6\u521d\u59cb\u5bc6\u7801\u5e76\u4fee\u6539\ngrep 'temporary password' /var/log/mysqld.log\nmysql -uroot -p\nALTER USER 'root'@'localhost' IDENTIFIED BY 'NewPass@123';\n</code></pre> <p>\u6838\u5fc3\u914d\u7f6e\uff08/etc/my.cnf\uff09</p> <pre><code>[mysqld]\n# \u57fa\u7840\u914d\u7f6e\nport=3306\ndatadir=/data/mysql\nsocket=/var/lib/mysql/mysql.sock\n\n# \u6027\u80fd\u4f18\u5316\ninnodb_buffer_pool_size=8G          # \u7269\u7406\u5185\u5b58\u7684 60-70%\ninnodb_log_file_size=1G\ninnodb_flush_log_at_trx_commit=2    # \u6027\u80fd\u4e0e\u5b89\u5168\u5e73\u8861\nmax_connections=500\nthread_cache_size=100\n\n# \u6162\u67e5\u8be2\nslow_query_log=1\nslow_query_log_file=/var/log/mysql/slow.log\nlong_query_time=2\n\n# \u4e8c\u8fdb\u5236\u65e5\u5fd7\uff08\u5907\u4efd\u4e0e\u590d\u5236\uff09\nlog_bin=/data/mysql/binlog/mysql-bin\nbinlog_format=ROW\nexpire_logs_days=7\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#22","title":"2.2 \u5907\u4efd\u4e0e\u6062\u590d","text":"<p>\u903b\u8f91\u5907\u4efd\uff08mysqldump\uff09</p> <pre><code># \u5168\u5e93\u5907\u4efd\nmysqldump -uroot -p --all-databases --single-transaction \\\n  --master-data=2 --flush-logs &gt; /backup/full_$(date +%F).sql\n\n# \u5355\u5e93\u5907\u4efd\nmysqldump -uroot -p --databases mydb --single-transaction \\\n  &gt; /backup/mydb_$(date +%F).sql\n\n# \u6062\u590d\nmysql -uroot -p &lt; /backup/full_2025-11-11.sql\n</code></pre> <p>\u7269\u7406\u5907\u4efd\uff08Percona XtraBackup\uff09</p> <pre><code># \u5168\u91cf\u5907\u4efd\nxtrabackup --backup --target-dir=/backup/full_$(date +%F) \\\n  --user=root --password='xxx'\n\n# \u589e\u91cf\u5907\u4efd\nxtrabackup --backup --target-dir=/backup/inc_$(date +%F) \\\n  --incremental-basedir=/backup/full_2025-11-10 --user=root --password='xxx'\n\n# \u6062\u590d\u51c6\u5907\nxtrabackup --prepare --target-dir=/backup/full_2025-11-11\nxtrabackup --copy-back --target-dir=/backup/full_2025-11-11\nchown -R mysql:mysql /data/mysql\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#23-sql","title":"2.3 \u6027\u80fd\u4f18\u5316\u4e0e SQL \u8c03\u4f18","text":"<p>\u6162\u67e5\u8be2\u5206\u6790</p> <pre><code># \u4f7f\u7528 pt-query-digest \u5206\u6790\u6162\u65e5\u5fd7\npt-query-digest /var/log/mysql/slow.log &gt; slow_report.txt\n</code></pre> <p>SQL \u4f18\u5316\u6b65\u9aa4</p> <pre><code>-- 1) \u67e5\u770b\u6267\u884c\u8ba1\u5212\nEXPLAIN SELECT * FROM orders WHERE user_id=123 AND status='paid';\n\n-- 2) \u6dfb\u52a0\u7d22\u5f15\nCREATE INDEX idx_user_status ON orders(user_id, status);\n\n-- 3) \u5206\u6790\u8868\u7edf\u8ba1\u4fe1\u606f\nANALYZE TABLE orders;\n\n-- 4) \u4f18\u5316\u67e5\u8be2\uff08\u907f\u514d SELECT *\uff0c\u4f7f\u7528\u8986\u76d6\u7d22\u5f15\uff09\nSELECT order_id, amount FROM orders WHERE user_id=123 AND status='paid';\n</code></pre> <p>\u5173\u952e\u6307\u6807\u76d1\u63a7</p> <pre><code>-- \u8fde\u63a5\u6570\nSHOW STATUS LIKE 'Threads_connected';\nSHOW STATUS LIKE 'Max_used_connections';\n\n-- \u7f13\u51b2\u6c60\u547d\u4e2d\u7387\nSHOW STATUS LIKE 'Innodb_buffer_pool_read%';\n\n-- \u9501\u7b49\u5f85\nSHOW ENGINE INNODB STATUS\\G\nSELECT * FROM information_schema.INNODB_TRX;\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#24","title":"2.4 \u76d1\u63a7\u544a\u8b66","text":"<p>Prometheus + mysqld_exporter</p> <pre><code># \u5b89\u88c5 mysqld_exporter\nwget https://github.com/prometheus/mysqld_exporter/releases/download/v0.15.0/mysqld_exporter-0.15.0.linux-amd64.tar.gz\ntar -xzf mysqld_exporter-0.15.0.linux-amd64.tar.gz\ncd mysqld_exporter-0.15.0.linux-amd64\n\n# \u521b\u5efa\u76d1\u63a7\u7528\u6237\nmysql -uroot -p -e \"CREATE USER 'exporter'@'localhost' IDENTIFIED BY 'Exp@123';\"\nmysql -uroot -p -e \"GRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO 'exporter'@'localhost';\"\n\n# \u542f\u52a8 exporter\nexport DATA_SOURCE_NAME='exporter:Exp@123@(localhost:3306)/'\n./mysqld_exporter &amp;\n</code></pre> <p>\u544a\u8b66\u89c4\u5219\uff08Prometheus\uff09</p> <pre><code>groups:\n- name: mysql_alerts\n  rules:\n  - alert: MySQLDown\n    expr: mysql_up == 0\n    for: 1m\n    annotations:\n      summary: \"MySQL instance {{ $labels.instance }} is down\"\n\n  - alert: MySQLSlowQueries\n    expr: rate(mysql_global_status_slow_queries[5m]) &gt; 10\n    for: 5m\n    annotations:\n      summary: \"High slow query rate on {{ $labels.instance }}\"\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#25","title":"2.5 \u95ee\u9898\u8bca\u65ad","text":"<p>\u5e38\u89c1\u95ee\u9898</p> <pre><code># 1) \u8fde\u63a5\u6570\u8017\u5c3d\nSHOW PROCESSLIST;\nKILL &lt;thread_id&gt;;\n\n# 2) \u9501\u7b49\u5f85\u8d85\u65f6\nSELECT * FROM information_schema.INNODB_LOCK_WAITS;\n\n# 3) \u4e3b\u4ece\u5ef6\u8fdf\nSHOW SLAVE STATUS\\G\n# \u67e5\u770b Seconds_Behind_Master\n\n# 4) \u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3\ndu -sh /data/mysql/*\nPURGE BINARY LOGS BEFORE '2025-11-01';\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#26","title":"2.6 \u53d8\u66f4\u5b9e\u65bd","text":"<p>DDL \u53d8\u66f4\uff08\u4f7f\u7528 pt-online-schema-change\uff09</p> <pre><code># \u5728\u7ebf\u6dfb\u52a0\u7d22\u5f15\uff08\u907f\u514d\u9501\u8868\uff09\npt-online-schema-change --alter \"ADD INDEX idx_email (email)\" \\\n  D=mydb,t=users --execute --user=root --password='xxx'\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#3-redis","title":"3. Redis \u65e5\u5e38\u8fd0\u7ef4","text":""},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#31","title":"3.1 \u5b89\u88c5\u4e0e\u914d\u7f6e","text":"<p>\u5b89\u88c5\uff08\u7f16\u8bd1\u5b89\u88c5\uff09</p> <pre><code>wget https://download.redis.io/releases/redis-7.2.3.tar.gz\ntar -xzf redis-7.2.3.tar.gz &amp;&amp; cd redis-7.2.3\nmake &amp;&amp; make install\n\n# \u914d\u7f6e\u6587\u4ef6\ncp redis.conf /etc/redis/redis.conf\n</code></pre> <p>\u6838\u5fc3\u914d\u7f6e\uff08/etc/redis/redis.conf\uff09</p> <pre><code># \u7f51\u7edc\nbind 0.0.0.0\nport 6379\nprotected-mode yes\nrequirepass \"Redis@123\"\n\n# \u6301\u4e45\u5316\nsave 900 1\nsave 300 10\nsave 60 10000\nappendonly yes\nappendfsync everysec\n\n# \u5185\u5b58\u7ba1\u7406\nmaxmemory 4gb\nmaxmemory-policy allkeys-lru\n\n# \u6162\u65e5\u5fd7\nslowlog-log-slower-than 10000\nslowlog-max-len 128\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#32","title":"3.2 \u5907\u4efd\u4e0e\u6062\u590d","text":"<p>RDB \u5feb\u7167\u5907\u4efd</p> <pre><code># \u624b\u52a8\u89e6\u53d1\nredis-cli -a 'Redis@123' BGSAVE\n\n# \u5907\u4efd\u6587\u4ef6\ncp /var/lib/redis/dump.rdb /backup/dump_$(date +%F).rdb\n\n# \u6062\u590d\uff1a\u505c\u6b62 Redis\uff0c\u66ff\u6362 dump.rdb\uff0c\u91cd\u542f\n</code></pre> <p>AOF \u5907\u4efd</p> <pre><code># \u5907\u4efd AOF \u6587\u4ef6\ncp /var/lib/redis/appendonly.aof /backup/aof_$(date +%F).aof\n\n# \u91cd\u5199 AOF\uff08\u538b\u7f29\uff09\nredis-cli -a 'Redis@123' BGREWRITEAOF\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#33","title":"3.3 \u6027\u80fd\u4f18\u5316","text":"<p>\u5173\u952e\u6307\u6807\u76d1\u63a7</p> <pre><code># \u5b9e\u65f6\u76d1\u63a7\nredis-cli -a 'Redis@123' --stat\n\n# \u6162\u67e5\u8be2\nredis-cli -a 'Redis@123' SLOWLOG GET 10\n\n# \u5185\u5b58\u5206\u6790\nredis-cli -a 'Redis@123' INFO memory\nredis-cli -a 'Redis@123' --bigkeys\n</code></pre> <p>\u4f18\u5316\u5efa\u8bae - \u907f\u514d\u4f7f\u7528 KEYS \u547d\u4ee4\uff08\u4f7f\u7528 SCAN\uff09 - \u63a7\u5236\u5355\u4e2a key \u5927\u5c0f\uff08&lt; 10MB\uff09 - \u4f7f\u7528 Pipeline \u6279\u91cf\u64cd\u4f5c - \u5408\u7406\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4</p>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#34","title":"3.4 \u76d1\u63a7\u544a\u8b66","text":"<p>redis_exporter + Prometheus</p> <pre><code># \u542f\u52a8 redis_exporter\ndocker run -d --name redis_exporter -p 9121:9121 \\\n  oliver006/redis_exporter --redis.addr=redis://localhost:6379 \\\n  --redis.password='Redis@123'\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#35","title":"3.5 \u95ee\u9898\u8bca\u65ad","text":"<p>\u5e38\u89c1\u95ee\u9898</p> <pre><code># 1) \u5185\u5b58\u6ea2\u51fa\nredis-cli -a 'Redis@123' INFO memory | grep used_memory_human\nredis-cli -a 'Redis@123' --bigkeys\n\n# 2) \u8fde\u63a5\u6570\u8fc7\u591a\nredis-cli -a 'Redis@123' INFO clients\n\n# 3) \u6301\u4e45\u5316\u963b\u585e\nredis-cli -a 'Redis@123' INFO persistence\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#4-mongodb","title":"4. MongoDB \u65e5\u5e38\u8fd0\u7ef4","text":""},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#41","title":"4.1 \u5b89\u88c5\u4e0e\u914d\u7f6e","text":"<p>\u5b89\u88c5\uff08RHEL 8\uff09</p> <pre><code># \u6dfb\u52a0 MongoDB \u4ed3\u5e93\ncat &gt; /etc/yum.repos.d/mongodb-org-7.0.repo &lt;&lt;'EOF'\n[mongodb-org-7.0]\nname=MongoDB Repository\nbaseurl=https://repo.mongodb.org/yum/redhat/8/mongodb-org/7.0/x86_64/\ngpgcheck=1\nenabled=1\ngpgkey=https://www.mongodb.org/static/pgp/server-7.0.asc\nEOF\n\nyum install -y mongodb-org\nsystemctl enable mongod &amp;&amp; systemctl start mongod\n</code></pre> <p>\u6838\u5fc3\u914d\u7f6e\uff08/etc/mongod.conf\uff09</p> <pre><code>storage:\n  dbPath: /data/mongodb\n  journal:\n    enabled: true\n  wiredTiger:\n    engineConfig:\n      cacheSizeGB: 8\n\nnet:\n  port: 27017\n  bindIp: 0.0.0.0\n\nsecurity:\n  authorization: enabled\n\noperationProfiling:\n  mode: slowOp\n  slowOpThresholdMs: 100\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#42","title":"4.2 \u5907\u4efd\u4e0e\u6062\u590d","text":"<p>mongodump/mongorestore</p> <pre><code># \u5168\u5e93\u5907\u4efd\nmongodump --uri=\"mongodb://admin:Pass@123@localhost:27017\" \\\n  --out=/backup/mongo_$(date +%F)\n\n# \u5355\u5e93\u5907\u4efd\nmongodump --uri=\"mongodb://admin:Pass@123@localhost:27017\" \\\n  --db=mydb --out=/backup/mydb_$(date +%F)\n\n# \u6062\u590d\nmongorestore --uri=\"mongodb://admin:Pass@123@localhost:27017\" \\\n  /backup/mongo_2025-11-11\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#43","title":"4.3 \u6027\u80fd\u4f18\u5316","text":"<p>\u7d22\u5f15\u4f18\u5316</p> <pre><code>// \u67e5\u770b\u6162\u67e5\u8be2\ndb.system.profile.find().sort({ts:-1}).limit(10)\n\n// \u521b\u5efa\u7d22\u5f15\ndb.users.createIndex({email: 1}, {unique: true})\ndb.orders.createIndex({user_id: 1, created_at: -1})\n\n// \u5206\u6790\u67e5\u8be2\u8ba1\u5212\ndb.orders.find({user_id: 123}).explain(\"executionStats\")\n</code></pre> <p>\u5173\u952e\u6307\u6807</p> <pre><code>// \u8fde\u63a5\u6570\ndb.serverStatus().connections\n\n// \u64cd\u4f5c\u7edf\u8ba1\ndb.serverStatus().opcounters\n\n// \u9501\u7b49\u5f85\ndb.currentOp({\"waitingForLock\": true})\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#44","title":"4.4 \u76d1\u63a7\u544a\u8b66","text":"<p>mongodb_exporter</p> <pre><code>docker run -d -p 9216:9216 \\\n  percona/mongodb_exporter:0.40 \\\n  --mongodb.uri=mongodb://admin:Pass@123@localhost:27017\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#45","title":"4.5 \u95ee\u9898\u8bca\u65ad","text":"<p>\u5e38\u89c1\u95ee\u9898</p> <pre><code># 1) \u8fde\u63a5\u6570\u8fc7\u591a\nmongo --eval \"db.serverStatus().connections\"\n\n# 2) \u6162\u67e5\u8be2\nmongo --eval \"db.setProfilingLevel(2)\"\nmongo --eval \"db.system.profile.find().sort({ts:-1}).limit(10)\"\n\n# 3) \u78c1\u76d8\u7a7a\u95f4\ndu -sh /data/mongodb/*\ndb.runCommand({compact: 'collection_name'})\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#5","title":"5. \u53d8\u66f4\u7ba1\u7406\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#51","title":"5.1 \u53d8\u66f4\u6d41\u7a0b","text":"<ol> <li>\u53d8\u66f4\u7533\u8bf7\uff1a\u586b\u5199\u53d8\u66f4\u5355\uff08\u76ee\u7684\u3001\u5f71\u54cd\u8303\u56f4\u3001\u56de\u6eda\u65b9\u6848\uff09</li> <li>\u8bc4\u5ba1\uff1aDBA + \u5f00\u53d1 + \u8fd0\u7ef4\u8bc4\u5ba1</li> <li>\u6d4b\u8bd5\u73af\u5883\u9a8c\u8bc1\uff1a\u5b8c\u6574\u6d4b\u8bd5\u53d8\u66f4\u811a\u672c</li> <li>\u751f\u4ea7\u6267\u884c\uff1a\u9009\u62e9\u4f4e\u5cf0\u671f\uff0c\u51c6\u5907\u56de\u6eda\u811a\u672c</li> <li>\u9a8c\u8bc1\uff1a\u68c0\u67e5\u6570\u636e\u4e00\u81f4\u6027\u3001\u6027\u80fd\u6307\u6807</li> <li>\u5f52\u6863\uff1a\u8bb0\u5f55\u53d8\u66f4\u65e5\u5fd7</li> </ol>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#52","title":"5.2 \u53d8\u66f4\u68c0\u67e5\u6e05\u5355","text":"<ul> <li>[ ] \u5907\u4efd\u5df2\u5b8c\u6210</li> <li>[ ] \u56de\u6eda\u811a\u672c\u5df2\u51c6\u5907</li> <li>[ ] \u5f71\u54cd\u8303\u56f4\u5df2\u8bc4\u4f30</li> <li>[ ] \u76d1\u63a7\u544a\u8b66\u5df2\u914d\u7f6e</li> <li>[ ] \u5e94\u7528\u8fde\u63a5\u6c60\u914d\u7f6e\u5df2\u68c0\u67e5</li> <li>[ ] \u53d8\u66f4\u7a97\u53e3\u5df2\u901a\u77e5\u76f8\u5173\u65b9</li> </ul>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#6","title":"6. \u6700\u4f73\u5b9e\u8df5\u603b\u7ed3","text":""},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#61","title":"6.1 \u901a\u7528\u539f\u5219","text":"<ol> <li>\u5907\u4efd 3-2-1 \u7b56\u7565\uff1a3 \u4efd\u526f\u672c\uff0c2 \u79cd\u4ecb\u8d28\uff0c1 \u4efd\u5f02\u5730</li> <li>\u76d1\u63a7\u5148\u884c\uff1a\u90e8\u7f72\u524d\u914d\u7f6e\u76d1\u63a7\u544a\u8b66</li> <li>\u5bb9\u91cf\u89c4\u5212\uff1a\u63d0\u524d 3-6 \u4e2a\u6708\u9884\u6d4b\u8d44\u6e90\u9700\u6c42</li> <li>\u6743\u9650\u6700\u5c0f\u5316\uff1a\u6309\u9700\u6388\u6743\uff0c\u5b9a\u671f\u5ba1\u8ba1</li> <li>\u6587\u6863\u5316\uff1a\u8bb0\u5f55\u67b6\u6784\u3001\u914d\u7f6e\u3001\u53d8\u66f4\u5386\u53f2</li> </ol>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#62","title":"6.2 \u6027\u80fd\u4f18\u5316","text":"<ul> <li>MySQL\uff1a\u7d22\u5f15\u4f18\u5316\u3001\u67e5\u8be2\u6539\u5199\u3001\u5206\u5e93\u5206\u8868</li> <li>Redis\uff1a\u5408\u7406\u4f7f\u7528\u6570\u636e\u7ed3\u6784\u3001Pipeline\u3001\u96c6\u7fa4\u5206\u7247</li> <li>MongoDB\uff1a\u7d22\u5f15\u7b56\u7565\u3001\u5206\u7247\u952e\u8bbe\u8ba1\u3001\u8bfb\u5199\u5206\u79bb</li> </ul>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#63","title":"6.3 \u9ad8\u53ef\u7528","text":"<ul> <li>MySQL\uff1a\u4e3b\u4ece\u590d\u5236 + MHA/Orchestrator</li> <li>Redis\uff1aSentinel/Cluster</li> <li>MongoDB\uff1a\u526f\u672c\u96c6 + \u5206\u7247\u96c6\u7fa4</li> </ul>"},{"location":"dba/MySQL-Redis-MongoDB-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C.html#7","title":"7. \u53c2\u8003\u8d44\u6599","text":"<ul> <li>MySQL \u5b98\u65b9\u6587\u6863\uff1ahttps://dev.mysql.com/doc/</li> <li>Redis \u5b98\u65b9\u6587\u6863\uff1ahttps://redis.io/documentation</li> <li>MongoDB \u5b98\u65b9\u6587\u6863\uff1ahttps://www.mongodb.com/docs/</li> <li>Percona Toolkit\uff1ahttps://www.percona.com/software/database-tools/percona-toolkit</li> <li>Prometheus \u76d1\u63a7\uff1ahttps://prometheus.io/docs/</li> </ul> <p>\u4f5c\u8005\uff1aDBA \u56e2\u961f \u66f4\u65b0\u65f6\u95f4\uff1a2025-11-11</p>"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html","title":"MySQL\u3001Redis\u3001MongoDB \u9ad8\u53ef\u7528\u89e3\u51b3\u65b9\u6848\u5bf9\u6bd4\u4e0e\u9009\u578b\u6307\u5357","text":"<p>\u9002\u7528\u8bfb\u8005\uff1a\u67b6\u6784\u5e08\u3001DBA\u3001\u6280\u672f\u51b3\u7b56\u8005 \u76ee\u6807\uff1a\u5168\u9762\u5bf9\u6bd4 MySQL\u3001Redis\u3001MongoDB \u7684\u4e3b\u6d41\u9ad8\u53ef\u7528\u65b9\u6848\uff0c\u5206\u6790\u4f18\u7f3a\u70b9\uff0c\u6839\u636e\u4e1a\u52a1\u573a\u666f\u7ed9\u51fa\u9009\u578b\u5efa\u8bae\u3002</p>"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#1","title":"1. \u6982\u8ff0","text":"<p>\u9ad8\u53ef\u7528\uff08HA\uff09\u662f\u751f\u4ea7\u73af\u5883\u7684\u6838\u5fc3\u9700\u6c42\uff0c\u672c\u6587\u5bf9\u6bd4\u4e09\u5927\u6570\u636e\u5e93\u7684\u4e3b\u6d41 HA \u65b9\u6848\uff1a</p> \u6570\u636e\u5e93 \u4e3b\u6d41 HA \u65b9\u6848 \u6838\u5fc3\u6307\u6807 MySQL \u4e3b\u4ece\u590d\u5236\u3001MHA\u3001MGR\u3001Orchestrator RPO &lt; 1s, RTO &lt; 30s Redis Sentinel\u3001Cluster\u3001Keepalived RPO &lt; 1s, RTO &lt; 5s MongoDB \u526f\u672c\u96c6\u3001\u5206\u7247\u96c6\u7fa4 RPO = 0, RTO &lt; 10s"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#2-mysql","title":"2. MySQL \u9ad8\u53ef\u7528\u65b9\u6848","text":""},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#21-mhamaster-high-availability","title":"2.1 \u65b9\u6848\u4e00\uff1a\u4e3b\u4ece\u590d\u5236 + MHA\uff08Master High Availability\uff09","text":"<p>\u67b6\u6784</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u5f02\u6b65\u590d\u5236      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Master  \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; \u2502 Slave1  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2502                            \u2502\n     \u2502                       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt;\u2502 Slave2  \u2502\n                             \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502   MHA    \u2502 (\u76d1\u63a7 + \u81ea\u52a8\u6545\u969c\u8f6c\u79fb)\n         \u2502 Manager  \u2502\n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>\u4f18\u70b9 - \u2705 \u6210\u719f\u7a33\u5b9a\uff0c\u793e\u533a\u652f\u6301\u597d - \u2705 \u81ea\u52a8\u6545\u969c\u68c0\u6d4b\u4e0e\u5207\u6362\uff08RTO &lt; 30s\uff09 - \u2705 \u652f\u6301\u534a\u540c\u6b65\u590d\u5236\uff08\u51cf\u5c11\u6570\u636e\u4e22\u5931\uff09 - \u2705 \u53ef\u914d\u7f6e\u591a\u4e2a\u4ece\u5e93\uff08\u8bfb\u5199\u5206\u79bb\uff09</p> <p>\u7f3a\u70b9 - \u274c \u5f02\u6b65\u590d\u5236\u53ef\u80fd\u4e22\u5931\u6570\u636e\uff08RPO &gt; 0\uff09 - \u274c \u9700\u8981\u989d\u5916\u7684 MHA Manager \u8282\u70b9 - \u274c \u8111\u88c2\u98ce\u9669\uff08\u9700\u914d\u5408 VIP + \u4ef2\u88c1\u673a\u5236\uff09 - \u274c \u5355\u70b9\u5199\u5165\uff08\u4e3b\u5e93\u538b\u529b\u5927\uff09</p> <p>\u9002\u7528\u573a\u666f - \u4e2d\u5c0f\u578b\u4e1a\u52a1\uff08QPS &lt; 10000\uff09 - \u53ef\u5bb9\u5fcd\u79d2\u7ea7\u6570\u636e\u4e22\u5931 - \u8bfb\u591a\u5199\u5c11\u573a\u666f\uff08\u901a\u8fc7\u4ece\u5e93\u5206\u62c5\u8bfb\u538b\u529b\uff09</p> <p>\u90e8\u7f72\u793a\u4f8b</p> <pre><code># 1) \u914d\u7f6e\u4e3b\u4ece\u590d\u5236\n# Master (my.cnf)\n[mysqld]\nserver-id=1\nlog_bin=/data/mysql/binlog/mysql-bin\nbinlog_format=ROW\ngtid_mode=ON\nenforce_gtid_consistency=ON\n\n# Slave (my.cnf)\n[mysqld]\nserver-id=2\nrelay_log=/data/mysql/relay-log\nread_only=1\nsuper_read_only=1\n\n# 2) \u5728 Slave \u4e0a\u914d\u7f6e\u590d\u5236\nCHANGE MASTER TO\n  MASTER_HOST='192.168.1.10',\n  MASTER_USER='repl',\n  MASTER_PASSWORD='Repl@123',\n  MASTER_AUTO_POSITION=1;\nSTART SLAVE;\n\n# 3) \u5b89\u88c5 MHA\nyum install -y mha4mysql-manager mha4mysql-node\n# \u914d\u7f6e /etc/mha/app1.cnf\uff08\u7565\uff09\nmasterha_manager --conf=/etc/mha/app1.cnf\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#22-mysql-group-replicationmgr","title":"2.2 \u65b9\u6848\u4e8c\uff1aMySQL Group Replication\uff08MGR\uff09","text":"<p>\u67b6\u6784</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Node1   \u2502\u2500\u2500\u2500\u2500&gt;\u2502 Node2   \u2502\u2500\u2500\u2500\u2500&gt;\u2502 Node3   \u2502\n\u2502(Primary)\u2502&lt;\u2500\u2500\u2500\u2500\u2502(Secondary)&lt;\u2500\u2500\u2500\u2500\u2502(Secondary)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n      \u2191              \u2191              \u2191\n      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n           Paxos \u534f\u8bae\uff08\u591a\u6570\u6d3e\u4e00\u81f4\uff09\n</code></pre> <p>\u4f18\u70b9 - \u2705 \u539f\u751f\u652f\u6301\uff08MySQL 5.7.17+\uff09 - \u2705 \u5f3a\u4e00\u81f4\u6027\uff08\u57fa\u4e8e Paxos\uff0cRPO = 0\uff09 - \u2705 \u81ea\u52a8\u6545\u969c\u68c0\u6d4b\u4e0e\u5207\u6362\uff08RTO &lt; 10s\uff09 - \u2705 \u652f\u6301\u591a\u4e3b\u6a21\u5f0f\uff08Multi-Primary\uff09</p> <p>\u7f3a\u70b9 - \u274c \u6027\u80fd\u5f00\u9500\u5927\uff08\u5199\u5165\u9700\u591a\u6570\u6d3e\u786e\u8ba4\uff09 - \u274c \u7f51\u7edc\u5ef6\u8fdf\u654f\u611f\uff08\u8de8\u673a\u623f\u90e8\u7f72\u56f0\u96be\uff09 - \u274c \u5355\u4e3b\u6a21\u5f0f\u4e0b\u4ecd\u662f\u5355\u70b9\u5199\u5165 - \u274c \u914d\u7f6e\u590d\u6742\uff0c\u8c03\u4f18\u96be\u5ea6\u9ad8</p> <p>\u9002\u7528\u573a\u666f - \u91d1\u878d\u3001\u652f\u4ed8\u7b49\u5f3a\u4e00\u81f4\u6027\u8981\u6c42\u573a\u666f - \u540c\u57ce\u591a\u673a\u623f\u90e8\u7f72\uff08\u5ef6\u8fdf &lt; 5ms\uff09 - \u6570\u636e\u96f6\u4e22\u5931\u8981\u6c42\uff08RPO = 0\uff09</p> <p>\u90e8\u7f72\u793a\u4f8b</p> <pre><code>-- \u5728\u6240\u6709\u8282\u70b9\u6267\u884c\nSET SQL_LOG_BIN=0;\nCREATE USER 'repl'@'%' IDENTIFIED BY 'Repl@123';\nGRANT REPLICATION SLAVE ON *.* TO 'repl'@'%';\nGRANT BACKUP_ADMIN ON *.* TO 'repl'@'%';\nSET SQL_LOG_BIN=1;\n\n-- \u914d\u7f6e MGR\nCHANGE MASTER TO MASTER_USER='repl', MASTER_PASSWORD='Repl@123' \n  FOR CHANNEL 'group_replication_recovery';\n\nSET GLOBAL group_replication_bootstrap_group=ON;\nSTART GROUP_REPLICATION;\nSET GLOBAL group_replication_bootstrap_group=OFF;\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#23-orchestrator-proxysql","title":"2.3 \u65b9\u6848\u4e09\uff1aOrchestrator + ProxySQL","text":"<p>\u67b6\u6784</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  ProxySQL    \u2502 (\u8bfb\u5199\u5206\u79bb + \u8fde\u63a5\u6c60)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n   \u250c\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2510\n   \u2193       \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502Master\u2502 \u2502Slave1\u2502 \u2502Slave2\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2518\n   \u2191       \u2191       \u2191\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n    Orchestrator (\u62d3\u6251\u7ba1\u7406 + \u81ea\u52a8\u5207\u6362)\n</code></pre> <p>\u4f18\u70b9 - \u2705 \u53ef\u89c6\u5316\u62d3\u6251\u7ba1\u7406 - \u2705 \u81ea\u52a8\u6545\u969c\u6062\u590d\uff08RTO &lt; 20s\uff09 - \u2705 \u652f\u6301\u590d\u6742\u62d3\u6251\uff08\u7ea7\u8054\u590d\u5236\u3001\u5ef6\u8fdf\u4ece\u5e93\uff09 - \u2705 ProxySQL \u63d0\u4f9b\u8bfb\u5199\u5206\u79bb\u4e0e\u8fde\u63a5\u6c60</p> <p>\u7f3a\u70b9 - \u274c \u7ec4\u4ef6\u8f83\u591a\uff0c\u8fd0\u7ef4\u590d\u6742\u5ea6\u9ad8 - \u274c \u9700\u8981\u5b66\u4e60 Orchestrator \u548c ProxySQL - \u274c \u5f02\u6b65\u590d\u5236\u4ecd\u53ef\u80fd\u4e22\u6570\u636e</p> <p>\u9002\u7528\u573a\u666f - \u5927\u89c4\u6a21 MySQL \u96c6\u7fa4\u7ba1\u7406 - \u9700\u8981\u7075\u6d3b\u62d3\u6251\u8c03\u6574 - \u8bfb\u5199\u5206\u79bb + \u8fde\u63a5\u6c60\u9700\u6c42</p>"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#24-mysql","title":"2.4 MySQL \u65b9\u6848\u5bf9\u6bd4\u603b\u7ed3","text":"\u65b9\u6848 RPO RTO \u590d\u6742\u5ea6 \u6210\u672c \u63a8\u8350\u573a\u666f MHA \u79d2\u7ea7 30s \u4e2d \u4f4e \u4e2d\u5c0f\u578b\u4e1a\u52a1 MGR 0 10s \u9ad8 \u4e2d \u91d1\u878d/\u652f\u4ed8 Orchestrator \u79d2\u7ea7 20s \u9ad8 \u4e2d \u5927\u89c4\u6a21\u96c6\u7fa4"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#3-redis","title":"3. Redis \u9ad8\u53ef\u7528\u65b9\u6848","text":""},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#31-redis-sentinel","title":"3.1 \u65b9\u6848\u4e00\uff1aRedis Sentinel","text":"<p>\u67b6\u6784</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502Sentinel1 \u2502\u2500\u2500\u2500\u2500&gt;\u2502Sentinel2 \u2502\u2500\u2500\u2500\u2500&gt;\u2502Sentinel3 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n      \u2502               \u2502               \u2502\n      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                      \u2193\n              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n              \u2502  Redis Master \u2502\n              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                      \u2502\n              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n              \u2193               \u2193\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502 Slave1  \u2502     \u2502 Slave2  \u2502\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>\u4f18\u70b9 - \u2705 \u5b98\u65b9\u63a8\u8350\u65b9\u6848 - \u2705 \u81ea\u52a8\u6545\u969c\u68c0\u6d4b\u4e0e\u5207\u6362\uff08RTO &lt; 5s\uff09 - \u2705 \u914d\u7f6e\u7b80\u5355\uff0c\u8fd0\u7ef4\u6210\u672c\u4f4e - \u2705 \u652f\u6301\u591a\u4e2a\u4ece\u8282\u70b9\uff08\u8bfb\u5199\u5206\u79bb\uff09</p> <p>\u7f3a\u70b9 - \u274c \u5355\u4e3b\u5199\u5165\uff08\u65e0\u6cd5\u6c34\u5e73\u6269\u5c55\u5199\u80fd\u529b\uff09 - \u274c \u5ba2\u6237\u7aef\u9700\u652f\u6301 Sentinel \u534f\u8bae - \u274c \u8111\u88c2\u53ef\u80fd\u5bfc\u81f4\u6570\u636e\u4e22\u5931</p> <p>\u9002\u7528\u573a\u666f - \u4e2d\u5c0f\u578b\u7f13\u5b58\u573a\u666f\uff08QPS &lt; 100000\uff09 - \u8bfb\u591a\u5199\u5c11 - \u6570\u636e\u91cf &lt; \u5355\u673a\u5185\u5b58\u5bb9\u91cf</p> <p>\u90e8\u7f72\u793a\u4f8b</p> <pre><code># sentinel.conf\nport 26379\nsentinel monitor mymaster 192.168.1.10 6379 2\nsentinel down-after-milliseconds mymaster 5000\nsentinel failover-timeout mymaster 10000\nsentinel parallel-syncs mymaster 1\n\n# \u542f\u52a8 Sentinel\nredis-sentinel /etc/redis/sentinel.conf\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#32-redis-cluster","title":"3.2 \u65b9\u6848\u4e8c\uff1aRedis Cluster","text":"<p>\u67b6\u6784</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502Master1  \u2502  \u2502Master2  \u2502  \u2502Master3  \u2502\n\u2502Slot:    \u2502  \u2502Slot:    \u2502  \u2502Slot:    \u2502\n\u25020-5460   \u2502  \u25025461-    \u2502  \u250210923-   \u2502\n\u2502         \u2502  \u250210922    \u2502  \u250216383    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2502            \u2502            \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Slave1  \u2502  \u2502 Slave2  \u2502  \u2502 Slave3  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>\u4f18\u70b9 - \u2705 \u6c34\u5e73\u6269\u5c55\uff08\u652f\u6301 1000+ \u8282\u70b9\uff09 - \u2705 \u81ea\u52a8\u5206\u7247\uff0816384 \u4e2a slot\uff09 - \u2705 \u81ea\u52a8\u6545\u969c\u8f6c\u79fb\uff08RTO &lt; 5s\uff09 - \u2705 \u65e0\u4e2d\u5fc3\u5316\u67b6\u6784</p> <p>\u7f3a\u70b9 - \u274c \u4e0d\u652f\u6301\u591a\u952e\u64cd\u4f5c\uff08\u8de8 slot\uff09 - \u274c \u5ba2\u6237\u7aef\u9700\u652f\u6301 Cluster \u534f\u8bae - \u274c \u8fd0\u7ef4\u590d\u6742\u5ea6\u9ad8\uff08\u6269\u7f29\u5bb9\u3001\u6570\u636e\u8fc1\u79fb\uff09 - \u274c \u4e8b\u52a1\u652f\u6301\u53d7\u9650</p> <p>\u9002\u7528\u573a\u666f - \u5927\u89c4\u6a21\u7f13\u5b58\uff08\u6570\u636e\u91cf &gt; \u5355\u673a\u5185\u5b58\uff09 - \u9ad8\u5e76\u53d1\u5199\u5165\uff08QPS &gt; 100000\uff09 - \u9700\u8981\u6c34\u5e73\u6269\u5c55</p> <p>\u90e8\u7f72\u793a\u4f8b</p> <pre><code># \u521b\u5efa\u96c6\u7fa4\uff086 \u8282\u70b9\uff1a3 \u4e3b 3 \u4ece\uff09\nredis-cli --cluster create \\\n  192.168.1.10:6379 192.168.1.11:6379 192.168.1.12:6379 \\\n  192.168.1.13:6379 192.168.1.14:6379 192.168.1.15:6379 \\\n  --cluster-replicas 1\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#33-keepalived-redis","title":"3.3 \u65b9\u6848\u4e09\uff1aKeepalived + Redis \u4e3b\u4ece","text":"<p>\u67b6\u6784</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   VIP        \u2502 (\u865a\u62df IP\uff0c\u7531 Keepalived \u7ba1\u7406)\n\u2502 192.168.1.100\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n   \u250c\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2510\n   \u2193       \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Master  \u2502 \u2502 Slave   \u2502\n\u2502+Keepalived\u2502+Keepalived\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>\u4f18\u70b9 - \u2705 \u7b80\u5355\u6613\u7528 - \u2705 VIP \u5207\u6362\u5bf9\u5e94\u7528\u900f\u660e - \u2705 \u6210\u672c\u4f4e</p> <p>\u7f3a\u70b9 - \u274c \u9700\u624b\u52a8\u63d0\u5347\u4ece\u5e93\u4e3a\u4e3b\u5e93 - \u274c \u8111\u88c2\u98ce\u9669\u9ad8 - \u274c \u4e0d\u9002\u5408\u751f\u4ea7\u73af\u5883</p> <p>\u9002\u7528\u573a\u666f - \u6d4b\u8bd5/\u5f00\u53d1\u73af\u5883 - \u9884\u7b97\u6709\u9650\u7684\u5c0f\u578b\u9879\u76ee</p>"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#34-redis","title":"3.4 Redis \u65b9\u6848\u5bf9\u6bd4\u603b\u7ed3","text":"\u65b9\u6848 \u6269\u5c55\u6027 RTO \u590d\u6742\u5ea6 \u63a8\u8350\u573a\u666f Sentinel \u5355\u4e3b 5s \u4f4e \u4e2d\u5c0f\u578b\u7f13\u5b58 Cluster \u6c34\u5e73\u6269\u5c55 5s \u9ad8 \u5927\u89c4\u6a21/\u9ad8\u5e76\u53d1 Keepalived \u5355\u4e3b \u624b\u52a8 \u4f4e \u6d4b\u8bd5\u73af\u5883"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#4-mongodb","title":"4. MongoDB \u9ad8\u53ef\u7528\u65b9\u6848","text":""},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#41-replica-set","title":"4.1 \u65b9\u6848\u4e00\uff1a\u526f\u672c\u96c6\uff08Replica Set\uff09","text":"<p>\u67b6\u6784</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Primary \u2502\u2500\u2500\u2500\u2500&gt;\u2502Secondary\u2502\u2500\u2500\u2500\u2500&gt;\u2502Secondary\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n      \u2191              \u2191              \u2191\n      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n           \u9009\u4e3e\u534f\u8bae\uff08\u591a\u6570\u6d3e\uff09\n</code></pre> <p>\u4f18\u70b9 - \u2705 \u5b98\u65b9\u63a8\u8350\uff0c\u539f\u751f\u652f\u6301 - \u2705 \u81ea\u52a8\u6545\u969c\u8f6c\u79fb\uff08RTO &lt; 10s\uff09 - \u2705 \u5f3a\u4e00\u81f4\u6027\uff08\u5199\u5173\u6ce8 majority\uff09 - \u2705 \u8bfb\u5199\u5206\u79bb\uff08\u53ef\u914d\u7f6e\u8bfb\u504f\u597d\uff09</p> <p>\u7f3a\u70b9 - \u274c \u5355\u4e3b\u5199\u5165\uff08\u65e0\u6cd5\u6c34\u5e73\u6269\u5c55\u5199\u80fd\u529b\uff09 - \u274c \u6570\u636e\u91cf\u53d7\u9650\u4e8e\u5355\u673a\u5b58\u50a8</p> <p>\u9002\u7528\u573a\u666f - \u4e2d\u5c0f\u578b\u5e94\u7528\uff08\u6570\u636e\u91cf &lt; 2TB\uff09 - \u5f3a\u4e00\u81f4\u6027\u8981\u6c42 - \u8bfb\u591a\u5199\u5c11</p> <p>\u90e8\u7f72\u793a\u4f8b</p> <pre><code>// \u521d\u59cb\u5316\u526f\u672c\u96c6\nrs.initiate({\n  _id: \"rs0\",\n  members: [\n    { _id: 0, host: \"192.168.1.10:27017\" },\n    { _id: 1, host: \"192.168.1.11:27017\" },\n    { _id: 2, host: \"192.168.1.12:27017\" }\n  ]\n})\n\n// \u67e5\u770b\u72b6\u6001\nrs.status()\n</code></pre>"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#42-sharded-cluster","title":"4.2 \u65b9\u6848\u4e8c\uff1a\u5206\u7247\u96c6\u7fa4\uff08Sharded Cluster\uff09","text":"<p>\u67b6\u6784</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 mongos   \u2502  \u2502 mongos   \u2502 (\u8def\u7531)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502           \u2502\n   \u250c\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2510\n   \u2193                   \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502Config Server\u2502  \u2502Config Server\u2502 (\u5143\u6570\u636e)\n\u2502 Replica Set \u2502  \u2502 Replica Set \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n   \u250c\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2193               \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Shard1  \u2502  \u2502 Shard2  \u2502 (\u6570\u636e\u5206\u7247)\n\u2502ReplicaSet\u2502 \u2502ReplicaSet\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>\u4f18\u70b9 - \u2705 \u6c34\u5e73\u6269\u5c55\uff08\u6570\u636e + \u5199\u5165\u80fd\u529b\uff09 - \u2705 \u9ad8\u53ef\u7528\uff08\u6bcf\u4e2a\u5206\u7247\u90fd\u662f\u526f\u672c\u96c6\uff09 - \u2705 \u652f\u6301\u6d77\u91cf\u6570\u636e\uff08PB \u7ea7\uff09</p> <p>\u7f3a\u70b9 - \u274c \u67b6\u6784\u590d\u6742\uff0c\u8fd0\u7ef4\u6210\u672c\u9ad8 - \u274c \u5206\u7247\u952e\u9009\u62e9\u4e0d\u5f53\u5f71\u54cd\u6027\u80fd - \u274c \u8de8\u5206\u7247\u67e5\u8be2\u6027\u80fd\u5dee</p> <p>\u9002\u7528\u573a\u666f - \u5927\u89c4\u6a21\u5e94\u7528\uff08\u6570\u636e\u91cf &gt; 2TB\uff09 - \u9ad8\u5e76\u53d1\u5199\u5165 - \u9700\u8981\u6c34\u5e73\u6269\u5c55</p>"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#43-mongodb","title":"4.3 MongoDB \u65b9\u6848\u5bf9\u6bd4\u603b\u7ed3","text":"\u65b9\u6848 \u6269\u5c55\u6027 RTO \u590d\u6742\u5ea6 \u63a8\u8350\u573a\u666f \u526f\u672c\u96c6 \u5355\u4e3b 10s \u4f4e \u4e2d\u5c0f\u578b\u5e94\u7528 \u5206\u7247\u96c6\u7fa4 \u6c34\u5e73\u6269\u5c55 10s \u9ad8 \u5927\u89c4\u6a21/\u6d77\u91cf\u6570\u636e"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#5","title":"5. \u4e1a\u52a1\u573a\u666f\u9009\u578b\u5efa\u8bae","text":""},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#51","title":"5.1 \u7535\u5546\u573a\u666f","text":"<p>\u9700\u6c42\uff1a\u9ad8\u5e76\u53d1\u3001\u8bfb\u591a\u5199\u5c11\u3001\u6570\u636e\u4e00\u81f4\u6027\u8981\u6c42\u9ad8</p> <p>\u63a8\u8350\u65b9\u6848 - MySQL\uff1aMGR\uff08\u8ba2\u5355/\u652f\u4ed8\uff09+ MHA\uff08\u5546\u54c1/\u7528\u6237\uff09 - Redis\uff1aCluster\uff08\u5546\u54c1\u7f13\u5b58\u3001\u8d2d\u7269\u8f66\uff09 - MongoDB\uff1a\u526f\u672c\u96c6\uff08\u7528\u6237\u884c\u4e3a\u65e5\u5fd7\uff09</p>"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#52","title":"5.2 \u793e\u4ea4\u5a92\u4f53","text":"<p>\u9700\u6c42\uff1a\u6d77\u91cf\u6570\u636e\u3001\u9ad8\u5e76\u53d1\u5199\u5165\u3001\u5f31\u4e00\u81f4\u6027\u53ef\u63a5\u53d7</p> <p>\u63a8\u8350\u65b9\u6848 - MySQL\uff1aMHA + \u5206\u5e93\u5206\u8868\uff08\u7528\u6237\u5173\u7cfb\uff09 - Redis\uff1aCluster\uff08\u70ed\u70b9\u6570\u636e\u3001Feed \u6d41\uff09 - MongoDB\uff1a\u5206\u7247\u96c6\u7fa4\uff08\u5e16\u5b50\u3001\u8bc4\u8bba\uff09</p>"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#53","title":"5.3 \u91d1\u878d\u652f\u4ed8","text":"<p>\u9700\u6c42\uff1a\u5f3a\u4e00\u81f4\u6027\u3001\u96f6\u6570\u636e\u4e22\u5931\u3001\u9ad8\u53ef\u7528</p> <p>\u63a8\u8350\u65b9\u6848 - MySQL\uff1aMGR\uff08\u4ea4\u6613\u6838\u5fc3\uff09 - Redis\uff1aSentinel\uff08\u4f1a\u8bdd\u7f13\u5b58\uff09 - MongoDB\uff1a\u526f\u672c\u96c6 + majority \u5199\u5173\u6ce8\uff08\u5ba1\u8ba1\u65e5\u5fd7\uff09</p>"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#54-iot","title":"5.4 \u7269\u8054\u7f51\uff08IoT\uff09","text":"<p>\u9700\u6c42\uff1a\u6d77\u91cf\u65f6\u5e8f\u6570\u636e\u3001\u9ad8\u5e76\u53d1\u5199\u5165</p> <p>\u63a8\u8350\u65b9\u6848 - MySQL\uff1aMHA\uff08\u8bbe\u5907\u5143\u6570\u636e\uff09 - Redis\uff1aCluster\uff08\u5b9e\u65f6\u72b6\u6001\uff09 - MongoDB\uff1a\u5206\u7247\u96c6\u7fa4\uff08\u65f6\u5e8f\u6570\u636e\uff09</p>"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#6","title":"6. \u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u591a\u6d3b\u90e8\u7f72\uff1a\u540c\u57ce\u53cc\u6d3b/\u4e24\u5730\u4e09\u4e2d\u5fc3</li> <li>\u76d1\u63a7\u5148\u884c\uff1a\u90e8\u7f72\u524d\u914d\u7f6e\u5b8c\u6574\u76d1\u63a7\u544a\u8b66</li> <li>\u5b9a\u671f\u6f14\u7ec3\uff1a\u6bcf\u5b63\u5ea6\u8fdb\u884c\u6545\u969c\u5207\u6362\u6f14\u7ec3</li> <li>\u5bb9\u91cf\u89c4\u5212\uff1a\u63d0\u524d 6 \u4e2a\u6708\u9884\u6d4b\u8d44\u6e90\u9700\u6c42</li> <li>\u5907\u4efd\u7b56\u7565\uff1a3-2-1 \u539f\u5219\uff083 \u4efd\u526f\u672c\u30012 \u79cd\u4ecb\u8d28\u30011 \u4efd\u5f02\u5730\uff09</li> </ol>"},{"location":"dba/MySQL-Redis-MongoDB-%E9%AB%98%E5%8F%AF%E7%94%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94%E4%B8%8E%E9%80%89%E5%9E%8B.html#7","title":"7. \u53c2\u8003\u8d44\u6599","text":"<ul> <li>MySQL HA \u65b9\u6848\uff1ahttps://dev.mysql.com/doc/refman/8.0/en/replication.html</li> <li>Redis \u9ad8\u53ef\u7528\uff1ahttps://redis.io/topics/sentinel</li> <li>MongoDB \u526f\u672c\u96c6\uff1ahttps://www.mongodb.com/docs/manual/replication/</li> </ul> <p>\u4f5c\u8005\uff1a\u67b6\u6784\u56e2\u961f \u66f4\u65b0\u65f6\u95f4\uff1a2025-11-11</p>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html","title":"MySQL \u4e3b\u4ece\u590d\u5236\u4e0e\u9ad8\u53ef\u7528\u67b6\u6784\u65b9\u6848","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aMySQL DBA\u3001\u8fd0\u7ef4\u5de5\u7a0b\u5e08\u3001\u67b6\u6784\u5e08 \u76ee\u6807\uff1a\u63d0\u4f9b MySQL \u4e3b\u4ece\u590d\u5236\u3001\u534a\u540c\u6b65\u590d\u5236\u3001MGR\u3001MHA \u7b49\u9ad8\u53ef\u7528\u65b9\u6848\u7684\u5b8c\u6574\u5b9e\u65bd\u6307\u5357\u3002</p>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#1-mysql","title":"1. MySQL \u590d\u5236\u67b6\u6784\u6982\u8ff0","text":""},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#11","title":"1.1 \u590d\u5236\u7c7b\u578b\u5bf9\u6bd4","text":"\u590d\u5236\u7c7b\u578b \u5ef6\u8fdf \u6570\u636e\u4e00\u81f4\u6027 \u590d\u6742\u5ea6 \u9002\u7528\u573a\u666f \u5f02\u6b65\u590d\u5236 \u4f4e \u5f31 \u4f4e \u8bfb\u5199\u5206\u79bb\u3001\u62a5\u8868\u67e5\u8be2 \u534a\u540c\u6b65\u590d\u5236 \u4e2d \u5f3a \u4e2d \u91d1\u878d\u3001\u7535\u5546\u6838\u5fc3\u4e1a\u52a1 \u7ec4\u590d\u5236 (MGR) \u4e2d \u5f3a\uff08\u591a\u6570\u6d3e\uff09 \u9ad8 \u5206\u5e03\u5f0f\u9ad8\u53ef\u7528 \u540c\u6b65\u590d\u5236 (Galera) \u9ad8 \u5f3a \u9ad8 \u5f3a\u4e00\u81f4\u6027\u8981\u6c42"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#12","title":"1.2 \u67b6\u6784\u9009\u578b\u5efa\u8bae","text":"<ul> <li>\u4e00\u4e3b\u591a\u4ece\uff1a\u8bfb\u591a\u5199\u5c11\uff0c\u8bfb\u5199\u5206\u79bb\uff0c\u6210\u672c\u4f4e</li> <li>\u53cc\u4e3b\u4e92\u5907\uff1a\u5feb\u901f\u6545\u969c\u5207\u6362\uff0c\u9700\u9632\u6b62\u8111\u88c2</li> <li>MHA/MMM\uff1a\u81ea\u52a8\u6545\u969c\u5207\u6362\uff0c\u9002\u5408\u4f20\u7edf\u4e3b\u4ece</li> <li>MGR (MySQL Group Replication)\uff1a\u539f\u751f\u591a\u4e3b\uff0c\u5f3a\u4e00\u81f4\u6027</li> <li>ProxySQL + \u4e3b\u4ece\uff1a\u667a\u80fd\u8bfb\u5199\u5206\u79bb\uff0c\u8fde\u63a5\u6c60</li> </ul>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#2","title":"2. \u4f20\u7edf\u4e3b\u4ece\u590d\u5236\u90e8\u7f72","text":""},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#21","title":"2.1 \u73af\u5883\u51c6\u5907","text":"<pre><code># \u4e3b\u5e93\uff1a192.168.1.10 (master)\n# \u4ece\u5e931\uff1a192.168.1.11 (slave1)\n# \u4ece\u5e932\uff1a192.168.1.12 (slave2)\n\n# MySQL 8.0 \u5b89\u88c5\uff08\u6240\u6709\u8282\u70b9\uff09\nyum install -y mysql-community-server-8.0.35\nsystemctl enable mysqld\nsystemctl start mysqld\n\n# \u83b7\u53d6\u4e34\u65f6\u5bc6\u7801\ngrep 'temporary password' /var/log/mysqld.log\nmysql -uroot -p\nALTER USER 'root'@'localhost' IDENTIFIED BY 'NewPass123#';\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#22","title":"2.2 \u4e3b\u5e93\u914d\u7f6e","text":"<pre><code># /etc/my.cnf (\u4e3b\u5e93)\n[mysqld]\nserver-id = 1\nlog-bin = mysql-bin\nbinlog-format = ROW\ngtid-mode = ON\nenforce-gtid-consistency = ON\nlog-slave-updates = ON\nbinlog-do-db = myapp_db\nbinlog-ignore-db = mysql,information_schema,performance_schema\n\n# \u4e8c\u8fdb\u5236\u65e5\u5fd7\u4fdd\u7559\u65f6\u95f4\uff087\u5929\uff09\nbinlog_expire_logs_seconds = 604800\n\n# \u534a\u540c\u6b65\u590d\u5236\u63d2\u4ef6\uff08\u53ef\u9009\uff09\nplugin-load = \"rpl_semi_sync_master=semisync_master.so\"\nrpl_semi_sync_master_enabled = 1\nrpl_semi_sync_master_timeout = 1000\n\n# \u6027\u80fd\u4f18\u5316\nsync_binlog = 1\ninnodb_flush_log_at_trx_commit = 1\n</code></pre> <pre><code>-- \u91cd\u542f MySQL\nsystemctl restart mysqld\n\n-- \u521b\u5efa\u590d\u5236\u7528\u6237\nCREATE USER 'repl'@'192.168.1.%' IDENTIFIED WITH mysql_native_password BY 'Repl123#';\nGRANT REPLICATION SLAVE ON *.* TO 'repl'@'192.168.1.%';\nFLUSH PRIVILEGES;\n\n-- \u67e5\u770b\u4e3b\u5e93\u72b6\u6001\nSHOW MASTER STATUS;\n-- \u8bb0\u5f55 File \u548c Position\uff08\u5982\u679c\u4f7f\u7528 GTID \u5219\u4e0d\u9700\u8981\uff09\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#23","title":"2.3 \u4ece\u5e93\u914d\u7f6e","text":"<pre><code># /etc/my.cnf (\u4ece\u5e93)\n[mysqld]\nserver-id = 2  # \u6bcf\u4e2a\u4ece\u5e93\u552f\u4e00\nlog-bin = mysql-bin\nbinlog-format = ROW\ngtid-mode = ON\nenforce-gtid-consistency = ON\nlog-slave-updates = ON\nread-only = 1\nsuper-read-only = 1\n\n# \u534a\u540c\u6b65\u590d\u5236\u63d2\u4ef6\uff08\u53ef\u9009\uff09\nplugin-load = \"rpl_semi_sync_slave=semisync_slave.so\"\nrpl_semi_sync_slave_enabled = 1\n\n# \u4e2d\u7ee7\u65e5\u5fd7\nrelay-log = relay-bin\nrelay-log-recovery = 1\n</code></pre> <pre><code>-- \u91cd\u542f MySQL\nsystemctl restart mysqld\n\n-- \u914d\u7f6e\u4e3b\u4ece\u590d\u5236\uff08\u57fa\u4e8e GTID\uff09\nCHANGE MASTER TO\n  MASTER_HOST='192.168.1.10',\n  MASTER_USER='repl',\n  MASTER_PASSWORD='Repl123#',\n  MASTER_AUTO_POSITION=1;\n\n-- \u542f\u52a8\u590d\u5236\nSTART SLAVE;\n\n-- \u68c0\u67e5\u590d\u5236\u72b6\u6001\nSHOW SLAVE STATUS\\G\n\n-- \u5173\u952e\u6307\u6807\uff1a\n-- Slave_IO_Running: Yes\n-- Slave_SQL_Running: Yes\n-- Seconds_Behind_Master: 0\n-- Last_IO_Error: (\u7a7a)\n-- Last_SQL_Error: (\u7a7a)\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#24","title":"2.4 \u6570\u636e\u521d\u59cb\u5316\uff08\u5df2\u6709\u6570\u636e\uff09","text":"<pre><code># \u5728\u4e3b\u5e93\u5907\u4efd\nmysqldump -uroot -p --single-transaction --master-data=2 \\\n  --triggers --routines --events --all-databases &gt; /tmp/master_backup.sql\n\n# \u4f20\u8f93\u5230\u4ece\u5e93\nscp /tmp/master_backup.sql root@192.168.1.11:/tmp/\n\n# \u5728\u4ece\u5e93\u5bfc\u5165\nmysql -uroot -p &lt; /tmp/master_backup.sql\n\n# \u914d\u7f6e\u590d\u5236\uff08\u4ece\u5907\u4efd\u6587\u4ef6\u4e2d\u83b7\u53d6 GTID \u6216 binlog \u4f4d\u7f6e\uff09\ngrep \"CHANGE MASTER TO\" /tmp/master_backup.sql\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#3","title":"3. \u534a\u540c\u6b65\u590d\u5236\u914d\u7f6e","text":""},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#31","title":"3.1 \u542f\u7528\u534a\u540c\u6b65","text":"<pre><code>-- \u4e3b\u5e93\nINSTALL PLUGIN rpl_semi_sync_master SONAME 'semisync_master.so';\nSET GLOBAL rpl_semi_sync_master_enabled = 1;\nSET GLOBAL rpl_semi_sync_master_timeout = 1000; -- 1\u79d2\u8d85\u65f6\n\n-- \u4ece\u5e93\nINSTALL PLUGIN rpl_semi_sync_slave SONAME 'semisync_slave.so';\nSET GLOBAL rpl_semi_sync_slave_enabled = 1;\nSTOP SLAVE IO_THREAD;\nSTART SLAVE IO_THREAD;\n\n-- \u9a8c\u8bc1\u534a\u540c\u6b65\u72b6\u6001\nSHOW STATUS LIKE 'Rpl_semi_sync%';\n-- Rpl_semi_sync_master_status: ON\n-- Rpl_semi_sync_master_clients: 2\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#32","title":"3.2 \u76d1\u63a7\u534a\u540c\u6b65","text":"<pre><code>-- \u4e3b\u5e93\u76d1\u63a7\nSELECT \n    VARIABLE_NAME, \n    VARIABLE_VALUE \nFROM performance_schema.global_status \nWHERE VARIABLE_NAME LIKE 'Rpl_semi_sync%';\n\n-- \u5173\u952e\u6307\u6807\uff1a\n-- Rpl_semi_sync_master_yes_tx: \u534a\u540c\u6b65\u6210\u529f\u4e8b\u52a1\u6570\n-- Rpl_semi_sync_master_no_tx: \u964d\u7ea7\u4e3a\u5f02\u6b65\u7684\u4e8b\u52a1\u6570\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#4-mysql-group-replication-mgr","title":"4. MySQL Group Replication (MGR)","text":""},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#41-mgr","title":"4.1 MGR \u67b6\u6784","text":"<ul> <li>\u5355\u4e3b\u6a21\u5f0f\uff1a\u4e00\u4e2a\u4e3b\u8282\u70b9\u5199\u5165\uff0c\u5176\u4ed6\u8282\u70b9\u53ea\u8bfb</li> <li>\u591a\u4e3b\u6a21\u5f0f\uff1a\u6240\u6709\u8282\u70b9\u53ef\u5199\uff0c\u81ea\u52a8\u51b2\u7a81\u68c0\u6d4b</li> </ul>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#42-mgr","title":"4.2 MGR \u90e8\u7f72\uff08\u5355\u4e3b\u6a21\u5f0f\uff09","text":"<pre><code># /etc/my.cnf (\u6240\u6709\u8282\u70b9)\n[mysqld]\nserver-id = 1  # \u6bcf\u4e2a\u8282\u70b9\u552f\u4e00\ngtid-mode = ON\nenforce-gtid-consistency = ON\nbinlog-checksum = NONE\nlog-slave-updates = ON\nlog-bin = mysql-bin\nbinlog-format = ROW\nmaster-info-repository = TABLE\nrelay-log-info-repository = TABLE\n\n# MGR \u914d\u7f6e\nplugin-load-add = 'group_replication.so'\ngroup_replication_group_name = \"aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee\"\ngroup_replication_start_on_boot = OFF\ngroup_replication_local_address = \"192.168.1.10:33061\"\ngroup_replication_group_seeds = \"192.168.1.10:33061,192.168.1.11:33061,192.168.1.12:33061\"\ngroup_replication_bootstrap_group = OFF\ngroup_replication_single_primary_mode = ON\ngroup_replication_enforce_update_everywhere_checks = OFF\n</code></pre> <pre><code>-- \u5728\u7b2c\u4e00\u4e2a\u8282\u70b9\uff08\u5f15\u5bfc\u8282\u70b9\uff09\nSET GLOBAL group_replication_bootstrap_group=ON;\nSTART GROUP_REPLICATION;\nSET GLOBAL group_replication_bootstrap_group=OFF;\n\n-- \u5728\u5176\u4ed6\u8282\u70b9\nSTART GROUP_REPLICATION;\n\n-- \u68c0\u67e5 MGR \u72b6\u6001\nSELECT * FROM performance_schema.replication_group_members;\n\n-- \u8f93\u51fa\u793a\u4f8b\uff1a\n-- MEMBER_ID | MEMBER_HOST | MEMBER_PORT | MEMBER_STATE | MEMBER_ROLE\n-- uuid1     | 192.168.1.10| 3306        | ONLINE       | PRIMARY\n-- uuid2     | 192.168.1.11| 3306        | ONLINE       | SECONDARY\n-- uuid3     | 192.168.1.12| 3306        | ONLINE       | SECONDARY\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#43-mgr","title":"4.3 MGR \u6545\u969c\u5207\u6362","text":"<pre><code>-- \u4e3b\u8282\u70b9\u6545\u969c\u540e\uff0c\u81ea\u52a8\u9009\u4e3e\u65b0\u4e3b\n-- \u67e5\u770b\u5f53\u524d\u4e3b\u8282\u70b9\nSELECT \n    MEMBER_HOST, \n    MEMBER_ROLE \nFROM performance_schema.replication_group_members \nWHERE MEMBER_ROLE='PRIMARY';\n\n-- \u624b\u52a8\u5207\u6362\u4e3b\u8282\u70b9\uff08\u591a\u4e3b\u6a21\u5f0f\uff09\nSELECT group_replication_set_as_primary('member_uuid');\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#5-mha-master-high-availability","title":"5. MHA (Master High Availability) \u90e8\u7f72","text":""},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#51-mha","title":"5.1 MHA \u67b6\u6784","text":"<ul> <li>MHA Manager\uff1a\u76d1\u63a7\u4e3b\u5e93\uff0c\u6267\u884c\u6545\u969c\u5207\u6362</li> <li>MHA Node\uff1a\u5b89\u88c5\u5728\u6240\u6709 MySQL \u8282\u70b9\uff0c\u6267\u884c\u5207\u6362\u811a\u672c</li> </ul>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#52-mha","title":"5.2 \u5b89\u88c5 MHA","text":"<pre><code># \u6240\u6709\u8282\u70b9\u5b89\u88c5 MHA Node\nyum install -y perl-DBD-MySQL\nrpm -ivh mha4mysql-node-0.58-0.el7.centos.noarch.rpm\n\n# Manager \u8282\u70b9\u5b89\u88c5 MHA Manager\nyum install -y perl-Config-Tiny perl-Log-Dispatch perl-Parallel-ForkManager\nrpm -ivh mha4mysql-manager-0.58-0.el7.centos.noarch.rpm\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#53-mha","title":"5.3 MHA \u914d\u7f6e","text":"<pre><code># /etc/mha/app1.cnf (Manager \u8282\u70b9)\n[server default]\nmanager_workdir=/var/log/mha/app1\nmanager_log=/var/log/mha/app1/manager.log\nremote_workdir=/var/log/mha/app1\nssh_user=root\nrepl_user=repl\nrepl_password=Repl123#\nping_interval=3\nmaster_ip_failover_script=/usr/local/bin/master_ip_failover\nshutdown_script=/usr/local/bin/power_manager\nreport_script=/usr/local/bin/send_report\n\n[server1]\nhostname=192.168.1.10\nport=3306\ncandidate_master=1\ncheck_repl_delay=0\n\n[server2]\nhostname=192.168.1.11\nport=3306\ncandidate_master=1\ncheck_repl_delay=0\n\n[server3]\nhostname=192.168.1.12\nport=3306\nno_master=1\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#54-vip","title":"5.4 VIP \u5207\u6362\u811a\u672c","text":"<pre><code># /usr/local/bin/master_ip_failover\n#!/usr/bin/env perl\nuse strict;\nuse warnings FATAL =&gt; 'all';\n\nmy $vip = '192.168.1.100/24';\nmy $key = '1';\nmy $ssh_start_vip = \"/sbin/ip addr add $vip dev eth0 label eth0:$key\";\nmy $ssh_stop_vip = \"/sbin/ip addr del $vip dev eth0 label eth0:$key\";\n\n# \u7701\u7565\u5b8c\u6574\u811a\u672c\uff0c\u53c2\u8003 MHA \u5b98\u65b9\u6587\u6863\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#55-mha","title":"5.5 \u542f\u52a8 MHA","text":"<pre><code># \u68c0\u67e5 SSH \u8fde\u901a\u6027\nmasterha_check_ssh --conf=/etc/mha/app1.cnf\n\n# \u68c0\u67e5\u590d\u5236\u72b6\u6001\nmasterha_check_repl --conf=/etc/mha/app1.cnf\n\n# \u542f\u52a8 MHA Manager\nnohup masterha_manager --conf=/etc/mha/app1.cnf &gt; /var/log/mha/app1/manager.log 2&gt;&amp;1 &amp;\n\n# \u68c0\u67e5 MHA \u72b6\u6001\nmasterha_check_status --conf=/etc/mha/app1.cnf\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#6-proxysql","title":"6. ProxySQL \u8bfb\u5199\u5206\u79bb","text":""},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#61-proxysql","title":"6.1 \u5b89\u88c5 ProxySQL","text":"<pre><code>yum install -y proxysql\nsystemctl enable proxysql\nsystemctl start proxysql\n\n# \u767b\u5f55 ProxySQL \u7ba1\u7406\u7aef\u53e3\nmysql -uadmin -padmin -h127.0.0.1 -P6032\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#62","title":"6.2 \u914d\u7f6e\u540e\u7aef\u670d\u52a1\u5668","text":"<pre><code>-- \u6dfb\u52a0 MySQL \u670d\u52a1\u5668\nINSERT INTO mysql_servers(hostgroup_id, hostname, port) \nVALUES (1, '192.168.1.10', 3306);  -- \u4e3b\u5e93\uff08\u5199\uff09\n\nINSERT INTO mysql_servers(hostgroup_id, hostname, port) \nVALUES (2, '192.168.1.11', 3306);  -- \u4ece\u5e931\uff08\u8bfb\uff09\n\nINSERT INTO mysql_servers(hostgroup_id, hostname, port) \nVALUES (2, '192.168.1.12', 3306);  -- \u4ece\u5e932\uff08\u8bfb\uff09\n\nLOAD MYSQL SERVERS TO RUNTIME;\nSAVE MYSQL SERVERS TO DISK;\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#63","title":"6.3 \u914d\u7f6e\u7528\u6237\u548c\u8def\u7531\u89c4\u5219","text":"<pre><code>-- \u6dfb\u52a0\u5e94\u7528\u7528\u6237\nINSERT INTO mysql_users(username, password, default_hostgroup) \nVALUES ('appuser', 'AppPass123#', 1);\n\nLOAD MYSQL USERS TO RUNTIME;\nSAVE MYSQL USERS TO DISK;\n\n-- \u914d\u7f6e\u8bfb\u5199\u5206\u79bb\u89c4\u5219\nINSERT INTO mysql_query_rules(rule_id, active, match_pattern, destination_hostgroup, apply)\nVALUES (1, 1, '^SELECT.*FOR UPDATE$', 1, 1);  -- SELECT FOR UPDATE \u8d70\u4e3b\u5e93\n\nINSERT INTO mysql_query_rules(rule_id, active, match_pattern, destination_hostgroup, apply)\nVALUES (2, 1, '^SELECT', 2, 1);  -- \u666e\u901a SELECT \u8d70\u4ece\u5e93\n\nLOAD MYSQL QUERY RULES TO RUNTIME;\nSAVE MYSQL QUERY RULES TO DISK;\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#64","title":"6.4 \u5e94\u7528\u8fde\u63a5","text":"<pre><code># \u5e94\u7528\u8fde\u63a5 ProxySQL\uff08\u7aef\u53e3 6033\uff09\nmysql -uappuser -pAppPass123# -h192.168.1.100 -P6033\n\n# \u6d4b\u8bd5\u8bfb\u5199\u5206\u79bb\nSELECT @@hostname;  -- \u5e94\u8fd4\u56de\u4ece\u5e93\u4e3b\u673a\u540d\nBEGIN; SELECT * FROM users WHERE id=1 FOR UPDATE; COMMIT;  -- \u5e94\u8d70\u4e3b\u5e93\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#7","title":"7. \u76d1\u63a7\u4e0e\u544a\u8b66","text":""},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#71","title":"7.1 \u590d\u5236\u5ef6\u8fdf\u76d1\u63a7","text":"<pre><code>-- \u4ece\u5e93\u6267\u884c\nSHOW SLAVE STATUS\\G\n\n-- \u5173\u952e\u6307\u6807\uff1a\n-- Seconds_Behind_Master: \u5ef6\u8fdf\u79d2\u6570\n-- Slave_IO_Running: IO \u7ebf\u7a0b\u72b6\u6001\n-- Slave_SQL_Running: SQL \u7ebf\u7a0b\u72b6\u6001\n\n-- \u4f7f\u7528 pt-heartbeat\uff08Percona Toolkit\uff09\npt-heartbeat --update --database test --table heartbeat --create-table -h192.168.1.10\npt-heartbeat --monitor --database test --table heartbeat -h192.168.1.11\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#72-prometheus-grafana","title":"7.2 Prometheus + Grafana \u76d1\u63a7","text":"<pre><code># \u5b89\u88c5 mysqld_exporter\nwget https://github.com/prometheus/mysqld_exporter/releases/download/v0.15.0/mysqld_exporter-0.15.0.linux-amd64.tar.gz\ntar -xzf mysqld_exporter-0.15.0.linux-amd64.tar.gz\ncd mysqld_exporter-0.15.0.linux-amd64\n\n# \u521b\u5efa\u76d1\u63a7\u7528\u6237\nCREATE USER 'exporter'@'localhost' IDENTIFIED BY 'Exporter123#';\nGRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO 'exporter'@'localhost';\n\n# \u542f\u52a8 exporter\nexport DATA_SOURCE_NAME='exporter:Exporter123#@(localhost:3306)/'\n./mysqld_exporter &amp;\n\n# Prometheus \u914d\u7f6e\n# prometheus.yml\nscrape_configs:\n  - job_name: 'mysql'\n    static_configs:\n      - targets: ['192.168.1.10:9104', '192.168.1.11:9104', '192.168.1.12:9104']\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#8","title":"8. \u6545\u969c\u5904\u7406","text":""},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#81","title":"8.1 \u4e3b\u4ece\u590d\u5236\u4e2d\u65ad","text":"<pre><code>-- \u68c0\u67e5\u9519\u8bef\nSHOW SLAVE STATUS\\G\n-- Last_SQL_Error: Error 'Duplicate entry...'\n\n-- \u8df3\u8fc7\u9519\u8bef\uff08\u8c28\u614e\u4f7f\u7528\uff09\nSTOP SLAVE;\nSET GLOBAL SQL_SLAVE_SKIP_COUNTER = 1;\nSTART SLAVE;\n\n-- \u6216\u4f7f\u7528 GTID \u8df3\u8fc7\nSTOP SLAVE;\nSET GTID_NEXT='uuid:transaction_id';\nBEGIN; COMMIT;\nSET GTID_NEXT='AUTOMATIC';\nSTART SLAVE;\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#82","title":"8.2 \u4e3b\u5e93\u5b95\u673a\u5207\u6362","text":"<pre><code># \u4f7f\u7528 MHA \u81ea\u52a8\u5207\u6362\n# MHA \u4f1a\u81ea\u52a8\uff1a\n# 1. \u68c0\u6d4b\u4e3b\u5e93\u6545\u969c\n# 2. \u9009\u62e9\u6700\u65b0\u7684\u4ece\u5e93\u4f5c\u4e3a\u65b0\u4e3b\n# 3. \u5e94\u7528\u5dee\u5f02\u65e5\u5fd7\n# 4. \u5207\u6362 VIP\n# 5. \u91cd\u65b0\u914d\u7f6e\u5176\u4ed6\u4ece\u5e93\n\n# \u624b\u52a8\u5207\u6362\uff08\u65e0 MHA\uff09\n# 1. \u5728\u6700\u65b0\u7684\u4ece\u5e93\u4e0a\u6267\u884c\nSTOP SLAVE;\nRESET SLAVE ALL;\n\n# 2. \u914d\u7f6e VIP\nip addr add 192.168.1.100/24 dev eth0\n\n# 3. \u8bbe\u7f6e\u4e3a\u53ef\u5199\nSET GLOBAL read_only=0;\nSET GLOBAL super_read_only=0;\n\n# 4. \u5176\u4ed6\u4ece\u5e93\u6307\u5411\u65b0\u4e3b\nCHANGE MASTER TO MASTER_HOST='192.168.1.11', MASTER_AUTO_POSITION=1;\nSTART SLAVE;\n</code></pre>"},{"location":"dba/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html#9","title":"9. \u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>GTID \u6a21\u5f0f\uff1a\u7b80\u5316\u6545\u969c\u5207\u6362\uff0c\u63a8\u8350\u751f\u4ea7\u73af\u5883\u542f\u7528</li> <li>\u534a\u540c\u6b65\u590d\u5236\uff1a\u91d1\u878d\u3001\u7535\u5546\u7b49\u6838\u5fc3\u4e1a\u52a1\u5fc5\u987b\u542f\u7528</li> <li>\u76d1\u63a7\u544a\u8b66\uff1a\u590d\u5236\u5ef6\u8fdf &gt; 10s \u544a\u8b66\uff0cIO/SQL \u7ebf\u7a0b\u5f02\u5e38\u7acb\u5373\u544a\u8b66</li> <li>\u5b9a\u671f\u6f14\u7ec3\uff1a\u6bcf\u5b63\u5ea6\u8fdb\u884c\u4e3b\u4ece\u5207\u6362\u6f14\u7ec3</li> <li>\u5907\u4efd\u7b56\u7565\uff1a\u4e3b\u5e93\u5168\u91cf\u5907\u4efd + binlog \u5907\u4efd\uff0c\u4ece\u5e93\u53ef\u7528\u4e8e\u5907\u4efd</li> <li>\u53c2\u6570\u4f18\u5316\uff1a</li> <li><code>sync_binlog=1</code></li> <li><code>innodb_flush_log_at_trx_commit=1</code></li> <li><code>binlog_expire_logs_seconds=604800</code>\uff087\u5929\uff09</li> <li>\u7f51\u7edc\u4f18\u5316\uff1a\u4e3b\u4ece\u4e4b\u95f4\u4f7f\u7528\u4e13\u7528\u7f51\u7edc\uff0c\u907f\u514d\u516c\u7f51\u4f20\u8f93</li> </ol> <p>\u53c2\u8003\u6587\u6863\uff1a - MySQL 8.0 Replication Manual - MHA for MySQL Documentation - ProxySQL Documentation - Percona Toolkit Documentation</p>"},{"location":"dba/OceanBase-%E7%A4%BE%E5%8C%BA%E7%89%88-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html","title":"OceanBase \u793e\u533a\u7248\uff1a\u5165\u95e8\u4e0e\u5b89\u88c5\u5b9e\u8df5","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aDBA\u3001\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u521d\u5b66\u8005\u3001\u5e94\u7528\u5f00\u53d1 \u76ee\u6807\uff1a\u4f7f\u7528 OBD \u5feb\u901f\u90e8\u7f72 OceanBase CE \u6700\u5c0f\u96c6\u7fa4\uff0c\u638c\u63e1\u8fde\u63a5\u3001\u57fa\u7840\u8fd0\u7ef4\u4e0e\u5e38\u89c1\u95ee\u9898\u5904\u7406\u3002</p>"},{"location":"dba/OceanBase-%E7%A4%BE%E5%8C%BA%E7%89%88-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#1-oceanbase","title":"1. OceanBase \u6982\u8ff0","text":"<ul> <li>\u7c7b\u578b\uff1a\u5206\u5e03\u5f0f\u4e8b\u52a1\u578b\u6570\u636e\u5e93\uff08NewSQL\uff09\uff0cMySQL/Oracle \u53cc\u534f\u8bae\u517c\u5bb9</li> <li>\u7279\u6027\uff1a\u9ad8\u53ef\u7528\u3001\u591a\u526f\u672c\u5f3a\u4e00\u81f4\u3001\u5f39\u6027\u6269\u7f29\u5bb9\u3001\u8de8\u673a\u623f\u5bb9\u707e</li> <li>\u5178\u578b\u573a\u666f\uff1a\u91d1\u878d\u6838\u5fc3\u3001\u4ea4\u6613\u3001\u8d26\u52a1\u3001\u7528\u6237\u753b\u50cf</li> </ul>"},{"location":"dba/OceanBase-%E7%A4%BE%E5%8C%BA%E7%89%88-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#2-obd","title":"2. \u5feb\u901f\u90e8\u7f72\uff08obd \u6700\u5c0f\u96c6\u7fa4\uff09","text":"<p>\u73af\u5883\uff1aLinux x86_64\uff0c\u5185\u5b58 \u2265 16GB\uff0c\u78c1\u76d8 \u2265 200GB\uff0c\u5173\u95ed\u900f\u660e\u5927\u9875\u3001NUMA</p> <pre><code># 1) \u5b89\u88c5 obd\nyum install -y yum-utils\nyum-config-manager --add-repo https://mirrors.aliyun.com/oceanbase/OceanBase.repo\nyum install -y obd obclient\n\n# 2) \u751f\u6210\u6700\u5c0f\u62d3\u6251\nyum install -y wget &amp;&amp; mkdir -p ~/ob &amp;&amp; cd ~/ob\nobd cluster template -t mini -o obmini.yaml\n\n# 3) \u90e8\u7f72\u5e76\u542f\u52a8\noh=`hostname -I | awk '{print $1}'`\n# \u5982\u9700\u4fee\u6539\u76d1\u542c\u4e0e\u6570\u636e\u76ee\u5f55\uff0c\u7f16\u8f91 obmini.yaml \u540e\u6267\u884c\uff1a\nobd cluster deploy obmini -c obmini.yaml\nobd cluster start obmini\nobd cluster display obmini\n</code></pre>"},{"location":"dba/OceanBase-%E7%A4%BE%E5%8C%BA%E7%89%88-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#3","title":"3. \u8fde\u63a5\u4e0e\u57fa\u672c\u64cd\u4f5c","text":"<pre><code># \u8fde\u63a5\u5230 MySQL \u517c\u5bb9\u63a5\u53e3\uff08\u9ed8\u8ba4 2881\uff09\nobclient -h127.0.0.1 -P2881 -uroot@sys -p -Doceanbase\n# \u521d\u59cb\u5bc6\u7801\u4e3a\u7a7a\uff0c\u9996\u6b21\u767b\u5f55\u540e\u8bbe\u7f6e\uff1a\nALTER USER root IDENTIFIED BY 'Root@123';\n\n# \u521b\u5efa MySQL \u79df\u6237\u4e0e\u4e1a\u52a1\u5e93\nCREATE RESOURCE UNIT unit1 MAX_CPU 2, MEMORY_SIZE '4G';\nCREATE RESOURCE POOL pool1 UNIT='unit1', UNIT_NUM=1, ZONE_LIST=('zone1');\nCREATE TENANT IF NOT EXISTS t_mysql CHARSET='utf8mb4' COLLATE='utf8mb4_bin' \n  REPLICA_NUM=1 ZONE_LIST=('zone1') PRIMARY_ZONE='zone1' \n  RESOURCE_POOL_LIST=('pool1');\n\n# \u5207\u6362\u5230\u79df\u6237\noBclient -h127.0.0.1 -P2881 -uroot@t_mysql -p -Doceanbase\nCREATE DATABASE demo;\nUSE demo;\nCREATE TABLE t1(id bigint primary key, name varchar(50));\nINSERT INTO t1 VALUES (1,'hello'),(2,'oceanbase');\nSELECT * FROM t1;\n</code></pre>"},{"location":"dba/OceanBase-%E7%A4%BE%E5%8C%BA%E7%89%88-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#4","title":"4. \u8fd0\u7ef4\u5e38\u7528","text":"<pre><code># \u67e5\u8be2\u79df\u6237\u3001\u8d44\u6e90\nSHOW TENANT;\nSHOW RESOURCE POOL;\nSHOW PARAMETERS LIKE 'memstore_limit_percentage';\n\n# \u67e5\u770b\u7cfb\u7edf\u79df\u6237\u89c6\u56fe\uff08\u767b\u5f55 sys \u79df\u6237\uff09\nSELECT * FROM oceanbase.__all_server;\nSELECT * FROM oceanbase.__all_virtual_table;\n</code></pre>"},{"location":"dba/OceanBase-%E7%A4%BE%E5%8C%BA%E7%89%88-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#5","title":"5. \u5907\u4efd\u4e0e\u9ad8\u53ef\u7528","text":"<ul> <li>\u526f\u672c\u7b56\u7565\uff1a\u6700\u5c0f 1 \u526f\u672c\uff08\u6d4b\u8bd5\uff09\u3001\u5efa\u8bae\u751f\u4ea7 &gt;= 3 \u526f\u672c</li> <li>\u5907\u4efd\uff1a\u65e5\u5fd7\u5f52\u6863 + \u6570\u636e\u5907\u4efd\uff08\u5bf9\u8c61\u5b58\u50a8/\u5171\u4eab\u5b58\u50a8\uff09\uff0c\u6309\u79df\u6237\u7ef4\u5ea6</li> <li>\u5bb9\u707e\uff1a\u540c\u57ce\u53cc\u6d3b/\u4e24\u5730\u4e09\u4e2d\u5fc3\uff0c\u901a\u8fc7\u591a Zone + \u590d\u5236\u62d3\u6251\u5b9e\u73b0</li> </ul>"},{"location":"dba/OceanBase-%E7%A4%BE%E5%8C%BA%E7%89%88-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#6","title":"6. \u5e38\u89c1\u95ee\u9898","text":"<ul> <li>\u542f\u52a8\u5931\u8d25\uff1a\u68c0\u67e5\u5185\u5b58\u914d\u7f6e\uff08memstore\u3001\u7cfb\u7edf\u9884\u7559\uff09\u3001\u78c1\u76d8\u7a7a\u95f4\u3001\u7aef\u53e3\u5360\u7528\uff082881/2882\uff09</li> <li>\u8fde\u63a5\u62a5\u9519 4012\uff1a\u79df\u6237\u672a\u6fc0\u6d3b\u6216 root \u6ca1\u6709\u5bc6\u7801\uff1b\u5207\u6362 sys \u79df\u6237\u68c0\u67e5</li> <li>SQL \u517c\u5bb9\uff1a\u542f\u7528 MySQL/Oracle \u6a21\u5f0f\u7684\u79df\u6237\u4e0e\u8bed\u6cd5\u7ec6\u8282</li> </ul>"},{"location":"dba/OceanBase-%E7%A4%BE%E5%8C%BA%E7%89%88-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#7","title":"7. \u6700\u4f73\u5b9e\u8df5","text":"<p>1) \u8d44\u6e90\u9694\u79bb\uff08\u79df\u6237\u7ea7/\u8d44\u6e90\u6c60\uff09\uff1b2) 3 \u526f\u672c\u9ad8\u53ef\u7528\uff1b3) \u53c2\u6570\u53d8\u66f4\u5ba1\u6279\uff1b4) \u76d1\u63a7\u4e0e\u544a\u8b66\uff08CPU\u3001IO\u3001LS \u65e5\u5fd7\uff09\uff1b5) \u538b\u6d4b\u4e0e\u5bb9\u91cf\u89c4\u5212\uff1b6) \u5907\u4efd\u6f14\u7ec3\uff1b7) \u5347\u7ea7\u7070\u5ea6</p> <p>\u53c2\u8003\uff1a - OceanBase CE \u6587\u6863 https://open.oceanbase.com - OBD \u5de5\u5177 https://github.com/oceanbase/obd</p>"},{"location":"dba/Oracle-21c-%E5%A2%9E%E5%8A%A0%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95.html","title":"Oracle 21c \u589e\u52a0\u5220\u9664\u6570\u636e\u6587\u4ef6\u7684\u65b9\u6cd5","text":"<p>\u672c\u6587\u603b\u7ed3 Oracle 21c \u5728\u5c0f\u6587\u4ef6\uff08Smallfile\uff09\u4e0e\u5927\u6587\u4ef6\uff08Bigfile\uff09\u8868\u7a7a\u95f4\u4e0b\u7684\u6570\u636e\u6587\u4ef6/\u4e34\u65f6\u6587\u4ef6\u589e\u5220\u3001\u79fb\u52a8\u4e0e\u8c03\u6574\u5927\u5c0f\u7684\u89c4\u8303\u505a\u6cd5\u4e0e\u98ce\u63a7\u8981\u70b9\u3002</p> <p>\u524d\u63d0\u4e0e\u6ce8\u610f\uff1a - \u6743\u9650\uff1a\u9700 SYSDBA \u6216\u5177\u5907 ALTER DATABASE / ALTER TABLESPACE \u6743\u9650 - CDB/PDB\uff1a\u5728\u76ee\u6807 PDB \u5185\u64cd\u4f5c\u5176\u672c\u5730\u8868\u7a7a\u95f4\u4e0e\u6570\u636e\u6587\u4ef6\uff1bCDB$ROOT \u4ec5\u7ba1\u7406 CDB \u7ea7\u6587\u4ef6 - OMF\uff08Oracle Managed Files\uff09\uff1a\u542f\u7528\u540e\u53ef\u7701\u7565\u6587\u4ef6\u5168\u8def\u5f84\uff0c\u7531\u6570\u636e\u5e93\u81ea\u52a8\u653e\u7f6e - ASM \u4e0e RAC\uff1a\u6570\u636e\u6587\u4ef6\u8def\u5f84\u4e3a +DATA/+FRA \u7b49\u78c1\u76d8\u7ec4\uff1b\u786e\u4fdd\u6240\u6709\u5b9e\u4f8b\u5747\u53ef\u89c1</p>"},{"location":"dba/Oracle-21c-%E5%A2%9E%E5%8A%A0%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95.html#1","title":"1. \u589e\u52a0\u6570\u636e\u6587\u4ef6\uff08\u6301\u4e45\u8868\u7a7a\u95f4\uff09","text":"<pre><code>-- \u60c5\u5f62 A\uff1a\u624b\u5de5\u6587\u4ef6\u8def\u5f84\uff08\u6587\u4ef6\u7cfb\u7edf\uff09\nALTER TABLESPACE users ADD DATAFILE '/u01/oradata/ORCL/users02.dbf' SIZE 1G AUTOEXTEND ON NEXT 100M MAXSIZE 30G;\n\n-- \u60c5\u5f62 B\uff1a\u542f\u7528 OMF\uff08\u63a8\u8350\u751f\u4ea7\uff09\nALTER SYSTEM SET db_create_file_dest = '/u01/oradata/ORCL' SCOPE=BOTH;\nALTER TABLESPACE users ADD DATAFILE SIZE 1G AUTOEXTEND ON NEXT 128M;\n\n-- ASM\nALTER TABLESPACE users ADD DATAFILE '+DATA' SIZE 1G AUTOEXTEND ON;\n</code></pre> <p>\u6821\u9a8c\uff1a</p> <pre><code>SELECT file_id, file_name, bytes/1024/1024 AS mb, autoextensible\nFROM   dba_data_files\nWHERE  tablespace_name = 'USERS'\nORDER  BY file_id;\n</code></pre>"},{"location":"dba/Oracle-21c-%E5%A2%9E%E5%8A%A0%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95.html#2-temp","title":"2. \u589e\u52a0\u4e34\u65f6\u6587\u4ef6\uff08\u4e34\u65f6\u8868\u7a7a\u95f4 TEMP\uff09","text":"<pre><code>-- \u65b0\u589e tempfile\uff08\u53ef\u591a\u6587\u4ef6\u5e76\u884c\u5206\u644a I/O\uff09\nALTER TABLESPACE temp ADD TEMPFILE '/u01/oradata/ORCL/temp02.dbf' SIZE 8G AUTOEXTEND ON NEXT 1G;\n\n-- OMF/ASM \u573a\u666f\nALTER TABLESPACE temp ADD TEMPFILE SIZE 8G;        -- OMF\nALTER TABLESPACE temp ADD TEMPFILE '+DATA' SIZE 8G; -- ASM\n</code></pre> <p>\u6821\u9a8c\uff1a</p> <pre><code>SELECT file_id, file_name, bytes/1024/1024 AS mb\nFROM   dba_temp_files\nORDER  BY file_id;\n</code></pre>"},{"location":"dba/Oracle-21c-%E5%A2%9E%E5%8A%A0%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95.html#3","title":"3. \u8c03\u6574\u5927\u5c0f\u4e0e\u6269\u5c55\u7b56\u7565","text":"<pre><code>-- \u5173\u95ed/\u5f00\u542f\u81ea\u589e\u957f\nALTER DATABASE DATAFILE '/u01/oradata/ORCL/users01.dbf' AUTOEXTEND OFF;\nALTER DATABASE DATAFILE '/u01/oradata/ORCL/users01.dbf' AUTOEXTEND ON NEXT 128M MAXSIZE UNLIMITED;\n\n-- \u76f4\u63a5\u8c03\u6574\u5927\u5c0f\uff08\u6536\u7f29\u9700\u786e\u4fdd\u9ad8\u6c34\u4f4d\u7ebf\u4e4b\u4e0b\u65e0\u6bb5/\u533a\uff09\nALTER DATABASE DATAFILE '/u01/oradata/ORCL/users01.dbf' RESIZE 10G;\n\n-- \u4e34\u65f6\u6587\u4ef6\u8c03\u6574\u5927\u5c0f\nALTER DATABASE TEMPFILE '/u01/oradata/ORCL/temp01.dbf' RESIZE 16G;\n</code></pre> <p>\u8f85\u52a9\u68c0\u67e5\uff1a</p> <pre><code>-- \u8868\u7a7a\u95f4\u5269\u4f59\u4e0e\u788e\u7247\u6982\u89c8\uff08Smallfile\uff09\nSELECT df.tablespace_name,\n       ROUND(SUM(df.bytes)/1024/1024) AS total_mb,\n       ROUND(SUM(fs.bytes)/1024/1024) AS free_mb,\n       ROUND((SUM(df.bytes)-SUM(fs.bytes))*100/NULLIF(SUM(df.bytes),0),2) AS used_pct\nFROM   dba_data_files df\nLEFT JOIN (SELECT tablespace_name, SUM(bytes) bytes FROM dba_free_space GROUP BY tablespace_name) fs\n       ON df.tablespace_name = fs.tablespace_name\nGROUP  BY df.tablespace_name\nORDER  BY used_pct DESC;\n</code></pre>"},{"location":"dba/Oracle-21c-%E5%A2%9E%E5%8A%A0%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95.html#4-12c21c","title":"4. \u5728\u7ebf\u79fb\u52a8\u6570\u636e\u6587\u4ef6\uff08\u4e0d\u4e0b\u7ebf\u5bf9\u8c61\uff0c12c+\uff0c21c \u63a8\u8350\uff09","text":"<pre><code>-- \u6587\u4ef6\u7cfb\u7edf\u5230\u65b0\u8def\u5f84\nALTER DATABASE MOVE DATAFILE '/u01/oradata/ORCL/users01.dbf' TO '/u02/oradata/ORCL/users01.dbf';\n\n-- ASM \u78c1\u76d8\u7ec4\u95f4\u79fb\u52a8\nALTER DATABASE MOVE DATAFILE '+DATA/ORCL/DATAFILE/users01.256.11111111' TO '+DATA2';\n\n-- \u53ef\u9009\uff1aKEEP/REUSE \u9009\u9879\uff08\u6309\u9700\u8981\u4fdd\u7559\u65e7\u6587\u4ef6\u6216\u91cd\u7528\u76ee\u6807\u6587\u4ef6\uff09\n</code></pre> <p>\u6821\u9a8c\uff1a</p> <pre><code>SELECT file_name FROM dba_data_files WHERE file_id = 1;  -- \u786e\u8ba4\u8def\u5f84\u5df2\u66f4\u65b0\n</code></pre>"},{"location":"dba/Oracle-21c-%E5%A2%9E%E5%8A%A0%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95.html#5","title":"5. \u5220\u9664\u6570\u636e\u6587\u4ef6\uff08\u4ec5\u7a7a\u6587\u4ef6\u3001\u5c0f\u6587\u4ef6\u8868\u7a7a\u95f4\u9002\u7528\uff09","text":"<p>\u6ce8\u610f\uff1a - SYSTEM/SYSAUX/UNDO/\u4e34\u65f6\u8868\u7a7a\u95f4\u4e0d\u53ef\u5982\u6b64\u5220\u9664 - \u4ec5\u5f53\u6587\u4ef6\u65e0\u4efb\u4f55\u6bb5\uff08dba_extents \u4e2d\u65e0\u8bb0\u5f55\uff09\u4e14\u975e\u5305\u542b\u6bb5\u5934/\u4f4d\u56fe\u7b49\u5173\u952e\u5143\u6570\u636e\u65f6\u53ef\u5220\u9664</p> <p>\u6b65\u9aa4\uff1a</p> <pre><code>-- 1) \u786e\u8ba4\u6587\u4ef6\u4e3a\u7a7a\nSELECT COUNT(*) AS extents\nFROM   dba_extents\nWHERE  file_id = :FILE_ID;    -- \u5e94\u4e3a 0\n\n-- 2) \u8bbe\u7f6e\u8868\u7a7a\u95f4\u53ea\u8bfb\uff08\u6709\u52a9\u4e8e\u7a33\u5b9a\u6027\uff0c\u53ef\u9009\uff09\nALTER TABLESPACE users READ ONLY;   -- \u53ef\u9009\n\n-- 3) \u5220\u9664\u6570\u636e\u6587\u4ef6\uff08Smallfile \u8868\u7a7a\u95f4\uff09\nALTER TABLESPACE users DROP DATAFILE '/u01/oradata/ORCL/users02.dbf';\n\n-- 4) \u6062\u590d\u8bfb\u5199\nALTER TABLESPACE users READ WRITE;  -- \u53ef\u9009\n</code></pre> <p>\u4e34\u65f6\u6587\u4ef6\u5220\u9664\uff1a</p> <pre><code>ALTER TABLESPACE temp DROP TEMPFILE '/u01/oradata/ORCL/temp02.dbf';\n-- \u6216\uff1aALTER DATABASE TEMPFILE '/u01/oradata/ORCL/temp02.dbf' DROP;\n</code></pre>"},{"location":"dba/Oracle-21c-%E5%A2%9E%E5%8A%A0%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95.html#6","title":"6. \u5e38\u89c1\u95ee\u9898\u4e0e\u98ce\u63a7","text":"<ul> <li>\u65e0\u6cd5 RESIZE\uff1a\u9ad8\u6c34\u4f4d\u7ebf\u9650\u5236\u3002\u8fc1\u79fb/\u91cd\u7ec4\u81f3\u65b0\u6587\u4ef6\uff0c\u518d DROP \u65e7\u6587\u4ef6\u53ef\u884c</li> <li>DROP DATAFILE \u62a5\u9519\uff1a\u6587\u4ef6\u975e\u7a7a\u6216\u5305\u542b\u6bb5\u5934\u3002\u53ef\u65b0\u5efa\u8868\u7a7a\u95f4\u8fc1\u79fb\u5bf9\u8c61\uff08ALTER TABLE ... MOVE / SHRINK / ONLINE MOVE\uff09</li> <li>OMF \u73af\u5883\u8def\u5f84\u7ba1\u7406\uff1a\u4f18\u5148\u8bbe\u7f6e db_create_file_dest / db_create_online_log_dest_n</li> <li>RAC/ASM\uff1a\u786e\u4fdd\u76ee\u6807\u8def\u5f84/\u78c1\u76d8\u7ec4\u5bf9\u6240\u6709\u5b9e\u4f8b\u53ef\u89c1\uff1b\u5728\u7ebf\u79fb\u52a8\u671f\u95f4\u907f\u514d DDL</li> <li>\u5907\u4efd\uff1a\u4efb\u4f55\u6587\u4ef6\u7ea7\u64cd\u4f5c\u524d\u540e\u52a1\u5fc5 RMAN \u5907\u4efd\u4e0e\u4ea4\u53c9\u6821\u9a8c</li> </ul>"},{"location":"dba/Oracle-21c-%E5%A2%9E%E5%8A%A0%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95.html#7","title":"7. \u5178\u578b\u53d8\u66f4\u6a21\u677f\uff08\u5efa\u8bae\uff09","text":"<pre><code>-- A) \u7d27\u6025\u6269\u5bb9\uff08OMF\uff09\nALTER SYSTEM SET db_create_file_dest = '+DATA' SCOPE=BOTH;\nALTER TABLESPACE APP_DATA ADD DATAFILE SIZE 8G AUTOEXTEND ON NEXT 1G MAXSIZE 128G;\n\n-- B) \u8fc1\u79fb\u81f3\u65b0\u5b58\u50a8\uff08\u5728\u7ebf\u79fb\u52a8\uff09\nALTER DATABASE MOVE DATAFILE '+DATA/ORCL/DATAFILE/app_data01.256.111' TO '+DATA2';\n\n-- C) \u4e34\u65f6\u8868\u7a7a\u95f4\u6269\u5bb9\nALTER TABLESPACE TEMP ADD TEMPFILE SIZE 32G;\n</code></pre> <p>\u63d0\u793a\uff1a\u751f\u4ea7\u73af\u5883\u5efa\u8bae\u5c06\u4e0a\u8ff0\u6b65\u9aa4\u6c89\u6dc0\u4e3a\u6807\u51c6\u53d8\u66f4\u811a\u672c\uff0c\u5e76\u7eb3\u5165\u5ba1\u6279/\u56de\u6eda\u9884\u6848\uff08\u542b\u6821\u9a8c SQL \u4e0e\u76d1\u63a7\uff09\u3002</p>"},{"location":"dba/Oracle-21c-%E5%A2%9E%E5%8A%A0%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95.html#8-asmomf-rman","title":"8. ASM/OMF \u5168\u6d41\u7a0b\u53d8\u66f4\u6a21\u677f\uff08\u542b\u56de\u6eda\u4e0e RMAN \u9a8c\u8bc1\uff09","text":"<p>\u9002\u7528\uff1aRAC/ASM/OMF \u751f\u4ea7\u73af\u5883\u7684\u6570\u636e\u6587\u4ef6\u6269\u5bb9/\u8fc1\u79fb\u3002</p> <ul> <li>\u9884\u68c0</li> <li>\u786e\u8ba4\u76ee\u6807\u78c1\u76d8\u7ec4\u7a7a\u95f4\u4e0e\u5197\u4f59\uff1a<code>asmcmd lsdg</code>\uff1b\u5f52\u6863\u7a7a\u95f4\uff1a<code>v$recovery_file_dest</code></li> <li>\u5217\u51fa\u5f85\u53d8\u66f4\u5bf9\u8c61\u4e0e\u6587\u4ef6\uff1a<code>dba_segments / dba_data_files / gv$filestat</code></li> <li>\u6a21\u5f0f\uff1a\u786e\u8ba4 CDB/PDB \u5f53\u524d\u5bb9\u5668\uff1b<code>SHOW con_name</code></li> <li>\u5907\u4efd\uff08\u5f3a\u70c8\u5efa\u8bae\uff09   <code>-- RMAN \u7269\u7406\u5907\u4efd\uff08\u793a\u4f8b\uff09   rman target /   BACKUP AS COMPRESSED BACKUPSET DATABASE PLUS ARCHIVELOG;</code></li> <li>\u53d8\u66f4\u6b65\u9aa4\uff08\u793a\u4f8b\uff09   ```sql   -- 1) \u8bbe\u7f6e OMF \u76ee\u6807\uff08\u82e5\u9700\uff09   ALTER SYSTEM SET db_create_file_dest = '+DATA2' SCOPE=BOTH;</li> </ul> <p>-- 2) \u589e\u52a0\u6570\u636e\u6587\u4ef6\uff08\u6269\u5bb9\u578b\uff09   ALTER TABLESPACE APP_DATA ADD DATAFILE SIZE 8G AUTOEXTEND ON NEXT 1G;</p> <p>-- \u6216\u8005\uff1a\u5728\u7ebf\u8fc1\u79fb\u65e2\u6709\u6570\u636e\u6587\u4ef6\uff08\u5b58\u50a8\u8fc1\u79fb\u578b\uff09   ALTER DATABASE MOVE DATAFILE '+DATA/ORCL/DATAFILE/app_data01.256.111' TO '+DATA2';</p> <p>-- 3) \u9a8c\u8bc1   SELECT file_id, file_name FROM dba_data_files WHERE tablespace_name='APP_DATA';   SELECT name, total_mb, free_mb FROM v$asm_diskgroup WHERE name IN ('DATA','DATA2');   <code>`` - \u9a8c\u8bc1\u6e05\u5355   - \u8def\u5f84\u66f4\u65b0\uff1a</code>dba_data_files<code>\u4e0e</code>v$datafile<code>\u4e00\u81f4   - RAC \u53ef\u89c1\u6027\uff1a\u5728\u6240\u6709\u5b9e\u4f8b</code>gv$datafile<code>\u53ef\u89c1\uff1b\u4e1a\u52a1\u65e0\u660e\u663e\u7b49\u5f85\u589e\u52a0   - \u5f52\u6863/\u5907\u4efd\uff1a\u751f\u6210\u91cf\u4e0e\u7a7a\u95f4\u8db3\u591f\uff0c\u65e0\u6ede\u540e\u544a\u8b66 - \u56de\u6eda\u7b56\u7565\uff08\u6309\u573a\u666f\uff09   - \u6269\u5bb9\u65b0\u589e\u6587\u4ef6\uff1a\u82e5\u9700\u56de\u6eda\uff0c</code>ALTER TABLESPACE ... DROP DATAFILE`\uff08\u4ec5\u5728\u65e0\u6bb5\u65f6\uff09   - \u5728\u7ebf\u8fc1\u79fb\u5931\u8d25\uff1a\u518d\u6b21 MOVE \u56de\u539f\u78c1\u76d8\u7ec4\uff1b\u6216\u7531 RMAN RESTORE DATAFILE \u6062\u590d   - \u603b\u4f53\u64a4\u9000\uff1a\u57fa\u4e8e\u53d8\u66f4\u524d RMAN \u5907\u4efd\u96c6\u8fdb\u884c POINT-IN-TIME \u6062\u590d\uff08\u5fc5\u8981\u65f6\uff09</p> <ul> <li>\u53c2\u8003\u811a\u672c\u9aa8\u67b6   ```bash   #!/usr/bin/env bash   set -euo pipefail   sqlplus / as sysdba &lt;&lt;'SQL'   ALTER SYSTEM SET db_create_file_dest = '+DATA2' SCOPE=BOTH;   ALTER DATABASE MOVE DATAFILE '+DATA/ORCL/DATAFILE/app_data01.256.111' TO '+DATA2';   SQL</li> </ul> <p>rman target / &lt;&lt;'RMAN'   BACKUP VALIDATE DATABASE;   RMAN   ```</p>"},{"location":"dba/Oracle-21c-%E5%B8%B8%E8%A7%81%E8%A7%86%E5%9B%BE%E5%8F%8A%E7%94%A8%E6%B3%95.html","title":"Oracle 21c \u5e38\u89c1\u89c6\u56fe\u53ca\u7528\u6cd5","text":"<p>\u9762\u5411 Oracle DBA \u7684 21c \u5e38\u7528\u6570\u636e\u5b57\u5178\u4e0e\u52a8\u6001\u6027\u80fd\u89c6\u56fe\u901f\u67e5\u3002\u6db5\u76d6\u5bf9\u8c61/\u7a7a\u95f4/\u4f1a\u8bdd/SQL/\u65e5\u5fd7\u7b49\u5178\u578b\u573a\u666f\u7684\u67e5\u8be2\u8303\u5f0f\u4e0e\u5b9e\u6218\u793a\u4f8b\u3002</p> <p>\u63d0\u793a\u4e0e\u524d\u63d0\uff1a - CDB \u67b6\u6784\uff1a\u5728 CDB$ROOT \u4e0e\u5404 PDB \u4e2d\u76f8\u540c\u89c6\u56fe\u7684\u542b\u4e49\u4e0d\u540c\u3002\u8de8\u5bb9\u5668\u4f7f\u7528 CDB_/CONTAINER_DATA \u8bbe\u7f6e\uff0c\u6216\u5728\u6bcf\u4e2a PDB \u5185\u5206\u522b\u67e5\u8be2\u3002 - \u8bbf\u95ee\u6743\u9650\uff1aDBA_ \u9700\u5177\u5907\u76f8\u5e94\u6743\u9650\uff1bV$/GV$ \u901a\u5e38\u9700\u8981 SELECT ANY DICTIONARY \u6216 SELECT_CATALOG_ROLE\u3002 - RAC \u73af\u5883\uff1a\u4f7f\u7528 GV$* \u8de8\u5b9e\u4f8b\u6c47\u603b\uff08\u542b INST_ID\uff09\u3002</p>"},{"location":"dba/Oracle-21c-%E5%B8%B8%E8%A7%81%E8%A7%86%E5%9B%BE%E5%8F%8A%E7%94%A8%E6%B3%95.html#1","title":"1. \u89c6\u56fe\u65cf\u8c31\u901f\u89c8","text":"<ul> <li>USER_*\uff1a\u5f53\u524d\u7528\u6237\u53ef\u89c1\u5bf9\u8c61\uff08\u4e0d\u7528 DBA \u6743\u9650\uff09</li> <li>ALL_*\uff1a\u5f53\u524d\u7528\u6237\u53ef\u8bbf\u95ee\u5bf9\u8c61</li> <li>DBA_*\uff1a\u6570\u636e\u5e93\u7ea7\u5bf9\u8c61/\u5143\u6570\u636e\uff08\u9700 DBA \u6743\u9650\uff09</li> <li>V$ / GV$\uff1a\u52a8\u6001\u6027\u80fd\u89c6\u56fe\uff08\u5b9e\u4f8b\u7ea7/\u96c6\u7fa4\u7ea7\uff09</li> <li>CDB_*\uff1a\u5bb9\u5668\u5b57\u5178\u89c6\u56fe\uff08CDB \u67b6\u6784\uff09</li> </ul>"},{"location":"dba/Oracle-21c-%E5%B8%B8%E8%A7%81%E8%A7%86%E5%9B%BE%E5%8F%8A%E7%94%A8%E6%B3%95.html#2","title":"2. \u5bf9\u8c61\u4e0e\u5206\u533a","text":"<ul> <li>\u8868/\u7d22\u5f15/\u7ea6\u675f/\u7edf\u8ba1\u4fe1\u606f</li> </ul> <pre><code>-- \u67e5\u627e\u6307\u5b9a\u6a21\u5f0f\u7684\u5927\u8868\uff08\u6309\u6bb5\u5927\u5c0f\uff09\nSELECT owner, segment_name, segment_type, bytes/1024/1024 AS mb\nFROM   dba_segments\nWHERE  owner = 'APP'\nAND    segment_type = 'TABLE'\nORDER  BY bytes DESC FETCH FIRST 20 ROWS ONLY;\n\n-- \u8868\u5206\u533a\u4fe1\u606f\nSELECT table_owner, table_name, partition_name, high_value, num_rows\nFROM   dba_tab_partitions\nWHERE  table_owner = 'APP'\nORDER  BY table_name, partition_position;\n\n-- \u7d22\u5f15\u4e0e\u53ef\u7528\u6027\nSELECT owner, index_name, table_name, status, uniqueness\nFROM   dba_indexes\nWHERE  owner = 'APP' AND table_name = 'ORDERS';\n</code></pre>"},{"location":"dba/Oracle-21c-%E5%B8%B8%E8%A7%81%E8%A7%86%E5%9B%BE%E5%8F%8A%E7%94%A8%E6%B3%95.html#3","title":"3. \u8868\u7a7a\u95f4\u4e0e\u6570\u636e\u6587\u4ef6/\u5269\u4f59\u7a7a\u95f4","text":"<pre><code>-- \u8868\u7a7a\u95f4\u4f7f\u7528\u7387\uff08\u5c0f\u6587\u4ef6\u8868\u7a7a\u95f4\uff09\nSELECT df.tablespace_name,\n       ROUND(SUM(df.bytes)/1024/1024) AS total_mb,\n       ROUND(SUM(fs.bytes)/1024/1024) AS free_mb,\n       ROUND( (SUM(df.bytes)-SUM(fs.bytes))*100 / NULLIF(SUM(df.bytes),0), 2) AS used_pct\nFROM   dba_data_files df\nLEFT JOIN (\n  SELECT tablespace_name, SUM(bytes) bytes FROM dba_free_space GROUP BY tablespace_name\n) fs ON df.tablespace_name = fs.tablespace_name\nGROUP  BY df.tablespace_name\nORDER  BY used_pct DESC;\n\n-- \u6570\u636e\u6587\u4ef6\u660e\u7ec6\uff08\u542b\u81ea\u589e\uff09\nSELECT file_id, file_name, tablespace_name,\n       bytes/1024/1024 AS mb,\n       autoextensible, increment_by\nFROM   dba_data_files\nORDER  BY tablespace_name, file_id;\n\n-- \u4e34\u65f6\u8868\u7a7a\u95f4\u4e0e tempfile\nSELECT file_id, file_name, tablespace_name, bytes/1024/1024 AS mb\nFROM   dba_temp_files;\n</code></pre>"},{"location":"dba/Oracle-21c-%E5%B8%B8%E8%A7%81%E8%A7%86%E5%9B%BE%E5%8F%8A%E7%94%A8%E6%B3%95.html#4","title":"4. \u4f1a\u8bdd/\u9501/\u963b\u585e","text":"<pre><code>-- \u5f53\u524d\u4f1a\u8bdd\u4e0e\u7b49\u5f85\uff08\u4f1a\u8bdd\u7ea7\uff09\nSELECT s.sid, s.serial#, s.username, s.status, s.machine,\n       s.event, s.wait_class, s.seconds_in_wait\nFROM   v$session s\nWHERE  s.type = 'USER'\nORDER  BY s.seconds_in_wait DESC FETCH FIRST 30 ROWS ONLY;\n\n-- \u963b\u585e\u5173\u7cfb\uff08\u627e\u51fa blocker \u4e0e\u88ab\u963b\u585e\u8005\uff09\nSELECT /*+ RULE */\n  s1.sid AS blocker_sid, s1.serial# AS blocker_serial, s1.username AS blocker_user,\n  s2.sid AS waiter_sid,  s2.serial# AS waiter_serial,  s2.username  AS waiter_user,\n  l1.type, l1.id1, l1.id2\nFROM  v$lock l1\nJOIN  v$session s1 ON s1.sid = l1.sid\nJOIN  v$lock l2 ON l2.id1 = l1.id1 AND l2.id2 = l1.id2 AND l2.block = 0\nJOIN  v$session s2 ON s2.sid = l2.sid\nWHERE l1.block = 1;\n\n-- \u6740\u4f1a\u8bdd\uff08\u8c28\u614e\uff09\uff1a\nALTER SYSTEM KILL SESSION 'sid,serial#' IMMEDIATE;  -- \u5355\u5b9e\u4f8b\n-- RAC\uff1a\u53ef\u52a0 @inst_id\uff1a'sid,serial#,@inst_id'\n</code></pre>"},{"location":"dba/Oracle-21c-%E5%B8%B8%E8%A7%81%E8%A7%86%E5%9B%BE%E5%8F%8A%E7%94%A8%E6%B3%95.html#5-sql","title":"5. SQL \u70ed\u70b9\u4e0e\u6267\u884c\u7edf\u8ba1","text":"<pre><code>-- TOP SQL\uff08\u903b\u8f91\u8bfb\uff09\nSELECT sql_id, plan_hash_value, buffer_gets, executions, parsing_schema_name,\n       substr(sql_text,1,80) AS sql_sample\nFROM   v$sqlarea\nWHERE  buffer_gets &gt; 0\nORDER  BY buffer_gets DESC FETCH FIRST 20 ROWS ONLY;\n\n-- \u6700\u8fd1\u9ad8\u8017\u8d44\u6e90 SQL\uff08ASH\uff0c\u9700\u8bca\u65ad\u8bb8\u53ef\uff09\nSELECT sql_id, session_state, wait_class,\n       COUNT(*) AS samples\nFROM   v$active_session_history\nWHERE  sample_time &gt; SYSTIMESTAMP - INTERVAL '10' MINUTE\nGROUP  BY sql_id, session_state, wait_class\nORDER  BY samples DESC FETCH FIRST 20 ROWS ONLY;\n</code></pre>"},{"location":"dba/Oracle-21c-%E5%B8%B8%E8%A7%81%E8%A7%86%E5%9B%BE%E5%8F%8A%E7%94%A8%E6%B3%95.html#6-fra","title":"6. \u65e5\u5fd7/\u5f52\u6863/FRA \u4e0e\u6570\u636e\u5e93\u72b6\u6001","text":"<pre><code>-- \u5b9e\u4f8b\u4e0e\u6570\u636e\u5e93\nSELECT instance_name, status, database_status FROM v$instance;\nSELECT name, dbid, open_mode, cdb FROM v$database;\n\n-- \u8054\u673a\u91cd\u505a\u65e5\u5fd7\nSELECT group#, thread#, bytes/1024/1024 AS mb, members, status\nFROM   v$log ORDER BY group#;\nSELECT group#, member FROM v$logfile ORDER BY group#, member;\n\n-- \u5f52\u6863\u65e5\u5fd7\u4e0e FRA \u4f7f\u7528\nSELECT dest_name, status, target, archived_seq# FROM v$archive_dest;\nSELECT name, space_limit/1024/1024 AS limit_mb, space_used/1024/1024 AS used_mb\nFROM   v$recovery_file_dest;\n</code></pre>"},{"location":"dba/Oracle-21c-%E5%B8%B8%E8%A7%81%E8%A7%86%E5%9B%BE%E5%8F%8A%E7%94%A8%E6%B3%95.html#7","title":"7. \u53c2\u6570\u4e0e\u73af\u5883","text":"<pre><code>-- \u53c2\u6570\uff08\u6a21\u7cca\uff09\nSELECT name, value FROM v$parameter WHERE LOWER(name) LIKE '%pga%';\nSELECT name, display_value FROM v$parameter WHERE name IN ('db_block_size','compatible');\n\n-- PDB \u5217\u8868/\u5f53\u524d\u5bb9\u5668\nSELECT con_id, name, open_mode FROM v$containers ORDER BY con_id;\nSHOW con_name;  -- SQL*Plus/SQLcl\n</code></pre>"},{"location":"dba/Oracle-21c-%E5%B8%B8%E8%A7%81%E8%A7%86%E5%9B%BE%E5%8F%8A%E7%94%A8%E6%B3%95.html#8","title":"8. \u5e38\u7528\u6392\u969c\u6e05\u5355\uff08\u6309\u89c6\u56fe\u5b9a\u4f4d\uff09","text":"<ul> <li>\u7a7a\u95f4\u95ee\u9898\uff1adba_data_files, dba_free_space, dba_segments</li> <li>\u7d22\u5f15\u95ee\u9898\uff1adba_indexes, dba_ind_columns, v$sql_plan</li> <li>\u9501\u7b49\u5f85\uff1av$session, v$lock, dba_waiters, dba_blockers\uff08\u82e5\u6709\uff09</li> <li>\u6027\u80fd\u70ed\u70b9\uff1av$sqlarea, v$active_session_history, v$sysstat</li> <li>\u65e5\u5fd7/FRA\uff1av$log, v$logfile, v$archived_log, v$recovery_file_dest</li> <li>\u5bb9\u5668/CDB\uff1acdb_* \u89c6\u56fe\uff0cv$containers</li> </ul> <p>\u63d0\u793a\uff1a\u5728\u751f\u4ea7\u73af\u5883\u6267\u884c\u67e5\u8be2\u8bf7\u9644\u5e26\u9650\u5b9a\u6761\u4ef6\uff08owner/schema/time range\uff09\uff0c\u907f\u514d\u5168\u5e93\u626b\u63cf\u5e26\u6765\u989d\u5916\u8d1f\u8f7d\u3002</p>"},{"location":"dba/Oracle-21c-%E6%9E%B6%E6%9E%84%E5%8F%8A%E5%85%B3%E9%94%AE%E7%BB%84%E4%BB%B6.html","title":"Oracle 21c \u67b6\u6784\u53ca\u5173\u952e\u7ec4\u4ef6","text":"<p>\u672c\u6587\u6982\u89c8 Oracle 21c \u7684\u5bb9\u5668\u5316\u6570\u636e\u5e93\uff08CDB/PDB\uff09\u67b6\u6784\u3001\u5185\u5b58\u4e0e\u8fdb\u7a0b\u3001\u5b58\u50a8\u7ed3\u6784\u3001\u6062\u590d\u673a\u5236\u4e0e\u8bca\u65ad\u7ec4\u4ef6\uff0c\u914d\u4ee5\u5e38\u7528\u68c0\u67e5\u547d\u4ee4\uff0c\u4fbf\u4e8e\u5feb\u901f\u5b9a\u4f4d\u4e0e\u65e5\u5e38\u5de1\u68c0\u3002</p>"},{"location":"dba/Oracle-21c-%E6%9E%B6%E6%9E%84%E5%8F%8A%E5%85%B3%E9%94%AE%E7%BB%84%E4%BB%B6.html#1-cdbpdb","title":"1. \u5bb9\u5668\u6570\u636e\u5e93\uff08CDB/PDB\uff09","text":"<ul> <li>\u67b6\u6784\u8981\u70b9</li> <li>CDB$ROOT + \u591a\u4e2a PDB\uff1b21c \u7f3a\u7701\u542f\u7528\u672c\u5730 UNDO\uff08Local Undo\uff09</li> <li>\u6570\u636e\u5b57\u5178\uff1aCDB \u7ea7 + PDB \u7ea7\uff1bCDB_* \u89c6\u56fe\u6c47\u603b\u5404\u5bb9\u5668\u4fe1\u606f</li> <li>\u53c2\u6570\u53ef\u5206 CDB/PDB \u4e24\u7ea7\u8bbe\u7f6e\uff08ALTER SYSTEM SCOPE=SPFILE / ALTER SYSTEM SET ... CONTAINER=CURRENT/ALL\uff09</li> <li>\u5e38\u7528\u68c0\u67e5</li> </ul> <pre><code>-- \u5bb9\u5668\u4e0e\u72b6\u6001\nSELECT con_id, name, open_mode FROM v$containers ORDER BY con_id;\nSHOW con_name; -- \u5f53\u524d\u5bb9\u5668\n\n-- \u8de8\u5bb9\u5668\u67e5\u8be2\uff08\u9700\u5bb9\u5668\u6570\u636e\u6743\u9650\uff09\nSELECT con_id, username, account_status FROM cdb_users WHERE username='APP';\n</code></pre>"},{"location":"dba/Oracle-21c-%E6%9E%B6%E6%9E%84%E5%8F%8A%E5%85%B3%E9%94%AE%E7%BB%84%E4%BB%B6.html#2-sgapgaamm","title":"2. \u5185\u5b58\u7ed3\u6784\uff08SGA/PGA/AMM\uff09","text":"<ul> <li>SGA\uff1a</li> <li>Database Buffer Cache\uff08\u6570\u636e\u5757\u7f13\u5b58\uff09</li> <li>Shared Pool\uff08\u5e93\u7f13\u5b58/\u6570\u636e\u5b57\u5178\u7f13\u5b58\uff09</li> <li>Large Pool\uff08\u5907\u4efd/\u5e76\u884c\uff09</li> <li>Redo Log Buffer\uff08\u91cd\u505a\u65e5\u5fd7\u7f13\u51b2\uff09</li> <li>In-Memory Column Store\uff08\u53ef\u9009\uff0c\u9700\u8bb8\u53ef\uff09</li> <li>PGA\uff1a\u4f1a\u8bdd/\u8fdb\u7a0b\u79c1\u6709\u5185\u5b58\uff08\u6392\u5e8f/\u54c8\u5e0c/\u6e38\u6807\u7b49\uff09</li> <li>\u7ba1\u7406\u53c2\u6570</li> </ul> <pre><code>-- \u81ea\u52a8\u5185\u5b58\uff08AMM/ASMM\uff09\u76f8\u5173\u53c2\u6570\nSELECT name, value FROM v$parameter WHERE name IN (\n  'memory_target','sga_target','pga_aggregate_target','inmemory_size');\n</code></pre>"},{"location":"dba/Oracle-21c-%E6%9E%B6%E6%9E%84%E5%8F%8A%E5%85%B3%E9%94%AE%E7%BB%84%E4%BB%B6.html#3","title":"3. \u540e\u53f0\u8fdb\u7a0b\uff08\u5178\u578b\uff09","text":"<ul> <li>\u5173\u952e\u8fdb\u7a0b</li> <li>DBWn\uff1a\u7f13\u51b2\u5199\u76d8</li> <li>LGWR\uff1a\u5199\u91cd\u505a\u65e5\u5fd7</li> <li>CKPT\uff1a\u68c0\u67e5\u70b9</li> <li>SMON/PMON\uff1a\u7cfb\u7edf/\u8fdb\u7a0b\u76d1\u63a7</li> <li>ARCn\uff1a\u5f52\u6863</li> <li>MMON/MMNL\uff1a\u6027\u80fd\u7edf\u8ba1\u4e0e AWR \u91c7\u96c6</li> <li>LREG/VKTM\uff1a\u76d1\u542c\u6ce8\u518c/\u65f6\u949f</li> <li>RVWR\uff1a\u95ea\u56de\u65e5\u5fd7</li> <li>\u68c0\u67e5\u4e0e\u7edf\u8ba1</li> </ul> <pre><code>SELECT pname, program FROM v$process WHERE background='1' ORDER BY pname;\n</code></pre>"},{"location":"dba/Oracle-21c-%E6%9E%B6%E6%9E%84%E5%8F%8A%E5%85%B3%E9%94%AE%E7%BB%84%E4%BB%B6.html#4","title":"4. \u7269\u7406\u5b58\u50a8\u7ed3\u6784","text":"<ul> <li>\u7ec4\u6210\uff1a\u6570\u636e\u6587\u4ef6\uff08.dbf/+ASM\uff09\u3001\u63a7\u5236\u6587\u4ef6\uff08controlfile\uff09\u3001\u8054\u673a\u91cd\u505a\u65e5\u5fd7\uff08redo\uff09\u3001\u4e34\u65f6\u6587\u4ef6\uff08tempfile\uff09\u3001\u95ea\u56de\u6062\u590d\u533a\uff08FRA\uff0c\u53ef\u9009\uff09</li> <li>\u8868\u7a7a\u95f4\u7c7b\u578b\uff1aSmallfile / Bigfile\uff1b\u672c\u5730\u7ba1\u7406\uff08LMT\uff09\u4e0e ASSM \u4f4d\u56fe\u7ba1\u7406</li> <li>UNDO\uff1a21c \u5efa\u8bae\u4f7f\u7528\u672c\u5730 UNDO\uff0c\u6bcf\u4e2a PDB \u53ef\u62e5\u6709\u72ec\u7acb UNDO \u8868\u7a7a\u95f4</li> <li>\u5e38\u7528\u68c0\u67e5</li> </ul> <pre><code>-- \u6570\u636e\u6587\u4ef6/\u8868\u7a7a\u95f4\nSELECT tablespace_name, file_id, file_name, bytes/1024/1024 mb FROM dba_data_files ORDER BY tablespace_name, file_id;\nSELECT tablespace_name, contents, status FROM dba_tablespaces ORDER BY tablespace_name;\n\n-- \u91cd\u505a\u4e0e\u5f52\u6863\nSELECT group#, bytes/1024/1024 mb, status FROM v$log ORDER BY group#;\nSELECT dest_name, status, target FROM v$archive_dest WHERE target IS NOT NULL;\n</code></pre>"},{"location":"dba/Oracle-21c-%E6%9E%B6%E6%9E%84%E5%8F%8A%E5%85%B3%E9%94%AE%E7%BB%84%E4%BB%B6.html#5-frarman","title":"5. \u6062\u590d\u4e0e\u5907\u4efd\uff08FRA/RMAN/\u95ea\u56de\uff09","text":"<ul> <li>FRA\uff08Fast Recovery Area\uff09\uff1a\u96c6\u4e2d\u7ba1\u7406\u5f52\u6863/\u5907\u4efd\u7247/\u95ea\u56de\u65e5\u5fd7</li> <li>RMAN\uff1a\u7269\u7406\u5907\u4efd/\u6062\u590d\u7684\u6807\u51c6\u5de5\u5177</li> <li>\u95ea\u56de\u6280\u672f\uff1a\u95ea\u56de\u67e5\u8be2/\u95ea\u56de\u8868/\u95ea\u56de\u6570\u636e\u5e93\uff08\u9700\u5f00\u542f\u65e5\u5fd7\uff09</li> <li>\u5e38\u7528\u68c0\u67e5</li> </ul> <pre><code>-- FRA \u7a7a\u95f4\nSELECT name, space_limit/1024/1024 AS limit_mb, space_used/1024/1024 AS used_mb FROM v$recovery_file_dest;\n\n-- \u5f52\u6863\u5207\u6362\u9891\u7387\uff08\u8fd1\u82e5\u5e72\u5206\u949f\uff09\nSELECT COUNT(*) FROM v$archived_log WHERE completion_time &gt; SYSDATE - 1/24/6; -- 10 \u5206\u949f\n</code></pre>"},{"location":"dba/Oracle-21c-%E6%9E%B6%E6%9E%84%E5%8F%8A%E5%85%B3%E9%94%AE%E7%BB%84%E4%BB%B6.html#6-awrashadr","title":"6. \u6027\u80fd\u4e0e\u8bca\u65ad\uff08AWR/ASH/ADR\uff09","text":"<ul> <li>AWR/ASH\uff08\u9700\u8bca\u65ad\u5305\u8bb8\u53ef\uff09\uff1a</li> <li>AWR\uff1a\u5386\u53f2\u5feb\u7167\uff0cDBA_HIST_* \u89c6\u56fe</li> <li>ASH\uff1a\u6d3b\u52a8\u4f1a\u8bdd\u91c7\u6837\uff0cV$ACTIVE_SESSION_HISTORY</li> <li>ADR\uff08Automatic Diagnostic Repository\uff09\uff1a\u7edf\u4e00\u8bca\u65ad\u4ed3\u5e93\uff0c\u5305\u542b alert \u65e5\u5fd7/trace</li> <li>\u5e38\u7528\u68c0\u67e5</li> </ul> <pre><code>-- \u6700\u8fd1\u70ed\u70b9\u7b49\u5f85\uff08ASH \u793a\u4f8b\uff09\nSELECT wait_class, event, COUNT(*) samples\nFROM   v$active_session_history\nWHERE  sample_time &gt; SYSTIMESTAMP - INTERVAL '10' MINUTE\nGROUP  BY wait_class, event ORDER BY samples DESC FETCH FIRST 10 ROWS ONLY;\n\n-- ADR \u57fa\u672c\u8def\u5f84\uff08SQL*Plus\uff09\nSHOW parameter diagnostic_dest;\n</code></pre>"},{"location":"dba/Oracle-21c-%E6%9E%B6%E6%9E%84%E5%8F%8A%E5%85%B3%E9%94%AE%E7%BB%84%E4%BB%B6.html#7","title":"7. \u9ad8\u53ef\u7528\u4e0e\u6269\u5c55\u80fd\u529b\u6982\u89c8","text":"<ul> <li>RAC\uff1a\u591a\u5b9e\u4f8b\u5171\u4eab\u5b58\u50a8\u6269\u5c55\u8ba1\u7b97\u80fd\u529b\u4e0e\u9ad8\u53ef\u7528\uff08GV$ \u89c6\u56fe\u89c2\u5bdf\u5168\u5c40\u7b49\u5f85/\u7f13\u5b58\u4e00\u81f4\u6027\uff09</li> <li>Data Guard\uff1a\u7269\u7406/\u903b\u8f91\u5907\u5e93\u5bb9\u707e\uff1b\u53ef\u8bfb\u5907\u5e93\uff08Active Data Guard\uff0c\u9700\u8bb8\u53ef\uff09</li> <li>Sharding\uff1a\u5206\u7247\u6269\u5c55\uff08\u7279\u5b9a\u573a\u666f\uff09</li> </ul>"},{"location":"dba/Oracle-21c-%E6%9E%B6%E6%9E%84%E5%8F%8A%E5%85%B3%E9%94%AE%E7%BB%84%E4%BB%B6.html#8","title":"8. \u7ba1\u7406\u5de5\u5177\u4e0e\u5e38\u89c1\u57fa\u7ebf","text":"<ul> <li>\u5de5\u5177\uff1aSQL*Plus / SQLcl\u3001RMAN\u3001Data Pump\u3001OEM Cloud Control/Express</li> <li>\u57fa\u7ebf\u5efa\u8bae\uff1a</li> <li>\u53c2\u6570/\u5b9e\u4f8b/\u65e5\u5fd7\u5bb9\u91cf/\u8868\u7a7a\u95f4\u5269\u4f59/\u5907\u4efd\u4f5c\u4e1a/\u544a\u8b66\u65e5\u5fd7\u6bcf\u65e5\u91c7\u96c6</li> <li>\u5173\u952e\u4e1a\u52a1 SQL \u7684\u6267\u884c\u8ba1\u5212\u4e0e\u7edf\u8ba1\u4fe1\u606f\u5b9a\u671f\u6838\u5bf9</li> <li>\u53d8\u66f4\u524d\u540e\u5feb\u7167\uff08AWR\uff09\u4e0e\u56de\u6eda\u9884\u6848</li> </ul> <p>\u63d0\u793a\uff1a\u4ee5\u4e0a\u68c0\u67e5 SQL \u5efa\u8bae\u5c01\u88c5\u4e3a\u5de1\u68c0\u811a\u672c\uff0c\u7ed3\u5408\u4efb\u52a1\u8ba1\u5212\uff08crontab/Scheduler\uff09\u4e0e\u544a\u8b66\u901a\u9053\u7edf\u4e00\u6cbb\u7406\u3002</p>"},{"location":"dba/Oracle-21c-%E7%AD%89%E5%BE%85%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95.html","title":"Oracle 21c \u7b49\u5f85\u4e8b\u4ef6\u5904\u7406\u65b9\u6cd5","text":"<p>\u672c\u6307\u5357\u603b\u7ed3 Oracle 21c \u4e2d\u5e38\u89c1\u7b49\u5f85\u4e8b\u4ef6\uff08Wait Events\uff09\u7684\u8bc6\u522b\u3001\u5206\u6790\u4e0e\u5904\u7f6e\u6d41\u7a0b\uff0c\u8986\u76d6\u4f1a\u8bdd/\u7cfb\u7edf\u7ef4\u5ea6\u7684\u5b9a\u4f4d\u65b9\u6cd5\uff0c\u4ee5\u53ca\u5178\u578b\u4e8b\u4ef6\uff08I/O\u3001\u65e5\u5fd7\u3001\u9501\u7ade\u4e89\u3001\u5e76\u53d1\u3001\u7f51\u7edc\u7b49\uff09\u7684\u5904\u7406\u8981\u70b9\u3002</p> <p>\u63d0\u793a\uff1a - \u7b49\u5f85\u4e8b\u4ef6\u6309 Wait Class \u5f52\u7c7b\uff1aUser I/O\u3001System I/O\u3001Commit\u3001Concurrency\u3001Application\u3001Configuration\u3001Network\u3001Scheduler\u3001Other \u7b49 - \u5206\u6790\u5c42\u6b21\uff1a\u4f1a\u8bdd\uff08v$session\uff09\u2192 SQL\uff08v$sql / v$sqlarea / v$sql_monitor\uff09\u2192 \u7b49\u5f85\uff08v$session / v$active_session_history\uff09\u2192 \u8d44\u6e90\uff08\u5b58\u50a8/\u65e5\u5fd7/CPU/\u7f51\u7edc\uff09 - \u8bb8\u53ef\u8bc1\uff1a\u4f7f\u7528 AWR/ASH/ADDM \u9700 Diagnostics/Tuning Pack \u8bb8\u53ef</p>"},{"location":"dba/Oracle-21c-%E7%AD%89%E5%BE%85%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95.html#1","title":"1. \u5feb\u901f\u6392\u67e5\u6d41\u7a0b\uff08\u5b9e\u7528\u6a21\u677f\uff09","text":"<p>1) \u5224\u65ad\u662f\u5426\u201cCPU \u7ed1\u6ee1\u8fd8\u662f\u7b49\u5f85\u4e3a\u4e3b\u201d</p> <pre><code>-- \u57fa\u7ebf\uff1aCPU vs Wait\uff08RAC \u7528 GV$\uff09\nSELECT stat_name, value FROM v$sys_time_model WHERE stat_name IN ('DB CPU','DB time');\n</code></pre> <ul> <li>\u82e5 DB CPU \u2248 DB time\uff1a\u504f CPU \u4fa7\uff1b\u5173\u6ce8 SQL \u6267\u884c\u8ba1\u5212\u3001\u5e76\u884c\u5ea6\u3001\u7edf\u8ba1\u4fe1\u606f</li> <li>\u82e5 DB CPU \u8fdc\u5c0f\u4e8e DB time\uff1a\u504f\u7b49\u5f85\u4fa7\uff1b\u7ee7\u7eed\u7b2c 2 \u6b65</li> </ul> <p>2) \u6309 Wait Class/\u4e8b\u4ef6\u5206\u5e03\u805a\u5408</p> <pre><code>-- \u6700\u8fd1 10 \u5206\u949f ASH\uff08\u9700\u8bb8\u53ef\uff09\uff0c\u5feb\u901f\u770b Wait Class TOPN\nSELECT wait_class, event, COUNT(*) samples\nFROM   v$active_session_history\nWHERE  sample_time &gt; SYSTIMESTAMP - INTERVAL '10' MINUTE\nGROUP  BY wait_class, event\nORDER  BY samples DESC FETCH FIRST 10 ROWS ONLY;\n\n-- \u65e0 ASH \u65f6\u7528\u7cfb\u7edf\u7d2f\u8ba1\nSELECT wait_class, SUM(time_waited)/100 AS seconds\nFROM   v$system_event\nWHERE  wait_class &lt;&gt; 'Idle'\nGROUP  BY wait_class ORDER BY seconds DESC;\n</code></pre> <p>3) \u4e0b\u94bb\u5230\u4f1a\u8bdd/SQL</p> <pre><code>-- \u6b63\u5728\u7b49\u5f85\u7684\u7528\u6237\u4f1a\u8bdd\nSELECT sid, serial#, username, event, wait_class, blocking_session, sql_id\nFROM   v$session\nWHERE  type='USER' AND state='WAITING'\nORDER  BY logon_time;\n\n-- \u7ed1\u5b9a SQL \u4e0e\u6267\u884c\u7edf\u8ba1\nSELECT sql_id, plan_hash_value, executions, buffer_gets, disk_reads, elapsed_time\nFROM   v$sqlarea WHERE sql_id = :sql_id;\n</code></pre> <p>4) \u7ed3\u5408\u7cfb\u7edf\u8d44\u6e90/\u5b58\u50a8\u65e5\u5fd7\u9a8c\u8bc1\uff08iostat/vmstat/redo/ASM/\u7f51\u7edc\uff09</p>"},{"location":"dba/Oracle-21c-%E7%AD%89%E5%BE%85%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95.html#2","title":"2. \u5e38\u89c1\u7b49\u5f85\u4e8b\u4ef6\u4e0e\u5904\u7406\u5efa\u8bae","text":""},{"location":"dba/Oracle-21c-%E7%AD%89%E5%BE%85%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95.html#21-user-io-system-io","title":"2.1 User I/O / System I/O","text":"<ul> <li>db file sequential read\uff08\u968f\u673a\u8bfb\uff0c\u7d22\u5f15\u8bbf\u95ee\u5e38\u89c1\uff09</li> <li>\u73b0\u8c61\uff1a\u5927\u91cf\u5355\u5757\u8bfb\uff0c\u5ef6\u8fdf\u8f83\u9ad8</li> <li>\u8bca\u65ad\uff1a\u68c0\u67e5 I/O \u5ef6\u8fdf\uff08\u5b58\u50a8\u76d1\u63a7\uff09\uff0cSQL \u662f\u5426\u5b58\u5728\u4f4e\u6548\u7d22\u5f15\u8bbf\u95ee\uff08\u9009\u62e9\u6027\u5dee/\u7f3a\u5931\u7d22\u5f15\uff09</li> <li>\u5904\u7406\uff1a\u4f18\u5316\u7d22\u5f15\u8bbe\u8ba1\u3001\u6536\u96c6\u7edf\u8ba1\u4fe1\u606f\u3001\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u968f\u673a\u8bbf\u95ee\uff1b\u5b58\u50a8\u4fa7\u964d\u4f4e\u5ef6\u8fdf</li> <li>db file scattered read\uff08\u591a\u5757\u8bfb\uff0c\u5168\u8868/\u5168\u7d22\u5f15\u7528\uff09</li> <li>\u5904\u7406\uff1a\u786e\u8ba4\u662f\u5426\u9884\u671f\u7684\u5168\u8868\u626b\u63cf\uff1b\u589e\u52a0\u9ad8\u9009\u62e9\u6027\u7d22\u5f15\u6216\u5206\u533a\u88c1\u526a\uff1bI/O \u541e\u5410\u4e0d\u8db3\u65f6\u8003\u8651\u5206\u6761\u5e26/\u5e76\u884c</li> <li>direct path read/write\uff08\u76f4\u901a I/O\uff0c\u591a\u89c1\u4e8e\u5927\u7b97\u5b50/\u5e76\u884c/\u4e34\u65f6\u6bb5\uff09</li> <li>\u5904\u7406\uff1a\u589e\u5927 PGA\uff08pga_aggregate_target\uff09\u6216\u542f\u7528\u81ea\u52a8\u5185\u5b58\u7ba1\u7406\uff0c\u4f18\u5316\u5e76\u884c\u5ea6\uff1bTEMP \u8868\u7a7a\u95f4\u6269\u5bb9\u4e0e\u9ad8\u901f\u76d8\uff1b\u51cf\u5c11\u4e34\u65f6\u6570\u636e\u4ea7\u751f</li> </ul>"},{"location":"dba/Oracle-21c-%E7%AD%89%E5%BE%85%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95.html#22-commit-redo","title":"2.2 Commit / Redo","text":"<ul> <li>log file sync\uff08\u63d0\u4ea4\u7b49\u5f85 LGWR \u540c\u6b65\uff09</li> <li>\u73b0\u8c61\uff1a\u5c0f\u4e8b\u52a1\u9891\u7e41\u63d0\u4ea4\uff0c\u7b49\u5f85\u7ea2\u8272\u65e5\u5fd7\u843d\u76d8</li> <li>\u8bca\u65ad\uff1av$log\u3001v$logfile\u3001\u5b58\u50a8\u5ef6\u8fdf\uff1b\u5e94\u7528\u662f\u5426\u8fc7\u5ea6 commit</li> <li>\u5904\u7406\uff1a<ul> <li>\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u9891\u7e41\u63d0\u4ea4\uff08\u6279\u91cf\u63d0\u4ea4/\u5408\u5e76\u4e8b\u52a1\uff09</li> <li>\u63d0\u5347\u91cd\u505a\u65e5\u5fd7\u8bbe\u5907\uff1a\u66f4\u4f4e\u65f6\u5ef6\u78c1\u76d8/\u4e13\u7528\u5377\uff0c\u5408\u7406\u5927\u5c0f\uff08\u4f8b\u5982 1G~4G\uff09\uff0c\u6210\u5458\u591a\u8def\u5f84</li> <li>\u907f\u514d\u70ed\u70b9 LUN\uff1b\u786e\u8ba4\u65e0\u8fc7\u5ea6\u5f52\u6863/\u8fdc\u7a0b\u4f20\u8f93\u963b\u585e</li> </ul> </li> </ul>"},{"location":"dba/Oracle-21c-%E7%AD%89%E5%BE%85%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95.html#23-concurrency-latch-buffer-busy","title":"2.3 Concurrency / Latch / Buffer Busy","text":"<ul> <li>buffer busy waits / read by other session</li> <li>\u73b0\u8c61\uff1a\u70ed\u70b9\u5757\u7ade\u4e89</li> <li>\u5904\u7406\uff1a\u5206\u533a/\u5206\u8868\u964d\u4f4e\u70ed\u70b9\uff1b\u4f7f\u7528\u53cd\u5411\u7d22\u5f15\uff08reverse key\uff09\u7f13\u89e3\u63d2\u5165\u70ed\u70b9\uff1b\u51cf\u5c11\u70ed\u70b9\u5e8f\u5217\uff08\u7f13\u5b58\u66f4\u5927/\u4f7f\u7528\u591a\u5e8f\u5217\uff09</li> <li>latch: cache buffers chains</li> <li>\u5904\u7406\uff1a\u51cf\u5c11\u70ed\u70b9\u5757\u8bbf\u95ee\uff1b\u68c0\u67e5\u4e0d\u5408\u7406\u7684\u5168\u8868\u626b\u63cf\uff1b\u589e\u5927 DB_CACHE_SIZE \u4ec5\u5728\u8bc1\u636e\u5145\u5206\u65f6\u8003\u8651</li> </ul>"},{"location":"dba/Oracle-21c-%E7%AD%89%E5%BE%85%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95.html#24-applicationconcurrency","title":"2.4 \u9501\u7ade\u4e89\uff08Application/Concurrency\uff09","text":"<ul> <li>enq: TX - row lock contention\uff08\u884c\u7ea7\u9501\u7ade\u4e89\uff09</li> <li>\u8bca\u65ad\uff1a\u5b9a\u4f4d blocker \u4e0e\u7b49\u5f85\u94fe</li> </ul> <pre><code>SELECT s1.sid blocker, s2.sid waiter, ob.owner, ob.object_name, l1.id1, l1.id2\nFROM   v$lock l1 JOIN v$session s1 ON l1.sid=s1.sid AND l1.block=1\nJOIN   v$lock l2 ON l2.id1=l1.id1 AND l2.id2=l1.id2 AND l2.block=0\nJOIN   dba_objects ob ON ob.object_id=s2.row_wait_obj#\nJOIN   v$session s2 ON s2.sid=l2.sid;\n</code></pre> <ul> <li>\u5904\u7406\uff1a\u5c3d\u5feb\u91ca\u653e\u4e8b\u52a1\uff08\u63d0\u4ea4/\u56de\u6eda/\u7ed3\u675f\u4f1a\u8bdd\uff09\uff1b\u4e3a\u5916\u952e\u5217\u8865\u7d22\u5f15\uff0c\u51cf\u5c11\u8868\u7ea7\u9501\uff1b\u8c03\u6574\u4e8b\u52a1\u8fb9\u754c</li> <li>enq: TM - contention\uff08DDL/\u5916\u952e\u76f8\u5173\uff09</li> <li>\u5904\u7406\uff1a\u9519\u5cf0 DDL\uff1b\u4e3a\u5916\u952e\u521b\u5efa\u7d22\u5f15\uff1b\u51cf\u5c11\u5168\u8868\u9501\u7684 DDL \u64cd\u4f5c</li> </ul>"},{"location":"dba/Oracle-21c-%E7%AD%89%E5%BE%85%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95.html#25","title":"2.5 \u7f51\u7edc\u4e0e\u914d\u7f6e","text":"<ul> <li>SQL*Net break/reset / more data / TCP \u76f8\u5173\u7b49\u5f85</li> <li>\u5904\u7406\uff1a\u68c0\u67e5\u5e94\u7528/\u4e2d\u95f4\u4ef6\u7684\u6279\u91cf\u63d0\u53d6\u5927\u5c0f\uff08fetch size\uff09\u3001\u7f51\u7edc\u65f6\u5ef6\u4e0e\u4e22\u5305\uff1b\u670d\u52a1\u5668/\u5ba2\u6237\u7aef Nagle/keepalive \u914d\u7f6e</li> </ul>"},{"location":"dba/Oracle-21c-%E7%AD%89%E5%BE%85%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95.html#26-rac","title":"2.6 RAC \u76f8\u5173\uff08\u5982\u9002\u7528\uff09","text":"<ul> <li>gc buffer busy / gc cr request</li> <li>\u5904\u7406\uff1a\u51cf\u5c11\u8de8\u5b9e\u4f8b\u70ed\u70b9\u8bbf\u95ee\uff08\u5206\u533a/\u670d\u52a1\u4eb2\u548c/\u5e8f\u5217\u672c\u5730\u7f13\u5b58\uff09\uff1b\u6821\u9a8c interconnect \u5e26\u5bbd\u4e0e\u5ef6\u8fdf</li> </ul>"},{"location":"dba/Oracle-21c-%E7%AD%89%E5%BE%85%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95.html#27","title":"2.7 \u5b9e\u6218\u6848\u4f8b\uff08\u7cbe\u7b80\u6a21\u677f\uff09","text":"<ul> <li>\u6848\u4f8b A\uff1alog file sync \u504f\u9ad8\uff08Commit/Redo\uff09   1) \u8bc1\u636e\u6536\u96c6\uff1aAWR Top Events/Redo write time\u3001v$log \u5207\u6362\u9891\u7387\u3001v$sysstat\uff08redo size/redo writes\uff09   2) \u8bca\u65ad\u5b9a\u4f4d\uff1a\u5e94\u7528\u662f\u5426\u9891\u7e41\u5c0f\u4e8b\u52a1\u63d0\u4ea4\uff1b\u65e5\u5fd7\u8bbe\u5907/\u5377\u662f\u5426\u9ad8\u65f6\u5ef6\uff1b\u5f52\u6863\u662f\u5426\u963b\u585e   3) \u5904\u7406\u5efa\u8bae\uff1a<ul> <li>\u5e94\u7528\u4fa7\u5408\u5e76\u63d0\u4ea4/\u6279\u91cf\u63d0\u4ea4\uff1b\u5408\u7406\u6279\u5927\u5c0f</li> <li>\u8c03\u6574\u8054\u673a\u65e5\u5fd7\u5927\u5c0f\uff08\u5e38\u89c1 1G~4G\uff09\u4e0e\u6210\u5458/\u591a\u8def\u5f84\uff0c\u8fc1\u79fb\u81f3\u4f4e\u65f6\u5ef6\u5377</li> <li>\u5f52\u6863/\u8fdc\u7a0b\u4f20\u8f93\u4e0e\u8054\u673a\u65e5\u5fd7 IO \u901a\u9053\u5206\u79bb\uff0c\u907f\u514d\u70ed\u70b9 LUN</li> </ul> </li> <li>\u6848\u4f8b B\uff1aTX \u884c\u7ea7\u9501\u7ade\u4e89\uff08enq: TX - row lock contention\uff09   1) \u8bc1\u636e\u6536\u96c6\uff1a\u963b\u585e\u94fe\uff08v$lock/v$session \u5173\u8054\uff09\u3001\u53d7\u5f71\u54cd\u5bf9\u8c61\uff08dba_objects\uff09   2) \u8bca\u65ad\u5b9a\u4f4d\uff1a\u7f3a\u5931\u5916\u952e\u7d22\u5f15/\u957f\u4e8b\u52a1/\u540c\u4e00\u70ed\u70b9\u884c\u66f4\u65b0\u51b2\u7a81   3) \u5904\u7406\u5efa\u8bae\uff1a<ul> <li>\u53ca\u65f6\u63d0\u4ea4/\u56de\u6eda\uff1b\u5fc5\u8981\u65f6 kill session\uff08\u8c28\u614e\uff09</li> <li>\u4e3a\u5916\u952e\u8865\u7d22\u5f15\uff0c\u51cf\u5c11\u8868\u7ea7\u9501</li> <li>\u91c7\u7528\u53bb\u70ed\u70b9\u7b56\u7565\uff08\u5206\u533a/\u5206\u8868/\u4e1a\u52a1\u5c42\u6253\u6563\uff09\uff0c\u5fc5\u8981\u65f6\u4f7f\u7528 SKIP LOCKED \u6a21\u5f0f</li> </ul> </li> <li>\u6848\u4f8b C\uff1adb file sequential read \u504f\u9ad8\uff08\u968f\u673a\u8bfb\uff09   1) \u8bc1\u636e\u6536\u96c6\uff1aTOP SQL\uff08v$sqlarea \u6309 buffer_gets\uff09\u3001\u6267\u884c\u8ba1\u5212\uff08DBMS_XPLAN\uff09   2) \u8bca\u65ad\u5b9a\u4f4d\uff1a\u9009\u62e9\u6027\u5dee/\u7f3a\u5931\u7d22\u5f15/\u8fc7\u671f\u7edf\u8ba1\u4fe1\u606f   3) \u5904\u7406\u5efa\u8bae\uff1a<ul> <li>\u4fee\u6b63\u7d22\u5f15\u4e0e\u7edf\u8ba1\u4fe1\u606f\uff1b\u6839\u636e\u8bbf\u95ee\u6a21\u5f0f\u4f18\u5316\u8fde\u63a5\u987a\u5e8f/\u9a71\u52a8\u8868</li> <li>\u5b58\u50a8\u4fa7\u964d\u4f4e\u8bfb\u5ef6\u8fdf\uff1b\u4e1a\u52a1\u4fa7\u7f13\u5b58\u70ed\u70b9\u7ef4\u8868</li> </ul> </li> <li>\u6848\u4f8b D\uff08RAC\uff09\uff1agc buffer busy / gc cr request   1) \u8bc1\u636e\u6536\u96c6\uff1aGV$ \u7ef4\u5ea6\u7b49\u5f85\u5206\u5e03\uff0c\u5b9e\u4f8b\u95f4\u70ed\u70b9\u6bb5   2) \u5904\u7406\u5efa\u8bae\uff1a\u670d\u52a1\u4eb2\u548c/\u5206\u533a\u672c\u5730\u5316/\u5e8f\u5217\u672c\u5730\u7f13\u5b58\uff1b\u9a8c\u8bc1 interconnect \u5e26\u5bbd/\u5ef6\u8fdf</li> </ul>"},{"location":"dba/Oracle-21c-%E7%AD%89%E5%BE%85%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95.html#3-awrashaddm","title":"3. AWR/ASH/ADDM \u5de5\u5177\u5316\uff08\u53ef\u9009\uff0c\u9700\u8bb8\u53ef\uff09","text":"<pre><code>-- \u751f\u6210 AWR \u62a5\u544a\uff08\u5feb\u7167\u95f4\uff09\n@?/rdbms/admin/awrrpt.sql\n-- \u751f\u6210 ASH \u62a5\u544a\uff08\u533a\u95f4\uff09\n@?/rdbms/admin/ashrpt.sql\n-- ADDM\uff08\u57fa\u4e8e AWR \u5feb\u7167\uff09\n@?/rdbms/admin/addmrpt.sql\n</code></pre> <p>\u62a5\u544a\u9605\u8bfb\u8981\u70b9\uff1a - Top Events / SQL Ordered by Elapsed Time / I/O Stats by Function - Segment Statistics\uff08\u70ed\u70b9\u6bb5\uff09/ Instance Efficiency\uff08\u7f13\u5b58\u547d\u4e2d\u7387\u53c2\u8003\uff09</p>"},{"location":"dba/Oracle-21c-%E7%AD%89%E5%BE%85%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95.html#4","title":"4. \u76d1\u63a7\u4e0e\u57fa\u7ebf\u5efa\u8bae","text":"<ul> <li>\u7edf\u4e00\u91c7\u96c6\uff1a\u5173\u952e\u7b49\u5f85\u5206\u5e03\u3001TOP SQL\u3001Redo \u4ea7\u51fa\u3001I/O \u5ef6\u8fdf\u3001TEMP \u4f7f\u7528\u3001\u9501\u7b49\u5f85\u94fe</li> <li>\u544a\u8b66\u9608\u503c\uff1a\u7b49\u5f85\u603b\u91cf/\u7c7b\u76ee\u7a81\u589e\u3001log file sync \u8d85\u9608\u3001db file sequential read \u5ef6\u8fdf\u3001\u5f52\u6863\u6ede\u540e</li> <li>\u53d8\u66f4\u524d\u540e\uff1a\u4ee5 AWR \u4e3a\u57fa\u7ebf\u5bf9\u6bd4\uff08\u65f6\u95f4\u3001\u8d1f\u8f7d\u3001SQL \u6a21\u5f0f\u4e00\u81f4\uff09</li> </ul>"},{"location":"dba/Oracle-21c-%E7%AD%89%E5%BE%85%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95.html#5","title":"5. \u6807\u51c6\u5e94\u6025\u6e05\u5355\uff08\u6a21\u677f\uff09","text":"<p>1) \u786e\u8ba4\u8303\u56f4\uff1a\u5355\u5b9e\u4f8b/\u6240\u6709\u5b9e\u4f8b\u3001\u5355 PDB/\u5168\u5e93\u3001\u5355\u4e1a\u52a1/\u5168\u5c40 2) \u5b9a\u4f4d\u7c7b\u578b\uff1aCPU vs Wait\uff1bWait Class \u5206\u5e03 3) \u6293\u70ed\u70b9\uff1a\u4f1a\u8bdd/SQL/\u5bf9\u8c61\uff08\u6bb5/\u6587\u4ef6/\u8868\u7a7a\u95f4\uff09 4) \u4e34\u65f6\u7f13\u89e3\uff1a\u964d\u5e76\u53d1\u3001\u6682\u505c\u6279\u5904\u7406\u3001\u6269\u5bb9\u8d44\u6e90\uff08TEMP/UNDO/REDO/I/O\uff09 5) \u6839\u56e0\u4fee\u590d\uff1a\u7d22\u5f15\u4e0eSQL\u3001\u4e8b\u52a1\u8fb9\u754c\u3001\u53c2\u6570/\u5b58\u50a8/\u7f51\u7edc\u4f18\u5316 6) \u590d\u76d8\u6c89\u6dc0\uff1a\u811a\u672c\u5316\u3001\u9608\u503c\u5316\u3001\u9762\u677f\u5316\uff08Grafana/Exporter\uff09</p>"},{"location":"dba/Oracle-DBA-01-%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html","title":"Oracle DBA \u6559\u5b66\uff0801\uff09\u90e8\u7f72\u4e0e\u67b6\u6784\u8bbe\u8ba1","text":"<p>\u9002\u7528\u8bfb\u8005\uff1a\u521d/\u4e2d\u7ea7 DBA\u3001\u67b6\u6784\u5e08\u3001SRE \u76ee\u6807\uff1a\u57fa\u4e8e JD \u7684\u8981\u6c42\uff0c\u7ed9\u51fa\u4e00\u5957\u4ece\u89c4\u5212\u3001\u5b89\u88c5\u5230\u9ad8\u53ef\u7528\u67b6\u6784\u8bbe\u8ba1\u7684\u53ef\u843d\u5730\u6307\u5357\uff0c\u53ef\u76f4\u63a5\u7528\u4e8e\u751f\u4ea7\u5b9e\u65bd\u4e0e\u6f14\u7ec3\u3002</p>"},{"location":"dba/Oracle-DBA-01-%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html#1","title":"1. \u89c4\u5212\u4e0e\u524d\u7f6e\u6761\u4ef6","text":"<ul> <li>\u7248\u672c\u9009\u62e9\uff1aOracle 19c \u4e3a\u957f\u671f\u652f\u6301\u7248\uff08LTS\uff09\uff0c\u751f\u4ea7\u9996\u9009\uff1b12c/21c \u9700\u7ed3\u5408\u517c\u5bb9\u6027\u8bc4\u4f30\u3002</li> <li>\u5e73\u53f0\u4e0e\u6587\u4ef6\u7cfb\u7edf\uff1aRHEL/CentOS/OL\uff1b\u5efa\u8bae ASM + OMF\uff1b\u5f52\u6863\u6a21\u5f0f\u5f00\u542f\uff08ARCHIVELOG\uff09\u3002</li> <li>\u8d44\u6e90\u57fa\u7ebf\uff1aCPU/\u5185\u5b58/\u78c1\u76d8/\u7f51\u7edc\u5197\u4f59\uff1b\u65f6\u949f\u540c\u6b65\uff08NTP/Chrony\uff09\uff1b\u4e3b\u673a\u540d\u4e0e DNS \u89e3\u6790\u4e00\u81f4\u3002</li> <li>\u5b89\u5168\u57fa\u7ebf\uff1a\u6700\u5c0f\u6743\u9650\u8d26\u53f7\u3001\u7981\u7528 root \u76f4\u767b\u3001SSH key\u3001\u5ba1\u8ba1\u5f00\u542f\u3001\u8865\u4e01\u4e0e\u6f0f\u6d1e\u57fa\u7ebf\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-01-%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html#2","title":"2. \u5b89\u88c5\u6d41\u7a0b\uff08\u5355\u5b9e\u4f8b\uff09","text":"<p>1) \u521b\u5efa\u5b89\u88c5\u7528\u6237\u4e0e\u7ec4\uff08oracle\u3001oinstall\u3001dba\uff09\u5e76\u914d\u7f6e limits \u4e0e\u5185\u6838\u53c2\u6570\u3002 2) \u5b89\u88c5\u6570\u636e\u5e93\u8f6f\u4ef6\uff08GUI \u6216\u9759\u9ed8\uff09\u3002\u793a\u4f8b\uff08\u9759\u9ed8\uff09\uff1a</p> <pre><code>./runInstaller -silent \\\n  oracle.install.option=INSTALL_DB_SWONLY \\\n  UNIX_GROUP_NAME=oinstall \\\n  INVENTORY_LOCATION=/u01/app/oraInventory \\\n  ORACLE_HOME=/u01/app/oracle/product/19.3.0/dbhome_1 \\\n  ORACLE_BASE=/u01/app/oracle \\\n  oracle.install.db.ConfigureAsContainerDB=true \\\n  DECLINE_SECURITY_UPDATES=true\n</code></pre> <p>3) \u5efa\u5e93\uff08DBCA \u9759\u9ed8\u793a\u4f8b\uff09\uff1a</p> <pre><code>$ORACLE_HOME/bin/dbca -silent -createDatabase \\\n  -gdbname prodc -sid prodc -createAsContainerDatabase true \\\n  -numberOfPDBs 1 -pdbName pdb1 -pdbAdminPassword 'Strong#Pass1' \\\n  -sysPassword 'Strong#Sys1' -systemPassword 'Strong#Sys1' \\\n  -templateName General_Purpose.dbc -characterSet AL32UTF8 \\\n  -memoryMgmtType auto_sga -totalMemory 8192 \\\n  -redoLogFileSize 1024 -emConfiguration NONE\n</code></pre> <p>4) \u57fa\u7840\u68c0\u67e5\uff1a\u5f52\u6863\u3001\u95ea\u56de\u533a\u3001\u5907\u4efd\u76ee\u5f55\u3001\u76d1\u542c\u914d\u7f6e\u3001\u5b57\u7b26\u96c6\u3001nls_lang\u3001\u65f6\u533a\u7b49\u3002</p>"},{"location":"dba/Oracle-DBA-01-%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html#3","title":"3. \u67b6\u6784\u8bbe\u8ba1","text":""},{"location":"dba/Oracle-DBA-01-%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html#31","title":"3.1 \u8868\u7a7a\u95f4\u4e0e\u6570\u636e\u6587\u4ef6","text":"<ul> <li>SYSTEM/SYSAUX/UNDOTBS/TEMP \u72ec\u7acb\uff1b\u4e1a\u52a1\u8868\u7a7a\u95f4\u6309\u6a21\u5757\u6216\u751f\u547d\u5468\u671f\u62c6\u5206\uff1b\u5927\u5bf9\u8c61\u5355\u72ec\u8868\u7a7a\u95f4\u3002</li> <li>\u4f7f\u7528 OMF + ASM\uff0c\u51cf\u5c11\u624b\u5de5\u8def\u5f84\u7ba1\u7406\uff1b\u542f\u7528\u81ea\u52a8\u6269\u5c55\uff0c\u8bbe\u7f6e\u4e0a\u9650\uff0c\u5b9a\u671f\u5bb9\u91cf\u8bc4\u4f30\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-01-%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html#32","title":"3.2 \u903b\u8f91\u7ed3\u6784\u4e0e\u591a\u79df\u6237","text":"<ul> <li>CDB+PDB \u67b6\u6784\uff1a\u6838\u5fc3\u5e93\u505a CDB\uff0c\u6309\u7cfb\u7edf\u9694\u79bb\u81f3\u4e0d\u540c PDB\uff1b\u5229\u7528 PDB \u7ea7\u514b\u9686\u4e0e\u5237\u65b0\u5b9e\u73b0\u7070\u5ea6\u4e0e\u56de\u5f52\u6d4b\u8bd5\u3002</li> <li>\u53c2\u6570\u6a21\u677f\uff1aCDB \u5c42\u8bbe\u7f6e SGA/PGA\u3001\u5e76\u884c\u3001\u5ba1\u8ba1\uff1bPDB \u5c42\u8bbe\u7f6e\u65f6\u533a\u3001\u8d44\u6e90\u7ec4\u3001\u8fde\u63a5\u9650\u5236\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-01-%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html#33-rac-data-guard","title":"3.3 \u9ad8\u53ef\u7528\u4e0e\u707e\u5907\uff08RAC / Data Guard\uff09","text":"<ul> <li>RAC\uff1a\u540c\u57ce\u591a\u8282\u70b9\uff0c\u65e0\u5171\u4eab\u5b58\u50a8\u5219\u91c7\u7528 ASM + \u591a\u8def\u5f84\uff1b\u6ce8\u610f interconnect \u4e0e\u5fc3\u8df3\u7f51\u7edc\u5197\u4f59\u3002</li> <li>Data Guard\uff1a\u5f02\u5730\u53ea\u8bfb/\u7269\u7406\u5907\u5e93\uff0cRPO/RTO \u7531\u7f51\u7edc\u4e0e\u4fdd\u62a4\u6a21\u5f0f\u51b3\u5b9a\uff08MAXPROTECT/AVAIL/PERFORMANCE\uff09\u3002</li> <li>\u5207\u6362\u4e0e\u6f14\u7ec3\uff1a\u6bcf\u5b63\u5ea6\u8fdb\u884c switchover \u4e0e failover \u6f14\u7ec3\u5e76\u7559\u5b58\u62a5\u544a\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-01-%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html#34","title":"3.4 \u5f52\u6863\u3001\u95ea\u56de\u4e0e\u65e5\u5fd7","text":"<ul> <li>\u5f52\u6863\u653e\u72ec\u7acb\u78c1\u76d8\u7ec4\uff0c\u8bbe\u7f6e <code>DB_RECOVERY_FILE_DEST</code> \u4e0e\u914d\u989d\uff1b</li> <li>\u6253\u5f00 Flashback Database \u4ee5\u652f\u6491\u5feb\u901f\u56de\u6eda\uff1b</li> <li>REDO/UNDO \u8bc4\u4f30\uff1a\u9ad8\u5e76\u53d1\u7cfb\u7edf\u9002\u5f53\u589e\u5927\u65e5\u5fd7\u6587\u4ef6\u4e0e\u7ec4\u6570\uff0c\u51cf\u5c11\u65e5\u5fd7\u5207\u6362\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-01-%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html#4","title":"4. \u5347\u7ea7\u4e0e\u8fc1\u79fb\u8def\u7ebf","text":"<ul> <li>\u539f\u5730\u5347\u7ea7\uff1aDBUA \u6216 <code>catctl.pl</code>\uff1b\u7248\u672c\u8de8\u8d8a\u5927\u65f6\u5efa\u8bae\u65c1\u8def\u8fc1\u79fb\u3002</li> <li>\u903b\u8f91\u8fc1\u79fb\uff1a<code>expdp/impdp</code>\u3001Transportable Tablespace\uff1b</li> <li>\u7269\u7406\u8fc1\u79fb\uff1a<code>RMAN DUPLICATE</code>\u3001\u5907\u4efd\u8fd8\u539f + \u91cd\u505a\u5e94\u7528\uff1b</li> <li>\u505c\u673a\u7a97\u53e3\u4f18\u5316\uff1a\u5e76\u884c\u5bfc\u5165\u3001\u5206\u6279\u8fc1\u79fb\u3001\u53cc\u5199/\u53d8\u66f4\u51bb\u7ed3\u3001\u53ea\u8bfb\u5207\u6362\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-01-%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html#5","title":"5. \u9a8c\u6536\u4e0e\u57fa\u7ebf","text":"<ul> <li>\u5065\u5eb7\u68c0\u67e5\uff1a\u544a\u8b66\u65e5\u5fd7/\u65e0 invalid object/AWR \u5173\u952e\u7b49\u5f85\u5728\u57fa\u7ebf\u8303\u56f4\u5185/<code>db_block_change_tracking</code> \u6253\u5f00\u7b49\u3002</li> <li>\u6307\u6807\u57fa\u7ebf\uff1aCPU/\u5185\u5b58/I/O/\u7b49\u5f85\u4e8b\u4ef6/\u4e8b\u52a1\u541e\u5410/\u6162 SQL \u524d 20\uff1b\u4fdd\u5b58\u4e3a\u201c\u4e0a\u7ebf\u57fa\u7ebf\u201d\u6587\u6863\u3002</li> <li>\u6587\u6863\u5316\uff1a\u5b89\u88c5\u8bb0\u5f55\u3001\u53c2\u6570\u6e05\u5355\u3001\u62d3\u6251\u56fe\u3001\u5bb9\u91cf\u8bc4\u4f30\u3001\u56de\u6eda\u65b9\u6848\u3001\u8054\u7cfb\u4eba\u4e0e\u5e94\u6025\u8868\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-01-%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html#6-checklist","title":"6. \u6700\u4f73\u5b9e\u8df5\u6e05\u5355\uff08Checklist\uff09","text":"<ul> <li>[ ] CDB+PDB \u67b6\u6784\u4e0e\u8d44\u6e90\u914d\u989d\u5b8c\u6210</li> <li>[ ] \u5f52\u6863\u4e0e\u95ea\u56de\u533a\u542f\u7528\u4e14\u5bb9\u91cf\u7559\u6709 7 \u5929\u5197\u4f59</li> <li>[ ] \u5907\u4efd\u7b56\u7565\uff08\u5168+\u589e\u91cf+\u5f52\u6863\uff09\u4e0e\u6062\u590d\u6f14\u7ec3\u901a\u8fc7</li> <li>[ ] \u5ba1\u8ba1/\u5bc6\u7801\u7b56\u7565/\u6700\u5c0f\u6743\u9650/\u5bc6\u94a5\u7ba1\u7406\u5230\u4f4d</li> <li>[ ] AWR/ASH \u8bb8\u53ef\u5408\u89c4\u5e76\u5f00\u542f\u91c7\u6837/\u62a5\u544a\u7559\u5b58</li> <li>[ ] RAC/DG \u8bbe\u8ba1\u8bc4\u5ba1\u4e0e\u5b63\u5ea6\u6f14\u7ec3\u8ba1\u5212</li> </ul> <p>\u53c2\u8003\uff1aOracle 19c \u6587\u6863\u3001MOS\u3001\u6700\u4f73\u5b9e\u8df5\u767d\u76ae\u4e66\u3002</p>"},{"location":"dba/Oracle-DBA-02-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E4%B8%8E%E7%9B%91%E6%8E%A7.html","title":"Oracle DBA \u6559\u5b66\uff0802\uff09\u65e5\u5e38\u8fd0\u7ef4\u4e0e\u6027\u80fd\u76d1\u63a7","text":"<p>\u76ee\u6807\uff1a\u5efa\u7acb\u201c\u53ef\u89c2\u6d4b\u3001\u53ef\u9884\u8b66\u3001\u53ef\u56de\u6eaf\u201d\u7684\u65e5\u5e38\u8fd0\u7ef4\u4f53\u7cfb\uff0c\u6ee1\u8db3 7x24 \u7a33\u5b9a\u8fd0\u884c\u7684 JD \u8981\u6c42\u3002</p>"},{"location":"dba/Oracle-DBA-02-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E4%B8%8E%E7%9B%91%E6%8E%A7.html#1","title":"1. \u76d1\u63a7\u9762\u677f\u4e0e\u9608\u503c","text":"<ul> <li>\u4e3b\u673a\uff1aCPU/\u5185\u5b58/\u78c1\u76d8/\u7f51\u7edc/\u65f6\u949f\u540c\u6b65\u3002</li> <li>\u6570\u636e\u5e93\uff1a\u4f1a\u8bdd\u6570\u3001\u9501\u7b49\u5f85\u3001\u65e5\u5fd7\u5207\u6362\u3001\u5f52\u6863\u7a7a\u95f4\u3001PGA/SGA \u547d\u4e2d\u7387\u3001\u5e93\u7f13\u5b58\u3001Parse\u3001Top SQL\u3001I/O \u70ed\u70b9\u3002</li> <li>\u9608\u503c\uff1a\u6309\u4e1a\u52a1 SLA \u8bbe\u7f6e\u591a\u7ea7\u9608\u503c\uff08\u544a\u8b66/\u4e25\u91cd/\u81f4\u547d\uff09\uff0c\u8054\u52a8\u544a\u8b66\u6e20\u9053\uff08\u90ae\u4ef6/IM/\u77ed\u4fe1/\u7535\u8bdd\uff09\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-02-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E4%B8%8E%E7%9B%91%E6%8E%A7.html#2","title":"2. \u5185\u7f6e\u5de5\u5177\u4e0e\u89c6\u56fe","text":"<ul> <li>AWR/ASH\uff1a\u5b9a\u65f6\u5feb\u7167\u3001\u57fa\u7ebf\u3001\u5bf9\u6bd4\u62a5\u544a\u3002</li> <li>OEM/Cloud Control\uff1a\u7edf\u4e00\u76d1\u63a7\u4e0e\u544a\u8b66\u3002</li> <li>\u52a8\u6001\u89c6\u56fe\uff1a<code>v$session</code>\u3001<code>v$sql</code>\u3001<code>v$active_session_history</code>\u3001<code>v$system_event</code>\u3001<code>v$sysstat</code>\u3001<code>dba_hist_*</code>\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-02-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E4%B8%8E%E7%9B%91%E6%8E%A7.html#3","title":"3. \u5e38\u7528\u5de1\u68c0\u811a\u672c","text":"<p>1) \u6d3b\u8dc3\u4f1a\u8bdd\u4e0e\u7b49\u5f85</p> <pre><code>SELECT sid, serial#, username, event, wait_class, state, p1text, p1 FROM v$session WHERE status='ACTIVE' AND username IS NOT NULL;\n</code></pre> <p>2) Top SQL\uff08CPU/\u903b\u8f91\u8bfb\uff09</p> <pre><code>SELECT * FROM (\n  SELECT sql_id, parsing_schema_name, executions, elapsed_time/1e6 elapsed_s, cpu_time/1e6 cpu_s, buffer_gets\n  FROM v$sql\n  WHERE executions&gt;0\n  ORDER BY cpu_time DESC\n) WHERE ROWNUM&lt;=20;\n</code></pre> <p>3) \u8868\u7a7a\u95f4\u5bb9\u91cf</p> <pre><code>SELECT tablespace_name, total_mb, free_mb, ROUND((1-free_mb/total_mb)*100,2) used_pct FROM (\n  SELECT t.name tablespace_name,\n         ROUND(SUM(d.bytes)/1024/1024) total_mb,\n         ROUND(SUM(CASE WHEN f.bytes IS NULL THEN 0 ELSE f.bytes END)/1024/1024) free_mb\n  FROM v$tablespace t\n  JOIN v$datafile d ON t.ts#=d.ts#\n  LEFT JOIN (\n    SELECT tablespace_name, SUM(bytes) bytes FROM dba_free_space GROUP BY tablespace_name\n  ) f ON t.name=f.tablespace_name\n  GROUP BY t.name\n);\n</code></pre> <p>4) \u5f52\u6863\u4f7f\u7528\u7387</p> <pre><code>SELECT name, percent_space_used, percent_space_reclaimable FROM v$recovery_area_usage;\n</code></pre>"},{"location":"dba/Oracle-DBA-02-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E4%B8%8E%E7%9B%91%E6%8E%A7.html#4","title":"4. \u544a\u8b66\u4e0e\u81ea\u6108","text":"<ul> <li>\u544a\u8b66\u6e90\uff1aOEM \u4e8b\u4ef6\u3001\u8868\u7a7a\u95f4\u4f7f\u7528\u7387\u3001RJ \u65e5\u5fd7\u9891\u7e41\u5207\u6362\u3001\u5f52\u6863\u7206\u6ee1\u3001\u7b49\u5f85\u4e8b\u4ef6\u98d9\u5347\u3001\u8fde\u63a5\u5931\u8d25\u6b21\u6570\u3001\u5907\u4efd\u5931\u8d25\u3002</li> <li>\u81ea\u6108\u52a8\u4f5c\uff1a</li> <li>\u8868\u7a7a\u95f4\u9608\u503c\u89e6\u53d1\u81ea\u52a8\u6269\u5bb9\uff08\u524d\u63d0\uff1a\u8bbe\u7f6e\u4e0a\u9650\u5e76\u5ba1\u8ba1\uff09\u3002</li> <li>\u5f52\u6863\u7206\u6ee1\u89e6\u53d1 RMAN \u5f52\u6863\u5220\u9664\u7b56\u7565\u6267\u884c\u3002</li> <li>\u4f1a\u8bdd\u98ce\u66b4\u89e6\u53d1\u8fde\u63a5\u6c60\u9650\u6d41/\u963b\u65ad\u5f02\u5e38\u6765\u6e90\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-02-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E4%B8%8E%E7%9B%91%E6%8E%A7.html#5-7x24","title":"5. 7x24 \u7a33\u5b9a\u8fd0\u884c\u4fdd\u969c","text":"<ul> <li>\u53d8\u66f4\u7a97\u53e3\u4e0e\u51bb\u7ed3\u671f\u7ba1\u7406\uff1b\u53d8\u66f4\u524d\u540e\u57fa\u7ebf\u5bf9\u6bd4\uff1b\u7070\u5ea6\u4e0e\u56de\u6eda\u9884\u6848\u3002</li> <li>\u5bb9\u91cf\u7ba1\u7406\uff1a\u4ee5\u5cf0\u503c 1.5~2 \u500d\u89c4\u5212\uff0c\u53ef\u7528\u533a/\u591a\u673a\u623f\u5197\u4f59\u3002</li> <li>\u8fd0\u884c\u5468\u62a5\uff1a\u5173\u952e\u6307\u6807\u8d8b\u52bf\u3001\u6162 SQL \u5217\u8868\u3001\u4e8b\u4ef6\u603b\u7ed3\u3001\u98ce\u9669\u4e0e\u6539\u8fdb\u8ba1\u5212\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-02-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E4%B8%8E%E7%9B%91%E6%8E%A7.html#6-awrash","title":"6. AWR/ASH \u5b9e\u6218","text":"<ul> <li>\u91c7\u6837\u4e0e\u62a5\u544a</li> </ul> <pre><code>-- AWR \u5bf9\u6bd4\nSELECT * FROM TABLE(dbms_workload_repository.awr_report_html(dbid, inst_num, begin_snap, end_snap));\n-- ASH \u62a5\u544a\n@$ORACLE_HOME/rdbms/admin/ashrpt.sql\n</code></pre> <ul> <li>\u5173\u6ce8\uff1aTop Events\u3001Top SQL\u3001SQL Elapsed vs Executions\u3001I/O Profile\u3001Instance Efficiency\u3001Latch/Mutex\u3001PGA/Temp \u4f7f\u7528\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-02-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E4%B8%8E%E7%9B%91%E6%8E%A7.html#7","title":"7. \u503c\u73ed\u624b\u518c\uff08\u6837\u4f8b\uff09","text":"<ul> <li>\u503c\u73ed\u6d41\uff1a\u76d1\u63a7\u2192\u8bc6\u522b\u2192\u5206\u7ea7\u2192\u786e\u8ba4\u2192\u5904\u7f6e\u2192\u6062\u590d\u2192\u590d\u76d8\u3002</li> <li>MTTD/MTTR \u6307\u6807\uff1bP1/P2/P3 \u5de5\u5355\u54cd\u5e94\u4e0e\u5347\u7ea7\u94fe\u8def\u3002</li> <li>\u5e94\u6025\u8054\u7cfb\u4eba\u6e05\u5355\u4e0e\u534f\u540c\uff08\u5e94\u7528/\u4e2d\u95f4\u4ef6/\u7f51\u7edc/\u5b58\u50a8/\u4f9b\u5e94\u5546\uff09\u3002</li> </ul> <p>\u4ee5\u4e0a\u811a\u672c\u53ef\u4f5c\u4e3a\u5de1\u68c0\u4e0e\u5e94\u6025\u6392\u67e5\u7684\u201c\u8d77\u6b65\u7248\u201d\uff0c\u6839\u636e\u4e1a\u52a1\u7279\u6027\u6269\u5c55\u3002</p>"},{"location":"dba/Oracle-DBA-03-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%B8%8E%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D.html","title":"Oracle DBA \u6559\u5b66\uff0803\uff09\u6570\u636e\u5b89\u5168\u4e0e\u5907\u4efd\u6062\u590d\uff08RMAN / \u51b7\u5907 / \u70ed\u5907 / \u707e\u5907\uff09","text":"<p>\u76ee\u6807\uff1a\u5efa\u7acb\u201c\u53ef\u6062\u590d\u3001\u53ef\u9a8c\u8bc1\u3001\u53ef\u6f14\u7ec3\u201d\u7684\u6570\u636e\u5b89\u5168\u4f53\u7cfb\uff0c\u6ee1\u8db3\u96f6\u6570\u636e\u4e22\u5931\uff08RPO\u22480\uff09\u4e0e\u6700\u77ed\u6062\u590d\u65f6\u95f4\uff08RTO\uff09\u7684\u4e1a\u52a1\u76ee\u6807\u3002</p>"},{"location":"dba/Oracle-DBA-03-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%B8%8E%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D.html#1","title":"1. \u5907\u4efd\u7b56\u7565\u8bbe\u8ba1","text":"<ul> <li>\u76ee\u6807\u503c\uff1a</li> <li>RPO\uff1a\u22645\u5206\u949f\uff08\u5f52\u6863+\u589e\u91cf\uff09\uff1bRTO\uff1a\u6309\u5173\u952e\u4e1a\u52a1\u5206\u7ea7\uff08P1\u226430min\uff09\u3002</li> <li>\u5907\u4efd\u5c42\u6b21\uff1a</li> <li>\u5168\u5907\uff08\u5468\uff09+ \u7d2f\u79ef\u589e\u91cf\uff08\u5929\uff09+ \u65e5\u5fd7\uff08\u5b9e\u65f6\uff09\uff1b</li> <li>\u63a7\u5236\u6587\u4ef6/\u53c2\u6570\u6587\u4ef6/\u5bc6\u7801\u6587\u4ef6\uff1b</li> <li>\u79bb\u7ebf\u62f7\u8d1d\u5143\u6570\u636e\uff08\u5907\u4efd\u76ee\u5f55\u6e05\u5355\u3001\u6821\u9a8c\u6458\u8981\uff09\u3002</li> <li>\u5b58\u50a8\uff1a\u672c\u5730 + \u8fdc\u7aef\uff08\u5bf9\u8c61\u5b58\u50a8/NAS\uff09+ \u5f02\u5730\u5bb9\u707e\uff1b\u52a0\u5bc6\u3001\u5206\u5c42\u751f\u547d\u5468\u671f\u3001\u4e0d\u53ef\u53d8\u5b58\u50a8\uff08WORM\uff09\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-03-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%B8%8E%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D.html#2-rman","title":"2. RMAN \u57fa\u7840\u5957\u8def","text":"<ul> <li>\u914d\u7f6e\u4e0e\u6821\u9a8c</li> </ul> <pre><code>RMAN&gt; CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 14 DAYS;\nRMAN&gt; CONFIGURE CONTROLFILE AUTOBACKUP ON;\nRMAN&gt; CONFIGURE DEVICE TYPE DISK PARALLELISM 4;\nRMAN&gt; SHOW ALL;\n</code></pre> <ul> <li>\u4f8b\u884c\u5907\u4efd\uff08\u5f52\u6863\u65e5\u5fd7\u6a21\u5f0f\uff09</li> </ul> <pre><code>RUN {\n  BACKUP AS COMPRESSED BACKUPSET INCREMENTAL LEVEL 0 DATABASE TAG 'WEEKLY_FULL';\n  BACKUP ARCHIVELOG ALL NOT BACKED UP TAG 'ARCH';\n  BACKUP CURRENT CONTROLFILE TAG 'CTRLFILE';\n}\n</code></pre> <ul> <li>\u65e5\u5e38\u589e\u91cf</li> </ul> <pre><code>RUN {\n  RECOVER COPY OF DATABASE WITH TAG 'WEEKLY_FULL';\n  BACKUP INCREMENTAL LEVEL 1 FOR RECOVER OF COPY WITH TAG 'WEEKLY_FULL' DATABASE;\n  BACKUP ARCHIVELOG ALL NOT BACKED UP;\n}\n</code></pre> <ul> <li>\u5907\u4efd\u6821\u9a8c</li> </ul> <pre><code>RMAN&gt; VALIDATE DATABASE;\nRMAN&gt; CROSSCHECK BACKUP; DELETE NOPROMPT EXPIRED BACKUP;\n</code></pre>"},{"location":"dba/Oracle-DBA-03-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%B8%8E%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D.html#3","title":"3. \u6062\u590d\u5e38\u89c1\u573a\u666f","text":"<ul> <li>\u8bef\u5220\u5355\u8868\uff08\u6709\u56de\u6536\u7ad9\u65f6\uff09</li> </ul> <pre><code>FLASHBACK TABLE scott.emp TO BEFORE DROP;\n</code></pre> <ul> <li>\u8bef\u66f4\u65b0\uff08\u6709\u884c\u79fb\u52a8/\u95ea\u56de\u6570\u636e\u5f52\u6863\uff09</li> </ul> <pre><code>FLASHBACK TABLE t TO TIMESTAMP (SYSTIMESTAMP - INTERVAL '5' MINUTE);\n</code></pre> <ul> <li>\u63a7\u5236\u6587\u4ef6/\u6570\u636e\u6587\u4ef6\u635f\u574f</li> </ul> <pre><code>RMAN&gt; RESTORE CONTROLFILE FROM AUTOBACKUP; \nRMAN&gt; ALTER DATABASE MOUNT; \nRMAN&gt; RESTORE DATABASE; RECOVER DATABASE; \nRMAN&gt; ALTER DATABASE OPEN RESETLOGS;\n</code></pre> <ul> <li>\u5a92\u4f53\u6545\u969c\uff08\u5757\u635f\u574f\uff09</li> </ul> <pre><code>RMAN&gt; BLOCKRECOVER DATAFILE 7 BLOCK 1234;\n</code></pre>"},{"location":"dba/Oracle-DBA-03-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%B8%8E%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D.html#4","title":"4. \u51b7\u5907\u4e0e\u70ed\u5907\u8981\u70b9","text":"<ul> <li>\u51b7\u5907\uff08\u5173\u5e93\u7269\u7406\u62f7\u8d1d\uff09\uff1a\u7a97\u53e3\u5927\u4f46\u98ce\u9669\u4f4e\uff1b\u9002\u5408\u9996\u6b21\u201c\u91d1\u50cf\u201d\u5907\u4efd\u6216\u8fc1\u79fb\u524d\u57fa\u7ebf\u3002</li> <li>\u70ed\u5907\uff08\u8054\u673a RMAN\uff09\uff1a\u7a97\u53e3\u5c0f\uff1b\u914d\u5408\u5f52\u6863\u4e0e\u589e\u91cf\u6eda\u52a8\uff1b\u6ce8\u610f FRA \u7a7a\u95f4\u4e0e\u5f52\u6863\u9891\u7387\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-03-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%B8%8E%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D.html#5","title":"5. \u52a0\u5bc6\u3001\u538b\u7f29\u4e0e\u8131\u654f","text":"<ul> <li>\u5907\u4efd\u52a0\u5bc6\uff1a<code>CONFIGURE ENCRYPTION FOR DATABASE ON;</code> \u4f7f\u7528\u94b1\u5305/\u4e3b\u5bc6\u94a5\u7ba1\u7406\uff1b</li> <li>\u538b\u7f29\uff1a<code>AS COMPRESSED BACKUPSET</code>\uff1b</li> <li>\u8131\u654f\uff1a\u5bfc\u51fa\u5f00\u53d1/\u6d4b\u8bd5\u6570\u636e\u524d\u8fdb\u884c\u6570\u636e\u8131\u654f\uff08\u5b57\u6bb5\u6253\u4e71\u3001\u54c8\u5e0c\u5316\u3001\u4fdd\u578b\u52a0\u5bc6\uff09\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-03-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%B8%8E%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D.html#6-data-guard","title":"6. \u707e\u5907\uff08Data Guard\uff09\u6f14\u7ec3","text":"<ul> <li>\u4fdd\u62a4\u6a21\u5f0f\uff1aMAXIMUM AVAILABILITY\uff08\u96f6/\u8fd1\u96f6 RPO\uff09\u4e0e MAXIMUM PERFORMANCE\uff08\u4f4e\u6210\u672c\uff09\u3002</li> <li>\u5173\u952e\u68c0\u67e5\u6e05\u5355\uff1a</li> <li>\u5f52\u6863\u4f20\u8f93/\u5e94\u7528\u5ef6\u8fdf &lt; 60s\uff1b</li> <li>\u65e5\u5fd7\u5207\u6362\u9891\u7387\u4e0e\u7f51\u7edc\u5e26\u5bbd\u5339\u914d\uff1b</li> <li>\u53ea\u8bfb\u62a5\u8868\u4e0e\u5907\u4efd\u5728\u5907\u5e93\u627f\u8f7d\uff1b</li> <li>\u6bcf\u5b63\u5ea6\u5b8c\u6210 switchover \u4e0e failover \u6f14\u7ec3\u5e76\u7559\u5b58\u62a5\u544a\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-03-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%B8%8E%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D.html#7","title":"7. \u8fd8\u539f\u6f14\u7ec3\uff08\u5efa\u8bae\u6bcf\u6708\uff09","text":"<ul> <li>\u9009\u53d6\u6700\u8fd1\u4e00\u6b21\u5168\u5907 + \u5f52\u6863\uff0c</li> <li>\u5728\u72ec\u7acb\u6d4b\u8bd5\u73af\u5883\u5b8c\u6210\u8fd8\u539f\uff0c\u6821\u9a8c\u5173\u952e\u6838\u5bf9\u70b9\uff1a</li> <li>\u6570\u636e\u5b57\u5178\u4e0e\u5bf9\u8c61\u6570\uff1b</li> <li>\u4e1a\u52a1\u5173\u952e\u8868\u8bb0\u5f55\u6570\uff1b</li> <li>\u5173\u952e\u89c6\u56fe/\u5b58\u50a8\u8fc7\u7a0b\u53ef\u7528\uff1b</li> <li>\u5e94\u7528\u8fde\u63a5/\u8bfb\u5199\u9a8c\u6536\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-03-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%B8%8E%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D.html#8","title":"8. \u5907\u4efd\u76ee\u5f55\u7ed3\u6784\u5efa\u8bae","text":"<pre><code>/u02/backup/DBNAME/\n  |- full/         # \u5468\u5168\u5907\n  |- incr/         # \u65e5\u589e\u91cf\n  |- arch/         # \u5f52\u6863\n  |- ctrl/         # \u63a7\u5236\u6587\u4ef6\n  |- logs/         # \u5907\u4efd\u65e5\u5fd7\n  |- manifest/     # \u5907\u4efd\u6e05\u5355\u4e0e\u6821\u9a8c\n</code></pre> <p>\u6700\u4f73\u5b9e\u8df5\uff1a\u5907\u4efd\u53ef\u8fd8\u539f\u624d\u53eb\u5907\u4efd\u3002\u5efa\u7acb\u201c\u5907\u4efd\u62a5\u544a + \u6062\u590d\u6f14\u7ec3\u62a5\u544a\u201d\u7684\u53cc\u95ed\u73af\uff0c\u63a5\u5165\u5b63\u5ea6\u5ba1\u8ba1\u3002</p>"},{"location":"dba/Oracle-DBA-04-%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E4%B8%8E%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94.html","title":"Oracle DBA \u6559\u5b66\uff0804\uff09\u6545\u969c\u5904\u7406\u4e0e\u5e94\u6025\u54cd\u5e94","text":"<p>\u76ee\u6807\uff1a\u5efa\u7acb\u4e00\u5957\u201c\u5feb\u3001\u51c6\u3001\u7a33\u201d\u7684 P1/P2 \u4e8b\u4ef6\u54cd\u5e94\u6d41\u7a0b\u4e0e\u5b9e\u64cd\u6e05\u5355\uff0c\u8986\u76d6\u9501\u4e0e\u8d44\u6e90\u7ade\u4e89\u3001\u6027\u80fd\u52a3\u5316\u3001\u6570\u636e\u5e93\u4e0d\u53ef\u7528\u3001\u5b58\u50a8/\u7f51\u7edc\u6545\u969c\u7b49\u6838\u5fc3\u573a\u666f\u3002</p>"},{"location":"dba/Oracle-DBA-04-%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E4%B8%8E%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94.html#1","title":"1. \u503c\u5b88\u54cd\u5e94\u4e0e\u5206\u7ea7","text":"<ul> <li>\u4e8b\u4ef6\u5206\u7ea7\uff1aP1\uff08\u4e1a\u52a1\u4e2d\u65ad/\u6838\u5fc3\u8ba2\u5355\u53d7\u963b\uff09\u3001P2\uff08\u6838\u5fc3\u529f\u80fd\u53d7\u5f71\u54cd\uff09\u3001P3\uff08\u4f4e\u4f18\u5148\u7ea7\u7f3a\u9677\uff09\u3002</li> <li>\u54cd\u5e94\u65f6\u6548\uff1aP1 5min \u63a5\u5355/15min \u521d\u5224/30min \u7f13\u89e3\uff1bP2 15/30/60\uff1b\u660e\u786e\u5347\u7ea7\u94fe\u8def\u4e0e\u5916\u90e8\u652f\u63f4\u89e6\u53d1\u6761\u4ef6\uff08\u4f9b\u5e94\u5546 SR/MOS/TAC\uff09\u3002</li> <li>\u8bb0\u5f55\uff1a\u7edf\u4e00\u5de5\u5355\uff0c\u201c\u65f6\u95f4\u7ebf + \u51b3\u7b56 + \u8bc1\u636e\uff08AWR/\u65e5\u5fd7/\u622a\u56fe\uff09\u201d\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-04-%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E4%B8%8E%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94.html#2","title":"2. \u5e38\u89c1\u6545\u969c\u573a\u666f\u4e0e\u5904\u7f6e","text":""},{"location":"dba/Oracle-DBA-04-%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E4%B8%8E%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94.html#21","title":"2.1 \u6570\u636e\u5e93\u9501\u4e0e\u963b\u585e","text":"<ul> <li>\u8bc6\u522b\uff1a</li> </ul> <pre><code>SELECT s1.sid blocker, s2.sid waiter, l1.type, l1.id1, l1.id2\nFROM v$lock l1 JOIN v$session s1 ON l1.sid=s1.sid\nJOIN v$lock l2 ON l1.id1=l2.id1 AND l1.id2=l2.id2 AND l1.block=1 AND l2.request&gt;0\nJOIN v$session s2 ON l2.sid=s2.sid;\n</code></pre> <ul> <li>\u5904\u7f6e\uff1a</li> <li>\u4e0e\u4e1a\u52a1\u786e\u8ba4\uff0c\u7ec8\u6b62\u957f\u4e8b\u52a1/\u5f02\u5e38\u4f1a\u8bdd\uff1a<code>ALTER SYSTEM KILL SESSION 'sid,serial#' IMMEDIATE;</code></li> <li>\u5efa\u7acb\u7d22\u5f15/\u6539\u5199 SQL/\u7f29\u5c0f\u6279\u91cf\uff1b\u542f\u7528\u8d85\u65f6\u4e0e\u9501\u7b49\u5f85\u544a\u8b66\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-04-%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E4%B8%8E%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94.html#22-sql","title":"2.2 \u6027\u80fd\u7a81\u964d\uff08\u6162 SQL/\u7b49\u5f85\u98d9\u5347\uff09","text":"<ul> <li>\u5feb\u7167\u5bf9\u6bd4\uff1aAWR begin/end\uff0c\u5173\u6ce8 Top Events\u3001SQL ordered by Elapsed/CPU\u3001Load Profile\u3002</li> <li>\u5feb\u901f\u7f13\u89e3\uff1a</li> <li>\u901a\u8fc7 SQL Profile/Outline \u6682\u65f6\u56fa\u5b9a\u6267\u884c\u8ba1\u5212\uff1b</li> <li>\u964d\u4f4e\u5e76\u884c\u5ea6\u3001\u5173\u95ed\u95ee\u9898\u529f\u80fd\u3001\u56de\u6eda\u53d8\u66f4\uff1b</li> <li>\u6269\u5bb9 TEMP/UNDO/\u5185\u5b58\uff0c\u964d\u4f4e\u4e89\u7528\u3002</li> <li>\u6839\u56e0\uff1a\u7edf\u8ba1\u4fe1\u606f\u5f02\u5e38\u3001\u7ed1\u5b9a\u53d8\u91cf\u7aa5\u63a2\u3001\u8ba1\u5212\u6f14\u53d8\u3001\u7d22\u5f15\u5931\u6548\u3001\u70ed\u70b9\u5757/\u6bb5\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-04-%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E4%B8%8E%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94.html#23-fra","title":"2.3 FRA/\u5f52\u6863\u7206\u6ee1\u5bfc\u81f4\u4e0d\u53ef\u5199","text":"<pre><code>-- \u91ca\u653e\u5f52\u6863\nRMAN&gt; DELETE NOPROMPT ARCHIVELOG UNTIL TIME 'SYSDATE-1';\n-- \u4e34\u65f6\u6269\u5bb9 FRA \u6216\u5207\u6362\u5f52\u6863\u76ee\u5f55\nALTER SYSTEM SET db_recovery_file_dest_size = 800G SCOPE=BOTH;\n</code></pre>"},{"location":"dba/Oracle-DBA-04-%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E4%B8%8E%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94.html#24","title":"2.4 \u63a7\u5236\u6587\u4ef6/\u8054\u673a\u65e5\u5fd7\u635f\u574f","text":"<pre><code>-- \u63a7\u5236\u6587\u4ef6\nRMAN&gt; RESTORE CONTROLFILE FROM AUTOBACKUP; ALTER DATABASE MOUNT; RECOVER DATABASE;\n-- \u591a\u8def\u590d\u7528 redo\uff0c\u5fc5\u8981\u65f6\u6e05\u7406\u6545\u969c\u7ec4\u5e76\u91cd\u5efa\nALTER DATABASE CLEAR UNARCHIVED LOGFILE GROUP 3;\n</code></pre>"},{"location":"dba/Oracle-DBA-04-%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E4%B8%8E%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94.html#25-data-guard","title":"2.5 Data Guard \u5ef6\u8fdf/\u4e2d\u65ad","text":"<ul> <li>\u590d\u6838\u65e5\u5fd7\u4f20\u8f93/\u5e94\u7528\uff1b\u7f51\u7edc\u5e26\u5bbd\u4e0e\u5ef6\u8fdf\uff1b\u5907\u7528\u5e93\u78c1\u76d8/\u6743\u9650\uff1b\u544a\u8b66\u65e5\u5fd7\u9519\u8bef\u7801\u3002</li> <li>\u5feb\u901f\u5207\u6362\uff1a\u5fc5\u8981\u65f6\u6267\u884c switchover/failover\uff0c\u5e76\u540c\u6b65\u56de\u5207\u8ba1\u5212\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-04-%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E4%B8%8E%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94.html#3","title":"3. \u5e94\u6025\u56de\u9000\u4e0e\u53d8\u66f4\u51bb\u7ed3","text":"<ul> <li>\u5efa\u7acb\u201c\u53d8\u66f4\u2014\u7070\u5ea6\u2014\u56de\u6eda\u2014\u9a8c\u8bc1\u201d\u7684 SOP\uff1b</li> <li>\u5e94\u6025\u56de\u9000\u4f18\u5148\u7ea7\uff1a\u6267\u884c\u8ba1\u5212\u56de\u9000 &gt; \u5e94\u7528\u914d\u7f6e\u56de\u9000 &gt; \u6570\u636e\u5e93\u53c2\u6570\u56de\u9000 &gt; \u7248\u672c/\u8865\u4e01\u56de\u9000\uff1b</li> <li>\u56de\u9000\u9a8c\u8bc1\uff1a\u5173\u952e\u529f\u80fd\u5192\u70df + \u6307\u6807\u56de\u5230\u57fa\u7ebf \u00b15%\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-04-%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E4%B8%8E%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94.html#4","title":"4. \u53d6\u8bc1\u4e0e\u590d\u76d8","text":"<ul> <li>\u53d6\u8bc1\u6e05\u5355\uff1a\u544a\u8b66\u65e5\u5fd7\u3001AWR/ASH \u62a5\u544a\u3001\u7cfb\u7edf\u65e5\u5fd7\u3001\u53d8\u66f4\u8bb0\u5f55\u3001\u76d1\u63a7\u65f6\u95f4\u7ebf\u3002</li> <li>\u590d\u76d8\u6a21\u677f\uff1a\u95ee\u9898\u63cf\u8ff0/\u5f71\u54cd\u8303\u56f4/\u65f6\u95f4\u7ebf/\u6839\u56e0/\u4fee\u590d/\u957f\u671f\u6539\u8fdb/\u8d23\u4efb\u4eba/\u9a8c\u6536\uff1b</li> <li>\u4ea7\u7269\u6c89\u6dc0\uff1a\u77e5\u8bc6\u5e93\u6587\u7ae0\u3001Playbook\u3001\u5de1\u68c0\u811a\u672c\u3001\u53ef\u89c2\u6d4b\u6027\u770b\u677f\u8c03\u6574\u3002</li> </ul>"},{"location":"dba/Oracle-DBA-04-%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E4%B8%8E%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94.html#5-mos","title":"5. \u5e38\u7528 MOS \u6587\u6863\u4e0e\u5de5\u5177","text":"<ul> <li>ORA-600/7445 \u5de5\u5177\uff0cLatch/Mutex \u8bca\u65ad\uff0cSegment Advisor/SQL Tuning Advisor\uff1b</li> <li>ADRCI \u91c7\u96c6\u4e0e\u538b\u7f29\u5305\uff1a<code>adrci&gt; show problem; show incident; ips create package;</code>\uff1b</li> <li>SR \u5347\u7ea7\u672f\uff1a\u95ee\u9898\u6458\u8981\u6e05\u6670\u3001\u5f71\u54cd\u8bc4\u4f30\u3001\u5df2\u91c7\u53d6\u52a8\u4f5c\u3001\u9644\u4ef6\u9f50\u5168\u3002</li> </ul> <p>\u5efa\u8bae\u5efa\u8bbe\u201c\u6f14\u7ec3\u65e5\u5386\u201d\uff1a\u6309\u5b63\u5ea6\u5b8c\u6210\u9501\u98ce\u66b4\u3001FRA \u7206\u6ee1\u3001\u63a7\u5236\u6587\u4ef6\u635f\u574f\u3001DG \u5207\u6362\u7b49\u6f14\u7ec3\uff0c\u5e76\u8f93\u51fa\u6f14\u7ec3\u62a5\u544a\u4e0e\u6539\u8fdb\u9879\u3002</p>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html","title":"Oracle Data Guard \u5b9e\u6218\u90e8\u7f72\u65b9\u6848","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aOracle DBA\u3001\u8fd0\u7ef4\u5de5\u7a0b\u5e08\u3001\u67b6\u6784\u5e08 \u76ee\u6807\uff1a\u63d0\u4f9b Oracle Data Guard \u7269\u7406\u5907\u5e93\u3001\u903b\u8f91\u5907\u5e93\u7684\u5b8c\u6574\u90e8\u7f72\u3001\u914d\u7f6e\u3001\u5207\u6362\u4e0e\u6545\u969c\u5904\u7406\u65b9\u6848\u3002</p>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#1-data-guard","title":"1. Data Guard \u67b6\u6784\u6982\u8ff0","text":""},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#11-data-guard","title":"1.1 \u4ec0\u4e48\u662f Data Guard","text":"<p>Oracle Data Guard \u662f Oracle \u6570\u636e\u5e93\u7684\u9ad8\u53ef\u7528\u3001\u707e\u96be\u6062\u590d\u548c\u6570\u636e\u4fdd\u62a4\u89e3\u51b3\u65b9\u6848\uff0c\u901a\u8fc7\u7ef4\u62a4\u4e00\u4e2a\u6216\u591a\u4e2a\u5907\u5e93\uff08Standby Database\uff09\u6765\u4fdd\u62a4\u751f\u4ea7\u6570\u636e\u5e93\uff08Primary Database\uff09\u3002</p>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#12","title":"1.2 \u67b6\u6784\u7c7b\u578b","text":"\u7c7b\u578b \u539f\u7406 \u5ef6\u8fdf \u7528\u9014 \u8bb8\u53ef \u7269\u7406\u5907\u5e93 (Physical Standby) Redo \u5e94\u7528 \u79d2\u7ea7 \u707e\u5907\u3001\u8bfb\u5199\u5206\u79bb \u6807\u51c6\u7248/\u4f01\u4e1a\u7248 \u903b\u8f91\u5907\u5e93 (Logical Standby) SQL \u5e94\u7528 \u5206\u949f\u7ea7 \u62a5\u8868\u3001\u5347\u7ea7 \u4ec5\u4f01\u4e1a\u7248 \u5feb\u7167\u5907\u5e93 (Snapshot Standby) \u4e34\u65f6\u53ef\u5199 - \u6d4b\u8bd5\u3001\u5f00\u53d1 \u4f01\u4e1a\u7248"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#13","title":"1.3 \u4fdd\u62a4\u6a21\u5f0f","text":"\u6a21\u5f0f \u6570\u636e\u4e22\u5931 \u6027\u80fd\u5f71\u54cd \u9002\u7528\u573a\u666f Maximum Protection \u96f6\u4e22\u5931 \u9ad8 \u91d1\u878d\u3001\u6838\u5fc3\u4e1a\u52a1 Maximum Availability \u96f6\u4e22\u5931\uff08\u6b63\u5e38\uff09 \u4e2d \u63a8\u8350\u6a21\u5f0f Maximum Performance \u53ef\u80fd\u4e22\u5931 \u4f4e \u4e00\u822c\u4e1a\u52a1"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#14","title":"1.4 \u5178\u578b\u67b6\u6784","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u5e94\u7528\u670d\u52a1\u5668                          \u2502\n\u2502         (\u901a\u8fc7 Service Name \u8fde\u63a5)                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                    \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502                       \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Primary DB   \u2502        \u2502 Standby DB   \u2502\n\u2502 (\u4e3b\u5e93)       \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502 (\u5907\u5e93)       \u2502\n\u2502 192.168.1.10 \u2502  Redo  \u2502 192.168.1.20 \u2502\n\u2502 ORCL         \u2502  \u4f20\u8f93   \u2502 ORCL_STBY    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2502                       \u2502\n     \u2502 Archive              \u2502 Archive\n     \u25bc                       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Archive Dest \u2502        \u2502 Archive Dest \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#2","title":"2. \u73af\u5883\u51c6\u5907","text":""},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#21","title":"2.1 \u786c\u4ef6\u4e0e\u7f51\u7edc\u8981\u6c42","text":"<pre><code>\u4e3b\u5e93\u670d\u52a1\u5668\uff1a\n- CPU: 16\u6838+\n- \u5185\u5b58: 64GB+\n- \u5b58\u50a8: 2TB+ (SSD/NVMe)\n- \u7f51\u7edc: \u4e07\u5146\u7f51\u5361\uff0810Gbps\uff09\n\n\u5907\u5e93\u670d\u52a1\u5668\uff1a\n- \u914d\u7f6e\u4e0e\u4e3b\u5e93\u76f8\u540c\u6216\u7565\u4f4e\n- \u7f51\u7edc\u5e26\u5bbd\u5145\u8db3\uff08\u652f\u6301 Redo \u4f20\u8f93\uff09\n\n\u7f51\u7edc\u8981\u6c42\uff1a\n- \u4e3b\u5907\u4e4b\u95f4\u5ef6\u8fdf &lt; 10ms\n- \u5e26\u5bbd &gt; 1Gbps\n- \u4e13\u7528\u7f51\u7edc\uff08\u907f\u514d\u516c\u7f51\uff09\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#22","title":"2.2 \u8f6f\u4ef6\u7248\u672c","text":"<pre><code># \u4e3b\u5e93\u548c\u5907\u5e93\u5fc5\u987b\uff1a\n# - \u76f8\u540c\u7684 Oracle \u7248\u672c\uff08\u5982 19.3.0.0.0\uff09\n# - \u76f8\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\uff08Linux x86_64\uff09\n# - \u76f8\u540c\u7684\u5b57\u7b26\u96c6\n\n# \u67e5\u770b\u7248\u672c\nsqlplus / as sysdba\nSELECT * FROM v$version;\n\n# \u67e5\u770b\u5b57\u7b26\u96c6\nSELECT * FROM nls_database_parameters WHERE parameter = 'NLS_CHARACTERSET';\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#23","title":"2.3 \u4e3b\u673a\u914d\u7f6e","text":"<pre><code># \u4e3b\u5e93\uff1a192.168.1.10 (orcl-primary)\n# \u5907\u5e93\uff1a192.168.1.20 (orcl-standby)\n\n# \u914d\u7f6e /etc/hosts\uff08\u4e24\u53f0\u670d\u52a1\u5668\uff09\ncat &gt;&gt; /etc/hosts &lt;&lt;EOF\n192.168.1.10 orcl-primary\n192.168.1.20 orcl-standby\nEOF\n\n# \u914d\u7f6e SSH \u4e92\u4fe1\uff08\u7528\u4e8e RMAN \u4f20\u8f93\uff09\nssh-keygen -t rsa\nssh-copy-id oracle@orcl-standby\nssh-copy-id oracle@orcl-primary\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#3","title":"3. \u4e3b\u5e93\u914d\u7f6e","text":""},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#31","title":"3.1 \u542f\u7528\u5f52\u6863\u6a21\u5f0f","text":"<pre><code>-- \u68c0\u67e5\u5f52\u6863\u6a21\u5f0f\nSELECT log_mode FROM v$database;\n\n-- \u5982\u679c\u662f NOARCHIVELOG\uff0c\u542f\u7528\u5f52\u6863\nSHUTDOWN IMMEDIATE;\nSTARTUP MOUNT;\nALTER DATABASE ARCHIVELOG;\nALTER DATABASE OPEN;\n\n-- \u9a8c\u8bc1\nSELECT log_mode FROM v$database;\n-- \u8f93\u51fa\uff1aARCHIVELOG\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#32","title":"3.2 \u542f\u7528\u5f3a\u5236\u65e5\u5fd7","text":"<pre><code>-- \u542f\u7528\u5f3a\u5236\u65e5\u5fd7\uff08\u786e\u4fdd\u6240\u6709\u64cd\u4f5c\u90fd\u8bb0\u5f55 Redo\uff09\nALTER DATABASE FORCE LOGGING;\n\n-- \u9a8c\u8bc1\nSELECT force_logging FROM v$database;\n-- \u8f93\u51fa\uff1aYES\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#33-standby-redo-log","title":"3.3 \u914d\u7f6e Standby Redo Log","text":"<pre><code>-- \u67e5\u770b\u5f53\u524d Redo Log \u914d\u7f6e\nSELECT group#, bytes/1024/1024 AS size_mb, members FROM v$log;\n\n-- \u8f93\u51fa\u793a\u4f8b\uff1a\n-- GROUP# | SIZE_MB | MEMBERS\n-- 1      | 200     | 2\n-- 2      | 200     | 2\n-- 3      | 200     | 2\n\n-- \u521b\u5efa Standby Redo Log\uff08\u6570\u91cf = Redo Log \u7ec4\u6570 + 1\uff09\nALTER DATABASE ADD STANDBY LOGFILE THREAD 1 \n  GROUP 4 ('/u01/oradata/ORCL/standby_redo01.log') SIZE 200M;\nALTER DATABASE ADD STANDBY LOGFILE THREAD 1 \n  GROUP 5 ('/u01/oradata/ORCL/standby_redo02.log') SIZE 200M;\nALTER DATABASE ADD STANDBY LOGFILE THREAD 1 \n  GROUP 6 ('/u01/oradata/ORCL/standby_redo03.log') SIZE 200M;\nALTER DATABASE ADD STANDBY LOGFILE THREAD 1 \n  GROUP 7 ('/u01/oradata/ORCL/standby_redo04.log') SIZE 200M;\n\n-- \u9a8c\u8bc1\nSELECT group#, bytes/1024/1024 AS size_mb, status FROM v$standby_log;\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#34","title":"3.4 \u914d\u7f6e\u521d\u59cb\u5316\u53c2\u6570","text":"<pre><code>-- \u8bbe\u7f6e DB_UNIQUE_NAME\nALTER SYSTEM SET db_unique_name='ORCL_PRIMARY' SCOPE=SPFILE;\n\n-- \u914d\u7f6e\u5f52\u6863\u76ee\u5f55\nALTER SYSTEM SET log_archive_dest_1='LOCATION=/u01/archive/ORCL VALID_FOR=(ALL_LOGFILES,ALL_ROLES) DB_UNIQUE_NAME=ORCL_PRIMARY' SCOPE=BOTH;\n\n-- \u914d\u7f6e\u8fdc\u7a0b\u5f52\u6863\u5230\u5907\u5e93\nALTER SYSTEM SET log_archive_dest_2='SERVICE=ORCL_STBY ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=ORCL_STBY' SCOPE=BOTH;\n\n-- \u914d\u7f6e\u5f52\u6863\u683c\u5f0f\nALTER SYSTEM SET log_archive_format='%t_%s_%r.arc' SCOPE=SPFILE;\n\n-- \u914d\u7f6e\u5f52\u6863\u76ee\u6807\u72b6\u6001\nALTER SYSTEM SET log_archive_dest_state_1=ENABLE SCOPE=BOTH;\nALTER SYSTEM SET log_archive_dest_state_2=ENABLE SCOPE=BOTH;\n\n-- \u914d\u7f6e FAL\uff08Fetch Archive Log\uff09\u670d\u52a1\u5668\nALTER SYSTEM SET fal_server='ORCL_STBY' SCOPE=BOTH;\nALTER SYSTEM SET fal_client='ORCL_PRIMARY' SCOPE=BOTH;\n\n-- \u914d\u7f6e Standby File Management\nALTER SYSTEM SET standby_file_management=AUTO SCOPE=BOTH;\n\n-- \u91cd\u542f\u6570\u636e\u5e93\u4f7f\u53c2\u6570\u751f\u6548\nSHUTDOWN IMMEDIATE;\nSTARTUP;\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#35-tns","title":"3.5 \u914d\u7f6e TNS\uff08\u4e3b\u5e93\uff09","text":"<pre><code># $ORACLE_HOME/network/admin/tnsnames.ora\ncat &gt;&gt; $ORACLE_HOME/network/admin/tnsnames.ora &lt;&lt;EOF\nORCL_PRIMARY =\n  (DESCRIPTION =\n    (ADDRESS = (PROTOCOL = TCP)(HOST = orcl-primary)(PORT = 1521))\n    (CONNECT_DATA =\n      (SERVER = DEDICATED)\n      (SERVICE_NAME = ORCL)\n    )\n  )\n\nORCL_STBY =\n  (DESCRIPTION =\n    (ADDRESS = (PROTOCOL = TCP)(HOST = orcl-standby)(PORT = 1521))\n    (CONNECT_DATA =\n      (SERVER = DEDICATED)\n      (SERVICE_NAME = ORCL_STBY)\n    )\n  )\nEOF\n\n# \u6d4b\u8bd5\u8fde\u63a5\ntnsping ORCL_STBY\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#36","title":"3.6 \u914d\u7f6e\u76d1\u542c\u5668\uff08\u4e3b\u5e93\uff09","text":"<pre><code># $ORACLE_HOME/network/admin/listener.ora\ncat &gt; $ORACLE_HOME/network/admin/listener.ora &lt;&lt;EOF\nLISTENER =\n  (DESCRIPTION_LIST =\n    (DESCRIPTION =\n      (ADDRESS = (PROTOCOL = TCP)(HOST = orcl-primary)(PORT = 1521))\n    )\n  )\n\nSID_LIST_LISTENER =\n  (SID_LIST =\n    (SID_DESC =\n      (GLOBAL_DBNAME = ORCL)\n      (ORACLE_HOME = /u01/app/oracle/product/19.3.0/dbhome_1)\n      (SID_NAME = ORCL)\n    )\n  )\nEOF\n\n# \u91cd\u542f\u76d1\u542c\u5668\nlsnrctl stop\nlsnrctl start\nlsnrctl status\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#4","title":"4. \u5907\u5e93\u90e8\u7f72","text":""},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#41-rman","title":"4.1 \u4f7f\u7528 RMAN \u521b\u5efa\u5907\u5e93","text":"<pre><code># \u5728\u5907\u5e93\u670d\u52a1\u5668\u521b\u5efa\u5fc5\u8981\u76ee\u5f55\nmkdir -p /u01/oradata/ORCL_STBY\nmkdir -p /u01/archive/ORCL_STBY\nmkdir -p /u01/app/oracle/admin/ORCL_STBY/adump\n\n# \u521b\u5efa\u5bc6\u7801\u6587\u4ef6\uff08\u4e0e\u4e3b\u5e93\u76f8\u540c\uff09\nscp oracle@orcl-primary:$ORACLE_HOME/dbs/orapwORCL $ORACLE_HOME/dbs/orapwORCL_STBY\n\n# \u521b\u5efa\u521d\u59cb\u5316\u53c2\u6570\u6587\u4ef6\ncat &gt; $ORACLE_HOME/dbs/initORCL_STBY.ora &lt;&lt;EOF\n*.db_name='ORCL'\n*.db_unique_name='ORCL_STBY'\n*.db_file_name_convert='/u01/oradata/ORCL/','/u01/oradata/ORCL_STBY/'\n*.log_file_name_convert='/u01/oradata/ORCL/','/u01/oradata/ORCL_STBY/'\n*.log_archive_dest_1='LOCATION=/u01/archive/ORCL_STBY VALID_FOR=(ALL_LOGFILES,ALL_ROLES) DB_UNIQUE_NAME=ORCL_STBY'\n*.log_archive_dest_2='SERVICE=ORCL_PRIMARY ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=ORCL_PRIMARY'\n*.log_archive_format='%t_%s_%r.arc'\n*.fal_server='ORCL_PRIMARY'\n*.fal_client='ORCL_STBY'\n*.standby_file_management=AUTO\nEOF\n\n# \u542f\u52a8\u5907\u5e93\u5230 NOMOUNT \u72b6\u6001\nexport ORACLE_SID=ORCL_STBY\nsqlplus / as sysdba\nSTARTUP NOMOUNT PFILE='$ORACLE_HOME/dbs/initORCL_STBY.ora';\nEXIT;\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#42-rman-duplicate","title":"4.2 \u4f7f\u7528 RMAN DUPLICATE \u521b\u5efa\u5907\u5e93","text":"<pre><code># \u5728\u5907\u5e93\u670d\u52a1\u5668\u6267\u884c\nrman TARGET sys/Oracle123#@ORCL_PRIMARY AUXILIARY sys/Oracle123#@ORCL_STBY\n\n# RMAN \u811a\u672c\nDUPLICATE TARGET DATABASE\n  FOR STANDBY\n  FROM ACTIVE DATABASE\n  DORECOVER\n  SPFILE\n    SET db_unique_name='ORCL_STBY' COMMENT 'Standby DB'\n    SET log_archive_dest_1='LOCATION=/u01/archive/ORCL_STBY VALID_FOR=(ALL_LOGFILES,ALL_ROLES) DB_UNIQUE_NAME=ORCL_STBY'\n    SET log_archive_dest_2='SERVICE=ORCL_PRIMARY ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=ORCL_PRIMARY'\n    SET fal_server='ORCL_PRIMARY'\n    SET fal_client='ORCL_STBY'\n  NOFILENAMECHECK;\n\nEXIT;\n\n# \u8be5\u8fc7\u7a0b\u4f1a\uff1a\n# 1. \u4ece\u4e3b\u5e93\u590d\u5236\u6570\u636e\u6587\u4ef6\n# 2. \u521b\u5efa\u63a7\u5236\u6587\u4ef6\n# 3. \u5e94\u7528\u5f52\u6863\u65e5\u5fd7\n# 4. \u521b\u5efa SPFILE\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#43-tns","title":"4.3 \u914d\u7f6e TNS\uff08\u5907\u5e93\uff09","text":"<pre><code># $ORACLE_HOME/network/admin/tnsnames.ora\ncat &gt;&gt; $ORACLE_HOME/network/admin/tnsnames.ora &lt;&lt;EOF\nORCL_PRIMARY =\n  (DESCRIPTION =\n    (ADDRESS = (PROTOCOL = TCP)(HOST = orcl-primary)(PORT = 1521))\n    (CONNECT_DATA =\n      (SERVER = DEDICATED)\n      (SERVICE_NAME = ORCL)\n    )\n  )\n\nORCL_STBY =\n  (DESCRIPTION =\n    (ADDRESS = (PROTOCOL = TCP)(HOST = orcl-standby)(PORT = 1521))\n    (CONNECT_DATA =\n      (SERVER = DEDICATED)\n      (SERVICE_NAME = ORCL_STBY)\n    )\n  )\nEOF\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#44","title":"4.4 \u914d\u7f6e\u76d1\u542c\u5668\uff08\u5907\u5e93\uff09","text":"<pre><code># $ORACLE_HOME/network/admin/listener.ora\ncat &gt; $ORACLE_HOME/network/admin/listener.ora &lt;&lt;EOF\nLISTENER =\n  (DESCRIPTION_LIST =\n    (DESCRIPTION =\n      (ADDRESS = (PROTOCOL = TCP)(HOST = orcl-standby)(PORT = 1521))\n    )\n  )\n\nSID_LIST_LISTENER =\n  (SID_LIST =\n    (SID_DESC =\n      (GLOBAL_DBNAME = ORCL_STBY)\n      (ORACLE_HOME = /u01/app/oracle/product/19.3.0/dbhome_1)\n      (SID_NAME = ORCL_STBY)\n    )\n  )\nEOF\n\n# \u91cd\u542f\u76d1\u542c\u5668\nlsnrctl stop\nlsnrctl start\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#5-data-guard","title":"5. \u542f\u52a8 Data Guard","text":""},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#51-redo","title":"5.1 \u542f\u52a8\u5907\u5e93 Redo \u5e94\u7528","text":"<pre><code>-- \u5728\u5907\u5e93\u6267\u884c\nsqlplus / as sysdba\n\n-- \u542f\u52a8\u5230 MOUNT \u72b6\u6001\nSHUTDOWN IMMEDIATE;\nSTARTUP MOUNT;\n\n-- \u542f\u52a8 Redo \u5e94\u7528\uff08\u5b9e\u65f6\u5e94\u7528\uff09\nALTER DATABASE RECOVER MANAGED STANDBY DATABASE USING CURRENT LOGFILE DISCONNECT FROM SESSION;\n\n-- \u9a8c\u8bc1\u72b6\u6001\nSELECT database_role, open_mode FROM v$database;\n-- \u8f93\u51fa\uff1a\n-- DATABASE_ROLE | OPEN_MODE\n-- PHYSICAL STANDBY | MOUNTED\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#52-active-data-guard","title":"5.2 \u542f\u7528 Active Data Guard\uff08\u53ef\u9009\uff0c\u9700\u4f01\u4e1a\u7248\u8bb8\u53ef\uff09","text":"<pre><code>-- \u5728\u5907\u5e93\u6267\u884c\nALTER DATABASE OPEN READ ONLY;\nALTER DATABASE RECOVER MANAGED STANDBY DATABASE USING CURRENT LOGFILE DISCONNECT FROM SESSION;\n\n-- \u9a8c\u8bc1\nSELECT database_role, open_mode FROM v$database;\n-- \u8f93\u51fa\uff1a\n-- DATABASE_ROLE | OPEN_MODE\n-- PHYSICAL STANDBY | READ ONLY WITH APPLY\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#6","title":"6. \u76d1\u63a7\u4e0e\u9a8c\u8bc1","text":""},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#61","title":"6.1 \u68c0\u67e5\u5f52\u6863\u4f20\u8f93","text":"<pre><code>-- \u4e3b\u5e93\uff1a\u67e5\u770b\u5f52\u6863\u76ee\u6807\u72b6\u6001\nSELECT dest_id, status, destination, error FROM v$archive_dest WHERE dest_id &lt;= 2;\n\n-- \u8f93\u51fa\u793a\u4f8b\uff1a\n-- DEST_ID | STATUS | DESTINATION           | ERROR\n-- 1       | VALID  | /u01/archive/ORCL     | \n-- 2       | VALID  | ORCL_STBY             |\n\n-- \u4e3b\u5e93\uff1a\u67e5\u770b\u5f52\u6863\u65e5\u5fd7\nSELECT sequence#, first_time, next_time, applied FROM v$archived_log \nWHERE dest_id = 2 \nORDER BY sequence# DESC \nFETCH FIRST 10 ROWS ONLY;\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#62-redo","title":"6.2 \u68c0\u67e5 Redo \u5e94\u7528\u5ef6\u8fdf","text":"<pre><code>-- \u5907\u5e93\uff1a\u67e5\u770b\u5e94\u7528\u5ef6\u8fdf\nSELECT name, value, unit, time_computed \nFROM v$dataguard_stats \nWHERE name IN ('transport lag', 'apply lag');\n\n-- \u8f93\u51fa\u793a\u4f8b\uff1a\n-- NAME          | VALUE      | UNIT    | TIME_COMPUTED\n-- transport lag | +00 00:00:02 | seconds | 2025-11-11 15:30:00\n-- apply lag     | +00 00:00:05 | seconds | 2025-11-11 15:30:00\n\n-- \u5907\u5e93\uff1a\u67e5\u770b\u5e94\u7528\u8fdb\u5ea6\nSELECT process, status, thread#, sequence#, block#, blocks \nFROM v$managed_standby;\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#63","title":"6.3 \u68c0\u67e5\u6570\u636e\u540c\u6b65","text":"<pre><code>-- \u4e3b\u5e93\uff1a\u67e5\u770b\u5f53\u524d SCN\nSELECT current_scn FROM v$database;\n\n-- \u5907\u5e93\uff1a\u67e5\u770b\u5e94\u7528\u7684 SCN\nSELECT current_scn FROM v$database;\n\n-- \u5bf9\u6bd4\u4e24\u8005\u5dee\u5f02\uff08\u5e94\u8be5\u5f88\u5c0f\uff09\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#7","title":"7. \u5207\u6362\u64cd\u4f5c","text":""},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#71-switchover","title":"7.1 Switchover\uff08\u8ba1\u5212\u5185\u5207\u6362\uff09","text":"<pre><code>-- \u6b65\u9aa41\uff1a\u5728\u4e3b\u5e93\u9a8c\u8bc1\u53ef\u5207\u6362\u6027\nSELECT switchover_status FROM v$database;\n-- \u8f93\u51fa\u5e94\u4e3a\uff1aTO STANDBY \u6216 SESSIONS ACTIVE\n\n-- \u5982\u679c\u662f SESSIONS ACTIVE\uff0c\u6267\u884c\uff1a\nALTER DATABASE COMMIT TO SWITCHOVER TO PHYSICAL STANDBY WITH SESSION SHUTDOWN;\n\n-- \u6b65\u9aa42\uff1a\u5728\u4e3b\u5e93\u6267\u884c\u5207\u6362\nALTER DATABASE COMMIT TO SWITCHOVER TO PHYSICAL STANDBY;\nSHUTDOWN IMMEDIATE;\nSTARTUP MOUNT;\n\n-- \u6b65\u9aa43\uff1a\u5728\u5907\u5e93\u9a8c\u8bc1\u53ef\u5207\u6362\u6027\nSELECT switchover_status FROM v$database;\n-- \u8f93\u51fa\u5e94\u4e3a\uff1aTO PRIMARY \u6216 SESSIONS ACTIVE\n\n-- \u6b65\u9aa44\uff1a\u5728\u5907\u5e93\u6267\u884c\u5207\u6362\nALTER DATABASE COMMIT TO SWITCHOVER TO PRIMARY;\nALTER DATABASE OPEN;\n\n-- \u6b65\u9aa45\uff1a\u5728\u65b0\u5907\u5e93\uff08\u539f\u4e3b\u5e93\uff09\u542f\u52a8 Redo \u5e94\u7528\nALTER DATABASE RECOVER MANAGED STANDBY DATABASE USING CURRENT LOGFILE DISCONNECT FROM SESSION;\n\n-- \u9a8c\u8bc1\u89d2\u8272\nSELECT database_role FROM v$database;\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#72-failover","title":"7.2 Failover\uff08\u6545\u969c\u5207\u6362\uff09","text":"<pre><code>-- \u573a\u666f\uff1a\u4e3b\u5e93\u6545\u969c\uff0c\u9700\u8981\u7d27\u6025\u5207\u6362\u5230\u5907\u5e93\n\n-- \u6b65\u9aa41\uff1a\u5728\u5907\u5e93\u505c\u6b62 Redo \u5e94\u7528\nALTER DATABASE RECOVER MANAGED STANDBY DATABASE CANCEL;\n\n-- \u6b65\u9aa42\uff1a\u5b8c\u6210\u6062\u590d\uff08\u5e94\u7528\u6240\u6709\u53ef\u7528\u7684\u5f52\u6863\u65e5\u5fd7\uff09\nALTER DATABASE RECOVER MANAGED STANDBY DATABASE FINISH;\n\n-- \u6b65\u9aa43\uff1a\u6fc0\u6d3b\u5907\u5e93\u4e3a\u4e3b\u5e93\nALTER DATABASE ACTIVATE PHYSICAL STANDBY DATABASE;\n\n-- \u6b65\u9aa44\uff1a\u6253\u5f00\u6570\u636e\u5e93\nALTER DATABASE OPEN;\n\n-- \u6b65\u9aa45\uff1a\u9a8c\u8bc1\u89d2\u8272\nSELECT database_role, open_mode FROM v$database;\n-- \u8f93\u51fa\uff1a\n-- DATABASE_ROLE | OPEN_MODE\n-- PRIMARY       | READ WRITE\n\n-- \u6ce8\u610f\uff1aFailover \u540e\uff0c\u539f\u4e3b\u5e93\u9700\u8981\u91cd\u65b0\u521b\u5efa\u4e3a\u5907\u5e93\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#8","title":"8. \u6545\u969c\u5904\u7406","text":""},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#81","title":"8.1 \u5f52\u6863\u4f20\u8f93\u4e2d\u65ad","text":"<pre><code>-- \u4e3b\u5e93\uff1a\u68c0\u67e5\u5f52\u6863\u76ee\u6807\u72b6\u6001\nSELECT dest_id, status, error FROM v$archive_dest WHERE dest_id = 2;\n\n-- \u5982\u679c STATUS = ERROR\uff0c\u67e5\u770b\u9519\u8bef\u4fe1\u606f\nSELECT message FROM v$dataguard_status WHERE severity = 'Error';\n\n-- \u5e38\u89c1\u539f\u56e0\uff1a\n-- 1. \u7f51\u7edc\u4e2d\u65ad\uff1a\u68c0\u67e5\u7f51\u7edc\u8fde\u901a\u6027\n-- 2. \u5907\u5e93\u78c1\u76d8\u6ee1\uff1a\u6e05\u7406\u5f52\u6863\u65e5\u5fd7\n-- 3. TNS \u914d\u7f6e\u9519\u8bef\uff1a\u68c0\u67e5 tnsnames.ora\n\n-- \u89e3\u51b3\u540e\uff0c\u91cd\u65b0\u542f\u7528\u5f52\u6863\u76ee\u6807\nALTER SYSTEM SET log_archive_dest_state_2=ENABLE;\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#82-redo","title":"8.2 Redo \u5e94\u7528\u5ef6\u8fdf","text":"<pre><code>-- \u5907\u5e93\uff1a\u68c0\u67e5\u5e94\u7528\u5ef6\u8fdf\nSELECT name, value FROM v$dataguard_stats WHERE name = 'apply lag';\n\n-- \u5982\u679c\u5ef6\u8fdf\u8fc7\u5927\uff08&gt; 1\u5206\u949f\uff09\uff0c\u68c0\u67e5\uff1a\n-- 1. \u5907\u5e93\u8d44\u6e90\uff08CPU/IO\uff09\nSELECT * FROM v$session WHERE program LIKE '%MRP%';\n\n-- 2. \u5e94\u7528\u901f\u7387\nSELECT process, status, sequence# FROM v$managed_standby WHERE process LIKE 'MRP%';\n\n-- 3. \u91cd\u542f Redo \u5e94\u7528\nALTER DATABASE RECOVER MANAGED STANDBY DATABASE CANCEL;\nALTER DATABASE RECOVER MANAGED STANDBY DATABASE USING CURRENT LOGFILE DISCONNECT FROM SESSION;\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#83-gap","title":"8.3 \u5f52\u6863\u65e5\u5fd7\u7f3a\u5931\uff08GAP\uff09","text":"<pre><code>-- \u5907\u5e93\uff1a\u68c0\u67e5\u5f52\u6863\u65e5\u5fd7\u7f3a\u5931\nSELECT * FROM v$archive_gap;\n\n-- \u8f93\u51fa\u793a\u4f8b\uff1a\n-- THREAD# | LOW_SEQUENCE# | HIGH_SEQUENCE#\n-- 1       | 1234          | 1236\n\n-- \u624b\u52a8\u4ece\u4e3b\u5e93\u4f20\u8f93\u7f3a\u5931\u7684\u5f52\u6863\u65e5\u5fd7\n-- \u5728\u4e3b\u5e93\u6267\u884c\uff1a\nALTER SYSTEM ARCHIVE LOG CURRENT;\nALTER SYSTEM SWITCH LOGFILE;\n\n-- \u6216\u624b\u52a8\u590d\u5236\u5f52\u6863\u6587\u4ef6\nscp /u01/archive/ORCL/1_1234_*.arc oracle@orcl-standby:/u01/archive/ORCL_STBY/\n\n-- \u5728\u5907\u5e93\u6ce8\u518c\u5f52\u6863\u65e5\u5fd7\nALTER DATABASE REGISTER PHYSICAL LOGFILE '/u01/archive/ORCL_STBY/1_1234_*.arc';\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#9-data-guard-broker","title":"9. Data Guard Broker\uff08\u53ef\u9009\uff09","text":""},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#91-broker","title":"9.1 \u542f\u7528 Broker","text":"<pre><code>-- \u4e3b\u5e93\u548c\u5907\u5e93\u90fd\u6267\u884c\nALTER SYSTEM SET dg_broker_start=TRUE SCOPE=BOTH;\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#92-broker","title":"9.2 \u914d\u7f6e Broker","text":"<pre><code># \u4f7f\u7528 DGMGRL \u5de5\u5177\ndgmgrl sys/Oracle123#@ORCL_PRIMARY\n\n# \u521b\u5efa\u914d\u7f6e\nCREATE CONFIGURATION dg_config AS\n  PRIMARY DATABASE IS ORCL_PRIMARY\n  CONNECT IDENTIFIER IS ORCL_PRIMARY;\n\n# \u6dfb\u52a0\u5907\u5e93\nADD DATABASE ORCL_STBY AS\n  CONNECT IDENTIFIER IS ORCL_STBY\n  MAINTAINED AS PHYSICAL;\n\n# \u542f\u7528\u914d\u7f6e\nENABLE CONFIGURATION;\n\n# \u67e5\u770b\u914d\u7f6e\nSHOW CONFIGURATION;\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\n# Configuration - dg_config\n#   Protection Mode: MaxPerformance\n#   Members:\n#   ORCL_PRIMARY - Primary database\n#   ORCL_STBY    - Physical standby database\n# Fast-Start Failover: DISABLED\n# Configuration Status: SUCCESS\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#93-broker","title":"9.3 \u4f7f\u7528 Broker \u5207\u6362","text":"<pre><code># Switchover\nSWITCHOVER TO ORCL_STBY;\n\n# Failover\nFAILOVER TO ORCL_STBY;\n\n# \u67e5\u770b\u72b6\u6001\nSHOW DATABASE ORCL_PRIMARY;\nSHOW DATABASE ORCL_STBY;\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#10","title":"10. \u6027\u80fd\u4f18\u5316","text":""},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#101","title":"10.1 \u5f52\u6863\u4f20\u8f93\u4f18\u5316","text":"<pre><code>-- \u4f7f\u7528 ASYNC \u6a21\u5f0f\uff08\u9ed8\u8ba4\uff09\nALTER SYSTEM SET log_archive_dest_2='SERVICE=ORCL_STBY ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=ORCL_STBY';\n\n-- \u4f7f\u7528\u538b\u7f29\u4f20\u8f93\uff08\u51cf\u5c11\u7f51\u7edc\u5e26\u5bbd\uff09\nALTER SYSTEM SET log_archive_dest_2='SERVICE=ORCL_STBY ASYNC COMPRESSION=ENABLE VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=ORCL_STBY';\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#102-redo","title":"10.2 Redo \u5e94\u7528\u4f18\u5316","text":"<pre><code>-- \u542f\u7528\u5e76\u884c\u6062\u590d\nALTER DATABASE RECOVER MANAGED STANDBY DATABASE USING CURRENT LOGFILE DISCONNECT FROM SESSION PARALLEL 4;\n\n-- \u8c03\u6574 SGA\nALTER SYSTEM SET sga_target=16G SCOPE=SPFILE;\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#11","title":"11. \u76d1\u63a7\u811a\u672c","text":"<pre><code>#!/bin/bash\n# check_dataguard.sh\n\necho \"=== Data Guard Status Check ===\"\n\n# \u4e3b\u5e93\u68c0\u67e5\necho \"Primary Database:\"\nsqlplus -s / as sysdba &lt;&lt;EOF\nSET PAGESIZE 0 FEEDBACK OFF\nSELECT 'Role: ' || database_role FROM v$database;\nSELECT 'Archive Dest 2: ' || status FROM v$archive_dest WHERE dest_id = 2;\nSELECT 'Current Sequence: ' || MAX(sequence#) FROM v$archived_log WHERE dest_id = 1;\nEXIT;\nEOF\n\n# \u5907\u5e93\u68c0\u67e5\necho \"Standby Database:\"\nssh oracle@orcl-standby \"sqlplus -s / as sysdba\" &lt;&lt;EOF\nSET PAGESIZE 0 FEEDBACK OFF\nSELECT 'Role: ' || database_role FROM v$database;\nSELECT 'Open Mode: ' || open_mode FROM v$database;\nSELECT 'Apply Lag: ' || value FROM v$dataguard_stats WHERE name = 'apply lag';\nSELECT 'Applied Sequence: ' || MAX(sequence#) FROM v$archived_log WHERE applied = 'YES';\nEXIT;\nEOF\n</code></pre>"},{"location":"dba/Oracle-DataGuard-%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html#12_1","title":"12. \u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u5b9a\u671f\u6f14\u7ec3\uff1a\u6bcf\u5b63\u5ea6\u8fdb\u884c Switchover \u6f14\u7ec3</li> <li>\u76d1\u63a7\u544a\u8b66\uff1a\u5e94\u7528\u5ef6\u8fdf &gt; 1\u5206\u949f\u544a\u8b66</li> <li>\u5f52\u6863\u7ba1\u7406\uff1a\u5b9a\u671f\u6e05\u7406\u5f52\u6863\u65e5\u5fd7\uff0c\u907f\u514d\u78c1\u76d8\u6ee1</li> <li>\u7f51\u7edc\u4f18\u5316\uff1a\u4f7f\u7528\u4e13\u7528\u7f51\u7edc\uff0c\u907f\u514d\u516c\u7f51\u4f20\u8f93</li> <li>\u53c2\u6570\u4e00\u81f4\uff1a\u4e3b\u5907\u5e93\u53c2\u6570\u5c3d\u91cf\u4fdd\u6301\u4e00\u81f4</li> <li>\u5907\u4efd\u7b56\u7565\uff1a\u5728\u5907\u5e93\u6267\u884c RMAN \u5907\u4efd\uff0c\u51cf\u8f7b\u4e3b\u5e93\u538b\u529b</li> <li>\u6587\u6863\u8bb0\u5f55\uff1a\u8bb0\u5f55\u6240\u6709\u914d\u7f6e\u548c\u5207\u6362\u64cd\u4f5c</li> </ol> <p>\u53c2\u8003\u6587\u6863\uff1a - Oracle Data Guard Concepts and Administration (19c) - Oracle Data Guard Broker (19c) - MOS Note: Data Guard Best Practices (Doc ID 1454802.1)</p>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html","title":"Oracle GoldenGate \u90e8\u7f72\u65b9\u6848\u53ca\u5165\u95e8\u6559\u5b66","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aOracle DBA\u3001\u6570\u636e\u5de5\u7a0b\u5e08\u3001\u67b6\u6784\u5e08 \u76ee\u6807\uff1a\u63d0\u4f9b Oracle GoldenGate (OGG) \u7684\u5b8c\u6574\u90e8\u7f72\u3001\u914d\u7f6e\u3001\u76d1\u63a7\u4e0e\u6545\u969c\u5904\u7406\u65b9\u6848\uff0c\u6db5\u76d6\u5355\u5411\u590d\u5236\u3001\u53cc\u5411\u590d\u5236\u3001\u5f02\u6784\u6570\u636e\u5e93\u540c\u6b65\u3002</p>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#1-goldengate","title":"1. GoldenGate \u6982\u8ff0","text":""},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#11-goldengate","title":"1.1 \u4ec0\u4e48\u662f GoldenGate","text":"<p>Oracle GoldenGate \u662f\u4e00\u6b3e\u5b9e\u65f6\u6570\u636e\u96c6\u6210\u548c\u590d\u5236\u8f6f\u4ef6\uff0c\u652f\u6301\uff1a - \u5b9e\u65f6\u6570\u636e\u6355\u83b7\uff1a\u57fa\u4e8e\u65e5\u5fd7\u7684 CDC\uff08Change Data Capture\uff09 - \u5f02\u6784\u590d\u5236\uff1aOracle \u2194 MySQL/PostgreSQL/SQL Server - \u53cc\u5411\u590d\u5236\uff1a\u652f\u6301\u591a\u4e3b\u590d\u5236 - \u6570\u636e\u8f6c\u6362\uff1a\u652f\u6301\u5b57\u6bb5\u6620\u5c04\u3001\u8fc7\u6ee4\u3001\u8f6c\u6362</p>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#12","title":"1.2 \u6838\u5fc3\u7ec4\u4ef6","text":"\u7ec4\u4ef6 \u529f\u80fd \u90e8\u7f72\u4f4d\u7f6e Extract \u4ece\u6e90\u6570\u636e\u5e93\u6355\u83b7\u53d8\u66f4 \u6e90\u7aef Data Pump \u4f20\u8f93 Trail \u6587\u4ef6\u5230\u76ee\u6807\u7aef \u6e90\u7aef Replicat \u5e94\u7528\u53d8\u66f4\u5230\u76ee\u6807\u6570\u636e\u5e93 \u76ee\u6807\u7aef Trail File \u5b58\u50a8\u53d8\u66f4\u6570\u636e\u7684\u6587\u4ef6 \u6e90\u7aef/\u76ee\u6807\u7aef Manager \u7ba1\u7406\u8fdb\u7a0b\u3001\u7aef\u53e3\u3001\u65e5\u5fd7 \u6e90\u7aef/\u76ee\u6807\u7aef"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#13","title":"1.3 \u67b6\u6784\u56fe","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u6e90\u6570\u636e\u5e93 (Oracle)                   \u2502\n\u2502                                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                \u2502\n\u2502  \u2502 Extract  \u2502\u2500\u2500\u2500\u2500\u2500\u25ba\u2502Data Pump \u2502                \u2502\n\u2502  \u2502 (\u6355\u83b7)   \u2502      \u2502 (\u4f20\u8f93)   \u2502                \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                \u2502\n\u2502       \u2502                  \u2502                      \u2502\n\u2502       \u25bc                  \u25bc                      \u2502\n\u2502  Local Trail        Remote Trail               \u2502\n\u2502  (/u01/ogg/dirdat)  (\u4f20\u8f93\u5230\u76ee\u6807\u7aef)              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502\n                        \u2502 \u7f51\u7edc\u4f20\u8f93\n                        \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u76ee\u6807\u6570\u636e\u5e93 (Oracle/MySQL)           \u2502\n\u2502                                                 \u2502\n\u2502       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                              \u2502\n\u2502       \u2502Replicat  \u2502                              \u2502\n\u2502       \u2502 (\u5e94\u7528)   \u2502                              \u2502\n\u2502       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                              \u2502\n\u2502            \u2502                                    \u2502\n\u2502            \u25bc                                    \u2502\n\u2502       \u76ee\u6807\u8868                                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#14","title":"1.4 \u5e94\u7528\u573a\u666f","text":"<ul> <li>\u6570\u636e\u5e93\u8fc1\u79fb\uff1aOracle \u2192 MySQL/PostgreSQL</li> <li>\u707e\u5907\u540c\u6b65\uff1a\u5b9e\u65f6\u6570\u636e\u590d\u5236\u5230\u5f02\u5730</li> <li>\u8bfb\u5199\u5206\u79bb\uff1a\u4e3b\u5e93\u5199\u5165\uff0c\u4ece\u5e93\u67e5\u8be2</li> <li>\u6570\u636e\u96c6\u6210\uff1a\u591a\u4e2a\u6570\u636e\u6e90\u6c47\u603b\u5230\u6570\u636e\u4ed3\u5e93</li> <li>\u53cc\u6d3b\u67b6\u6784\uff1a\u53cc\u5411\u590d\u5236\uff0c\u591a\u5730\u5199\u5165</li> </ul>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#2","title":"2. \u73af\u5883\u51c6\u5907","text":""},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#21","title":"2.1 \u786c\u4ef6\u4e0e\u8f6f\u4ef6\u8981\u6c42","text":"<pre><code>\u6e90\u7aef\u670d\u52a1\u5668\uff1a\n- CPU: 8\u6838+\n- \u5185\u5b58: 16GB+\n- \u78c1\u76d8: 500GB+\uff08\u5b58\u50a8 Trail \u6587\u4ef6\uff09\n- \u7f51\u7edc: \u5343\u5146\u7f51\u5361\n\n\u76ee\u6807\u7aef\u670d\u52a1\u5668\uff1a\n- \u914d\u7f6e\u4e0e\u6e90\u7aef\u76f8\u540c\n\n\u8f6f\u4ef6\u7248\u672c\uff1a\n- Oracle GoldenGate 19.1+ (for Oracle)\n- Oracle GoldenGate 19.1+ (for MySQL/PostgreSQL)\n- Oracle Database 11g+\n- MySQL 5.7+ / PostgreSQL 10+\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#22-oracle","title":"2.2 \u6570\u636e\u5e93\u51c6\u5907\uff08Oracle \u6e90\u7aef\uff09","text":"<pre><code>-- \u542f\u7528\u5f52\u6863\u6a21\u5f0f\nSELECT log_mode FROM v$database;\n-- \u5982\u679c\u662f NOARCHIVELOG\uff1a\nSHUTDOWN IMMEDIATE;\nSTARTUP MOUNT;\nALTER DATABASE ARCHIVELOG;\nALTER DATABASE OPEN;\n\n-- \u542f\u7528\u8865\u5145\u65e5\u5fd7\uff08Supplemental Logging\uff09\nALTER DATABASE ADD SUPPLEMENTAL LOG DATA;\n\n-- \u4e3a\u8868\u542f\u7528\u4e3b\u952e\u8865\u5145\u65e5\u5fd7\nALTER TABLE schema_name.table_name ADD SUPPLEMENTAL LOG DATA (PRIMARY KEY) COLUMNS;\n\n-- \u6216\u4e3a\u6574\u4e2a Schema \u542f\u7528\nBEGIN\n  FOR rec IN (SELECT table_name FROM dba_tables WHERE owner = 'APP_SCHEMA') LOOP\n    EXECUTE IMMEDIATE 'ALTER TABLE APP_SCHEMA.' || rec.table_name || ' ADD SUPPLEMENTAL LOG DATA (PRIMARY KEY) COLUMNS';\n  END LOOP;\nEND;\n/\n\n-- \u9a8c\u8bc1\u8865\u5145\u65e5\u5fd7\nSELECT supplemental_log_data_min, supplemental_log_data_pk \nFROM v$database;\n-- \u8f93\u51fa\uff1aYES, YES\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#23-goldengate","title":"2.3 \u521b\u5efa GoldenGate \u7528\u6237","text":"<pre><code>-- \u6e90\u7aef Oracle\nCREATE USER ggadmin IDENTIFIED BY GG123#Admin;\nGRANT CONNECT, RESOURCE TO ggadmin;\nGRANT SELECT ANY DICTIONARY TO ggadmin;\nGRANT SELECT ANY TABLE TO ggadmin;\nGRANT FLASHBACK ANY TABLE TO ggadmin;\nGRANT EXECUTE ON DBMS_FLASHBACK TO ggadmin;\nGRANT UNLIMITED TABLESPACE TO ggadmin;\n\n-- \u6388\u4e88 DBA \u6743\u9650\uff08\u751f\u4ea7\u73af\u5883\u53ef\u7ec6\u5316\uff09\nGRANT DBA TO ggadmin;\n\n-- \u76ee\u6807\u7aef Oracle\nCREATE USER ggadmin IDENTIFIED BY GG123#Admin;\nGRANT CONNECT, RESOURCE, DBA TO ggadmin;\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#3-goldengate","title":"3. GoldenGate \u5b89\u88c5","text":""},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#31","title":"3.1 \u4e0b\u8f7d\u4e0e\u89e3\u538b","text":"<pre><code># \u4e0b\u8f7d Oracle GoldenGate for Oracle\n# https://www.oracle.com/middleware/technologies/goldengate-downloads.html\n\n# \u89e3\u538b\u5230\u5b89\u88c5\u76ee\u5f55\nmkdir -p /u01/ogg\ncd /u01/ogg\nunzip 191004_fbo_ggs_Linux_x64_Oracle_64bit.zip\n\n# \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\ncat &gt;&gt; ~/.bash_profile &lt;&lt;EOF\nexport OGG_HOME=/u01/ogg\nexport PATH=\\$OGG_HOME:\\$PATH\nexport LD_LIBRARY_PATH=\\$ORACLE_HOME/lib:\\$LD_LIBRARY_PATH\nEOF\n\nsource ~/.bash_profile\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#32","title":"3.2 \u521b\u5efa\u5b50\u76ee\u5f55","text":"<pre><code>cd $OGG_HOME\n./ggsci\n\nGGSCI&gt; CREATE SUBDIRS\n\n# \u521b\u5efa\u7684\u76ee\u5f55\uff1a\n# dirprm/  - \u53c2\u6570\u6587\u4ef6\n# dirdat/  - Trail \u6587\u4ef6\n# dirchk/  - Checkpoint \u6587\u4ef6\n# dirtmp/  - \u4e34\u65f6\u6587\u4ef6\n# dirpcs/  - \u8fdb\u7a0b\u72b6\u6001\u6587\u4ef6\n# dirrpt/  - \u62a5\u544a\u6587\u4ef6\n# dirdef/  - \u6570\u636e\u5b9a\u4e49\u6587\u4ef6\n\nGGSCI&gt; EXIT\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#33-manager","title":"3.3 \u914d\u7f6e Manager","text":"<pre><code>cd $OGG_HOME\n./ggsci\n\nGGSCI&gt; EDIT PARAMS MGR\n\n# \u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\nPORT 7809\nDYNAMICPORTLIST 7810-7820\nAUTORESTART EXTRACT *, RETRIES 5, WAITMINUTES 3\nPURGEOLDEXTRACTS ./dirdat/*, USECHECKPOINTS, MINKEEPDAYS 7\nLAGREPORTHOURS 1\nLAGINFOMINUTES 30\nLAGCRITICALMINUTES 45\n\n# \u4fdd\u5b58\u5e76\u9000\u51fa\n\n# \u542f\u52a8 Manager\nGGSCI&gt; START MGR\nGGSCI&gt; INFO MGR\n\n# \u8f93\u51fa\uff1a\n# Manager is running (IP port orcl-source.7809, Process ID 12345).\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#4-extract","title":"4. \u914d\u7f6e Extract\uff08\u6e90\u7aef\uff09","text":""},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#41-trandata","title":"4.1 \u6dfb\u52a0 Trandata","text":"<pre><code>GGSCI&gt; DBLOGIN USERID ggadmin, PASSWORD GG123#Admin\n\n# \u4e3a\u8868\u542f\u7528\u4e8b\u52a1\u6570\u636e\u6355\u83b7\nGGSCI&gt; ADD TRANDATA APP_SCHEMA.ORDERS\nGGSCI&gt; ADD TRANDATA APP_SCHEMA.USERS\nGGSCI&gt; ADD TRANDATA APP_SCHEMA.PRODUCTS\n\n# \u6216\u4e3a\u6574\u4e2a Schema \u542f\u7528\nGGSCI&gt; ADD SCHEMATRANDATA APP_SCHEMA\n\n# \u9a8c\u8bc1\nGGSCI&gt; INFO TRANDATA APP_SCHEMA.ORDERS\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#42-extract","title":"4.2 \u521b\u5efa Extract \u8fdb\u7a0b","text":"<pre><code>GGSCI&gt; ADD EXTRACT ext1, TRANLOG, BEGIN NOW\nGGSCI&gt; ADD EXTTRAIL ./dirdat/lt, EXTRACT ext1\n\n# \u7f16\u8f91 Extract \u53c2\u6570\nGGSCI&gt; EDIT PARAMS ext1\n</code></pre> <pre><code>-- ext1.prm\nEXTRACT ext1\nUSERID ggadmin, PASSWORD GG123#Admin\nEXTTRAIL ./dirdat/lt\nDISCARDFILE ./dirrpt/ext1.dsc, PURGE\nWARNLONGTRANS 2H, CHECKINTERVAL 30M\n\n-- \u6355\u83b7\u7684\u8868\nTABLE APP_SCHEMA.ORDERS;\nTABLE APP_SCHEMA.USERS;\nTABLE APP_SCHEMA.PRODUCTS;\n\n-- \u8fc7\u6ee4\u6761\u4ef6\uff08\u53ef\u9009\uff09\n-- TABLE APP_SCHEMA.ORDERS, WHERE (status = 'ACTIVE');\n\n-- \u5b57\u6bb5\u6620\u5c04\uff08\u53ef\u9009\uff09\n-- TABLE APP_SCHEMA.ORDERS, COLSEXCEPT (internal_notes);\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#43-data-pump","title":"4.3 \u521b\u5efa Data Pump\uff08\u53ef\u9009\uff0c\u7528\u4e8e\u8fdc\u7a0b\u4f20\u8f93\uff09","text":"<pre><code>GGSCI&gt; ADD EXTRACT pump1, EXTTRAILSOURCE ./dirdat/lt\nGGSCI&gt; ADD RMTTRAIL ./dirdat/rt, EXTRACT pump1\n\n# \u7f16\u8f91 Data Pump \u53c2\u6570\nGGSCI&gt; EDIT PARAMS pump1\n</code></pre> <pre><code>-- pump1.prm\nEXTRACT pump1\nUSERID ggadmin, PASSWORD GG123#Admin\nRMTHOST orcl-target, MGRPORT 7809\nRMTTRAIL ./dirdat/rt\nPASSTHRU\n\n-- \u4f20\u8f93\u7684\u8868\nTABLE APP_SCHEMA.*;\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#5-replicat","title":"5. \u914d\u7f6e Replicat\uff08\u76ee\u6807\u7aef\uff09","text":""},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#51-checkpoint","title":"5.1 \u521b\u5efa Checkpoint \u8868","text":"<pre><code># \u5728\u76ee\u6807\u7aef GGSCI\nGGSCI&gt; DBLOGIN USERID ggadmin, PASSWORD GG123#Admin\nGGSCI&gt; ADD CHECKPOINTTABLE ggadmin.checkpoint\n\n# \u9a8c\u8bc1\nSELECT * FROM ggadmin.checkpoint;\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#52-replicat","title":"5.2 \u521b\u5efa Replicat \u8fdb\u7a0b","text":"<pre><code>GGSCI&gt; ADD REPLICAT rep1, EXTTRAIL ./dirdat/rt, CHECKPOINTTABLE ggadmin.checkpoint\n\n# \u7f16\u8f91 Replicat \u53c2\u6570\nGGSCI&gt; EDIT PARAMS rep1\n</code></pre> <pre><code>-- rep1.prm\nREPLICAT rep1\nASSUMETARGETDEFS\nUSERID ggadmin, PASSWORD GG123#Admin\nDISCARDFILE ./dirrpt/rep1.dsc, PURGE\nHANDLECOLLISIONS\n\n-- \u76ee\u6807\u8868\u6620\u5c04\nMAP APP_SCHEMA.ORDERS, TARGET APP_SCHEMA.ORDERS;\nMAP APP_SCHEMA.USERS, TARGET APP_SCHEMA.USERS;\nMAP APP_SCHEMA.PRODUCTS, TARGET APP_SCHEMA.PRODUCTS;\n\n-- \u5b57\u6bb5\u6620\u5c04\uff08\u53ef\u9009\uff09\n-- MAP APP_SCHEMA.ORDERS, TARGET APP_SCHEMA.ORDERS, &amp;\n--   COLMAP (order_id = order_id, &amp;\n--           user_id = user_id, &amp;\n--           amount = amount * 1.1);  -- \u8f6c\u6362\u793a\u4f8b\n\n-- \u8fc7\u6ee4\u6761\u4ef6\uff08\u53ef\u9009\uff09\n-- MAP APP_SCHEMA.ORDERS, TARGET APP_SCHEMA.ORDERS, &amp;\n--   WHERE (status = 'COMPLETED');\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#6","title":"6. \u521d\u59cb\u5316\u6570\u636e\u52a0\u8f7d","text":""},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#61-rman-datapump","title":"6.1 \u4f7f\u7528 RMAN \u6216 DataPump \u521d\u59cb\u5316","text":"<pre><code># \u65b9\u6cd51\uff1a\u4f7f\u7528 DataPump \u5bfc\u51fa/\u5bfc\u5165\n# \u6e90\u7aef\u5bfc\u51fa\nexpdp ggadmin/GG123#Admin@ORCL DIRECTORY=DATA_PUMP_DIR DUMPFILE=init_load.dmp SCHEMAS=APP_SCHEMA\n\n# \u76ee\u6807\u7aef\u5bfc\u5165\nimpdp ggadmin/GG123#Admin@ORCL_TARGET DIRECTORY=DATA_PUMP_DIR DUMPFILE=init_load.dmp SCHEMAS=APP_SCHEMA\n\n# \u65b9\u6cd52\uff1a\u4f7f\u7528 GoldenGate Initial Load\nGGSCI&gt; ADD EXTRACT init1, SOURCEISTABLE\nGGSCI&gt; EDIT PARAMS init1\n</code></pre> <pre><code>-- init1.prm\nEXTRACT init1\nUSERID ggadmin, PASSWORD GG123#Admin\nRMTHOST orcl-target, MGRPORT 7809\nRMTTASK REPLICAT, GROUP rep_init\nTABLE APP_SCHEMA.ORDERS;\nTABLE APP_SCHEMA.USERS;\nTABLE APP_SCHEMA.PRODUCTS;\n</code></pre> <pre><code># \u76ee\u6807\u7aef\u521b\u5efa Initial Load Replicat\nGGSCI&gt; ADD REPLICAT rep_init, SPECIALRUN\nGGSCI&gt; EDIT PARAMS rep_init\n</code></pre> <pre><code>-- rep_init.prm\nREPLICAT rep_init\nASSUMETARGETDEFS\nUSERID ggadmin, PASSWORD GG123#Admin\nMAP APP_SCHEMA.*, TARGET APP_SCHEMA.*;\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#7","title":"7. \u542f\u52a8\u4e0e\u76d1\u63a7","text":""},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#71","title":"7.1 \u542f\u52a8\u8fdb\u7a0b","text":"<pre><code># \u6e90\u7aef\nGGSCI&gt; START EXTRACT ext1\nGGSCI&gt; START EXTRACT pump1\n\n# \u76ee\u6807\u7aef\nGGSCI&gt; START REPLICAT rep1\n\n# \u67e5\u770b\u6240\u6709\u8fdb\u7a0b\u72b6\u6001\nGGSCI&gt; INFO ALL\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\n# Program     Status      Group       Lag at Chkpt  Time Since Chkpt\n# MANAGER     RUNNING\n# EXTRACT     RUNNING     EXT1        00:00:03      00:00:02\n# EXTRACT     RUNNING     PUMP1       00:00:00      00:00:01\n# REPLICAT    RUNNING     REP1        00:00:05      00:00:03\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#72","title":"7.2 \u76d1\u63a7\u5ef6\u8fdf","text":"<pre><code>GGSCI&gt; STATS EXTRACT ext1\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\n# Sending STATS request to EXTRACT EXT1 ...\n# Start of Statistics at 2025-11-11 15:30:00.\n# Output to ./dirdat/lt:\n# Extracting from APP_SCHEMA.ORDERS to APP_SCHEMA.ORDERS:\n# *** Total statistics since 2025-11-11 10:00:00 ***\n#         Total inserts                      12345\n#         Total updates                       6789\n#         Total deletes                        123\n#         Total discards                         0\n#         Total operations                   19257\n\nGGSCI&gt; STATS REPLICAT rep1\n\n# \u67e5\u770b\u8be6\u7ec6\u5ef6\u8fdf\nGGSCI&gt; LAG EXTRACT ext1\nGGSCI&gt; LAG REPLICAT rep1\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#73","title":"7.3 \u67e5\u770b\u62a5\u544a","text":"<pre><code># \u67e5\u770b Extract \u62a5\u544a\nGGSCI&gt; VIEW REPORT ext1\n\n# \u67e5\u770b Replicat \u62a5\u544a\nGGSCI&gt; VIEW REPORT rep1\n\n# \u67e5\u770b\u9519\u8bef\nGGSCI&gt; VIEW GGSEVT\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#8","title":"8. \u9ad8\u7ea7\u914d\u7f6e","text":""},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#81-bidirectional-replication","title":"8.1 \u53cc\u5411\u590d\u5236\uff08Bidirectional Replication\uff09","text":"<pre><code>-- \u7ad9\u70b9A Extract (ext_a)\nEXTRACT ext_a\nUSERID ggadmin, PASSWORD GG123#Admin\nEXTTRAIL ./dirdat/la\nTRANLOGOPTIONS EXCLUDEUSER ggadmin  -- \u6392\u9664 GG \u81ea\u8eab\u7684\u53d8\u66f4\nTABLE APP_SCHEMA.*;\n\n-- \u7ad9\u70b9A Replicat (rep_a)\nREPLICAT rep_a\nUSERID ggadmin, PASSWORD GG123#Admin\nASSUMETARGETDEFS\nMAP APP_SCHEMA.*, TARGET APP_SCHEMA.*;\n\n-- \u7ad9\u70b9B \u914d\u7f6e\u7c7b\u4f3c\uff0c\u6ce8\u610f\uff1a\n-- 1. \u4f7f\u7528\u4e0d\u540c\u7684 GGSCI \u7528\u6237\u6216\u6807\u8bb0\n-- 2. \u542f\u7528\u51b2\u7a81\u68c0\u6d4b\u548c\u89e3\u51b3\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#82","title":"8.2 \u51b2\u7a81\u68c0\u6d4b\u4e0e\u89e3\u51b3","text":"<pre><code>-- rep1.prm\nREPLICAT rep1\nUSERID ggadmin, PASSWORD GG123#Admin\n\n-- \u51b2\u7a81\u5904\u7406\u7b56\u7565\nHANDLECOLLISIONS  -- \u81ea\u52a8\u5904\u7406\u51b2\u7a81\uff08\u8986\u76d6\uff09\n\n-- \u6216\u4f7f\u7528 CDR (Conflict Detection and Resolution)\nMAP APP_SCHEMA.ORDERS, TARGET APP_SCHEMA.ORDERS, &amp;\n  RESOLVECONFLICT (UPDATEROWEXISTS, (DEFAULT, OVERWRITE)), &amp;\n  RESOLVECONFLICT (INSERTROWEXISTS, (DEFAULT, OVERWRITE)), &amp;\n  RESOLVECONFLICT (DELETEROWEXISTS, (DEFAULT, IGNORE));\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#83","title":"8.3 \u6570\u636e\u8f6c\u6362","text":"<pre><code>-- rep1.prm\nREPLICAT rep1\nUSERID ggadmin, PASSWORD GG123#Admin\n\n-- \u5b57\u6bb5\u6620\u5c04\u4e0e\u8f6c\u6362\nMAP APP_SCHEMA.ORDERS, TARGET APP_SCHEMA.ORDERS_NEW, &amp;\n  COLMAP ( &amp;\n    order_id = order_id, &amp;\n    user_id = user_id, &amp;\n    amount_usd = amount * 6.5,  -- \u6c47\u7387\u8f6c\u6362\n    created_date = @STREXT(created_at, 1, 10),  -- \u63d0\u53d6\u65e5\u671f\n    status_code = @IF(status = 'ACTIVE', 1, 0)  -- \u6761\u4ef6\u8f6c\u6362\n  );\n\n-- \u8fc7\u6ee4\u884c\nMAP APP_SCHEMA.ORDERS, TARGET APP_SCHEMA.ORDERS, &amp;\n  WHERE (amount &gt; 100 AND status = 'COMPLETED');\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#84-ddl","title":"8.4 DDL \u590d\u5236","text":"<pre><code># \u6e90\u7aef\u542f\u7528 DDL \u590d\u5236\nGGSCI&gt; DBLOGIN USERID ggadmin, PASSWORD GG123#Admin\nGGSCI&gt; ADD TRANDATA APP_SCHEMA.*, ALLCOLS\n\n# \u7f16\u8f91 Extract \u53c2\u6570\nGGSCI&gt; EDIT PARAMS ext1\n</code></pre> <pre><code>-- ext1.prm\nEXTRACT ext1\nUSERID ggadmin, PASSWORD GG123#Admin\nEXTTRAIL ./dirdat/lt\nDDL INCLUDE MAPPED OBJNAME APP_SCHEMA.*\nTABLE APP_SCHEMA.*;\n</code></pre> <pre><code>-- rep1.prm\nREPLICAT rep1\nUSERID ggadmin, PASSWORD GG123#Admin\nASSUMETARGETDEFS\nDDL INCLUDE MAPPED OBJNAME APP_SCHEMA.*\nMAP APP_SCHEMA.*, TARGET APP_SCHEMA.*;\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#9","title":"9. \u6545\u969c\u5904\u7406","text":""},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#91-extract-abended","title":"9.1 Extract \u8fdb\u7a0b ABENDED","text":"<pre><code># \u67e5\u770b\u9519\u8bef\nGGSCI&gt; VIEW REPORT ext1\n\n# \u5e38\u89c1\u539f\u56e0\uff1a\n# 1. \u5f52\u6863\u65e5\u5fd7\u7f3a\u5931\n# 2. \u8865\u5145\u65e5\u5fd7\u672a\u542f\u7528\n# 3. \u6743\u9650\u4e0d\u8db3\n\n# \u89e3\u51b3\u540e\u91cd\u542f\nGGSCI&gt; START EXTRACT ext1\n\n# \u5982\u679c\u9700\u8981\u4ece\u7279\u5b9a SCN \u5f00\u59cb\nGGSCI&gt; START EXTRACT ext1, ATCSN 12345678\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#92-replicat-abended","title":"9.2 Replicat \u8fdb\u7a0b ABENDED","text":"<pre><code># \u67e5\u770b\u9519\u8bef\nGGSCI&gt; VIEW REPORT rep1\n\n# \u5e38\u89c1\u539f\u56e0\uff1a\n# 1. \u4e3b\u952e\u51b2\u7a81\n# 2. \u76ee\u6807\u8868\u4e0d\u5b58\u5728\n# 3. \u6570\u636e\u7c7b\u578b\u4e0d\u5339\u914d\n\n# \u8df3\u8fc7\u9519\u8bef\u8bb0\u5f55\nGGSCI&gt; ALTER REPLICAT rep1, EXTSEQNO 123, EXTRBA 456789\n\n# \u6216\u542f\u7528 HANDLECOLLISIONS\nGGSCI&gt; EDIT PARAMS rep1\n# \u6dfb\u52a0\uff1aHANDLECOLLISIONS\n\nGGSCI&gt; START REPLICAT rep1\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#93","title":"9.3 \u5ef6\u8fdf\u8fc7\u5927","text":"<pre><code># \u68c0\u67e5\u5ef6\u8fdf\nGGSCI&gt; LAG REPLICAT rep1\n\n# \u539f\u56e0\u5206\u6790\uff1a\n# 1. \u76ee\u6807\u6570\u636e\u5e93\u6027\u80fd\u74f6\u9888\n# 2. \u7f51\u7edc\u5e26\u5bbd\u4e0d\u8db3\n# 3. Replicat \u5355\u7ebf\u7a0b\u5904\u7406\n\n# \u89e3\u51b3\u65b9\u6848\uff1a\n# 1. \u542f\u7528\u5e76\u884c Replicat\nGGSCI&gt; EDIT PARAMS rep1\n# \u6dfb\u52a0\uff1a\n# PARALLELREPLICAT 4\n# MAP APP_SCHEMA.*, TARGET APP_SCHEMA.*, THREAD (1);\n# MAP APP_SCHEMA.*, TARGET APP_SCHEMA.*, THREAD (2);\n# MAP APP_SCHEMA.*, TARGET APP_SCHEMA.*, THREAD (3);\n# MAP APP_SCHEMA.*, TARGET APP_SCHEMA.*, THREAD (4);\n\n# 2. \u4f18\u5316\u76ee\u6807\u6570\u636e\u5e93\u7d22\u5f15\n# 3. \u589e\u52a0\u7f51\u7edc\u5e26\u5bbd\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#94-trail","title":"9.4 Trail \u6587\u4ef6\u6e05\u7406","text":"<pre><code># \u624b\u52a8\u6e05\u7406\nGGSCI&gt; DELETE EXTRACT ext1, EXTTRAIL ./dirdat/lt*\n\n# \u81ea\u52a8\u6e05\u7406\uff08\u5728 MGR \u53c2\u6570\u4e2d\u914d\u7f6e\uff09\nPURGEOLDEXTRACTS ./dirdat/*, USECHECKPOINTS, MINKEEPDAYS 7\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#10","title":"10. \u76d1\u63a7\u811a\u672c","text":"<pre><code>#!/bin/bash\n# check_ogg.sh\n\necho \"=== GoldenGate Status Check ===\"\n\n$OGG_HOME/ggsci &lt;&lt;EOF\nINFO ALL\nLAG EXTRACT ext1\nLAG REPLICAT rep1\nSTATS EXTRACT ext1, TOTAL\nSTATS REPLICAT rep1, TOTAL\nEXIT\nEOF\n\n# \u68c0\u67e5 Manager \u8fdb\u7a0b\nif ps -ef | grep -v grep | grep mgr &gt; /dev/null; then\n    echo \"\u2705 Manager is running\"\nelse\n    echo \"\u274c Manager is NOT running\"\nfi\n\n# \u68c0\u67e5 Trail \u6587\u4ef6\u5927\u5c0f\necho \"Trail file sizes:\"\ndu -sh $OGG_HOME/dirdat/*\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#11","title":"11. \u6027\u80fd\u4f18\u5316","text":""},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#111-extract","title":"11.1 Extract \u4f18\u5316","text":"<pre><code>-- ext1.prm\nEXTRACT ext1\nUSERID ggadmin, PASSWORD GG123#Admin\nEXTTRAIL ./dirdat/lt\n\n-- \u6279\u91cf\u63d0\u4ea4\nGROUPTRANSOPS 10000\n\n-- \u538b\u7f29 Trail \u6587\u4ef6\nCOMPRESSDELETES\nCOMPRESSUPDATES\n\n-- \u5e76\u884c\u8bfb\u53d6\nTRANLOGOPTIONS PARALLELISM 4\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#112-replicat","title":"11.2 Replicat \u4f18\u5316","text":"<pre><code>-- rep1.prm\nREPLICAT rep1\nUSERID ggadmin, PASSWORD GG123#Admin\n\n-- \u6279\u91cf\u5e94\u7528\nBATCHSQL\nBATCHSQL BATCHTRANSOPS 1000\n\n-- \u7981\u7528\u89e6\u53d1\u5668\uff08\u63d0\u9ad8\u6027\u80fd\uff09\nDBOPTIONS SUPPRESSTRIGGERS\n\n-- \u5e76\u884c\u5e94\u7528\nPARALLELREPLICAT 4\n</code></pre>"},{"location":"dba/Oracle-GoldenGate-%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E5%8F%8A%E5%85%A5%E9%97%A8%E6%95%99%E5%AD%A6.html#12_1","title":"12. \u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u76d1\u63a7\u544a\u8b66\uff1a\u5ef6\u8fdf &gt; 5\u5206\u949f\u544a\u8b66</li> <li>\u5b9a\u671f\u6e05\u7406\uff1aTrail \u6587\u4ef6\u4fdd\u75597\u5929</li> <li>\u5907\u4efd\u53c2\u6570\uff1a\u5b9a\u671f\u5907\u4efd dirprm/ \u76ee\u5f55</li> <li>\u6d4b\u8bd5\u9a8c\u8bc1\uff1a\u751f\u4ea7\u90e8\u7f72\u524d\u5728\u6d4b\u8bd5\u73af\u5883\u9a8c\u8bc1</li> <li>\u6587\u6863\u8bb0\u5f55\uff1a\u8bb0\u5f55\u6240\u6709\u914d\u7f6e\u548c\u53d8\u66f4</li> <li>\u6743\u9650\u6700\u5c0f\u5316\uff1a\u751f\u4ea7\u73af\u5883\u7ec6\u5316 GG \u7528\u6237\u6743\u9650</li> <li>\u7f51\u7edc\u4f18\u5316\uff1a\u4f7f\u7528\u4e13\u7528\u7f51\u7edc\uff0c\u907f\u514d\u516c\u7f51\u4f20\u8f93</li> </ol> <p>\u53c2\u8003\u6587\u6863\uff1a - Oracle GoldenGate 19c Documentation - Oracle GoldenGate Best Practices (MOS Doc ID 1321696.1) - Oracle GoldenGate Troubleshooting Guide</p>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html","title":"Oracle GoldenGate \u4e0e MySQL \u6570\u636e\u4ea4\u6362\u65b9\u6848","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aDBA\u3001\u6570\u636e\u5de5\u7a0b\u5e08\u3001\u67b6\u6784\u5e08 \u76ee\u6807\uff1a\u63d0\u4f9b Oracle \u4e0e MySQL \u4e4b\u95f4\u4f7f\u7528 GoldenGate \u8fdb\u884c\u53cc\u5411\u6570\u636e\u540c\u6b65\u7684\u5b8c\u6574\u65b9\u6848\uff0c\u5305\u62ec\u5f02\u6784\u6570\u636e\u5e93\u914d\u7f6e\u3001\u7c7b\u578b\u6620\u5c04\u3001\u51b2\u7a81\u5904\u7406\u3002</p>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#1","title":"1. \u65b9\u6848\u6982\u8ff0","text":""},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#11","title":"1.1 \u5e94\u7528\u573a\u666f","text":"<ul> <li>\u6570\u636e\u5e93\u8fc1\u79fb\uff1aOracle \u2192 MySQL\uff08\u9010\u6b65\u8fc1\u79fb\uff09</li> <li>\u6df7\u5408\u67b6\u6784\uff1a\u6838\u5fc3\u4e1a\u52a1 Oracle\uff0c\u65b0\u4e1a\u52a1 MySQL</li> <li>\u6570\u636e\u96c6\u6210\uff1aOracle \u6570\u636e\u540c\u6b65\u5230 MySQL \u6570\u636e\u4ed3\u5e93</li> <li>\u53cc\u6d3b\u67b6\u6784\uff1aOracle \u2194 MySQL \u53cc\u5411\u540c\u6b65</li> </ul>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#12","title":"1.2 \u67b6\u6784\u56fe","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              Oracle \u6570\u636e\u5e93                       \u2502\n\u2502                                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                \u2502\n\u2502  \u2502 Extract  \u2502\u2500\u2500\u2500\u2500\u2500\u25ba\u2502Data Pump \u2502                \u2502\n\u2502  \u2502 (OGG for \u2502      \u2502          \u2502                \u2502\n\u2502  \u2502  Oracle) \u2502      \u2502          \u2502                \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                \u2502\n\u2502       \u2502                  \u2502                      \u2502\n\u2502       \u25bc                  \u25bc                      \u2502\n\u2502  Local Trail        Remote Trail               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502\n                        \u2502 \u7f51\u7edc\u4f20\u8f93\n                        \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              MySQL \u6570\u636e\u5e93                        \u2502\n\u2502                                                 \u2502\n\u2502       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                              \u2502\n\u2502       \u2502Replicat  \u2502                              \u2502\n\u2502       \u2502 (OGG for \u2502                              \u2502\n\u2502       \u2502  MySQL)  \u2502                              \u2502\n\u2502       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                              \u2502\n\u2502            \u2502                                    \u2502\n\u2502            \u25bc                                    \u2502\n\u2502       \u76ee\u6807\u8868                                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u53cd\u5411\u540c\u6b65\uff08MySQL \u2192 Oracle\uff09\uff1a\n  MySQL Extract \u2192 Oracle Replicat\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#13","title":"1.3 \u6311\u6218\u4e0e\u89e3\u51b3\u65b9\u6848","text":"\u6311\u6218 \u5f71\u54cd \u89e3\u51b3\u65b9\u6848 \u6570\u636e\u7c7b\u578b\u5dee\u5f02 \u6570\u636e\u8f6c\u6362\u9519\u8bef \u7c7b\u578b\u6620\u5c04\u3001COLMAP \u5b57\u7b26\u96c6\u5dee\u5f02 \u4e71\u7801 \u7edf\u4e00\u4f7f\u7528 UTF8 \u5e8f\u5217/\u81ea\u589e\u4e3b\u952e ID \u51b2\u7a81 \u4f7f\u7528 RANGE \u5206\u914d \u4e8b\u52a1\u9694\u79bb\u7ea7\u522b \u6570\u636e\u4e0d\u4e00\u81f4 \u8c03\u6574\u9694\u79bb\u7ea7\u522b DDL \u590d\u5236 Schema \u4e0d\u540c\u6b65 \u624b\u52a8\u540c\u6b65\u6216\u811a\u672c"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#2","title":"2. \u73af\u5883\u51c6\u5907","text":""},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#21","title":"2.1 \u8f6f\u4ef6\u7248\u672c","text":"<pre><code>Oracle \u7aef\uff1a\n- Oracle Database 19c\n- Oracle GoldenGate 19.1 for Oracle\n\nMySQL \u7aef\uff1a\n- MySQL 8.0\n- Oracle GoldenGate 19.1 for MySQL\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#22-oracle","title":"2.2 Oracle \u7aef\u914d\u7f6e","text":"<pre><code>-- \u542f\u7528\u5f52\u6863\u6a21\u5f0f\nALTER DATABASE ARCHIVELOG;\n\n-- \u542f\u7528\u8865\u5145\u65e5\u5fd7\nALTER DATABASE ADD SUPPLEMENTAL LOG DATA;\n\n-- \u4e3a\u8868\u542f\u7528\u4e3b\u952e\u8865\u5145\u65e5\u5fd7\nALTER TABLE app_schema.orders ADD SUPPLEMENTAL LOG DATA (PRIMARY KEY) COLUMNS;\n\n-- \u521b\u5efa GoldenGate \u7528\u6237\nCREATE USER ggadmin IDENTIFIED BY GG123#Admin;\nGRANT CONNECT, RESOURCE, DBA TO ggadmin;\nGRANT SELECT ANY DICTIONARY TO ggadmin;\nGRANT FLASHBACK ANY TABLE TO ggadmin;\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#23-mysql","title":"2.3 MySQL \u7aef\u914d\u7f6e","text":"<pre><code># /etc/my.cnf\n[mysqld]\n# \u542f\u7528 binlog\nserver-id = 1\nlog-bin = mysql-bin\nbinlog-format = ROW\nbinlog-row-image = FULL\n\n# GoldenGate \u9700\u8981\ngtid-mode = ON\nenforce-gtid-consistency = ON\nlog-slave-updates = ON\n\n# \u5b57\u7b26\u96c6\ncharacter-set-server = utf8mb4\ncollation-server = utf8mb4_unicode_ci\n</code></pre> <pre><code>-- \u521b\u5efa GoldenGate \u7528\u6237\nCREATE USER 'ggadmin'@'%' IDENTIFIED BY 'GG123#Admin';\nGRANT ALL PRIVILEGES ON *.* TO 'ggadmin'@'%';\nFLUSH PRIVILEGES;\n\n-- \u521b\u5efa\u76ee\u6807 Schema\nCREATE DATABASE app_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#3-goldengate","title":"3. GoldenGate \u5b89\u88c5","text":""},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#31-oracle","title":"3.1 Oracle \u7aef\u5b89\u88c5","text":"<pre><code># \u4e0b\u8f7d Oracle GoldenGate for Oracle\nmkdir -p /u01/ogg_oracle\ncd /u01/ogg_oracle\nunzip 191004_fbo_ggs_Linux_x64_Oracle_64bit.zip\n\n# \u521b\u5efa\u5b50\u76ee\u5f55\n./ggsci\nGGSCI&gt; CREATE SUBDIRS\nGGSCI&gt; EXIT\n\n# \u914d\u7f6e Manager\nGGSCI&gt; EDIT PARAMS MGR\n</code></pre> <pre><code>PORT 7809\nDYNAMICPORTLIST 7810-7820\nAUTORESTART EXTRACT *, RETRIES 5, WAITMINUTES 3\nPURGEOLDEXTRACTS ./dirdat/*, USECHECKPOINTS, MINKEEPDAYS 7\n</code></pre> <pre><code>GGSCI&gt; START MGR\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#32-mysql","title":"3.2 MySQL \u7aef\u5b89\u88c5","text":"<pre><code># \u4e0b\u8f7d Oracle GoldenGate for MySQL\nmkdir -p /u01/ogg_mysql\ncd /u01/ogg_mysql\nunzip 191004_fbo_ggs_Linux_x64_MySQL_64bit.zip\n\n# \u521b\u5efa\u5b50\u76ee\u5f55\n./ggsci\nGGSCI&gt; CREATE SUBDIRS\nGGSCI&gt; EXIT\n\n# \u914d\u7f6e Manager\nGGSCI&gt; EDIT PARAMS MGR\n</code></pre> <pre><code>PORT 7809\nDYNAMICPORTLIST 7810-7820\nAUTORESTART REPLICAT *, RETRIES 5, WAITMINUTES 3\nPURGEOLDEXTRACTS ./dirdat/*, USECHECKPOINTS, MINKEEPDAYS 7\n</code></pre> <pre><code>GGSCI&gt; START MGR\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#4-oracle-mysql","title":"4. Oracle \u2192 MySQL \u5355\u5411\u540c\u6b65","text":""},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#41","title":"4.1 \u6570\u636e\u7c7b\u578b\u6620\u5c04","text":"Oracle MySQL \u8bf4\u660e NUMBER(p,s) DECIMAL(p,s) \u7cbe\u786e\u6570\u503c NUMBER DECIMAL(65,30) \u65e0\u7cbe\u5ea6 NUMBER VARCHAR2(n) VARCHAR(n) \u53d8\u957f\u5b57\u7b26\u4e32 CHAR(n) CHAR(n) \u5b9a\u957f\u5b57\u7b26\u4e32 DATE DATETIME Oracle DATE \u5305\u542b\u65f6\u95f4 TIMESTAMP DATETIME(6) \u5fae\u79d2\u7cbe\u5ea6 CLOB LONGTEXT \u5927\u6587\u672c BLOB LONGBLOB \u4e8c\u8fdb\u5236 RAW VARBINARY \u4e8c\u8fdb\u5236"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#42-mysql","title":"4.2 \u521b\u5efa\u76ee\u6807\u8868\uff08MySQL\uff09","text":"<pre><code>-- Oracle \u6e90\u8868\nCREATE TABLE app_schema.orders (\n    order_id NUMBER PRIMARY KEY,\n    user_id NUMBER NOT NULL,\n    amount NUMBER(15,2),\n    status VARCHAR2(20),\n    created_at TIMESTAMP DEFAULT SYSTIMESTAMP,\n    updated_at TIMESTAMP\n);\n\n-- MySQL \u76ee\u6807\u8868\nCREATE TABLE app_db.orders (\n    order_id BIGINT PRIMARY KEY,\n    user_id BIGINT NOT NULL,\n    amount DECIMAL(15,2),\n    status VARCHAR(20),\n    created_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6),\n    updated_at DATETIME(6) ON UPDATE CURRENT_TIMESTAMP(6),\n    INDEX idx_user_id (user_id)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#43-oracle-extract","title":"4.3 \u914d\u7f6e Oracle Extract","text":"<pre><code># Oracle \u7aef GGSCI\ncd /u01/ogg_oracle\n./ggsci\n\nGGSCI&gt; DBLOGIN USERID ggadmin, PASSWORD GG123#Admin\nGGSCI&gt; ADD TRANDATA app_schema.orders\n\nGGSCI&gt; ADD EXTRACT ext_ora, TRANLOG, BEGIN NOW\nGGSCI&gt; ADD EXTTRAIL ./dirdat/eo, EXTRACT ext_ora\n\nGGSCI&gt; EDIT PARAMS ext_ora\n</code></pre> <pre><code>-- ext_ora.prm\nEXTRACT ext_ora\nUSERID ggadmin, PASSWORD GG123#Admin\nEXTTRAIL ./dirdat/eo\nDISCARDFILE ./dirrpt/ext_ora.dsc, PURGE\n\nTABLE app_schema.orders;\nTABLE app_schema.users;\nTABLE app_schema.products;\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#44-data-pump","title":"4.4 \u914d\u7f6e Data Pump","text":"<pre><code>GGSCI&gt; ADD EXTRACT pump_ora, EXTTRAILSOURCE ./dirdat/eo\nGGSCI&gt; ADD RMTTRAIL ./dirdat/ro, EXTRACT pump_ora\n\nGGSCI&gt; EDIT PARAMS pump_ora\n</code></pre> <pre><code>-- pump_ora.prm\nEXTRACT pump_ora\nRMTHOST mysql-server, MGRPORT 7809\nRMTTRAIL ./dirdat/ro\nPASSTHRU\n\nTABLE app_schema.*;\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#45-mysql-replicat","title":"4.5 \u914d\u7f6e MySQL Replicat","text":"<pre><code># MySQL \u7aef GGSCI\ncd /u01/ogg_mysql\n./ggsci\n\nGGSCI&gt; DBLOGIN SOURCEDB app_db, USERID ggadmin, PASSWORD GG123#Admin\nGGSCI&gt; ADD CHECKPOINTTABLE ggadmin.checkpoint\n\nGGSCI&gt; ADD REPLICAT rep_mysql, EXTTRAIL ./dirdat/ro, CHECKPOINTTABLE ggadmin.checkpoint\n\nGGSCI&gt; EDIT PARAMS rep_mysql\n</code></pre> <pre><code>-- rep_mysql.prm\nREPLICAT rep_mysql\nTARGETDB app_db, USERID ggadmin, PASSWORD GG123#Admin\nDISCARDFILE ./dirrpt/rep_mysql.dsc, PURGE\nHANDLECOLLISIONS\n\n-- \u7c7b\u578b\u6620\u5c04\nMAP app_schema.orders, TARGET app_db.orders, &amp;\n  COLMAP ( &amp;\n    order_id = order_id, &amp;\n    user_id = user_id, &amp;\n    amount = amount, &amp;\n    status = status, &amp;\n    created_at = created_at, &amp;\n    updated_at = updated_at &amp;\n  );\n\nMAP app_schema.users, TARGET app_db.users;\nMAP app_schema.products, TARGET app_db.products;\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#46","title":"4.6 \u542f\u52a8\u8fdb\u7a0b","text":"<pre><code># Oracle \u7aef\nGGSCI&gt; START EXTRACT ext_ora\nGGSCI&gt; START EXTRACT pump_ora\n\n# MySQL \u7aef\nGGSCI&gt; START REPLICAT rep_mysql\n\n# \u9a8c\u8bc1\nGGSCI&gt; INFO ALL\nGGSCI&gt; STATS EXTRACT ext_ora\nGGSCI&gt; STATS REPLICAT rep_mysql\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#5-mysql-oracle","title":"5. MySQL \u2192 Oracle \u53cd\u5411\u540c\u6b65","text":""},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#51-mysql-extract","title":"5.1 \u914d\u7f6e MySQL Extract","text":"<pre><code># MySQL \u7aef GGSCI\nGGSCI&gt; DBLOGIN SOURCEDB app_db, USERID ggadmin, PASSWORD GG123#Admin\n\nGGSCI&gt; ADD EXTRACT ext_mysql, TRANLOG, BEGIN NOW\nGGSCI&gt; ADD EXTTRAIL ./dirdat/em, EXTRACT ext_mysql\n\nGGSCI&gt; EDIT PARAMS ext_mysql\n</code></pre> <pre><code>-- ext_mysql.prm\nEXTRACT ext_mysql\nSOURCEDB app_db, USERID ggadmin, PASSWORD GG123#Admin\nEXTTRAIL ./dirdat/em\nDISCARDFILE ./dirrpt/ext_mysql.dsc, PURGE\n\n-- \u6392\u9664 GoldenGate \u81ea\u8eab\u7684\u53d8\u66f4\uff08\u907f\u514d\u5faa\u73af\uff09\nTRANLOGOPTIONS EXCLUDEUSER ggadmin\n\nTABLE app_db.orders;\nTABLE app_db.users;\nTABLE app_db.products;\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#52-data-pump","title":"5.2 \u914d\u7f6e Data Pump","text":"<pre><code>GGSCI&gt; ADD EXTRACT pump_mysql, EXTTRAILSOURCE ./dirdat/em\nGGSCI&gt; ADD RMTTRAIL ./dirdat/rm, EXTRACT pump_mysql\n\nGGSCI&gt; EDIT PARAMS pump_mysql\n</code></pre> <pre><code>-- pump_mysql.prm\nEXTRACT pump_mysql\nRMTHOST oracle-server, MGRPORT 7809\nRMTTRAIL ./dirdat/rm\nPASSTHRU\n\nTABLE app_db.*;\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#53-oracle-replicat","title":"5.3 \u914d\u7f6e Oracle Replicat","text":"<pre><code># Oracle \u7aef GGSCI\nGGSCI&gt; DBLOGIN USERID ggadmin, PASSWORD GG123#Admin\nGGSCI&gt; ADD CHECKPOINTTABLE ggadmin.checkpoint\n\nGGSCI&gt; ADD REPLICAT rep_ora, EXTTRAIL ./dirdat/rm, CHECKPOINTTABLE ggadmin.checkpoint\n\nGGSCI&gt; EDIT PARAMS rep_ora\n</code></pre> <pre><code>-- rep_ora.prm\nREPLICAT rep_ora\nUSERID ggadmin, PASSWORD GG123#Admin\nASSUMETARGETDEFS\nDISCARDFILE ./dirrpt/rep_ora.dsc, PURGE\nHANDLECOLLISIONS\n\n-- \u7c7b\u578b\u6620\u5c04\nMAP app_db.orders, TARGET app_schema.orders, &amp;\n  COLMAP ( &amp;\n    order_id = order_id, &amp;\n    user_id = user_id, &amp;\n    amount = amount, &amp;\n    status = status, &amp;\n    created_at = created_at, &amp;\n    updated_at = updated_at &amp;\n  );\n\nMAP app_db.users, TARGET app_schema.users;\nMAP app_db.products, TARGET app_schema.products;\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#6","title":"6. \u53cc\u5411\u540c\u6b65\u914d\u7f6e","text":""},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#61","title":"6.1 \u907f\u514d\u5faa\u73af\u590d\u5236","text":"<pre><code>-- Oracle Extract (ext_ora.prm)\nEXTRACT ext_ora\nUSERID ggadmin, PASSWORD GG123#Admin\nEXTTRAIL ./dirdat/eo\nTRANLOGOPTIONS EXCLUDEUSER ggadmin  -- \u6392\u9664 GG \u7528\u6237\u7684\u53d8\u66f4\nTABLE app_schema.*;\n\n-- MySQL Extract (ext_mysql.prm)\nEXTRACT ext_mysql\nSOURCEDB app_db, USERID ggadmin, PASSWORD GG123#Admin\nEXTTRAIL ./dirdat/em\nTRANLOGOPTIONS EXCLUDEUSER ggadmin  -- \u6392\u9664 GG \u7528\u6237\u7684\u53d8\u66f4\nTABLE app_db.*;\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#62","title":"6.2 \u51b2\u7a81\u68c0\u6d4b\u4e0e\u89e3\u51b3","text":"<pre><code>-- Oracle Replicat (rep_ora.prm)\nREPLICAT rep_ora\nUSERID ggadmin, PASSWORD GG123#Admin\n\n-- \u51b2\u7a81\u5904\u7406\u7b56\u7565\nMAP app_db.orders, TARGET app_schema.orders, &amp;\n  RESOLVECONFLICT (UPDATEROWEXISTS, (DEFAULT, OVERWRITE)), &amp;\n  RESOLVECONFLICT (INSERTROWEXISTS, (DEFAULT, OVERWRITE)), &amp;\n  RESOLVECONFLICT (DELETEROWEXISTS, (DEFAULT, IGNORE));\n\n-- MySQL Replicat (rep_mysql.prm)\nREPLICAT rep_mysql\nTARGETDB app_db, USERID ggadmin, PASSWORD GG123#Admin\n\n-- \u51b2\u7a81\u5904\u7406\u7b56\u7565\nMAP app_schema.orders, TARGET app_db.orders, &amp;\n  RESOLVECONFLICT (UPDATEROWEXISTS, (DEFAULT, OVERWRITE)), &amp;\n  RESOLVECONFLICT (INSERTROWEXISTS, (DEFAULT, OVERWRITE)), &amp;\n  RESOLVECONFLICT (DELETEROWEXISTS, (DEFAULT, IGNORE));\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#63","title":"6.3 \u4e3b\u952e\u8303\u56f4\u5206\u914d\uff08\u907f\u514d\u51b2\u7a81\uff09","text":"<pre><code>-- Oracle \u7aef\uff1a\u4f7f\u7528\u5947\u6570 ID\nCREATE SEQUENCE seq_order_id START WITH 1 INCREMENT BY 2;\n\n-- MySQL \u7aef\uff1a\u4f7f\u7528\u5076\u6570 ID\nALTER TABLE app_db.orders AUTO_INCREMENT = 2;\nSET @@auto_increment_increment = 2;\nSET @@auto_increment_offset = 2;\n\n-- \u6216\u4f7f\u7528 UUID\n-- Oracle\nCREATE TABLE orders (\n    order_id VARCHAR2(36) DEFAULT SYS_GUID() PRIMARY KEY,\n    ...\n);\n\n-- MySQL\nCREATE TABLE orders (\n    order_id CHAR(36) DEFAULT (UUID()) PRIMARY KEY,\n    ...\n);\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#7","title":"7. \u6570\u636e\u8f6c\u6362","text":""},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#71","title":"7.1 \u65e5\u671f\u683c\u5f0f\u8f6c\u6362","text":"<pre><code>-- Oracle \u2192 MySQL (rep_mysql.prm)\nMAP app_schema.orders, TARGET app_db.orders, &amp;\n  COLMAP ( &amp;\n    order_id = order_id, &amp;\n    created_at = @STREXT(created_at, 1, 19)  -- \u622a\u53d6\u5230\u79d2\n  );\n\n-- MySQL \u2192 Oracle (rep_ora.prm)\nMAP app_db.orders, TARGET app_schema.orders, &amp;\n  COLMAP ( &amp;\n    order_id = order_id, &amp;\n    created_at = @DATE(\"YYYY-MM-DD HH24:MI:SS\", created_at)\n  );\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#72","title":"7.2 \u5b57\u7b26\u96c6\u8f6c\u6362","text":"<pre><code>-- rep_mysql.prm\nREPLICAT rep_mysql\nTARGETDB app_db, USERID ggadmin, PASSWORD GG123#Admin\nCHARSET UTF8 TO UTF8\n\nMAP app_schema.*, TARGET app_db.*;\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#73","title":"7.3 \u5b57\u6bb5\u6620\u5c04\u4e0e\u8ba1\u7b97","text":"<pre><code>-- rep_mysql.prm\nMAP app_schema.orders, TARGET app_db.orders, &amp;\n  COLMAP ( &amp;\n    order_id = order_id, &amp;\n    user_id = user_id, &amp;\n    amount_usd = amount,  -- \u539f\u59cb\u91d1\u989d\n    amount_cny = amount * 6.5,  -- \u6c47\u7387\u8f6c\u6362\n    status_code = @IF(status = 'ACTIVE', 1, 0),  -- \u72b6\u6001\u8f6c\u6362\n    full_name = @STRCAT(first_name, ' ', last_name)  -- \u5b57\u7b26\u4e32\u62fc\u63a5\n  );\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#8","title":"8. \u521d\u59cb\u5316\u6570\u636e\u52a0\u8f7d","text":""},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#81-datapump","title":"8.1 \u4f7f\u7528 DataPump \u521d\u59cb\u5316","text":"<pre><code># Oracle \u5bfc\u51fa\nexpdp ggadmin/GG123#Admin@ORCL DIRECTORY=DATA_PUMP_DIR DUMPFILE=init_load.dmp SCHEMAS=app_schema\n\n# \u8f6c\u6362\u4e3a MySQL \u683c\u5f0f\uff08\u624b\u52a8\u6216\u4f7f\u7528\u5de5\u5177\uff09\n# \u7136\u540e\u5bfc\u5165 MySQL\nmysql -uggadmin -pGG123#Admin app_db &lt; init_load.sql\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#82-goldengate-initial-load","title":"8.2 \u4f7f\u7528 GoldenGate Initial Load","text":"<pre><code># Oracle \u7aef\nGGSCI&gt; ADD EXTRACT init_ora, SOURCEISTABLE\nGGSCI&gt; EDIT PARAMS init_ora\n</code></pre> <pre><code>-- init_ora.prm\nEXTRACT init_ora\nUSERID ggadmin, PASSWORD GG123#Admin\nRMTHOST mysql-server, MGRPORT 7809\nRMTTASK REPLICAT, GROUP rep_init\nTABLE app_schema.orders;\nTABLE app_schema.users;\nTABLE app_schema.products;\n</code></pre> <pre><code># MySQL \u7aef\nGGSCI&gt; ADD REPLICAT rep_init, SPECIALRUN\nGGSCI&gt; EDIT PARAMS rep_init\n</code></pre> <pre><code>-- rep_init.prm\nREPLICAT rep_init\nTARGETDB app_db, USERID ggadmin, PASSWORD GG123#Admin\nMAP app_schema.*, TARGET app_db.*;\n</code></pre> <pre><code># \u542f\u52a8\u521d\u59cb\u5316\u52a0\u8f7d\nGGSCI&gt; START EXTRACT init_ora\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#9","title":"9. \u76d1\u63a7\u4e0e\u6545\u969c\u5904\u7406","text":""},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#91","title":"9.1 \u76d1\u63a7\u5ef6\u8fdf","text":"<pre><code># Oracle \u7aef\nGGSCI&gt; LAG EXTRACT ext_ora\nGGSCI&gt; STATS EXTRACT ext_ora, TOTAL\n\n# MySQL \u7aef\nGGSCI&gt; LAG REPLICAT rep_mysql\nGGSCI&gt; STATS REPLICAT rep_mysql, TOTAL\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#92","title":"9.2 \u5e38\u89c1\u9519\u8bef\u5904\u7406","text":"<pre><code>\u9519\u8bef1\uff1a\u6570\u636e\u7c7b\u578b\u4e0d\u5339\u914d\n  \u9519\u8bef\u4fe1\u606f\uff1aOGG-00664 OCI Error converting column\n  \u89e3\u51b3\u65b9\u6848\uff1a\u4f7f\u7528 COLMAP \u663e\u5f0f\u8f6c\u6362\u7c7b\u578b\n\n\u9519\u8bef2\uff1a\u4e3b\u952e\u51b2\u7a81\n  \u9519\u8bef\u4fe1\u606f\uff1aOGG-00663 OCI Error: Unique constraint violated\n  \u89e3\u51b3\u65b9\u6848\uff1a\u542f\u7528 HANDLECOLLISIONS \u6216\u4f7f\u7528 RESOLVECONFLICT\n\n\u9519\u8bef3\uff1a\u5b57\u7b26\u96c6\u4e71\u7801\n  \u9519\u8bef\u4fe1\u606f\uff1aInvalid character\n  \u89e3\u51b3\u65b9\u6848\uff1a\u7edf\u4e00\u4f7f\u7528 UTF8\uff0c\u914d\u7f6e CHARSET \u53c2\u6570\n\n\u9519\u8bef4\uff1a\u5927\u5b57\u6bb5\u622a\u65ad\n  \u9519\u8bef\u4fe1\u606f\uff1aOGG-01163 Bad column length\n  \u89e3\u51b3\u65b9\u6848\uff1a\u8c03\u6574\u76ee\u6807\u8868\u5b57\u6bb5\u957f\u5ea6\u6216\u4f7f\u7528 LOBMEMORY\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#93","title":"9.3 \u67e5\u770b\u9519\u8bef\u65e5\u5fd7","text":"<pre><code># Oracle \u7aef\nGGSCI&gt; VIEW REPORT ext_ora\nGGSCI&gt; VIEW GGSEVT\n\n# MySQL \u7aef\nGGSCI&gt; VIEW REPORT rep_mysql\ntail -f /u01/ogg_mysql/ggserr.log\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#10","title":"10. \u6027\u80fd\u4f18\u5316","text":""},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#101-mysql-replicat","title":"10.1 \u6279\u91cf\u5e94\u7528\uff08MySQL Replicat\uff09","text":"<pre><code>-- rep_mysql.prm\nREPLICAT rep_mysql\nTARGETDB app_db, USERID ggadmin, PASSWORD GG123#Admin\n\n-- \u6279\u91cf\u5e94\u7528\nBATCHSQL\nBATCHSQL BATCHTRANSOPS 1000\nBATCHSQL BATCHSIZE 1000000\n\n-- \u7981\u7528\u5916\u952e\u68c0\u67e5\uff08\u63d0\u9ad8\u6027\u80fd\uff09\nDBOPTIONS DEFERREFCONST\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#102","title":"10.2 \u5e76\u884c\u590d\u5236","text":"<pre><code>-- rep_mysql.prm\nREPLICAT rep_mysql\nTARGETDB app_db, USERID ggadmin, PASSWORD GG123#Admin\n\n-- \u5e76\u884c\u5e94\u7528\uff08\u6309\u8868\u5206\u7ec4\uff09\nPARALLELREPLICAT 4\nMAP app_schema.orders, TARGET app_db.orders, THREAD (1);\nMAP app_schema.users, TARGET app_db.users, THREAD (2);\nMAP app_schema.products, TARGET app_db.products, THREAD (3);\nMAP app_schema.logs, TARGET app_db.logs, THREAD (4);\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#103","title":"10.3 \u538b\u7f29\u4f20\u8f93","text":"<pre><code>-- pump_ora.prm\nEXTRACT pump_ora\nRMTHOST mysql-server, MGRPORT 7809\nRMTTRAIL ./dirdat/ro\nPASSTHRU\n\n-- \u542f\u7528\u538b\u7f29\nCOMPRESSDELETES\nCOMPRESSUPDATES\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#11_1","title":"11. \u76d1\u63a7\u811a\u672c","text":"<pre><code>#!/bin/bash\n# check_ogg_heterogeneous.sh\n\necho \"=== Oracle \u2192 MySQL Sync Status ===\"\n\n# Oracle \u7aef\necho \"Oracle Extract:\"\n/u01/ogg_oracle/ggsci &lt;&lt;EOF\nINFO EXTRACT ext_ora\nLAG EXTRACT ext_ora\nSTATS EXTRACT ext_ora, TOTAL\nEXIT\nEOF\n\n# MySQL \u7aef\necho \"MySQL Replicat:\"\n/u01/ogg_mysql/ggsci &lt;&lt;EOF\nINFO REPLICAT rep_mysql\nLAG REPLICAT rep_mysql\nSTATS REPLICAT rep_mysql, TOTAL\nEXIT\nEOF\n\necho \"=== MySQL \u2192 Oracle Sync Status ===\"\n\n# MySQL \u7aef\necho \"MySQL Extract:\"\n/u01/ogg_mysql/ggsci &lt;&lt;EOF\nINFO EXTRACT ext_mysql\nLAG EXTRACT ext_mysql\nEXIT\nEOF\n\n# Oracle \u7aef\necho \"Oracle Replicat:\"\n/u01/ogg_oracle/ggsci &lt;&lt;EOF\nINFO REPLICAT rep_ora\nLAG REPLICAT rep_ora\nEXIT\nEOF\n</code></pre>"},{"location":"dba/Oracle-GoldenGate%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E6%96%B9%E6%A1%88.html#12_1","title":"12. \u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u7c7b\u578b\u6620\u5c04\uff1a\u660e\u786e\u5b9a\u4e49\u6240\u6709\u5b57\u6bb5\u7684\u7c7b\u578b\u6620\u5c04</li> <li>\u5b57\u7b26\u96c6\u7edf\u4e00\uff1a\u4f7f\u7528 UTF8/UTF8MB4</li> <li>\u4e3b\u952e\u7b56\u7565\uff1a\u53cc\u5411\u540c\u6b65\u65f6\u4f7f\u7528\u8303\u56f4\u5206\u914d\u6216 UUID</li> <li>\u51b2\u7a81\u5904\u7406\uff1a\u5b9a\u4e49\u660e\u786e\u7684\u51b2\u7a81\u89e3\u51b3\u7b56\u7565</li> <li>\u76d1\u63a7\u544a\u8b66\uff1a\u5ef6\u8fdf &gt; 5\u5206\u949f\u544a\u8b66</li> <li>\u6d4b\u8bd5\u9a8c\u8bc1\uff1a\u751f\u4ea7\u90e8\u7f72\u524d\u5145\u5206\u6d4b\u8bd5</li> <li>\u6587\u6863\u8bb0\u5f55\uff1a\u8bb0\u5f55\u6240\u6709\u6620\u5c04\u89c4\u5219\u548c\u914d\u7f6e</li> </ol> <p>\u53c2\u8003\u6587\u6863\uff1a - Oracle GoldenGate for Heterogeneous Databases - Oracle GoldenGate for MySQL Documentation - Oracle to MySQL Migration Guide</p>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html","title":"Oracle RAC \u96c6\u7fa4\u90e8\u7f72\u4e0e\u8c03\u4f18\u65b9\u6848","text":"<p>\u9002\u7528\u8bfb\u8005\uff1a\u4e2d\u9ad8\u7ea7 DBA\u3001\u67b6\u6784\u5e08\u3001\u8fd0\u7ef4\u5de5\u7a0b\u5e08 \u76ee\u6807\uff1a\u63d0\u4f9b Oracle RAC\uff08Real Application Clusters\uff09\u4ece\u89c4\u5212\u3001\u90e8\u7f72\u5230\u6027\u80fd\u8c03\u4f18\u7684\u5b8c\u6574\u65b9\u6848\uff0c\u9002\u7528\u4e8e\u9ad8\u53ef\u7528\u751f\u4ea7\u73af\u5883\u3002</p>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#1-rac","title":"1. RAC \u67b6\u6784\u6982\u8ff0","text":""},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#11","title":"1.1 \u6838\u5fc3\u7ec4\u4ef6","text":"<ul> <li>Clusterware (Grid Infrastructure)\uff1a\u96c6\u7fa4\u7ba1\u7406\u8f6f\u4ef6\uff0c\u8d1f\u8d23\u8282\u70b9\u7ba1\u7406\u3001\u8d44\u6e90\u8c03\u5ea6\u3001\u6545\u969c\u5207\u6362</li> <li>ASM (Automatic Storage Management)\uff1a\u5171\u4eab\u5b58\u50a8\u7ba1\u7406\uff0c\u63d0\u4f9b\u6570\u636e\u6587\u4ef6\u3001\u63a7\u5236\u6587\u4ef6\u3001\u65e5\u5fd7\u6587\u4ef6\u7684\u96c6\u7fa4\u6587\u4ef6\u7cfb\u7edf</li> <li>Cache Fusion\uff1a\u8282\u70b9\u95f4\u5185\u5b58\u6570\u636e\u5757\u4f20\u8f93\u673a\u5236\uff0c\u901a\u8fc7\u79c1\u7f51\uff08Interconnect\uff09\u5b9e\u73b0</li> <li>Voting Disk &amp; OCR\uff1a\u6295\u7968\u78c1\u76d8\uff08\u4ef2\u88c1\uff09\u548c\u96c6\u7fa4\u914d\u7f6e\u4ed3\u5e93</li> </ul>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#12","title":"1.2 \u7f51\u7edc\u67b6\u6784","text":"<ul> <li>Public Network\uff1a\u5ba2\u6237\u7aef\u8fde\u63a5\uff0cSCAN\uff08Single Client Access Name\uff09\u63d0\u4f9b\u8d1f\u8f7d\u5747\u8861</li> <li>Private Network (Interconnect)\uff1a\u8282\u70b9\u95f4\u5fc3\u8df3\u3001Cache Fusion \u6570\u636e\u4f20\u8f93\uff0c\u5efa\u8bae 10GbE \u6216\u66f4\u9ad8</li> <li>IPMI/iLO Network\uff1a\u5e26\u5916\u7ba1\u7406\u7f51\u7edc\uff08\u53ef\u9009\uff09</li> </ul>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#2","title":"2. \u90e8\u7f72\u524d\u89c4\u5212","text":""},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#21","title":"2.1 \u786c\u4ef6\u4e0e\u5b58\u50a8","text":"<pre><code>\u6700\u4f4e\u914d\u7f6e\uff082\u8282\u70b9\uff09\uff1a\n- CPU: 8\u6838 x 2\u8282\u70b9\n- \u5185\u5b58: 32GB x 2\u8282\u70b9\n- \u5b58\u50a8: \u5171\u4eab\u5b58\u50a8\uff08SAN/NAS/iSCSI\uff09\uff0c\u81f3\u5c11 500GB\n- \u7f51\u7edc: \u53cc\u7f51\u5361\uff08Public + Private\uff09\uff0c\u5efa\u8bae\u5197\u4f59\n\n\u63a8\u8350\u914d\u7f6e\uff08\u751f\u4ea7\u73af\u5883\uff09\uff1a\n- CPU: 16\u6838+ x 2-4\u8282\u70b9\n- \u5185\u5b58: 64GB+ x \u8282\u70b9\u6570\n- \u5b58\u50a8: \u5149\u7ea4 SAN \u6216 NVMe \u5171\u4eab\u5b58\u50a8\uff0cRAID10\n- \u7f51\u7edc: \u53cc 10GbE \u79c1\u7f51\uff08\u7ed1\u5b9a\uff09\uff0c\u53cc 1GbE \u516c\u7f51\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#22","title":"2.2 \u64cd\u4f5c\u7cfb\u7edf\u4e0e\u5185\u6838\u53c2\u6570","text":"<pre><code># RHEL/OL 7.x/8.x\uff0c\u5173\u95ed\u9632\u706b\u5899\u6216\u914d\u7f6e\u89c4\u5219\nsystemctl stop firewalld\nsystemctl disable firewalld\n\n# \u5185\u6838\u53c2\u6570 /etc/sysctl.conf\nkernel.shmmax = 68719476736\nkernel.shmall = 16777216\nkernel.shmmni = 4096\nkernel.sem = 250 32000 100 128\nfs.file-max = 6815744\nnet.ipv4.ip_local_port_range = 9000 65500\nnet.core.rmem_default = 262144\nnet.core.rmem_max = 4194304\nnet.core.wmem_default = 262144\nnet.core.wmem_max = 1048576\n\n# \u5e94\u7528\u53c2\u6570\nsysctl -p\n\n# \u7528\u6237\u9650\u5236 /etc/security/limits.conf\noracle soft nproc 2047\noracle hard nproc 16384\noracle soft nofile 1024\noracle hard nofile 65536\noracle soft stack 10240\noracle hard stack 32768\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#23","title":"2.3 \u5171\u4eab\u5b58\u50a8\u914d\u7f6e","text":"<ul> <li>ASM \u78c1\u76d8\u7ec4\uff1a</li> <li><code>+DATA</code>\uff1a\u6570\u636e\u6587\u4ef6\u3001\u63a7\u5236\u6587\u4ef6\uff08Normal/High Redundancy\uff09</li> <li><code>+FRA</code>\uff1a\u95ea\u56de\u533a\u3001\u5f52\u6863\u65e5\u5fd7\uff08Normal Redundancy\uff09</li> <li> <p><code>+OCR</code>\uff1aOCR \u548c Voting Disk\uff08High Redundancy\uff0c\u81f3\u5c113\u4e2a\u78c1\u76d8\uff09</p> </li> <li> <p>\u591a\u8def\u5f84\u914d\u7f6e\uff08multipath\uff09\uff1a</p> </li> </ul> <pre><code># /etc/multipath.conf \u793a\u4f8b\ndefaults {\n    user_friendly_names yes\n    path_grouping_policy multibus\n    failback immediate\n}\nmultipaths {\n    multipath {\n        wwid 3600508b1001c1234567890abcdef\n        alias asm_data01\n    }\n}\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#3-grid-infrastructure","title":"3. Grid Infrastructure \u5b89\u88c5","text":""},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#31","title":"3.1 \u5b89\u88c5\u524d\u68c0\u67e5","text":"<pre><code># \u5728\u6240\u6709\u8282\u70b9\u6267\u884c\n# 1. \u4e3b\u673a\u540d\u89e3\u6790\uff08/etc/hosts\uff09\n192.168.1.101 rac1.example.com rac1\n192.168.1.102 rac2.example.com rac2\n192.168.1.103 rac1-priv.example.com rac1-priv\n192.168.1.104 rac2-priv.example.com rac2-priv\n192.168.1.105 rac1-vip.example.com rac1-vip\n192.168.1.106 rac2-vip.example.com rac2-vip\n192.168.1.110 rac-scan.example.com rac-scan\n\n# 2. SSH \u4e92\u4fe1\uff08grid \u548c oracle \u7528\u6237\uff09\nsu - grid\nssh-keygen -t rsa\nssh-copy-id rac2\n\n# 3. \u65f6\u949f\u540c\u6b65\uff08\u6240\u6709\u8282\u70b9\uff09\nsystemctl enable chronyd\nsystemctl start chronyd\nchronyc sources\n\n# 4. ASM \u78c1\u76d8\u6743\u9650\nchown grid:asmadmin /dev/mapper/asm_*\nchmod 660 /dev/mapper/asm_*\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#32-grid-infrastructure","title":"3.2 \u9759\u9ed8\u5b89\u88c5 Grid Infrastructure","text":"<pre><code># \u5728\u7b2c\u4e00\u4e2a\u8282\u70b9\u6267\u884c\ncd /u01/app/19.3.0/grid\n./gridSetup.sh -silent -responseFile /tmp/grid_install.rsp\n\n# grid_install.rsp \u5173\u952e\u53c2\u6570\noracle.install.option=CRS_CONFIG\nINVENTORY_LOCATION=/u01/app/oraInventory\noracle.install.asm.OSDBA=asmdba\noracle.install.asm.OSOPER=asmoper\noracle.install.asm.OSASM=asmadmin\noracle.install.crs.config.ClusterConfiguration=STANDALONE\noracle.install.crs.config.configureAsExtendedCluster=false\noracle.install.crs.config.clusterName=rac-cluster\noracle.install.crs.config.gpnp.scanName=rac-scan.example.com\noracle.install.crs.config.gpnp.scanPort=1521\noracle.install.crs.config.ClusterConfiguration=STANDALONE\noracle.install.crs.config.configureGNS=false\noracle.install.crs.config.autoConfigureClusterNodeVIP=false\noracle.install.crs.config.clusterNodes=rac1:rac1-vip,rac2:rac2-vip\noracle.install.crs.config.networkInterfaceList=eth0:192.168.1.0:1,eth1:192.168.2.0:5\noracle.install.asm.configureGIMRDataDG=false\noracle.install.asm.storageOption=ASM\noracle.install.asmOnNAS.configureGIMRDataDG=false\noracle.install.asm.SYSASMPassword=Oracle123#\noracle.install.asm.diskGroup.name=OCR\noracle.install.asm.diskGroup.redundancy=EXTERNAL\noracle.install.asm.diskGroup.disks=/dev/mapper/asm_ocr01,/dev/mapper/asm_ocr02,/dev/mapper/asm_ocr03\noracle.install.asm.diskGroup.diskDiscoveryString=/dev/mapper/asm_*\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#33-grid-infrastructure","title":"3.3 \u9a8c\u8bc1 Grid Infrastructure","text":"<pre><code># \u68c0\u67e5\u96c6\u7fa4\u72b6\u6001\ncrsctl check cluster -all\ncrsctl stat res -t\n\n# \u68c0\u67e5 ASM \u5b9e\u4f8b\nsrvctl status asm\nasmcmd lsdg\n\n# \u68c0\u67e5 SCAN \u76d1\u542c\nsrvctl status scan\nsrvctl status scan_listener\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#4-oracle-database-rac","title":"4. Oracle Database \u5b89\u88c5\uff08RAC\uff09","text":""},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#41","title":"4.1 \u5b89\u88c5\u6570\u636e\u5e93\u8f6f\u4ef6","text":"<pre><code># \u5728\u7b2c\u4e00\u4e2a\u8282\u70b9\u6267\u884c\ncd /u01/app/oracle/product/19.3.0/dbhome_1\n./runInstaller -silent -responseFile /tmp/db_install.rsp\n\n# db_install.rsp \u5173\u952e\u53c2\u6570\noracle.install.option=INSTALL_DB_SWONLY\nUNIX_GROUP_NAME=oinstall\nINVENTORY_LOCATION=/u01/app/oraInventory\nORACLE_HOME=/u01/app/oracle/product/19.3.0/dbhome_1\nORACLE_BASE=/u01/app/oracle\noracle.install.db.InstallEdition=EE\noracle.install.db.OSDBA_GROUP=dba\noracle.install.db.OSOPER_GROUP=oper\noracle.install.db.OSBACKUPDBA_GROUP=backupdba\noracle.install.db.OSDGDBA_GROUP=dgdba\noracle.install.db.OSKMDBA_GROUP=kmdba\noracle.install.db.OSRACDBA_GROUP=racdba\noracle.install.db.CLUSTER_NODES=rac1,rac2\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#42-rac","title":"4.2 \u521b\u5efa RAC \u6570\u636e\u5e93","text":"<pre><code># \u4f7f\u7528 DBCA \u521b\u5efa RAC \u6570\u636e\u5e93\ndbca -silent -createDatabase \\\n  -templateName General_Purpose.dbc \\\n  -gdbname racdb -sid racdb \\\n  -responseFile NO_VALUE \\\n  -characterSet AL32UTF8 \\\n  -sysPassword Oracle123# \\\n  -systemPassword Oracle123# \\\n  -createAsContainerDatabase true \\\n  -numberOfPDBs 1 \\\n  -pdbName pdb1 \\\n  -pdbAdminPassword Oracle123# \\\n  -storageType ASM \\\n  -diskGroupName +DATA \\\n  -recoveryGroupName +FRA \\\n  -redoLogFileSize 1024 \\\n  -emConfiguration NONE \\\n  -nodelist rac1,rac2 \\\n  -memoryMgmtType AUTO_SGA \\\n  -totalMemory 16384\n\n# \u9a8c\u8bc1\u6570\u636e\u5e93\nsrvctl status database -d racdb\nsrvctl config database -d racdb\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#5-rac","title":"5. RAC \u6027\u80fd\u8c03\u4f18","text":""},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#51-interconnect","title":"5.1 Interconnect \u4f18\u5316","text":"<pre><code>-- \u68c0\u67e5 Interconnect \u4f7f\u7528\u60c5\u51b5\nSELECT inst_id, name, value \nFROM gv$parameter \nWHERE name = 'cluster_interconnects';\n\n-- \u68c0\u67e5 Cache Fusion \u7edf\u8ba1\nSELECT * FROM gv$cr_block_server;\nSELECT * FROM gv$current_block_server;\n\n-- \u68c0\u67e5\u5168\u5c40\u7f13\u5b58\u4f20\u8f93\u5ef6\u8fdf\nSELECT \n    inst_id,\n    event,\n    total_waits,\n    time_waited,\n    average_wait\nFROM gv$system_event\nWHERE event LIKE 'gc%'\nORDER BY time_waited DESC;\n</code></pre> <p>\u4f18\u5316\u5efa\u8bae\uff1a - \u4f7f\u7528\u4e07\u5146\u6216\u66f4\u9ad8\u901f\u7f51\u7edc\u4f5c\u4e3a Interconnect - \u542f\u7528 Jumbo Frames\uff08MTU 9000\uff09 - \u7ed1\u5b9a\u591a\u4e2a\u7f51\u5361\uff08bonding mode 4 - LACP\uff09 - \u9694\u79bb Interconnect \u6d41\u91cf\u5230\u4e13\u7528 VLAN</p>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#52","title":"5.2 \u5e8f\u5217\u53f7\u7f13\u5b58\u4f18\u5316","text":"<pre><code>-- RAC \u73af\u5883\u4e0b\u5e8f\u5217\u53f7\u7ade\u4e89\u662f\u5e38\u89c1\u95ee\u9898\n-- \u589e\u52a0\u5e8f\u5217\u7f13\u5b58\u5927\u5c0f\nALTER SEQUENCE order_seq CACHE 1000;\n\n-- \u6216\u4f7f\u7528 NOORDER \u9009\u9879\uff08\u5982\u679c\u4e0d\u9700\u8981\u4e25\u683c\u987a\u5e8f\uff09\nCREATE SEQUENCE order_seq \n    START WITH 1 \n    INCREMENT BY 1 \n    CACHE 1000 \n    NOORDER;\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#53-gcsges","title":"5.3 GCS/GES \u8d44\u6e90\u8c03\u4f18","text":"<pre><code>-- \u68c0\u67e5 GCS \u8d44\u6e90\nSELECT * FROM gv$ges_resource WHERE resource_name LIKE '%YOUR_TABLE%';\n\n-- \u68c0\u67e5 GCS \u9501\u7b49\u5f85\nSELECT \n    inst_id,\n    sid,\n    event,\n    p1text,\n    p1,\n    p2text,\n    p2,\n    wait_time,\n    seconds_in_wait\nFROM gv$session_wait\nWHERE event LIKE 'gc%'\nORDER BY seconds_in_wait DESC;\n\n-- \u8c03\u6574 _gc_policy_time\uff08\u8c28\u614e\u4f7f\u7528\uff09\nALTER SYSTEM SET \"_gc_policy_time\"=0 SCOPE=SPFILE SID='*';\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#54-awr-rac","title":"5.4 AWR \u62a5\u544a\u5206\u6790\uff08RAC\uff09","text":"<pre><code>-- \u751f\u6210 RAC AWR \u62a5\u544a\n@?/rdbms/admin/awrgrpt.sql\n\n-- \u5173\u6ce8\u6307\u6807\uff1a\n-- 1. Global Cache CR/Current Blocks Received\n-- 2. GC Block Lost/Corrupt\n-- 3. Interconnect Ping Time\n-- 4. Cluster Wait Time\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#6","title":"6. \u9ad8\u53ef\u7528\u4e0e\u6545\u969c\u5207\u6362","text":""},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#61","title":"6.1 \u670d\u52a1\u914d\u7f6e\uff08\u8d1f\u8f7d\u5747\u8861\uff09","text":"<pre><code># \u521b\u5efa\u670d\u52a1\nsrvctl add service -d racdb -s app_service \\\n  -preferred racdb1,racdb2 \\\n  -available racdb3 \\\n  -pdb pdb1 \\\n  -policy AUTOMATIC \\\n  -failovertype AUTO \\\n  -failovermethod BASIC \\\n  -notification TRUE \\\n  -clbgoal SHORT \\\n  -rlbgoal THROUGHPUT\n\n# \u542f\u52a8\u670d\u52a1\nsrvctl start service -d racdb -s app_service\n\n# \u68c0\u67e5\u670d\u52a1\u72b6\u6001\nsrvctl status service -d racdb -s app_service\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#62-taftransparent-application-failover","title":"6.2 TAF\uff08Transparent Application Failover\uff09\u914d\u7f6e","text":"<pre><code># tnsnames.ora \u914d\u7f6e\nRACDB_TAF = \n  (DESCRIPTION =\n    (ADDRESS = (PROTOCOL = TCP)(HOST = rac-scan)(PORT = 1521))\n    (CONNECT_DATA =\n      (SERVER = DEDICATED)\n      (SERVICE_NAME = app_service)\n      (FAILOVER_MODE =\n        (TYPE = SELECT)\n        (METHOD = BASIC)\n        (RETRIES = 180)\n        (DELAY = 5)\n      )\n    )\n  )\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#63-fast-application-notification-fan","title":"6.3 Fast Application Notification (FAN)","text":"<pre><code>-- \u542f\u7528 FAN\nALTER SYSTEM SET event='10046 trace name context forever, level 12' SCOPE=SPFILE SID='*';\n\n-- \u5e94\u7528\u7aef\u914d\u7f6e\uff08JDBC\uff09\njdbc:oracle:thin:@(DESCRIPTION=\n  (ADDRESS=(PROTOCOL=TCP)(HOST=rac-scan)(PORT=1521))\n  (CONNECT_DATA=(SERVICE_NAME=app_service))\n  (ENABLE=BROKEN)\n  (FAST_CONNECTION_FAILOVER=TRUE)\n)\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#7","title":"7. \u65e5\u5e38\u7ef4\u62a4","text":""},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#71","title":"7.1 \u8282\u70b9\u7ba1\u7406","text":"<pre><code># \u505c\u6b62\u8282\u70b9\nsrvctl stop instance -d racdb -i racdb2\n\n# \u542f\u52a8\u8282\u70b9\nsrvctl start instance -d racdb -i racdb2\n\n# \u91cd\u5b9a\u4f4d\u670d\u52a1\nsrvctl relocate service -d racdb -s app_service -oldinst racdb1 -newinst racdb2\n\n# \u68c0\u67e5\u96c6\u7fa4\u5065\u5eb7\ncluvfy comp healthcheck -collect cluster -bestpractice\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#72-opatch","title":"7.2 \u8865\u4e01\u7ba1\u7406\uff08OPatch\uff09","text":"<pre><code># \u68c0\u67e5\u8865\u4e01\nopatchauto apply /u01/patches/34786990 -oh /u01/app/19.3.0/grid\n\n# \u56de\u6eda\u8865\u4e01\nopatchauto rollback /u01/patches/34786990 -oh /u01/app/19.3.0/grid\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#73","title":"7.3 \u5907\u4efd\u7b56\u7565","text":"<pre><code># RMAN \u5907\u4efd\uff08RAC\uff09\nrman target /\nCONFIGURE DEVICE TYPE DISK PARALLELISM 4;\nCONFIGURE CONTROLFILE AUTOBACKUP ON;\nCONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '+FRA/%F';\n\nBACKUP AS COMPRESSED BACKUPSET DATABASE PLUS ARCHIVELOG;\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#8","title":"8. \u6545\u969c\u6392\u67e5","text":""},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#81","title":"8.1 \u5e38\u89c1\u95ee\u9898","text":"\u95ee\u9898 \u6392\u67e5\u547d\u4ee4 \u89e3\u51b3\u65b9\u6848 \u8282\u70b9\u9a71\u9010 <code>crsctl check cluster -all</code> \u68c0\u67e5\u7f51\u7edc\u3001\u5b58\u50a8\u3001\u65e5\u5fd7 SCAN \u76d1\u542c\u5f02\u5e38 <code>srvctl status scan_listener</code> \u91cd\u542f SCAN \u76d1\u542c ASM \u78c1\u76d8\u7ec4\u65e0\u6cd5\u6302\u8f7d <code>asmcmd lsdg</code> \u68c0\u67e5\u78c1\u76d8\u6743\u9650\u3001\u591a\u8def\u5f84 Cache Fusion \u6162 <code>SELECT * FROM gv$system_event WHERE event LIKE 'gc%'</code> \u4f18\u5316 Interconnect"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#82","title":"8.2 \u65e5\u5fd7\u4f4d\u7f6e","text":"<pre><code># Grid Infrastructure \u65e5\u5fd7\n$GRID_HOME/log/&lt;hostname&gt;/alert&lt;hostname&gt;.log\n$GRID_HOME/log/&lt;hostname&gt;/crsd/crsd.log\n\n# \u6570\u636e\u5e93\u544a\u8b66\u65e5\u5fd7\n$ORACLE_BASE/diag/rdbms/racdb/racdb1/trace/alert_racdb1.log\n\n# ASM \u65e5\u5fd7\n$ORACLE_BASE/diag/asm/+asm/+ASM1/trace/alert_+ASM1.log\n</code></pre>"},{"location":"dba/Oracle-RAC-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E4%BC%98%E6%96%B9%E6%A1%88.html#9","title":"9. \u6700\u4f73\u5b9e\u8df5\u603b\u7ed3","text":"<ol> <li>\u7f51\u7edc\u9694\u79bb\uff1aPublic\u3001Private\u3001IPMI \u4e09\u7f51\u5206\u79bb</li> <li>\u5b58\u50a8\u5197\u4f59\uff1aOCR/Voting Disk \u4f7f\u7528 High Redundancy\uff0c\u6570\u636e\u4f7f\u7528 Normal Redundancy</li> <li>\u670d\u52a1\u8bbe\u8ba1\uff1a\u6309\u4e1a\u52a1\u6a21\u5757\u62c6\u5206\u670d\u52a1\uff0c\u914d\u7f6e TAF/FAN</li> <li>\u76d1\u63a7\u544a\u8b66\uff1a\u76d1\u63a7 GCS/GES \u7b49\u5f85\u3001Interconnect \u5ef6\u8fdf\u3001\u8282\u70b9\u5065\u5eb7</li> <li>\u5b9a\u671f\u6f14\u7ec3\uff1a\u6545\u969c\u5207\u6362\u3001\u8282\u70b9\u9a71\u9010\u3001\u8865\u4e01\u5347\u7ea7</li> <li>\u5bb9\u91cf\u89c4\u5212\uff1a\u9884\u7559 30% CPU/\u5185\u5b58/\u5b58\u50a8\u4f59\u91cf\uff0c\u652f\u6301\u8282\u70b9\u6545\u969c\u540e\u7684\u8d1f\u8f7d</li> </ol> <p>\u53c2\u8003\u6587\u6863\uff1a - Oracle RAC 19c Administration and Deployment Guide - MOS Note: 1587357.1 (RAC Best Practices) - Oracle Clusterware Administration Guide</p>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html","title":"Oracle RMAN \u589e\u91cf\u5907\u4efd\u65b9\u6848","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aOracle DBA\u3001\u8fd0\u7ef4\u5de5\u7a0b\u5e08 \u76ee\u6807\uff1a\u63d0\u4f9b Oracle RMAN \u589e\u91cf\u5907\u4efd\u7684\u5b8c\u6574\u65b9\u6848\uff0c\u5305\u62ec\u5907\u4efd\u7b56\u7565\u3001\u6062\u590d\u6f14\u7ec3\u3001\u6027\u80fd\u4f18\u5316\u4e0e\u81ea\u52a8\u5316\u811a\u672c\u3002</p>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#1-rman","title":"1. RMAN \u5907\u4efd\u6982\u8ff0","text":""},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#11","title":"1.1 \u5907\u4efd\u7c7b\u578b","text":"\u5907\u4efd\u7c7b\u578b \u8bf4\u660e \u5907\u4efd\u5185\u5bb9 \u6062\u590d\u901f\u5ea6 \u5b58\u50a8\u7a7a\u95f4 \u5b8c\u5168\u5907\u4efd (Full) \u5907\u4efd\u6240\u6709\u6570\u636e\u5757 \u6240\u6709\u5df2\u4f7f\u7528\u7684\u6570\u636e\u5757 \u5feb \u5927 \u589e\u91cf\u5907\u4efd Level 0 \u7b49\u540c\u4e8e\u5b8c\u5168\u5907\u4efd \u6240\u6709\u5df2\u4f7f\u7528\u7684\u6570\u636e\u5757 \u5feb \u5927 \u589e\u91cf\u5907\u4efd Level 1 \u5dee\u5f02 \u5907\u4efd\u81ea\u4e0a\u6b21 Level 0 \u540e\u7684\u53d8\u66f4 \u53d8\u66f4\u7684\u6570\u636e\u5757 \u4e2d \u4e2d \u589e\u91cf\u5907\u4efd Level 1 \u7d2f\u79ef \u5907\u4efd\u81ea\u4e0a\u6b21 Level 0 \u540e\u7684\u6240\u6709\u53d8\u66f4 \u6240\u6709\u53d8\u66f4\u7684\u6570\u636e\u5757 \u4e2d \u4e2d \u5f52\u6863\u65e5\u5fd7\u5907\u4efd \u5907\u4efd\u5f52\u6863\u65e5\u5fd7 \u5f52\u6863\u65e5\u5fd7\u6587\u4ef6 - \u5c0f"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#12","title":"1.2 \u5907\u4efd\u7b56\u7565\u5bf9\u6bd4","text":"\u7b56\u7565 \u5907\u4efd\u9891\u7387 \u6062\u590d\u65f6\u95f4 \u5b58\u50a8\u9700\u6c42 \u9002\u7528\u573a\u666f \u6bcf\u65e5\u5b8c\u5168\u5907\u4efd \u6bcf\u5929 \u6700\u5feb \u6700\u5927 \u5c0f\u578b\u6570\u636e\u5e93\uff08&lt; 100GB\uff09 \u5468\u5b8c\u5168 + \u65e5\u589e\u91cf \u5468\u65e5 Level 0\uff0c\u5468\u4e00\u81f3\u5468\u516d Level 1 \u4e2d \u4e2d \u4e2d\u578b\u6570\u636e\u5e93\uff08100GB-1TB\uff09 \u6708\u5b8c\u5168 + \u5468\u7d2f\u79ef + \u65e5\u5dee\u5f02 \u6708\u521d Level 0\uff0c\u6bcf\u5468\u7d2f\u79ef\uff0c\u6bcf\u65e5\u5dee\u5f02 \u6162 \u5c0f \u5927\u578b\u6570\u636e\u5e93\uff08&gt; 1TB\uff09"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#13","title":"1.3 \u63a8\u8350\u7b56\u7565\uff08\u5468\u5b8c\u5168 + \u65e5\u589e\u91cf\u5dee\u5f02\uff09","text":"<pre><code>\u5468\u65e5\uff1aLevel 0 \u589e\u91cf\u5907\u4efd\uff08\u5b8c\u5168\u5907\u4efd\uff09\n\u5468\u4e00\uff1aLevel 1 \u5dee\u5f02\u589e\u91cf\u5907\u4efd\uff08\u81ea\u5468\u65e5\u4ee5\u6765\u7684\u53d8\u66f4\uff09\n\u5468\u4e8c\uff1aLevel 1 \u5dee\u5f02\u589e\u91cf\u5907\u4efd\uff08\u81ea\u5468\u4e00\u4ee5\u6765\u7684\u53d8\u66f4\uff09\n\u5468\u4e09\uff1aLevel 1 \u5dee\u5f02\u589e\u91cf\u5907\u4efd\uff08\u81ea\u5468\u4e8c\u4ee5\u6765\u7684\u53d8\u66f4\uff09\n\u5468\u56db\uff1aLevel 1 \u5dee\u5f02\u589e\u91cf\u5907\u4efd\uff08\u81ea\u5468\u4e09\u4ee5\u6765\u7684\u53d8\u66f4\uff09\n\u5468\u4e94\uff1aLevel 1 \u5dee\u5f02\u589e\u91cf\u5907\u4efd\uff08\u81ea\u5468\u56db\u4ee5\u6765\u7684\u53d8\u66f4\uff09\n\u5468\u516d\uff1aLevel 1 \u5dee\u5f02\u589e\u91cf\u5907\u4efd\uff08\u81ea\u5468\u4e94\u4ee5\u6765\u7684\u53d8\u66f4\uff09\n\n\u6bcf\u5929\uff1a\u5f52\u6863\u65e5\u5fd7\u5907\u4efd\uff08\u6bcf\u5c0f\u65f6\u6216\u5b9e\u65f6\uff09\n\n\u6062\u590d\u573a\u666f\uff1a\n- \u5468\u4e09\u6545\u969c\uff1a\u6062\u590d Level 0\uff08\u5468\u65e5\uff09+ Level 1\uff08\u5468\u4e00\uff09+ Level 1\uff08\u5468\u4e8c\uff09+ \u5f52\u6863\u65e5\u5fd7\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#2-rman","title":"2. RMAN \u914d\u7f6e","text":""},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#21-rman","title":"2.1 \u8fde\u63a5 RMAN","text":"<pre><code># \u672c\u5730\u8fde\u63a5\nrman target /\n\n# \u8fdc\u7a0b\u8fde\u63a5\nrman target sys/Oracle123#@ORCL\n\n# \u8fde\u63a5\u5230 Catalog\uff08\u53ef\u9009\uff09\nrman target sys/Oracle123#@ORCL catalog rman/Rman123#@RMANCAT\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#22-rman","title":"2.2 \u914d\u7f6e RMAN \u53c2\u6570","text":"<pre><code>-- \u67e5\u770b\u5f53\u524d\u914d\u7f6e\nSHOW ALL;\n\n-- \u914d\u7f6e\u5907\u4efd\u4fdd\u7559\u7b56\u7565\uff08\u4fdd\u75597\u5929\uff09\nCONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 7 DAYS;\n\n-- \u914d\u7f6e\u9ed8\u8ba4\u8bbe\u5907\u7c7b\u578b\uff08\u78c1\u76d8\uff09\nCONFIGURE DEFAULT DEVICE TYPE TO DISK;\n\n-- \u914d\u7f6e\u5907\u4efd\u8def\u5f84\nCONFIGURE CHANNEL DEVICE TYPE DISK FORMAT '/u01/backup/rman/%U';\n\n-- \u914d\u7f6e\u5e76\u884c\u5ea6\uff084\u4e2a\u901a\u9053\uff09\nCONFIGURE DEVICE TYPE DISK PARALLELISM 4;\n\n-- \u914d\u7f6e\u81ea\u52a8\u5907\u4efd\u63a7\u5236\u6587\u4ef6\nCONFIGURE CONTROLFILE AUTOBACKUP ON;\nCONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '/u01/backup/rman/ctl_%F';\n\n-- \u914d\u7f6e\u5907\u4efd\u4f18\u5316\uff08\u8df3\u8fc7\u672a\u53d8\u66f4\u7684\u53ea\u8bfb\u6587\u4ef6\uff09\nCONFIGURE BACKUP OPTIMIZATION ON;\n\n-- \u914d\u7f6e\u538b\u7f29\uff08\u8282\u7701\u7a7a\u95f4\uff09\nCONFIGURE COMPRESSION ALGORITHM 'MEDIUM';\n\n-- \u914d\u7f6e\u5f52\u6863\u65e5\u5fd7\u5220\u9664\u7b56\u7565\nCONFIGURE ARCHIVELOG DELETION POLICY TO BACKED UP 1 TIMES TO DISK;\n\n-- \u914d\u7f6e\u5feb\u7167\u63a7\u5236\u6587\u4ef6\u4f4d\u7f6e\nCONFIGURE SNAPSHOT CONTROLFILE NAME TO '/u01/backup/rman/snapcf_ORCL.f';\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#3","title":"3. \u5907\u4efd\u811a\u672c","text":""},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#31-level-0","title":"3.1 Level 0 \u589e\u91cf\u5907\u4efd\uff08\u5468\u65e5\uff09","text":"<pre><code>#!/bin/bash\n# rman_level0_backup.sh\n\nexport ORACLE_SID=ORCL\nexport ORACLE_HOME=/u01/app/oracle/product/19.3.0/dbhome_1\nexport PATH=$ORACLE_HOME/bin:$PATH\n\nBACKUP_DIR=/u01/backup/rman\nLOG_DIR=/u01/backup/logs\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p $BACKUP_DIR\nmkdir -p $LOG_DIR\n\nrman target / &lt;&lt;EOF &gt; $LOG_DIR/level0_backup_$DATE.log\nRUN {\n  ALLOCATE CHANNEL ch1 DEVICE TYPE DISK FORMAT '$BACKUP_DIR/level0_%U';\n  ALLOCATE CHANNEL ch2 DEVICE TYPE DISK FORMAT '$BACKUP_DIR/level0_%U';\n  ALLOCATE CHANNEL ch3 DEVICE TYPE DISK FORMAT '$BACKUP_DIR/level0_%U';\n  ALLOCATE CHANNEL ch4 DEVICE TYPE DISK FORMAT '$BACKUP_DIR/level0_%U';\n\n  BACKUP INCREMENTAL LEVEL 0 \n    DATABASE \n    TAG 'LEVEL0_BACKUP'\n    PLUS ARCHIVELOG DELETE INPUT;\n\n  BACKUP CURRENT CONTROLFILE FORMAT '$BACKUP_DIR/ctl_level0_%U';\n\n  RELEASE CHANNEL ch1;\n  RELEASE CHANNEL ch2;\n  RELEASE CHANNEL ch3;\n  RELEASE CHANNEL ch4;\n}\n\nDELETE NOPROMPT OBSOLETE;\nDELETE NOPROMPT EXPIRED BACKUP;\n\nCROSSCHECK BACKUP;\nCROSSCHECK ARCHIVELOG ALL;\n\nEXIT;\nEOF\n\n# \u68c0\u67e5\u5907\u4efd\u662f\u5426\u6210\u529f\nif [ $? -eq 0 ]; then\n    echo \"Level 0 backup completed successfully at $DATE\" | mail -s \"RMAN Level 0 Backup Success\" dba@example.com\nelse\n    echo \"Level 0 backup failed at $DATE\" | mail -s \"RMAN Level 0 Backup FAILED\" dba@example.com\nfi\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#32-level-1","title":"3.2 Level 1 \u5dee\u5f02\u589e\u91cf\u5907\u4efd\uff08\u5468\u4e00\u81f3\u5468\u516d\uff09","text":"<pre><code>#!/bin/bash\n# rman_level1_backup.sh\n\nexport ORACLE_SID=ORCL\nexport ORACLE_HOME=/u01/app/oracle/product/19.3.0/dbhome_1\nexport PATH=$ORACLE_HOME/bin:$PATH\n\nBACKUP_DIR=/u01/backup/rman\nLOG_DIR=/u01/backup/logs\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p $BACKUP_DIR\nmkdir -p $LOG_DIR\n\nrman target / &lt;&lt;EOF &gt; $LOG_DIR/level1_backup_$DATE.log\nRUN {\n  ALLOCATE CHANNEL ch1 DEVICE TYPE DISK FORMAT '$BACKUP_DIR/level1_%U';\n  ALLOCATE CHANNEL ch2 DEVICE TYPE DISK FORMAT '$BACKUP_DIR/level1_%U';\n  ALLOCATE CHANNEL ch3 DEVICE TYPE DISK FORMAT '$BACKUP_DIR/level1_%U';\n  ALLOCATE CHANNEL ch4 DEVICE TYPE DISK FORMAT '$BACKUP_DIR/level1_%U';\n\n  BACKUP INCREMENTAL LEVEL 1 \n    DATABASE \n    TAG 'LEVEL1_DIFFERENTIAL'\n    PLUS ARCHIVELOG DELETE INPUT;\n\n  BACKUP CURRENT CONTROLFILE FORMAT '$BACKUP_DIR/ctl_level1_%U';\n\n  RELEASE CHANNEL ch1;\n  RELEASE CHANNEL ch2;\n  RELEASE CHANNEL ch3;\n  RELEASE CHANNEL ch4;\n}\n\nDELETE NOPROMPT OBSOLETE;\nDELETE NOPROMPT EXPIRED BACKUP;\n\nCROSSCHECK BACKUP;\nCROSSCHECK ARCHIVELOG ALL;\n\nEXIT;\nEOF\n\n# \u68c0\u67e5\u5907\u4efd\u662f\u5426\u6210\u529f\nif [ $? -eq 0 ]; then\n    echo \"Level 1 backup completed successfully at $DATE\" | mail -s \"RMAN Level 1 Backup Success\" dba@example.com\nelse\n    echo \"Level 1 backup failed at $DATE\" | mail -s \"RMAN Level 1 Backup FAILED\" dba@example.com\nfi\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#33","title":"3.3 \u5f52\u6863\u65e5\u5fd7\u5907\u4efd\uff08\u6bcf\u5c0f\u65f6\uff09","text":"<pre><code>#!/bin/bash\n# rman_archivelog_backup.sh\n\nexport ORACLE_SID=ORCL\nexport ORACLE_HOME=/u01/app/oracle/product/19.3.0/dbhome_1\nexport PATH=$ORACLE_HOME/bin:$PATH\n\nBACKUP_DIR=/u01/backup/rman\nLOG_DIR=/u01/backup/logs\nDATE=$(date +%Y%m%d_%H%M%S)\n\nrman target / &lt;&lt;EOF &gt; $LOG_DIR/archivelog_backup_$DATE.log\nRUN {\n  ALLOCATE CHANNEL ch1 DEVICE TYPE DISK FORMAT '$BACKUP_DIR/arch_%U';\n\n  BACKUP ARCHIVELOG ALL DELETE INPUT;\n\n  RELEASE CHANNEL ch1;\n}\n\nDELETE NOPROMPT OBSOLETE;\nCROSSCHECK ARCHIVELOG ALL;\n\nEXIT;\nEOF\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#4-crontab","title":"4. Crontab \u5b9a\u65f6\u4efb\u52a1","text":"<pre><code># \u7f16\u8f91 crontab\ncrontab -e\n\n# \u6dfb\u52a0\u5b9a\u65f6\u4efb\u52a1\n# \u5468\u65e5\u51cc\u66682\u70b9\uff1aLevel 0 \u5907\u4efd\n0 2 * * 0 /u01/scripts/rman_level0_backup.sh\n\n# \u5468\u4e00\u81f3\u5468\u516d\u51cc\u66682\u70b9\uff1aLevel 1 \u5907\u4efd\n0 2 * * 1-6 /u01/scripts/rman_level1_backup.sh\n\n# \u6bcf\u5c0f\u65f6\uff1a\u5f52\u6863\u65e5\u5fd7\u5907\u4efd\n0 * * * * /u01/scripts/rman_archivelog_backup.sh\n\n# \u6bcf\u5929\u51cc\u66684\u70b9\uff1a\u6e05\u7406\u8fc7\u671f\u5907\u4efd\n0 4 * * * /u01/scripts/rman_cleanup.sh\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#5","title":"5. \u6062\u590d\u64cd\u4f5c","text":""},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#51","title":"5.1 \u5b8c\u5168\u6062\u590d\uff08\u6570\u636e\u5e93\u5b8c\u6574\uff09","text":"<pre><code># \u573a\u666f\uff1a\u6570\u636e\u6587\u4ef6\u635f\u574f\uff0c\u4f46\u63a7\u5236\u6587\u4ef6\u548c\u5f52\u6863\u65e5\u5fd7\u5b8c\u6574\n\nrman target /\n\n# \u5173\u95ed\u6570\u636e\u5e93\nSHUTDOWN IMMEDIATE;\n\n# \u542f\u52a8\u5230 MOUNT \u72b6\u6001\nSTARTUP MOUNT;\n\n# \u6062\u590d\u6570\u636e\u5e93\nRESTORE DATABASE;\nRECOVER DATABASE;\n\n# \u6253\u5f00\u6570\u636e\u5e93\nALTER DATABASE OPEN;\n\nEXIT;\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#52","title":"5.2 \u4e0d\u5b8c\u5168\u6062\u590d\uff08\u6062\u590d\u5230\u6307\u5b9a\u65f6\u95f4\u70b9\uff09","text":"<pre><code># \u573a\u666f\uff1a\u8bef\u5220\u9664\u6570\u636e\uff0c\u9700\u8981\u6062\u590d\u5230\u5220\u9664\u524d\u7684\u65f6\u95f4\u70b9\n\nrman target /\n\nSHUTDOWN IMMEDIATE;\nSTARTUP MOUNT;\n\n# \u6062\u590d\u5230\u6307\u5b9a\u65f6\u95f4\u70b9\nRUN {\n  SET UNTIL TIME \"TO_DATE('2025-11-11 14:30:00', 'YYYY-MM-DD HH24:MI:SS')\";\n  RESTORE DATABASE;\n  RECOVER DATABASE;\n}\n\n# \u4ee5 RESETLOGS \u65b9\u5f0f\u6253\u5f00\u6570\u636e\u5e93\nALTER DATABASE OPEN RESETLOGS;\n\nEXIT;\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#53","title":"5.3 \u6062\u590d\u5355\u4e2a\u8868\u7a7a\u95f4","text":"<pre><code>rman target /\n\n# \u8868\u7a7a\u95f4\u79bb\u7ebf\nSQL \"ALTER TABLESPACE users OFFLINE IMMEDIATE\";\n\n# \u6062\u590d\u8868\u7a7a\u95f4\nRESTORE TABLESPACE users;\nRECOVER TABLESPACE users;\n\n# \u8868\u7a7a\u95f4\u4e0a\u7ebf\nSQL \"ALTER TABLESPACE users ONLINE\";\n\nEXIT;\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#54","title":"5.4 \u6062\u590d\u5355\u4e2a\u6570\u636e\u6587\u4ef6","text":"<pre><code>rman target /\n\n# \u6570\u636e\u6587\u4ef6\u79bb\u7ebf\nSQL \"ALTER DATABASE DATAFILE 4 OFFLINE\";\n\n# \u6062\u590d\u6570\u636e\u6587\u4ef6\nRESTORE DATAFILE 4;\nRECOVER DATAFILE 4;\n\n# \u6570\u636e\u6587\u4ef6\u4e0a\u7ebf\nSQL \"ALTER DATABASE DATAFILE 4 ONLINE\";\n\nEXIT;\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#55","title":"5.5 \u6062\u590d\u63a7\u5236\u6587\u4ef6","text":"<pre><code># \u573a\u666f\uff1a\u6240\u6709\u63a7\u5236\u6587\u4ef6\u4e22\u5931\n\nrman target /\n\n# \u542f\u52a8\u5230 NOMOUNT \u72b6\u6001\nSTARTUP NOMOUNT;\n\n# \u6062\u590d\u63a7\u5236\u6587\u4ef6\uff08\u4ece\u81ea\u52a8\u5907\u4efd\uff09\nRESTORE CONTROLFILE FROM AUTOBACKUP;\n\n# \u6216\u4ece\u6307\u5b9a\u5907\u4efd\n# RESTORE CONTROLFILE FROM '/u01/backup/rman/ctl_c-123456789-20251111-00';\n\n# \u6302\u8f7d\u6570\u636e\u5e93\nALTER DATABASE MOUNT;\n\n# \u6062\u590d\u6570\u636e\u5e93\nRESTORE DATABASE;\nRECOVER DATABASE;\n\n# \u6253\u5f00\u6570\u636e\u5e93\nALTER DATABASE OPEN RESETLOGS;\n\nEXIT;\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#6","title":"6. \u9a8c\u8bc1\u4e0e\u6d4b\u8bd5","text":""},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#61","title":"6.1 \u9a8c\u8bc1\u5907\u4efd","text":"<pre><code>rman target /\n\n# \u9a8c\u8bc1\u6240\u6709\u5907\u4efd\nVALIDATE BACKUPSET ALL;\n\n# \u9a8c\u8bc1\u6570\u636e\u5e93\nVALIDATE DATABASE;\n\n# \u9a8c\u8bc1\u7279\u5b9a\u5907\u4efd\u96c6\nVALIDATE BACKUPSET 123;\n\n# \u68c0\u67e5\u5907\u4efd\u662f\u5426\u53ef\u6062\u590d\nRESTORE DATABASE VALIDATE;\n\nEXIT;\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#62","title":"6.2 \u5217\u51fa\u5907\u4efd","text":"<pre><code>rman target /\n\n# \u5217\u51fa\u6240\u6709\u5907\u4efd\nLIST BACKUP SUMMARY;\n\n# \u5217\u51fa\u6570\u636e\u5e93\u5907\u4efd\nLIST BACKUP OF DATABASE;\n\n# \u5217\u51fa\u5f52\u6863\u65e5\u5fd7\u5907\u4efd\nLIST BACKUP OF ARCHIVELOG ALL;\n\n# \u5217\u51fa\u63a7\u5236\u6587\u4ef6\u5907\u4efd\nLIST BACKUP OF CONTROLFILE;\n\n# \u5217\u51fa\u8fc7\u671f\u5907\u4efd\nLIST EXPIRED BACKUP;\n\n# \u5217\u51fa\u8fc7\u65f6\u5907\u4efd\nLIST OBSOLETE;\n\nEXIT;\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#63","title":"6.3 \u67e5\u770b\u5907\u4efd\u8be6\u60c5","text":"<pre><code>rman target /\n\n# \u67e5\u770b\u5907\u4efd\u96c6\u8be6\u60c5\nLIST BACKUPSET 123;\n\n# \u67e5\u770b\u5907\u4efd\u7247\u8be6\u60c5\nLIST BACKUPPIECE '/u01/backup/rman/level0_abc123';\n\n# \u67e5\u770b\u5907\u4efd\u62a5\u544a\nREPORT SCHEMA;\nREPORT NEED BACKUP;\nREPORT OBSOLETE;\n\nEXIT;\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#7","title":"7. \u6027\u80fd\u4f18\u5316","text":""},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#71","title":"7.1 \u5e76\u884c\u5907\u4efd","text":"<pre><code>-- \u914d\u7f6e\u5e76\u884c\u5ea6\nCONFIGURE DEVICE TYPE DISK PARALLELISM 8;\n\n-- \u6216\u5728\u5907\u4efd\u65f6\u6307\u5b9a\nRUN {\n  ALLOCATE CHANNEL ch1 DEVICE TYPE DISK;\n  ALLOCATE CHANNEL ch2 DEVICE TYPE DISK;\n  ALLOCATE CHANNEL ch3 DEVICE TYPE DISK;\n  ALLOCATE CHANNEL ch4 DEVICE TYPE DISK;\n\n  BACKUP INCREMENTAL LEVEL 0 DATABASE;\n\n  RELEASE CHANNEL ch1;\n  RELEASE CHANNEL ch2;\n  RELEASE CHANNEL ch3;\n  RELEASE CHANNEL ch4;\n}\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#72","title":"7.2 \u538b\u7f29\u5907\u4efd","text":"<pre><code>-- \u914d\u7f6e\u538b\u7f29\u7b97\u6cd5\nCONFIGURE COMPRESSION ALGORITHM 'MEDIUM';  -- LOW/MEDIUM/HIGH\n\n-- \u6216\u5728\u5907\u4efd\u65f6\u6307\u5b9a\nBACKUP AS COMPRESSED BACKUPSET \n  INCREMENTAL LEVEL 0 \n  DATABASE;\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#73","title":"7.3 \u5907\u4efd\u4f18\u5316","text":"<pre><code>-- \u542f\u7528\u5907\u4efd\u4f18\u5316\uff08\u8df3\u8fc7\u672a\u53d8\u66f4\u7684\u53ea\u8bfb\u6587\u4ef6\uff09\nCONFIGURE BACKUP OPTIMIZATION ON;\n\n-- \u4f7f\u7528\u5757\u53d8\u66f4\u8ddf\u8e2a\uff08Block Change Tracking\uff09\n-- \u5927\u5e45\u63d0\u5347\u589e\u91cf\u5907\u4efd\u901f\u5ea6\n\n-- \u542f\u7528 BCT\nALTER DATABASE ENABLE BLOCK CHANGE TRACKING \n  USING FILE '/u01/oradata/ORCL/block_change_tracking.f';\n\n-- \u9a8c\u8bc1 BCT \u72b6\u6001\nSELECT status, filename FROM v$block_change_tracking;\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#74","title":"7.4 \u5907\u4efd\u5230\u591a\u4e2a\u76ee\u6807","text":"<pre><code>RUN {\n  ALLOCATE CHANNEL ch1 DEVICE TYPE DISK FORMAT '/backup1/rman/%U';\n  ALLOCATE CHANNEL ch2 DEVICE TYPE DISK FORMAT '/backup2/rman/%U';\n\n  BACKUP INCREMENTAL LEVEL 0 DATABASE;\n\n  RELEASE CHANNEL ch1;\n  RELEASE CHANNEL ch2;\n}\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#8","title":"8. \u5907\u4efd\u5230\u78c1\u5e26\uff08\u53ef\u9009\uff09","text":""},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#81","title":"8.1 \u914d\u7f6e\u78c1\u5e26\u8bbe\u5907","text":"<pre><code>-- \u914d\u7f6e SBT\uff08System Backup to Tape\uff09\nCONFIGURE DEFAULT DEVICE TYPE TO SBT;\n\n-- \u914d\u7f6e SBT \u901a\u9053\nCONFIGURE CHANNEL DEVICE TYPE SBT PARMS 'SBT_LIBRARY=/opt/omni/lib/libob2oracle8_64bit.so';\n\n-- \u914d\u7f6e\u5e76\u884c\u5ea6\nCONFIGURE DEVICE TYPE SBT PARALLELISM 2;\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#82","title":"8.2 \u5907\u4efd\u5230\u78c1\u5e26","text":"<pre><code>RUN {\n  ALLOCATE CHANNEL ch1 DEVICE TYPE SBT;\n  ALLOCATE CHANNEL ch2 DEVICE TYPE SBT;\n\n  BACKUP INCREMENTAL LEVEL 0 DATABASE;\n\n  RELEASE CHANNEL ch1;\n  RELEASE CHANNEL ch2;\n}\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#9","title":"9. \u76d1\u63a7\u4e0e\u544a\u8b66","text":""},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#91","title":"9.1 \u76d1\u63a7\u5907\u4efd\u72b6\u6001","text":"<pre><code>-- \u67e5\u770b\u6700\u8fd1\u7684\u5907\u4efd\nSELECT \n    session_key,\n    input_type,\n    status,\n    start_time,\n    end_time,\n    elapsed_seconds,\n    input_bytes/1024/1024/1024 AS input_gb,\n    output_bytes/1024/1024/1024 AS output_gb\nFROM v$rman_backup_job_details\nWHERE start_time &gt; SYSDATE - 7\nORDER BY start_time DESC;\n\n-- \u67e5\u770b\u5907\u4efd\u8fdb\u5ea6\nSELECT \n    sid,\n    serial#,\n    context,\n    sofar,\n    totalwork,\n    ROUND(sofar/totalwork*100, 2) AS pct_complete,\n    start_time,\n    time_remaining\nFROM v$session_longops\nWHERE opname LIKE 'RMAN%'\n  AND totalwork &gt; 0;\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#92","title":"9.2 \u544a\u8b66\u811a\u672c","text":"<pre><code>#!/bin/bash\n# check_rman_backup.sh\n\nexport ORACLE_SID=ORCL\nexport ORACLE_HOME=/u01/app/oracle/product/19.3.0/dbhome_1\nexport PATH=$ORACLE_HOME/bin:$PATH\n\n# \u68c0\u67e5\u6700\u8fd124\u5c0f\u65f6\u662f\u5426\u6709\u6210\u529f\u7684\u5907\u4efd\nBACKUP_COUNT=$(sqlplus -s / as sysdba &lt;&lt;EOF\nSET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\nSELECT COUNT(*) \nFROM v\\$rman_backup_job_details\nWHERE status = 'COMPLETED'\n  AND start_time &gt; SYSDATE - 1;\nEXIT;\nEOF\n)\n\nif [ \"$BACKUP_COUNT\" -eq 0 ]; then\n    echo \"No successful RMAN backup in the last 24 hours!\" | mail -s \"RMAN Backup Alert\" dba@example.com\nfi\n\n# \u68c0\u67e5\u5907\u4efd\u5931\u8d25\nFAILED_COUNT=$(sqlplus -s / as sysdba &lt;&lt;EOF\nSET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\nSELECT COUNT(*) \nFROM v\\$rman_backup_job_details\nWHERE status = 'FAILED'\n  AND start_time &gt; SYSDATE - 1;\nEXIT;\nEOF\n)\n\nif [ \"$FAILED_COUNT\" -gt 0 ]; then\n    echo \"RMAN backup failed in the last 24 hours!\" | mail -s \"RMAN Backup FAILED\" dba@example.com\nfi\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#10","title":"10. \u6e05\u7406\u8fc7\u671f\u5907\u4efd","text":""},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#101","title":"10.1 \u624b\u52a8\u6e05\u7406","text":"<pre><code>rman target /\n\n# \u5220\u9664\u8fc7\u65f6\u5907\u4efd\nDELETE NOPROMPT OBSOLETE;\n\n# \u5220\u9664\u8fc7\u671f\u5907\u4efd\nDELETE NOPROMPT EXPIRED BACKUP;\n\n# \u5220\u9664\u6307\u5b9a\u5907\u4efd\u96c6\nDELETE BACKUPSET 123;\n\n# \u5220\u9664\u5f52\u6863\u65e5\u5fd7\uff08\u5df2\u5907\u4efd\uff09\nDELETE ARCHIVELOG ALL BACKED UP 1 TIMES TO DISK;\n\n# \u5220\u96647\u5929\u524d\u7684\u5f52\u6863\u65e5\u5fd7\nDELETE ARCHIVELOG UNTIL TIME 'SYSDATE-7';\n\nEXIT;\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#102","title":"10.2 \u81ea\u52a8\u6e05\u7406\u811a\u672c","text":"<pre><code>#!/bin/bash\n# rman_cleanup.sh\n\nexport ORACLE_SID=ORCL\nexport ORACLE_HOME=/u01/app/oracle/product/19.3.0/dbhome_1\nexport PATH=$ORACLE_HOME/bin:$PATH\n\nLOG_DIR=/u01/backup/logs\nDATE=$(date +%Y%m%d_%H%M%S)\n\nrman target / &lt;&lt;EOF &gt; $LOG_DIR/cleanup_$DATE.log\nCROSSCHECK BACKUP;\nCROSSCHECK ARCHIVELOG ALL;\n\nDELETE NOPROMPT OBSOLETE;\nDELETE NOPROMPT EXPIRED BACKUP;\nDELETE NOPROMPT ARCHIVELOG ALL BACKED UP 2 TIMES TO DISK;\n\nEXIT;\nEOF\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#11_1","title":"11. \u6062\u590d\u6f14\u7ec3","text":""},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#111","title":"11.1 \u5b9a\u671f\u6f14\u7ec3\u8ba1\u5212","text":"<pre><code>\u6bcf\u6708\u7b2c\u4e00\u4e2a\u5468\u516d\uff1a\n1. \u5728\u6d4b\u8bd5\u73af\u5883\u6062\u590d\u6700\u65b0\u5907\u4efd\n2. \u9a8c\u8bc1\u6570\u636e\u5b8c\u6574\u6027\n3. \u6d4b\u8bd5\u4e0d\u5b8c\u5168\u6062\u590d\uff08PITR\uff09\n4. \u8bb0\u5f55\u6062\u590d\u65f6\u95f4\uff08RTO\uff09\n5. \u66f4\u65b0\u6062\u590d\u6587\u6863\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#112","title":"11.2 \u6f14\u7ec3\u811a\u672c","text":"<pre><code>#!/bin/bash\n# rman_restore_test.sh\n\nexport ORACLE_SID=TESTDB\nexport ORACLE_HOME=/u01/app/oracle/product/19.3.0/dbhome_1\nexport PATH=$ORACLE_HOME/bin:$PATH\n\necho \"Starting RMAN restore test at $(date)\"\n\nrman target / &lt;&lt;EOF\nSHUTDOWN IMMEDIATE;\nSTARTUP NOMOUNT;\n\n# \u6062\u590d\u63a7\u5236\u6587\u4ef6\nRESTORE CONTROLFILE FROM '/u01/backup/rman/ctl_latest';\n\nALTER DATABASE MOUNT;\n\n# \u6062\u590d\u6570\u636e\u5e93\nRESTORE DATABASE;\nRECOVER DATABASE;\n\n# \u6253\u5f00\u6570\u636e\u5e93\nALTER DATABASE OPEN RESETLOGS;\n\nEXIT;\nEOF\n\n# \u9a8c\u8bc1\u6570\u636e\nsqlplus / as sysdba &lt;&lt;EOF\nSELECT COUNT(*) FROM dba_tables;\nSELECT COUNT(*) FROM dba_users;\nEXIT;\nEOF\n\necho \"RMAN restore test completed at $(date)\"\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#12_1","title":"12. \u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u5b9a\u671f\u6d4b\u8bd5\u6062\u590d\uff1a\u6bcf\u6708\u81f3\u5c11\u4e00\u6b21\u6062\u590d\u6f14\u7ec3</li> <li>\u5f02\u5730\u5907\u4efd\uff1a\u5c06\u5907\u4efd\u590d\u5236\u5230\u5f02\u5730\u5b58\u50a8</li> <li>\u76d1\u63a7\u544a\u8b66\uff1a\u5907\u4efd\u5931\u8d25\u7acb\u5373\u544a\u8b66</li> <li>\u4fdd\u7559\u7b56\u7565\uff1a\u6839\u636e\u4e1a\u52a1\u9700\u6c42\u8bbe\u7f6e\u5408\u7406\u7684\u4fdd\u7559\u671f</li> <li>\u538b\u7f29\u5907\u4efd\uff1a\u8282\u7701\u5b58\u50a8\u7a7a\u95f4</li> <li>\u5e76\u884c\u5907\u4efd\uff1a\u63d0\u9ad8\u5907\u4efd\u901f\u5ea6</li> <li>\u5757\u53d8\u66f4\u8ddf\u8e2a\uff1a\u542f\u7528 BCT \u52a0\u901f\u589e\u91cf\u5907\u4efd</li> <li>\u6587\u6863\u8bb0\u5f55\uff1a\u8bb0\u5f55\u5907\u4efd\u7b56\u7565\u548c\u6062\u590d\u6b65\u9aa4</li> <li>\u6743\u9650\u7ba1\u7406\uff1a\u9650\u5236\u5907\u4efd\u6587\u4ef6\u8bbf\u95ee\u6743\u9650</li> <li>\u5b9a\u671f\u6e05\u7406\uff1a\u81ea\u52a8\u6e05\u7406\u8fc7\u671f\u5907\u4efd</li> </ol>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#13_1","title":"13. \u6545\u969c\u6392\u67e5","text":""},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#131","title":"13.1 \u5e38\u89c1\u9519\u8bef","text":"<pre><code>\u9519\u8bef1\uff1aRMAN-06059: expected archived log not found\n  \u539f\u56e0\uff1a\u5f52\u6863\u65e5\u5fd7\u7f3a\u5931\n  \u89e3\u51b3\uff1a\u68c0\u67e5\u5f52\u6863\u65e5\u5fd7\u8def\u5f84\uff0c\u6062\u590d\u7f3a\u5931\u7684\u5f52\u6863\u65e5\u5fd7\n\n\u9519\u8bef2\uff1aRMAN-03009: failure of backup command\n  \u539f\u56e0\uff1a\u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3\n  \u89e3\u51b3\uff1a\u6e05\u7406\u78c1\u76d8\u7a7a\u95f4\u6216\u66f4\u6539\u5907\u4efd\u8def\u5f84\n\n\u9519\u8bef3\uff1aORA-19870: error while restoring backup piece\n  \u539f\u56e0\uff1a\u5907\u4efd\u6587\u4ef6\u635f\u574f\n  \u89e3\u51b3\uff1a\u4f7f\u7528\u5176\u4ed6\u5907\u4efd\u6216\u4ece\u5f02\u5730\u6062\u590d\n\n\u9519\u8bef4\uff1aRMAN-06023: no backup or copy of datafile found\n  \u539f\u56e0\uff1a\u5907\u4efd\u4e0d\u5b58\u5728\n  \u89e3\u51b3\uff1a\u68c0\u67e5\u5907\u4efd\u7b56\u7565\uff0c\u786e\u4fdd\u5b9a\u671f\u5907\u4efd\n</code></pre>"},{"location":"dba/Oracle-RMAN-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%96%B9%E6%A1%88.html#132-rman","title":"13.2 \u67e5\u770b RMAN \u65e5\u5fd7","text":"<pre><code># \u67e5\u770b RMAN \u65e5\u5fd7\ntail -f $ORACLE_HOME/rdbms/log/rman_*.log\n\n# \u67e5\u770b\u544a\u8b66\u65e5\u5fd7\ntail -f $ORACLE_BASE/diag/rdbms/orcl/ORCL/trace/alert_ORCL.log\n</code></pre> <p>\u53c2\u8003\u6587\u6863\uff1a - Oracle Database Backup and Recovery User's Guide (19c) - Oracle RMAN Best Practices (MOS Doc ID 388422.1) - Oracle Database Backup and Recovery Reference (19c)</p>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html","title":"Oracle \u8fc1\u79fb\u81f3 MySQL\uff1a50TB \u7ea7\u6570\u636e\u8fc1\u79fb\u65b9\u6848","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aDBA\u3001\u67b6\u6784\u5e08\u3001\u9879\u76ee\u7ecf\u7406 \u76ee\u6807\uff1a\u63d0\u4f9b\u8d85\u5927\u89c4\u6a21\uff0850TB+\uff09Oracle \u5230 MySQL \u6570\u636e\u8fc1\u79fb\u7684\u5b8c\u6574\u65b9\u6848\uff0c\u5305\u62ec\u8bc4\u4f30\u3001\u67b6\u6784\u8bbe\u8ba1\u3001\u8fc1\u79fb\u5b9e\u65bd\u3001\u9a8c\u8bc1\u4e0e\u4f18\u5316\u3002</p>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#1","title":"1. \u9879\u76ee\u80cc\u666f","text":""},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#11","title":"1.1 \u8fc1\u79fb\u52a8\u673a","text":"<ul> <li>\u6210\u672c\u4f18\u5316\uff1aOracle License \u8d39\u7528\u9ad8\u6602\uff0850TB \u6570\u636e\u7ea6\u9700\u6570\u767e\u4e07/\u5e74\uff09</li> <li>\u4e91\u539f\u751f\uff1aMySQL \u4e91\u670d\u52a1\u6210\u719f\uff08AWS RDS/Aurora\u3001\u963f\u91cc\u4e91 RDS\uff09</li> <li>\u5f00\u6e90\u751f\u6001\uff1a\u793e\u533a\u6d3b\u8dc3\uff0c\u5de5\u5177\u4e30\u5bcc</li> <li>\u4e1a\u52a1\u9700\u6c42\uff1a\u5fae\u670d\u52a1\u5316\u6539\u9020\uff0c\u9700\u8981\u8f7b\u91cf\u7ea7\u6570\u636e\u5e93</li> </ul>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#12","title":"1.2 \u6311\u6218\u4e0e\u98ce\u9669","text":"\u6311\u6218 \u5f71\u54cd \u5e94\u5bf9\u7b56\u7565 \u6570\u636e\u91cf\u5de8\u5927\uff0850TB\uff09 \u8fc1\u79fb\u65f6\u95f4\u957f \u5206\u6279\u8fc1\u79fb\u3001\u5e76\u884c\u4f20\u8f93 \u4e1a\u52a1\u505c\u673a\u65f6\u95f4 \u670d\u52a1\u4e2d\u65ad \u53cc\u5199\u3001\u903b\u8f91\u590d\u5236\u3001\u7070\u5ea6\u5207\u6362 \u6570\u636e\u4e00\u81f4\u6027 \u6570\u636e\u4e22\u5931/\u91cd\u590d \u6821\u9a8c\u5de5\u5177\u3001\u56de\u6eda\u9884\u6848 \u6027\u80fd\u5dee\u5f02 \u67e5\u8be2\u53d8\u6162 \u7d22\u5f15\u4f18\u5316\u3001\u5206\u5e93\u5206\u8868 SQL \u517c\u5bb9\u6027 \u5e94\u7528\u6539\u9020 SQL \u6539\u5199\u3001\u517c\u5bb9\u5c42 \u5b58\u50a8\u8fc7\u7a0b\u8fc1\u79fb \u4e1a\u52a1\u903b\u8f91\u91cd\u5199 \u9010\u4e2a\u8fc1\u79fb\u3001\u6d4b\u8bd5"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#2","title":"2. \u8fc1\u79fb\u524d\u8bc4\u4f30","text":""},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#21","title":"2.1 \u6570\u636e\u5e93\u5bf9\u8c61\u6e05\u5355","text":"<pre><code>-- Oracle \u7aef\u7edf\u8ba1\n-- \u8868\u6570\u91cf\u4e0e\u6570\u636e\u91cf\nSELECT \n    owner,\n    COUNT(*) AS table_count,\n    ROUND(SUM(bytes)/1024/1024/1024/1024, 2) AS size_tb\nFROM dba_segments\nWHERE segment_type = 'TABLE'\n  AND owner NOT IN ('SYS', 'SYSTEM', 'SYSAUX')\nGROUP BY owner\nORDER BY size_tb DESC;\n\n-- \u8f93\u51fa\u793a\u4f8b\uff1a\n-- OWNER        | TABLE_COUNT | SIZE_TB\n-- APP_SCHEMA   | 1200        | 35.6\n-- LOG_SCHEMA   | 450         | 12.3\n-- ARCHIVE_SCHEMA | 230       | 2.1\n\n-- \u7d22\u5f15\u7edf\u8ba1\nSELECT \n    owner,\n    COUNT(*) AS index_count,\n    ROUND(SUM(bytes)/1024/1024/1024, 2) AS size_gb\nFROM dba_segments\nWHERE segment_type LIKE 'INDEX%'\n  AND owner NOT IN ('SYS', 'SYSTEM', 'SYSAUX')\nGROUP BY owner;\n\n-- \u5b58\u50a8\u8fc7\u7a0b/\u51fd\u6570/\u5305\nSELECT \n    owner,\n    object_type,\n    COUNT(*) AS object_count\nFROM dba_objects\nWHERE object_type IN ('PROCEDURE', 'FUNCTION', 'PACKAGE', 'TRIGGER')\n  AND owner NOT IN ('SYS', 'SYSTEM', 'SYSAUX')\nGROUP BY owner, object_type\nORDER BY owner, object_type;\n\n-- \u5206\u533a\u8868\u7edf\u8ba1\nSELECT \n    table_owner,\n    COUNT(DISTINCT table_name) AS partitioned_tables,\n    COUNT(*) AS partition_count\nFROM dba_tab_partitions\nWHERE table_owner NOT IN ('SYS', 'SYSTEM', 'SYSAUX')\nGROUP BY table_owner;\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#22","title":"2.2 \u4e1a\u52a1\u5206\u6790","text":"<pre><code>\u6570\u636e\u5206\u7c7b\uff1a\n1. \u6838\u5fc3\u4e1a\u52a1\u6570\u636e\uff08\u70ed\u6570\u636e\uff09\uff1a20TB\n   - \u8ba2\u5355\u8868\u3001\u7528\u6237\u8868\u3001\u4ea4\u6613\u8868\n   - \u9700\u8981\u9ad8\u53ef\u7528\u3001\u4f4e\u5ef6\u8fdf\n   - \u4f18\u5148\u8fc1\u79fb\n\n2. \u65e5\u5fd7/\u5f52\u6863\u6570\u636e\uff08\u6e29\u6570\u636e\uff09\uff1a25TB\n   - \u64cd\u4f5c\u65e5\u5fd7\u3001\u5ba1\u8ba1\u65e5\u5fd7\n   - \u67e5\u8be2\u9891\u7387\u4f4e\n   - \u53ef\u8003\u8651\u5f52\u6863\u5230\u5bf9\u8c61\u5b58\u50a8\uff08S3/OSS\uff09\n\n3. \u5386\u53f2\u6570\u636e\uff08\u51b7\u6570\u636e\uff09\uff1a5TB\n   - 3\u5e74\u524d\u7684\u5386\u53f2\u8bb0\u5f55\n   - \u51e0\u4e4e\u4e0d\u67e5\u8be2\n   - \u8fc1\u79fb\u5230\u51b7\u5b58\u50a8\u6216\u4e0d\u8fc1\u79fb\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#23","title":"2.3 \u517c\u5bb9\u6027\u8bc4\u4f30","text":"<pre><code># \u4f7f\u7528 MySQL Migration Toolkit \u8bc4\u4f30\n# \u6216\u4f7f\u7528 AWS SCT (Schema Conversion Tool)\n\n# \u751f\u6210\u8bc4\u4f30\u62a5\u544a\naws sct create-assessment-report \\\n  --source-endpoint oracle-source \\\n  --target-endpoint mysql-target \\\n  --output-file /tmp/assessment_report.pdf\n\n# \u62a5\u544a\u5305\u542b\uff1a\n# - \u81ea\u52a8\u8f6c\u6362\u7387\uff08\u901a\u5e38 70-85%\uff09\n# - \u9700\u8981\u624b\u52a8\u6539\u5199\u7684\u5bf9\u8c61\u5217\u8868\n# - \u9884\u4f30\u5de5\u4f5c\u91cf\uff08\u4eba\u5929\uff09\n# - \u98ce\u9669\u8bc4\u4f30\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#3","title":"3. \u67b6\u6784\u8bbe\u8ba1","text":""},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#31","title":"3.1 \u76ee\u6807\u67b6\u6784","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   \u5e94\u7528\u5c42\uff08\u53cc\u5199\uff09                      \u2502\n\u2502          Oracle (\u4e3b) + MySQL (\u4ece) \u2192 MySQL (\u4e3b)       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502               \u2502               \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 MySQL Shard1 \u2502 \u2502MySQL Shard2 \u2502 \u2502MySQL Shard3 \u2502\n\u2502   (\u6838\u5fc3\u4e1a\u52a1)  \u2502 \u2502  (\u65e5\u5fd7\u6570\u636e)  \u2502 \u2502  (\u5f52\u6863\u6570\u636e)  \u2502\n\u2502     15TB     \u2502 \u2502     20TB    \u2502 \u2502     10TB    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502               \u2502               \u2502\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502\n                \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                \u2502  ProxySQL      \u2502\n                \u2502  (\u8bfb\u5199\u5206\u79bb)     \u2502\n                \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#32","title":"3.2 \u5206\u5e93\u5206\u8868\u7b56\u7565","text":"<pre><code>-- \u6309\u4e1a\u52a1\u6a21\u5757\u5206\u5e93\ndatabase_order    -- \u8ba2\u5355\u76f8\u5173\u8868\ndatabase_user     -- \u7528\u6237\u76f8\u5173\u8868\ndatabase_product  -- \u5546\u54c1\u76f8\u5173\u8868\ndatabase_log      -- \u65e5\u5fd7\u76f8\u5173\u8868\n\n-- \u5927\u8868\u5206\u8868\uff08\u6309\u65f6\u95f4/ID\uff09\n-- \u8ba2\u5355\u8868\u6309\u6708\u5206\u8868\norders_202501\norders_202502\norders_202503\n...\n\n-- \u6216\u6309 ID \u8303\u56f4\u5206\u8868\uff08Hash\uff09\norders_0  -- user_id % 16 = 0\norders_1  -- user_id % 16 = 1\n...\norders_15 -- user_id % 16 = 15\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#33","title":"3.3 \u786c\u4ef6\u89c4\u5212","text":"<pre><code>MySQL \u96c6\u7fa4\u914d\u7f6e\uff083\u4e2a\u5206\u7247\uff09\uff1a\n\n\u6bcf\u4e2a\u5206\u7247\uff1a\n- \u4e3b\u5e93\uff1a64\u6838 256GB \u5185\u5b58\uff0c20TB NVMe SSD\uff08RAID 10\uff09\n- \u4ece\u5e931\uff1a64\u6838 256GB \u5185\u5b58\uff0c20TB NVMe SSD\n- \u4ece\u5e932\uff1a64\u6838 256GB \u5185\u5b58\uff0c20TB NVMe SSD\n\n\u7f51\u7edc\uff1a\n- \u4e07\u5146\u7f51\u5361\uff0810Gbps\uff09\n- \u4e13\u7528\u8fc1\u79fb\u7f51\u7edc\uff08\u907f\u514d\u5f71\u54cd\u751f\u4ea7\uff09\n\n\u5b58\u50a8\uff1a\n- IOPS\uff1a50000+\n- \u541e\u5410\u91cf\uff1a2GB/s+\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#4","title":"4. \u8fc1\u79fb\u65b9\u6848\u8bbe\u8ba1","text":""},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#41","title":"4.1 \u8fc1\u79fb\u7b56\u7565\uff08\u5206\u9636\u6bb5\uff09","text":"<pre><code>\u9636\u6bb51\uff1a\u51c6\u5907\u9636\u6bb5\uff082\u5468\uff09\n  - \u5b89\u88c5 MySQL \u96c6\u7fa4\uff08\u4e3b\u4ece\u590d\u5236\uff09\n  - Schema \u8fc1\u79fb\uff08\u8868\u3001\u7d22\u5f15\u3001\u7ea6\u675f\uff09\n  - \u5e94\u7528\u4ee3\u7801\u9002\u914d\uff08SQL \u6539\u5199\uff09\n  - \u6d4b\u8bd5\u73af\u5883\u9a8c\u8bc1\n\n\u9636\u6bb52\uff1a\u5386\u53f2\u6570\u636e\u8fc1\u79fb\uff084\u5468\uff09\n  - \u51b7\u6570\u636e\u8fc1\u79fb\uff083\u5e74\u524d\u6570\u636e\uff09\n  - \u6e29\u6570\u636e\u8fc1\u79fb\uff081-3\u5e74\u6570\u636e\uff09\n  - \u6570\u636e\u6821\u9a8c\n\n\u9636\u6bb53\uff1a\u589e\u91cf\u540c\u6b65\uff082\u5468\uff09\n  - \u4f7f\u7528 OGG/Debezium \u5b9e\u65f6\u540c\u6b65\n  - \u70ed\u6570\u636e\u8fc1\u79fb\n  - \u53cc\u5199\u9a8c\u8bc1\n\n\u9636\u6bb54\uff1a\u7070\u5ea6\u5207\u6362\uff081\u5468\uff09\n  - 10% \u6d41\u91cf\u5207\u6362\u5230 MySQL\n  - 50% \u6d41\u91cf\u5207\u6362\n  - 100% \u6d41\u91cf\u5207\u6362\n  - \u76d1\u63a7\u544a\u8b66\n\n\u9636\u6bb55\uff1a\u7a33\u5b9a\u89c2\u5bdf\uff082\u5468\uff09\n  - \u6027\u80fd\u76d1\u63a7\n  - \u6570\u636e\u4e00\u81f4\u6027\u6821\u9a8c\n  - Oracle \u4fdd\u7559\u4f5c\u4e3a\u5907\u4efd\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#42","title":"4.2 \u6570\u636e\u8fc1\u79fb\u5de5\u5177\u9009\u578b","text":"\u5de5\u5177 \u9002\u7528\u573a\u666f \u4f18\u70b9 \u7f3a\u70b9 AWS DMS \u4e91\u4e0a\u8fc1\u79fb \u81ea\u52a8\u5316\u3001\u652f\u6301\u589e\u91cf \u9700\u8981 AWS \u73af\u5883 Oracle GoldenGate \u5b9e\u65f6\u540c\u6b65 \u4f4e\u5ef6\u8fdf\u3001\u53cc\u5411\u540c\u6b65 License \u8d39\u7528\u9ad8 Debezium (CDC) \u5f00\u6e90\u65b9\u6848 \u514d\u8d39\u3001\u7075\u6d3b \u914d\u7f6e\u590d\u6742 DataX (\u963f\u91cc) \u6279\u91cf\u8fc1\u79fb \u9ad8\u6027\u80fd\u3001\u5e76\u884c \u4ec5\u5168\u91cf Kettle/Talend ETL \u5de5\u5177 \u53ef\u89c6\u5316\u3001\u8f6c\u6362\u7075\u6d3b \u6027\u80fd\u4e00\u822c \u81ea\u7814\u811a\u672c \u5b9a\u5236\u9700\u6c42 \u5b8c\u5168\u53ef\u63a7 \u5f00\u53d1\u6210\u672c\u9ad8 <p>\u63a8\u8350\u65b9\u6848\uff1a - \u5168\u91cf\u8fc1\u79fb\uff1aDataX\uff08\u5e76\u884c\uff09+ \u81ea\u7814\u811a\u672c - \u589e\u91cf\u540c\u6b65\uff1aOracle GoldenGate \u6216 Debezium</p>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#5-schema","title":"5. Schema \u8fc1\u79fb","text":""},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#51","title":"5.1 \u6570\u636e\u7c7b\u578b\u6620\u5c04","text":"Oracle MySQL \u8bf4\u660e NUMBER(p,s) DECIMAL(p,s) \u7cbe\u786e\u6570\u503c NUMBER DECIMAL(65,0) \u65e0\u7cbe\u5ea6 NUMBER VARCHAR2(n) VARCHAR(n) \u53d8\u957f\u5b57\u7b26\u4e32 CHAR(n) CHAR(n) \u5b9a\u957f\u5b57\u7b26\u4e32 DATE DATETIME Oracle DATE \u5305\u542b\u65f6\u95f4 TIMESTAMP DATETIME(6) \u5fae\u79d2\u7cbe\u5ea6 CLOB LONGTEXT \u5927\u6587\u672c\uff084GB\uff09 BLOB LONGBLOB \u4e8c\u8fdb\u5236\uff084GB\uff09 RAW VARBINARY \u4e8c\u8fdb\u5236 LONG TEXT \u5df2\u5e9f\u5f03"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#52-schema","title":"5.2 \u81ea\u52a8\u5316 Schema \u8f6c\u6362","text":"<pre><code># \u4f7f\u7528 AWS SCT \u8f6c\u6362 Schema\naws sct convert-schema \\\n  --source-endpoint oracle-source \\\n  --target-endpoint mysql-target \\\n  --output-dir /tmp/converted_schema\n\n# \u6216\u4f7f\u7528 MySQL Workbench Migration Wizard\n# GUI \u5de5\u5177\uff0c\u652f\u6301\u53ef\u89c6\u5316\u8f6c\u6362\n\n# \u751f\u6210\u7684 MySQL DDL \u793a\u4f8b\nCREATE TABLE orders (\n    order_id BIGINT PRIMARY KEY,\n    user_id BIGINT NOT NULL,\n    amount DECIMAL(15,2),\n    status VARCHAR(20),\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n    INDEX idx_user_id (user_id),\n    INDEX idx_created_at (created_at)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#53","title":"5.3 \u5206\u533a\u8868\u8f6c\u6362","text":"<pre><code>-- Oracle \u5206\u533a\u8868\nCREATE TABLE orders (\n    order_id NUMBER,\n    order_date DATE,\n    ...\n)\nPARTITION BY RANGE (order_date) (\n    PARTITION p202301 VALUES LESS THAN (TO_DATE('2023-02-01', 'YYYY-MM-DD')),\n    PARTITION p202302 VALUES LESS THAN (TO_DATE('2023-03-01', 'YYYY-MM-DD')),\n    ...\n);\n\n-- MySQL \u5206\u533a\u8868\nCREATE TABLE orders (\n    order_id BIGINT,\n    order_date DATE,\n    ...\n)\nPARTITION BY RANGE (TO_DAYS(order_date)) (\n    PARTITION p202301 VALUES LESS THAN (TO_DAYS('2023-02-01')),\n    PARTITION p202302 VALUES LESS THAN (TO_DAYS('2023-03-01')),\n    ...\n);\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#6","title":"6. \u6570\u636e\u8fc1\u79fb\u5b9e\u65bd","text":""},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#61-datax","title":"6.1 \u4f7f\u7528 DataX \u6279\u91cf\u8fc1\u79fb","text":"<pre><code>// datax_job.json\n{\n    \"job\": {\n        \"setting\": {\n            \"speed\": {\n                \"channel\": 32,\n                \"byte\": 10485760\n            }\n        },\n        \"content\": [\n            {\n                \"reader\": {\n                    \"name\": \"oraclereader\",\n                    \"parameter\": {\n                        \"username\": \"app_user\",\n                        \"password\": \"Oracle123#\",\n                        \"column\": [\"order_id\", \"user_id\", \"amount\", \"created_at\"],\n                        \"connection\": [\n                            {\n                                \"table\": [\"orders\"],\n                                \"jdbcUrl\": [\"jdbc:oracle:thin:@192.168.1.10:1521:ORCL\"]\n                            }\n                        ],\n                        \"where\": \"created_at &gt;= TO_DATE('2023-01-01', 'YYYY-MM-DD')\"\n                    }\n                },\n                \"writer\": {\n                    \"name\": \"mysqlwriter\",\n                    \"parameter\": {\n                        \"username\": \"root\",\n                        \"password\": \"MySQL123#\",\n                        \"column\": [\"order_id\", \"user_id\", \"amount\", \"created_at\"],\n                        \"connection\": [\n                            {\n                                \"table\": [\"orders\"],\n                                \"jdbcUrl\": \"jdbc:mysql://192.168.1.20:3306/mydb?useUnicode=true&amp;characterEncoding=utf8\"\n                            }\n                        ],\n                        \"writeMode\": \"insert\"\n                    }\n                }\n            }\n        ]\n    }\n}\n</code></pre> <pre><code># \u6267\u884c DataX \u4efb\u52a1\npython datax.py datax_job.json\n\n# \u5e76\u884c\u6267\u884c\u591a\u4e2a\u4efb\u52a1\uff08\u6309\u5206\u533a\uff09\nfor i in {1..12}; do\n    python datax.py datax_job_2023_${i}.json &amp;\ndone\nwait\n\n# \u76d1\u63a7\u8fdb\u5ea6\ntail -f datax.log\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#62-oracle-goldengate","title":"6.2 \u4f7f\u7528 Oracle GoldenGate \u589e\u91cf\u540c\u6b65","text":"<pre><code># \u5728 Oracle \u7aef\u914d\u7f6e GoldenGate Extract\nGGSCI&gt; ADD EXTRACT ext1, TRANLOG, BEGIN NOW\nGGSCI&gt; ADD EXTTRAIL /u01/ogg/dirdat/lt, EXTRACT ext1\nGGSCI&gt; EDIT PARAMS ext1\n\n# ext1.prm\nEXTRACT ext1\nUSERID ggadmin, PASSWORD Oracle123#\nEXTTRAIL /u01/ogg/dirdat/lt\nTABLE app_schema.orders;\nTABLE app_schema.users;\nTABLE app_schema.products;\n\n# \u542f\u52a8 Extract\nGGSCI&gt; START EXTRACT ext1\n\n# \u5728 MySQL \u7aef\u914d\u7f6e Replicat\nGGSCI&gt; ADD REPLICAT rep1, EXTTRAIL /u01/ogg/dirdat/lt\nGGSCI&gt; EDIT PARAMS rep1\n\n# rep1.prm\nREPLICAT rep1\nTARGETDB mydb, USERID root, PASSWORD MySQL123#\nMAP app_schema.orders, TARGET mydb.orders;\nMAP app_schema.users, TARGET mydb.users;\nMAP app_schema.products, TARGET mydb.products;\n\n# \u542f\u52a8 Replicat\nGGSCI&gt; START REPLICAT rep1\n\n# \u76d1\u63a7\u540c\u6b65\u72b6\u6001\nGGSCI&gt; INFO ALL\nGGSCI&gt; STATS EXTRACT ext1\nGGSCI&gt; STATS REPLICAT rep1\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#63","title":"6.3 \u5206\u6279\u8fc1\u79fb\u811a\u672c","text":"<pre><code>#!/usr/bin/env python3\n# migrate_batch.py\n\nimport cx_Oracle\nimport pymysql\nfrom datetime import datetime, timedelta\n\n# \u914d\u7f6e\nORACLE_DSN = \"192.168.1.10:1521/ORCL\"\nORACLE_USER = \"app_user\"\nORACLE_PASS = \"Oracle123#\"\n\nMYSQL_HOST = \"192.168.1.20\"\nMYSQL_USER = \"root\"\nMYSQL_PASS = \"MySQL123#\"\nMYSQL_DB = \"mydb\"\n\nBATCH_SIZE = 10000\nTABLE_NAME = \"orders\"\n\ndef migrate_table_by_date_range(start_date, end_date):\n    \"\"\"\u6309\u65e5\u671f\u8303\u56f4\u8fc1\u79fb\u6570\u636e\"\"\"\n    oracle_conn = cx_Oracle.connect(ORACLE_USER, ORACLE_PASS, ORACLE_DSN)\n    mysql_conn = pymysql.connect(host=MYSQL_HOST, user=MYSQL_USER, \n                                  password=MYSQL_PASS, database=MYSQL_DB)\n\n    oracle_cursor = oracle_conn.cursor()\n    mysql_cursor = mysql_conn.cursor()\n\n    # \u67e5\u8be2 Oracle \u6570\u636e\n    query = f\"\"\"\n        SELECT order_id, user_id, amount, status, created_at\n        FROM {TABLE_NAME}\n        WHERE created_at &gt;= :start_date AND created_at &lt; :end_date\n        ORDER BY order_id\n    \"\"\"\n\n    oracle_cursor.execute(query, start_date=start_date, end_date=end_date)\n\n    batch = []\n    total_rows = 0\n\n    while True:\n        rows = oracle_cursor.fetchmany(BATCH_SIZE)\n        if not rows:\n            break\n\n        # \u6279\u91cf\u63d2\u5165 MySQL\n        insert_sql = f\"\"\"\n            INSERT INTO {TABLE_NAME} \n            (order_id, user_id, amount, status, created_at)\n            VALUES (%s, %s, %s, %s, %s)\n        \"\"\"\n        mysql_cursor.executemany(insert_sql, rows)\n        mysql_conn.commit()\n\n        total_rows += len(rows)\n        print(f\"Migrated {total_rows} rows for {start_date} to {end_date}\")\n\n    oracle_cursor.close()\n    mysql_cursor.close()\n    oracle_conn.close()\n    mysql_conn.close()\n\n    print(f\"Completed: {total_rows} rows migrated\")\n\n# \u6309\u6708\u5206\u6279\u8fc1\u79fb\nstart_date = datetime(2020, 1, 1)\nend_date = datetime(2025, 12, 1)\n\ncurrent_date = start_date\nwhile current_date &lt; end_date:\n    next_date = current_date + timedelta(days=30)\n    print(f\"Migrating data from {current_date} to {next_date}\")\n    migrate_table_by_date_range(current_date, next_date)\n    current_date = next_date\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#7","title":"7. \u6570\u636e\u4e00\u81f4\u6027\u6821\u9a8c","text":""},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#71","title":"7.1 \u884c\u6570\u6821\u9a8c","text":"<pre><code>#!/bin/bash\n# check_row_count.sh\n\nTABLES=\"orders users products transactions\"\n\nfor table in $TABLES; do\n    echo \"Checking table: $table\"\n\n    # Oracle \u884c\u6570\n    oracle_count=$(sqlplus -s app_user/Oracle123#@ORCL &lt;&lt;EOF\nSET PAGESIZE 0 FEEDBACK OFF VERIFY OFF HEADING OFF ECHO OFF\nSELECT COUNT(*) FROM $table;\nEXIT;\nEOF\n)\n\n    # MySQL \u884c\u6570\n    mysql_count=$(mysql -h192.168.1.20 -uroot -pMySQL123# -D mydb -N -e \"SELECT COUNT(*) FROM $table\")\n\n    echo \"Oracle: $oracle_count, MySQL: $mysql_count\"\n\n    if [ \"$oracle_count\" -eq \"$mysql_count\" ]; then\n        echo \"\u2705 $table: PASS\"\n    else\n        echo \"\u274c $table: FAIL (diff: $((oracle_count - mysql_count)))\"\n    fi\ndone\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#72-checksum","title":"7.2 \u6570\u636e\u6821\u9a8c\uff08Checksum\uff09","text":"<pre><code>-- Oracle \u7aef\nSELECT \n    'orders' AS table_name,\n    COUNT(*) AS row_count,\n    SUM(ORA_HASH(order_id || user_id || amount)) AS checksum\nFROM orders;\n\n-- MySQL \u7aef\nSELECT \n    'orders' AS table_name,\n    COUNT(*) AS row_count,\n    SUM(CRC32(CONCAT(order_id, user_id, amount))) AS checksum\nFROM orders;\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#73-pt-table-checksumpercona-toolkit","title":"7.3 \u4f7f\u7528 pt-table-checksum\uff08Percona Toolkit\uff09","text":"<pre><code># \u9700\u8981\u5728 Oracle \u548c MySQL \u4e4b\u95f4\u5efa\u7acb\u6570\u636e\u6865\u63a5\n# \u6216\u4f7f\u7528\u81ea\u5b9a\u4e49\u811a\u672c\u9010\u884c\u5bf9\u6bd4\n\n# \u793a\u4f8b\uff1a\u5bf9\u6bd4\u5173\u952e\u5b57\u6bb5\nSELECT order_id, MD5(CONCAT(user_id, amount, status)) AS hash\nFROM orders\nORDER BY order_id\nLIMIT 1000;\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#8","title":"8. \u5e94\u7528\u6539\u9020","text":""},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#81-sql","title":"8.1 SQL \u6539\u5199","text":"<pre><code>-- Oracle: DUAL \u8868\nSELECT SYSDATE FROM DUAL;\n-- MySQL\nSELECT NOW();\n\n-- Oracle: \u5e8f\u5217\nSELECT seq_order_id.NEXTVAL FROM DUAL;\n-- MySQL: AUTO_INCREMENT\nINSERT INTO orders (user_id, amount) VALUES (123, 99.99);\nSELECT LAST_INSERT_ID();\n\n-- Oracle: ROWNUM\nSELECT * FROM orders WHERE ROWNUM &lt;= 10;\n-- MySQL: LIMIT\nSELECT * FROM orders LIMIT 10;\n\n-- Oracle: NVL\nSELECT NVL(column_name, 'default') FROM table_name;\n-- MySQL: IFNULL/COALESCE\nSELECT IFNULL(column_name, 'default') FROM table_name;\n\n-- Oracle: TO_DATE\nSELECT * FROM orders WHERE created_at &gt; TO_DATE('2025-01-01', 'YYYY-MM-DD');\n-- MySQL: STR_TO_DATE\nSELECT * FROM orders WHERE created_at &gt; STR_TO_DATE('2025-01-01', '%Y-%m-%d');\n\n-- Oracle: DECODE\nSELECT DECODE(status, 1, 'Active', 2, 'Inactive', 'Unknown') FROM users;\n-- MySQL: CASE\nSELECT CASE status \n    WHEN 1 THEN 'Active' \n    WHEN 2 THEN 'Inactive' \n    ELSE 'Unknown' \nEND FROM users;\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#82","title":"8.2 \u8fde\u63a5\u6c60\u914d\u7f6e","text":"<pre><code># Oracle (HikariCP)\nspring.datasource.url=jdbc:oracle:thin:@192.168.1.10:1521:ORCL\nspring.datasource.driver-class-name=oracle.jdbc.OracleDriver\n\n# MySQL (HikariCP)\nspring.datasource.url=jdbc:mysql://192.168.1.20:3306/mydb?useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=Asia/Shanghai\nspring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver\nspring.datasource.hikari.maximum-pool-size=50\nspring.datasource.hikari.minimum-idle=10\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#9","title":"9. \u6027\u80fd\u4f18\u5316","text":""},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#91-mysql-50tb","title":"9.1 MySQL \u53c2\u6570\u8c03\u4f18\uff0850TB \u6570\u636e\uff09","text":"<pre><code>[mysqld]\n# \u5185\u5b58\u914d\u7f6e\uff08256GB \u670d\u52a1\u5668\uff09\ninnodb_buffer_pool_size = 180G  # 70% \u5185\u5b58\ninnodb_log_file_size = 8G\ninnodb_log_buffer_size = 256M\n\n# IO \u4f18\u5316\ninnodb_io_capacity = 20000\ninnodb_io_capacity_max = 40000\ninnodb_flush_method = O_DIRECT\ninnodb_flush_log_at_trx_commit = 2  # \u6027\u80fd\u4f18\u5148\n\n# \u5e76\u53d1\u4f18\u5316\ninnodb_thread_concurrency = 0\ninnodb_read_io_threads = 16\ninnodb_write_io_threads = 16\nmax_connections = 2000\n\n# \u8868\u7a7a\u95f4\ninnodb_file_per_table = 1\ninnodb_data_file_path = ibdata1:1G:autoextend\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#92","title":"9.2 \u7d22\u5f15\u4f18\u5316","text":"<pre><code>-- \u5206\u6790\u6162\u67e5\u8be2\nSELECT \n    query_time,\n    lock_time,\n    rows_examined,\n    sql_text\nFROM mysql.slow_log\nORDER BY query_time DESC\nLIMIT 20;\n\n-- \u521b\u5efa\u590d\u5408\u7d22\u5f15\nCREATE INDEX idx_orders_user_created ON orders(user_id, created_at);\n\n-- \u5220\u9664\u672a\u4f7f\u7528\u7d22\u5f15\nSELECT \n    table_schema,\n    table_name,\n    index_name\nFROM information_schema.statistics\nWHERE table_schema = 'mydb'\n  AND index_name NOT IN (\n      SELECT DISTINCT index_name \n      FROM sys.schema_unused_indexes\n  );\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#10","title":"10. \u5207\u6362\u4e0e\u56de\u6eda","text":""},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#101","title":"10.1 \u7070\u5ea6\u5207\u6362\u65b9\u6848","text":"<pre><code>\u7b2c1\u5929\uff1a10% \u6d41\u91cf\u5207\u6362\n  - \u914d\u7f6e Nginx/HAProxy \u8def\u7531\u89c4\u5219\n  - \u76d1\u63a7 MySQL \u6027\u80fd\n  - \u5bf9\u6bd4 Oracle \u548c MySQL \u67e5\u8be2\u7ed3\u679c\n\n\u7b2c3\u5929\uff1a30% \u6d41\u91cf\u5207\u6362\n  - \u6269\u5927\u5207\u6362\u8303\u56f4\n  - \u6301\u7eed\u76d1\u63a7\n\n\u7b2c7\u5929\uff1a50% \u6d41\u91cf\u5207\u6362\n  - \u4e00\u534a\u6d41\u91cf\u9a8c\u8bc1\n\n\u7b2c10\u5929\uff1a100% \u6d41\u91cf\u5207\u6362\n  - \u5168\u91cf\u5207\u6362\n  - Oracle \u4fdd\u75597\u5929\u4f5c\u4e3a\u5907\u4efd\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#102","title":"10.2 \u56de\u6eda\u9884\u6848","text":"<pre><code># \u89e6\u53d1\u6761\u4ef6\uff1a\n# - \u6570\u636e\u4e0d\u4e00\u81f4\n# - \u6027\u80fd\u4e25\u91cd\u4e0b\u964d\uff08&gt; 50%\uff09\n# - \u529f\u80fd\u5f02\u5e38\n\n# \u56de\u6eda\u6b65\u9aa4\uff1a\n1. \u7acb\u5373\u5207\u6362\u6d41\u91cf\u56de Oracle\n2. \u505c\u6b62 MySQL \u5199\u5165\n3. \u5206\u6790\u5931\u8d25\u539f\u56e0\n4. \u4fee\u590d\u95ee\u9898\u540e\u91cd\u65b0\u5207\u6362\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#11_1","title":"11. \u76d1\u63a7\u4e0e\u544a\u8b66","text":"<pre><code>-- MySQL \u5173\u952e\u6307\u6807\nSHOW GLOBAL STATUS LIKE 'Threads_connected';\nSHOW GLOBAL STATUS LIKE 'Innodb_buffer_pool_read_requests';\nSHOW GLOBAL STATUS LIKE 'Slow_queries';\n\n-- \u590d\u5236\u5ef6\u8fdf\uff08\u5982\u679c\u4f7f\u7528\u4e3b\u4ece\uff09\nSHOW SLAVE STATUS\\G\n</code></pre>"},{"location":"dba/Oracle%E8%BF%81%E7%A7%BB%E8%87%B3MySQL-50TB%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88.html#12_1","title":"12. \u6700\u4f73\u5b9e\u8df5\u603b\u7ed3","text":"<ol> <li>\u5206\u9636\u6bb5\u8fc1\u79fb\uff1a\u5386\u53f2\u6570\u636e \u2192 \u589e\u91cf\u540c\u6b65 \u2192 \u7070\u5ea6\u5207\u6362</li> <li>\u5e76\u884c\u4f20\u8f93\uff1a\u5229\u7528 DataX \u591a\u901a\u9053\u5e76\u884c</li> <li>\u6570\u636e\u6821\u9a8c\uff1a\u884c\u6570 + Checksum \u53cc\u91cd\u6821\u9a8c</li> <li>\u6027\u80fd\u6d4b\u8bd5\uff1a\u8fc1\u79fb\u524d\u540e\u6027\u80fd\u5bf9\u6bd4</li> <li>\u56de\u6eda\u9884\u6848\uff1a\u4fdd\u7559 Oracle \u6570\u636e7-14\u5929</li> <li>\u76d1\u63a7\u544a\u8b66\uff1a\u5b9e\u65f6\u76d1\u63a7 MySQL \u6027\u80fd\u6307\u6807</li> <li>\u6587\u6863\u8bb0\u5f55\uff1a\u8bb0\u5f55\u6240\u6709\u6539\u52a8\u548c\u914d\u7f6e</li> </ol> <p>\u53c2\u8003\u5de5\u5177\uff1a - AWS DMS: https://aws.amazon.com/dms/ - Oracle GoldenGate: https://www.oracle.com/goldengate/ - DataX: https://github.com/alibaba/DataX - Debezium: https://debezium.io/</p>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html","title":"PostgreSQL \u6d41\u590d\u5236\u4e0e Patroni \u9ad8\u53ef\u7528\u65b9\u6848","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aPostgreSQL DBA\u3001\u8fd0\u7ef4\u5de5\u7a0b\u5e08\u3001\u67b6\u6784\u5e08 \u76ee\u6807\uff1a\u63d0\u4f9b PostgreSQL \u6d41\u590d\u5236\u3001\u903b\u8f91\u590d\u5236\u3001Patroni + etcd \u9ad8\u53ef\u7528\u96c6\u7fa4\u7684\u5b8c\u6574\u90e8\u7f72\u4e0e\u8fd0\u7ef4\u65b9\u6848\u3002</p>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#1-postgresql","title":"1. PostgreSQL \u590d\u5236\u67b6\u6784\u6982\u8ff0","text":""},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#11","title":"1.1 \u590d\u5236\u7c7b\u578b","text":"\u590d\u5236\u7c7b\u578b \u539f\u7406 \u5ef6\u8fdf \u4e00\u81f4\u6027 \u9002\u7528\u573a\u666f \u6d41\u590d\u5236\uff08\u7269\u7406\uff09 WAL \u65e5\u5fd7\u4f20\u8f93 \u4f4e \u5f3a \u9ad8\u53ef\u7528\u3001\u8bfb\u5199\u5206\u79bb \u903b\u8f91\u590d\u5236 \u903b\u8f91\u89e3\u7801 \u4e2d \u6700\u7ec8\u4e00\u81f4 \u8de8\u7248\u672c\u3001\u90e8\u5206\u8868\u590d\u5236 \u540c\u6b65\u590d\u5236 \u540c\u6b65\u63d0\u4ea4 \u4e2d \u5f3a \u91d1\u878d\u3001\u6838\u5fc3\u4e1a\u52a1 \u7ea7\u8054\u590d\u5236 \u591a\u7ea7\u4f20\u8f93 \u9ad8 \u5f31 \u8de8\u5730\u57df\u707e\u5907"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#12","title":"1.2 \u9ad8\u53ef\u7528\u65b9\u6848\u5bf9\u6bd4","text":"\u65b9\u6848 \u81ea\u52a8\u5207\u6362 \u590d\u6742\u5ea6 \u4f9d\u8d56 \u63a8\u8350\u5ea6 Patroni + etcd \u2705 \u4e2d etcd/Consul/ZK \u2b50\u2b50\u2b50\u2b50\u2b50 repmgr \u2705 \u4f4e \u65e0 \u2b50\u2b50\u2b50\u2b50 Pacemaker + Corosync \u2705 \u9ad8 Pacemaker \u2b50\u2b50\u2b50 pgpool-II \u2705 \u4e2d pgpool \u2b50\u2b50\u2b50"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#2","title":"2. \u6d41\u590d\u5236\u90e8\u7f72\uff08\u4e00\u4e3b\u4e24\u4ece\uff09","text":""},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#21","title":"2.1 \u73af\u5883\u51c6\u5907","text":"<pre><code># \u4e3b\u5e93\uff1a192.168.1.10 (pg-master)\n# \u4ece\u5e931\uff1a192.168.1.11 (pg-slave1)\n# \u4ece\u5e932\uff1a192.168.1.12 (pg-slave2)\n\n# PostgreSQL 15 \u5b89\u88c5\uff08\u6240\u6709\u8282\u70b9\uff09\nyum install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm\nyum install -y postgresql15-server postgresql15-contrib\n/usr/pgsql-15/bin/postgresql-15-setup initdb\nsystemctl enable postgresql-15\nsystemctl start postgresql-15\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#22","title":"2.2 \u4e3b\u5e93\u914d\u7f6e","text":"<pre><code># /var/lib/pgsql/15/data/postgresql.conf\nlisten_addresses = '*'\nport = 5432\nmax_connections = 200\nshared_buffers = 4GB\nwal_level = replica\nmax_wal_senders = 10\nmax_replication_slots = 10\nwal_keep_size = 1GB\nhot_standby = on\narchive_mode = on\narchive_command = 'test ! -f /var/lib/pgsql/15/archive/%f &amp;&amp; cp %p /var/lib/pgsql/15/archive/%f'\n</code></pre> <pre><code># /var/lib/pgsql/15/data/pg_hba.conf\n# \u5141\u8bb8\u590d\u5236\u8fde\u63a5\nhost    replication     replicator      192.168.1.0/24          scram-sha-256\nhost    all             all             192.168.1.0/24          scram-sha-256\n</code></pre> <pre><code>-- \u521b\u5efa\u590d\u5236\u7528\u6237\nCREATE USER replicator WITH REPLICATION ENCRYPTED PASSWORD 'Repl123#';\n\n-- \u521b\u5efa\u590d\u5236\u69fd\uff08\u53ef\u9009\uff0c\u63a8\u8350\uff09\nSELECT * FROM pg_create_physical_replication_slot('slave1_slot');\nSELECT * FROM pg_create_physical_replication_slot('slave2_slot');\n\n-- \u91cd\u542f PostgreSQL\nsystemctl restart postgresql-15\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#23","title":"2.3 \u4ece\u5e93\u914d\u7f6e\uff08\u57fa\u7840\u5907\u4efd\uff09","text":"<pre><code># \u5728\u4ece\u5e93\u8282\u70b9\u6267\u884c\nsystemctl stop postgresql-15\nrm -rf /var/lib/pgsql/15/data/*\n\n# \u4f7f\u7528 pg_basebackup \u521b\u5efa\u57fa\u7840\u5907\u4efd\npg_basebackup -h 192.168.1.10 -U replicator -D /var/lib/pgsql/15/data \\\n  -Fp -Xs -P -R -S slave1_slot\n\n# -R \u53c2\u6570\u4f1a\u81ea\u52a8\u521b\u5efa standby.signal \u548c\u914d\u7f6e primary_conninfo\n\n# \u68c0\u67e5\u751f\u6210\u7684\u914d\u7f6e\ncat /var/lib/pgsql/15/data/postgresql.auto.conf\n# primary_conninfo = 'host=192.168.1.10 port=5432 user=replicator password=Repl123#'\n# primary_slot_name = 'slave1_slot'\n\n# \u542f\u52a8\u4ece\u5e93\nsystemctl start postgresql-15\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#24","title":"2.4 \u9a8c\u8bc1\u590d\u5236\u72b6\u6001","text":"<pre><code>-- \u4e3b\u5e93\u67e5\u770b\u590d\u5236\u72b6\u6001\nSELECT \n    client_addr,\n    state,\n    sync_state,\n    replay_lag,\n    write_lag,\n    flush_lag\nFROM pg_stat_replication;\n\n-- \u8f93\u51fa\u793a\u4f8b\uff1a\n-- client_addr   | state     | sync_state | replay_lag | write_lag | flush_lag\n-- 192.168.1.11  | streaming | async      | 00:00:00   | 00:00:00  | 00:00:00\n-- 192.168.1.12  | streaming | async      | 00:00:00   | 00:00:00  | 00:00:00\n\n-- \u4ece\u5e93\u67e5\u770b\u590d\u5236\u5ef6\u8fdf\nSELECT \n    now() - pg_last_xact_replay_timestamp() AS replication_delay;\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#3","title":"3. \u540c\u6b65\u590d\u5236\u914d\u7f6e","text":""},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#31","title":"3.1 \u542f\u7528\u540c\u6b65\u590d\u5236","text":"<pre><code># \u4e3b\u5e93 postgresql.conf\nsynchronous_commit = on\nsynchronous_standby_names = 'FIRST 1 (slave1_slot, slave2_slot)'\n# FIRST 1: \u81f3\u5c111\u4e2a\u4ece\u5e93\u786e\u8ba4\n# ANY 1: \u4efb\u610f1\u4e2a\u4ece\u5e93\u786e\u8ba4\n# slave1_slot, slave2_slot: \u4f18\u5148\u7ea7\u987a\u5e8f\n</code></pre> <pre><code>-- \u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\nSELECT pg_reload_conf();\n\n-- \u9a8c\u8bc1\u540c\u6b65\u72b6\u6001\nSELECT \n    application_name,\n    sync_state,\n    sync_priority\nFROM pg_stat_replication;\n\n-- sync_state: sync\uff08\u540c\u6b65\uff09, potential\uff08\u5019\u9009\uff09, async\uff08\u5f02\u6b65\uff09\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#32","title":"3.2 \u540c\u6b65\u590d\u5236\u76d1\u63a7","text":"<pre><code>-- \u68c0\u67e5\u540c\u6b65\u590d\u5236\u7b49\u5f85\nSELECT \n    pid,\n    usename,\n    application_name,\n    client_addr,\n    state,\n    sync_state,\n    wait_event_type,\n    wait_event\nFROM pg_stat_replication\nWHERE sync_state = 'sync';\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#4-patroni","title":"4. Patroni \u9ad8\u53ef\u7528\u96c6\u7fa4\u90e8\u7f72","text":""},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#41","title":"4.1 \u67b6\u6784\u8bbe\u8ba1","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   HAProxy (VIP)                 \u2502\n\u2502              192.168.1.100:5000                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502               \u2502               \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Patroni Node1\u2502 \u2502Patroni Node2\u2502 \u2502Patroni Node3\u2502\n\u2502 PG Master    \u2502 \u2502 PG Replica  \u2502 \u2502 PG Replica  \u2502\n\u2502 192.168.1.10 \u2502 \u2502192.168.1.11 \u2502 \u2502192.168.1.12 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502                \u2502               \u2502\n       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502\n                \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                \u2502  etcd Cluster  \u2502\n                \u2502  (3 nodes)     \u2502\n                \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#42-etcd","title":"4.2 \u5b89\u88c5 etcd \u96c6\u7fa4","text":"<pre><code># \u5728\u6240\u6709\u8282\u70b9\u5b89\u88c5 etcd\nyum install -y etcd\n\n# \u8282\u70b91\u914d\u7f6e /etc/etcd/etcd.conf\nETCD_NAME=etcd1\nETCD_DATA_DIR=\"/var/lib/etcd/default.etcd\"\nETCD_LISTEN_PEER_URLS=\"http://192.168.1.10:2380\"\nETCD_LISTEN_CLIENT_URLS=\"http://192.168.1.10:2379,http://127.0.0.1:2379\"\nETCD_INITIAL_ADVERTISE_PEER_URLS=\"http://192.168.1.10:2380\"\nETCD_ADVERTISE_CLIENT_URLS=\"http://192.168.1.10:2379\"\nETCD_INITIAL_CLUSTER=\"etcd1=http://192.168.1.10:2380,etcd2=http://192.168.1.11:2380,etcd3=http://192.168.1.12:2380\"\nETCD_INITIAL_CLUSTER_STATE=\"new\"\nETCD_INITIAL_CLUSTER_TOKEN=\"etcd-cluster\"\n\n# \u542f\u52a8 etcd\uff08\u6240\u6709\u8282\u70b9\uff09\nsystemctl enable etcd\nsystemctl start etcd\n\n# \u9a8c\u8bc1\u96c6\u7fa4\netcdctl member list\netcdctl cluster-health\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#43-patroni","title":"4.3 \u5b89\u88c5 Patroni","text":"<pre><code># \u6240\u6709\u8282\u70b9\u5b89\u88c5 Patroni\npip3 install patroni[etcd] psycopg2-binary\n\n# \u521b\u5efa\u914d\u7f6e\u76ee\u5f55\nmkdir -p /etc/patroni\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#44-patroni","title":"4.4 Patroni \u914d\u7f6e","text":"<pre><code># /etc/patroni/patroni.yml (\u8282\u70b91 - Master)\nscope: postgres-cluster\nnamespace: /db/\nname: pg-node1\n\nrestapi:\n  listen: 192.168.1.10:8008\n  connect_address: 192.168.1.10:8008\n\netcd:\n  hosts: 192.168.1.10:2379,192.168.1.11:2379,192.168.1.12:2379\n\nbootstrap:\n  dcs:\n    ttl: 30\n    loop_wait: 10\n    retry_timeout: 10\n    maximum_lag_on_failover: 1048576\n    postgresql:\n      use_pg_rewind: true\n      parameters:\n        max_connections: 200\n        shared_buffers: 4GB\n        wal_level: replica\n        hot_standby: on\n        max_wal_senders: 10\n        max_replication_slots: 10\n        wal_keep_size: 1GB\n\n  initdb:\n    - encoding: UTF8\n    - data-checksums\n\n  pg_hba:\n    - host replication replicator 192.168.1.0/24 scram-sha-256\n    - host all all 192.168.1.0/24 scram-sha-256\n\n  users:\n    admin:\n      password: Admin123#\n      options:\n        - createrole\n        - createdb\n    replicator:\n      password: Repl123#\n      options:\n        - replication\n\npostgresql:\n  listen: 192.168.1.10:5432\n  connect_address: 192.168.1.10:5432\n  data_dir: /var/lib/pgsql/15/data\n  bin_dir: /usr/pgsql-15/bin\n  pgpass: /tmp/pgpass\n  authentication:\n    replication:\n      username: replicator\n      password: Repl123#\n    superuser:\n      username: postgres\n      password: Postgres123#\n  parameters:\n    unix_socket_directories: '/var/run/postgresql'\n\ntags:\n  nofailover: false\n  noloadbalance: false\n  clonefrom: false\n  nosync: false\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#45-patroni","title":"4.5 \u542f\u52a8 Patroni","text":"<pre><code># \u521b\u5efa systemd \u670d\u52a1\ncat &gt; /etc/systemd/system/patroni.service &lt;&lt;EOF\n[Unit]\nDescription=Patroni PostgreSQL HA\nAfter=syslog.target network.target\n\n[Service]\nType=simple\nUser=postgres\nGroup=postgres\nExecStart=/usr/local/bin/patroni /etc/patroni/patroni.yml\nExecReload=/bin/kill -HUP \\$MAINPID\nKillMode=process\nTimeoutSec=30\nRestart=no\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\n# \u542f\u52a8 Patroni\uff08\u5148\u542f\u52a8\u8282\u70b91\uff0c\u518d\u542f\u52a8\u5176\u4ed6\u8282\u70b9\uff09\nsystemctl daemon-reload\nsystemctl enable patroni\nsystemctl start patroni\n\n# \u68c0\u67e5\u96c6\u7fa4\u72b6\u6001\npatronictl -c /etc/patroni/patroni.yml list\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\n# + Cluster: postgres-cluster (7123456789012345678) -----+----+-----------+\n# | Member   | Host         | Role    | State   | TL | Lag in MB |\n# +----------+--------------+---------+---------+----+-----------+\n# | pg-node1 | 192.168.1.10 | Leader  | running |  1 |           |\n# | pg-node2 | 192.168.1.11 | Replica | running |  1 |         0 |\n# | pg-node3 | 192.168.1.12 | Replica | running |  1 |         0 |\n# +----------+--------------+---------+---------+----+-----------+\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#5-haproxy","title":"5. HAProxy \u8d1f\u8f7d\u5747\u8861","text":""},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#51-haproxy","title":"5.1 \u5b89\u88c5 HAProxy","text":"<pre><code>yum install -y haproxy\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#52-haproxy","title":"5.2 \u914d\u7f6e HAProxy","text":"<pre><code># /etc/haproxy/haproxy.cfg\nglobal\n    maxconn 100\n\ndefaults\n    log global\n    mode tcp\n    retries 2\n    timeout client 30m\n    timeout connect 4s\n    timeout server 30m\n    timeout check 5s\n\nlisten stats\n    mode http\n    bind *:7000\n    stats enable\n    stats uri /\n\nlisten postgres_write\n    bind *:5000\n    option httpchk\n    http-check expect status 200\n    default-server inter 3s fall 3 rise 2 on-marked-down shutdown-sessions\n    server pg-node1 192.168.1.10:5432 maxconn 100 check port 8008\n    server pg-node2 192.168.1.11:5432 maxconn 100 check port 8008\n    server pg-node3 192.168.1.12:5432 maxconn 100 check port 8008\n\nlisten postgres_read\n    bind *:5001\n    option httpchk GET /replica\n    http-check expect status 200\n    default-server inter 3s fall 3 rise 2 on-marked-down shutdown-sessions\n    server pg-node1 192.168.1.10:5432 maxconn 100 check port 8008\n    server pg-node2 192.168.1.11:5432 maxconn 100 check port 8008\n    server pg-node3 192.168.1.12:5432 maxconn 100 check port 8008\n</code></pre> <pre><code># \u542f\u52a8 HAProxy\nsystemctl enable haproxy\nsystemctl start haproxy\n\n# \u6d4b\u8bd5\u8fde\u63a5\npsql -h 192.168.1.100 -p 5000 -U admin -d postgres  # \u5199\u5165\npsql -h 192.168.1.100 -p 5001 -U admin -d postgres  # \u53ea\u8bfb\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#6","title":"6. \u6545\u969c\u5207\u6362\u4e0e\u7ba1\u7406","text":""},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#61","title":"6.1 \u624b\u52a8\u5207\u6362\u4e3b\u5e93","text":"<pre><code># \u67e5\u770b\u5f53\u524d\u96c6\u7fa4\u72b6\u6001\npatronictl -c /etc/patroni/patroni.yml list\n\n# \u624b\u52a8\u5207\u6362\u4e3b\u5e93\u5230 pg-node2\npatronictl -c /etc/patroni/patroni.yml switchover --master pg-node1 --candidate pg-node2\n\n# \u8ba1\u5212\u5185\u7ef4\u62a4\uff08\u6682\u505c\u81ea\u52a8\u5207\u6362\uff09\npatronictl -c /etc/patroni/patroni.yml pause\n\n# \u6062\u590d\u81ea\u52a8\u5207\u6362\npatronictl -c /etc/patroni/patroni.yml resume\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#62","title":"6.2 \u6545\u969c\u6a21\u62df\u4e0e\u6062\u590d","text":"<pre><code># \u6a21\u62df\u4e3b\u5e93\u6545\u969c\nsystemctl stop patroni  # \u5728\u4e3b\u5e93\u8282\u70b9\u6267\u884c\n\n# Patroni \u4f1a\u81ea\u52a8\uff1a\n# 1. \u68c0\u6d4b\u4e3b\u5e93\u6545\u969c\uff08TTL \u8d85\u65f6\uff09\n# 2. \u9009\u4e3e\u65b0\u4e3b\u5e93\uff08\u6700\u5c0f\u5ef6\u8fdf\u7684\u4ece\u5e93\uff09\n# 3. \u63d0\u5347\u65b0\u4e3b\u5e93\n# 4. \u91cd\u65b0\u914d\u7f6e\u5176\u4ed6\u4ece\u5e93\n\n# \u6062\u590d\u6545\u969c\u8282\u70b9\nsystemctl start patroni\n# Patroni \u4f1a\u81ea\u52a8\u5c06\u5176\u52a0\u5165\u4e3a\u4ece\u5e93\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#63-patroni","title":"6.3 \u76d1\u63a7 Patroni","text":"<pre><code># REST API \u76d1\u63a7\ncurl http://192.168.1.10:8008/\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\n# {\"state\":\"running\",\"postmaster_start_time\":\"2025-11-11 10:00:00\",\"role\":\"master\",\"server_version\":150000,\"cluster_unlocked\":false,\"xlog\":{\"location\":67108864},\"timeline\":1,\"database_system_identifier\":\"7123456789012345678\",\"patroni\":{\"version\":\"3.0.2\",\"scope\":\"postgres-cluster\"}}\n\n# \u68c0\u67e5\u4e3b\u5e93\ncurl http://192.168.1.10:8008/master\n# HTTP 200: \u662f\u4e3b\u5e93\n# HTTP 503: \u4e0d\u662f\u4e3b\u5e93\n\n# \u68c0\u67e5\u4ece\u5e93\ncurl http://192.168.1.11:8008/replica\n# HTTP 200: \u662f\u4ece\u5e93\n# HTTP 503: \u4e0d\u662f\u4ece\u5e93\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#7","title":"7. \u903b\u8f91\u590d\u5236\uff08\u8de8\u7248\u672c/\u90e8\u5206\u8868\uff09","text":""},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#71","title":"7.1 \u53d1\u5e03\u7aef\u914d\u7f6e","text":"<pre><code>-- PostgreSQL 14+ (\u53d1\u5e03\u7aef)\n-- \u4fee\u6539 wal_level\nALTER SYSTEM SET wal_level = logical;\nSELECT pg_reload_conf();\n\n-- \u521b\u5efa\u53d1\u5e03\nCREATE PUBLICATION my_publication FOR TABLE users, orders;\n\n-- \u6216\u53d1\u5e03\u6240\u6709\u8868\nCREATE PUBLICATION all_tables FOR ALL TABLES;\n\n-- \u67e5\u770b\u53d1\u5e03\nSELECT * FROM pg_publication;\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#72","title":"7.2 \u8ba2\u9605\u7aef\u914d\u7f6e","text":"<pre><code>-- PostgreSQL 14+ (\u8ba2\u9605\u7aef)\n-- \u521b\u5efa\u8ba2\u9605\nCREATE SUBSCRIPTION my_subscription\n    CONNECTION 'host=192.168.1.10 port=5432 user=replicator password=Repl123# dbname=mydb'\n    PUBLICATION my_publication;\n\n-- \u67e5\u770b\u8ba2\u9605\u72b6\u6001\nSELECT * FROM pg_stat_subscription;\n\n-- \u7981\u7528/\u542f\u7528\u8ba2\u9605\nALTER SUBSCRIPTION my_subscription DISABLE;\nALTER SUBSCRIPTION my_subscription ENABLE;\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#8","title":"8. \u6027\u80fd\u4f18\u5316","text":""},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#81","title":"8.1 \u590d\u5236\u6027\u80fd\u8c03\u4f18","text":"<pre><code># postgresql.conf\nwal_compression = on\nwal_buffers = 16MB\nmax_wal_size = 4GB\nmin_wal_size = 1GB\ncheckpoint_completion_target = 0.9\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#82","title":"8.2 \u76d1\u63a7\u590d\u5236\u5ef6\u8fdf","text":"<pre><code>-- \u4e3b\u5e93\u76d1\u63a7\nSELECT \n    client_addr,\n    application_name,\n    state,\n    sync_state,\n    pg_wal_lsn_diff(pg_current_wal_lsn(), replay_lsn) AS lag_bytes,\n    write_lag,\n    flush_lag,\n    replay_lag\nFROM pg_stat_replication;\n\n-- \u4ece\u5e93\u76d1\u63a7\nSELECT \n    pg_is_in_recovery() AS is_replica,\n    pg_last_wal_receive_lsn() AS receive_lsn,\n    pg_last_wal_replay_lsn() AS replay_lsn,\n    pg_wal_lsn_diff(pg_last_wal_receive_lsn(), pg_last_wal_replay_lsn()) AS lag_bytes;\n</code></pre>"},{"location":"dba/PostgreSQL-%E6%B5%81%E5%A4%8D%E5%88%B6%E4%B8%8EPatroni%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#9","title":"9. \u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u4f7f\u7528\u590d\u5236\u69fd\uff1a\u9632\u6b62\u4e3b\u5e93\u5220\u9664\u4ece\u5e93\u672a\u63a5\u6536\u7684 WAL</li> <li>\u542f\u7528\u5f52\u6863\uff1a\u652f\u6301 PITR \u548c\u707e\u96be\u6062\u590d</li> <li>\u76d1\u63a7\u5ef6\u8fdf\uff1a\u590d\u5236\u5ef6\u8fdf &gt; 10s \u544a\u8b66</li> <li>\u5b9a\u671f\u6f14\u7ec3\uff1a\u6bcf\u5b63\u5ea6\u8fdb\u884c\u6545\u969c\u5207\u6362\u6f14\u7ec3</li> <li>\u5907\u4efd\u7b56\u7565\uff1a</li> <li>\u4e3b\u5e93\uff1apg_basebackup + WAL \u5f52\u6863</li> <li>\u4ece\u5e93\uff1a\u53ef\u7528\u4e8e\u5907\u4efd\uff0c\u51cf\u8f7b\u4e3b\u5e93\u538b\u529b</li> <li>\u53c2\u6570\u4f18\u5316\uff1a</li> <li><code>synchronous_commit = on</code>\uff08\u91d1\u878d\u4e1a\u52a1\uff09</li> <li><code>wal_keep_size = 1GB</code></li> <li><code>max_wal_senders = 10</code></li> <li>\u7f51\u7edc\u4f18\u5316\uff1a\u4e3b\u4ece\u4e4b\u95f4\u4f7f\u7528\u4e13\u7528\u7f51\u7edc</li> </ol> <p>\u53c2\u8003\u6587\u6863\uff1a - PostgreSQL 15 Replication Documentation - Patroni Documentation - etcd Documentation - HAProxy Configuration Manual</p>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html","title":"SQL Server \u5e38\u89c1\u8fd0\u7ef4\u5178\u578b\u95ee\u9898\u793a\u4f8b\u53ca\u89e3\u6790","text":"<p>\u6c47\u603b\u751f\u4ea7\u73af\u5883\u4e2d\u9ad8\u9891\u51fa\u73b0\u7684\u5178\u578b\u95ee\u9898\u3001\u5b9a\u4f4d\u601d\u8def\u4e0e\u89e3\u51b3\u5efa\u8bae\uff0c\u4fbf\u4e8e\u5feb\u901f\u54cd\u5e94\u4e0e\u77e5\u8bc6\u6c89\u6dc0\u3002</p>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#1","title":"1. \u8fde\u63a5\u5931\u8d25/\u8d85\u65f6","text":"<ul> <li>\u75c7\u72b6\uff1a\u5e94\u7528\u8d85\u65f6\u3001\u5076\u53d1\u65ad\u8fde</li> <li>\u6392\u67e5\uff1a</li> <li>\u7f51\u7edc\u4e0e\u7aef\u53e3\uff1a<code>telnet &lt;host&gt; 1433</code> / \u9632\u706b\u5899\u89c4\u5219</li> <li>\u7aef\u70b9\uff1aSQL Browser\u3001\u4fa6\u542c\u5668\uff08AG\uff09\u89e3\u6790\u662f\u5426\u6b63\u786e</li> <li>\u8ba4\u8bc1\uff1aAD/Kerberos/\u53cc\u673a\u5207\u6362\u540e\u7684 SPN \u662f\u5426\u6b63\u786e</li> <li>\u5efa\u8bae\uff1a\u56fa\u5b9a\u8fde\u63a5\u5b57\u7b26\u4e32\uff08\u542b MultiSubnetFailover\uff09\u3001\u542f\u7528\u8fde\u63a5\u91cd\u8bd5</li> </ul>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#2","title":"2. \u9501\u4e0e\u963b\u585e","text":"<ul> <li>\u75c7\u72b6\uff1aCPU \u4f4e\u4f46\u8bf7\u6c42\u7b49\u5f85\u3001\u54cd\u5e94\u6162</li> <li>\u6392\u67e5\uff1a</li> <li>\u7b49\u5f85\u7edf\u8ba1\uff1a<code>sys.dm_os_wait_stats</code></li> <li>\u6d3b\u52a8\u4f1a\u8bdd\uff1a<code>sys.dm_exec_requests</code>\u3001<code>sys.dm_tran_locks</code></li> <li>\u8bed\u53e5\u6587\u672c\uff1a<code>sys.dm_exec_sql_text()</code></li> <li>\u793a\u4f8b\uff1a</li> </ul> <pre><code>SELECT r.session_id, r.status, r.wait_type, r.blocking_session_id,\n       t.text\nFROM sys.dm_exec_requests r\nCROSS APPLY sys.dm_exec_sql_text(r.sql_handle) t\nWHERE r.session_id &lt;&gt; @@SPID;\n</code></pre> <ul> <li>\u5efa\u8bae\uff1a\u5408\u7406\u4e8b\u52a1\u7c92\u5ea6\u4e0e\u9694\u79bb\u7ea7\u522b\uff1b\u70ed\u70b9\u8868\u52a0\u7d22\u5f15/\u884c\u7248\u672c\u63a7\u5236\uff08RCSI\uff09</li> </ul>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#3-tempdb","title":"3. TempDB \u538b\u529b","text":"<ul> <li>\u75c7\u72b6\uff1a\u5199\u5ef6\u8fdf\u9ad8\u3001\u7a7a\u95f4\u66b4\u6da8</li> <li>\u6392\u67e5\uff1a\u6587\u4ef6\u6570\u91cf\u3001\u6269\u5c55\u6b21\u6570\u3001\u5206\u914d\u4e89\u7528\uff08PFS/SGAM\uff09</li> <li>\u5efa\u8bae\uff1a\u6309 CPU \u6838\u6570\u8bbe\u5b9a\u6570\u636e\u6587\u4ef6\u6570\u91cf\uff08\u4e0a\u9650 8\uff5e16\uff09\u3001\u9884\u5206\u914d\u3001\u542f\u7528 TF 1117/1118\uff08\u65e7\u7248\u672c\uff09</li> </ul>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#4","title":"4. \u65e5\u5fd7\u6587\u4ef6\u6301\u7eed\u589e\u957f","text":"<ul> <li>\u6392\u67e5\uff1a\u957f\u4e8b\u52a1/\u672a\u5907\u4efd\u65e5\u5fd7\uff1b<code>log_reuse_wait_desc</code></li> <li>\u5efa\u8bae\uff1a\u53ca\u65f6\u65e5\u5fd7\u5907\u4efd\uff1b\u6e05\u7406\u957f\u4e8b\u52a1\uff1b\u5408\u7406\u6062\u590d\u6a21\u5f0f</li> </ul>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#5","title":"5. \u6027\u80fd\u56de\u9000/\u67e5\u8be2\u53d8\u6162","text":"<ul> <li>\u6392\u67e5\uff1a\u6267\u884c\u8ba1\u5212\u53d8\u5316\u3001\u7edf\u8ba1\u4fe1\u606f\u8fc7\u671f\u3001\u53c2\u6570\u55c5\u63a2</li> <li>\u5efa\u8bae\uff1a\u66f4\u65b0\u7edf\u8ba1\u4fe1\u606f\uff1b\u53c2\u6570\u5316\u7b56\u7565\uff1bPlan Guide/Query Store \u56fa\u5b9a\u8ba1\u5212</li> </ul>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#6","title":"6. \u6b7b\u9501","text":"<ul> <li>\u6392\u67e5\uff1a\u6269\u5c55\u4e8b\u4ef6\u6293\u53d6 deadlock graph\uff1b\u5b9a\u4f4d\u51b2\u7a81\u5bf9\u8c61\u4e0e\u987a\u5e8f</li> <li>\u5efa\u8bae\uff1a\u7edf\u4e00\u8bbf\u95ee\u987a\u5e8f\uff1b\u62c6\u5206\u4e8b\u52a1\uff1b\u7ec6\u5316\u9501\u7c92\u5ea6</li> </ul>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#7-agent","title":"7. Agent \u4f5c\u4e1a\u5931\u8d25","text":"<ul> <li>\u6392\u67e5\uff1a\u5386\u53f2\u65e5\u5fd7\u3001\u4ee3\u7406\u8d26\u6237\u6743\u9650\u3001\u4f9d\u8d56\u7f51\u7edc/\u5171\u4eab\u8d44\u6e90\u53ef\u7528\u6027</li> <li>\u5efa\u8bae\uff1a\u5931\u8d25\u544a\u8b66\u3001\u91cd\u8bd5\u7b56\u7565\u3001\u5c06\u811a\u672c\u7eb3\u5165\u6e90\u7801\u7ba1\u7406</li> </ul>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#8","title":"8. \u9ad8\u53ef\u7528\u76f8\u5173","text":"<ul> <li>AG \u540c\u6b65\u5ef6\u8fdf\uff1a\u68c0\u67e5\u7f51\u7edc\u4e0e\u4e8b\u52a1\u65e5\u5fd7\u541e\u5410\uff1b\u53ea\u8bfb\u8def\u7531\u662f\u5426\u5408\u7406</li> <li>FCI \u6f02\u79fb\uff1a\u5fc3\u8df3\u7f51\u7edc\u4e0e\u4ef2\u88c1\uff1b\u5b58\u50a8\u53ef\u7528\u6027</li> </ul>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#9","title":"9. \u5907\u4efd/\u8fd8\u539f\u95ee\u9898","text":"<ul> <li>\u5907\u4efd\u94fe\u4e2d\u65ad\u3001\u6821\u9a8c\u5931\u8d25\u3001\u538b\u7f29\u6bd4\u5f02\u5e38</li> <li>\u5efa\u8bae\uff1a<code>RESTORE VERIFYONLY</code>\u3001\u9694\u79bb\u6d4b\u8bd5\u8fd8\u539f\u3001\u5b9a\u671f\u6f14\u7ec3</li> </ul>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#dmv","title":"\u9644\uff1a\u5e38\u7528\u89c6\u56fe/DMV \u901f\u67e5","text":"<ul> <li>\u4f1a\u8bdd/\u8bf7\u6c42\uff1a<code>sys.dm_exec_sessions</code>\u3001<code>sys.dm_exec_requests</code></li> <li>\u7b49\u5f85\uff1a<code>sys.dm_os_wait_stats</code></li> <li>IO\uff1a<code>sys.dm_io_virtual_file_stats</code></li> <li>\u7d22\u5f15\uff1a<code>sys.dm_db_index_usage_stats</code>\u3001<code>sys.dm_db_index_physical_stats</code></li> </ul>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#_1","title":"\u8be6\u7ec6\u89e3\u51b3\u65b9\u6848\uff08\u9010\u9879\u843d\u5730\uff09","text":""},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#1-networkdnskerberos","title":"1. \u8fde\u63a5\u5931\u8d25/\u8d85\u65f6\uff08Network/DNS/Kerberos\uff09","text":"<ul> <li>\u8bca\u65ad\uff1a</li> </ul> <pre><code>Test-NetConnection server.contoso.com -Port 1433\nResolve-DnsName server.contoso.com\n</code></pre> <ul> <li>\u9632\u706b\u5899\u653e\u901a\uff1a</li> </ul> <pre><code>netsh advfirewall firewall add rule name=\"SQL TCP 1433\" dir=in action=allow protocol=TCP localport=1433\n</code></pre> <ul> <li>Kerberos/SPN\uff1a</li> </ul> <pre><code>setspn -L CONTOSO\\svc_sql\nsetspn -S MSSQLSvc/server.contoso.com:1433 CONTOSO\\svc_sql\nklist purge -li 0x3e7   # \u6e05\u7cfb\u7edf Kerberos \u7f13\u5b58\uff08\u7ba1\u7406\u5458\uff09\n</code></pre> <ul> <li>\u8fde\u63a5\u5b57\u7b26\u4e32\uff1a\u5728\u591a\u5b50\u7f51 AG \u4f7f\u7528 <code>MultiSubnetFailover=True</code>\uff0c\u5e76\u542f\u7528\u5ba2\u6237\u7aef\u91cd\u8bd5\u3002</li> </ul>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#2_1","title":"2. \u9501\u4e0e\u963b\u585e\uff08\u5feb\u901f\u6b62\u8840\u2192\u6839\u6cbb\uff09","text":"<ul> <li>\u5feb\u901f\u5b9a\u4f4d\u963b\u585e\u94fe\uff1a</li> </ul> <pre><code>SELECT r.session_id, r.blocking_session_id, r.wait_type, t.text\nFROM sys.dm_exec_requests r\nCROSS APPLY sys.dm_exec_sql_text(r.sql_handle) t\nWHERE r.session_id &lt;&gt; @@SPID AND (r.blocking_session_id &lt;&gt; 0 OR r.wait_type IS NOT NULL);\n</code></pre> <ul> <li>\u4e34\u65f6\u6b62\u8840\uff1a\u4e0e\u4e1a\u52a1\u786e\u8ba4\u540e <code>KILL &lt;spid&gt;</code>\uff08\u8c28\u614e\uff09\u3002</li> <li>\u6839\u6cbb\uff1a\u7ec6\u5316\u7d22\u5f15\u3001\u62c6\u5206\u4e8b\u52a1\uff1b\u5982\u8bfb\u591a\u5199\u5c11\uff0c\u5f00\u542f\u884c\u7248\u672c\u63a7\u5236\uff1a</li> </ul> <pre><code>ALTER DATABASE [DB] SET READ_COMMITTED_SNAPSHOT ON WITH ROLLBACK IMMEDIATE;\n</code></pre>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#3-tempdb_1","title":"3. TempDB \u538b\u529b","text":"<ul> <li>\u589e\u52a0\u6570\u636e\u6587\u4ef6\u5e76\u9884\u5206\u914d\uff1a</li> </ul> <pre><code>ALTER DATABASE tempdb ADD FILE (NAME=N'tempdev2', FILENAME='E:\\\\TempDB\\\\tempdb2.ndf', SIZE=8GB, FILEGROWTH=1024MB);\n-- \u6309 CPU \u6838\u5fc3\u6570\u914d\u7f6e\uff0c\u901a\u5e38\u4e0a\u9650 8~16 \u4e2a\u6587\u4ef6\n</code></pre> <ul> <li>\u65e7\u7248\u672c\uff08&lt;2016\uff09\u53ef\u8003\u8651 TF 1117/1118\uff1b\u65b0\u7248\u672c\u4e0d\u5fc5\u3002</li> </ul>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#4_1","title":"4. \u4e8b\u52a1\u65e5\u5fd7\u6301\u7eed\u589e\u957f","text":"<ul> <li>\u5224\u65ad\u539f\u56e0\uff1a</li> </ul> <pre><code>SELECT name, recovery_model_desc, log_reuse_wait_desc FROM sys.databases WHERE name=N'DB';\nDBCC OPENTRAN('DB');\n</code></pre> <ul> <li>\u5904\u7406\uff1a</li> </ul> <pre><code>BACKUP LOG [DB] TO DISK='X:\\\\Backup\\\\DB_log.trn' WITH INIT, COMPRESSION;\n-- \u5982\u7a7a\u95f4\u7d27\u6025\u4e14\u975e\u751f\u4ea7\u5efa\u8bae\uff0c\u8c28\u614e\u6536\u7f29\uff1a\nDBCC SHRINKFILE (N'DB_log', 2048);\n</code></pre>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#5_1","title":"5. \u6027\u80fd\u56de\u9000/\u67e5\u8be2\u53d8\u6162\uff08\u8ba1\u5212\u56de\u9000\uff09","text":"<ul> <li>\u66f4\u65b0\u7edf\u8ba1\u4fe1\u606f\uff1a</li> </ul> <pre><code>EXEC sp_updatestats;\n-- \u5173\u952e\u8868\uff1aUPDATE STATISTICS dbo.T WITH FULLSCAN;\n</code></pre> <ul> <li>\u542f\u7528\u5e76\u4f7f\u7528 Query Store \u5f3a\u5236\u8ba1\u5212\uff1a</li> </ul> <pre><code>ALTER DATABASE [DB] SET QUERY_STORE = ON;\n-- \u5728\u5df2\u786e\u8ba4\u7684\u8ba1\u5212\u4e0a\u6267\u884c\u5f3a\u5236\uff1aUI \u6216\n-- EXEC sp_query_store_force_plan @query_id, @plan_id;\n</code></pre>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#6_1","title":"6. \u6b7b\u9501","text":"<ul> <li>\u542f\u7528\u6269\u5c55\u4e8b\u4ef6\u6355\u83b7\uff1a</li> </ul> <pre><code>CREATE EVENT SESSION [deadlock] ON SERVER\nADD EVENT sqlserver.xml_deadlock_report\nADD TARGET package0.event_file(SET filename=N'C:\\\\XEs\\\\deadlocks.xel');\nALTER EVENT SESSION [deadlock] ON SERVER STATE = START;\n</code></pre> <ul> <li>\u4f18\u5316\uff1a\u7edf\u4e00\u5bf9\u8c61\u8bbf\u95ee\u987a\u5e8f\uff1b\u5fc5\u8981\u65f6\u5206\u5e93\u5206\u8868\u3001\u964d\u4e8b\u52a1\u7c92\u5ea6\u3002</li> </ul>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#7-agent_1","title":"7. Agent \u4f5c\u4e1a\u5931\u8d25","text":"<ul> <li>\u81ea\u68c0\u4e0e\u91cd\u8bd5\uff1a</li> </ul> <pre><code>EXEC msdb.dbo.sp_help_job @job_name=N'JobX';\nEXEC msdb.dbo.sp_update_job @job_name=N'JobX', @retry_attempts=3, @retry_interval=5;\n</code></pre> <ul> <li>\u4ee3\u7406\u51ed\u636e/\u4ee3\u7406\u8d26\u6237\uff08\u9700\u8981\u6700\u5c0f\u6743\u9650\u5e76\u6821\u9a8c\u7f51\u7edc\u5171\u4eab\uff09\u3002</li> </ul>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#8-agfci","title":"8. \u9ad8\u53ef\u7528\uff08AG/FCI\uff09","text":"<ul> <li>AG \u5ef6\u8fdf\u5b9a\u4f4d\uff1a</li> </ul> <pre><code>SELECT DB_NAME(database_id) AS db, log_send_queue_size, redo_queue_size, synchronization_state_desc\nFROM sys.dm_hadr_database_replica_states;\n</code></pre> <ul> <li>\u6062\u590d\u6570\u636e\u79fb\u52a8\uff1a</li> </ul> <pre><code>ALTER DATABASE [DB1] SET HADR RESUME;\n</code></pre> <ul> <li>FCI \u6f02\u79fb\uff1a</li> </ul> <pre><code>Get-ClusterGroup \"SQL Server (MSSQLSERVER)\" | Move-ClusterGroup -Node NODE2\nGet-ClusterLog -UseLocalTime -Destination C:\\\\ClusterLogs\n</code></pre>"},{"location":"dba/SQL-Server-%E5%B8%B8%E8%A7%81%E8%BF%90%E7%BB%B4%E5%85%B8%E5%9E%8B%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B%E5%8F%8A%E8%A7%A3%E6%9E%90.html#9_1","title":"9. \u5907\u4efd/\u8fd8\u539f\u95ee\u9898","text":"<pre><code>RESTORE VERIFYONLY FROM DISK='X:\\\\Backup\\\\DB_full.bak';\n-- \u5728\u9694\u79bb\u73af\u5883\u9a8c\u8bc1\u8fd8\u539f\u94fe\u6761\u4e0e STOPAT \u6062\u590d\u70b9\n</code></pre>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html","title":"SQL Server \u6545\u969c\u6392\u67e5","text":"<p>\u63d0\u4f9b\u4e00\u4efd\u201c\u5148\u6807\u51c6\u5316\u64cd\u4f5c\u3001\u540e\u4e13\u9879\u6df1\u5165\u201d\u7684\u6392\u9519\u6d41\u7a0b\uff0c\u8986\u76d6\u8fde\u63a5\u3001\u8d44\u6e90\u3001\u67e5\u8be2\u3001\u5b58\u50a8\u4ee5\u53ca\u9ad8\u53ef\u7528\u7ec4\u4ef6\u3002</p>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#_1","title":"\u4e00\u3001\u5206\u7c7b\u4e0e\u4f18\u5148\u7ea7","text":"<ul> <li>P1\uff1a\u5168\u7ad9\u4e0d\u53ef\u7528/\u6570\u636e\u635f\u574f/RPO \u98ce\u9669</li> <li>P2\uff1a\u6838\u5fc3\u529f\u80fd\u4e0d\u53ef\u7528/\u5927\u9762\u79ef\u6027\u80fd\u4e0b\u964d</li> <li>P3\uff1a\u5c40\u90e8\u5f71\u54cd/\u5355\u79df\u6237\u95ee\u9898</li> </ul>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#_2","title":"\u4e8c\u3001\u901a\u7528\u6392\u67e5\u6d41\u7a0b","text":"<ol> <li>\u73b0\u8c61\u786e\u8ba4\uff1a\u8c01/\u4f55\u65f6/\u8303\u56f4/\u8fd1\u56e0</li> <li>\u5feb\u901f\u6b62\u8840\uff1a\u8bfb\u5199\u5207\u6362\u3001\u9650\u6d41\u3001\u56de\u6eda\u53d8\u66f4</li> <li>\u6307\u6807\u6536\u96c6\uff1aCPU/\u5185\u5b58/IO/\u7f51\u7edc\u3001\u8fde\u63a5\u6570\u3001\u7b49\u5f85\u7c7b\u578b</li> <li>\u5212\u5206\u8fb9\u754c\uff1a\u5e94\u7528/\u7f51\u7edc/\u6570\u636e\u5e93/\u5b58\u50a8</li> <li>\u590d\u76d8\u4e0e\u9884\u9632\uff1a\u6839\u56e0\u3001\u6539\u8fdb\u9879\u3001\u6587\u6863</li> </ol>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#_3","title":"\u4e09\u3001\u5173\u952e\u6307\u6807\u4e0e\u5de5\u5177","text":"<ul> <li>\u7b49\u5f85\u7c7b\u578b\uff1a<code>sys.dm_os_wait_stats</code></li> <li>\u70ed\u70b9\u8bf7\u6c42\uff1a<code>sys.dm_exec_requests</code> + <code>sys.dm_exec_sql_text</code></li> <li>\u8d44\u6e90\u7edf\u8ba1\uff1aPerfMon \u8ba1\u6570\u5668\u3001sp_Blitz \u7cfb\u5217</li> <li>\u8ba1\u5212\u4e0e\u56de\u9000\uff1aQuery Store\u3001\u5f3a\u5236\u8ba1\u5212</li> </ul>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#_4","title":"\u56db\u3001\u5178\u578b\u573a\u666f","text":""},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#1","title":"1. \u8fde\u63a5\u4e0d\u4e0a/\u9891\u7e41\u8d85\u65f6","text":"<ul> <li>\u68c0\u67e5 DNS/Listener \u89e3\u6790\uff1b\u7aef\u53e3/\u9632\u706b\u5899\uff1bSPN/Kerberos</li> <li>\u8fde\u63a5\u5b57\u7b26\u4e32\uff1a<code>MultiSubnetFailover=True</code>\uff08AG \u591a\u5b50\u7f51\uff09</li> </ul>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#2-cpu","title":"2. CPU \u98d9\u9ad8","text":"<ul> <li>\u6293\u70ed\u70b9 SQL\u3001\u67e5\u770b\u6267\u884c\u8ba1\u5212\uff1b\u7edf\u8ba1\u4fe1\u606f\u4e0e\u7d22\u5f15\u7b56\u7565\uff1b\u53c2\u6570\u55c5\u63a2</li> </ul>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#3-io","title":"3. IO \u5ef6\u8fdf\u9ad8/\u65e5\u5fd7\u6253\u6ee1","text":"<ul> <li><code>sys.dm_io_virtual_file_stats</code>\u3001\u5b58\u50a8\u544a\u8b66\uff1b\u957f\u4e8b\u52a1\u4e0e\u6279\u91cf\u5199\u5165\u7a97\u53e3</li> </ul>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#4-tempdb","title":"4. TempDB \u4e89\u7528","text":"<ul> <li>\u591a\u6587\u4ef6\u3001\u9884\u5206\u914d\u3001\u6587\u4ef6\u653e\u7f6e\u4e0e\u76d8\u578b</li> </ul>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#5-ag","title":"5. AG \u540c\u6b65\u5ef6\u8fdf/\u81ea\u52a8\u5207\u6362\u5931\u8d25","text":"<ul> <li>\u7f51\u7edc\u4e0e\u5e26\u5bbd\u3001\u65e5\u5fd7\u751f\u6210\u901f\u7387\u3001\u53ea\u8bfb\u8def\u7531\u914d\u7f6e\uff1bWSFC \u4ef2\u88c1\u4e0e\u5fc3\u8df3</li> </ul>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#_5","title":"\u4e94\u3001\u5e94\u6025\u6e05\u5355\uff08\u793a\u4f8b\uff09","text":"<ul> <li>[ ] \u51c6\u5907\u201c\u53ea\u8bfb\u964d\u7ea7/\u5207\u6362\u201d\u9884\u6848\u4e0e\u6f14\u7ec3\u8bb0\u5f55</li> <li>[ ] \u5173\u952e DMV/\u811a\u672c\u4e00\u952e\u6536\u96c6\u5305</li> <li>[ ] \u5907\u4efd/\u8fd8\u539f\u94fe\u8def\u4e0e\u6f14\u7ec3\u8ba1\u5212</li> <li>[ ] \u53d8\u66f4\u56de\u6eda\u9884\u6848</li> </ul>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#_6","title":"\u9644\u5f55\uff1a\u91c7\u96c6\u811a\u672c\u793a\u4f8b","text":"<pre><code>-- \u7b49\u5f85\u7edf\u8ba1 Top N\nSELECT TOP 20 * FROM sys.dm_os_wait_stats ORDER BY wait_time_ms DESC;\n\n-- \u6d3b\u52a8\u8bf7\u6c42\u4e0e\u8bed\u53e5\nSELECT r.session_id, r.status, r.wait_type, t.text\nFROM sys.dm_exec_requests r\nCROSS APPLY sys.dm_exec_sql_text(r.sql_handle) t\nWHERE r.session_id &lt;&gt; @@SPID;\n</code></pre>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#_7","title":"\u64cd\u4f5c\u624b\u518c\uff08\u53ef\u76f4\u63a5\u6267\u884c/\u6309\u9700\u4fee\u6539\uff09","text":""},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#_8","title":"\u901a\u7528\u4e00\u952e\u91c7\u96c6\uff08\u5e94\u6025\u9996\u9009\uff09","text":"<pre><code>-- CPU/\u7b49\u5f85/\u963b\u585e/\u4f1a\u8bdd/IO \u5173\u952e\u4fe1\u606f\nSELECT TOP 20 * FROM sys.dm_os_wait_stats ORDER BY wait_time_ms DESC;\nSELECT r.session_id, r.status, r.wait_type, r.blocking_session_id, t.text\nFROM sys.dm_exec_requests r\nCROSS APPLY sys.dm_exec_sql_text(r.sql_handle) t\nWHERE r.session_id &lt;&gt; @@SPID;\nSELECT DB_NAME(database_id) AS db, io_stall_read_ms, io_stall_write_ms\nFROM sys.dm_io_virtual_file_stats(NULL, NULL);\n</code></pre>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#_9","title":"\u5178\u578b\u6545\u969c\u6848\u4f8b\u4e0e\u5904\u7406","text":""},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#1-9002","title":"\u6848\u4f8b 1\uff1a\u9519\u8bef 9002\uff08\u4e8b\u52a1\u65e5\u5fd7\u5df2\u6ee1\uff09","text":"<ul> <li>\u73b0\u8c61\uff1a\u6570\u636e\u5e93\u53ef\u8bfb\u4f46\u65e0\u6cd5\u5199\u5165\uff1b\u65e5\u5fd7\u6587\u4ef6\u6025\u5267\u589e\u957f</li> <li>\u5224\u65ad\uff1a</li> </ul> <pre><code>SELECT name, recovery_model_desc, log_reuse_wait_desc FROM sys.databases WHERE name=N'DB';\nDBCC OPENTRAN('DB');\n</code></pre> <ul> <li>\u5904\u7406\u6b65\u9aa4\uff1a</li> </ul> <pre><code>-- 1) \u91ca\u653e\u7a7a\u95f4\u6216\u6269\u5bb9\u78c1\u76d8\n-- 2) \u5907\u4efd\u4e8b\u52a1\u65e5\u5fd7\uff08FULL/BULK_LOGGED \u6a21\u5f0f\uff09\nBACKUP LOG [DB] TO DISK='X:\\\\Backup\\\\DB_log_9002.trn' WITH INIT, COMPRESSION;\n-- 3) \u7f13\u89e3\uff1a\u8c28\u614e\u6536\u7f29\nDBCC SHRINKFILE (N'DB_log', 2048);\n-- 4) \u65e0\u6cd5\u5907\u4efd\u4e14\u7d27\u6025\uff1a\u4e34\u65f6 SIMPLE\uff08\u8c28\u614e\uff09\uff0c\u540e\u5c3d\u5feb\u6539\u56de FULL \u5e76\u505a\u5b8c\u6574\u5907\u4efd\nALTER DATABASE [DB] SET RECOVERY SIMPLE;\nDBCC SHRINKFILE (N'DB_log', 1024);\nALTER DATABASE [DB] SET RECOVERY FULL;\nBACKUP DATABASE [DB] TO DISK='X:\\\\Backup\\\\DB_full_afterSimple.bak' WITH INIT, COMPRESSION;\n</code></pre>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#2sspikerberos","title":"\u6848\u4f8b 2\uff1a\u65e0\u6cd5\u767b\u5f55\uff08SSPI/Kerberos \u5931\u8d25\uff09","text":"<ul> <li>\u73b0\u8c61\uff1aThe target principal name is incorrect / Cannot generate SSPI context</li> <li>\u5904\u7406\uff1a</li> </ul> <pre><code>setspn -L CONTOSO\\svc_sql\nsetspn -S MSSQLSvc/sql.contoso.com:1433 CONTOSO\\svc_sql\nklist purge -li 0x3e7\nRestart-Service MSSQLSERVER\n</code></pre> <ul> <li>\u5e94\u7528\u4fa7\u53ef\u4e34\u65f6\u6539\u7528 <code>TrustServerCertificate=True</code>\uff08\u4ec5\u77ed\u671f\u5e94\u6025\uff09\u3002</li> </ul>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#3ag","title":"\u6848\u4f8b 3\uff1aAG \u540c\u6b65\u5361\u4f4f/\u6570\u636e\u79fb\u52a8\u6682\u505c","text":"<ul> <li>\u5224\u65ad\uff1a</li> </ul> <pre><code>SELECT DB_NAME(database_id) db, synchronization_state_desc, log_send_queue_size, redo_queue_size, is_suspended\nFROM sys.dm_hadr_database_replica_states;\n</code></pre> <ul> <li>\u5904\u7406\uff1a</li> </ul> <pre><code>ALTER AVAILABILITY GROUP [AG1] MODIFY REPLICA ON N'NODE1' WITH (AVAILABILITY_MODE = ASYNCHRONOUS_COMMIT);\nALTER DATABASE [DB1] SET HADR RESUME;\n</code></pre>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#4dbcc-checkdb","title":"\u6848\u4f8b 4\uff1aDBCC CHECKDB \u62a5\u9519\uff08\u9875\u635f\u574f/\u4e00\u81f4\u6027\u95ee\u9898\uff09","text":"<ul> <li>\u4f18\u5148\u6062\u590d\uff1a</li> </ul> <pre><code>RESTORE DATABASE [DB] FROM DISK='X:\\\\Backup\\\\DB_full.bak' WITH NORECOVERY;\nRESTORE LOG [DB] FROM DISK='X:\\\\Backup\\\\DB_log.trn' WITH RECOVERY;\n</code></pre> <ul> <li>\u65e0\u53ef\u7528\u5907\u4efd\uff08\u6700\u540e\u624b\u6bb5\uff09\uff1a</li> </ul> <pre><code>ALTER DATABASE [DB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;\nDBCC CHECKDB('DB', REPAIR_REBUILD);\n-- \u4ecd\u5931\u8d25\u4e14\u786e\u8ba4\u53ef\u63a5\u53d7\u6570\u636e\u4e22\u5931\u98ce\u9669\uff1a\n-- DBCC CHECKDB('DB', REPAIR_ALLOW_DATA_LOSS);\nALTER DATABASE [DB] SET MULTI_USER;\n</code></pre>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#5-tempdb","title":"\u6848\u4f8b 5\uff1a\u78c1\u76d8\u6253\u6ee1\uff08\u542b TempDB\uff09","text":"<ul> <li>\u5904\u7406\uff1a</li> </ul> <pre><code>-- \u79fb\u52a8 TempDB \u5230\u65b0\u76d8\uff08\u9700\u91cd\u542f\u670d\u52a1\u751f\u6548\uff09\nUSE master;\nALTER DATABASE tempdb MODIFY FILE (NAME=N'tempdev', FILENAME='F:\\\\TempDB\\\\tempdb.mdf');\nALTER DATABASE tempdb MODIFY FILE (NAME=N'templog', FILENAME='F:\\\\TempDB\\\\templog.ldf');\n-- \u5207\u6362\u9519\u8bef\u65e5\u5fd7\u6587\u4ef6\uff08\u4e0d\u91ca\u653e\u78c1\u76d8\uff0c\u4f46\u5207\u6362\u5230\u65b0\u6587\u4ef6\uff09\nEXEC sp_cycle_errorlog;\n</code></pre> <ul> <li>\u91ca\u653e\u7a7a\u95f4\uff1a\u8fc1\u79fb\u5907\u4efd\u76ee\u5f55\u3001\u6e05\u7406\u5386\u53f2\u5907\u4efd/\u8f6c\u50a8\u3001\u538b\u7f29\u4e0e\u5f52\u6863\u3002</li> </ul>"},{"location":"dba/SQL-Server-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5.html#_10","title":"\u5c0f\u7ed3","text":"<ul> <li>\u5148\u6b62\u8840\u518d\u6839\u56e0\uff1b\u6240\u6709\u53d8\u66f4\u7eb3\u5165\u53d8\u66f4\u5355\u4e0e\u6f14\u7ec3\u8bb0\u5f55\uff1b\u5173\u952e\u52a8\u4f5c\u524d\u540e\u505a\u5feb\u7167/\u5907\u4efd\u3002</li> </ul>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html","title":"SQL Server \u9ad8\u53ef\u7528\u65b9\u6848","text":"<p>\u672c\u6587\u63d0\u4f9b\u5728\u4f01\u4e1a\u73af\u5883\u4e2d\u90e8\u7f72 SQL Server \u9ad8\u53ef\u7528\uff08HA\uff09\u7684\u9009\u578b\u5efa\u8bae\u3001\u53c2\u8003\u67b6\u6784\u4e0e\u5b9e\u65bd\u8981\u70b9\uff0c\u8986\u76d6\u53ef\u7528\u6027\u7ec4\uff08Always On AG\uff09\u3001\u6545\u969c\u8f6c\u79fb\u7fa4\u96c6\u5b9e\u4f8b\uff08FCI\uff09\u3001\u65e5\u5fd7\u4f20\u9001\u4e0e\u590d\u5236\u7b49\u5e38\u89c1\u65b9\u6848\u3002</p>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#_1","title":"\u9002\u7528\u573a\u666f\u4e0e\u76ee\u6807","text":"<ul> <li>\u91d1\u878d/\u533b\u836f/\u5236\u9020\u7b49\u5173\u952e\u4e1a\u52a1\u7cfb\u7edf</li> <li>\u76ee\u6807\uff1aRPO\u22480\uff5e5\u5206\u949f\u3001RTO\u22481\uff5e30\u5206\u949f\uff08\u6309\u4e1a\u52a1\u5206\u7ea7\uff09</li> <li>\u6ee1\u8db3\u5408\u89c4\u4e0e\u5ba1\u8ba1\uff08\u5982\u5ba1\u8ba1\u65e5\u5fd7\u3001\u53d8\u66f4\u8bb0\u5f55\uff09</li> </ul>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#_2","title":"\u67b6\u6784\u9009\u578b\u5bf9\u6bd4\uff08\u7b80\u8981\uff09","text":"<ul> <li>Always On \u53ef\u7528\u6027\u7ec4\uff08AG\uff09</li> <li>\u4f18\u70b9\uff1a\u8bfb\u5199\u5206\u79bb\u3001\u591a\u526f\u672c\u3001\u65e0\u5171\u4eab\u5b58\u50a8\uff1b\u7c92\u5ea6\u5230\u6570\u636e\u5e93</li> <li>\u9002\u7528\uff1a\u4f01\u4e1a\u7248\u6700\u4f73\uff1b\u6807\u51c6\u7248\u652f\u6301\u57fa\u7840\u53ef\u7528\u6027\u7ec4\uff08Basic AG\uff09\u53d7\u9650</li> <li>\u6545\u969c\u8f6c\u79fb\u7fa4\u96c6\u5b9e\u4f8b\uff08FCI\uff09</li> <li>\u4f18\u70b9\uff1a\u5b9e\u4f8b\u7ea7\u4fdd\u62a4\uff1b\u5e94\u7528\u900f\u660e\uff1b\u9700\u8981\u5171\u4eab\u5b58\u50a8\uff08\u6216 S2D\uff09</li> <li>\u9002\u7528\uff1a\u865a\u62df\u5316+\u5171\u4eab\u5b58\u50a8\u573a\u666f\uff1b\u5bf9\u5b58\u50a8\u53ef\u9760\u6027\u8981\u6c42\u9ad8</li> <li>\u65e5\u5fd7\u4f20\u9001\uff08Log Shipping\uff09</li> <li>\u4f18\u70b9\uff1a\u5b9e\u73b0\u7b80\u5355\u3001\u6210\u672c\u4f4e\uff1b\u5ef6\u8fdf\u53ef\u63a7</li> <li>\u5c40\u9650\uff1a\u53ea\u8bfb\u5907\u5e93\u9700\u6062\u590d\u6a21\u5f0f\uff1b\u5207\u6362\u9700\u4eba\u5de5/\u811a\u672c</li> <li>\u4e8b\u52a1\u590d\u5236\uff08Transactional Replication\uff09</li> <li>\u4f18\u70b9\uff1a\u7ec6\u7c92\u5ea6\u5230\u8868\uff1b\u9002\u5408\u5206\u53d1/\u62a5\u8868</li> <li>\u5c40\u9650\uff1a\u4e0d\u80fd\u4f5c\u4e3a\u4e25\u683c\u610f\u4e49 HA\uff1b\u8fd0\u7ef4\u590d\u6742\u5ea6\u9ad8</li> </ul>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#ag","title":"\u53c2\u8003\u67b6\u6784\u4e00\uff1aAG \u8de8\u53ef\u7528\u533a/\u673a\u623f\uff08\u63a8\u8350\uff09","text":"<ul> <li>\u4e3b\u5e93\uff1aAG Primary\uff08\u540c\u6b65\u63d0\u4ea4\uff09</li> <li>\u540c\u57ce\u526f\u672c\uff1aSecondary\uff08\u540c\u6b65\u63d0\u4ea4+\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\uff09</li> <li>\u5f02\u5730\u707e\u5907\uff1aSecondary\uff08\u5f02\u6b65\u63d0\u4ea4\uff09</li> <li>\u4fa6\u542c\u5668\uff08Listener\uff09\uff1a\u63d0\u4f9b\u7a33\u5b9a\u7684\u8fde\u63a5\u5165\u53e3</li> <li>\u8bfb\u5199\u5206\u79bb\uff1a\u53ea\u8bfb\u8def\u7531\u5230\u526f\u672c</li> </ul>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#fci-ag","title":"\u53c2\u8003\u67b6\u6784\u4e8c\uff1aFCI + AG\uff08\u6df7\u5408\uff09","text":"<ul> <li>\u5e95\u5c42\u7528 FCI \u63d0\u4f9b\u5b9e\u4f8b\u7ea7\u53ef\u7528\u6027\uff0c\u4e0a\u5c42\u7528 AG \u63d0\u4f9b\u8de8\u7ad9\u70b9\u591a\u526f\u672c\u4e0e\u8bfb\u5199\u5206\u79bb</li> <li>\u9002\u7528\u4e8e\u5df2\u6709\u5171\u4eab\u5b58\u50a8/\u5bf9\u5b9e\u4f8b\u7ea7\u4fdd\u62a4\u6709\u5f3a\u9700\u6c42\u7684\u73af\u5883</li> </ul>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#_3","title":"\u7248\u672c\u4e0e\u8bb8\u53ef\u8981\u70b9","text":"<ul> <li>\u4f01\u4e1a\u7248\uff1a\u5b8c\u6574 AG \u7279\u6027\uff08\u591a\u6570\u636e\u5e93\u3001\u5e76\u884c\u7b49\uff09</li> <li>\u6807\u51c6\u7248\uff1aBasic AG\uff08\u5355\u6570\u636e\u5e93\u3001\u9650\u5236\u591a\uff09\u6216\u4f7f\u7528 FCI</li> <li>\u9700\u6838\u5bf9 OS \u4e0e SQL Server \u7248\u672c\u517c\u5bb9\u77e9\u9635</li> </ul>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#_4","title":"\u7f51\u7edc\u4e0e\u5b58\u50a8\u8981\u6c42","text":"<ul> <li>\u540c\u6b65\u63d0\u4ea4\u526f\u672c\uff1a\u7f51\u7edc\u5ef6\u8fdf\u5efa\u8bae &lt; 2ms</li> <li>\u5e26\u5bbd\u89c4\u5212\uff1a\u6309\u4e1a\u52a1\u5cf0\u503c\u5199\u5165\u91cf\u00d7\u526f\u672c\u6570\u9884\u7559</li> <li>\u5b58\u50a8\uff1a\u5efa\u8bae\u72ec\u7acb\u6570\u636e/\u65e5\u5fd7\u76d8\uff1b\u542f\u7528\u5199\u5165\u7f13\u5b58\u7684\u6301\u4e45\u5316\u7b56\u7565\uff1b\u5f00\u542f\u5373\u65f6\u6587\u4ef6\u521d\u59cb\u5316</li> </ul>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#ag_1","title":"\u90e8\u7f72\u6b65\u9aa4\uff08AG \u793a\u4f8b\uff09","text":"<ol> <li>\u73af\u5883\u51c6\u5907\uff1a\u57df\u63a7\u3001DNS\u3001\u4e3b\u673a\u540d\u3001\u65f6\u95f4\u540c\u6b65\u3001\u8865\u4e01</li> <li>\u5b89\u88c5 SQL Server \u4e0e\u6700\u65b0 CU\uff1b\u542f\u7528\u5fc5\u8981\u529f\u80fd\uff08HADR\uff09</li> <li>\u914d\u7f6e Windows \u6545\u969c\u8f6c\u79fb\u7fa4\u96c6\uff08WSFC\uff09</li> <li>\u65b0\u5efa\u53ef\u7528\u6027\u7ec4\u4e0e\u526f\u672c\uff1b\u8bbe\u7f6e\u540c\u6b65/\u5f02\u6b65\u63d0\u4ea4\u53ca\u9996\u9009\u9879</li> <li>\u914d\u7f6e\u4fa6\u542c\u5668\uff08Listener\uff09\u4e0e\u53ea\u8bfb\u8def\u7531</li> <li>\u9a8c\u8bc1\u5207\u6362\u4e0e\u56de\u5207\uff0c\u7f16\u5199\u6f14\u7ec3\u8bb0\u5f55</li> </ol>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#_5","title":"\u76d1\u63a7\u4e0e\u544a\u8b66","text":"<ul> <li>\u53ef\u7528\u6027\u7ec4\u5065\u5eb7\uff1a\u540c\u6b65\u72b6\u6001\u3001\u961f\u5217\u5ef6\u8fdf\u3001\u81ea\u52a8/\u624b\u52a8\u6545\u969c\u8f6c\u79fb\u7ed3\u679c</li> <li>\u8d44\u6e90\uff1aCPU/\u5185\u5b58/IO/\u7f51\u7edc\uff1bTempDB/\u65e5\u5fd7\u589e\u957f</li> <li>\u5907\u4efd\uff1a\u5b8c\u6574/\u5dee\u5f02/\u65e5\u5fd7\u5907\u4efd\u72b6\u6001\u4e0e\u94fe\u5b8c\u6574\u6027</li> </ul>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#ha","title":"\u5907\u4efd\u4e0e\u6062\u590d\u7b56\u7565\uff08\u4e0e HA \u534f\u540c\uff09","text":"<ul> <li>\u4e3b\u5e93/\u8f85\u5e93\uff1a\u6839\u636e\u53ef\u8bfb\u6027\u914d\u7f6e\u5907\u4efd\u804c\u8d23</li> <li>\u6062\u590d\u6f14\u7ec3\uff1a\u5b63\u5ea6/\u534a\u5e74\u5ea6\uff0c\u8bb0\u5f55 RTO/RPO \u5b9e\u6d4b\u6570\u636e</li> </ul>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#checklist","title":"\u8fd0\u7ef4 Checklist\uff08\u6458\uff09","text":"<ul> <li>[ ] \u5b9a\u671f\u68c0\u67e5 AG \u540c\u6b65\u5ef6\u8fdf\u4e0e\u961f\u5217</li> <li>[ ] \u6838\u5bf9\u5907\u4efd\u662f\u5426\u53ef\u8fd8\u539f</li> <li>[ ] \u66f4\u65b0\u4e0e\u8865\u4e01\u5206\u6279\u6b21\u6eda\u52a8\u5b9e\u65bd</li> <li>[ ] \u53d8\u66f4\u8d70 CAB/\u53d8\u66f4\u5355\u7559\u75d5</li> </ul>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#_6","title":"\u53c2\u8003","text":"<ul> <li>Microsoft Docs\uff1aAlways On availability groups, FCI, Log Shipping, Replication</li> <li>SQL Server Best Practices &amp; Field Notes</li> </ul>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#always-on-ag","title":"\u547d\u4ee4\u884c\u642d\u5efa\u793a\u4f8b\uff08Always On AG\uff09","text":"<p>\u4ee5\u4e0b\u4e3a\u5728 Windows/WSFC \u73af\u5883\u4e2d\u4f7f\u7528 PowerShell + T-SQL \u7684\u6700\u7b80\u53ef\u590d\u73b0\u811a\u672c\uff08\u8bf7\u6309\u5b9e\u9645\u4e3b\u673a\u540d\u3001IP\u3001\u78c1\u76d8\u8def\u5f84\u4e0e\u8d26\u6237\u66ff\u6362\uff09\u3002</p>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#1-windows-wsfc","title":"1) Windows \u5148\u51b3\u6761\u4ef6\u4e0e WSFC","text":"<pre><code># \u4ee5\u7ba1\u7406\u5458 PowerShell \u8fd0\u884c\uff08\u6240\u6709\u8282\u70b9\uff09\nInstall-WindowsFeature Failover-Clustering -IncludeManagementTools\n\n# \u9a8c\u8bc1\u5e76\u521b\u5efa\u7fa4\u96c6\uff08\u4efb\u4e00\u8282\u70b9\u6267\u884c\uff09\nTest-Cluster -Node NODE1,NODE2\nNew-Cluster -Name SQLCL -Node NODE1,NODE2 -StaticAddress 10.0.0.10 -NoStorage\nSet-ClusterQuorum -NodeAndFileShareMajority \"\\\\FS\\Quorum\"\n</code></pre>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#2-alwayson-sql","title":"2) \u542f\u7528 AlwaysOn\uff08\u5404 SQL \u5b9e\u4f8b\uff09","text":"<pre><code># \u9700\u5b89\u88c5 SqlServer PowerShell \u6a21\u5757\uff08\u82e5\u672a\u5b89\u88c5\uff09\n# Install-Module SqlServer -Force\nEnable-SqlAlwaysOn -ServerInstance \"NODE1\" -Force\nEnable-SqlAlwaysOn -ServerInstance \"NODE2\" -Force\nRestart-Service MSSQLSERVER\n</code></pre>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#3-hadr","title":"3) \u521b\u5efa HADR \u7aef\u70b9\uff08\u5404\u526f\u672c\u6267\u884c\uff09","text":"<pre><code>USE master;\nIF NOT EXISTS (SELECT 1 FROM sys.endpoints WHERE name = N'Hadr_endpoint')\nBEGIN\n    CREATE ENDPOINT [Hadr_endpoint] STATE=STARTED\n    AS TCP (LISTENER_PORT = 5022)\n    FOR DATA_MIRRORING (\n        ROLE = ALL,\n        ENCRYPTION = REQUIRED ALGORITHM AES,\n        AUTHENTICATION = WINDOWS\n    );\nEND\n</code></pre>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#4","title":"4) \u521b\u5efa\u53ef\u7528\u6027\u7ec4\uff08\u81ea\u52a8\u64ad\u79cd\u793a\u4f8b\uff0c\u4e3b\u526f\u672c\u6267\u884c\uff09","text":"<pre><code>-- \u524d\u7f6e\uff1a\u5e93\u5e94\u4e3a FULL \u6062\u590d\u6a21\u5f0f\uff0c\u5e76\u505a\u4e00\u6b21\u5b8c\u6574\u5907\u4efd\nALTER DATABASE [DB1] SET RECOVERY FULL;\nBACKUP DATABASE [DB1] TO DISK = N'\\\\\\\\backup\\\\DB1_full.bak' WITH INIT, COMPRESSION;\n\nCREATE AVAILABILITY GROUP [AG1]\nWITH (\n    AUTOMATED_BACKUP_PREFERENCE = PRIMARY,\n    DB_FAILOVER = ON,\n    CLUSTER_TYPE = WSFC,\n    AUTOMATIC_SEEDING = ON\n)\nFOR DATABASE [DB1]\nREPLICA ON\n    N'NODE1' WITH (\n        ENDPOINT_URL = N'TCP://node1:5022',\n        AVAILABILITY_MODE = SYNCHRONOUS_COMMIT,\n        FAILOVER_MODE = AUTOMATIC,\n        SEEDING_MODE = AUTOMATIC,\n        SECONDARY_ROLE (ALLOW_CONNECTIONS = ALL)\n    ),\n    N'NODE2' WITH (\n        ENDPOINT_URL = N'TCP://node2:5022',\n        AVAILABILITY_MODE = SYNCHRONOUS_COMMIT,\n        FAILOVER_MODE = AUTOMATIC,\n        SEEDING_MODE = AUTOMATIC,\n        SECONDARY_ROLE (ALLOW_CONNECTIONS = ALL)\n    );\n</code></pre>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#5","title":"5) \u52a0\u5165\u53ef\u7528\u6027\u7ec4\u4e0e\u542f\u52a8\u6570\u636e\u79fb\u52a8\uff08\u6b21\u8981\u526f\u672c\uff09","text":"<pre><code>ALTER AVAILABILITY GROUP [AG1] JOIN;\n-- \u81ea\u52a8\u64ad\u79cd\u5c06\u81ea\u52a8\u8fd8\u539f\u5e76\u5f00\u59cb\u540c\u6b65\uff1b\u82e5\u624b\u52a8\u64ad\u79cd\uff0c\u5219\uff1a\n-- RESTORE DATABASE [DB1] FROM DISK='...' WITH NORECOVERY;\n-- ALTER DATABASE [DB1] SET HADR AVAILABILITY GROUP = [AG1];\n</code></pre>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#6-listener","title":"6) \u914d\u7f6e Listener \u4e0e\u53ea\u8bfb\u8def\u7531\uff08\u4e3b\u526f\u672c\uff09","text":"<pre><code>-- \u76d1\u542c\u5668\uff08\u793a\u4f8b\u4f7f\u7528\u5355 IP\uff09\nALTER AVAILABILITY GROUP [AG1]\nADD LISTENER N'AG1-LST'\n( WITH IP ((N'10.0.0.11', N'255.255.255.0')), PORT=1433 );\n\n-- \u53ea\u8bfb\u8def\u7531\uff08\u6839\u636e\u73af\u5883\u8c03\u6574 URL \u4e0e\u987a\u5e8f\uff09\nALTER AVAILABILITY GROUP [AG1]\nMODIFY REPLICA ON N'NODE1'\nWITH (PRIMARY_ROLE (READ_ONLY_ROUTING_LIST = (('NODE2'))));\n\nALTER AVAILABILITY GROUP [AG1]\nMODIFY REPLICA ON N'NODE2'\nWITH (READ_ONLY_ROUTING_URL = N'TCP://node2.contoso.com:1433');\n</code></pre>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#7","title":"7) \u6545\u969c\u8f6c\u79fb/\u56de\u5207\u6f14\u7ec3","text":"<pre><code>-- \u5728\u540c\u6b65\u5065\u5eb7\u7684\u6b21\u8981\u526f\u672c\u4e0a\u6267\u884c\nALTER AVAILABILITY GROUP [AG1] FAILOVER;\n-- \u9a8c\u8bc1\u540e\u6309\u9700\u56de\u5207\n</code></pre>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#fci","title":"FCI\uff08\u6545\u969c\u8f6c\u79fb\u7fa4\u96c6\u5b9e\u4f8b\uff09\u7b80\u8981\u547d\u4ee4","text":"<pre><code># WSFC \u5df2\u5c31\u7eea\u540e\uff0c\u51c6\u5907\u5171\u4eab\u78c1\u76d8\uff08\u6216 S2D\uff09\u5e76\u5206\u914d\u7ed9\u7fa4\u96c6\nInstall-WindowsFeature Failover-Clustering -IncludeManagementTools\nNew-Cluster -Name SQL-FCI -Node NODE1,NODE2 -StaticAddress 10.0.0.20\n# \u5b89\u88c5 SQL FCI\uff08\u5728\u6bcf\u4e2a\u8282\u70b9\u8fd0\u884c setup\uff0c\u53c2\u6570\u793a\u4f8b\uff09\n\"C:\\\\Setup\\\\setup.exe\" /QS /ACTION=InstallFailoverCluster /FEATURES=SQLENGINE ^\n  /INSTANCENAME=MSSQLSERVER /FAILOVERCLUSTERNETWORKNAME=\"SQL-FCI\" ^\n  /SQLSVCACCOUNT=\"DOMAIN\\\\svc_sql\" /SQLSVCPASSWORD=\"&lt;password&gt;\"\n# \u4e3a\u7b2c\u4e8c\u8282\u70b9\u52a0\u8282\u70b9\n\"C:\\\\Setup\\\\setup.exe\" /QS /ACTION=AddNode /INSTANCENAME=MSSQLSERVER\n</code></pre>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#log-shipping","title":"\u65e5\u5fd7\u4f20\u9001\uff08Log Shipping\uff09\u6700\u5c0f\u811a\u672c","text":"<pre><code>-- \u4e3b\u5e93\uff1a\u6ce8\u518c\u65e5\u5fd7\u4f20\u9001\uff08\u793a\u4f8b\uff0c\u6309\u9700\u8c03\u6574\u8def\u5f84\u4e0e\u65f6\u95f4\uff09\nEXEC msdb.dbo.sp_add_log_shipping_primary_database\n    @database = N'DB1',\n    @backup_directory = N'\\\\\\\\backup\\\\DB1',\n    @backup_share = N'\\\\\\\\backup\\\\DB1',\n    @backup_job_name = N'LSBackup_DB1',\n    @backup_retention_period = 4320, -- 3 \u5929\n    @backup_compression = 1;\n-- \u5907\u5e93\uff1a\u6ce8\u518c\u6765\u6e90\u4e0e\u8fd8\u539f\u53c2\u6570\nEXEC msdb.dbo.sp_add_log_shipping_secondary_primary\n    @primary_server = N'NODE1', @primary_database = N'DB1',\n    @backup_source_directory = N'\\\\\\\\backup\\\\DB1';\nEXEC msdb.dbo.sp_add_log_shipping_secondary_database\n    @secondary_database = N'DB1',\n    @restore_mode = 1,       -- \u5e38\u5f00\u53ea\u8bfb\uff1aSTANDBY \u6a21\u5f0f\n    @disconnect_users = 1;\n</code></pre>"},{"location":"dba/SQL-Server-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88.html#transactional-replication","title":"\u4e8b\u52a1\u590d\u5236\uff08Transactional Replication\uff09\u6700\u5c0f\u811a\u672c","text":"<pre><code>-- \u53d1\u5e03\u7aef\uff08\u53d1\u5e03\u5e93\u9700\u542f\u7528\u53d1\u5e03\uff09\nEXEC sp_replicationdboption @dbname=N'DB1', @optname=N'publish', @value=true;\nEXEC sp_addpublication @publication=N'pub_DB1', @status=N'active', @sync_method=N'concurrent';\nEXEC sp_addpublication_snapshot @publication=N'pub_DB1';\nEXEC sp_addarticle @publication=N'pub_DB1', @article=N'dbo.T1', @source_owner=N'dbo', @source_object=N'T1';\n-- \u8ba2\u9605\u7aef\nEXEC sp_addsubscription @publication=N'pub_DB1', @subscriber=N'NODE2', @destination_db=N'DB1', @subscription_type=N'Push';\n</code></pre>"},{"location":"dba/TiDB-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html","title":"TiDB \u5206\u5e03\u5f0f\u6570\u636e\u5e93\uff1a\u5165\u95e8\u4e0e\u5b89\u88c5\u5b9e\u8df5","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aDBA\u3001\u5f00\u53d1\u3001\u6570\u636e\u5e73\u53f0\u5de5\u7a0b\u5e08 \u76ee\u6807\uff1a\u901a\u8fc7 TiUP \u5feb\u901f\u542f\u52a8 TiDB \u96c6\u7fa4\uff0c\u7406\u89e3\u7ec4\u4ef6\u4e0e\u57fa\u672c\u8fd0\u7ef4\u3002</p>"},{"location":"dba/TiDB-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#1-tidb","title":"1. TiDB \u6982\u8ff0","text":"<ul> <li>\u7c7b\u578b\uff1a\u5f00\u6e90\u5206\u5e03\u5f0f NewSQL\uff0c\u517c\u5bb9 MySQL \u534f\u8bae</li> <li>\u7ec4\u4ef6\uff1aTiDB\uff08SQL \u5c42\uff09\u3001PD\uff08\u8c03\u5ea6\uff09\u3001TiKV\uff08\u5b58\u50a8\uff09\u3001TiFlash\uff08\u5217\u5b58-HTAP\uff09</li> <li>\u4eae\u70b9\uff1a\u5f39\u6027\u6269\u5c55\u3001\u5f3a\u4e00\u81f4\u3001\u5728\u7ebf\u6269\u7f29\u5bb9\u3001HTAP\u3001MySQL \u517c\u5bb9</li> </ul>"},{"location":"dba/TiDB-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#2-tiup-playground","title":"2. \u5feb\u901f\u4f53\u9a8c\uff08TiUP Playground\uff09","text":"<p>\u8981\u6c42\uff1aLinux/macOS\uff0c\u5185\u5b58 \u2265 8GB</p> <pre><code># \u5b89\u88c5 TiUP\uff08\u4e2d\u56fd\u5927\u9646\u5efa\u8bae\u52a0\u73af\u5883\u4ee3\u7406\uff09\ncurl --proto '=https' -fsSL https://tiup.io/install.sh | sh\nsource ~/.tiup/bin/tiup\n\n# \u542f\u52a8\u672c\u5730\u4f53\u9a8c\u96c6\u7fa4\uff08v7.5.0 \u793a\u4f8b\uff09\nTiUP playground v7.5.0 --db 1 --pd 1 --kv 3 --tiflash 1\n# \u8f93\u51fa\u5305\u542b TiDB \u8fde\u63a5\u5730\u5740\uff0c\u9ed8\u8ba4 4000 \u7aef\u53e3\n\n# \u8fde\u63a5\nmysql -h127.0.0.1 -P4000 -uroot --comments\n</code></pre>"},{"location":"dba/TiDB-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#3-tiup-cluster","title":"3. \u751f\u4ea7\u5316\u90e8\u7f72\uff08TiUP Cluster\uff09","text":"<pre><code># 1) \u5b89\u88c5 tiup cluster \u7ec4\u4ef6\ntiup update --self &amp;&amp; tiup update cluster\n\n# 2) \u62d3\u6251\u793a\u4f8b\uff08topology.yaml\uff09\ncat &gt; topology.yaml &lt;&lt;'YAML'\nglobal:\n  user: tidb\n  ssh_port: 22\n  deploy_dir: /data/tidb-deploy\n  data_dir: /data/tidb-data\npd_servers:\n  - host: 10.0.1.10\n  - host: 10.0.1.11\n  - host: 10.0.1.12\ntidb_servers:\n  - host: 10.0.1.20\n  - host: 10.0.1.21\ntikv_servers:\n  - host: 10.0.1.30\n  - host: 10.0.1.31\n  - host: 10.0.1.32\ntiflash_servers:\n  - host: 10.0.1.40\nmonitoring_servers:\n  - host: 10.0.1.50\ngrafana_servers:\n  - host: 10.0.1.51\nalertmanager_servers:\n  - host: 10.0.1.52\nYAML\n\n# 3) \u90e8\u7f72\u4e0e\u542f\u52a8\ntiup cluster deploy prod v7.5.0 topology.yaml --user root -p\ntiup cluster start prod\n\ntiup cluster display prod\n</code></pre>"},{"location":"dba/TiDB-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#4","title":"4. \u57fa\u672c\u64cd\u4f5c\u4e0e\u7ef4\u62a4","text":"<pre><code>-- \u521b\u5efa\u5e93\u8868\nCREATE DATABASE demo;\nUSE demo;\nCREATE TABLE t1(id BIGINT PRIMARY KEY, name VARCHAR(50));\nINSERT INTO t1 VALUES (1,'hello'),(2,'tidb');\nSELECT * FROM t1;\n\n-- \u67e5\u770b\u96c6\u7fa4\u4fe1\u606f\uff08\u5728 SQL \u4e2d\uff09\nSHOW CONFIG;\nSHOW PLACEMENT LABELS;\n</code></pre> <pre><code># \u6269\u5bb9\u4e00\u4e2a TiKV\ntiup cluster scale-out prod scale.yaml\n\n# \u6eda\u52a8\u5347\u7ea7\ntiup cluster upgrade prod v7.6.0\n\n# \u5907\u4efd\u6062\u590d\uff08BR\uff09\nBR backup full --pd http://10.0.1.10:2379 --storage s3://bucket/backup --s3.endpoint http://minio:9000\nBR restore full --pd http://10.0.1.10:2379 --storage s3://bucket/backup\n</code></pre>"},{"location":"dba/TiDB-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#5","title":"5. \u5e38\u89c1\u95ee\u9898","text":"<ul> <li>SQL \u517c\u5bb9\uff1aMySQL \u7edd\u5927\u90e8\u5206\u8bed\u6cd5\u517c\u5bb9\uff0c\u4f46\u4e2a\u522b\u7cfb\u7edf\u51fd\u6570/\u53d8\u91cf\u4e0d\u540c</li> <li>\u4e8b\u52a1\uff1a\u60b2\u89c2/\u4e50\u89c2\u4e8b\u52a1\u6a21\u5f0f\u9009\u62e9\uff0c\u957f\u4e8b\u52a1\u907f\u514d</li> <li>\u5199\u70ed\u70b9\uff1a\u901a\u8fc7 SHARD_ROW_ID_BITS/\u5206\u533a/Placement Rules \u89c4\u907f</li> <li>GC\uff1aGC \u751f\u547d\u5468\u671f\u4e0e\u5927\u4e8b\u52a1\u51b2\u7a81\uff0c\u5408\u7406\u8bbe\u7f6e tikv_gc_life_time</li> </ul>"},{"location":"dba/TiDB-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#6","title":"6. \u6700\u4f73\u5b9e\u8df5","text":"<p>1) \u4e09\u526f\u672c\uff1b2) \u4f7f\u7528 Placement Rules \u7ba1\u7406\u591a\u673a\u623f\uff1b3) \u907f\u514d\u5de8\u8868\u5355\u5206\u533a\uff1b4) \u538b\u6d4b\u5bb9\u91cf\u89c4\u5212\uff1b5) \u5b9a\u671f\u5907\u4efd\u4e0e\u6f14\u7ec3\uff1b6) \u76d1\u63a7\u4e0e\u544a\u8b66\uff08Prometheus/Grafana\uff09\uff1b7) \u7248\u672c\u8ddf\u968f LTS</p> <p>\u53c2\u8003\uff1a - TiDB \u6587\u6863 https://docs.pingcap.com/ - TiUP https://tiup.io</p>"},{"location":"dba/dm8-performance-tuning-with-ai.html","title":"\u8fbe\u68a6\u6570\u636e\u5e93 DM8 \u6027\u80fd\u8c03\u4f18\u65b9\u6848\u4e0e AI\uff08ChatGPT 5.x\uff09\u8f85\u52a9\u5b9e\u8df5","text":"<p>\u9002\u7528\u8bfb\u8005\uff1a\u6709\u4e00\u5b9a DM8 \u57fa\u7840\u7684 DBA / \u5f00\u53d1\uff0c\u671f\u671b\u7cfb\u7edf\u6027\u505a\u597d\u6027\u80fd\u8c03\u4f18\uff0c\u5e76\u5b66\u4f1a\u7528 AI \u505a\u201c\u7b2c\u4e8c\u4e2a DBA \u540c\u4e8b\u201d\u3002</p>"},{"location":"dba/dm8-performance-tuning-with-ai.html#1","title":"1. \u8c03\u4f18\u603b\u4f53\u601d\u8def","text":"<p>\u53ef\u4ee5\u6309\u201c\u56db\u5c42\u201d\u6765\u62c6\u89e3 DM8 \u6027\u80fd\u95ee\u9898\uff1a</p> <ol> <li>\u786c\u4ef6\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u5c42\uff1aCPU\u3001\u5185\u5b58\u3001\u78c1\u76d8\u9635\u5217\u3001RAID\u3001\u6587\u4ef6\u7cfb\u7edf\u3001I/O \u8c03\u5ea6\u7b49\u3002</li> <li>\u6570\u636e\u5e93\u5b9e\u4f8b\u5c42\uff08dm.ini / \u8fd0\u884c\u53c2\u6570\uff09\uff1a\u8fde\u63a5\u6570\u3001\u7f13\u51b2\u533a\u3001HASH/\u6392\u5e8f\u7f13\u5b58\u3001\u7ebf\u7a0b\u6570\u7b49\u3002</li> <li>SQL \u4e0e\u7ed3\u6784\u8bbe\u8ba1\u5c42\uff1a\u7d22\u5f15\u8bbe\u8ba1\u3001SQL \u5199\u6cd5\u3001\u4e8b\u52a1\u957f\u5ea6\u3001\u9501\u51b2\u7a81\u7b49\u3002</li> <li>\u4e1a\u52a1\u4e0e\u8bbf\u95ee\u6a21\u5f0f\u5c42\uff1a\u9ad8\u5e76\u53d1\u77ed\u4e8b\u52a1 / \u6279\u5904\u7406 / \u62a5\u8868\u7b49\uff0c\u5f71\u54cd\u53c2\u6570\u53d6\u503c\u4e0e\u7d22\u5f15\u7b56\u7565\u3002</li> </ol> <p>\u8c03\u4f18\u6b65\u9aa4\u5efa\u8bae\uff1a - \u5148\u786e\u8ba4\u201c\u74f6\u9888\u5728\u54ea\u4e00\u5c42\u201d\uff0c\u4e0d\u8981\u76f2\u76ee\u6539\u53c2\u6570\uff1b - \u5148\u4fdd\u8bc1\u6b63\u786e\u6027\u4e0e\u7a33\u5b9a\u6027\uff0c\u518d\u8ffd\u6c42\u6781\u81f4\u6027\u80fd\uff1b - \u6240\u6709\u8c03\u6574\u5148\u5728\u6d4b\u8bd5\u73af\u5883\u56de\u653e / \u56de\u5f52\uff0c\u518d\u4e0a\u7ebf\u3002</p>"},{"location":"dba/dm8-performance-tuning-with-ai.html#2-dm8","title":"2. DM8 \u5173\u952e\u76d1\u63a7\u89c6\u56fe\u4e0e\u5de5\u5177","text":"<p>\u5728 <code>disql</code> \u4e2d\u5e38\u7528\uff1a</p> <pre><code>-- \u5b9e\u4f8b\u53c2\u6570\uff08dm.ini \u4e0e\u8fd0\u884c\u65f6\u53c2\u6570\uff09\nSELECT * FROM V$DM_INI;\n\n-- \u4f1a\u8bdd\u4e0e\u8fde\u63a5\nSELECT SID, USER_NAME, SQL_TEXT, STATE\n  FROM V$SESSION;\n\n-- \u7b49\u5f85\u4e8b\u4ef6/\u9501\u60c5\u51b5\uff08\u793a\u4f8b\u89c6\u56fe\u540d\uff0c\u6309\u5b9e\u9645\u7248\u672c\u8c03\u6574\uff09\nSELECT * FROM V$LOCK;        -- \u9501\u7b49\u5f85\nSELECT * FROM V$WAITSUMMARY; -- \u7b49\u5f85\u7edf\u8ba1\uff08\u90e8\u5206\u7248\u672c\uff09\n\n-- SQL \u7edf\u8ba1\uff08\u4e0d\u540c\u7248\u672c\u53ef\u80fd\u7565\u6709\u5dee\u5f02\uff09\nSELECT * FROM V$SQLAREA;\n</code></pre> <p>\u5e38\u7528\u547d\u4ee4\u884c\u5de5\u5177\uff1a - <code>disql</code>\uff1a\u547d\u4ee4\u884c\u5ba2\u6237\u7aef - <code>dmrman</code>\uff1a\u7269\u7406\u5907\u4efd\u4e0e\u6062\u590d - <code>dexp</code> / <code>dimp</code>\uff1a\u903b\u8f91\u5bfc\u51fa\u5bfc\u5165</p>"},{"location":"dba/dm8-performance-tuning-with-ai.html#3","title":"3. \u5b9e\u4f8b\u53c2\u6570\u8c03\u4f18\uff1a\u5185\u5b58\u4e0e\u8fde\u63a5","text":""},{"location":"dba/dm8-performance-tuning-with-ai.html#31","title":"3.1 \u5feb\u901f\u67e5\u770b\u5173\u952e\u53c2\u6570","text":"<pre><code>-- \u5e38\u89c1\u5173\u952e\u53c2\u6570\u5feb\u901f\u67e5\u770b\nSELECT 'MAX_SESSIONS' PARA, SF_GET_PARA_VALUE(1,'MAX_SESSIONS') AS VAL FROM DUAL\nUNION ALL\nSELECT 'MAX_SESSION_STATEMENT', SF_GET_PARA_VALUE(1,'MAX_SESSION_STATEMENT') FROM DUAL\nUNION ALL\nSELECT 'MAX_OS_MEMORY', SF_GET_PARA_VALUE(1,'MAX_OS_MEMORY') FROM DUAL\nUNION ALL\nSELECT 'BUFFER', SF_GET_PARA_VALUE(1,'BUFFER') FROM DUAL\nUNION ALL\nSELECT 'RECYCLE', SF_GET_PARA_VALUE(1,'RECYCLE') FROM DUAL\nUNION ALL\nSELECT 'HJ_BUF_GLOBAL_SIZE', SF_GET_PARA_VALUE(1,'HJ_BUF_GLOBAL_SIZE') FROM DUAL\nUNION ALL\nSELECT 'CACHE_POOL_SIZE', SF_GET_PARA_VALUE(1,'CACHE_POOL_SIZE') FROM DUAL\nUNION ALL\nSELECT 'WORKER_THREADS', SF_GET_PARA_VALUE(1,'WORKER_THREADS') FROM DUAL\nUNION ALL\nSELECT 'TASK_THREADS', SF_GET_PARA_VALUE(1,'TASK_THREADS') FROM DUAL;\n</code></pre> <p>\u8bf4\u660e\uff1a<code>SF_GET_PARA_VALUE(1, ...)</code> \u8868\u793a\u4ece dm.ini \u914d\u7f6e\u6587\u4ef6\u83b7\u53d6\u53c2\u6570\u503c\uff1b<code>2</code> \u8868\u793a\u5f53\u524d\u5185\u5b58\u4e2d\u7684\u8fd0\u884c\u503c\u3002</p>"},{"location":"dba/dm8-performance-tuning-with-ai.html#32","title":"3.2 \u8c03\u6574\u53c2\u6570\u7684\u4e00\u822c\u65b9\u6cd5","text":"<p>DM8 \u652f\u6301\u901a\u8fc7\u5b58\u50a8\u8fc7\u7a0b\u4fee\u6539\u53c2\u6570\uff1a</p> <pre><code>-- \u901a\u7528\u5f62\u5f0f\nCALL SP_SET_PARA_VALUE(2, '\u53c2\u6570\u540d', \u6570\u503c);     -- \u5199 dm.ini\uff0c\u91cd\u542f\u540e\u751f\u6548\u6216\u90e8\u5206\u53c2\u6570\u7acb\u5373\u751f\u6548\nCALL SF_SET_SYSTEM_PARA_VALUE('\u53c2\u6570\u540d', \u6570\u503c, 1, 2);\n</code></pre> <p>\u5e38\u89c1\u8c03\u6574\u65b9\u5411\uff08\u9700\u7ed3\u5408\u7269\u7406\u5185\u5b58\u3001\u5e76\u53d1\u91cf\uff09\uff1a</p> <ul> <li>\u8fde\u63a5\u6570</li> <li><code>MAX_SESSIONS</code>\uff1a\u5141\u8bb8\u7684\u6700\u5927\u4f1a\u8bdd\u6570\uff0c\u53d7 License \u9650\u5236\uff1bOLTP \u7cfb\u7edf\u53ef\u8003\u8651\u6309\u5cf0\u503c\u5e76\u53d1 \u00d7 1.5~2 \u8bbe\u7f6e\u3002</li> <li> <p><code>MAX_SESSION_STATEMENT</code>\uff1a\u5355\u4f1a\u8bdd\u53ef\u540c\u65f6\u6253\u5f00\u7684\u8bed\u53e5\u53e5\u67c4\u6570\uff0c\u4e00\u822c\u4ece\u9ed8\u8ba4 100 \u63d0\u5347\u5230 1000~5000 \u4e4b\u95f4\u3002</p> </li> <li> <p>\u5185\u5b58\u4e0e\u7f13\u51b2\u533a\uff08\u5355\u4f4d MB\uff0c\u4ee5\u4e0b\u4ec5\u4e3a\u601d\u8def\u793a\u4f8b\uff09</p> </li> <li><code>MAX_OS_MEMORY</code>\uff1aDM \u4f7f\u7528\u7684\u5185\u5b58\u5360 OS \u603b\u5185\u5b58\u767e\u5206\u6bd4\uff0c\u5efa\u8bae 70~90 \u4e4b\u95f4\u3002</li> <li><code>BUFFER</code>\uff1a\u6570\u636e\u7f13\u51b2\u533a\uff0c\u63a8\u8350\u7ea6\u7b49\u4e8e\u53ef\u7528\u7269\u7406\u5185\u5b58\u7684 60~80%\u3002</li> <li><code>RECYCLE</code>\uff1a\u56de\u6536\u7f13\u51b2\u533a\uff0c\u7528\u4e8e\u51b7\u6570\u636e\uff0c\u53ef\u7565\u5c0f\u4e8e <code>BUFFER</code>\u3002</li> <li><code>HJ_BUF_GLOBAL_SIZE</code> / <code>HJ_BUF_SIZE</code>\uff1a\u54c8\u5e0c\u8fde\u63a5\u7f13\u5b58\uff0c\u62a5\u8868/\u6c47\u603b\u591a\u65f6\u53ef\u9002\u5f53\u589e\u5927\u3002</li> <li> <p><code>CACHE_POOL_SIZE</code>\uff1aSQL \u8ba1\u5212\u7f13\u5b58\u6c60\uff0cSQL \u79cd\u7c7b\u591a\u3001\u91cd\u590d\u7387\u9ad8\u7684\u7cfb\u7edf\u53ef\u9002\u5f53\u589e\u5927\u3002</p> </li> <li> <p>\u7ebf\u7a0b\u7c7b\u53c2\u6570</p> </li> <li><code>WORKER_THREADS</code>\uff1a\u5de5\u4f5c\u7ebf\u7a0b\u6570\uff0c\u901a\u5e38\u8bbe\u7f6e\u4e3a CPU \u903b\u8f91\u6838\u5fc3\u6570\u7684 60%~80%\u3002</li> <li><code>TASK_THREADS</code>\uff1a\u4efb\u52a1\u7ebf\u7a0b\u6570\uff0c\u7ed3\u5408\u5e76\u884c\u4efb\u52a1\u3001\u6279\u5904\u7406\u6570\u91cf\u8c03\u6574\u3002</li> </ul> <p>\u793a\u4f8b\uff08\u5047\u8bbe 64GB \u7269\u7406\u5185\u5b58\uff0cOLTP+\u8f7b\u62a5\u8868\uff09\uff1a</p> <pre><code>CALL SP_SET_PARA_VALUE(2, 'MAX_SESSIONS', 3000);\nCALL SP_SET_PARA_VALUE(2, 'MAX_SESSION_STATEMENT', 5000);\nCALL SP_SET_PARA_VALUE(2, 'MAX_OS_MEMORY', 85);\nCALL SP_SET_PARA_VALUE(2, 'BUFFER', 32000);\nCALL SP_SET_PARA_VALUE(2, 'RECYCLE', 8000);\nCALL SP_SET_PARA_VALUE(2, 'HJ_BUF_GLOBAL_SIZE', 4000);\nCALL SP_SET_PARA_VALUE(2, 'CACHE_POOL_SIZE', 512);\nCALL SP_SET_PARA_VALUE(2, 'WORKER_THREADS', 24);\nCALL SP_SET_PARA_VALUE(2, 'TASK_THREADS', 24);\n</code></pre> <p>\u6ce8\u610f\uff1a\u4ee5\u4e0a\u6570\u503c\u4ec5\u4e3a\u793a\u610f\uff0c\u8bf7\u6839\u636e\u5b9e\u9645\u786c\u4ef6\u3001\u4e1a\u52a1\u538b\u529b\u4e0e\u5b98\u65b9\u6587\u6863\u518d\u786e\u8ba4\u3002</p>"},{"location":"dba/dm8-performance-tuning-with-ai.html#4-sql","title":"4. SQL \u4e0e\u7d22\u5f15\u8c03\u4f18","text":""},{"location":"dba/dm8-performance-tuning-with-ai.html#41-sql","title":"4.1 \u627e\u5230\u201c\u6700\u6162\u7684\u90a3\u4e00\u6279 SQL\u201d","text":"<p>\u601d\u8def\uff1a\u6309\u6267\u884c\u6b21\u6570\u3001\u5e73\u5747\u54cd\u5e94\u65f6\u95f4\u3001\u903b\u8f91\u8bfb\u3001\u7269\u7406\u8bfb\u7b49\u7ef4\u5ea6\u6392\u5e8f\uff0c\u627e Top SQL\u3002</p> <pre><code>-- \u793a\u4f8b\uff1a\u6309\u5e73\u5747\u6267\u884c\u65f6\u95f4\u6392\u5e8f Top SQL\uff08\u5b57\u6bb5\u540d\u53ef\u6839\u636e\u7248\u672c\u8c03\u6574\uff09\nSELECT SQL_TEXT, EXECUTIONS, ELAPSED_TIME, ELAPSED_TIME/EXECUTIONS AVG_ELAPSED\n  FROM V$SQLAREA\n WHERE EXECUTIONS &gt; 100\n ORDER BY AVG_ELAPSED DESC\n FETCH FIRST 50 ROWS ONLY;\n</code></pre>"},{"location":"dba/dm8-performance-tuning-with-ai.html#42","title":"4.2 \u67e5\u770b\u6267\u884c\u8ba1\u5212","text":"<pre><code>EXPLAIN SELECT ... FROM ... WHERE ...;\n\n-- \u90e8\u5206\u7248\u672c\u53ef\u4ee5\u4f7f\u7528\nSELECT * FROM V$PLAN;  -- \u67e5\u770b\u6700\u8fd1\u4e00\u6b21 EXPLAIN \u7684\u8ba1\u5212\n</code></pre> <p>\u5173\u6ce8\u8981\u70b9\uff1a - \u662f\u5426\u5b58\u5728\u5927\u8868 \u5168\u8868\u626b\u63cf \u5374\u7f3a\u4e4f\u5408\u9002\u7d22\u5f15\uff1b - \u662f\u5426\u51fa\u73b0\u9891\u7e41\u7684 HASH JOIN / NESTED LOOP \u5bf9\u5927\u6570\u636e\u91cf\u8868\uff0c\u5bfc\u81f4\u5185\u5b58\u4e0e I/O \u538b\u529b\uff1b - \u662f\u5426\u5b58\u5728\u5927\u91cf\u6392\u5e8f\u3001\u4e34\u65f6\u8868\u7a7a\u95f4\u4f7f\u7528\uff08\u6ce8\u610f <code>TEMP_SIZE</code>\u3001\u4e34\u65f6\u8868\u7a7a\u95f4\u4f7f\u7528\u7387\uff09\u3002</p>"},{"location":"dba/dm8-performance-tuning-with-ai.html#43-sql","title":"4.3 \u5e38\u89c1 SQL \u4f18\u5316\u624b\u6bb5","text":"<ul> <li>\u907f\u514d\u5728\u7d22\u5f15\u5217\u4e0a\u4f7f\u7528\u51fd\u6570 / \u6a21\u7cca\u524d\u7f00\u5339\u914d\uff0c\u5f71\u54cd\u7d22\u5f15\u5229\u7528\uff1b</li> <li>\u7528\u5408\u9002\u7684 \u8054\u5408\u7d22\u5f15 \u4e0e \u8986\u76d6\u7d22\u5f15 \u51cf\u5c11\u56de\u8868\uff1b</li> <li>\u63a7\u5236\u5927\u4e8b\u52a1\uff0c\u62c6\u5206\u4e3a\u5c0f\u6279\u6b21\u63d0\u4ea4\uff0c\u51cf\u5c11\u9501\u7b49\u5f85\uff1b</li> <li>\u4f7f\u7528\u7ed1\u5b9a\u53d8\u91cf\u51cf\u5c11\u786c\u89e3\u6790\u6b21\u6570\uff0c\u63d0\u9ad8\u8ba1\u5212\u7f13\u5b58\u547d\u4e2d\u3002</li> </ul>"},{"location":"dba/dm8-performance-tuning-with-ai.html#5-aichatgpt-5x","title":"5. \u7ed3\u5408 AI\uff08ChatGPT 5.x\uff09\u8fdb\u884c\u8c03\u4f18","text":"<p>AI \u53ef\u4ee5\u5728\u8c03\u4f18\u4e2d\u626e\u6f14\u201c\u6709\u7ecf\u9a8c\u7684\u540c\u4e8b\u201d\uff0c\u4f46\u524d\u63d0\u662f\uff1a - \u4e25\u683c\u8131\u654f\uff1a\u4e0d\u8981\u76f4\u63a5\u4e0a\u4f20\u654f\u611f\u8868\u540d\u3001\u5217\u540d\u3001\u4e1a\u52a1\u6570\u636e\uff1b - \u5728\u4f60\u81ea\u5df1\u6709\u57fa\u672c\u5224\u65ad\u7684\u524d\u63d0\u4e0b\uff0c\u4f7f\u7528 AI \u505a\u201c\u7b2c\u4e8c\u610f\u89c1\u201d\u548c\u6587\u6863\u751f\u6210\u5668\u3002</p>"},{"location":"dba/dm8-performance-tuning-with-ai.html#51-chatgpt","title":"5.1 \u9002\u5408\u4ea4\u7ed9 ChatGPT \u7684\u4efb\u52a1","text":"<ol> <li>\u9605\u8bfb\u4e0e\u603b\u7ed3\u4fe1\u606f\uff1a</li> <li> <p>\u628a <code>V$DM_INI</code>\u3001<code>V$SQLAREA</code>\u3001<code>EXPLAIN</code> \u8f93\u51fa\u505a\u9002\u5f53\u6574\u7406\u540e\u8d34\u7ed9 AI\uff0c\u8bf7\u5b83\u603b\u7ed3\uff1a</p> <ul> <li>\u76ee\u524d\u53c2\u6570\u662f\u5426\u5b58\u5728\u660e\u663e\u4e0d\u5408\u7406\u7684\u5730\u65b9\uff1b</li> <li>\u54ea\u4e9b SQL \u6700\u503c\u5f97\u4f18\u5148\u4f18\u5316\uff1b</li> <li>\u6267\u884c\u8ba1\u5212\u4e2d\u6709\u54ea\u4e9b\u5178\u578b\u95ee\u9898\u3002</li> </ul> </li> <li> <p>\u7ed9\u51fa\u5907\u9009\u8c03\u4f18\u65b9\u6848\uff1a</p> </li> <li>\u8ba9 AI \u7ed3\u5408\u4f60\u7684\u786c\u4ef6\u914d\u7f6e\u3001\u4e1a\u52a1\u7279\u70b9\uff08OLTP/\u62a5\u8868\uff09\uff0c\u7ed9\u51fa\u4e00\u7ec4\u5019\u9009\u53c2\u6570\u4e0e\u89e3\u91ca\u3002</li> <li> <p>\u8ba9 AI \u751f\u6210\u201c\u8bd5\u9a8c\u65b9\u6848\u4e0e\u56de\u6eda\u65b9\u6848\u201d\u6587\u6863\uff0c\u4fbf\u4e8e\u53d8\u66f4\u8bc4\u5ba1\u3002</p> </li> <li> <p>\u81ea\u52a8\u751f\u6210\u811a\u672c\u4e0e\u6587\u6863\uff1a</p> </li> <li>\u751f\u6210\u67e5\u8be2 Top SQL \u7684\u89c6\u56fe/\u811a\u672c\uff1b</li> <li>\u751f\u6210\u6807\u51c6\u5316\u7684\u5de1\u68c0\u62a5\u544a\u6a21\u677f\uff1b</li> <li>\u5e2e\u4f60\u628a\u4e00\u6b21\u8c03\u4f18\u8fc7\u7a0b\u6574\u7406\u6210\u8fd0\u7ef4\u6587\u6863\u3002</li> </ol>"},{"location":"dba/dm8-performance-tuning-with-ai.html#52-prompt","title":"5.2 \u793a\u4f8b Prompt\uff1a\u53c2\u6570\u8c03\u4f18","text":"<p>\u4f60\u53ef\u4ee5\u6309\u4e0b\u9762\u6a21\u677f\u5411 ChatGPT \u63d0\u95ee\uff08\u6ce8\u610f\u8131\u654f\u4e0e\u6982\u62ec\uff09\uff1a</p> <p>\u201c\u4f60\u662f\u719f\u6089 \u8fbe\u68a6 DM8 \u7684\u6570\u636e\u5e93\u4e13\u5bb6\u3002\u73b0\u5728\u6709\u4e00\u5957\u7cfb\u7edf\uff0c\u786c\u4ef6\u914d\u7f6e\u5927\u81f4\u5982\u4e0b\uff1a - CPU\uff1a16C 32G - \u5b58\u50a8\uff1aSSD\uff0c\u4e3b\u8981\u662f OLTP \u4e1a\u52a1\uff0c\u5c11\u91cf\u62a5\u8868\u3002</p> <p>\u4ee5\u4e0b\u662f\u6211\u4ece DM8 \u4e2d\u5bfc\u51fa\u7684\u90e8\u5206\u53c2\u6570\uff08\u5355\u4f4d\u5982\u65e0\u7279\u522b\u8bf4\u660e\u90fd\u662f MB\uff09\uff1a</p> <pre><code>MAX_SESSIONS=...\nMAX_SESSION_STATEMENT=...\nMAX_OS_MEMORY=...\nBUFFER=...\nRECYCLE=...\nHJ_BUF_GLOBAL_SIZE=...\nCACHE_POOL_SIZE=...\nWORKER_THREADS=...\nTASK_THREADS=...\n</code></pre> <p>\u8bf7\u4f60\uff1a 1. \u8bf4\u660e\u8fd9\u4e9b\u53c2\u6570\u5206\u522b\u5bf9\u6027\u80fd\u6709\u4ec0\u4e48\u5f71\u54cd\uff1b 2. \u7ed3\u5408\u6211\u7684\u786c\u4ef6\u548c OLTP+\u5c11\u91cf\u62a5\u8868\u573a\u666f\uff0c\u7ed9\u51fa\u4e00\u5957\u66f4\u5408\u7406\u7684\u53c2\u6570\u5efa\u8bae\uff0c\u5e76\u89e3\u91ca\u6bcf\u4e2a\u53c2\u6570\u4e3a\u4f55\u8fd9\u6837\u53d6\u503c\uff1b 3. \u7ed9\u51fa\u4e00\u4e2a\u5206\u9636\u6bb5\u8c03\u6574\u65b9\u6848\uff08\u4f8b\u5982\u5148\u8c03\u6574\u54ea\u4e9b\uff0c\u89c2\u5bdf\u54ea\u4e9b\u6307\u6807\uff0c\u518d\u8c03\u6574\u54ea\u4e9b\uff09\uff1b 4. \u987a\u4fbf\u7ed9\u4e00\u6bb5 DM8 \u7684 SQL/\u5b58\u50a8\u8fc7\u7a0b\u4ee3\u7801\uff0c\u65b9\u4fbf\u6211\u76f4\u63a5\u5728\u6d4b\u8bd5\u73af\u5883\u6267\u884c\u8fd9\u4e9b\u8c03\u6574\u3002\u201d</p>"},{"location":"dba/dm8-performance-tuning-with-ai.html#53-promptsql","title":"5.3 \u793a\u4f8b Prompt\uff1aSQL \u4e0e\u7d22\u5f15\u8c03\u4f18","text":"<p>\u4f60\u53ef\u4ee5\u628a Top SQL \u4e0e\u6267\u884c\u8ba1\u5212\u6458\u8981\u6574\u7406\u4e3a\u6587\u672c\uff1a</p> <pre><code>SQL1: \u67e5\u8be2\u8ba2\u5355\u6c47\u603b ...\uff08\u7565\uff09\n\u6267\u884c\u6b21\u6570\uff1a20\u4e07\u6b21/\u5c0f\u65f6\n\u5e73\u5747\u54cd\u5e94\u65f6\u95f4\uff1a120ms\n\u6267\u884c\u8ba1\u5212\uff1a\u5927\u8868 ORDER \u660e\u663e\u5168\u8868\u626b\u63cf\uff0c\u8fde\u63a5 CUSTOMER \u65f6\u8d70 HASH JOIN ...\n\nSQL2: ...\n</code></pre> <p>\u7136\u540e\u5411 ChatGPT \u63d0\u95ee\uff1a</p> <p>\u201c\u8bf7\u5e2e\u6211\u9010\u6761\u5206\u6790\u8fd9\u4e9b SQL \u7684\u6027\u80fd\u95ee\u9898\uff0c\u7ed9\u51fa\uff1a 1. \u53ef\u80fd\u9700\u8981\u65b0\u589e\u6216\u4f18\u5316\u7684\u7d22\u5f15\uff08\u53ea\u5199\u51fa\u7d22\u5f15\u5217\u7ec4\u5408\u548c\u987a\u5e8f\u5373\u53ef\uff09\uff1b 2. \u9700\u8981\u8c03\u6574\u7684 SQL \u5199\u6cd5\uff08\u6bd4\u5982\u907f\u514d\u51fd\u6570\u3001\u6539\u5199\u5b50\u67e5\u8be2\u7b49\uff09\uff1b 3. \u53ef\u80fd\u5bfc\u81f4\u9501\u7b49\u5f85\u548c\u4e34\u65f6\u8868\u7a7a\u95f4\u81a8\u80c0\u7684\u5730\u65b9\uff1b 4. \u6bcf\u6761 SQL \u7684\u8c03\u4f18\u4f18\u5148\u7ea7\u6392\u5e8f\u3002\u201d</p>"},{"location":"dba/dm8-performance-tuning-with-ai.html#6","title":"6. \u5b9e\u6218\u843d\u5730\u5efa\u8bae","text":"<ol> <li>\u56fa\u5b9a\u8282\u594f\u7684\u5de1\u68c0\u4e0e\u57fa\u7ebf</li> <li>\u6bcf\u5929/\u6bcf\u5468\u56fa\u5b9a\u65f6\u95f4\u91c7\u96c6\uff1aCPU\u3001I/O\u3001\u4e3b\u8981\u89c6\u56fe\uff08V$DM_INI\u3001V$SQLAREA\u3001V$SESSION\uff09\u5feb\u7167\u3002</li> <li> <p>\u628a\u6307\u6807\u8f93\u5165 ChatGPT\uff0c\u8ba9\u5b83\u5e2e\u4f60\u753b\u51fa\u201c\u8d8b\u52bf\u201d\u548c\u201c\u5f02\u5e38\u70b9\u8bf4\u660e\u201d\u3002</p> </li> <li> <p>\u53d8\u66f4\u524d\u540e\u5bf9\u6bd4</p> </li> <li>\u6240\u6709\u53c2\u6570\u8c03\u6574\u3001\u7d22\u5f15\u53d8\u66f4\u3001SQL \u91cd\u6784\uff0c\u90fd\u8981\u6709\u201c\u524d\u540e\u5bf9\u6bd4\u201d\u7684 TPS/QPS\u3001\u5ef6\u65f6\u3001\u8d44\u6e90\u5360\u7528\u6570\u636e\u3002</li> <li> <p>\u53ef\u4ee5\u8ba9 AI \u5e2e\u4f60\u751f\u6210\u5bf9\u6bd4\u62a5\u544a\u548c\u7ed3\u8bba\u6458\u8981\u3002</p> </li> <li> <p>\u81ea\u52a8\u5316\u811a\u672c\u4e0e\u6587\u6863\u6c89\u6dc0</p> </li> <li>\u628a\u672c\u6587\u4e2d\u7684\u67e5\u8be2\u3001\u8c03\u4f18\u811a\u672c\u6574\u7406\u6210 <code>.sql</code> \u6587\u4ef6\u653e\u5165 DBA \u5de5\u5177\u5e93\uff1b</li> <li>\u628a\u4e0e ChatGPT \u7684\u9ad8\u8d28\u91cf\u5bf9\u8bdd\u6574\u7406\u6210\u201c\u6848\u4f8b\u5e93\u201d\uff0c\u65b9\u4fbf\u56e2\u961f\u5176\u4ed6\u4eba\u5b66\u4e60\u3002</li> </ol> <p>\u901a\u8fc7\u4e0a\u8ff0\u601d\u8def\uff0c\u4f60\u53ef\u4ee5\u5728\u638c\u63a7\u98ce\u9669\u7684\u524d\u63d0\u4e0b\uff0c\u9010\u6b65\u628a DM8 \u7684\u6027\u80fd\u548c\u7a33\u5b9a\u6027\u201c\u62c9\u6ee1\u201d\uff0c\u540c\u65f6\u628a AI \u53d8\u6210\u81ea\u5df1\u7684\u52a9\u7406 DBA\uff0c\u800c\u4e0d\u662f\u66ff\u4ee3\u8005\u3002</p>"},{"location":"dba/openGauss-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html","title":"openGauss \u6570\u636e\u5e93\uff1a\u5165\u95e8\u4e0e\u5b89\u88c5\u5b9e\u8df5","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aDBA\u3001\u6570\u636e\u5e93\u521d\u5b66\u8005\u3001\u5e94\u7528\u5f00\u53d1\u4e0e\u8fd0\u7ef4\u5de5\u7a0b\u5e08 \u76ee\u6807\uff1a\u5b8c\u6210 openGauss \u5355\u673a/\u6700\u5c0f\u96c6\u7fa4\u5feb\u901f\u5b89\u88c5\uff0c\u638c\u63e1\u57fa\u7840\u8fd0\u7ef4\u3001\u5907\u4efd\u6062\u590d\u4e0e\u5e38\u89c1\u95ee\u9898\u5904\u7406\u3002</p>"},{"location":"dba/openGauss-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#1-opengauss","title":"1. openGauss \u6982\u8ff0","text":"<ul> <li>\u7c7b\u578b\uff1a\u4f01\u4e1a\u7ea7\u5f00\u6e90\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0cPostgreSQL \u884d\u751f\uff0cSQL \u517c\u5bb9\u5ea6\u9ad8</li> <li>\u5178\u578b\u573a\u666f\uff1a\u653f\u4f01\u6838\u5fc3\u7cfb\u7edf\u3001\u91d1\u878d\u3001\u8fd0\u8425\u5546\u3001\u5236\u9020\u4e1a</li> <li>\u4e3b\u8981\u7279\u6027\uff1a\u591a\u6838\u5e76\u884c\u3001\u5411\u91cf\u5316\u6267\u884c\u3001\u5185\u5b58\u8868\u3001\u5b89\u5168\u5ba1\u8ba1\u3001\u7269\u5316\u89c6\u56fe\u3001\u517c\u5bb9 Oracle/PostgreSQL \u8bed\u6cd5</li> <li>\u751f\u6001\uff1aopenGauss\u3001openEuler\u3001FusionInsight\u3001GaussDB\uff08\u5546\u7528\uff09</li> </ul>"},{"location":"dba/openGauss-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#2-docker","title":"2. \u5feb\u901f\u4f53\u9a8c\uff08Docker \u5355\u673a\uff09","text":"<p>\u4f9d\u8d56\uff1aDocker 20+\uff0c\u5185\u5b58 \u2265 4GB\uff0c\u78c1\u76d8 \u2265 20GB</p> <pre><code># \u62c9\u53d6\u955c\u50cf\u5e76\u542f\u52a8\uff08\u9ed8\u8ba4\u6570\u636e\u5e93 og\uff0c\u7aef\u53e3 5432\uff09\ndocker run -d --name opengauss \\\n  -e GS_PASSWORD='Gauss@123' \\\n  -p 5432:5432 \\\n  enmotech/opengauss:5.0.0\n\n# \u4f7f\u7528 psql/gsql \u8fde\u63a5\npsql -h 127.0.0.1 -p 5432 -U gaussdb -d postgres  # \u9ed8\u8ba4\u7528\u6237 gaussdb\n# \u5bc6\u7801\uff1aGauss@123\n</code></pre>"},{"location":"dba/openGauss-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#3-linux","title":"3. \u751f\u4ea7\u5316\u5b89\u88c5\uff08Linux \u5355\u673a\u6700\u5c0f\u5316\uff09","text":"<p>\u63a8\u8350\u7cfb\u7edf\uff1aopenEuler 22.03/RedHat 8+/CentOS Stream 8\uff0c\u5185\u5b58 \u2265 16GB\uff0c\u78c1\u76d8 \u2265 200GB</p>"},{"location":"dba/openGauss-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#31","title":"3.1 \u7cfb\u7edf\u51c6\u5907","text":"<pre><code># 1) \u7cfb\u7edf\u53c2\u6570\uff08\u53ea\u793a\u4f8b\u5173\u952e\u9879\uff09\ncat &gt;&gt; /etc/sysctl.conf &lt;&lt;'EOF'\nvm.swappiness=0\nkernel.shmmax=68719476736\nkernel.shmall=4294967296\nfs.file-max=1000000\nEOF\nsysctl -p\n\ncat &gt;&gt; /etc/security/limits.conf &lt;&lt;'EOF'\n* soft nofile 1000000\n* hard nofile 1000000\n* soft nproc  131072\n* hard nproc  131072\nEOF\n\n# 2) \u521b\u5efa\u8fd0\u884c\u7528\u6237\nuseradd -m -s /bin/bash omm\npasswd omm\nmkdir -p /opt/og\nchown -R omm:omm /opt/og\n</code></pre>"},{"location":"dba/openGauss-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#32","title":"3.2 \u5b89\u88c5\u5305\u4e0e\u76ee\u5f55","text":"<pre><code># \u4ee5 5.x \u4e3a\u4f8b\uff0c\u5c06\u5b89\u88c5\u4ecb\u8d28\u4e0a\u4f20\u81f3 /opt/og\nsu - omm\nmkdir ~/pkg &amp;&amp; cd ~/pkg\n# \u5c06 openGauss-5.x.x-...tar.gz \u4e0e\u811a\u672c\u5305\u89e3\u538b\u5230 ~/pkg\n</code></pre>"},{"location":"dba/openGauss-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#33-om","title":"3.3 \u5355\u673a\u90e8\u7f72\uff08OM \u5de5\u5177\uff09","text":"<pre><code># \u751f\u6210\u5355\u673a\u914d\u7f6e\uff08cluster_config.xml\uff09\ncat &gt; ~/cluster_config.xml &lt;&lt;'XML'\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;ROOT&gt;\n  &lt;CLUSTER&gt;\n    &lt;PARAM name=\"cluster_name\" value=\"og_one\"/&gt;\n    &lt;PARAM name=\"node_names\" value=\"`hostname`\"/&gt;\n    &lt;PARAM name=\"back_ip1s\" value=\"127.0.0.1\"/&gt;\n    &lt;PARAM name=\"gaussdb_app_path\" value=\"/opt/og/app\"/&gt;\n    &lt;PARAM name=\"gaussdb_log_path\" value=\"/opt/og/log\"/&gt;\n    &lt;PARAM name=\"tmp_mppdb_path\" value=\"/opt/og/tmp\"/&gt;\n    &lt;PARAM name=\"gaussdb_tool_path\" value=\"/opt/og/om\"/&gt;\n    &lt;PARAM name=\"cluster_type\" value=\"single-inst\"/&gt;\n  &lt;/CLUSTER&gt;\n  &lt;DEVICELIST&gt;\n    &lt;DEVICE sn=\"1\"&gt;\n      &lt;PARAM name=\"name\" value=\"`hostname`\"/&gt;\n      &lt;PARAM name=\"azName\" value=\"AZ1\"/&gt;\n      &lt;PARAM name=\"azPriority\" value=\"1\"/&gt;\n      &lt;PARAM name=\"backIp1\" value=\"127.0.0.1\"/&gt;\n      &lt;PARAM name=\"sshIp1\" value=\"127.0.0.1\"/&gt;\n      &lt;PARAM name=\"dataNum\" value=\"1\"/&gt;\n      &lt;PARAM name=\"dataPortBase\" value=\"5432\"/&gt;\n      &lt;PARAM name=\"dataNode1\" value=\"/opt/og/data\"/&gt;\n      &lt;PARAM name=\"dataNode1_syncNum\" value=\"0\"/&gt;\n    &lt;/DEVICE&gt;\n  &lt;/DEVICELIST&gt;\n&lt;/ROOT&gt;\nXML\n\n# \u9884\u5b89\u88c5\u3001\u5b89\u88c5\nsource ~/pkg/om/gs_profile\ngs_preinstall -U omm -G dbgrp -X ~/cluster_config.xml --skip-hostname-set -M fast\ngs_install -X ~/cluster_config.xml --gsinit-parameter=\"--locale=en_US.UTF-8\"\n\n# \u542f\u505c\u4e0e\u72b6\u6001\ngs_om -t start\ngs_om -t status\n</code></pre>"},{"location":"dba/openGauss-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#4","title":"4. \u57fa\u7840\u4f7f\u7528","text":"<pre><code># \u5207\u6362\u5230\u6570\u636e\u5e93\u7528\u6237\nsu - omm\nsource /opt/og/app/bin/gs_profile\n\ngsql -d postgres -p 5432 -r &lt;&lt;'SQL'\nCREATE DATABASE demo;\n\\c demo\nCREATE TABLE t1(id int primary key, name text);\nINSERT INTO t1 VALUES (1,'hello'),(2,'openGauss');\nSELECT * FROM t1;\nSQL\n</code></pre>"},{"location":"dba/openGauss-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#5","title":"5. \u5907\u4efd\u4e0e\u6062\u590d","text":"<pre><code># \u903b\u8f91\u5907\u4efd\ngs_dump -p 5432 -U omm -f /backup/demo.sql demo\n\n# \u903b\u8f91\u6062\u590d\ngsql -d demo -p 5432 -f /backup/demo.sql\n\n# \u7269\u7406\u5907\u4efd\uff08\u793a\u610f\uff1a\u7ed3\u5408\u5feb\u7167/LVM/\u6587\u4ef6\u7cfb\u7edf\u5feb\u7167\uff09\n# \u505c\u5e93 -&gt; \u5feb\u7167 -&gt; \u542f\u5e93\uff0c\u6216\u4f7f\u7528\u589e\u91cf\u5907\u4efd\u5de5\u5177\u94fe\uff08\u4f01\u4e1a\u7248\uff09\n</code></pre>"},{"location":"dba/openGauss-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#6","title":"6. \u5b89\u5168\u4e0e\u5ba1\u8ba1","text":"<ul> <li>\u53e3\u4ee4\u7b56\u7565\uff1a\u957f\u5ea6 \u2265 12\u3001\u590d\u6742\u5ea6\u300190 \u5929\u8fc7\u671f</li> <li>\u6700\u5c0f\u6743\u9650\uff1a\u6309\u89d2\u8272\u6388\u4e88\uff0c\u907f\u514d\u76f4\u63a5\u4f7f\u7528\u8d85\u7ea7\u7528\u6237</li> <li>\u5ba1\u8ba1\uff1a\u8bb0\u5f55\u767b\u5f55/DDL/\u5b89\u5168\u53d8\u66f4\uff0c\u65e5\u5fd7\u4fdd\u7559 \u2265 7 \u5e74</li> <li>\u4f20\u8f93\u5b89\u5168\uff1a\u914d\u7f6e SSL/TLS\uff0c\u9650\u5236\u6765\u6e90 IP</li> </ul>"},{"location":"dba/openGauss-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#7","title":"7. \u5e38\u89c1\u95ee\u9898","text":"<ul> <li>\u7aef\u53e3\u5360\u7528\uff1a\u786e\u4fdd 5432 \u672a\u88ab\u5360\u7528\uff08ss -lntp | grep 5432\uff09</li> <li>\u201cpermission denied\u201d\uff1a\u68c0\u67e5\u6570\u636e\u76ee\u5f55\u5c5e\u4e3b\u3001\u6743\u9650\uff08700\uff09</li> <li>\u7f16\u7801/\u6392\u5e8f\u89c4\u5219\uff1a\u5b89\u88c5\u65f6\u7edf\u4e00\u8bbe\u7f6e\u4e3a UTF-8\uff0c\u907f\u514d\u4e2d\u6587\u4e71\u7801</li> <li>\u6027\u80fd\u4f4e\uff1a\u68c0\u67e5 shared_buffers\u3001work_mem\u3001\u5e76\u53d1\u3001IO \u5b50\u7cfb\u7edf</li> </ul>"},{"location":"dba/openGauss-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#8","title":"8. \u6700\u4f73\u5b9e\u8df5","text":"<p>1) \u751f\u4ea7\u4e0e\u6d4b\u8bd5\u73af\u5883\u9694\u79bb\uff1b2) \u53c2\u6570\u8d70\u914d\u7f6e\u4e0e\u53d8\u66f4\u5ba1\u6279\uff1b3) \u5907\u4efd 3-2-1 \u7b56\u7565\uff1b4) \u7edf\u4e00\u76d1\u63a7+\u544a\u8b66\uff1b5) \u57fa\u7ebf\u6027\u80fd\u6d4b\u8bd5\u4e0e\u5bb9\u91cf\u89c4\u5212\uff1b6) \u5b9a\u671f VACUUM/ANALYZE\uff1b7) \u5408\u89c4\u4e0e\u5ba1\u8ba1</p> <p>\u53c2\u8003\uff1a - openGauss \u5b98\u65b9\u6587\u6863 https://docs.opengauss.org/ - \u793e\u533a\u955c\u50cf https://hub.docker.com/r/enmotech/opengauss</p>"},{"location":"dba/oracle-pdb-guide.html","title":"Oracle PDB \u8be6\u7ec6\u4f7f\u7528\u6307\u5357","text":""},{"location":"dba/oracle-pdb-guide.html#_1","title":"\u76ee\u5f55","text":"<ol> <li>\u6982\u8ff0</li> <li>\u57fa\u7840\u67b6\u6784</li> <li>\u5b89\u88c5\u548c\u914d\u7f6e</li> <li>\u65e5\u5e38\u7ba1\u7406\u64cd\u4f5c</li> <li>\u9ad8\u7ea7\u7279\u6027</li> <li>\u6027\u80fd\u8c03\u4f18</li> <li>\u6545\u969c\u6392\u9664</li> <li>\u6700\u4f73\u5b9e\u8df5</li> </ol>"},{"location":"dba/oracle-pdb-guide.html#1","title":"1. \u6982\u8ff0","text":""},{"location":"dba/oracle-pdb-guide.html#11-pdb","title":"1.1 \u4ec0\u4e48\u662f PDB","text":"<p>PDB (Pluggable Database) \u662f Oracle 12c \u53ca\u66f4\u9ad8\u7248\u672c\u5f15\u5165\u7684\u591a\u79df\u6237\u67b6\u6784\u7684\u6838\u5fc3\u7ec4\u4ef6\u3002\u5b83\u662f\u4e00\u4e2a\u5b8c\u5168\u5c01\u88c5\u7684\u6570\u636e\u5e93\uff0c\u5305\u542b\u81ea\u5df1\u7684\u6570\u636e\u6587\u4ef6\u3001\u6570\u636e\u5b57\u5178\u548c\u975e\u516c\u5171\u5bf9\u8c61\u3002</p>"},{"location":"dba/oracle-pdb-guide.html#12","title":"1.2 \u4f18\u52bf","text":"<ul> <li>\u8d44\u6e90\u5171\u4eab\u548c\u4f18\u5316</li> <li>\u7b80\u5316\u7ba1\u7406\u7ef4\u62a4</li> <li>\u7075\u6d3b\u7684\u90e8\u7f72\u9009\u9879</li> <li>\u589e\u5f3a\u7684\u5b89\u5168\u6027\u548c\u9694\u79bb\u6027</li> <li>\u964d\u4f4e\u8bb8\u53ef\u8bc1\u6210\u672c</li> </ul>"},{"location":"dba/oracle-pdb-guide.html#2","title":"2. \u57fa\u7840\u67b6\u6784","text":""},{"location":"dba/oracle-pdb-guide.html#21-cdb","title":"2.1 CDB \u67b6\u6784","text":"<p>CDB (Container Database) \u5305\u542b\u4ee5\u4e0b\u7ec4\u4ef6\uff1a - ROOT (CDB$ROOT)\uff1a\u5b58\u50a8 Oracle \u63d0\u4f9b\u7684\u516c\u5171\u5bf9\u8c61 - SEED (PDB$SEED)\uff1a\u7528\u4e8e\u521b\u5efa\u65b0 PDB \u7684\u53ea\u8bfb\u6a21\u677f - PDBs\uff1a\u4e00\u4e2a\u6216\u591a\u4e2a\u53ef\u63d2\u62d4\u6570\u636e\u5e93</p>"},{"location":"dba/oracle-pdb-guide.html#22","title":"2.2 \u6587\u4ef6\u7ed3\u6784","text":"<pre><code>ORACLE_BASE\n\u251c\u2500\u2500 admin\n\u2502   \u2514\u2500\u2500 CDB\n\u2502       \u251c\u2500\u2500 adump\n\u2502       \u251c\u2500\u2500 bdump\n\u2502       \u251c\u2500\u2500 cdump\n\u2502       \u2514\u2500\u2500 udump\n\u251c\u2500\u2500 oradata\n\u2502   \u2514\u2500\u2500 CDB\n\u2502       \u251c\u2500\u2500 control01.ctl\n\u2502       \u251c\u2500\u2500 redo01.log\n\u2502       \u251c\u2500\u2500 system01.dbf\n\u2502       \u251c\u2500\u2500 temp01.dbf\n\u2502       \u2514\u2500\u2500 users01.dbf\n\u2514\u2500\u2500 product\n    \u2514\u2500\u2500 19.0.0\n        \u2514\u2500\u2500 dbhome_1\n</code></pre>"},{"location":"dba/oracle-pdb-guide.html#3","title":"3. \u5b89\u88c5\u548c\u914d\u7f6e","text":""},{"location":"dba/oracle-pdb-guide.html#31","title":"3.1 \u5148\u51b3\u6761\u4ef6","text":"<ul> <li>Oracle Database \u8f6f\u4ef6\u5b89\u88c5</li> <li>\u8db3\u591f\u7684\u78c1\u76d8\u7a7a\u95f4</li> <li>\u9002\u5f53\u7684\u5185\u5b58\u914d\u7f6e</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u8981\u6c42</li> </ul>"},{"location":"dba/oracle-pdb-guide.html#32-cdb","title":"3.2 \u521b\u5efa CDB","text":"<pre><code>CREATE DATABASE CDB\n  USER SYS IDENTIFIED BY password\n  USER SYSTEM IDENTIFIED BY password\n  LOGFILE GROUP 1 ('/u01/app/oracle/oradata/cdb/redo01.log') SIZE 100M,\n          GROUP 2 ('/u01/app/oracle/oradata/cdb/redo02.log') SIZE 100M\n  MAXLOGFILES 5\n  MAXLOGMEMBERS 5\n  MAXLOGHISTORY 1\n  MAXDATAFILES 100\n  CHARACTER SET AL32UTF8\n  NATIONAL CHARACTER SET AL16UTF16\n  EXTENT MANAGEMENT LOCAL\n  DATAFILE '/u01/app/oracle/oradata/cdb/system01.dbf'\n    SIZE 700M REUSE AUTOEXTEND ON NEXT 10240K MAXSIZE UNLIMITED\n  SYSAUX DATAFILE '/u01/app/oracle/oradata/cdb/sysaux01.dbf'\n    SIZE 550M REUSE AUTOEXTEND ON NEXT 10240K MAXSIZE UNLIMITED\n  DEFAULT TABLESPACE users\n    DATAFILE '/u01/app/oracle/oradata/cdb/users01.dbf'\n    SIZE 500M REUSE AUTOEXTEND ON MAXSIZE UNLIMITED\n  DEFAULT TEMPORARY TABLESPACE temp\n    TEMPFILE '/u01/app/oracle/oradata/cdb/temp01.dbf'\n    SIZE 20M REUSE AUTOEXTEND ON NEXT 640K MAXSIZE UNLIMITED\n  UNDO TABLESPACE undotbs1\n    DATAFILE '/u01/app/oracle/oradata/cdb/undotbs01.dbf'\n    SIZE 200M REUSE AUTOEXTEND ON NEXT 5120K MAXSIZE UNLIMITED\n  ENABLE PLUGGABLE DATABASE\n    SEED\n    FILE_NAME_CONVERT = ('/u01/app/oracle/oradata/cdb/',\n                        '/u01/app/oracle/oradata/pdbseed/')\n    SYSTEM DATAFILES SIZE 125M AUTOEXTEND ON NEXT 10240K MAXSIZE UNLIMITED\n    SYSAUX DATAFILES SIZE 100M;\n</code></pre>"},{"location":"dba/oracle-pdb-guide.html#33-pdb","title":"3.3 \u521b\u5efa PDB","text":"<pre><code>CREATE PLUGGABLE DATABASE pdb1\n  ADMIN USER pdb_admin IDENTIFIED BY password\n  ROLES = (CONNECT)\n  DEFAULT TABLESPACE users\n    DATAFILE '/u01/app/oracle/oradata/cdb/pdb1/users01.dbf'\n    SIZE 250M AUTOEXTEND ON NEXT 1M MAXSIZE UNLIMITED\n  FILE_NAME_CONVERT = ('/u01/app/oracle/oradata/pdbseed/',\n                      '/u01/app/oracle/oradata/pdb1/');\n</code></pre>"},{"location":"dba/oracle-pdb-guide.html#4","title":"4. \u65e5\u5e38\u7ba1\u7406\u64cd\u4f5c","text":""},{"location":"dba/oracle-pdb-guide.html#41","title":"4.1 \u57fa\u672c\u64cd\u4f5c","text":"<pre><code>-- \u67e5\u770b\u6240\u6709 PDB\nSELECT name, open_mode FROM v$pdbs;\n\n-- \u5207\u6362\u5bb9\u5668\nALTER SESSION SET CONTAINER = pdb1;\n\n-- \u542f\u52a8 PDB\nALTER PLUGGABLE DATABASE pdb1 OPEN;\n\n-- \u5173\u95ed PDB\nALTER PLUGGABLE DATABASE pdb1 CLOSE;\n\n-- \u91cd\u542f PDB\nALTER PLUGGABLE DATABASE pdb1 CLOSE IMMEDIATE;\nALTER PLUGGABLE DATABASE pdb1 OPEN;\n</code></pre>"},{"location":"dba/oracle-pdb-guide.html#42","title":"4.2 \u7528\u6237\u7ba1\u7406","text":"<pre><code>-- \u521b\u5efa\u7528\u6237\nCREATE USER user1 IDENTIFIED BY password\n  DEFAULT TABLESPACE users\n  TEMPORARY TABLESPACE temp\n  QUOTA UNLIMITED ON users;\n\n-- \u6388\u6743\nGRANT CREATE SESSION TO user1;\nGRANT CREATE TABLE TO user1;\nGRANT CREATE VIEW TO user1;\n</code></pre>"},{"location":"dba/oracle-pdb-guide.html#43","title":"4.3 \u5907\u4efd\u4e0e\u6062\u590d","text":"<pre><code>-- RMAN \u5907\u4efd\nBACKUP PLUGGABLE DATABASE pdb1;\n\n-- \u5bfc\u51fa\u5bfc\u5165\nexpdp system/password@pdb1 directory=dp_dir dumpfile=pdb1.dmp\nimpdp system/password@pdb2 directory=dp_dir dumpfile=pdb1.dmp\n</code></pre>"},{"location":"dba/oracle-pdb-guide.html#5","title":"5. \u9ad8\u7ea7\u7279\u6027","text":""},{"location":"dba/oracle-pdb-guide.html#51-pdb","title":"5.1 \u514b\u9686 PDB","text":"<pre><code>CREATE PLUGGABLE DATABASE pdb2 FROM pdb1\n  FILE_NAME_CONVERT = ('/pdb1/', '/pdb2/');\n</code></pre>"},{"location":"dba/oracle-pdb-guide.html#52-pdb","title":"5.2 \u91cd\u5b9a\u4f4d PDB","text":"<pre><code>-- \u6e90 CDB\nALTER PLUGGABLE DATABASE pdb1 CLOSE;\nALTER PLUGGABLE DATABASE pdb1 \n  UNPLUG INTO '/tmp/pdb1.xml';\n\n-- \u76ee\u6807 CDB\nCREATE PLUGGABLE DATABASE pdb1 \n  USING '/tmp/pdb1.xml'\n  NOCOPY;\n</code></pre>"},{"location":"dba/oracle-pdb-guide.html#53","title":"5.3 \u8d44\u6e90\u7ba1\u7406","text":"<pre><code>-- \u521b\u5efa\u8d44\u6e90\u8ba1\u5212\nCREATE RESOURCE PLAN pdb_plan;\n\n-- \u6dfb\u52a0\u6307\u4ee4\nBEGIN\n  DBMS_RESOURCE_MANAGER.CREATE_PLAN_DIRECTIVE(\n    PLAN =&gt; 'pdb_plan',\n    PLUGGABLE_DATABASE =&gt; 'pdb1',\n    SHARES =&gt; 3);\nEND;\n/\n</code></pre>"},{"location":"dba/oracle-pdb-guide.html#6","title":"6. \u6027\u80fd\u8c03\u4f18","text":""},{"location":"dba/oracle-pdb-guide.html#61","title":"6.1 \u5185\u5b58\u7ba1\u7406","text":"<pre><code>-- \u8bbe\u7f6e PDB \u7684\u5185\u5b58\u9650\u5236\nALTER SYSTEM SET SGA_TARGET = 4G SCOPE = BOTH;\nALTER SYSTEM SET PGA_AGGREGATE_TARGET = 1G SCOPE = BOTH;\n</code></pre>"},{"location":"dba/oracle-pdb-guide.html#62","title":"6.2 \u6027\u80fd\u76d1\u63a7","text":"<pre><code>-- \u67e5\u770b\u7b49\u5f85\u4e8b\u4ef6\nSELECT event, total_waits, time_waited\nFROM v$system_event\nORDER BY time_waited DESC;\n\n-- \u67e5\u770b SQL \u6027\u80fd\nSELECT sql_id, executions, elapsed_time/1000000 elapsed_seconds\nFROM v$sql\nORDER BY elapsed_time DESC;\n</code></pre>"},{"location":"dba/oracle-pdb-guide.html#63","title":"6.3 \u7edf\u8ba1\u4fe1\u606f\u7ba1\u7406","text":"<pre><code>-- \u6536\u96c6\u7edf\u8ba1\u4fe1\u606f\nEXEC DBMS_STATS.GATHER_SCHEMA_STATS('SCHEMA_NAME');\n</code></pre>"},{"location":"dba/oracle-pdb-guide.html#7","title":"7. \u6545\u969c\u6392\u9664","text":""},{"location":"dba/oracle-pdb-guide.html#71","title":"7.1 \u5e38\u89c1\u95ee\u9898","text":"<ol> <li>PDB \u65e0\u6cd5\u6253\u5f00</li> </ol> <pre><code>-- \u68c0\u67e5\u544a\u8b66\u65e5\u5fd7\nSELECT message_text\nFROM v$diag_alert_ext\nWHERE component_id = 'rdbms'\nORDER BY originating_timestamp DESC;\n\n-- \u68c0\u67e5\u6570\u636e\u6587\u4ef6\u72b6\u6001\nSELECT name, status FROM v$datafile;\n</code></pre> <ol> <li>\u6027\u80fd\u95ee\u9898</li> </ol> <pre><code>-- \u68c0\u67e5\u6d3b\u52a8\u4f1a\u8bdd\nSELECT sid, serial#, username, status\nFROM v$session\nWHERE type != 'BACKGROUND';\n\n-- \u68c0\u67e5\u9501\u7b49\u5f85\nSELECT holding.sid holding_sid,\n       waiting.sid waiting_sid,\n       holding.username holding_user,\n       waiting.username waiting_user\nFROM v$lock l1\nJOIN v$session holding ON l1.sid = holding.sid\nJOIN v$lock l2 ON l1.id1 = l2.id1 AND l2.request &gt; 0\nJOIN v$session waiting ON l2.sid = waiting.sid\nWHERE l1.block = 1;\n</code></pre>"},{"location":"dba/oracle-pdb-guide.html#8","title":"8. \u6700\u4f73\u5b9e\u8df5","text":""},{"location":"dba/oracle-pdb-guide.html#81","title":"8.1 \u8bbe\u8ba1\u5efa\u8bae","text":"<ol> <li>PDB \u547d\u540d\u89c4\u8303</li> <li>\u4f7f\u7528\u6709\u610f\u4e49\u7684\u540d\u79f0</li> <li>\u5305\u542b\u73af\u5883\u6807\u8bc6\uff08dev/test/prod\uff09</li> <li> <p>\u907f\u514d\u7279\u6b8a\u5b57\u7b26</p> </li> <li> <p>\u6587\u4ef6\u7ba1\u7406</p> </li> <li>\u4f7f\u7528 OMF\uff08Oracle Managed Files\uff09</li> <li>\u89c4\u5212\u8db3\u591f\u7684\u5b58\u50a8\u7a7a\u95f4</li> <li>\u5b9e\u65bd\u9002\u5f53\u7684\u5907\u4efd\u7b56\u7565</li> </ol>"},{"location":"dba/oracle-pdb-guide.html#82","title":"8.2 \u5b89\u5168\u5efa\u8bae","text":"<ol> <li>\u8bbf\u95ee\u63a7\u5236</li> <li>\u5b9e\u65bd\u6700\u5c0f\u6743\u9650\u539f\u5219</li> <li>\u5b9a\u671f\u5ba1\u8ba1\u7528\u6237\u6743\u9650</li> <li> <p>\u4f7f\u7528 profiles \u9650\u5236\u8d44\u6e90\u4f7f\u7528</p> </li> <li> <p>\u7f51\u7edc\u5b89\u5168</p> </li> <li>\u4f7f\u7528 SSL/TLS \u52a0\u5bc6</li> <li>\u5b9e\u65bd\u7f51\u7edc\u8bbf\u95ee\u63a7\u5236\u5217\u8868</li> <li>\u76d1\u63a7\u5f02\u5e38\u8bbf\u95ee</li> </ol>"},{"location":"dba/oracle-pdb-guide.html#83","title":"8.3 \u7ef4\u62a4\u5efa\u8bae","text":"<ol> <li>\u65e5\u5e38\u7ef4\u62a4</li> <li>\u5b9a\u671f\u6536\u96c6\u7edf\u8ba1\u4fe1\u606f</li> <li>\u76d1\u63a7\u7a7a\u95f4\u4f7f\u7528</li> <li> <p>\u68c0\u67e5\u544a\u8b66\u65e5\u5fd7</p> </li> <li> <p>\u6027\u80fd\u4f18\u5316</p> </li> <li>\u5b9a\u671f\u5ba1\u67e5\u6267\u884c\u8ba1\u5212</li> <li>\u7ef4\u62a4\u7d22\u5f15</li> <li> <p>\u6e05\u7406\u5386\u53f2\u6570\u636e</p> </li> <li> <p>\u5907\u4efd\u7b56\u7565</p> </li> <li>\u5b9e\u65bd\u589e\u91cf\u5907\u4efd</li> <li>\u5b9a\u671f\u6d4b\u8bd5\u6062\u590d</li> <li>\u4fdd\u7559\u5907\u4efd\u5386\u53f2</li> </ol>"},{"location":"dba/oracle-pdb-guide.html#84","title":"8.4 \u76d1\u63a7\u6e05\u5355","text":"<ol> <li>\u57fa\u7840\u76d1\u63a7</li> <li>CPU \u4f7f\u7528\u7387</li> <li>\u5185\u5b58\u4f7f\u7528\u60c5\u51b5</li> <li>I/O \u6027\u80fd</li> <li> <p>\u7f51\u7edc\u5ef6\u8fdf</p> </li> <li> <p>\u6570\u636e\u5e93\u76d1\u63a7</p> </li> <li>\u8868\u7a7a\u95f4\u4f7f\u7528\u7387</li> <li>\u4f1a\u8bdd\u6570\u91cf</li> <li>\u9501\u7b49\u5f85</li> <li> <p>SQL \u54cd\u5e94\u65f6\u95f4</p> </li> <li> <p>\u4e1a\u52a1\u76d1\u63a7</p> </li> <li>\u4e8b\u52a1\u541e\u5410\u91cf</li> <li>\u7528\u6237\u8fde\u63a5\u6570</li> <li>\u4e1a\u52a1\u5173\u952e\u6307\u6807</li> <li>\u54cd\u5e94\u65f6\u95f4 SLA</li> </ol>"},{"location":"dba/oracle-pdb-guide.html#_2","title":"\u9644\u5f55","text":""},{"location":"dba/oracle-pdb-guide.html#a","title":"A. \u5e38\u7528\u547d\u4ee4\u901f\u67e5","text":"<pre><code>-- \u5207\u6362\u5bb9\u5668\nSHOW CON_NAME;\nALTER SESSION SET CONTAINER = pdb_name;\n\n-- \u521b\u5efa PDB\nCREATE PLUGGABLE DATABASE pdb_name \n  ADMIN USER admin_user IDENTIFIED BY password;\n\n-- PDB \u751f\u547d\u5468\u671f\u7ba1\u7406\nALTER PLUGGABLE DATABASE pdb_name OPEN;\nALTER PLUGGABLE DATABASE pdb_name CLOSE;\nDROP PLUGGABLE DATABASE pdb_name INCLUDING DATAFILES;\n\n-- \u72b6\u6001\u67e5\u770b\nSELECT con_id, name, open_mode FROM v$pdbs;\nSELECT instance_name, status FROM v$instance;\n</code></pre>"},{"location":"dba/oracle-pdb-guide.html#b","title":"B. \u5e38\u7528\u89c6\u56fe","text":"<ol> <li>\u5bb9\u5668\u76f8\u5173\u89c6\u56fe</li> <li>V$CONTAINERS</li> <li>V$PDBS</li> <li>CDB_USERS</li> <li> <p>DBA_PDBS</p> </li> <li> <p>\u6027\u80fd\u76f8\u5173\u89c6\u56fe</p> </li> <li>V$SYSSTAT</li> <li>V$SYSTEM_EVENT</li> <li>V$SESSION_WAIT</li> <li> <p>V$SQL</p> </li> <li> <p>\u5b58\u50a8\u76f8\u5173\u89c6\u56fe</p> </li> <li>V$DATAFILE</li> <li>V$TEMPFILE</li> <li>V$CONTROLFILE</li> <li>V$LOGFILE</li> </ol>"},{"location":"dba/oracle-pdb-guide.html#c","title":"C. \u53c2\u8003\u8d44\u6599","text":"<ul> <li>Oracle \u5b98\u65b9\u6587\u6863</li> <li>Oracle Support \u77e5\u8bc6\u5e93</li> <li>Oracle \u6280\u672f\u7f51\u7edc\uff08OTN\uff09</li> <li>Oracle \u5b66\u4e60\u8d44\u6e90\u5e93</li> </ul>"},{"location":"dba/%E4%BA%BA%E5%A4%A7%E9%87%91%E4%BB%93KingbaseES-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html","title":"\u4eba\u5927\u91d1\u4ed3 KingbaseES\uff1a\u5165\u95e8\u4e0e\u5b89\u88c5\u5b9e\u8df5","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aDBA\u3001\u884c\u4e1a\u4fe1\u606f\u5316\u4eba\u5458\u3001\u66ff\u4ee3\u8bc4\u4f30\u4eba\u5458 \u76ee\u6807\uff1a\u5b8c\u6210 KingbaseES \u5b89\u88c5\u3001\u521d\u59cb\u5316\u3001\u57fa\u7840 SQL \u4e0e\u5907\u4efd\u6062\u590d\u3002</p>"},{"location":"dba/%E4%BA%BA%E5%A4%A7%E9%87%91%E4%BB%93KingbaseES-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#1-kingbasees","title":"1. KingbaseES \u6982\u8ff0","text":"<ul> <li>\u7c7b\u578b\uff1a\u56fd\u4ea7\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0cPostgreSQL \u6df1\u5ea6\u517c\u5bb9</li> <li>\u7aef\u53e3\uff1a\u9ed8\u8ba4 54321\uff1b\u5ba2\u6237\u7aef\uff1aksql\uff1b\u670d\u52a1\u7ba1\u7406\uff1akb_ctl</li> <li>\u573a\u666f\uff1a\u653f\u52a1\u3001\u80fd\u6e90\u3001\u8fd0\u8425\u5546\u3001\u91d1\u878d</li> </ul>"},{"location":"dba/%E4%BA%BA%E5%A4%A7%E9%87%91%E4%BB%93KingbaseES-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#2-linux","title":"2. \u5b89\u88c5\uff08Linux \u793a\u4f8b\uff09","text":"<pre><code># 1) \u5b89\u88c5\nrpm -ivh kingbaseES-std-&lt;version&gt;.rpm\n\n# 2) \u521d\u59cb\u5316\u96c6\u7c07\uff08\u7cfb\u7edf\u7528\u6237 kingbase\uff09\nuseradd -m kingbase\nsu - kingbase\nkb_ctl init -D /data/kingbase/data -U system -W 'System@123' --encoding=UTF8\n\n# 3) \u542f\u52a8\nauthdir=/data/kingbase/data\nkb_ctl start -D $authdir\nkb_ctl status -D $authdir\n</code></pre>"},{"location":"dba/%E4%BA%BA%E5%A4%A7%E9%87%91%E4%BB%93KingbaseES-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#3","title":"3. \u57fa\u7840\u4f7f\u7528","text":"<pre><code>ksql -h 127.0.0.1 -p 54321 -U system -W\n</code></pre> <pre><code>-- \u521b\u5efa\u89d2\u8272\u4e0e\u6570\u636e\u5e93\nCREATE ROLE demo LOGIN PASSWORD 'Demo@123';\nCREATE DATABASE demo OWNER demo ENCODING 'UTF8';\n\\c demo demo\nCREATE TABLE t1(id int primary key, name varchar(50));\nINSERT INTO t1 VALUES (1,'hello'),(2,'kingbase');\nSELECT * FROM t1;\n</code></pre>"},{"location":"dba/%E4%BA%BA%E5%A4%A7%E9%87%91%E4%BB%93KingbaseES-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#4","title":"4. \u8fde\u63a5\u4e0e\u6743\u9650","text":"<ul> <li>pg_hba.conf \u89c4\u5219\u4e0e libpq \u8fde\u63a5\u4e32\u4e0e PG \u57fa\u672c\u4e00\u81f4</li> <li>\u5efa\u8bae\u4ec5\u5f00\u653e\u5185\u7f51\u3001\u767d\u540d\u5355\u63a7\u5236\uff0c\u5f3a\u5bc6\u7801\u7b56\u7565\uff0c\u6700\u5c0f\u6743\u9650</li> </ul> <pre><code># $DATA/pg_hba.conf \u793a\u4f8b\nhost    all     all     192.168.10.0/24    md5\n</code></pre>"},{"location":"dba/%E4%BA%BA%E5%A4%A7%E9%87%91%E4%BB%93KingbaseES-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#5","title":"5. \u5907\u4efd\u4e0e\u6062\u590d","text":"<pre><code># \u903b\u8f91\u5907\u4efd/\u6062\u590d\nkb_dump -h 127.0.0.1 -p 54321 -U demo -d demo -f /backup/demo.sql\nkb_restore -h 127.0.0.1 -p 54321 -U demo -d demo /backup/demo.sql\n\n# \u7269\u7406\u5907\u4efd\uff08\u505c\u5e93\u5feb\u7167\u6216\u4e13\u7528\u5de5\u5177\uff09\nkb_ctl stop -D /data/kingbase/data\n# \u6587\u4ef6\u7cfb\u7edf\u5feb\u7167 -&gt; \u590d\u5236 -&gt; \u542f\u5e93\nkb_ctl start -D /data/kingbase/data\n</code></pre>"},{"location":"dba/%E4%BA%BA%E5%A4%A7%E9%87%91%E4%BB%93KingbaseES-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#6","title":"6. \u5e38\u89c1\u95ee\u9898","text":"<ul> <li>\u7aef\u53e3\u51b2\u7a81\uff1a54321 \u88ab\u5360\u7528\uff0c\u4fee\u6539 postgresql.conf \u4e2d port</li> <li>\u6743\u9650\u4e0d\u8db3\uff1a\u68c0\u67e5 pg_hba.conf \u4e0e\u7528\u6237\u6743\u9650</li> <li>\u6027\u80fd\uff1ashared_buffers\u3001work_mem\u3001checkpoint\u3001autovacuum \u53c2\u7167 PG \u8c03\u4f18</li> </ul>"},{"location":"dba/%E4%BA%BA%E5%A4%A7%E9%87%91%E4%BB%93KingbaseES-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#7","title":"7. \u6700\u4f73\u5b9e\u8df5","text":"<p>1) \u6570\u636e\u4e0e WAL \u5206\u76d8\uff1b2) \u5907\u4efd 3-2-1\uff1b3) \u76d1\u63a7\uff08pg_stat\u3001\u7cfb\u7edf\u6307\u6807\uff09\uff1b4) \u53d8\u66f4\u5ba1\u6279\uff1b5) \u5b9a\u671f VACUUM/ANALYZE</p> <p>\u53c2\u8003\uff1a - KingbaseES \u6587\u6863 https://www.kingbase.com.cn</p>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html","title":"\u6570\u636e\u5e93\u6027\u80fd\u8bca\u65ad\u4e0e\u4f18\u5316\u5b9e\u6218\u624b\u518c","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aDBA\u3001\u6027\u80fd\u5de5\u7a0b\u5e08\u3001\u5f00\u53d1\u5de5\u7a0b\u5e08 \u76ee\u6807\uff1a\u63d0\u4f9b\u8de8\u6570\u636e\u5e93\uff08Oracle/MySQL/PostgreSQL\uff09\u7684\u6027\u80fd\u8bca\u65ad\u65b9\u6cd5\u8bba\u548c\u4f18\u5316\u5b9e\u6218\u6848\u4f8b\u3002</p>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#1","title":"1. \u6027\u80fd\u95ee\u9898\u5206\u7c7b","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#11","title":"1.1 \u95ee\u9898\u7c7b\u578b","text":"\u7c7b\u578b \u75c7\u72b6 \u5e38\u89c1\u539f\u56e0 \u4f18\u5148\u7ea7 \u6162\u67e5\u8be2 \u5355\u6761 SQL \u6267\u884c\u6162 \u7f3a\u5931\u7d22\u5f15\u3001\u5168\u8868\u626b\u63cf\u3001\u9501\u7b49\u5f85 \u9ad8 \u9ad8\u5e76\u53d1 \u8fde\u63a5\u6570\u8017\u5c3d\u3001\u54cd\u5e94\u6162 \u8fde\u63a5\u6c60\u914d\u7f6e\u3001\u8d44\u6e90\u7ade\u4e89 \u9ad8 \u9501\u7b49\u5f85 \u4e8b\u52a1\u963b\u585e\u3001\u8d85\u65f6 \u957f\u4e8b\u52a1\u3001\u6b7b\u9501\u3001\u9501\u5347\u7ea7 \u9ad8 IO \u74f6\u9888 \u78c1\u76d8 IO \u9ad8 \u5927\u8868\u626b\u63cf\u3001\u5f52\u6863\u6162\u3001RAID \u914d\u7f6e \u4e2d \u5185\u5b58\u4e0d\u8db3 OOM\u3001\u9891\u7e41 Swap Buffer Pool \u5c0f\u3001\u5185\u5b58\u6cc4\u6f0f \u4e2d CPU \u74f6\u9888 CPU 100% \u590d\u6742\u8ba1\u7b97\u3001\u6392\u5e8f\u3001\u805a\u5408 \u4e2d"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#12","title":"1.2 \u8bca\u65ad\u6d41\u7a0b","text":"<pre><code>1. \u73b0\u8c61\u786e\u8ba4\n   \u2193\n2. \u76d1\u63a7\u6570\u636e\u6536\u96c6\uff08CPU/\u5185\u5b58/IO/\u7f51\u7edc\uff09\n   \u2193\n3. \u6570\u636e\u5e93\u5c42\u9762\u5206\u6790\uff08\u6162\u67e5\u8be2/\u9501/\u7b49\u5f85\u4e8b\u4ef6\uff09\n   \u2193\n4. \u5e94\u7528\u5c42\u9762\u5206\u6790\uff08\u8fde\u63a5\u6c60/\u4e8b\u52a1/\u7f13\u5b58\uff09\n   \u2193\n5. \u5b9a\u4f4d\u6839\u56e0\n   \u2193\n6. \u5236\u5b9a\u4f18\u5316\u65b9\u6848\n   \u2193\n7. \u5b9e\u65bd\u9a8c\u8bc1\n   \u2193\n8. \u6301\u7eed\u76d1\u63a7\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#2-oracle","title":"2. Oracle \u6027\u80fd\u8bca\u65ad","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#21-awr","title":"2.1 AWR \u62a5\u544a\u5206\u6790","text":"<pre><code>-- \u751f\u6210 AWR \u62a5\u544a\n@?/rdbms/admin/awrrpt.sql\n\n-- \u5173\u952e\u6307\u6807\uff1a\n-- 1. Top 5 Timed Events\uff08\u7b49\u5f85\u4e8b\u4ef6\uff09\n-- 2. SQL ordered by Elapsed Time\uff08\u6162\u67e5\u8be2\uff09\n-- 3. Segment Statistics\uff08\u70ed\u70b9\u8868/\u7d22\u5f15\uff09\n-- 4. Instance Efficiency Percentages\uff08\u7f13\u5b58\u547d\u4e2d\u7387\uff09\n</code></pre> <p>AWR \u62a5\u544a\u89e3\u8bfb\uff1a</p> <pre><code>Top 5 Timed Events:\n1. db file scattered read  -- \u5168\u8868\u626b\u63cf\uff0c\u9700\u8981\u7d22\u5f15\n2. db file sequential read -- \u7d22\u5f15\u626b\u63cf\uff0c\u53ef\u80fd\u7d22\u5f15\u788e\u7247\n3. log file sync            -- \u63d0\u4ea4\u9891\u7e41\uff0c\u8003\u8651\u6279\u91cf\u63d0\u4ea4\n4. enq: TX - row lock       -- \u884c\u9501\u7b49\u5f85\uff0c\u68c0\u67e5\u957f\u4e8b\u52a1\n5. CPU time                 -- CPU \u74f6\u9888\uff0c\u4f18\u5316 SQL \u903b\u8f91\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#22","title":"2.2 \u5b9e\u65f6\u4f1a\u8bdd\u8bca\u65ad","text":"<pre><code>-- \u67e5\u770b\u6d3b\u52a8\u4f1a\u8bdd\nSELECT \n    s.sid,\n    s.serial#,\n    s.username,\n    s.program,\n    s.machine,\n    s.status,\n    s.sql_id,\n    s.event,\n    s.wait_class,\n    s.seconds_in_wait,\n    s.blocking_session\nFROM v$session s\nWHERE s.status = 'ACTIVE'\n  AND s.username IS NOT NULL\nORDER BY s.seconds_in_wait DESC;\n\n-- \u67e5\u770b\u5f53\u524d SQL\nSELECT sql_text \nFROM v$sql \nWHERE sql_id = '&amp;sql_id';\n\n-- \u67e5\u770b\u6267\u884c\u8ba1\u5212\nSELECT * FROM TABLE(DBMS_XPLAN.DISPLAY_CURSOR('&amp;sql_id', NULL, 'ALLSTATS LAST'));\n\n-- \u67e5\u770b\u9501\u7b49\u5f85\nSELECT \n    s1.username || '@' || s1.machine AS blocker,\n    s1.sid AS blocker_sid,\n    s2.username || '@' || s2.machine AS waiter,\n    s2.sid AS waiter_sid,\n    lo.oracle_username,\n    lo.os_user_name,\n    ao.object_name,\n    lo.locked_mode\nFROM v$locked_object lo\nJOIN all_objects ao ON lo.object_id = ao.object_id\nJOIN v$session s1 ON lo.session_id = s1.sid\nJOIN v$session s2 ON s1.blocking_session = s2.sid;\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#23-sql","title":"2.3 SQL \u8c03\u4f18","text":"<pre><code>-- \u6536\u96c6\u7edf\u8ba1\u4fe1\u606f\nEXEC DBMS_STATS.GATHER_TABLE_STATS('SCHEMA_NAME', 'TABLE_NAME', CASCADE =&gt; TRUE);\n\n-- \u67e5\u770b\u6267\u884c\u8ba1\u5212\nEXPLAIN PLAN FOR\nSELECT * FROM orders WHERE user_id = 12345;\n\nSELECT * FROM TABLE(DBMS_XPLAN.DISPLAY);\n\n-- \u521b\u5efa\u7d22\u5f15\nCREATE INDEX idx_orders_user_id ON orders(user_id);\n\n-- \u4f7f\u7528 Hint \u5f3a\u5236\u7d22\u5f15\nSELECT /*+ INDEX(orders idx_orders_user_id) */ * \nFROM orders \nWHERE user_id = 12345;\n\n-- \u5206\u6790 SQL \u6027\u80fd\nSELECT \n    sql_id,\n    executions,\n    elapsed_time / 1000000 AS elapsed_sec,\n    cpu_time / 1000000 AS cpu_sec,\n    buffer_gets,\n    disk_reads,\n    rows_processed,\n    ROUND(elapsed_time / executions / 1000000, 2) AS avg_elapsed_sec\nFROM v$sql\nWHERE executions &gt; 0\nORDER BY elapsed_time DESC\nFETCH FIRST 20 ROWS ONLY;\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#3-mysql","title":"3. MySQL \u6027\u80fd\u8bca\u65ad","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#31","title":"3.1 \u6162\u67e5\u8be2\u65e5\u5fd7\u5206\u6790","text":"<pre><code># \u542f\u7528\u6162\u67e5\u8be2\u65e5\u5fd7\n[mysqld]\nslow_query_log = 1\nslow_query_log_file = /var/log/mysql/slow.log\nlong_query_time = 1\nlog_queries_not_using_indexes = 1\n\n# \u4f7f\u7528 pt-query-digest \u5206\u6790\npt-query-digest /var/log/mysql/slow.log &gt; slow_report.txt\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\n# Query 1: 0.12 QPS, 1.23x concurrency, ID 0xABCD1234\n# Calls: 1000, Time: 1234.56s (avg 1.23s)\n# SELECT * FROM orders WHERE status = 'pending' ORDER BY created_at DESC LIMIT 100\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#32","title":"3.2 \u5b9e\u65f6\u6027\u80fd\u76d1\u63a7","text":"<pre><code>-- \u67e5\u770b\u5f53\u524d\u8fde\u63a5\nSHOW PROCESSLIST;\n\n-- \u67e5\u770b\u6162\u67e5\u8be2\nSELECT \n    id,\n    user,\n    host,\n    db,\n    command,\n    time,\n    state,\n    info\nFROM information_schema.processlist\nWHERE time &gt; 5\n  AND command != 'Sleep'\nORDER BY time DESC;\n\n-- \u67e5\u770b\u9501\u7b49\u5f85\nSELECT \n    r.trx_id AS waiting_trx_id,\n    r.trx_mysql_thread_id AS waiting_thread,\n    r.trx_query AS waiting_query,\n    b.trx_id AS blocking_trx_id,\n    b.trx_mysql_thread_id AS blocking_thread,\n    b.trx_query AS blocking_query\nFROM information_schema.innodb_lock_waits w\nJOIN information_schema.innodb_trx b ON b.trx_id = w.blocking_trx_id\nJOIN information_schema.innodb_trx r ON r.trx_id = w.requesting_trx_id;\n\n-- \u67e5\u770b\u8868\u7edf\u8ba1\u4fe1\u606f\nSELECT \n    table_schema,\n    table_name,\n    table_rows,\n    avg_row_length,\n    data_length / 1024 / 1024 AS data_mb,\n    index_length / 1024 / 1024 AS index_mb\nFROM information_schema.tables\nWHERE table_schema = 'mydb'\nORDER BY data_length DESC;\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#33","title":"3.3 \u6267\u884c\u8ba1\u5212\u5206\u6790","text":"<pre><code>-- \u67e5\u770b\u6267\u884c\u8ba1\u5212\nEXPLAIN SELECT * FROM orders WHERE user_id = 12345;\n\n-- \u8f93\u51fa\u793a\u4f8b\uff1a\n-- id | select_type | table  | type | possible_keys | key  | rows | Extra\n-- 1  | SIMPLE      | orders | ref  | idx_user_id   | idx_user_id | 100 | Using where\n\n-- type \u7c7b\u578b\uff08\u6027\u80fd\u4ece\u597d\u5230\u5dee\uff09\uff1a\n-- system &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt; ALL\n\n-- \u8be6\u7ec6\u6267\u884c\u8ba1\u5212\nEXPLAIN FORMAT=JSON SELECT * FROM orders WHERE user_id = 12345;\n\n-- \u5b9e\u9645\u6267\u884c\u7edf\u8ba1\nEXPLAIN ANALYZE SELECT * FROM orders WHERE user_id = 12345;\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#34","title":"3.4 \u7d22\u5f15\u4f18\u5316","text":"<pre><code>-- \u67e5\u770b\u672a\u4f7f\u7528\u7684\u7d22\u5f15\nSELECT \n    t.table_schema,\n    t.table_name,\n    s.index_name,\n    s.column_name\nFROM information_schema.statistics s\nJOIN information_schema.tables t ON s.table_schema = t.table_schema \n    AND s.table_name = t.table_name\nLEFT JOIN sys.schema_unused_indexes u ON s.table_schema = u.object_schema \n    AND s.table_name = u.object_name \n    AND s.index_name = u.index_name\nWHERE t.table_schema = 'mydb'\n  AND s.index_name != 'PRIMARY'\n  AND u.index_name IS NOT NULL;\n\n-- \u67e5\u770b\u91cd\u590d\u7d22\u5f15\nSELECT \n    a.table_schema,\n    a.table_name,\n    a.index_name AS index1,\n    b.index_name AS index2,\n    a.column_name\nFROM information_schema.statistics a\nJOIN information_schema.statistics b ON a.table_schema = b.table_schema\n    AND a.table_name = b.table_name\n    AND a.column_name = b.column_name\n    AND a.index_name &lt; b.index_name\nWHERE a.table_schema = 'mydb'\nORDER BY a.table_name, a.column_name;\n\n-- \u521b\u5efa\u590d\u5408\u7d22\u5f15\nCREATE INDEX idx_orders_user_status ON orders(user_id, status);\n\n-- \u5220\u9664\u672a\u4f7f\u7528\u7d22\u5f15\nDROP INDEX idx_unused ON orders;\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#4-postgresql","title":"4. PostgreSQL \u6027\u80fd\u8bca\u65ad","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#41-pg_stat_statements","title":"4.1 pg_stat_statements \u5206\u6790","text":"<pre><code>-- \u542f\u7528 pg_stat_statements\nCREATE EXTENSION pg_stat_statements;\n\n-- postgresql.conf\nshared_preload_libraries = 'pg_stat_statements'\npg_stat_statements.track = all\n\n-- \u67e5\u770b\u6162\u67e5\u8be2\nSELECT \n    query,\n    calls,\n    total_exec_time / 1000 AS total_sec,\n    mean_exec_time / 1000 AS avg_sec,\n    max_exec_time / 1000 AS max_sec,\n    rows,\n    100.0 * shared_blks_hit / NULLIF(shared_blks_hit + shared_blks_read, 0) AS cache_hit_ratio\nFROM pg_stat_statements\nORDER BY total_exec_time DESC\nLIMIT 20;\n\n-- \u91cd\u7f6e\u7edf\u8ba1\nSELECT pg_stat_statements_reset();\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#42","title":"4.2 \u5b9e\u65f6\u4f1a\u8bdd\u76d1\u63a7","text":"<pre><code>-- \u67e5\u770b\u6d3b\u52a8\u4f1a\u8bdd\nSELECT \n    pid,\n    usename,\n    application_name,\n    client_addr,\n    state,\n    query_start,\n    state_change,\n    wait_event_type,\n    wait_event,\n    query\nFROM pg_stat_activity\nWHERE state = 'active'\n  AND pid != pg_backend_pid()\nORDER BY query_start;\n\n-- \u67e5\u770b\u9501\u7b49\u5f85\nSELECT \n    blocked_locks.pid AS blocked_pid,\n    blocked_activity.usename AS blocked_user,\n    blocking_locks.pid AS blocking_pid,\n    blocking_activity.usename AS blocking_user,\n    blocked_activity.query AS blocked_statement,\n    blocking_activity.query AS blocking_statement,\n    blocked_activity.application_name\nFROM pg_catalog.pg_locks blocked_locks\nJOIN pg_catalog.pg_stat_activity blocked_activity ON blocked_activity.pid = blocked_locks.pid\nJOIN pg_catalog.pg_locks blocking_locks ON blocking_locks.locktype = blocked_locks.locktype\n    AND blocking_locks.database IS NOT DISTINCT FROM blocked_locks.database\n    AND blocking_locks.relation IS NOT DISTINCT FROM blocked_locks.relation\n    AND blocking_locks.page IS NOT DISTINCT FROM blocked_locks.page\n    AND blocking_locks.tuple IS NOT DISTINCT FROM blocked_locks.tuple\n    AND blocking_locks.virtualxid IS NOT DISTINCT FROM blocked_locks.virtualxid\n    AND blocking_locks.transactionid IS NOT DISTINCT FROM blocked_locks.transactionid\n    AND blocking_locks.classid IS NOT DISTINCT FROM blocked_locks.classid\n    AND blocking_locks.objid IS NOT DISTINCT FROM blocked_locks.objid\n    AND blocking_locks.objsubid IS NOT DISTINCT FROM blocked_locks.objsubid\n    AND blocking_locks.pid != blocked_locks.pid\nJOIN pg_catalog.pg_stat_activity blocking_activity ON blocking_activity.pid = blocking_locks.pid\nWHERE NOT blocked_locks.granted;\n\n-- \u7ec8\u6b62\u6162\u67e5\u8be2\nSELECT pg_cancel_backend(12345);  -- \u53d6\u6d88\u67e5\u8be2\nSELECT pg_terminate_backend(12345);  -- \u7ec8\u6b62\u8fde\u63a5\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#43","title":"4.3 \u6267\u884c\u8ba1\u5212\u5206\u6790","text":"<pre><code>-- \u67e5\u770b\u6267\u884c\u8ba1\u5212\nEXPLAIN SELECT * FROM orders WHERE user_id = 12345;\n\n-- \u8be6\u7ec6\u6267\u884c\u8ba1\u5212\nEXPLAIN (ANALYZE, BUFFERS, VERBOSE) \nSELECT * FROM orders WHERE user_id = 12345;\n\n-- \u8f93\u51fa\u793a\u4f8b\uff1a\n-- Index Scan using idx_orders_user_id on orders  (cost=0.43..8.45 rows=1 width=100) (actual time=0.012..0.013 rows=1 loops=1)\n--   Index Cond: (user_id = 12345)\n--   Buffers: shared hit=4\n-- Planning Time: 0.123 ms\n-- Execution Time: 0.045 ms\n\n-- \u67e5\u770b\u8868\u81a8\u80c0\nSELECT \n    schemaname,\n    tablename,\n    pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) AS total_size,\n    pg_size_pretty(pg_relation_size(schemaname||'.'||tablename)) AS table_size,\n    pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename) - pg_relation_size(schemaname||'.'||tablename)) AS index_size,\n    n_dead_tup,\n    n_live_tup,\n    ROUND(100 * n_dead_tup / NULLIF(n_live_tup + n_dead_tup, 0), 2) AS dead_ratio\nFROM pg_stat_user_tables\nORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#44-vacuum","title":"4.4 VACUUM \u4e0e\u7d22\u5f15\u7ef4\u62a4","text":"<pre><code>-- \u624b\u52a8 VACUUM\nVACUUM VERBOSE ANALYZE orders;\n\n-- \u67e5\u770b autovacuum \u72b6\u6001\nSELECT \n    schemaname,\n    tablename,\n    last_vacuum,\n    last_autovacuum,\n    last_analyze,\n    last_autoanalyze,\n    vacuum_count,\n    autovacuum_count\nFROM pg_stat_user_tables\nORDER BY last_autovacuum NULLS FIRST;\n\n-- \u91cd\u5efa\u7d22\u5f15\nREINDEX INDEX idx_orders_user_id;\nREINDEX TABLE orders;\n\n-- \u67e5\u770b\u7d22\u5f15\u4f7f\u7528\u60c5\u51b5\nSELECT \n    schemaname,\n    tablename,\n    indexname,\n    idx_scan,\n    idx_tup_read,\n    idx_tup_fetch,\n    pg_size_pretty(pg_relation_size(indexrelid)) AS index_size\nFROM pg_stat_user_indexes\nWHERE schemaname = 'public'\nORDER BY idx_scan;\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#5","title":"5. \u901a\u7528\u4f18\u5316\u7b56\u7565","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#51","title":"5.1 \u7d22\u5f15\u4f18\u5316\u539f\u5219","text":"<pre><code>1. \u9009\u62e9\u6027\u9ad8\u7684\u5217\u4f18\u5148\u5efa\u7d22\u5f15\uff08\u552f\u4e00\u503c\u591a\uff09\n2. WHERE/JOIN/ORDER BY \u5b50\u53e5\u4e2d\u7684\u5217\n3. \u590d\u5408\u7d22\u5f15\u9075\u5faa\u6700\u5de6\u524d\u7f00\u539f\u5219\n4. \u907f\u514d\u8fc7\u591a\u7d22\u5f15\uff08\u5f71\u54cd\u5199\u5165\u6027\u80fd\uff09\n5. \u5b9a\u671f\u91cd\u5efa\u788e\u7247\u5316\u7d22\u5f15\n6. \u5220\u9664\u672a\u4f7f\u7528\u7684\u7d22\u5f15\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#52-sql","title":"5.2 SQL \u4f18\u5316\u6280\u5de7","text":"<pre><code>-- \u907f\u514d SELECT *\n-- \u4e0d\u63a8\u8350\nSELECT * FROM orders WHERE user_id = 12345;\n-- \u63a8\u8350\nSELECT order_id, user_id, amount, created_at FROM orders WHERE user_id = 12345;\n\n-- \u907f\u514d\u51fd\u6570\u5305\u88f9\u7d22\u5f15\u5217\n-- \u4e0d\u63a8\u8350\nSELECT * FROM orders WHERE DATE(created_at) = '2025-11-11';\n-- \u63a8\u8350\nSELECT * FROM orders WHERE created_at &gt;= '2025-11-11' AND created_at &lt; '2025-11-12';\n\n-- \u4f7f\u7528 LIMIT \u9650\u5236\u7ed3\u679c\u96c6\nSELECT * FROM orders ORDER BY created_at DESC LIMIT 100;\n\n-- \u6279\u91cf\u64cd\u4f5c\u4ee3\u66ff\u5faa\u73af\n-- \u4e0d\u63a8\u8350\nFOR i IN 1..10000 LOOP\n    INSERT INTO logs VALUES (i, 'message');\nEND LOOP;\n-- \u63a8\u8350\nINSERT INTO logs SELECT generate_series(1, 10000), 'message';\n\n-- \u4f7f\u7528 EXISTS \u4ee3\u66ff IN\uff08\u5927\u6570\u636e\u96c6\uff09\n-- \u4e0d\u63a8\u8350\nSELECT * FROM users WHERE user_id IN (SELECT user_id FROM orders);\n-- \u63a8\u8350\nSELECT * FROM users u WHERE EXISTS (SELECT 1 FROM orders o WHERE o.user_id = u.user_id);\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#53","title":"5.3 \u8fde\u63a5\u6c60\u4f18\u5316","text":"<pre><code># HikariCP \u914d\u7f6e\nhikari.maximum-pool-size=20\nhikari.minimum-idle=5\nhikari.connection-timeout=30000\nhikari.idle-timeout=600000\nhikari.max-lifetime=1800000\nhikari.leak-detection-threshold=60000\n\n# \u8ba1\u7b97\u516c\u5f0f\uff1a\n# connections = ((core_count * 2) + effective_spindle_count)\n# \u4f8b\u5982\uff1a8\u6838 + 4\u5757\u78c1\u76d8 = (8 * 2) + 4 = 20\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#6","title":"6. \u5b9e\u6218\u6848\u4f8b","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#1_1","title":"\u6848\u4f8b1\uff1a\u6162\u67e5\u8be2\u4f18\u5316","text":"<pre><code>-- \u95ee\u9898 SQL\uff08\u6267\u884c 5 \u79d2\uff09\nSELECT * FROM orders \nWHERE status = 'pending' \nORDER BY created_at DESC \nLIMIT 100;\n\n-- \u8bca\u65ad\uff1a\nEXPLAIN ANALYZE ...\n-- Seq Scan on orders  (cost=0.00..1234567.89 rows=1000000 width=100)\n-- \u5168\u8868\u626b\u63cf\uff01\n\n-- \u4f18\u5316\u65b9\u6848\uff1a\nCREATE INDEX idx_orders_status_created ON orders(status, created_at DESC);\n\n-- \u4f18\u5316\u540e\uff08\u6267\u884c 0.05 \u79d2\uff09\n-- Index Scan using idx_orders_status_created on orders  (cost=0.43..8.45 rows=100 width=100)\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#2","title":"\u6848\u4f8b2\uff1a\u9501\u7b49\u5f85\u4f18\u5316","text":"<pre><code>-- \u95ee\u9898\uff1a\u5927\u91cf\u9501\u7b49\u5f85\n-- \u539f\u56e0\uff1a\u957f\u4e8b\u52a1\u672a\u63d0\u4ea4\n\n-- \u8bca\u65ad\uff1a\nSELECT * FROM pg_stat_activity WHERE state = 'idle in transaction';\n\n-- \u4f18\u5316\u65b9\u6848\uff1a\n-- 1. \u7f29\u77ed\u4e8b\u52a1\u65f6\u95f4\n-- 2. \u8bbe\u7f6e\u8d85\u65f6\nSET statement_timeout = '30s';\nSET lock_timeout = '10s';\n\n-- 3. \u5e94\u7528\u5c42\u4f18\u5316\n-- - \u907f\u514d\u5728\u4e8b\u52a1\u4e2d\u6267\u884c\u8017\u65f6\u64cd\u4f5c\n-- - \u4f7f\u7528\u4e50\u89c2\u9501\u4ee3\u66ff\u60b2\u89c2\u9501\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#3","title":"\u6848\u4f8b3\uff1a\u8868\u81a8\u80c0\u4f18\u5316","text":"<pre><code>-- \u95ee\u9898\uff1a\u8868\u81a8\u80c0\u4e25\u91cd\uff08\u6b7b\u5143\u7ec4 &gt; 50%\uff09\n-- \u8bca\u65ad\uff1a\nSELECT * FROM pg_stat_user_tables WHERE dead_ratio &gt; 50;\n\n-- \u4f18\u5316\u65b9\u6848\uff1a\n-- 1. \u624b\u52a8 VACUUM\nVACUUM FULL orders;  -- \u9501\u8868\uff0c\u614e\u7528\n\n-- 2. \u8c03\u6574 autovacuum \u53c2\u6570\nALTER TABLE orders SET (autovacuum_vacuum_scale_factor = 0.05);\nALTER TABLE orders SET (autovacuum_analyze_scale_factor = 0.02);\n\n-- 3. \u4f7f\u7528 pg_repack\uff08\u5728\u7ebf\u91cd\u5efa\uff09\npg_repack -t orders -d mydb\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#7","title":"7. \u76d1\u63a7\u544a\u8b66","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#71","title":"7.1 \u5173\u952e\u6307\u6807","text":"<pre><code>\u6570\u636e\u5e93\u5c42\uff1a\n- QPS/TPS\n- \u6162\u67e5\u8be2\u6570\u91cf\n- \u8fde\u63a5\u6570\u4f7f\u7528\u7387\n- \u7f13\u5b58\u547d\u4e2d\u7387\n- \u9501\u7b49\u5f85\u65f6\u95f4\n- \u590d\u5236\u5ef6\u8fdf\n\n\u7cfb\u7edf\u5c42\uff1a\n- CPU \u4f7f\u7528\u7387\n- \u5185\u5b58\u4f7f\u7528\u7387\n- \u78c1\u76d8 IO\uff08IOPS/\u541e\u5410\u91cf\uff09\n- \u7f51\u7edc\u6d41\u91cf\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#72","title":"7.2 \u544a\u8b66\u9608\u503c","text":"<pre><code>- \u6162\u67e5\u8be2 &gt; 1s\uff1a\u8b66\u544a\n- \u6162\u67e5\u8be2 &gt; 5s\uff1a\u4e25\u91cd\n- \u8fde\u63a5\u6570 &gt; 80%\uff1a\u8b66\u544a\n- \u8fde\u63a5\u6570 &gt; 95%\uff1a\u4e25\u91cd\n- \u590d\u5236\u5ef6\u8fdf &gt; 10s\uff1a\u8b66\u544a\n- \u590d\u5236\u5ef6\u8fdf &gt; 60s\uff1a\u4e25\u91cd\n- CPU &gt; 80%\uff1a\u8b66\u544a\n- \u78c1\u76d8 IO \u7b49\u5f85 &gt; 50%\uff1a\u8b66\u544a\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%89%8B%E5%86%8C.html#8","title":"8. \u5de5\u5177\u63a8\u8350","text":"\u5de5\u5177 \u7528\u9014 \u652f\u6301\u6570\u636e\u5e93 pt-query-digest \u6162\u67e5\u8be2\u5206\u6790 MySQL pg_stat_statements \u6162\u67e5\u8be2\u5206\u6790 PostgreSQL AWR/ASH \u6027\u80fd\u62a5\u544a Oracle Prometheus + Grafana \u76d1\u63a7\u53ef\u89c6\u5316 \u5168\u90e8 pgBadger \u65e5\u5fd7\u5206\u6790 PostgreSQL MySQLTuner \u53c2\u6570\u4f18\u5316\u5efa\u8bae MySQL pg_repack \u5728\u7ebf\u8868\u91cd\u5efa PostgreSQL Percona Toolkit \u6027\u80fd\u5de5\u5177\u96c6 MySQL <p>\u603b\u7ed3\uff1a\u6027\u80fd\u4f18\u5316\u662f\u6301\u7eed\u8fc7\u7a0b\uff0c\u9700\u8981\u76d1\u63a7\u3001\u8bca\u65ad\u3001\u4f18\u5316\u3001\u9a8c\u8bc1\u7684\u95ed\u73af\u3002</p>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html","title":"\u6570\u636e\u5e93\u8fc1\u79fb\u65b9\u6848\uff1aOracle \u5230 PostgreSQL","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aDBA\u3001\u67b6\u6784\u5e08\u3001\u9879\u76ee\u7ecf\u7406 \u76ee\u6807\uff1a\u63d0\u4f9b\u4ece Oracle \u8fc1\u79fb\u5230 PostgreSQL \u7684\u5b8c\u6574\u65b9\u6848\uff0c\u5305\u62ec\u8bc4\u4f30\u3001\u8fc1\u79fb\u3001\u9a8c\u8bc1\u3001\u4f18\u5316\u5168\u6d41\u7a0b\u3002</p>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#1","title":"1. \u8fc1\u79fb\u80cc\u666f\u4e0e\u52a8\u673a","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#11-postgresql","title":"1.1 \u4e3a\u4ec0\u4e48\u8fc1\u79fb\u5230 PostgreSQL","text":"<ul> <li>\u6210\u672c\u4f18\u52bf\uff1a\u5f00\u6e90\u514d\u8d39\uff0c\u65e0 License \u8d39\u7528</li> <li>\u529f\u80fd\u5b8c\u5584\uff1a\u652f\u6301 ACID\u3001\u4e8b\u52a1\u3001\u5b58\u50a8\u8fc7\u7a0b\u3001\u89e6\u53d1\u5668\u3001\u89c6\u56fe</li> <li>\u751f\u6001\u4e30\u5bcc\uff1aPostGIS\uff08\u5730\u7406\u4fe1\u606f\uff09\u3001TimescaleDB\uff08\u65f6\u5e8f\u6570\u636e\uff09\u3001Citus\uff08\u5206\u5e03\u5f0f\uff09</li> <li>\u793e\u533a\u6d3b\u8dc3\uff1a\u5feb\u901f\u8fed\u4ee3\uff0c\u5b89\u5168\u8865\u4e01\u53ca\u65f6</li> <li>\u4e91\u539f\u751f\uff1aAWS RDS\u3001Azure Database\u3001\u963f\u91cc\u4e91 RDS \u7b49\u5b8c\u5584\u652f\u6301</li> </ul>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#12","title":"1.2 \u8fc1\u79fb\u6311\u6218","text":"\u6311\u6218 \u5f71\u54cd \u89e3\u51b3\u65b9\u6848 SQL \u8bed\u6cd5\u5dee\u5f02 \u5e94\u7528\u6539\u9020 \u4f7f\u7528 Orafce \u63d2\u4ef6\u3001\u6539\u5199 SQL PL/SQL \u2192 PL/pgSQL \u5b58\u50a8\u8fc7\u7a0b\u6539\u5199 \u9010\u4e2a\u8fc1\u79fb\u3001\u6d4b\u8bd5 \u6570\u636e\u7c7b\u578b\u5dee\u5f02 \u6570\u636e\u8f6c\u6362 \u7c7b\u578b\u6620\u5c04\u3001ETL \u5de5\u5177 \u6027\u80fd\u5dee\u5f02 \u67e5\u8be2\u6162 \u7d22\u5f15\u4f18\u5316\u3001\u53c2\u6570\u8c03\u4f18 \u4e1a\u52a1\u505c\u673a\u65f6\u95f4 \u670d\u52a1\u4e2d\u65ad \u53cc\u5199\u3001\u903b\u8f91\u590d\u5236\u3001\u7070\u5ea6\u5207\u6362"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#2","title":"2. \u8fc1\u79fb\u524d\u8bc4\u4f30","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#21","title":"2.1 \u6570\u636e\u5e93\u5bf9\u8c61\u6e05\u5355","text":"<pre><code>-- Oracle \u7aef\u6267\u884c\n-- \u7edf\u8ba1\u8868\u6570\u91cf\nSELECT COUNT(*) FROM user_tables;\n\n-- \u7edf\u8ba1\u7d22\u5f15\u6570\u91cf\nSELECT COUNT(*) FROM user_indexes;\n\n-- \u7edf\u8ba1\u5b58\u50a8\u8fc7\u7a0b/\u51fd\u6570\nSELECT object_type, COUNT(*) \nFROM user_objects \nWHERE object_type IN ('PROCEDURE', 'FUNCTION', 'PACKAGE', 'TRIGGER')\nGROUP BY object_type;\n\n-- \u7edf\u8ba1\u89c6\u56fe\nSELECT COUNT(*) FROM user_views;\n\n-- \u7edf\u8ba1\u5e8f\u5217\nSELECT COUNT(*) FROM user_sequences;\n\n-- \u7edf\u8ba1\u6570\u636e\u91cf\nSELECT \n    table_name,\n    num_rows,\n    blocks,\n    avg_row_len\nFROM user_tables\nORDER BY num_rows DESC;\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#22","title":"2.2 \u517c\u5bb9\u6027\u8bc4\u4f30","text":"<pre><code># \u4f7f\u7528 ora2pg \u8fdb\u884c\u8bc4\u4f30\nyum install -y ora2pg\n\n# \u914d\u7f6e ora2pg.conf\ncat &gt; /etc/ora2pg/ora2pg.conf &lt;&lt;EOF\nORACLE_DSN  dbi:Oracle:host=192.168.1.10;sid=ORCL;port=1521\nORACLE_USER system\nORACLE_PWD  Oracle123#\nSCHEMA      MYAPP\nTYPE        TABLE,VIEW,SEQUENCE,FUNCTION,PROCEDURE,TRIGGER,PACKAGE\nOUTPUT      /tmp/migration_report.html\nEOF\n\n# \u751f\u6210\u8bc4\u4f30\u62a5\u544a\nora2pg -c /etc/ora2pg/ora2pg.conf -t SHOW_REPORT --estimate_cost &gt; /tmp/migration_cost.txt\n\n# \u62a5\u544a\u5305\u542b\uff1a\n# - \u8fc1\u79fb\u96be\u5ea6\u8bc4\u5206\uff081-5\u661f\uff09\n# - \u9700\u8981\u6539\u5199\u7684\u5bf9\u8c61\u5217\u8868\n# - \u9884\u4f30\u5de5\u4f5c\u91cf\uff08\u4eba\u5929\uff09\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#23","title":"2.3 \u5e94\u7528\u4f9d\u8d56\u5206\u6790","text":"<pre><code>\u68c0\u67e5\u6e05\u5355\uff1a\n\u25a1 JDBC/ODBC \u9a71\u52a8\u7248\u672c\n\u25a1 ORM \u6846\u67b6\uff08Hibernate/MyBatis\uff09\u914d\u7f6e\n\u25a1 \u8fde\u63a5\u6c60\u914d\u7f6e\uff08HikariCP/Druid\uff09\n\u25a1 SQL \u65b9\u8a00\uff08Oracle \u7279\u6709\u51fd\u6570\uff09\n\u25a1 \u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\n\u25a1 \u5b57\u7b26\u96c6\uff08Oracle: AL32UTF8 \u2192 PostgreSQL: UTF8\uff09\n\u25a1 \u65e5\u671f\u683c\u5f0f\uff08TO_DATE \u2192 TO_TIMESTAMP\uff09\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#3","title":"3. \u8fc1\u79fb\u65b9\u6848\u8bbe\u8ba1","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#31","title":"3.1 \u8fc1\u79fb\u7b56\u7565\u9009\u62e9","text":"\u7b56\u7565 \u505c\u673a\u65f6\u95f4 \u590d\u6742\u5ea6 \u9002\u7528\u573a\u666f \u505c\u673a\u8fc1\u79fb \u957f\uff08\u6570\u5c0f\u65f6\uff09 \u4f4e \u975e\u6838\u5fc3\u7cfb\u7edf\u3001\u53ef\u63a5\u53d7\u957f\u65f6\u95f4\u505c\u673a \u53cc\u5199\u5207\u6362 \u77ed\uff08\u5206\u949f\u7ea7\uff09 \u4e2d \u6838\u5fc3\u7cfb\u7edf\u3001\u9700\u8981\u9a8c\u8bc1 \u903b\u8f91\u590d\u5236 \u6781\u77ed\uff08\u79d2\u7ea7\uff09 \u9ad8 \u91d1\u878d\u3001\u7535\u5546\u7b49\u96f6\u505c\u673a\u8981\u6c42 \u7070\u5ea6\u8fc1\u79fb \u65e0 \u9ad8 \u5927\u578b\u7cfb\u7edf\u3001\u5206\u6a21\u5757\u8fc1\u79fb"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#32","title":"3.2 \u63a8\u8350\u65b9\u6848\uff1a\u53cc\u5199 + \u903b\u8f91\u590d\u5236","text":"<pre><code>\u9636\u6bb51\uff1a\u51c6\u5907\u9636\u6bb5\uff081-2\u5468\uff09\n  - \u5b89\u88c5 PostgreSQL \u96c6\u7fa4\n  - \u8fc1\u79fb Schema\uff08\u8868\u3001\u7d22\u5f15\u3001\u5e8f\u5217\uff09\n  - \u6539\u5199\u5b58\u50a8\u8fc7\u7a0b/\u51fd\u6570\n  - \u5e94\u7528\u4ee3\u7801\u9002\u914d\n\n\u9636\u6bb52\uff1a\u6570\u636e\u540c\u6b65\uff081\u5468\uff09\n  - \u5168\u91cf\u6570\u636e\u8fc1\u79fb\uff08ora2pg/AWS DMS\uff09\n  - \u542f\u52a8\u589e\u91cf\u540c\u6b65\uff08GoldenGate/Debezium\uff09\n  - \u6570\u636e\u4e00\u81f4\u6027\u6821\u9a8c\n\n\u9636\u6bb53\uff1a\u53cc\u5199\u9a8c\u8bc1\uff081-2\u5468\uff09\n  - \u5e94\u7528\u53cc\u5199\uff08Oracle + PostgreSQL\uff09\n  - \u5bf9\u6bd4\u67e5\u8be2\u7ed3\u679c\n  - \u6027\u80fd\u6d4b\u8bd5\n\n\u9636\u6bb54\uff1a\u5207\u6362\u4e0a\u7ebf\uff081\u5929\uff09\n  - \u505c\u6b62\u5199\u5165 Oracle\n  - \u6700\u7ec8\u6570\u636e\u540c\u6b65\n  - \u5207\u6362\u5e94\u7528\u5230 PostgreSQL\n  - \u76d1\u63a7\u544a\u8b66\n\n\u9636\u6bb55\uff1a\u7a33\u5b9a\u89c2\u5bdf\uff081\u5468\uff09\n  - \u6027\u80fd\u76d1\u63a7\n  - \u9519\u8bef\u65e5\u5fd7\u5206\u6790\n  - \u56de\u6eda\u9884\u6848\u51c6\u5907\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#4-schema","title":"4. Schema \u8fc1\u79fb","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#41-ora2pg-schema","title":"4.1 \u4f7f\u7528 ora2pg \u8fc1\u79fb Schema","text":"<pre><code># \u5b89\u88c5 ora2pg\ncpan DBD::Oracle\ncpan DBD::Pg\ngit clone https://github.com/darold/ora2pg.git\ncd ora2pg\nperl Makefile.PL\nmake &amp;&amp; make install\n\n# \u914d\u7f6e ora2pg.conf\ncat &gt; /etc/ora2pg/ora2pg.conf &lt;&lt;EOF\nORACLE_DSN  dbi:Oracle:host=192.168.1.10;sid=ORCL;port=1521\nORACLE_USER myapp\nORACLE_PWD  MyApp123#\nSCHEMA      MYAPP\n\nPG_DSN      dbi:Pg:dbname=myapp;host=192.168.1.20;port=5432\nPG_USER     postgres\nPG_PWD      Postgres123#\n\nTYPE        TABLE\nOUTPUT      /tmp/schema.sql\nOUTPUT_DIR  /tmp/migration\n\n# \u6570\u636e\u7c7b\u578b\u6620\u5c04\nDATA_TYPE   NUMBER:numeric\nDATA_TYPE   VARCHAR2:varchar\nDATA_TYPE   DATE:timestamp\nDATA_TYPE   CLOB:text\nDATA_TYPE   BLOB:bytea\n\n# \u6392\u9664\u7cfb\u7edf\u8868\nEXCLUDE     SYS_%,TEMP_%\nEOF\n\n# \u5bfc\u51fa Schema\nora2pg -c /etc/ora2pg/ora2pg.conf -t TABLE -o tables.sql\nora2pg -c /etc/ora2pg/ora2pg.conf -t INDEX -o indexes.sql\nora2pg -c /etc/ora2pg/ora2pg.conf -t SEQUENCE -o sequences.sql\nora2pg -c /etc/ora2pg/ora2pg.conf -t VIEW -o views.sql\nora2pg -c /etc/ora2pg/ora2pg.conf -t TRIGGER -o triggers.sql\nora2pg -c /etc/ora2pg/ora2pg.conf -t FUNCTION -o functions.sql\nora2pg -c /etc/ora2pg/ora2pg.conf -t PROCEDURE -o procedures.sql\n\n# \u5bfc\u5165\u5230 PostgreSQL\npsql -h 192.168.1.20 -U postgres -d myapp -f /tmp/migration/tables.sql\npsql -h 192.168.1.20 -U postgres -d myapp -f /tmp/migration/indexes.sql\npsql -h 192.168.1.20 -U postgres -d myapp -f /tmp/migration/sequences.sql\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#42","title":"4.2 \u6570\u636e\u7c7b\u578b\u6620\u5c04","text":"Oracle PostgreSQL \u8bf4\u660e NUMBER numeric/integer \u6839\u636e\u7cbe\u5ea6\u9009\u62e9 VARCHAR2(n) varchar(n) \u76f4\u63a5\u6620\u5c04 CHAR(n) char(n) \u76f4\u63a5\u6620\u5c04 DATE timestamp Oracle DATE \u5305\u542b\u65f6\u95f4 TIMESTAMP timestamp \u76f4\u63a5\u6620\u5c04 CLOB text \u5927\u6587\u672c BLOB bytea \u4e8c\u8fdb\u5236\u6570\u636e RAW bytea \u4e8c\u8fdb\u5236\u6570\u636e LONG text \u5df2\u5e9f\u5f03\uff0c\u8f6c\u4e3a text"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#43-sql","title":"4.3 \u5e38\u89c1 SQL \u6539\u5199","text":"<pre><code>-- Oracle: DUAL \u8868\nSELECT SYSDATE FROM DUAL;\n-- PostgreSQL: \u65e0\u9700 DUAL\nSELECT CURRENT_TIMESTAMP;\n\n-- Oracle: \u5e8f\u5217\nSELECT seq_order_id.NEXTVAL FROM DUAL;\n-- PostgreSQL\nSELECT nextval('seq_order_id');\n\n-- Oracle: \u5b57\u7b26\u4e32\u62fc\u63a5\nSELECT 'Hello' || ' ' || 'World' FROM DUAL;\n-- PostgreSQL: \u76f8\u540c\nSELECT 'Hello' || ' ' || 'World';\n\n-- Oracle: NVL\nSELECT NVL(column_name, 'default') FROM table_name;\n-- PostgreSQL: COALESCE\nSELECT COALESCE(column_name, 'default') FROM table_name;\n\n-- Oracle: DECODE\nSELECT DECODE(status, 1, 'Active', 2, 'Inactive', 'Unknown') FROM users;\n-- PostgreSQL: CASE\nSELECT CASE status \n    WHEN 1 THEN 'Active' \n    WHEN 2 THEN 'Inactive' \n    ELSE 'Unknown' \nEND FROM users;\n\n-- Oracle: ROWNUM\nSELECT * FROM users WHERE ROWNUM &lt;= 10;\n-- PostgreSQL: LIMIT\nSELECT * FROM users LIMIT 10;\n\n-- Oracle: (+) \u5916\u8fde\u63a5\nSELECT a.*, b.* FROM a, b WHERE a.id = b.id(+);\n-- PostgreSQL: LEFT JOIN\nSELECT a.*, b.* FROM a LEFT JOIN b ON a.id = b.id;\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#5","title":"5. \u6570\u636e\u8fc1\u79fb","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#51-ora2pg","title":"5.1 \u5168\u91cf\u6570\u636e\u8fc1\u79fb\uff08ora2pg\uff09","text":"<pre><code># \u914d\u7f6e ora2pg.conf\nTYPE        COPY\nOUTPUT      /tmp/data.sql\n\n# \u5bfc\u51fa\u6570\u636e\nora2pg -c /etc/ora2pg/ora2pg.conf -t COPY -o data.sql\n\n# \u5bfc\u5165\u6570\u636e\npsql -h 192.168.1.20 -U postgres -d myapp -f /tmp/migration/data.sql\n\n# \u6216\u4f7f\u7528\u5e76\u884c\u5bfc\u5165\nora2pg -c /etc/ora2pg/ora2pg.conf -t COPY -j 4 -o data.sql\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#52-aws-dmsdatabase-migration-service","title":"5.2 \u4f7f\u7528 AWS DMS\uff08Database Migration Service\uff09","text":"<pre><code>\u4f18\u52bf\uff1a\n- \u652f\u6301\u589e\u91cf\u540c\u6b65\n- \u81ea\u52a8\u7c7b\u578b\u8f6c\u6362\n- \u53ef\u89c6\u5316\u76d1\u63a7\n- \u652f\u6301\u591a\u79cd\u6570\u636e\u5e93\n\n\u6b65\u9aa4\uff1a\n1. \u521b\u5efa\u590d\u5236\u5b9e\u4f8b\uff08Replication Instance\uff09\n2. \u521b\u5efa\u6e90\u7aef\u70b9\uff08Oracle\uff09\n3. \u521b\u5efa\u76ee\u6807\u7aef\u70b9\uff08PostgreSQL\uff09\n4. \u521b\u5efa\u8fc1\u79fb\u4efb\u52a1\n   - Full Load\uff08\u5168\u91cf\uff09\n   - Full Load + CDC\uff08\u5168\u91cf + \u589e\u91cf\uff09\n5. \u542f\u52a8\u4efb\u52a1\u5e76\u76d1\u63a7\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#53-debeziumcdc","title":"5.3 \u4f7f\u7528 Debezium\uff08CDC\uff09","text":"<pre><code># Debezium Oracle Connector \u914d\u7f6e\nname: oracle-connector\nconfig:\n  connector.class: io.debezium.connector.oracle.OracleConnector\n  database.hostname: 192.168.1.10\n  database.port: 1521\n  database.user: c##dbzuser\n  database.password: Oracle123#\n  database.dbname: ORCL\n  database.server.name: oracle-server\n  table.include.list: MYAPP.USERS,MYAPP.ORDERS\n  database.history.kafka.bootstrap.servers: kafka:9092\n  database.history.kafka.topic: schema-changes.myapp\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#6","title":"6. \u5b58\u50a8\u8fc7\u7a0b/\u51fd\u6570\u8fc1\u79fb","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#61-plsql-plpgsql","title":"6.1 PL/SQL \u2192 PL/pgSQL \u6539\u5199","text":"<pre><code>-- Oracle PL/SQL\nCREATE OR REPLACE PROCEDURE update_user_status(\n    p_user_id IN NUMBER,\n    p_status IN VARCHAR2\n) AS\nBEGIN\n    UPDATE users \n    SET status = p_status, updated_at = SYSDATE\n    WHERE user_id = p_user_id;\n\n    COMMIT;\nEXCEPTION\n    WHEN OTHERS THEN\n        ROLLBACK;\n        RAISE;\nEND;\n/\n\n-- PostgreSQL PL/pgSQL\nCREATE OR REPLACE FUNCTION update_user_status(\n    p_user_id INTEGER,\n    p_status VARCHAR\n) RETURNS VOID AS $$\nBEGIN\n    UPDATE users \n    SET status = p_status, updated_at = CURRENT_TIMESTAMP\n    WHERE user_id = p_user_id;\n\n    -- PostgreSQL \u81ea\u52a8\u7ba1\u7406\u4e8b\u52a1\uff0c\u65e0\u9700\u663e\u5f0f COMMIT\nEXCEPTION\n    WHEN OTHERS THEN\n        RAISE;\nEND;\n$$ LANGUAGE plpgsql;\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#62-orafce","title":"6.2 \u4f7f\u7528 Orafce \u63d2\u4ef6\uff08\u517c\u5bb9\u5c42\uff09","text":"<pre><code>-- \u5b89\u88c5 Orafce\uff08\u63d0\u4f9b Oracle \u517c\u5bb9\u51fd\u6570\uff09\nCREATE EXTENSION orafce;\n\n-- \u652f\u6301\u7684 Oracle \u51fd\u6570\uff1a\n-- SYSDATE, TRUNC, TO_CHAR, TO_DATE, NVL, DECODE, SUBSTR, INSTR \u7b49\n\n-- \u793a\u4f8b\nSELECT SYSDATE FROM DUAL;  -- \u5728 PostgreSQL \u4e2d\u53ef\u7528\nSELECT NVL(column_name, 'default') FROM table_name;  -- \u53ef\u7528\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#7","title":"7. \u5e94\u7528\u6539\u9020","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#71-jdbc","title":"7.1 JDBC \u9a71\u52a8\u66ff\u6362","text":"<pre><code>&lt;!-- Maven pom.xml --&gt;\n&lt;!-- \u79fb\u9664 Oracle \u9a71\u52a8 --&gt;\n&lt;!--\n&lt;dependency&gt;\n    &lt;groupId&gt;com.oracle.database.jdbc&lt;/groupId&gt;\n    &lt;artifactId&gt;ojdbc8&lt;/artifactId&gt;\n    &lt;version&gt;19.3.0.0&lt;/version&gt;\n&lt;/dependency&gt;\n--&gt;\n\n&lt;!-- \u6dfb\u52a0 PostgreSQL \u9a71\u52a8 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\n    &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n    &lt;version&gt;42.6.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#72","title":"7.2 \u8fde\u63a5\u5b57\u7b26\u4e32\u4fee\u6539","text":"<pre><code># Oracle\nspring.datasource.url=jdbc:oracle:thin:@192.168.1.10:1521:ORCL\nspring.datasource.driver-class-name=oracle.jdbc.OracleDriver\n\n# PostgreSQL\nspring.datasource.url=jdbc:postgresql://192.168.1.20:5432/myapp\nspring.datasource.driver-class-name=org.postgresql.Driver\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#73-hibernate","title":"7.3 Hibernate \u65b9\u8a00\u914d\u7f6e","text":"<pre><code># Oracle\nspring.jpa.properties.hibernate.dialect=org.hibernate.dialect.Oracle12cDialect\n\n# PostgreSQL\nspring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#8","title":"8. \u6570\u636e\u4e00\u81f4\u6027\u6821\u9a8c","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#81","title":"8.1 \u884c\u6570\u6821\u9a8c","text":"<pre><code>-- Oracle\nSELECT table_name, num_rows FROM user_tables ORDER BY table_name;\n\n-- PostgreSQL\nSELECT \n    schemaname,\n    tablename,\n    n_live_tup AS row_count\nFROM pg_stat_user_tables\nORDER BY tablename;\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#82-checksum","title":"8.2 \u6570\u636e\u6821\u9a8c\uff08Checksum\uff09","text":"<pre><code># \u4f7f\u7528 pt-table-checksum\uff08\u9700\u9002\u914d PostgreSQL\uff09\n# \u6216\u81ea\u5b9a\u4e49\u811a\u672c\n\n# Oracle\nSELECT table_name, COUNT(*), SUM(ORA_HASH(column1 || column2)) AS checksum\nFROM table_name\nGROUP BY table_name;\n\n# PostgreSQL\nSELECT 'table_name', COUNT(*), SUM(hashtext(column1::text || column2::text)) AS checksum\nFROM table_name;\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#83-aws-dms","title":"8.3 \u4f7f\u7528 AWS DMS \u6570\u636e\u9a8c\u8bc1","text":"<pre><code>AWS DMS \u63d0\u4f9b\u5185\u7f6e\u6570\u636e\u9a8c\u8bc1\uff1a\n- \u884c\u6570\u5bf9\u6bd4\n- \u5217\u503c\u5bf9\u6bd4\n- \u81ea\u52a8\u751f\u6210\u5dee\u5f02\u62a5\u544a\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#9","title":"9. \u6027\u80fd\u4f18\u5316","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#91","title":"9.1 \u7d22\u5f15\u4f18\u5316","text":"<pre><code>-- \u68c0\u67e5\u7f3a\u5931\u7d22\u5f15\nSELECT \n    schemaname,\n    tablename,\n    attname,\n    n_distinct,\n    correlation\nFROM pg_stats\nWHERE schemaname = 'public'\nORDER BY n_distinct DESC;\n\n-- \u521b\u5efa\u7d22\u5f15\nCREATE INDEX idx_users_email ON users(email);\nCREATE INDEX idx_orders_user_id ON orders(user_id);\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#92","title":"9.2 \u53c2\u6570\u8c03\u4f18","text":"<pre><code># postgresql.conf\nshared_buffers = 8GB  # 25% \u5185\u5b58\neffective_cache_size = 24GB  # 75% \u5185\u5b58\nmaintenance_work_mem = 2GB\nwork_mem = 64MB\nmax_connections = 200\nrandom_page_cost = 1.1  # SSD\neffective_io_concurrency = 200\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#93-vacuum-analyze","title":"9.3 VACUUM \u4e0e ANALYZE","text":"<pre><code>-- \u5b9a\u671f VACUUM\nVACUUM ANALYZE users;\n\n-- \u81ea\u52a8 VACUUM \u914d\u7f6e\nALTER TABLE users SET (autovacuum_vacuum_scale_factor = 0.1);\nALTER TABLE users SET (autovacuum_analyze_scale_factor = 0.05);\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#10","title":"10. \u5207\u6362\u4e0e\u56de\u6eda","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#101","title":"10.1 \u5207\u6362\u6b65\u9aa4","text":"<pre><code>1. \u505c\u6b62\u5e94\u7528\u5199\u5165\uff08\u7ef4\u62a4\u6a21\u5f0f\uff09\n2. \u7b49\u5f85\u589e\u91cf\u540c\u6b65\u5b8c\u6210\n3. \u6700\u7ec8\u6570\u636e\u6821\u9a8c\n4. \u4fee\u6539\u5e94\u7528\u914d\u7f6e\uff08\u6570\u636e\u5e93\u8fde\u63a5\uff09\n5. \u91cd\u542f\u5e94\u7528\n6. \u9a8c\u8bc1\u529f\u80fd\n7. \u76d1\u63a7\u6027\u80fd\n8. \u5ba3\u5e03\u5207\u6362\u6210\u529f\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#102","title":"10.2 \u56de\u6eda\u9884\u6848","text":"<pre><code>\u89e6\u53d1\u6761\u4ef6\uff1a\n- \u6570\u636e\u4e0d\u4e00\u81f4\n- \u6027\u80fd\u4e25\u91cd\u4e0b\u964d\n- \u529f\u80fd\u5f02\u5e38\n\n\u56de\u6eda\u6b65\u9aa4\uff1a\n1. \u505c\u6b62\u5e94\u7528\n2. \u6062\u590d Oracle \u8fde\u63a5\u914d\u7f6e\n3. \u91cd\u542f\u5e94\u7528\n4. \u9a8c\u8bc1\u529f\u80fd\n5. \u5206\u6790\u5931\u8d25\u539f\u56e0\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#11","title":"11. \u76d1\u63a7\u4e0e\u544a\u8b66","text":""},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#111","title":"11.1 \u5173\u952e\u6307\u6807","text":"<pre><code>-- \u8fde\u63a5\u6570\nSELECT count(*) FROM pg_stat_activity;\n\n-- \u6162\u67e5\u8be2\nSELECT \n    pid,\n    now() - query_start AS duration,\n    query\nFROM pg_stat_activity\nWHERE state = 'active'\n  AND now() - query_start &gt; interval '5 seconds'\nORDER BY duration DESC;\n\n-- \u9501\u7b49\u5f85\nSELECT \n    blocked_locks.pid AS blocked_pid,\n    blocked_activity.usename AS blocked_user,\n    blocking_locks.pid AS blocking_pid,\n    blocking_activity.usename AS blocking_user,\n    blocked_activity.query AS blocked_statement,\n    blocking_activity.query AS blocking_statement\nFROM pg_catalog.pg_locks blocked_locks\nJOIN pg_catalog.pg_stat_activity blocked_activity ON blocked_activity.pid = blocked_locks.pid\nJOIN pg_catalog.pg_locks blocking_locks ON blocking_locks.locktype = blocked_locks.locktype\nJOIN pg_catalog.pg_stat_activity blocking_activity ON blocking_activity.pid = blocking_locks.pid\nWHERE NOT blocked_locks.granted;\n</code></pre>"},{"location":"dba/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88-Oracle%E5%88%B0PostgreSQL.html#12_1","title":"12. \u6700\u4f73\u5b9e\u8df5\u603b\u7ed3","text":"<ol> <li>\u5145\u5206\u8bc4\u4f30\uff1a\u4f7f\u7528 ora2pg \u8bc4\u4f30\u8fc1\u79fb\u6210\u672c</li> <li>\u5206\u9636\u6bb5\u8fc1\u79fb\uff1a\u5148\u975e\u6838\u5fc3\u7cfb\u7edf\uff0c\u518d\u6838\u5fc3\u7cfb\u7edf</li> <li>\u53cc\u5199\u9a8c\u8bc1\uff1a\u786e\u4fdd\u6570\u636e\u4e00\u81f4\u6027</li> <li>\u6027\u80fd\u6d4b\u8bd5\uff1a\u8fc1\u79fb\u524d\u540e\u6027\u80fd\u5bf9\u6bd4</li> <li>\u56de\u6eda\u9884\u6848\uff1a\u51c6\u5907\u5feb\u901f\u56de\u6eda\u65b9\u6848</li> <li>\u76d1\u63a7\u544a\u8b66\uff1a\u5b9e\u65f6\u76d1\u63a7\u5173\u952e\u6307\u6807</li> <li>\u6587\u6863\u8bb0\u5f55\uff1a\u8bb0\u5f55\u6240\u6709\u6539\u52a8\u548c\u914d\u7f6e</li> </ol> <p>\u53c2\u8003\u5de5\u5177\uff1a - ora2pg: https://ora2pg.darold.net/ - AWS DMS: https://aws.amazon.com/dms/ - Debezium: https://debezium.io/ - Orafce: https://github.com/orafce/orafce</p>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html","title":"\u8fbe\u68a6\u6570\u636e\u5e93 DM8\uff1aLinux\uff08RHEL\uff09\u5165\u95e8\u5b8c\u6574\u6307\u5357","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aDBA\u3001\u56fd\u4ea7\u6570\u636e\u5e93\u8bc4\u4f30\u4e0e\u5b9e\u65bd\u4eba\u5458 \u76ee\u6807\uff1a\u5728\u4e00\u53f0 Red Hat Linux \u670d\u52a1\u5668\u4e0a\uff0c\u4ece 0 \u5b8c\u6210 DM8 \u7684\u5b89\u88c5\u3001\u5efa\u5e93\u3001\u5efa\u7528\u6237\u3001\u5efa\u8868\u3001\u67e5\u8be2\u4e0e\u5907\u4efd\u3002</p>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#1-dm8","title":"1. DM8 \u4e0e\u73af\u5883\u51c6\u5907","text":"<ul> <li>\u4ea7\u54c1\uff1a\u8fbe\u68a6\u6570\u636e\u5e93 DM8\uff0864 \u4f4d\uff09</li> <li>\u64cd\u4f5c\u7cfb\u7edf\uff1aRed Hat Enterprise Linux 7/8/9\uff08x86_64\uff09</li> <li>\u89d2\u8272\u89c4\u5212\uff1a</li> <li><code>root</code>\uff1a\u5b89\u88c5\u8f6f\u4ef6\u3001\u914d\u7f6e\u7cfb\u7edf</li> <li><code>dmdba</code>\uff1a\u8fbe\u68a6\u6570\u636e\u5e93\u8fd0\u884c\u8d26\u6237</li> <li>\u7aef\u53e3\uff1a\u9ed8\u8ba4 5236</li> <li>\u76ee\u5f55\u89c4\u5212\u793a\u4f8b\uff1a</li> <li>\u8f6f\u4ef6\u76ee\u5f55\uff1a<code>/opt/dmdbms</code></li> <li>\u6570\u636e\u76ee\u5f55\uff1a<code>/data/dm8/data</code></li> <li>\u5907\u4efd\u76ee\u5f55\uff1a<code>/backup/dm8</code></li> </ul>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#11","title":"1.1 \u4ece\u5b98\u7f51\u4e0b\u8f7d\u5b89\u88c5\u5305","text":"<ol> <li>\u8bbf\u95ee\u5b98\u7f51\uff1ahttps://eco.dameng.com  \u6ce8\u518c/\u767b\u5f55\u8d26\u53f7\u3002</li> <li>\u5728\u3010\u4e0b\u8f7d\u4e2d\u5fc3\u3011\u9009\u62e9\uff1a</li> <li>\u4ea7\u54c1\uff1aDM8</li> <li>\u5e73\u53f0\uff1aLinux 64 \u4f4d\uff08x86_64\uff09</li> <li>\u5305\u7c7b\u578b\uff1aRPM \u6216 tar \u5305\uff08\u4e8c\u9009\u4e00\uff0c\u672c\u6307\u5357\u4ee5 RPM \u4e3a\u4f8b\uff09\u3002</li> <li>\u4e0b\u8f7d\u540e\u901a\u8fc7 <code>scp</code>/FTP \u4e0a\u4f20\u5230\u76ee\u6807\u670d\u52a1\u5668\uff08\u4f8b\u5982 <code>/tmp</code> \u76ee\u5f55\uff09\u3002</li> </ol>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#12-linuxrhel","title":"1.2 Linux\uff08RHEL\uff09\u57fa\u7840\u914d\u7f6e","text":"<pre><code># 1) \u521b\u5efa\u8fd0\u884c\u7528\u6237\nuseradd -m -d /home/dmdba -s /bin/bash dmdba\npasswd dmdba   # \u8bbe\u7f6e\u4e00\u4e2a\u5b89\u5168\u5bc6\u7801\n\n# 2) \u521b\u5efa\u6570\u636e\u4e0e\u5907\u4efd\u76ee\u5f55\nmkdir -p /data/dm8/data /backup/dm8\nchown -R dmdba:dmdba /data/dm8 /backup/dm8\n\n# 3) \u57fa\u672c\u5185\u6838\u4e0e\u53e5\u67c4\u9650\u5236\uff08/etc/security/limits.conf\uff09\n# \u8ffd\u52a0\uff1a\n# dmdba soft nofile 65535\n# dmdba hard nofile 65535\n# dmdba soft nproc  16384\n# dmdba hard nproc  16384\n</code></pre> <p>\u5982\u6709 SELinux/\u9632\u706b\u5899\u9650\u5236\uff0c\u53ef\u6839\u636e\u5b89\u5168\u89c4\u8303\u5f00\u653e 5236 \u7aef\u53e3\u6216\u901a\u8fc7\u5185\u7f51\u8bbf\u95ee\u3002</p>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#2-dm8-rpm","title":"2. \u5b89\u88c5 DM8 \u8f6f\u4ef6\uff08RPM \u793a\u4f8b\uff09","text":"<p>\u4ee5 root \u7528\u6237\u6267\u884c\uff1a</p> <pre><code>cd /tmp\nrpm -ivh dm8-*.x86_64.rpm\n# \u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u9ed8\u8ba4\u76ee\u5f55\u4e00\u822c\u4e3a /opt/dmdbms\nls -l /opt/dmdbms\n</code></pre> <p>\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff08\u7ed9\u6240\u6709\u7528\u6237\u751f\u6548\uff0c\u53ef\u5199\u5165 <code>/etc/profile.d/dm8.sh</code>\uff09\uff1a</p> <pre><code>cat &gt;/etc/profile.d/dm8.sh &lt;&lt;'EOF'\nexport DM_HOME=/opt/dmdbms\nexport PATH=\"$DM_HOME/bin:$PATH\"\nEOF\n\nsource /etc/profile.d/dm8.sh\n</code></pre>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#3-dminit","title":"3. \u521d\u59cb\u5316\u6570\u636e\u5e93\u5b9e\u4f8b\uff08dminit\uff09","text":"<p>\u5207\u6362\u5230\u8fd0\u884c\u7528\u6237 <code>dmdba</code>\uff0c\u521b\u5efa\u5b9e\u4f8b\u6570\u636e\u6587\u4ef6\uff1a</p> <pre><code>su - dmdba\nsource /etc/profile.d/dm8.sh\n\n/opt/dmdbms/bin/dminit \\\n  PATH=/data/dm8/data \\\n  DB_NAME=DM8 \\\n  INSTANCE_NAME=DM8 \\\n  PORT_NUM=5236 \\\n  PAGE_SIZE=32 \\\n  EXTENT_SIZE=32 \\\n  LOG_SIZE=1024 \\\n  CASE_SENSITIVE=0 \\\n  CHARSET=PG_UTF8\n</code></pre> <p>\u8bf4\u660e\uff1a - <code>PATH</code>\uff1a\u6570\u636e\u6587\u4ef6\u6240\u5728\u76ee\u5f55 - <code>DB_NAME</code>/<code>INSTANCE_NAME</code>\uff1a\u5b9e\u4f8b\u540d\u79f0 - <code>CHARSET</code>\uff1a\u63a8\u8350 UTF-8\uff08PG_UTF8\uff09\uff0c\u4fbf\u4e8e\u591a\u8bed\u8a00\u5b57\u7b26\u96c6</p> <p>\u521d\u59cb\u5316\u6210\u529f\u540e\uff0c\u4f1a\u751f\u6210 <code>dm.ini</code>\u3001\u6570\u636e\u6587\u4ef6\u548c\u65e5\u5fd7\u6587\u4ef6\u3002</p>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#4","title":"4. \u6ce8\u518c\u4e0e\u542f\u52a8\u670d\u52a1","text":"<p>\u4ee5 root \u7528\u6237\u6267\u884c\u670d\u52a1\u6ce8\u518c\u811a\u672c\uff1a</p> <pre><code>/opt/dmdbms/script/root/dm_service_installer.sh -i DM8\n\nsystemctl enable DmServiceDM8\nsystemctl start  DmServiceDM8\nsystemctl status DmServiceDM8\n</code></pre> <p>\u5e38\u89c1\u72b6\u6001\uff1a - <code>active (running)</code>\uff1a\u670d\u52a1\u6b63\u5e38 - \u5982\u679c\u542f\u52a8\u5931\u8d25\uff0c\u53ef\u67e5\u770b\u65e5\u5fd7\uff1a<code>/opt/dmdbms/log/DmServiceDM8*.log</code></p>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#5-disql","title":"5. \u4f7f\u7528 DISQL \u8fde\u63a5\u6570\u636e\u5e93","text":"<pre><code>su - dmdba\nsource /etc/profile.d/dm8.sh\n\ndisql SYSDBA/SYSDBA@127.0.0.1:5236\n</code></pre> <ul> <li>\u9ed8\u8ba4\u7ba1\u7406\u7528\u6237\uff1a<code>SYSDBA</code></li> <li>\u9ed8\u8ba4\u5bc6\u7801\uff1a<code>SYSDBA</code>\uff08\u751f\u4ea7\u73af\u5883\u5fc5\u987b\u5c3d\u5feb\u4fee\u6539\uff09\uff1a</li> </ul> <pre><code>ALTER USER SYSDBA IDENTIFIED BY \"NewPwd@2025\";\n</code></pre>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#6","title":"6. \u521b\u5efa\u8868\u7a7a\u95f4\u3001\u7528\u6237\u4e0e\u8868","text":""},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#61","title":"6.1 \u521b\u5efa\u8868\u7a7a\u95f4","text":"<pre><code>CREATE TABLESPACE TS_DM_DATA\n  DATAFILE '/data/dm8/data/TS_DM_DATA01.dbs' SIZE 10240;  -- \u5355\u4f4d MB\n</code></pre>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#62","title":"6.2 \u521b\u5efa\u4e1a\u52a1\u7528\u6237","text":"<pre><code>CREATE USER appuser IDENTIFIED BY \"AppUser@123\"\n  DEFAULT TABLESPACE TS_DM_DATA;\n\nGRANT RESOURCE, PUBLIC TO appuser;\n</code></pre> <p><code>RESOURCE</code> \u5141\u8bb8\u521b\u5efa\u8868\u7b49\u5bf9\u8c61\uff1b\u5982\u9700\u7ba1\u7406\u6743\u9650\uff0c\u53ef\u989d\u5916\u6388\u4e88 <code>DBA</code>\uff08\u8c28\u614e\uff09\u3002</p>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#63","title":"6.3 \u8fde\u63a5\u5e76\u521b\u5efa\u8868","text":"<pre><code>CONNECT appuser/AppUser@123;\n\nCREATE TABLE t_order (\n  id        INT PRIMARY KEY,\n  order_no  VARCHAR(64),\n  amount    NUMERIC(18,2),\n  created_at TIMESTAMP\n);\n\nINSERT INTO t_order VALUES\n  (1, 'ORD001', 100.00, SYSDATE),\n  (2, 'ORD002', 200.50, SYSDATE);\n\nSELECT * FROM t_order;\n</code></pre>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#7-dm8","title":"7. DM8 \u7279\u6709\u5e38\u7528\u547d\u4ee4\u4e0e\u89c6\u56fe","text":""},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#71","title":"7.1 \u5e38\u7528\u5de5\u5177","text":"<ul> <li><code>disql</code>\uff1a\u547d\u4ee4\u884c\u5ba2\u6237\u7aef</li> <li><code>dmrman</code>\uff1a\u7269\u7406\u5907\u4efd\u4e0e\u6062\u590d\u5de5\u5177</li> <li><code>dexp</code> / <code>dimp</code>\uff1a\u903b\u8f91\u5bfc\u51fa/\u5bfc\u5165</li> <li><code>dm_svc</code>\uff1a\u670d\u52a1\u7ba1\u7406\uff08\u90e8\u5206\u5e73\u53f0\uff09</li> </ul>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#72","title":"7.2 \u5e38\u7528\u6570\u636e\u5b57\u5178\u89c6\u56fe","text":"<pre><code>-- \u67e5\u770b\u5f53\u524d\u5b9e\u4f8b\u53c2\u6570\uff08INI\uff09\nSELECT * FROM V$DM_INI;\n\n-- \u4f1a\u8bdd\u4e0e\u8fde\u63a5\nSELECT * FROM V$SESSION;\n\n-- \u8868\u7a7a\u95f4\u4e0e\u6570\u636e\u6587\u4ef6\nSELECT * FROM DBA_DATA_FILES;\n\n-- \u7d22\u5f15\u4e0e\u6267\u884c\u8ba1\u5212\nSELECT * FROM V$INDEXES;\n</code></pre>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#73","title":"7.3 \u53c2\u6570\u67e5\u8be2\u4e0e\u4fee\u6539\u51fd\u6570","text":"<pre><code>-- \u67e5\u8be2\u53c2\u6570\u503c\nSELECT SF_GET_PARA_VALUE(1, 'MAX_SESSIONS') FROM DUAL;\n\n-- \u4fee\u6539\u53c2\u6570\uff08\u5199\u5165 dm.ini\uff0c\u91cd\u542f\u540e\u751f\u6548\u6216\u7acb\u523b\u751f\u6548\u89c6\u53c2\u6570\u7c7b\u578b\u800c\u5b9a\uff09\nCALL SP_SET_PARA_VALUE(2, 'MAX_SESSIONS', 3000);\n</code></pre>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#8","title":"8. \u5907\u4efd\u4e0e\u6062\u590d","text":""},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#81-dexpdimp","title":"8.1 \u903b\u8f91\u5907\u4efd\uff08dexp/dimp\uff09","text":"<p>\u9002\u5408\u5bfc\u51fa\u5355\u4e2a\u7528\u6237\u6216\u90e8\u5206\u8868\uff1a</p> <pre><code>su - dmdba\ncd /backup/dm8\n\ndexp appuser/AppUser@123 FILE=appuser.dmp LOG=appuser_dexp.log OWNER=appuser\n</code></pre> <p>\u6062\u590d\u5230\u540c\u4e00\u6216\u5176\u4ed6\u5e93\uff1a</p> <pre><code>dimp appuser/AppUser@123 FILE=appuser.dmp LOG=appuser_dimp.log IGNORE=Y\n</code></pre>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#82-dmrman","title":"8.2 \u7269\u7406\u5907\u4efd\uff08dmrman\uff09","text":"<p>\u9002\u5408\u6574\u5e93\u5907\u4efd\u3001\u707e\u5907\u6f14\u7ec3\uff1a</p> <pre><code>su - dmdba\nmkdir -p /backup/dm8/full\n\n/opt/dmdbms/bin/dmrman &lt;&lt;'EOF'\nbackup database full backupset '/backup/dm8/full/full_bak_01';\nEOF\n</code></pre> <p>\u6062\u590d\u65f6\u901a\u5e38\u6b65\u9aa4\u4e3a\uff1a 1. \u505c\u5e93\u5e76\u6302\u8f7d\u5907\u4efd\u76ee\u5f55 2. \u4f7f\u7528 <code>dmrman</code> \u7684 <code>restore database</code> / <code>recover database</code> \u547d\u4ee4 3. \u542f\u52a8\u6570\u636e\u5e93\u5e76\u9a8c\u8bc1\u4e1a\u52a1</p>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-Linux%E5%85%A5%E9%97%A8%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97.html#9","title":"9. \u5c0f\u7ed3","text":"<p>\u901a\u8fc7\u4ee5\u4e0a\u6b65\u9aa4\uff0c\u4f60\u5df2\u7ecf\u5728 RHEL \u4e0a\u5b8c\u6210\uff1aDM8 \u5b89\u88c5\u3001\u5b9e\u4f8b\u521d\u59cb\u5316\u3001\u670d\u52a1\u6ce8\u518c\u3001\u521b\u5efa\u7528\u6237\u4e0e\u8868\u3001\u57fa\u672c\u67e5\u8be2\u4ee5\u53ca\u903b\u8f91/\u7269\u7406\u5907\u4efd\u3002\u540e\u7eed\u53ef\u7ed3\u5408\u5b98\u65b9\u6587\u6863\u4e0e\u672c\u535a\u5ba2\u7684\u300a\u8fbe\u68a6 DM8 \u6027\u80fd\u8c03\u4f18\u4e0e AI \u8f85\u52a9\u5b9e\u8df5\u300b\u4e00\u6587\uff0c\u7ee7\u7eed\u6df1\u5165\u53c2\u6570\u8c03\u4f18\u4e0e\u9ad8\u53ef\u7528\u90e8\u7f72\u3002</p>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html","title":"\u8fbe\u68a6\u6570\u636e\u5e93 DM8\uff1a\u5165\u95e8\u4e0e\u5b89\u88c5\u5b9e\u8df5","text":"<p>\u9002\u7528\u8bfb\u8005\uff1aDBA\u3001\u56fd\u4ea7\u6570\u636e\u5e93\u8fc1\u79fb/\u66ff\u4ee3\u8bc4\u4f30\u4eba\u5458 \u76ee\u6807\uff1a\u5b8c\u6210 DM8 \u57fa\u7840\u5b89\u88c5\u3001\u521b\u5efa\u5e93\u8868\u3001\u5907\u4efd\u6062\u590d\u4e0e\u5e38\u89c1\u95ee\u9898\u5904\u7406\u3002</p>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#1-dm8","title":"1. DM8 \u6982\u8ff0","text":"<ul> <li>\u7c7b\u578b\uff1a\u56fd\u4ea7\u81ea\u7814\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0c\u652f\u6301 SQL/PL\uff0c\u517c\u5bb9 Oracle/MySQL \u8bed\u6cd5\u4e0e\u9a71\u52a8\u7684\u8fc1\u79fb</li> <li>\u7248\u672c\uff1aDM8\uff08\u5f53\u524d\u4e3b\u6d41\uff09\uff0c\u652f\u6301\u56fd\u4ea7\u5316 OS/CPU</li> <li>\u5178\u578b\u573a\u666f\uff1a\u653f\u4f01\u3001\u91d1\u878d\u3001\u80fd\u6e90\u3001\u7535\u4fe1</li> </ul>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#2-linux-rpm","title":"2. \u5b89\u88c5\uff08Linux RPM \u793a\u4f8b\uff09","text":"<p>\u4f9d\u8d56\uff1a\u5185\u5b58 \u2265 8GB\uff0c\u78c1\u76d8 \u2265 100GB\uff0c\u7aef\u53e3\u9ed8\u8ba4 5236</p> <pre><code># 1) \u5b89\u88c5\nrpm -ivh dm8-2023-x86_64.rpm\n/opt/dmdbms/script/root/dm_service_installer.sh -i  # \u6ce8\u518c\u670d\u52a1\n\n# 2) \u521d\u59cb\u5316\u5e93\n/opt/dmdbms/bin/dminit PATH=/data/dm/data DB_NAME=DM8 \\\n  PORT_NUM=5236 PAGE_SIZE=32 EXTENT_SIZE=32 LOG_SIZE=1024 \\\n  CASE_SENSITIVE=0 CHARSET=PG_UTF8\n\n# 3) \u542f\u52a8\u670d\u52a1\nsystemctl enable DmServiceDM8 &amp;&amp; systemctl start DmServiceDM8\nsystemctl status DmServiceDM8\n</code></pre>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#3","title":"3. \u57fa\u7840\u4f7f\u7528","text":"<pre><code># \u547d\u4ee4\u884c\u5ba2\u6237\u7aef DISQL\ndisql SYSDBA/SYSDBA@127.0.0.1:5236\n</code></pre> <pre><code>-- \u521b\u5efa\u7528\u6237\u4e0e\u8868\u7a7a\u95f4\nCREATE TABLESPACE TS_DATA DATAFILE '/data/dm/data/TS_DATA.dbs' SIZE 10240;\nCREATE USER demo IDENTIFIED BY \"Demo@123\" DEFAULT TABLESPACE TS_DATA;\nGRANT RESOURCE, PUBLIC, DBA TO demo;\n\n-- \u521b\u5efa\u8868\u4e0e\u6570\u636e\nCONNECT demo/Demo@123;\nCREATE TABLE t1(id INT PRIMARY KEY, name VARCHAR(50));\nINSERT INTO t1 VALUES(1,'hello'),(2,'dm8');\nSELECT * FROM t1;\n</code></pre>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#4","title":"4. \u5907\u4efd\u4e0e\u6062\u590d","text":"<pre><code>-- \u903b\u8f91\u5907\u4efd\ndexp demo/Demo@123 FILE '/backup/demo.dmp' LOG '/backup/dexp.log' OWNER=demo\n-- \u903b\u8f91\u6062\u590d\nDIMP demo/Demo@123 FILE '/backup/demo.dmp' LOG '/backup/dimp.log' IGNORE=Y\n</code></pre> <pre><code># \u7269\u7406\u5907\u4efd\uff08dmrman\uff09\n/opt/dmdbms/bin/dmrman &lt;&lt;'EOF'\nbackup database full backupset '/backup/full_bak';\nEOF\n</code></pre>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#5","title":"5. \u517c\u5bb9\u4e0e\u8fc1\u79fb\u63d0\u793a","text":"<ul> <li>Oracle \u8fc1\u79fb\uff1a\u51fd\u6570/\u5305/\u5e8f\u5217\u5b58\u5728\u5dee\u5f02\uff0c\u4f7f\u7528\u5b98\u65b9\u8fc1\u79fb\u5de5\u5177\u8bc4\u4f30\u4e0e\u6539\u5199</li> <li>MySQL \u8fc1\u79fb\uff1a\u65e5\u671f/\u5b57\u7b26\u96c6\u3001\u5927\u5c0f\u5199\u654f\u611f\u3001\u4e8b\u52a1\u9694\u79bb\u6ce8\u610f</li> <li>\u5b57\u7b26\u96c6\uff1a\u63a8\u8350 UTF-8\uff08PG_UTF8\uff09</li> </ul>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#6","title":"6. \u5e38\u89c1\u95ee\u9898","text":"<ul> <li>\u542f\u52a8\u5931\u8d25\uff1a\u67e5\u770b /opt/dmdbms/log/DmService* \u65e5\u5fd7</li> <li>\u8fde\u63a5\u9519\u8bef -700\uff1a\u7528\u6237/\u5bc6\u7801\uff0c\u6216\u6743\u9650\u4e0d\u8db3</li> <li>\u7f16\u7801\u4e71\u7801\uff1a\u521d\u59cb\u5316\u9009\u62e9\u5408\u9002\u5b57\u7b26\u96c6\uff0c\u5ba2\u6237\u7aef\u4e00\u81f4</li> </ul>"},{"location":"dba/%E8%BE%BE%E6%A2%A6DM8-%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85%E5%AE%9E%E8%B7%B5.html#7","title":"7. \u6700\u4f73\u5b9e\u8df5","text":"<p>1) \u72ec\u7acb\u6570\u636e/\u65e5\u5fd7\u76d8\uff1b2) \u5b9a\u671f\u5168\u91cf+\u589e\u91cf\u5907\u4efd\uff1b3) \u5ba1\u8ba1\u5f00\u542f\u4e0e\u65e5\u5fd7\u7559\u5b58\uff1b4) \u76d1\u63a7\u4e0e\u544a\u8b66\uff1b5) \u53d8\u66f4\u5ba1\u6279\u4e0e\u7248\u672c\u7ba1\u7406</p> <p>\u53c2\u8003\uff1a - DM8 \u6587\u6863 https://eco.dameng.com</p>"},{"location":"devops/K8s_1.html","title":"K8s \u76f8\u5173\u95ee\u9898\u96c6\u9526\uff08\u4e00\uff09","text":""},{"location":"devops/K8s_1.html#1","title":"1. \u57fa\u7840\u6982\u5ff5\u7c7b","text":"<ul> <li>Kubernetes \u662f\u4ec0\u4e48\uff1f\u5b83\u7684\u4e3b\u8981\u529f\u80fd\u6709\u54ea\u4e9b\uff1f</li> <li>\u8bf4\u660e Kubernetes \u662f\u4e00\u4e2a\u7528\u4e8e\u5bb9\u5668\u7f16\u6392\u7684\u5f00\u6e90\u5e73\u53f0\uff0c\u652f\u6301\u81ea\u52a8\u5316\u5bb9\u5668\u5316\u5e94\u7528\u7684\u90e8\u7f72\u3001\u6269\u5c55\u548c\u7ba1\u7406\u3002</li> <li>\u89e3\u91ca Pod \u662f\u4ec0\u4e48\uff1f</li> <li>Pod \u662f Kubernetes \u4e2d\u6700\u5c0f\u7684\u53ef\u90e8\u7f72\u5355\u5143\uff0c\u901a\u5e38\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u5bb9\u5668\uff0c\u5b83\u4eec\u5171\u4eab\u7f51\u7edc\u547d\u540d\u7a7a\u95f4\u548c\u5b58\u50a8\u5377\u3002</li> <li>\u4ec0\u4e48\u662f Namespace\uff1f\u5b83\u7684\u4f5c\u7528\u662f\u4ec0\u4e48\uff1f</li> <li>Namespace \u7528\u4e8e\u903b\u8f91\u4e0a\u5212\u5206 Kubernetes \u96c6\u7fa4\u4e2d\u7684\u8d44\u6e90\uff0c\u53ef\u4ee5\u7528\u4e8e\u5b9e\u73b0\u8d44\u6e90\u9694\u79bb\u548c\u7ba1\u7406\u4e0d\u540c\u73af\u5883\uff08\u5982\u5f00\u53d1\u3001\u6d4b\u8bd5\u3001\u751f\u4ea7\uff09\u3002</li> <li>\u4ec0\u4e48\u662f Deployment\uff1f\u5b83\u6709\u4ec0\u4e48\u4f5c\u7528\uff1f</li> <li>Deployment \u7528\u4e8e\u7ba1\u7406\u65e0\u72b6\u6001\u5e94\u7528\u7684\u90e8\u7f72\uff0c\u652f\u6301\u81ea\u52a8\u6269\u5c55\u3001\u6eda\u52a8\u66f4\u65b0\u548c\u7248\u672c\u56de\u6eda\u3002</li> </ul> <p>\u8f6c\u53d1\u4e00\u4e2a\u5feb\u901f\u5165\u95e8\u89c6\u9891</p>"},{"location":"devops/K8s_1.html#2","title":"2. \u67b6\u6784\u4e0e\u7ec4\u4ef6\u7c7b","text":"<ul> <li>Kubernetes \u7684\u4e3b\u8981\u7ec4\u4ef6\u6709\u54ea\u4e9b\uff1f</li> <li>\u63cf\u8ff0 Master \u8282\u70b9\u7ec4\u4ef6\uff08\u5982 API Server\u3001Controller Manager\u3001Scheduler\u3001etcd\uff09\u548c Worker \u8282\u70b9\u7ec4\u4ef6\uff08\u5982 kubelet\u3001kube-proxy\uff09\u3002</li> <li>\u89e3\u91ca API Server \u7684\u4f5c\u7528\u662f\u4ec0\u4e48\uff1f</li> <li>API Server \u662f Kubernetes \u7684\u524d\u7aef\uff0c\u8d1f\u8d23\u5904\u7406\u6765\u81ea\u7528\u6237\u548c\u5185\u90e8\u7ec4\u4ef6\u7684\u6240\u6709 RESTful \u8bf7\u6c42\uff0c\u662f\u96c6\u7fa4\u7684\u6838\u5fc3\u5165\u53e3\u3002</li> <li>\u4ec0\u4e48\u662f etcd\uff1f\u5728 Kubernetes \u4e2d\u8d77\u4ec0\u4e48\u4f5c\u7528\uff1f</li> <li>etcd \u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u952e\u503c\u5b58\u50a8\u7cfb\u7edf\uff0c\u7528\u4e8e\u5b58\u50a8 Kubernetes \u7684\u96c6\u7fa4\u6570\u636e\uff0c\u5982\u914d\u7f6e\u4fe1\u606f\u3001\u72b6\u6001\u6570\u636e\u7b49\uff0c\u662f Kubernetes \u9ad8\u53ef\u7528\u7684\u91cd\u8981\u7ec4\u6210\u90e8\u5206\u3002</li> </ul>"},{"location":"devops/K8s_1.html#3","title":"3. \u914d\u7f6e\u4e0e\u64cd\u4f5c\u7c7b","text":"<p>\u597d\u7684\uff0c\u4ee5\u4e0b\u662f\u57fa\u4e8e Debian \u64cd\u4f5c\u7cfb\u7edf\u7684\u5177\u4f53 Kubernetes \u64cd\u4f5c\u547d\u4ee4\u793a\u4f8b\uff0c\u6db5\u76d6\u521b\u5efa Pod\u3001\u67e5\u770b\u65e5\u5fd7\u3001\u6392\u67e5 <code>CrashLoopBackOff</code> \u72b6\u6001\u3001\u4ee5\u53ca\u521b\u5efa\u548c\u4f7f\u7528 <code>ConfigMap</code> \u548c <code>Secret</code> \u7684\u64cd\u4f5c\uff1a</p>"},{"location":"devops/K8s_1.html#1-pod","title":"1. \u5982\u4f55\u521b\u5efa\u4e00\u4e2a Pod\uff1f","text":"<p>\u5728 Kubernetes \u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e24\u79cd\u65b9\u5f0f\u521b\u5efa Pod\uff1a<code>kubectl run</code> \u547d\u4ee4\u548c <code>kubectl apply -f</code> \u547d\u4ee4\u3002</p>"},{"location":"devops/K8s_1.html#kubectl-run","title":"\u65b9\u5f0f\u4e00\uff1a\u4f7f\u7528 <code>kubectl run</code> \u547d\u4ee4","text":"<p><code>bash kubectl run nginx-pod --image=nginx:latest --restart=Never</code></p> <ul> <li><code>nginx-pod</code> \u662f Pod \u7684\u540d\u79f0\u3002</li> <li><code>--image=nginx:latest</code> \u6307\u5b9a\u4f7f\u7528\u7684\u955c\u50cf\u3002</li> <li><code>--restart=Never</code> \u8868\u793a\u4ec5\u521b\u5efa\u4e00\u4e2a Pod\uff0c\u800c\u4e0d\u662f\u521b\u5efa Deployment \u6216 ReplicaSet\u3002</li> </ul>"},{"location":"devops/K8s_1.html#yaml-pod","title":"\u65b9\u5f0f\u4e8c\uff1a\u4f7f\u7528 YAML \u6587\u4ef6\u521b\u5efa Pod","text":"<p>\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a <code>nginx-pod.yaml</code> \u7684\u6587\u4ef6\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</p> <p><code>yaml apiVersion: v1 kind: Pod metadata:   name: nginx-pod spec:   containers:   - name: nginx     image: nginx:latest     ports:     - containerPort: 80</code></p> <p>\u7136\u540e\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5e94\u7528\u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\u6765\u521b\u5efa Pod\uff1a</p> <p><code>bash kubectl apply -f nginx-pod.yaml</code></p>"},{"location":"devops/K8s_1.html#2-pod","title":"2. \u5982\u4f55\u67e5\u770b Pod \u7684\u65e5\u5fd7\uff1f","text":"<p>\u5047\u8bbe\u6211\u4eec\u8981\u67e5\u770b\u540d\u4e3a <code>nginx-pod</code> \u7684 Pod \u7684\u65e5\u5fd7\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <p><code>bash kubectl logs nginx-pod</code></p> <ul> <li>\u5982\u679c Pod \u4e2d\u6709\u591a\u4e2a\u5bb9\u5668\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6307\u5b9a\u5bb9\u5668\u540d\uff1a</li> </ul> <p><code>bash kubectl logs nginx-pod -c &lt;container_name&gt;</code></p>"},{"location":"devops/K8s_1.html#3-pod-crashloopbackoff","title":"3. \u5982\u4f55\u6392\u67e5 Pod \u5904\u4e8e <code>CrashLoopBackOff</code> \u72b6\u6001\u7684\u95ee\u9898\uff1f","text":"<p>\u5f53 Pod \u8fdb\u5165 <code>CrashLoopBackOff</code> \u72b6\u6001\u65f6\uff0c\u6392\u67e5\u6b65\u9aa4\u5305\u62ec\u67e5\u770b\u4e8b\u4ef6\u3001\u63cf\u8ff0 Pod \u8be6\u7ec6\u4fe1\u606f\u548c\u67e5\u770b\u5bb9\u5668\u65e5\u5fd7\u3002</p>"},{"location":"devops/K8s_1.html#1-pod_1","title":"\u6b65\u9aa4 1\uff1a\u67e5\u770b Pod \u7684\u63cf\u8ff0","text":"<p><code>bash kubectl describe pod nginx-pod</code></p> <ul> <li>\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u8f93\u51fa Pod \u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u4e8b\u4ef6\u5386\u53f2\u548c\u9519\u8bef\u539f\u56e0\u3002\u68c0\u67e5 <code>Events</code> \u90e8\u5206\uff0c\u53ef\u4ee5\u5e2e\u52a9\u7406\u89e3\u4e3a\u4ec0\u4e48 Pod \u4f1a\u9891\u7e41\u91cd\u542f\u3002</li> </ul>"},{"location":"devops/K8s_1.html#2-pod_1","title":"\u6b65\u9aa4 2\uff1a\u67e5\u770b Pod \u65e5\u5fd7","text":"<p><code>bash kubectl logs nginx-pod</code></p> <ul> <li>\u5982\u679c Pod \u4e2d\u6709\u591a\u4e2a\u5bb9\u5668\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6307\u5b9a\u5bb9\u5668\u540d\uff1a</li> </ul> <p><code>bash kubectl logs nginx-pod -c &lt;container_name&gt;</code></p> <ul> <li>\u65e5\u5fd7\u53ef\u4ee5\u5e2e\u52a9\u67e5\u770b\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u5931\u8d25\u7684\u539f\u56e0\u3002</li> </ul>"},{"location":"devops/K8s_1.html#3-pod","title":"\u6b65\u9aa4 3\uff1a\u68c0\u67e5 Pod \u7684\u914d\u7f6e\u6587\u4ef6\u6216\u955c\u50cf","text":"<ul> <li>\u786e\u8ba4 YAML \u6587\u4ef6\u4e2d\u7684\u914d\u7f6e\u662f\u5426\u6b63\u786e\uff0c\u5982\u73af\u5883\u53d8\u91cf\u3001\u955c\u50cf\u540d\u79f0\u3001\u542f\u52a8\u547d\u4ee4\u7b49\u3002</li> <li>\u786e\u4fdd\u955c\u50cf\u6ca1\u6709\u95ee\u9898\uff0c\u53ef\u4ee5\u901a\u8fc7\u5728\u672c\u5730\u6216\u5176\u4ed6\u73af\u5883\u4e2d\u6d4b\u8bd5\u955c\u50cf\u3002</li> </ul>"},{"location":"devops/K8s_1.html#4-configmap-secret","title":"4. \u5982\u4f55\u521b\u5efa\u548c\u4f7f\u7528 <code>ConfigMap</code> \u548c <code>Secret</code>\uff1f","text":""},{"location":"devops/K8s_1.html#configmap","title":"\u521b\u5efa <code>ConfigMap</code>","text":"<p>\u5047\u8bbe\u6211\u4eec\u8981\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u5e94\u7528\u914d\u7f6e\u7684 <code>ConfigMap</code>\uff1a</p> <p><code>bash kubectl create configmap my-config --from-literal=app_name=myapp --from-literal=app_env=production</code></p> <ul> <li><code>--from-literal</code> \u7528\u4e8e\u4ece\u547d\u4ee4\u884c\u76f4\u63a5\u6307\u5b9a\u952e\u503c\u5bf9\u3002</li> <li>\u53ef\u4ee5\u4f7f\u7528 <code>--from-file</code> \u53c2\u6570\u4ece\u6587\u4ef6\u52a0\u8f7d\u914d\u7f6e\u3002</li> </ul> <p>\u67e5\u770b <code>ConfigMap</code> \u7684\u5185\u5bb9\uff1a</p> <p><code>bash kubectl get configmap my-config -o yaml</code></p>"},{"location":"devops/K8s_1.html#secret","title":"\u521b\u5efa <code>Secret</code>","text":"<p>\u5047\u8bbe\u6211\u4eec\u8981\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u6570\u636e\u5e93\u5bc6\u7801\u7684 <code>Secret</code>\uff1a</p> <p><code>bash kubectl create secret generic db-secret --from-literal=username=myuser --from-literal=password=mypassword</code></p> <ul> <li><code>generic</code> \u8868\u793a\u521b\u5efa\u7684\u662f\u4e00\u4e2a\u901a\u7528\u7c7b\u578b\u7684 Secret\u3002</li> <li><code>--from-literal</code> \u7528\u4e8e\u4ece\u547d\u4ee4\u884c\u76f4\u63a5\u6307\u5b9a\u952e\u503c\u5bf9\u3002</li> </ul> <p>\u67e5\u770b <code>Secret</code> \u7684\u5185\u5bb9\uff08\u6ce8\u610f\uff0c<code>Secret</code> \u7684\u5185\u5bb9\u662f base64 \u7f16\u7801\u7684\uff09\uff1a</p> <p><code>bash kubectl get secret db-secret -o yaml</code></p>"},{"location":"devops/K8s_1.html#configmap-secret-pod","title":"\u5c06 <code>ConfigMap</code> \u548c <code>Secret</code> \u6302\u8f7d\u5230 Pod \u4e2d","text":"<p>\u53ef\u4ee5\u5c06 <code>ConfigMap</code> \u548c <code>Secret</code> \u6302\u8f7d\u4e3a\u73af\u5883\u53d8\u91cf\u6216\u6587\u4ef6\u3002</p> <p>\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a <code>nginx-pod-with-config.yaml</code> \u7684\u6587\u4ef6\uff1a</p> <p><code>yaml apiVersion: v1 kind: Pod metadata:   name: nginx-pod-with-config spec:   containers:   - name: nginx     image: nginx:latest     env:     - name: APP_NAME       valueFrom:         configMapKeyRef:           name: my-config           key: app_name     - name: APP_ENV       valueFrom:         configMapKeyRef:           name: my-config           key: app_env     - name: DB_USERNAME       valueFrom:         secretKeyRef:           name: db-secret           key: username     - name: DB_PASSWORD       valueFrom:         secretKeyRef:           name: db-secret           key: password</code></p> <p>\u5e94\u7528\u8fd9\u4e2a YAML \u6587\u4ef6\uff1a</p> <p><code>bash kubectl apply -f nginx-pod-with-config.yaml</code></p> <ul> <li>\u8fd9\u6837\u521b\u5efa\u7684 Pod \u5c06\u53ef\u4ee5\u4ece <code>ConfigMap</code> \u548c <code>Secret</code> \u4e2d\u8bfb\u53d6\u73af\u5883\u53d8\u91cf\u3002</li> <li>\u53ef\u4ee5\u5728\u5bb9\u5668\u4e2d\u901a\u8fc7 <code>echo $APP_NAME</code> \u7b49\u547d\u4ee4\u67e5\u770b\u8fd9\u4e9b\u73af\u5883\u53d8\u91cf\u7684\u503c\u3002</li> </ul>"},{"location":"devops/K8s_1.html#4","title":"4. \u7f51\u7edc\u4e0e\u5b58\u50a8\u7c7b","text":"<ul> <li>Kubernetes \u4e2d\u7684 Service \u662f\u4ec0\u4e48\uff1f\u6709\u54ea\u51e0\u79cd\u7c7b\u578b\uff1f</li> <li>Service \u7528\u4e8e\u66b4\u9732\u5e94\u7528\uff0c\u7c7b\u578b\u5305\u62ec ClusterIP\u3001NodePort\u3001LoadBalancer\u3001ExternalName\u3002</li> <li>\u89e3\u91ca Ingress \u662f\u4ec0\u4e48\uff1f\u5982\u4f55\u914d\u7f6e Ingress\uff1f</li> <li>Ingress \u662f\u4e00\u4e2a API \u5bf9\u8c61\uff0c\u7528\u4e8e\u7ba1\u7406\u5916\u90e8\u8bbf\u95ee\u5230\u96c6\u7fa4\u670d\u52a1\u7684 HTTP \u548c HTTPS \u8def\u7531\u3002</li> <li>Kubernetes \u4e2d\u5982\u4f55\u5b9e\u73b0\u6301\u4e45\u5b58\u50a8\uff1f</li> <li>\u4f7f\u7528 PersistentVolume (PV) \u548c PersistentVolumeClaim (PVC)\uff0c\u4ee5\u53ca StorageClass \u7ba1\u7406\u6301\u4e45\u5b58\u50a8\u3002</li> <li>ClusterIP \u548c NodePort \u6709\u4ec0\u4e48\u533a\u522b\uff1f</li> <li>ClusterIP \u53ea\u5728\u96c6\u7fa4\u5185\u90e8\u66b4\u9732\u670d\u52a1\uff0c\u800c NodePort \u5219\u901a\u8fc7\u6bcf\u4e2a\u8282\u70b9\u7684\u7aef\u53e3\u5c06\u670d\u52a1\u66b4\u9732\u7ed9\u96c6\u7fa4\u5916\u90e8\u3002</li> </ul>"},{"location":"devops/K8s_2.html","title":"K8s \u76f8\u5173\u95ee\u9898\u96c6\u9526\uff08\u4e8c\uff09","text":""},{"location":"devops/K8s_2.html#5","title":"5. \u9ad8\u53ef\u7528\u4e0e\u6269\u5c55\u7c7b","text":""},{"location":"devops/K8s_2.html#51-hpahorizontal-pod-autoscaler","title":"5.1 HPA\uff08Horizontal Pod Autoscaler)","text":"<p>Horizontal Pod Autoscaler (HPA) \u662f Kubernetes \u4e2d\u7684\u4e00\u4e2a\u81ea\u52a8\u6269\u5c55\u673a\u5236\uff0c\u7528\u4e8e\u6839\u636e\u67d0\u4e9b\u6307\u6807\uff08\u901a\u5e38\u662f CPU\u3001\u5185\u5b58\u4f7f\u7528\u7387\u6216\u5176\u4ed6\u81ea\u5b9a\u4e49\u6307\u6807\uff09\u6765\u81ea\u52a8\u8c03\u6574 Pod \u7684\u526f\u672c\u6570\uff0c\u4ee5\u786e\u4fdd\u5e94\u7528\u7a0b\u5e8f\u80fd\u591f\u5728\u8d1f\u8f7d\u53d8\u5316\u65f6\u7ef4\u6301\u826f\u597d\u7684\u6027\u80fd\u3002\u5b83\u901a\u8fc7\u76d1\u63a7\u6307\u6807\u6570\u636e\uff0c\u5e76\u6839\u636e\u9884\u8bbe\u7684\u76ee\u6807\u503c\u8c03\u6574 Deployment \u6216 ReplicaSet \u4e2d Pod \u7684\u6570\u91cf\u3002</p> <p>Horizontal Pod Autoscaler (HPA) \u662f Kubernetes \u4e2d\u7528\u6765\u7ba1\u7406  Pod \u526f\u672c\u6570\u91cf\u7684\u81ea\u52a8\u6269\u5c55\u673a\u5236 \u3002\u5b83\u5173\u6ce8\u7684\u662f\u5982\u4f55\u6839\u636e\u8d1f\u8f7d\uff08\u4f8b\u5982 CPU \u4f7f\u7528\u7387\u6216\u81ea\u5b9a\u4e49\u6307\u6807\uff09\u6765\u52a8\u6001\u8c03\u6574\u67d0\u4e2a\u7279\u5b9a\u5e94\u7528\uff08\u5982 Deployment\u3001ReplicaSet\uff09\u4e2d\u7684 Pod \u6570\u91cf\u3002\u56e0\u6b64\uff0c\u5b83\u53ef\u4ee5\u88ab\u770b\u4f5c\u662f  \u5728\u5e94\u7528\u5c42\u9762\u8fdb\u884c\u7684 Pod \u526f\u672c\u7684\u96c6\u7fa4\u7ba1\u7406 \uff0c\u76ee\u7684\u662f\u786e\u4fdd\u67d0\u4e2a\u670d\u52a1\u5728\u8d1f\u8f7d\u589e\u52a0\u65f6\u6709\u8db3\u591f\u7684 Pod \u5904\u7406\u8bf7\u6c42\uff0c\u5728\u8d1f\u8f7d\u964d\u4f4e\u65f6\u53c8\u80fd\u81ea\u52a8\u7f29\u51cf Pod \u6570\u91cf\u4ee5\u8282\u7701\u8d44\u6e90\u3002</p>"},{"location":"devops/K8s_2.html#hpa","title":"HPA \u5de5\u4f5c\u539f\u7406","text":"<ul> <li>HPA \u5b9a\u671f\u67e5\u8be2\u6307\u6807\uff08\u5982 CPU \u4f7f\u7528\u7387\uff09\u5e76\u8ba1\u7b97\u6240\u9700\u7684\u526f\u672c\u6570\u91cf\u3002</li> <li>\u5982\u679c\u5f53\u524d\u7684\u8d44\u6e90\u4f7f\u7528\u7387\u9ad8\u4e8e\u8bbe\u5b9a\u7684\u76ee\u6807\u503c\uff0cHPA \u4f1a\u589e\u52a0 Pod \u7684\u526f\u672c\u6570\uff1b\u5982\u679c\u4f7f\u7528\u7387\u4f4e\u4e8e\u76ee\u6807\u503c\uff0c\u5219\u4f1a\u51cf\u5c11\u526f\u672c\u6570\u3002</li> <li>HPA \u7684\u914d\u7f6e\u901a\u5e38\u57fa\u4e8e Kubernetes Metrics Server \u6765\u83b7\u53d6\u6307\u6807\u6570\u636e\u3002\u90e8\u7f72 Metrics Server \u662f\u914d\u7f6e HPA \u7684\u524d\u63d0\u6761\u4ef6\u3002</li> </ul>"},{"location":"devops/K8s_2.html#hpa_1","title":"HPA \u914d\u7f6e\u793a\u4f8b","text":"<p>\u4ee5\u4e0b\u662f\u914d\u7f6e HPA \u7684\u5177\u4f53\u6b65\u9aa4\u548c\u547d\u4ee4\u793a\u4f8b\uff1a</p>"},{"location":"devops/K8s_2.html#_1","title":"\u524d\u63d0\u6761\u4ef6","text":"<p>\u786e\u4fdd Kubernetes \u96c6\u7fa4\u4e2d\u5df2\u7ecf\u5b89\u88c5\u5e76\u8fd0\u884c Metrics Server\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b Metrics Server \u662f\u5426\u6b63\u5e38\u5de5\u4f5c\uff1a</p> <p><code>bash kubectl get --raw \"/apis/metrics.k8s.io/v1beta1/nodes\"</code></p> <p>\u5982\u679c\u8fd4\u56de\u7684\u8282\u70b9\u6570\u636e\u5305\u542b CPU \u548c\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\uff0c\u8bf4\u660e Metrics Server \u6b63\u5e38\u5de5\u4f5c\u3002</p>"},{"location":"devops/K8s_2.html#1-deployment","title":"1. \u521b\u5efa Deployment","text":"<p>\u5047\u8bbe\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a <code>nginx-deployment</code> \u7684 Deployment\uff0c\u8fd0\u884c\u4e00\u4e2a nginx \u5bb9\u5668\uff1a</p> <p><code>bash kubectl create deployment nginx-deployment --image=nginx --replicas=2</code></p> <p>\u8fd9\u5c06\u4f1a\u521b\u5efa\u4e00\u4e2a\u6709 2 \u4e2a\u526f\u672c\u7684 Deployment\uff0c\u955c\u50cf\u4e3a <code>nginx</code>\u3002</p>"},{"location":"devops/K8s_2.html#2-hpa","title":"2. \u914d\u7f6e HPA","text":"<p>\u4f7f\u7528 <code>kubectl autoscale</code> \u547d\u4ee4\u4e3a <code>nginx-deployment</code> \u521b\u5efa\u4e00\u4e2a HPA\uff1a</p> <p><code>bash kubectl autoscale deployment nginx-deployment --cpu-percent=50 --min=2 --max=10</code></p> <ul> <li><code>--cpu-percent=50</code>\uff1a\u76ee\u6807 CPU \u4f7f\u7528\u7387\u4e3a 50%\u3002\u5f53 Pod \u7684\u5e73\u5747 CPU \u4f7f\u7528\u7387\u9ad8\u4e8e 50% \u65f6\uff0cHPA \u4f1a\u589e\u52a0\u526f\u672c\u6570\uff1b\u5f53\u4f4e\u4e8e 50% \u65f6\uff0cHPA \u4f1a\u51cf\u5c11\u526f\u672c\u6570\u3002</li> <li><code>--min=2</code>\uff1a\u6700\u5c0f\u526f\u672c\u6570\u4e3a 2\uff0c\u4fdd\u8bc1\u81f3\u5c11\u6709 2 \u4e2a Pod \u5728\u8fd0\u884c\u3002</li> <li><code>--max=10</code>\uff1a\u6700\u5927\u526f\u672c\u6570\u4e3a 10\uff0c\u4fdd\u8bc1\u5373\u4f7f\u8d1f\u8f7d\u589e\u52a0\uff0c\u526f\u672c\u6570\u4e5f\u4e0d\u4f1a\u8d85\u8fc7 10\u3002</li> </ul>"},{"location":"devops/K8s_2.html#3-hpa","title":"3. \u9a8c\u8bc1 HPA","text":"<p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b HPA \u7684\u72b6\u6001\uff1a</p> <p><code>bash kubectl get hpa</code></p> <p>\u4f60\u4f1a\u770b\u5230\u7c7b\u4f3c\u5982\u4e0b\u7684\u8f93\u51fa\uff1a</p> <p><code>NAME                 REFERENCE                     TARGETS    MINPODS   MAXPODS   REPLICAS   AGE nginx-deployment     Deployment/nginx-deployment   40%/50%    2         10        3          5m</code></p> <ul> <li><code>TARGETS</code>\uff1a\u663e\u793a\u5f53\u524d CPU \u4f7f\u7528\u7387\u548c\u76ee\u6807\u503c\uff08\u5982 40%/50%\uff09\u3002</li> <li><code>MINPODS</code> \u548c <code>MAXPODS</code>\uff1a\u663e\u793a\u914d\u7f6e\u7684\u6700\u5c0f\u548c\u6700\u5927 Pod \u526f\u672c\u6570\u3002</li> <li><code>REPLICAS</code>\uff1a\u5f53\u524d\u5b9e\u9645\u8fd0\u884c\u7684\u526f\u672c\u6570\u3002</li> </ul>"},{"location":"devops/K8s_2.html#4-hpa","title":"4. \u4fee\u6539 HPA","text":"<p>\u53ef\u4ee5\u4f7f\u7528 <code>kubectl edit</code> \u547d\u4ee4\u6765\u4fee\u6539 HPA \u7684\u914d\u7f6e\u3002\u4f8b\u5982\uff0c\u8c03\u6574 CPU \u4f7f\u7528\u7387\u76ee\u6807\u6216\u6700\u5927\u6700\u5c0f\u526f\u672c\u6570\uff1a</p> <p><code>bash kubectl edit hpa nginx-deployment</code></p> <p>\u6216\u8005\u76f4\u63a5\u4f7f\u7528 YAML \u6587\u4ef6\u4fee\u6539\u914d\u7f6e\u3002</p>"},{"location":"devops/K8s_2.html#5-yaml-hpa","title":"5. \u4f7f\u7528 YAML \u6587\u4ef6\u914d\u7f6e HPA","text":"<p>\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528 YAML \u6587\u4ef6\u914d\u7f6e HPA\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a <code>hpa.yaml</code> \u7684\u6587\u4ef6\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</p> <p><code>yaml apiVersion: autoscaling/v2 kind: HorizontalPodAutoscaler metadata:   name: nginx-deployment-hpa spec:   scaleTargetRef:     apiVersion: apps/v1     kind: Deployment     name: nginx-deployment   minReplicas: 2   maxReplicas: 10   metrics:   - type: Resource     resource:       name: cpu       target:         type: Utilization         averageUtilization: 50</code></p> <p>\u5e94\u7528\u8be5\u914d\u7f6e\uff1a</p> <p><code>bash kubectl apply -f hpa.yaml</code></p>"},{"location":"devops/K8s_2.html#6-hpa","title":"6. \u6d4b\u8bd5 HPA","text":"<p>\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u8d1f\u8f7d\u6765\u6d4b\u8bd5 HPA \u7684\u6548\u679c\u3002\u4f8b\u5982\uff0c\u8fd0\u884c\u4e00\u4e2a\u8d1f\u8f7d\u751f\u6210\u5668\u6765\u589e\u52a0 nginx \u7684 CPU \u4f7f\u7528\u7387\uff1a</p> <p><code>bash kubectl run -i --tty load-generator --image=busybox /bin/sh</code></p> <p>\u5728 <code>busybox</code> \u5bb9\u5668\u4e2d\uff0c\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u6765\u5411 nginx \u53d1\u9001\u6301\u7eed\u8bf7\u6c42\uff0c\u589e\u52a0 CPU \u8d1f\u8f7d\uff1a</p> <p><code>bash while true; do wget -q -O- http://nginx-deployment; done</code></p> <p>\u5728\u8d1f\u8f7d\u589e\u52a0\u540e\uff0cHPA \u4f1a\u81ea\u52a8\u589e\u52a0 <code>nginx-deployment</code> \u7684 Pod \u526f\u672c\u6570\uff0c\u4ee5\u5e94\u5bf9\u589e\u52a0\u7684\u8bf7\u6c42\u91cf\u3002\u53ef\u4ee5\u4f7f\u7528 <code>kubectl get hpa</code> \u89c2\u5bdf Pod \u6570\u91cf\u7684\u53d8\u5316\u3002</p>"},{"location":"devops/K8s_2.html#7-hpa","title":"7. \u5220\u9664 HPA","text":"<p>\u5982\u679c\u4e0d\u518d\u9700\u8981 HPA\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5220\u9664\uff1a</p> <p><code>bash kubectl delete hpa nginx-deployment</code></p>"},{"location":"devops/K8s_2.html#_2","title":"\u5c0f\u7ed3","text":"<ul> <li>HPA \u80fd\u591f\u6839\u636e\u5e94\u7528\u7a0b\u5e8f\u7684\u8d1f\u8f7d\u60c5\u51b5\uff0c\u81ea\u52a8\u8c03\u6574 Pod \u7684\u526f\u672c\u6570\u91cf\uff0c\u4ee5\u63d0\u9ad8\u8d44\u6e90\u5229\u7528\u7387\u548c\u7cfb\u7edf\u7684\u7a33\u5b9a\u6027\u3002</li> <li>\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u914d\u7f6e HPA \u65f6\u9700\u8981\u7efc\u5408\u8003\u8651\u5e94\u7528\u7684\u7279\u70b9\u3001\u96c6\u7fa4\u5bb9\u91cf\u3001\u54cd\u5e94\u65f6\u95f4\u7b49\u56e0\u7d20\u3002</li> <li>HPA \u7684\u5e94\u7528\u573a\u666f\u5305\u62ec Web \u670d\u52a1\u3001API \u670d\u52a1\u7b49\u9700\u8981\u6839\u636e\u8d1f\u8f7d\u6ce2\u52a8\u8fdb\u884c\u81ea\u52a8\u6269\u5c55\u7684\u573a\u666f\u3002 </li> </ul>"},{"location":"devops/K8s_2.html#52","title":"5.2 \u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027","text":"<p>\u8ba8\u8bba\u5bf9 Master \u8282\u70b9\u7684\u9ad8\u53ef\u7528\u6027\uff08\u5982\u591a Master \u8282\u70b9\u90e8\u7f72\uff09\u548c etcd \u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027\uff0c\u4ee5\u53ca\u5bf9\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u4f7f\u7528\u3002</p> <p>\u914d\u7f6e\u591a Master \u8282\u70b9\u7684\u9ad8\u53ef\u7528\u9700\u8981\u7684\u989d\u5916\u7ec4\u4ef6\u548c\u914d\u7f6e</p> <ul> <li>\u914d\u7f6e\u8d1f\u8f7d\u5747\u8861\u5668\uff08\u5982 HAProxy\uff09\u4ee5\u5747\u8861 API Server \u7684\u8bf7\u6c42\u3002</li> <li>\u914d\u7f6e <code>etcd</code> \u96c6\u7fa4\u8fdb\u884c\u6570\u636e\u5197\u4f59\uff0c\u6240\u6709 <code>kube-apiserver</code> \u5b9e\u4f8b\u8fde\u63a5\u5230\u540c\u4e00\u4e2a <code>etcd</code> \u96c6\u7fa4\u3002</li> <li>\u786e\u4fdd\u6b63\u786e\u914d\u7f6e TLS \u8bc1\u4e66\uff0c\u5c24\u5176\u662f\u5728\u591a\u4e2a API Server \u5b9e\u4f8b\u548c\u8d1f\u8f7d\u5747\u8861\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u3002</li> <li>\u914d\u7f6e\u548c\u7ba1\u7406 Master \u8282\u70b9\u4e4b\u95f4\u7684\u65f6\u95f4\u540c\u6b65\u3002</li> <li>\u4f7f\u7528 <code>kube-scheduler</code> \u548c <code>kube-controller-manager</code> \u7684 Leader Election \u786e\u4fdd\u5355\u4e00\u6d3b\u8dc3\u5b9e\u4f8b\u3002</li> <li>\u5b9a\u671f\u5907\u4efd <code>etcd</code> \u6570\u636e\uff0c\u5e76\u5236\u5b9a\u707e\u96be\u6062\u590d\u7b56\u7565\u3002</li> </ul>"},{"location":"devops/K8s_2.html#521-master-etcd","title":"5.2.1 \u591a\u4e2aMaster\u8282\u70b9\u4e0e etcd\u96c6\u7fa4\u7684\u5173\u7cfb\uff1a","text":"<p>Kubernetes \u4e2d Master \u8282\u70b9\u7684\u9ad8\u53ef\u7528\u6027\u4e0e etcd \u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027 \u5e76\u4e0d\u662f\u5b8c\u5168\u72ec\u7acb\u7684\u8fc7\u7a0b\uff0c\u800c\u662f\u7d27\u5bc6\u5173\u8054\u7684\uff0c\u9700\u8981\u540c\u65f6\u914d\u7f6e\u3002</p>"},{"location":"devops/K8s_2.html#_3","title":"\u539f\u56e0\u89e3\u6790\uff1a","text":"<ul> <li> <p>etcd \u662f Kubernetes \u63a7\u5236\u5e73\u9762\u7684\u6570\u636e\u5b58\u50a8\u6838\u5fc3\uff1a</p> </li> <li> <p><code>etcd</code> \u5b58\u50a8\u4e86 Kubernetes \u7684\u6240\u6709\u914d\u7f6e\u3001\u72b6\u6001\u548c\u96c6\u7fa4\u7684\u5143\u6570\u636e\uff0c\u6bd4\u5982\u6240\u6709\u7684 Pod\u3001Service\u3001ConfigMap \u7b49\u4fe1\u606f\u3002\u6240\u6709\u5bf9 Kubernetes API \u7684\u53d8\u66f4\uff08\u5982\u521b\u5efa\u3001\u66f4\u65b0\u3001\u5220\u9664\u8d44\u6e90\uff09\u90fd\u4f1a\u8bb0\u5f55\u5728 <code>etcd</code> \u4e2d\u3002</p> </li> <li>Kubernetes \u63a7\u5236\u5e73\u9762\uff08\u5373 <code>kube-apiserver</code>\u3001<code>kube-scheduler</code>\u3001<code>kube-controller-manager</code>\uff09\u9700\u8981\u4e0e <code>etcd</code> \u901a\u4fe1\u6765\u83b7\u53d6\u96c6\u7fa4\u72b6\u6001\u548c\u5199\u5165\u72b6\u6001\u53d8\u66f4\u3002</li> <li> <p>\u591a Master \u8282\u70b9\u9700\u8981\u8fde\u63a5\u5230\u540c\u4e00\u4e2a etcd \u96c6\u7fa4\uff1a</p> </li> <li> <p>\u5f53\u914d\u7f6e\u591a Master \u8282\u70b9\u65f6\uff0c\u6240\u6709\u7684 <code>kube-apiserver</code> \u5b9e\u4f8b\u90fd\u9700\u8981\u8fde\u63a5\u5230\u540c\u4e00\u4e2a <code>etcd</code> \u96c6\u7fa4\uff0c\u4ee5\u4fdd\u6301\u4e00\u81f4\u7684\u6570\u636e\u89c6\u56fe\u3002</p> </li> <li>\u5982\u679c <code>etcd</code> \u96c6\u7fa4\u4e0d\u53ef\u7528\uff0c\u90a3\u4e48\u5373\u4f7f\u6709\u591a\u4e2a Master \u8282\u70b9\uff0c\u8fd9\u4e9b <code>kube-apiserver</code> \u4e5f\u4f1a\u56e0\u4e3a\u65e0\u6cd5\u8bbf\u95ee <code>etcd</code> \u6570\u636e\u800c\u53d8\u5f97\u65e0\u6548\u3002</li> <li> <p>etcd \u7684\u9ad8\u53ef\u7528\u6027\u51b3\u5b9a\u4e86\u6570\u636e\u7684\u53ef\u7528\u6027\u548c\u4e00\u81f4\u6027\uff1a</p> </li> <li> <p>\u5728\u9ad8\u53ef\u7528\u7684 Kubernetes \u96c6\u7fa4\u4e2d\uff0c<code>etcd</code> \u901a\u5e38\u4f1a\u90e8\u7f72\u4e3a 3 \u4e2a\u6216\u66f4\u591a\u8282\u70b9\u7684\u96c6\u7fa4\uff0c\u4ee5\u786e\u4fdd\u5728\u67d0\u4e9b <code>etcd</code> \u8282\u70b9\u5931\u6548\u65f6\uff0c\u5176\u4ed6\u8282\u70b9\u53ef\u4ee5\u7ee7\u7eed\u5de5\u4f5c\u3002</p> </li> <li>\u5982\u679c <code>etcd</code> \u6ca1\u6709\u914d\u7f6e\u9ad8\u53ef\u7528\u6027\uff0c\u5373\u4f7f Master \u8282\u70b9\u662f\u591a\u526f\u672c\u90e8\u7f72\u7684\uff0c\u4e5f\u65e0\u6cd5\u4fdd\u8bc1\u96c6\u7fa4\u7684\u7a33\u5b9a\u6027\u548c\u6570\u636e\u7684\u4e00\u81f4\u6027\u3002</li> </ul>"},{"location":"devops/K8s_2.html#_4","title":"\u56e0\u6b64\uff0c\u9ad8\u53ef\u7528\u914d\u7f6e\u9700\u8981\u540c\u65f6\u8003\u8651\u4ee5\u4e0b\u4e24\u4e2a\u65b9\u9762\uff1a","text":"<ol> <li> <p>etcd \u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027\uff1a</p> </li> <li> <p>\u4f7f\u7528\u81f3\u5c11 3 \u4e2a\u8282\u70b9\u7684 <code>etcd</code> \u96c6\u7fa4\uff0c\u4fdd\u8bc1\u6570\u636e\u7684\u6301\u4e45\u6027\u548c\u5bb9\u9519\u80fd\u529b\u3002</p> </li> <li>\u914d\u7f6e <code>etcd</code> \u8282\u70b9\u4e92\u76f8\u901a\u4fe1\u548c\u540c\u6b65\u6570\u636e\uff0c\u786e\u4fdd\u5728\u53d1\u751f\u5355\u8282\u70b9\u6545\u969c\u65f6\u96c6\u7fa4\u4f9d\u7136\u53ef\u4ee5\u9009\u4e3e\u51fa\u65b0\u7684 <code>leader</code> \u5e76\u7ee7\u7eed\u8fd0\u884c\u3002</li> <li> <p>Master \u8282\u70b9\u7684\u9ad8\u53ef\u7528\u6027\uff1a</p> </li> <li> <p>\u591a\u4e2a Master \u8282\u70b9\u4e0a\u8fd0\u884c <code>kube-apiserver</code>\u3001<code>kube-scheduler</code> \u548c <code>kube-controller-manager</code>\uff0c\u901a\u8fc7\u8d1f\u8f7d\u5747\u8861\u5668\u5747\u8861\u5bf9 <code>kube-apiserver</code> \u7684\u8bf7\u6c42\u3002</p> </li> <li>\u6240\u6709 <code>kube-apiserver</code> \u5b9e\u4f8b\u90fd\u9700\u8981\u8fde\u63a5\u5230\u540c\u4e00\u4e2a\u9ad8\u53ef\u7528\u7684 <code>etcd</code> \u96c6\u7fa4\uff0c\u4ee5\u4fdd\u8bc1\u4e00\u81f4\u7684\u6570\u636e\u89c6\u56fe\u3002</li> </ol>"},{"location":"devops/K8s_2.html#_5","title":"\u9ad8\u53ef\u7528\u914d\u7f6e\u7684\u5173\u7cfb\u793a\u4f8b\uff1a","text":"<p>\u5047\u8bbe\u6211\u4eec\u6709 3 \u53f0\u670d\u52a1\u5668\uff0c\u5206\u522b\u4e3a <code>master1</code>\u3001<code>master2</code> \u548c <code>master3</code>\uff1a</p> <ul> <li>\u5728\u6bcf\u4e2a Master \u8282\u70b9\u4e0a \u90e8\u7f72\u4e00\u4e2a <code>etcd</code> \u8282\u70b9\uff0c\u540c\u65f6\u90e8\u7f72\u4e00\u4e2a <code>kube-apiserver</code>\u3001<code>kube-scheduler</code> \u548c <code>kube-controller-manager</code>\u3002</li> <li>\u914d\u7f6e <code>kube-apiserver</code> \u4f7f\u7528 <code>etcd</code> \u96c6\u7fa4\u7684\u591a\u4e2a\u5730\u5740\uff0c\u4f8b\u5982\uff1a   <code>bash   kube-apiserver --etcd-servers=http://master1:2379,http://master2:2379,http://master3:2379</code></li> <li>\u4f7f\u7528\u4e00\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\uff08\u5982 HAProxy\uff09\u5c06\u5916\u90e8\u7684 API \u8bf7\u6c42\u5747\u8861\u5206\u53d1\u5230\u591a\u4e2a <code>kube-apiserver</code> \u5b9e\u4f8b\u3002</li> </ul> <p>\u8fd9\u79cd\u914d\u7f6e\u65b9\u5f0f\u786e\u4fdd\uff1a</p> <ul> <li>\u5373\u4f7f <code>master1</code> \u6545\u969c\uff0c\u5176\u4ed6\u4e24\u4e2a <code>etcd</code> \u8282\u70b9\u548c <code>kube-apiserver</code> \u5b9e\u4f8b\u4f9d\u7136\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\uff0c\u4fdd\u8bc1\u96c6\u7fa4\u7684\u53ef\u7528\u6027\u3002</li> <li>\u5f53 <code>etcd</code> \u4e2d\u7684\u67d0\u4e2a\u8282\u70b9\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u5269\u4f59\u7684 <code>etcd</code> \u8282\u70b9\u53ef\u4ee5\u7ee7\u7eed\u63d0\u4f9b\u6570\u636e\u670d\u52a1\uff0c\u907f\u514d <code>kube-apiserver</code> \u65e0\u6cd5\u83b7\u53d6\u96c6\u7fa4\u72b6\u6001\u3002</li> </ul>"},{"location":"devops/K8s_2.html#_6","title":"\u603b\u7ed3","text":"<ul> <li>Master \u8282\u70b9\u7684\u9ad8\u53ef\u7528\u6027\u4e0e <code>etcd</code> \u9ad8\u53ef\u7528\u6027\u662f\u7d27\u5bc6\u5173\u8054\u7684\uff0c\u4e24\u8005\u9700\u8981\u540c\u65f6\u914d\u7f6e\u3002</li> <li><code>etcd</code> \u7684\u9ad8\u53ef\u7528\u6027\u4fdd\u8bc1\u4e86\u6570\u636e\u5b58\u50a8\u7684\u53ef\u9760\u6027\u548c\u4e00\u81f4\u6027\uff0c\u800c\u591a Master \u8282\u70b9\u4fdd\u8bc1\u4e86\u96c6\u7fa4\u63a7\u5236\u5e73\u9762\u7684\u5197\u4f59\u548c\u8d1f\u8f7d\u5747\u8861\u3002</li> <li>\u5982\u679c\u53ea\u914d\u7f6e Master \u8282\u70b9\u7684\u9ad8\u53ef\u7528\u6027\u800c\u4e0d\u914d\u7f6e <code>etcd</code> \u7684\u9ad8\u53ef\u7528\u6027\uff0c<code>etcd</code> \u4e00\u65e6\u51fa\u95ee\u9898\uff0c\u6574\u4e2a\u96c6\u7fa4\u4ecd\u7136\u4f1a\u4e0d\u53ef\u7528\u3002</li> </ul> <p>\u56e0\u6b64\uff0c\u5728\u8bbe\u8ba1 Kubernetes \u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027\u65f6\uff0c\u9700\u8981\u4ece\u6574\u4f53\u51fa\u53d1\uff0c\u786e\u4fdd\u63a7\u5236\u5e73\u9762\u548c\u6570\u636e\u5b58\u50a8\u90fd\u5177\u5907\u8db3\u591f\u7684\u5197\u4f59\u548c\u5bb9\u9519\u80fd\u529b\u3002</p>"},{"location":"devops/K8s_2.html#522-master-etcd","title":"5.2.2 Master\u8282\u70b9\u4e0e etcd\u96c6\u7fa4 \u7684\u5177\u4f53\u914d\u7f6e\u8fc7\u7a0b\uff1a","text":"<p>Kubernetes \u63a7\u5236\u5e73\u9762\u8d1f\u8d23\u96c6\u7fa4\u7684\u7ba1\u7406\u548c\u8c03\u5ea6\uff0c\u4e3b\u8981\u7ec4\u4ef6\u5305\u62ec <code>kube-apiserver</code>\u3001<code>kube-controller-manager</code>\u3001<code>kube-scheduler</code> \u548c <code>etcd</code>\u3002\u4e3a\u4e86\u5b9e\u73b0\u63a7\u5236\u5e73\u9762\u7684\u9ad8\u53ef\u7528\u6027\uff0c\u901a\u5e38\u9700\u8981\u914d\u7f6e\u591a\u4e2a Master \u8282\u70b9\u3002</p>"},{"location":"devops/K8s_2.html#master","title":"\u591a Master \u8282\u70b9\u90e8\u7f72","text":"<ul> <li>\u76ee\u7684\uff1a\u591a\u4e2a Master \u8282\u70b9\u53ef\u4ee5\u63d0\u4f9b\u5197\u4f59\uff0c\u907f\u514d\u5355\u4e2a Master \u8282\u70b9\u5931\u6548\u5bfc\u81f4\u6574\u4e2a\u96c6\u7fa4\u4e0d\u53ef\u7528\u3002</li> <li>\u914d\u7f6e\uff1a</li> <li>\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u5efa\u8bae\u81f3\u5c11\u90e8\u7f72 3 \u4e2a Master \u8282\u70b9\u3002\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\u5f53\u5176\u4e2d\u4e00\u4e2a\u8282\u70b9\u5931\u6548\u65f6\uff0c\u96c6\u7fa4\u4f9d\u7136\u53ef\u4ee5\u7ee7\u7eed\u5de5\u4f5c\u3002</li> <li><code>kube-apiserver</code> \u662f\u65e0\u72b6\u6001\u7684\uff0c\u53ef\u4ee5\u5728\u591a\u4e2a Master \u8282\u70b9\u4e0a\u540c\u65f6\u8fd0\u884c\u3002</li> <li><code>kube-scheduler</code> \u548c <code>kube-controller-manager</code> \u9700\u8981\u4ee5 <code>leader election</code> \u6a21\u5f0f\u8fd0\u884c\uff0c\u786e\u4fdd\u53ea\u6709\u4e00\u4e2a\u5b9e\u4f8b\u5728\u6d3b\u52a8\u72b6\u6001\uff0c\u800c\u5176\u4ed6\u5b9e\u4f8b\u5904\u4e8e\u5907\u7528\u72b6\u6001\u3002</li> </ul> <p>\u5728 Kubernetes \u4e2d\uff0c\u5b9e\u73b0\u63a7\u5236\u5e73\u9762\uff08Master \u8282\u70b9\uff09\u7684\u9ad8\u53ef\u7528\u6027\uff0c\u6d89\u53ca\u90e8\u7f72\u591a\u4e2a Master \u8282\u70b9\uff0c\u5e76\u914d\u7f6e\u8d1f\u8f7d\u5747\u8861\u5668\u6765\u5747\u8861\u5bf9 <code>kube-apiserver</code> \u7684\u8bf7\u6c42\uff0c\u786e\u4fdd\u5373\u4f7f\u90e8\u5206 Master \u8282\u70b9\u6545\u969c\uff0c\u6574\u4e2a\u96c6\u7fa4\u4f9d\u7136\u80fd\u591f\u6b63\u5e38\u5de5\u4f5c\u3002\u4ee5\u4e0b\u662f\u5177\u4f53\u7684\u914d\u7f6e\u6b65\u9aa4\uff0c\u5305\u62ec Master \u8282\u70b9\u7684\u8bbe\u7f6e\u3001etcd \u96c6\u7fa4\u7684\u914d\u7f6e\u4ee5\u53ca\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u914d\u7f6e\u3002</p>"},{"location":"devops/K8s_2.html#_7","title":"\u524d\u63d0\u6761\u4ef6","text":"<ul> <li>\u81f3\u5c11 3 \u53f0\u670d\u52a1\u5668\uff08\u63a8\u8350 3 \u53f0\u4ee5\u4e0a\u7684\u5947\u6570\u53f0\u670d\u52a1\u5668\uff0c\u4ee5\u786e\u4fdd etcd \u96c6\u7fa4\u5728\u53d1\u751f\u6545\u969c\u65f6\u4ecd\u80fd\u9009\u4e3e leader\uff09\u3002</li> <li>\u6bcf\u53f0\u670d\u52a1\u5668\u90fd\u9700\u8981\u6709\u4ee5\u4e0b\u7ec4\u4ef6\uff1a</li> <li>Kubernetes \u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\uff08<code>kube-apiserver</code>\u3001<code>kube-controller-manager</code>\u3001<code>kube-scheduler</code>\uff09\u3002</li> <li>etcd\uff08\u7528\u4e8e\u5b58\u50a8 Kubernetes \u7684\u72b6\u6001\u6570\u636e\uff09\u3002</li> <li>\u4e00\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\uff08\u53ef\u4ee5\u662f\u786c\u4ef6\u8bbe\u5907\uff0c\u4e5f\u53ef\u4ee5\u662f\u57fa\u4e8e\u8f6f\u4ef6\u7684 HAProxy\u3001Nginx \u7b49\uff09\u3002</li> </ul>"},{"location":"devops/K8s_2.html#1-master","title":"1. \u90e8\u7f72\u591a Master \u8282\u70b9","text":""},{"location":"devops/K8s_2.html#1-kube-apiserverkube-controller-manager-kube-scheduler","title":"\u6b65\u9aa4 1\uff1a\u5b89\u88c5 <code>kube-apiserver</code>\u3001<code>kube-controller-manager</code> \u548c <code>kube-scheduler</code>","text":"<p>\u5728\u6bcf\u4e2a Master \u8282\u70b9\u4e0a\uff0c\u5b89\u88c5\u5e76\u914d\u7f6e\u4ee5\u4e0b\u7ec4\u4ef6\uff1a</p> <ul> <li>kube-apiserver: \u5b83\u662f\u65e0\u72b6\u6001\u7684\uff0c\u53ef\u4ee5\u5728\u6bcf\u4e2a Master \u8282\u70b9\u4e0a\u8fd0\u884c\u5b9e\u4f8b\u3002</li> <li>kube-scheduler \u548c kube-controller-manager: \u9700\u8981\u914d\u7f6e\u4e3a\u542f\u7528 <code>leader election</code>\uff0c\u786e\u4fdd\u53ea\u6709\u4e00\u4e2a\u5b9e\u4f8b\u5728\u6d3b\u52a8\u72b6\u6001\u3002</li> </ul> <p>\u4f8b\u5982\uff0c\u5728 <code>kube-controller-manager</code> \u914d\u7f6e\u4e2d\u542f\u7528 <code>leader election</code>:</p> <p><code>bash kube-controller-manager --leader-elect=true</code></p>"},{"location":"devops/K8s_2.html#2-etcd","title":"\u6b65\u9aa4 2\uff1a\u914d\u7f6e <code>etcd</code> \u96c6\u7fa4","text":"<p>\u5728\u6bcf\u4e2a Master \u8282\u70b9\u4e0a\uff0c\u5b89\u88c5 <code>etcd</code>\uff0c\u5e76\u914d\u7f6e\u5b83\u4eec\u4e92\u76f8\u901a\u4fe1\u3002\u5047\u8bbe\u6211\u4eec\u6709 3 \u4e2a Master \u8282\u70b9\uff1a</p> <ul> <li><code>master1</code> (IP: 192.168.1.1)</li> <li><code>master2</code> (IP: 192.168.1.2)</li> <li><code>master3</code> (IP: 192.168.1.3)</li> </ul> <p>\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\uff0c\u542f\u52a8 <code>etcd</code> \u5e76\u914d\u7f6e\u96c6\u7fa4\u4fe1\u606f\uff1a</p> <p><code>master1</code> \u4e0a\u7684\u914d\u7f6e\u793a\u4f8b\uff1a</p> <p><code>bash etcd --name etcd1 \\   --initial-advertise-peer-urls http://192.168.1.1:2380 \\   --listen-peer-urls http://0.0.0.0:2380 \\   --advertise-client-urls http://192.168.1.1:2379 \\   --listen-client-urls http://0.0.0.0:2379 \\   --initial-cluster etcd1=http://192.168.1.1:2380,etcd2=http://192.168.1.2:2380,etcd3=http://192.168.1.3:2380 \\   --initial-cluster-state new</code></p> <p><code>master2</code> \u548c <code>master3</code> \u4e0a\u7684\u914d\u7f6e\u7c7b\u4f3c\uff0c\u53ea\u9700\u66ff\u6362 <code>--name</code> \u548c <code>--initial-advertise-peer-urls</code> \u7684\u503c\u3002</p>"},{"location":"devops/K8s_2.html#3-kube-apiserver-etcd","title":"\u6b65\u9aa4 3\uff1a\u914d\u7f6e <code>kube-apiserver</code> \u4f7f\u7528 <code>etcd</code> \u96c6\u7fa4","text":"<p>\u5728\u6bcf\u4e2a Master \u8282\u70b9\u4e0a\uff0c\u542f\u52a8 <code>kube-apiserver</code> \u5e76\u914d\u7f6e <code>--etcd-servers</code> \u8fde\u63a5\u5230 etcd \u96c6\u7fa4\u7684\u6240\u6709\u8282\u70b9\uff1a</p> <p><code>bash kube-apiserver --etcd-servers=http://192.168.1.1:2379,http://192.168.1.2:2379,http://192.168.1.3:2379 \\   --other-flags...</code></p> <p>\u8fd9\u6837\uff0c<code>kube-apiserver</code> \u5c31\u53ef\u4ee5\u8fde\u63a5\u5230\u591a\u4e2a <code>etcd</code> \u8282\u70b9\uff0c\u4fdd\u8bc1\u5373\u4f7f\u90e8\u5206 etcd \u8282\u70b9\u5931\u6548\uff0c\u96c6\u7fa4\u6570\u636e\u4f9d\u7136\u53ef\u4ee5\u8bbf\u95ee\u3002</p>"},{"location":"devops/K8s_2.html#523-load-balancer","title":"5.2.3 \u8d1f\u8f7d\u5747\u8861\u5668\uff08Load Balancer\uff09","text":"<p>\u8d1f\u8f7d\u5747\u8861\u94fe\u63a5\u7684IP\u5730\u5740</p> <p>\u5728\u914d\u7f6e Kubernetes \u63a7\u5236\u5e73\u9762\u7684\u9ad8\u53ef\u7528\u6027\u65f6\uff0c\u5916\u90e8\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u94fe\u63a5 IP \u901a\u5e38\u6307\u7684\u662f \u5404\u4e2a Master \u8282\u70b9\u4e0a <code>kube-apiserver</code> \u7684 IP \u5730\u5740\u548c\u7aef\u53e3\u3002\u8fd9\u4e2a\u7aef\u53e3\u662f <code>kube-apiserver</code> \u76d1\u542c\u7684\u7aef\u53e3\uff0c\u901a\u5e38\u662f 6443\u3002\u5b83\u65e2\u4e0d\u662f <code>NodePort</code>\uff0c\u4e5f\u4e0d\u662f <code>ClusterIP</code>\uff0c\u800c\u662f\u76f4\u63a5\u8fde\u63a5\u5230\u6bcf\u4e2a Master \u8282\u70b9\u4e0a <code>kube-apiserver</code> \u6240\u7ed1\u5b9a\u7684\u5730\u5740\u3002</p> <p>\u9644\u4ef6\uff1a \u8d1f\u8f7d\u5747\u8861\u9ad8\u53ef\u7528</p> <p>\u8d1f\u8f7d\u5747\u8861\u5668\u672c\u8eab\u4e5f\u662f\u4e00\u4e2a\u8f6f\u4ef6\u6216\u8bbe\u5907\uff0c\u5982\u679c\u5e0c\u671b\u8d1f\u8f7d\u5747\u8861\u5668\u4e5f\u5177\u5907\u9ad8\u53ef\u7528\u6027\uff0c\u90a3\u4e48\u901a\u5e38\u9700\u8981\u914d\u7f6e\u591a\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\u5b9e\u4f8b\uff0c\u5e76\u5bf9\u8fd9\u4e9b\u5b9e\u4f8b\u8fdb\u884c\u5197\u4f59\u90e8\u7f72\u3002\u8fd9\u6837\uff0c\u5373\u4f7f\u67d0\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\u8282\u70b9\u51fa\u73b0\u6545\u969c\uff0c\u53e6\u4e00\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\u8282\u70b9\u4ecd\u7136\u53ef\u4ee5\u7ee7\u7eed\u5de5\u4f5c\uff0c\u4ece\u800c\u786e\u4fdd\u6574\u4e2a\u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027\u3002</p>"},{"location":"devops/K8s_2.html#_8","title":"\u4e3a\u4ec0\u4e48\u8d1f\u8f7d\u5747\u8861\u5668\u662f\u5fc5\u8981\u7684\uff1f","text":"<ol> <li> <p>\u5206\u53d1\u6d41\u91cf \uff1a</p> </li> <li> <p>\u5728 Kubernetes \u4e2d\uff0c\u591a Master \u8282\u70b9\u610f\u5473\u7740\u6709\u591a\u4e2a <code>kube-apiserver</code> \u5b9e\u4f8b\u5728\u8fd0\u884c\u3002\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u4e3b\u8981\u4f5c\u7528\u662f \u5c06\u6765\u81ea\u5ba2\u6237\u7aef\uff08\u5982 <code>kubectl</code>\uff09\u6216\u5176\u4ed6\u96c6\u7fa4\u7ec4\u4ef6\uff08\u5982 <code>kubelet</code>\u3001<code>kube-proxy</code>\uff09\u7684\u8bf7\u6c42\uff0c\u5747\u8861\u5730\u5206\u53d1\u5230\u8fd9\u4e9b <code>kube-apiserver</code> \u5b9e\u4f8b\u4e0a \u3002</p> </li> <li> <p>\u8fd9\u4e0d\u4ec5\u4f18\u5316\u4e86\u6d41\u91cf\u5206\u5e03\uff0c\u8fd8\u786e\u4fdd\u4e86\u5373\u4f7f\u67d0\u4e2a <code>kube-apiserver</code> \u5b9e\u4f8b\u51fa\u73b0\u6545\u969c\uff0c\u5176\u4ed6\u7684\u5b9e\u4f8b\u4f9d\u7136\u53ef\u4ee5\u7ee7\u7eed\u5904\u7406\u8bf7\u6c42\u3002</p> </li> <li> <p>\u63d0\u9ad8\u96c6\u7fa4\u7684\u53ef\u7528\u6027 \uff1a</p> </li> <li> <p>\u5982\u679c\u6ca1\u6709\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u5ba2\u6237\u7aef\u548c\u5185\u90e8\u7ec4\u4ef6\u5c31\u9700\u8981\u76f4\u63a5\u4e0e\u67d0\u4e2a\u56fa\u5b9a\u7684 <code>kube-apiserver</code> \u8fdb\u884c\u4ea4\u4e92\u3002\u4e00\u65e6\u8fd9\u4e2a <code>kube-apiserver</code> \u6240\u5728\u7684 Master \u8282\u70b9\u5931\u6548\uff0c\u5ba2\u6237\u7aef\u5c31\u65e0\u6cd5\u4e0e\u96c6\u7fa4\u8fdb\u884c\u901a\u4fe1\uff0c \u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027\u5c06\u4f1a\u5931\u53bb\u610f\u4e49 \u3002</p> </li> <li> <p>\u901a\u8fc7\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u5373\u4f7f\u67d0\u4e2a <code>kube-apiserver</code> \u8282\u70b9\u4e0d\u53ef\u7528\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u53ef\u4ee5\u81ea\u52a8\u5c06\u8bf7\u6c42\u8def\u7531\u5230\u5176\u4ed6\u53ef\u7528\u7684 Master \u8282\u70b9\uff0c\u4ece\u800c\u5b9e\u73b0\u5bf9 <code>kube-apiserver</code> \u7684\u9ad8\u53ef\u7528\u6027\u3002</p> </li> <li> <p>\u7b80\u5316 API Server \u7684\u8bbf\u95ee \uff1a</p> </li> <li> <p>\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u53ef\u4ee5\u4e3a\u6240\u6709 <code>kube-apiserver</code> \u5b9e\u4f8b\u63d0\u4f9b\u4e00\u4e2a\u7edf\u4e00\u7684\u8bbf\u95ee\u5730\u5740\u3002\u65e0\u8bba\u6709\u591a\u5c11\u4e2a Master \u8282\u70b9\uff0c\u5ba2\u6237\u7aef\u90fd\u53ea\u9700\u8981\u77e5\u9053\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u5730\u5740\u5373\u53ef\u3002\u8fd9\u5927\u5927\u7b80\u5316\u4e86\u96c6\u7fa4\u7684\u7ba1\u7406\u548c\u7ef4\u62a4\u3002</p> </li> </ol>"},{"location":"devops/K8s_2.html#_9","title":"\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u90e8\u7f72\u65b9\u5f0f","text":"<ul> <li>\u4e91\u5e73\u53f0\u7684\u8d1f\u8f7d\u5747\u8861\u670d\u52a1 \uff1a\u5bf9\u4e8e\u5728\u4e91\u5e73\u53f0\uff08\u5982 AWS\u3001GCP\u3001Azure\uff09\u4e0a\u90e8\u7f72\u7684 Kubernetes \u96c6\u7fa4\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u8fd9\u4e9b\u5e73\u53f0\u63d0\u4f9b\u7684\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\uff08\u5982 AWS \u7684 ELB\u3001GCP \u7684 Load Balancer \u7b49\uff09\u3002</li> <li>\u81ea\u5efa\u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861\u5668 \uff1a\u5728\u88f8\u673a\u73af\u5883\u6216\u81ea\u5efa\u7684\u6570\u636e\u4e2d\u5fc3\uff0c\u53ef\u4ee5\u4f7f\u7528\u5f00\u6e90\u7684\u8d1f\u8f7d\u5747\u8861\u8f6f\u4ef6\uff0c\u5982  HAProxy \u3001Nginx \u6216  Keepalived \uff0c\u5c06\u5916\u90e8\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u4e0d\u540c\u7684 Master \u8282\u70b9\u7684 <code>kube-apiserver</code>\u3002</li> </ul> <p>\u5728\u914d\u7f6e Kubernetes \u591a Master \u8282\u70b9\u7684\u9ad8\u53ef\u7528\u6027\u65f6\uff0c\u9664\u4e86\u642d\u914d <code>etcd</code> \u96c6\u7fa4\u5916\uff0c\u8fd8\u9700\u8981\u914d\u7f6e\u4ee5\u4e0b\u51e0\u4e2a\u91cd\u8981\u7684\u7ec4\u4ef6\u548c\u673a\u5236\uff0c\u4ee5\u786e\u4fdd\u6574\u4e2a\u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027\u548c\u7a33\u5b9a\u6027\uff1a</p>"},{"location":"devops/K8s_2.html#1-load-balancer","title":"1. \u8d1f\u8f7d\u5747\u8861\u5668\uff08Load Balancer\uff09","text":"<p>\u8d1f\u8f7d\u5747\u8861\u5668 \u662f\u591a Master \u8282\u70b9\u9ad8\u53ef\u7528\u914d\u7f6e\u4e2d\u7684\u5173\u952e\u90e8\u5206\uff0c\u7528\u4e8e\u5c06\u5bf9 <code>kube-apiserver</code> \u7684\u8bf7\u6c42\u5747\u8861\u5730\u5206\u53d1\u5230\u591a\u4e2a Master \u8282\u70b9\u3002\u8fd9\u6837\u5373\u4f7f\u67d0\u4e2a Master \u8282\u70b9\u5931\u6548\uff0c\u8bf7\u6c42\u4e5f\u53ef\u4ee5\u81ea\u52a8\u8f6c\u53d1\u5230\u5176\u4ed6\u53ef\u7528\u7684 Master \u8282\u70b9\u3002</p>"},{"location":"devops/K8s_2.html#_10","title":"\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u914d\u7f6e\u9009\u9879\uff1a","text":"<ul> <li>\u4e91\u5e73\u53f0\u7684\u8d1f\u8f7d\u5747\u8861\u5668\uff1a\u5982\u679c Kubernetes \u96c6\u7fa4\u90e8\u7f72\u5728\u4e91\u73af\u5883\u4e2d\uff08\u5982 AWS\u3001GCP\u3001Azure \u7b49\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e91\u63d0\u4f9b\u7684\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\uff08\u5982 AWS ELB \u6216 GCP Load Balancer\uff09\u3002</li> <li>\u81ea\u5efa\u8d1f\u8f7d\u5747\u8861\u5668\uff1a\u5728\u88f8\u673a\u6216\u865a\u62df\u673a\u73af\u5883\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u8f6f\u4ef6\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u5982 HAProxy\u3001Nginx\u3001Keepalived \u7b49\u3002</li> </ul>"},{"location":"devops/K8s_2.html#haproxy","title":"HAProxy \u914d\u7f6e\u793a\u4f8b\uff1a","text":"<p><code>/etc/haproxy/haproxy.cfg</code>\uff1a</p> <p>```haproxy frontend kubernetes-api     bind *:6443     mode tcp     default_backend kubernetes-api-backend</p> <p>backend kubernetes-api-backend     mode tcp     balance roundrobin     server master1 192.168.1.1:6443 check     server master2 192.168.1.2:6443 check     server master3 192.168.1.3:6443 check ```</p> <ul> <li>\u8fd9\u5c06 <code>kubectl</code> \u6216\u96c6\u7fa4\u5185\u90e8\u7ec4\u4ef6\u53d1\u5f80 <code>https://&lt;haproxy-ip&gt;:6443</code> \u7684\u8bf7\u6c42\u5747\u8861\u5730\u5206\u53d1\u5230 <code>kube-apiserver</code> \u5b9e\u4f8b\u30024. \u6570\u636e\u5907\u4efd\u548c\u6062\u590d</li> </ul>"},{"location":"devops/K8s_2.html#_11","title":"\u8be6\u7ec6\u89e3\u91ca","text":"<p>\u5728\u591a Master \u8282\u70b9\u9ad8\u53ef\u7528\u914d\u7f6e\u4e2d\uff0c<code>kube-apiserver</code> \u5728\u6bcf\u4e2a Master \u8282\u70b9\u4e0a\u76f4\u63a5\u76d1\u542c\u4e00\u4e2a\u56fa\u5b9a\u7684 IP \u5730\u5740\u548c\u7aef\u53e3\uff0c\u901a\u5e38\u662f <code>https://&lt;master-ip&gt;:6443</code>\uff0c\u8fd9\u662f Kubernetes \u96c6\u7fa4\u7684\u63a7\u5236\u5e73\u9762\u901a\u4fe1\u6240\u4f7f\u7528\u7684\u5730\u5740\u3002\u5916\u90e8\u8d1f\u8f7d\u5747\u8861\u5668\u4f1a\u5c06\u6d41\u91cf\u76f4\u63a5\u8f6c\u53d1\u5230\u8fd9\u4e9b <code>kube-apiserver</code> \u5b9e\u4f8b\u3002</p>"},{"location":"devops/K8s_2.html#ip","title":"\u8d1f\u8f7d\u5747\u8861\u5668\u8fde\u63a5\u7684 IP \u914d\u7f6e\u793a\u4f8b","text":"<p>\u5047\u8bbe\u6211\u4eec\u6709 3 \u4e2a Master \u8282\u70b9\uff0cIP \u5730\u5740\u5982\u4e0b\uff1a</p> <ul> <li><code>master1</code>\uff1a192.168.1.1</li> <li><code>master2</code>\uff1a192.168.1.2</li> <li><code>master3</code>\uff1a192.168.1.3</li> </ul> <p>\u6bcf\u4e2a Master \u8282\u70b9\u7684 <code>kube-apiserver</code> \u90fd\u76d1\u542c\u5728\u5404\u81ea\u8282\u70b9\u7684 6443 \u7aef\u53e3\uff0c\u56e0\u6b64\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u540e\u7aef\u914d\u7f6e\u5e94\u8be5\u662f\u8fde\u63a5\u5230\u8fd9\u4e9b\u5730\u5740\u7684 6443 \u7aef\u53e3\u3002</p>"},{"location":"devops/K8s_2.html#haproxy_1","title":"\u4f7f\u7528 HAProxy \u914d\u7f6e\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u793a\u4f8b","text":"<p>\u5728\u8d1f\u8f7d\u5747\u8861\u5668\uff08\u4f8b\u5982 HAProxy\uff09\u4e0a\uff0c\u914d\u7f6e\u6587\u4ef6 <code>/etc/haproxy/haproxy.cfg</code> \u53ef\u80fd\u5982\u4e0b\uff1a</p> <p>```haproxy frontend kubernetes-api     bind *:6443     mode tcp     default_backend kubernetes-api-backend</p> <p>backend kubernetes-api-backend     mode tcp     balance roundrobin     server master1 192.168.1.1:6443 check     server master2 192.168.1.2:6443 check     server master3 192.168.1.3:6443 check ```</p> <ul> <li>frontend \u90e8\u5206\uff1a\u76d1\u542c\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u5916\u90e8 IP \u5730\u5740\u7684 <code>6443</code> \u7aef\u53e3\uff0c\u5c06\u8bf7\u6c42\u8f6c\u53d1\u5230 <code>backend</code>\u3002</li> <li>backend \u90e8\u5206\uff1a\u5b9a\u4e49\u540e\u7aef\u7684 <code>kube-apiserver</code> \u5b9e\u4f8b\u3002<code>server</code> \u914d\u7f6e\u4e2d\u6307\u5411\u4e86 <code>kube-apiserver</code> \u5728\u6bcf\u4e2a Master \u8282\u70b9\u4e0a\u7684 IP \u5730\u5740\u548c\u7aef\u53e3 <code>6443</code>\u3002</li> </ul>"},{"location":"devops/K8s_2.html#_12","title":"\u603b\u7ed3","text":"<ul> <li>\u5916\u90e8\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u540e\u7aef\u8fde\u63a5\u6307\u5411\u7684\u662f\u6bcf\u4e2a Master \u8282\u70b9\u7684 <code>kube-apiserver</code> \u5730\u5740\u548c\u7aef\u53e3\uff0c\u5373 <code>https://&lt;master-ip&gt;:6443</code>\u3002</li> <li>\u8fd9\u91cc\u7684 <code>6443</code> \u662f <code>kube-apiserver</code> \u7684\u9ed8\u8ba4\u76d1\u542c\u7aef\u53e3\uff0c\u7528\u4e8e\u5904\u7406\u6765\u81ea <code>kubectl</code>\u3001<code>kubelet</code> \u548c\u5176\u4ed6 Kubernetes \u7ec4\u4ef6\u7684 API \u8bf7\u6c42\u3002</li> <li>NodePort \u548c ClusterIP \u4e3b\u8981\u7528\u4e8e\u96c6\u7fa4\u5185\u90e8\u670d\u52a1\u7684\u901a\u4fe1\u548c\u66b4\u9732\uff0c\u800c\u4e0d\u662f\u7528\u4e8e <code>kube-apiserver</code> \u7684\u5916\u90e8\u8d1f\u8f7d\u5747\u8861\u3002</li> </ul> <p>\u901a\u8fc7\u8fd9\u79cd\u914d\u7f6e\uff0c\u5f53 <code>kubectl</code> \u6216\u96c6\u7fa4\u4e2d\u7684\u5176\u4ed6\u7ec4\u4ef6\u5411\u8d1f\u8f7d\u5747\u8861\u5668\u53d1\u9001\u8bf7\u6c42\u65f6\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u4f1a\u5c06\u8bf7\u6c42\u8f6c\u53d1\u5230\u53ef\u7528\u7684 <code>kube-apiserver</code> \u5b9e\u4f8b\uff0c\u4ece\u800c\u5b9e\u73b0\u5bf9\u63a7\u5236\u5e73\u9762\u7684\u9ad8\u53ef\u7528\u8bbf\u95ee\u3002</p> <p>\u5e0c\u671b\u8fd9\u80fd\u5e2e\u52a9\u4f60\u7406\u89e3\u5916\u90e8\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u914d\u7f6e\u65b9\u5f0f\uff0c\u5982\u679c\u6709\u5176\u4ed6\u95ee\u9898\uff0c\u968f\u65f6\u95ee\u6211\uff01</p>"},{"location":"devops/K8s_2.html#_13","title":"\u9ad8\u53ef\u7528\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u914d\u7f6e\u65b9\u5f0f","text":"<p>\u9ad8\u53ef\u7528\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u914d\u7f6e\u65b9\u5f0f\u901a\u5e38\u5305\u62ec\u4ee5\u4e0b\u4e24\u79cd\uff1a</p> <ol> <li> <p>\u4f7f\u7528 Keepalived \u5b9e\u73b0\u865a\u62df IP\uff08VIP\uff09\u9ad8\u53ef\u7528\u6027\uff1a</p> </li> <li> <p>\u5728\u88f8\u673a\u6216\u81ea\u5efa\u6570\u636e\u4e2d\u5fc3\u73af\u5883\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 Keepalived \u914d\u7f6e\u4e00\u4e2a\u865a\u62df IP \u5730\u5740\uff08VIP\uff09\uff0c\u8fd9\u4e2a VIP \u4f1a\u6f02\u79fb\u5230\u6d3b\u52a8\u72b6\u6001\u7684\u8d1f\u8f7d\u5747\u8861\u5668\u5b9e\u4f8b\u4e0a\u3002</p> </li> <li>\u5f53\u4e00\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\u8282\u70b9\uff08\u5982 HAProxy \u6216 Nginx\uff09\u5931\u6548\u65f6\uff0cVIP \u4f1a\u81ea\u52a8\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u5065\u5eb7\u7684\u8d1f\u8f7d\u5747\u8861\u5668\u8282\u70b9\u4e0a\uff0c\u5ba2\u6237\u7aef\u59cb\u7ec8\u4f7f\u7528\u540c\u4e00\u4e2a VIP \u8fdb\u884c\u8bbf\u95ee\u3002</li> <li>\u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u5197\u4f59\uff0c\u5e76\u5728\u8282\u70b9\u6545\u969c\u65f6\u81ea\u52a8\u8fdb\u884c\u6545\u969c\u5207\u6362\u3002</li> </ol> <p>#### Keepalived \u914d\u7f6e\u793a\u4f8b</p> <p>\u5047\u8bbe\u6211\u4eec\u6709\u4e24\u53f0\u670d\u52a1\u5668 <code>lb1</code> \u548c <code>lb2</code>\uff0c\u5b83\u4eec\u90fd\u8fd0\u884c HAProxy\uff0c\u5e76\u4f7f\u7528 Keepalived \u6765\u7ba1\u7406 VIP\uff1a</p> <p>lb1\uff08192.168.1.1\uff09\u7684 Keepalived \u914d\u7f6e\uff1a</p> <p><code>keepalived    vrrp_instance VI_1 {        state MASTER        interface eth0        virtual_router_id 51        priority 100        advert_int 1        authentication {            auth_type PASS            auth_pass 1234        }        virtual_ipaddress {            192.168.1.100        }    }</code></p> <p>lb2\uff08192.168.1.2\uff09\u7684 Keepalived \u914d\u7f6e\uff1a</p> <p><code>keepalived    vrrp_instance VI_1 {        state BACKUP        interface eth0        virtual_router_id 51        priority 90        advert_int 1        authentication {            auth_type PASS            auth_pass 1234        }        virtual_ipaddress {            192.168.1.100        }    }</code></p> <ul> <li><code>state</code>\uff1a\u5728 <code>lb1</code> \u4e0a\u914d\u7f6e\u4e3a <code>MASTER</code>\uff0c\u8868\u793a\u5b83\u9ed8\u8ba4\u662f\u4e3b\u8282\u70b9\uff1b\u5728 <code>lb2</code> \u4e0a\u914d\u7f6e\u4e3a <code>BACKUP</code>\uff0c\u8868\u793a\u5b83\u662f\u5907\u4efd\u8282\u70b9\u3002</li> <li><code>priority</code>\uff1a<code>lb1</code> \u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e <code>lb2</code>\uff0c\u56e0\u6b64\u5f53 <code>lb1</code> \u6b63\u5e38\u8fd0\u884c\u65f6\uff0cVIP \u4f1a\u7ed1\u5b9a\u5230 <code>lb1</code>\u3002\u5982\u679c <code>lb1</code> \u6545\u969c\uff0cVIP \u4f1a\u81ea\u52a8\u5207\u6362\u5230 <code>lb2</code>\u3002</li> <li><code>virtual_ipaddress</code>\uff1a\u865a\u62df IP \u5730\u5740 <code>192.168.1.100</code>\uff0c\u5ba2\u6237\u7aef\u4f7f\u7528\u8fd9\u4e2a IP \u6765\u8bbf\u95ee\u8d1f\u8f7d\u5747\u8861\u5668\u3002</li> </ul> <p>\u8fd9\u6837\uff0c\u5ba2\u6237\u7aef\u59cb\u7ec8\u4f7f\u7528 <code>192.168.1.100</code> \u4f5c\u4e3a\u8bbf\u95ee\u5165\u53e3\uff0c\u5373\u4f7f <code>lb1</code> \u5931\u6548\uff0cKeepalived \u4f1a\u81ea\u52a8\u5c06 VIP \u5207\u6362\u5230 <code>lb2</code>\uff0c\u4ece\u800c\u5b9e\u73b0\u9ad8\u53ef\u7528\u3002 2. \u4f7f\u7528\u4e91\u5e73\u53f0\u7684\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\uff1a</p> <ul> <li>\u5982\u679c\u4f60\u7684 Kubernetes \u96c6\u7fa4\u90e8\u7f72\u5728\u4e91\u73af\u5883\uff08\u5982 AWS\u3001GCP\u3001Azure\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e91\u63d0\u4f9b\u7684\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u3002\u4e91\u5e73\u53f0\u901a\u5e38\u4f1a\u81ea\u52a8\u4e3a\u4f60\u7ba1\u7406\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u9ad8\u53ef\u7528\u6027\u3002</li> <li>\u4f8b\u5982\uff0c\u5728 AWS \u4e2d\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 Elastic Load Balancer (ELB)\uff0c\u5b83\u4f1a\u81ea\u52a8\u5206\u5e03\u5728\u591a\u4e2a\u53ef\u7528\u533a\uff08Availability Zones\uff09\u5185\uff0c\u5373\u4f7f\u67d0\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\u5b9e\u4f8b\u51fa\u73b0\u95ee\u9898\uff0cAWS \u4e5f\u4f1a\u81ea\u52a8\u63d0\u4f9b\u5197\u4f59\u3002</li> <li>\u8fd9\u79cd\u65b9\u5f0f\u975e\u5e38\u9002\u5408\u4e91\u4e0a\u90e8\u7f72\u7684\u96c6\u7fa4\uff0c\u56e0\u4e3a\u65e0\u9700\u81ea\u5df1\u7ba1\u7406\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u9ad8\u53ef\u7528\u6027\uff0c\u53ea\u9700\u914d\u7f6e\u597d\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u76ee\u6807\u7ec4\uff0c\u5c06 Master \u8282\u70b9\u6dfb\u52a0\u4e3a\u540e\u7aef\u3002</li> </ul>"},{"location":"devops/K8s_2.html#_14","title":"\u4e3a\u4ec0\u4e48\u9700\u8981\u591a\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\u8282\u70b9\uff1f","text":"<p>\u914d\u7f6e\u591a\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\u8282\u70b9\u7684\u597d\u5904\u5728\u4e8e\uff1a</p> <ul> <li>\u907f\u514d\u5355\u70b9\u6545\u969c\uff1a\u5982\u679c\u53ea\u6709\u4e00\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\u5b9e\u4f8b\uff0c\u90a3\u4e48\u4e00\u65e6\u8be5\u5b9e\u4f8b\u6545\u969c\uff0c\u96c6\u7fa4\u7684 API Server \u5c31\u4e0d\u53ef\u8bbf\u95ee\uff0c\u6574\u4e2a Kubernetes \u63a7\u5236\u5e73\u9762\u7684\u9ad8\u53ef\u7528\u6027\u4e5f\u5c31\u5931\u53bb\u4e86\u610f\u4e49\u3002</li> <li>\u66f4\u597d\u7684\u670d\u52a1\u7a33\u5b9a\u6027\uff1a\u591a\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\u8282\u70b9\u80fd\u591f\u66f4\u597d\u5730\u5904\u7406\u9ad8\u6d41\u91cf\u8bf7\u6c42\uff0c\u907f\u514d\u5355\u4e2a\u5b9e\u4f8b\u6210\u4e3a\u6027\u80fd\u74f6\u9888\u3002</li> <li>\u5b9e\u73b0\u65e0\u7f1d\u6545\u969c\u5207\u6362\uff1a\u901a\u8fc7 Keepalived \u6216\u4e91\u5e73\u53f0\u7684\u9ad8\u53ef\u7528\u673a\u5236\uff0c\u53ef\u4ee5\u5728\u8d1f\u8f7d\u5747\u8861\u5668\u5b9e\u4f8b\u6545\u969c\u65f6\u65e0\u7f1d\u5207\u6362\u5230\u5907\u4efd\u8282\u70b9\uff0c\u63d0\u5347\u96c6\u7fa4\u7684\u53ef\u9760\u6027\u3002</li> <li>\u8d1f\u8f7d\u5747\u8861\u5668\u5728 Kubernetes \u9ad8\u53ef\u7528\u914d\u7f6e\u4e2d\u662f\u5fc5\u987b\u7684\uff0c\u4f46\u5982\u679c\u5e0c\u671b\u8d1f\u8f7d\u5747\u8861\u5668\u672c\u8eab\u5177\u5907\u9ad8\u53ef\u7528\u6027\uff0c\u9700\u8981\u90e8\u7f72\u591a\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\u5b9e\u4f8b\u3002</li> <li>\u53ef\u4ee5\u901a\u8fc7 Keepalived \u914d\u7f6e\u865a\u62df IP \u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u9ad8\u53ef\u7528\u6027\uff0c\u6216\u8005\u4f7f\u7528 \u4e91\u5e73\u53f0\u63d0\u4f9b\u7684\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\uff0c\u4ece\u800c\u4fdd\u8bc1\u5373\u4f7f\u67d0\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\u8282\u70b9\u5931\u6548\uff0c\u96c6\u7fa4\u4f9d\u7136\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u3002</li> <li>\u6838\u5fc3\u601d\u8def \u662f\u6d88\u9664\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u5355\u70b9\u6545\u969c\uff0c\u786e\u4fdd\u6574\u4e2a Kubernetes \u96c6\u7fa4\u5728\u9762\u5bf9\u5404\u79cd\u786c\u4ef6\u6216\u7f51\u7edc\u95ee\u9898\u65f6\u80fd\u591f\u6301\u7eed\u63d0\u4f9b\u670d\u52a1\u3002</li> </ul>"},{"location":"devops/K8s_2.html#524-dns","title":"5.2.4 \u670d\u52a1\u53d1\u73b0\u548c DNS \u914d\u7f6e","text":"<p>\u5728\u9ad8\u53ef\u7528\u73af\u5883\u4e2d\uff0c\u9700\u8981\u786e\u4fdd \u6240\u6709 Master \u8282\u70b9\u7684 API Server \u80fd\u591f\u88ab\u96c6\u7fa4\u5185\u90e8\u7ec4\u4ef6\u6b63\u786e\u5730\u8bbf\u95ee\u3002\u9664\u4e86\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u8fd8\u9700\u8981\u914d\u7f6e\u670d\u52a1\u53d1\u73b0\u673a\u5236\uff0c\u4f7f\u5f97\u7ec4\u4ef6\u80fd\u591f\u5728\u4e0d\u540c Master \u8282\u70b9\u95f4\u81ea\u52a8\u5207\u6362\u3002</p> <ul> <li>CoreDNS\uff1aKubernetes \u9ed8\u8ba4\u4f7f\u7528 CoreDNS \u6765\u7ba1\u7406\u96c6\u7fa4\u5185\u90e8\u7684 DNS \u89e3\u6790\uff0c\u786e\u4fdd <code>kubelet</code> \u548c\u5176\u4ed6\u7ec4\u4ef6\u53ef\u4ee5\u6b63\u786e\u89e3\u6790\u670d\u52a1\u548c\u8282\u70b9\u7684\u5730\u5740\u3002</li> <li>External DNS\uff1a\u5982\u679c\u9700\u8981\u4ece\u96c6\u7fa4\u5916\u90e8\u8bbf\u95ee API Server\uff0c\u4e5f\u53ef\u4ee5\u914d\u7f6e DNS \u670d\u52a1\u4ee5\u6307\u5411\u8d1f\u8f7d\u5747\u8861\u5668\u7684 IP\u3002</li> </ul> <p>\u5728\u9ad8\u53ef\u7528\u7684 Kubernetes \u96c6\u7fa4\u4e2d\uff0c\u914d\u7f6e CoreDNS \u548c External DNS \u53ef\u4ee5\u786e\u4fdd\u96c6\u7fa4\u5185\u90e8\u548c\u5916\u90e8\u7684\u7ec4\u4ef6\u80fd\u591f\u6b63\u786e\u5730\u8bbf\u95ee <code>kube-apiserver</code> \u548c\u5176\u4ed6\u670d\u52a1\u3002\u4ee5\u4e0b\u662f\u5173\u4e8e\u8fd9\u4e24\u8005\u7684\u914d\u7f6e\u65b9\u6cd5\uff1a</p>"},{"location":"devops/K8s_2.html#1-coredns","title":"1. \u914d\u7f6e CoreDNS","text":"<p>Kubernetes \u96c6\u7fa4\u9ed8\u8ba4\u4f7f\u7528 CoreDNS \u4f5c\u4e3a DNS \u670d\u52a1\u5668\uff0c\u7528\u4e8e\u89e3\u6790\u96c6\u7fa4\u5185\u90e8\u7684\u670d\u52a1\u540d\u79f0\u3002CoreDNS \u8d1f\u8d23\u5c06\u670d\u52a1\u540d\u79f0\u89e3\u6790\u4e3a <code>ClusterIP</code>\uff0c\u4f7f\u5f97\u96c6\u7fa4\u5185\u90e8\u7684 Pod \u548c\u670d\u52a1\u80fd\u591f\u901a\u8fc7 DNS \u540d\u79f0\u8fdb\u884c\u901a\u4fe1\u3002</p>"},{"location":"devops/K8s_2.html#coredns","title":"CoreDNS \u7684\u914d\u7f6e\u65b9\u6cd5","text":"<p>CoreDNS \u901a\u5e38\u5728 <code>kubeadm</code> \u521d\u59cb\u5316\u96c6\u7fa4\u65f6\u81ea\u52a8\u5b89\u88c5\uff0c\u5e76\u4f5c\u4e3a <code>kube-system</code> \u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u4e00\u4e2a <code>Deployment</code> \u8fd0\u884c\u3002\u5b83\u7684\u914d\u7f6e\u6587\u4ef6\u901a\u5e38\u5b58\u50a8\u5728 <code>ConfigMap</code> \u4e2d\uff1a</p> <ul> <li>\u67e5\u770b CoreDNS \u7684 <code>ConfigMap</code>\uff1a</li> </ul> <p><code>bash   kubectl -n kube-system get configmap coredns -o yaml</code> - \u5178\u578b\u7684 <code>CoreDNS</code> \u914d\u7f6e\u6587\u4ef6\uff08<code>ConfigMap</code> \u4e2d\uff09\uff1a</p> <p><code>yaml   apiVersion: v1   kind: ConfigMap   metadata:     name: coredns     namespace: kube-system   data:     Corefile: |       .:53 {         errors         health {           lameduck 5s         }         ready         kubernetes cluster.local in-addr.arpa ip6.arpa {           pods insecure           fallthrough in-addr.arpa ip6.arpa           ttl 30         }         prometheus :9153         forward . /etc/resolv.conf         cache 30         loop         reload         loadbalance       }</code> - \u914d\u7f6e\u8bf4\u660e\uff1a</p> <ul> <li><code>kubernetes</code> \u6bb5\u914d\u7f6e\u4e86\u7528\u4e8e\u89e3\u6790 Kubernetes \u670d\u52a1\u7684 <code>cluster.local</code> \u57df\u3002</li> <li><code>forward</code> \u6bb5\u5b9a\u4e49\u4e86\u5982\u4f55\u5c06\u672a\u5339\u914d\u7684\u8bf7\u6c42\u8f6c\u53d1\u5230\u96c6\u7fa4\u5916\u90e8\u7684 DNS \u670d\u52a1\u5668\u3002</li> <li><code>cache</code> \u6bb5\u7528\u4e8e\u7f13\u5b58\u89e3\u6790\u7ed3\u679c\uff0c\u51cf\u5c11 DNS \u8bf7\u6c42\u7684\u5ef6\u8fdf\u3002</li> </ul>"},{"location":"devops/K8s_2.html#coredns_1","title":"CoreDNS \u7684\u5e38\u89c1\u64cd\u4f5c","text":"<ul> <li>\u91cd\u542f CoreDNS\uff1a\u5982\u679c\u4fee\u6539\u4e86 CoreDNS \u7684\u914d\u7f6e\uff0c\u9700\u8981\u91cd\u542f <code>coredns</code> Pod \u4f7f\u914d\u7f6e\u751f\u6548\uff1a   <code>bash   kubectl -n kube-system rollout restart deployment coredns</code></li> </ul>"},{"location":"devops/K8s_2.html#2-external-dns","title":"2. \u914d\u7f6e External DNS","text":"<p>External DNS \u662f\u4e3a\u4e86\u786e\u4fdd\u4ece\u96c6\u7fa4\u5916\u90e8\u8bbf\u95ee API Server \u65f6\u80fd\u591f\u89e3\u6790\u5230\u8d1f\u8f7d\u5747\u8861\u5668\u7684 IP \u5730\u5740\u3002\u8fd9\u79cd\u914d\u7f6e\u901a\u5e38\u7528\u4e8e\u4ee5\u4e0b\u573a\u666f\uff1a</p> <ul> <li>\u5728\u81ea\u5efa\u7684\u6570\u636e\u4e2d\u5fc3\u73af\u5883\u4e2d\uff0c\u4f60\u6709\u4e00\u4e2a \u5185\u90e8\u6216\u5916\u90e8 DNS \u670d\u52a1\u5668\uff0c\u5e0c\u671b\u80fd\u591f\u901a\u8fc7\u57df\u540d\u8bbf\u95ee Kubernetes \u7684 <code>kube-apiserver</code>\u3002</li> <li>\u5728\u4e91\u73af\u5883\u4e2d\uff0c\u4f7f\u7528 \u4e91\u63d0\u4f9b\u7684 DNS \u670d\u52a1\uff08\u5982 AWS Route 53\u3001GCP Cloud DNS\uff09\u6765\u89e3\u6790 API Server \u7684\u57df\u540d\u3002</li> </ul>"},{"location":"devops/K8s_2.html#dns-ip","title":"\u4f7f\u7528\u5916\u90e8 DNS \u89e3\u6790\u8d1f\u8f7d\u5747\u8861\u5668\u7684 IP","text":"<p>\u5047\u8bbe\u8d1f\u8f7d\u5747\u8861\u5668\u7684 IP \u662f <code>203.0.113.10</code>\uff0c\u6211\u4eec\u5e0c\u671b\u901a\u8fc7 <code>api.k8s.example.com</code> \u6765\u8bbf\u95ee Kubernetes API Server\u3002\u53ef\u4ee5\u5728\u5916\u90e8 DNS \u670d\u52a1\u5668\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u8bb0\u5f55\uff1a</p> <ul> <li>A \u8bb0\u5f55\uff1a</li> </ul> <p><code>api.k8s.example.com. IN A 203.0.113.10</code></p> <ul> <li>\u7c7b\u578b\uff1aA \u8bb0\u5f55</li> <li>\u540d\u79f0\uff1aapi.k8s.example.com</li> <li>\u503c\uff1a203.0.113.10\uff08\u8d1f\u8f7d\u5747\u8861\u5668\u7684 IP\uff09</li> </ul> <p>\u8fd9\u79cd\u65b9\u5f0f\u786e\u4fdd\u6240\u6709\u8bbf\u95ee <code>api.k8s.example.com</code> \u7684\u8bf7\u6c42\u90fd\u88ab\u89e3\u6790\u5230\u8d1f\u8f7d\u5747\u8861\u5668\u7684 IP\u3002</p>"},{"location":"devops/K8s_2.html#external-dns-aws","title":"\u5728\u4e91\u73af\u5883\u4e2d\u914d\u7f6e External DNS\uff08\u4ee5 AWS \u4e3a\u4f8b\uff09","text":"<p>\u5728\u4e91\u5e73\u53f0\u4e2d\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 ExternalDNS \u5de5\u5177\u6765\u81ea\u52a8\u7ba1\u7406\u57df\u540d\u89e3\u6790\u3002ExternalDNS \u662f\u4e00\u4e2a\u5f00\u6e90\u9879\u76ee\uff0c\u53ef\u4ee5\u6839\u636e Kubernetes \u7684\u670d\u52a1\u81ea\u52a8\u521b\u5efa\u548c\u7ba1\u7406 DNS \u8bb0\u5f55\u3002\u4ee5\u4e0b\u662f\u4f7f\u7528 ExternalDNS \u7684\u793a\u4f8b\u6b65\u9aa4\uff08\u4ee5 AWS Route 53 \u4e3a\u4f8b\uff09\uff1a</p> <ul> <li>\u5b89\u88c5 ExternalDNS\uff1a   \u521b\u5efa\u4e00\u4e2a <code>external-dns.yaml</code> \u6587\u4ef6\u5e76\u90e8\u7f72\uff1a</li> </ul> <p><code>yaml   apiVersion: apps/v1   kind: Deployment   metadata:     name: external-dns     namespace: kube-system   spec:     replicas: 1     selector:       matchLabels:         app: external-dns     template:       metadata:         labels:           app: external-dns       spec:         containers:         - name: external-dns           image: bitnami/external-dns:latest           args:           - --source=service           - --source=ingress           - --domain-filter=example.com           - --provider=aws           - --policy=sync           - --aws-zone-type=public</code> - \u914d\u7f6e\u8bf4\u660e\uff1a</p> <ul> <li><code>--source=service</code> \u548c <code>--source=ingress</code>\uff1aExternalDNS \u4f1a\u6839\u636e Kubernetes \u4e2d\u7684\u670d\u52a1\u548c Ingress \u521b\u5efa DNS \u8bb0\u5f55\u3002</li> <li><code>--domain-filter=example.com</code>\uff1a\u53ea\u5904\u7406 <code>example.com</code> \u57df\u7684 DNS \u8bb0\u5f55\u3002</li> <li><code>--provider=aws</code>\uff1a\u4f7f\u7528 AWS \u4f5c\u4e3a DNS \u670d\u52a1\u63d0\u4f9b\u5546\u3002</li> <li><code>--policy=sync</code>\uff1a\u540c\u6b65 Kubernetes \u8d44\u6e90\u4e0e DNS \u8bb0\u5f55\u3002</li> <li>\u90e8\u7f72 ExternalDNS\uff1a</li> </ul> <p><code>bash   kubectl apply -f external-dns.yaml</code> - AWS IAM \u6743\u9650\u914d\u7f6e\uff1a   \u786e\u4fdd ExternalDNS \u8fd0\u884c\u7684\u670d\u52a1\u8d26\u6237\u5177\u6709\u64cd\u4f5c Route 53 \u7684\u6743\u9650\uff0c\u4f8b\u5982\uff0c\u53ef\u4ee5\u4e3a ExternalDNS \u914d\u7f6e\u4ee5\u4e0b IAM \u6743\u9650\uff1a</p> <p><code>json   {     \"Version\": \"2012-10-17\",     \"Statement\": [       {         \"Effect\": \"Allow\",         \"Action\": [           \"route53:ChangeResourceRecordSets\",           \"route53:ListHostedZones\",           \"route53:ListResourceRecordSets\"         ],         \"Resource\": [\"*\"]       }     ]   }</code></p>"},{"location":"devops/K8s_2.html#_15","title":"\u603b\u7ed3","text":"<ol> <li> <p>CoreDNS \u914d\u7f6e\uff1a</p> </li> <li> <p>\u8d1f\u8d23\u96c6\u7fa4\u5185\u90e8\u7684\u670d\u52a1\u53d1\u73b0\u548c DNS \u89e3\u6790\uff0c\u786e\u4fdd <code>kubelet</code>\u3001<code>Pod</code> \u548c\u5176\u4ed6 Kubernetes \u7ec4\u4ef6\u80fd\u6b63\u786e\u89e3\u6790\u670d\u52a1\u7684 DNS \u540d\u79f0\u3002</p> </li> <li>\u901a\u5e38\u5728\u96c6\u7fa4\u521d\u59cb\u5316\u65f6\u81ea\u52a8\u914d\u7f6e\uff0c\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539 <code>ConfigMap</code> \u6765\u8c03\u6574\u3002</li> <li> <p>External DNS \u914d\u7f6e\uff1a</p> </li> <li> <p>\u7528\u4e8e\u786e\u4fdd\u4ece\u5916\u90e8\u80fd\u591f\u8bbf\u95ee\u5230 Kubernetes API Server \u6216\u5176\u4ed6\u66b4\u9732\u5728\u5916\u90e8\u7684\u670d\u52a1\u3002</p> </li> <li>\u53ef\u4ee5\u5728\u81ea\u5efa DNS \u670d\u52a1\u5668\u4e2d\u624b\u52a8\u6dfb\u52a0 A \u8bb0\u5f55\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5de5\u5177\uff08\u5982 ExternalDNS\uff09\u5728\u4e91\u5e73\u53f0\u4e0a\u81ea\u52a8\u7ba1\u7406\u57df\u540d\u89e3\u6790\u3002</li> <li>\u8d1f\u8f7d\u5747\u8861\u5668\u7684 IP \u662f\u5916\u90e8 DNS \u6307\u5411\u7684\u76ee\u6807\uff0c\u901a\u5e38\u662f <code>api.&lt;domain&gt;</code> \u6307\u5411\u8d1f\u8f7d\u5747\u8861\u5668\u7684 IP\uff0c\u4ece\u800c\u5c06\u5916\u90e8\u8bbf\u95ee\u8bf7\u6c42\u8f6c\u53d1\u5230\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u518d\u7531\u8d1f\u8f7d\u5747\u8861\u5668\u5206\u53d1\u5230\u5404\u4e2a <code>kube-apiserver</code>\u3002</li> </ol> <p>\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u4f60\u53ef\u4ee5\u786e\u4fdd Kubernetes \u96c6\u7fa4\u5185\u90e8\u548c\u5916\u90e8\u7684 DNS \u914d\u7f6e\u90fd\u80fd\u652f\u6301\u9ad8\u53ef\u7528\u7684\u8bbf\u95ee\u3002\u5e0c\u671b\u8fd9\u4e9b\u4fe1\u606f\u5bf9\u4f60\u6709\u5e2e\u52a9\uff0c\u5982\u679c\u8fd8\u6709\u5176\u4ed6\u95ee\u9898\u6216\u9700\u8981\u66f4\u8be6\u7ec6\u7684\u89e3\u91ca\uff0c\u6b22\u8fce\u7ee7\u7eed\u4ea4\u6d41\uff01</p>"},{"location":"devops/K8s_2.html#525","title":"5.2.5 \u96c6\u7fa4\u8bc1\u4e66\u7ba1\u7406","text":"<p>\u7531\u4e8e <code>kube-apiserver</code> \u548c\u5176\u4ed6\u7ec4\u4ef6\u4e4b\u95f4\u7684\u901a\u4fe1\u901a\u5e38\u901a\u8fc7 HTTPS \u8fdb\u884c\uff0c\u56e0\u6b64\u5728\u9ad8\u53ef\u7528\u73af\u5883\u4e0b\uff0c\u5fc5\u987b\u6b63\u786e\u914d\u7f6e TLS \u8bc1\u4e66\u3002\u7279\u522b\u662f\u591a Master \u8282\u70b9\u65f6\uff0c\u786e\u4fdd\u8bc1\u4e66\u5728\u6240\u6709 Master \u8282\u70b9\u4e0a\u662f\u76f8\u540c\u7684\u3002</p> <ul> <li>CA\uff08Certificate Authority\uff09\u8bc1\u4e66\uff1a\u6240\u6709 <code>kube-apiserver</code> \u5b9e\u4f8b\u548c <code>etcd</code> \u8282\u70b9\u9700\u8981\u4fe1\u4efb\u540c\u4e00\u4e2a CA\u3002</li> <li>API Server \u8bc1\u4e66\uff1a\u5982\u679c\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u53ef\u4ee5\u4e3a\u8d1f\u8f7d\u5747\u8861\u5668\u914d\u7f6e\u4e00\u4e2a\u901a\u914d\u7b26\u8bc1\u4e66\uff0c\u6216\u8005\u4f7f\u7528\u6240\u6709 Master \u8282\u70b9\u7684\u4e3b\u673a\u540d\u4f5c\u4e3a SAN\uff08Subject Alternative Name\uff09\u3002</li> <li>\u81ea\u52a8\u5316\u8bc1\u4e66\u7ba1\u7406\uff1a\u53ef\u4ee5\u4f7f\u7528\u5de5\u5177\uff08\u5982 <code>kubeadm</code> \u6216 <code>cert-manager</code>\uff09\u7b80\u5316\u8bc1\u4e66\u7684\u521b\u5efa\u548c\u7ba1\u7406\u3002</li> </ul> <p>\u8fd9\u4e9b TLS \u8bc1\u4e66\u4e3b\u8981\u7528\u4e8e Kubernetes \u5185\u90e8\u7ec4\u4ef6\u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u7279\u522b\u662f\u4e0e <code>kube-apiserver</code> \u7684\u5b89\u5168\u901a\u4fe1\u3002\u4ee5\u4e0b\u662f\u8fd9\u4e9b\u8bc1\u4e66\u7684\u5177\u4f53\u7528\u9014\u548c\u4f5c\u7528\uff1a</p>"},{"location":"devops/K8s_2.html#1-kubernetes","title":"1. Kubernetes \u5185\u90e8\u7ec4\u4ef6\u4e4b\u95f4\u7684\u5b89\u5168\u901a\u4fe1","text":"<ul> <li> <p><code>kube-apiserver</code> \u4e0e <code>kubelet</code> \u7684\u901a\u4fe1\uff1a</p> </li> <li> <p><code>kube-apiserver</code> \u662f Kubernetes \u96c6\u7fa4\u7684\u63a7\u5236\u4e2d\u5fc3\uff0c\u800c <code>kubelet</code> \u8fd0\u884c\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\uff0c\u8d1f\u8d23\u7ba1\u7406\u8be5\u8282\u70b9\u4e0a\u7684 Pod \u548c\u5bb9\u5668\u3002</p> </li> <li><code>kube-apiserver</code> \u548c <code>kubelet</code> \u4e4b\u95f4\u7684\u901a\u4fe1\u901a\u5e38\u4f7f\u7528 HTTPS \u52a0\u5bc6\uff0c\u4ee5\u786e\u4fdd\u4f20\u8f93\u7684\u6570\u636e\u4e0d\u4f1a\u88ab\u7a83\u542c\u6216\u7be1\u6539\u3002</li> <li>\u8fd9\u79cd\u52a0\u5bc6\u901a\u4fe1\u9700\u8981 <code>kube-apiserver</code> \u548c <code>kubelet</code> \u4e4b\u95f4\u4f7f\u7528 CA \u8bc1\u4e66\u8fdb\u884c\u76f8\u4e92\u8ba4\u8bc1\u3002</li> <li> <p><code>kube-apiserver</code> \u4e0e <code>etcd</code> \u7684\u901a\u4fe1\uff1a</p> </li> <li> <p><code>etcd</code> \u662f Kubernetes \u7684\u5206\u5e03\u5f0f\u952e\u503c\u5b58\u50a8\uff0c\u7528\u4e8e\u5b58\u50a8\u96c6\u7fa4\u7684\u6240\u6709\u72b6\u6001\u4fe1\u606f\u3002<code>kube-apiserver</code> \u9700\u8981\u4e0e <code>etcd</code> \u8fdb\u884c\u52a0\u5bc6\u901a\u4fe1\uff0c\u4ee5\u786e\u4fdd\u5b58\u50a8\u5728 <code>etcd</code> \u4e2d\u7684\u6570\u636e\u7684\u5b89\u5168\u6027\u3002</p> </li> <li><code>kube-apiserver</code> \u4f7f\u7528 TLS \u8bc1\u4e66\u4e0e <code>etcd</code> \u5efa\u7acb\u5b89\u5168\u8fde\u63a5\uff0c\u8fd9\u9700\u8981 <code>etcd</code> \u548c <code>kube-apiserver</code> \u4e4b\u95f4\u4fe1\u4efb\u540c\u4e00\u4e2a CA\u3002</li> <li> <p><code>kube-apiserver</code> \u4e0e <code>kube-controller-manager</code> \u548c <code>kube-scheduler</code> \u7684\u901a\u4fe1\uff1a</p> </li> <li> <p>\u8fd9\u4e9b\u7ec4\u4ef6\u4e5f\u9700\u8981\u901a\u8fc7 HTTPS \u4e0e <code>kube-apiserver</code> \u8fdb\u884c\u901a\u4fe1\uff0c\u4f7f\u7528 TLS \u8bc1\u4e66\u786e\u4fdd\u6570\u636e\u7684\u5b8c\u6574\u6027\u548c\u5b89\u5168\u6027\u3002</p> </li> </ul>"},{"location":"devops/K8s_2.html#2-api","title":"2. \u4fdd\u62a4\u96c6\u7fa4 API \u7684\u8bbf\u95ee","text":"<ul> <li><code>kube-apiserver</code> \u5bf9\u5916\u66b4\u9732\u7684 API\uff1a</li> <li><code>kube-apiserver</code> \u5bf9\u5916\u66b4\u9732\u7684 RESTful API \u662f\u96c6\u7fa4\u4e2d\u6240\u6709\u7ba1\u7406\u64cd\u4f5c\u7684\u5165\u53e3\uff0c\u5305\u62ec <code>kubectl</code> \u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u3002</li> <li>\u901a\u8fc7\u4f7f\u7528 TLS \u8bc1\u4e66\uff0c<code>kube-apiserver</code> \u53ef\u4ee5\u786e\u4fdd\u4e0e <code>kubectl</code> \u7b49\u5ba2\u6237\u7aef\u7684\u901a\u4fe1\u662f\u52a0\u5bc6\u7684\uff0c\u9632\u6b62\u7ba1\u7406\u6307\u4ee4\u88ab\u7a83\u542c\u3002</li> <li>\u5ba2\u6237\u7aef\uff08\u5982 <code>kubectl</code>\uff09\u901a\u5e38\u9700\u8981\u4fe1\u4efb <code>kube-apiserver</code> \u7684 CA \u8bc1\u4e66\uff0c\u4ee5\u9a8c\u8bc1 <code>kube-apiserver</code> \u7684\u8eab\u4efd\u3002</li> </ul>"},{"location":"devops/K8s_2.html#3","title":"3. \u8d1f\u8f7d\u5747\u8861\u5668\u4e0a\u7684\u8bc1\u4e66","text":"<ul> <li>\u8d1f\u8f7d\u5747\u8861\u5668\u4e0a\u7684 TLS \u8bc1\u4e66\uff1a</li> <li>\u5982\u679c\u5728 Kubernetes \u9ad8\u53ef\u7528\u96c6\u7fa4\u4e2d\u914d\u7f6e\u4e86\u8d1f\u8f7d\u5747\u8861\u5668\uff08\u5982 HAProxy \u6216\u4e91\u5e73\u53f0\u7684\u8d1f\u8f7d\u5747\u8861\u5668\uff09\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u4e5f\u53ef\u4ee5\u914d\u7f6e TLS \u8bc1\u4e66\uff0c\u7279\u522b\u662f\u5728\u8d1f\u8f7d\u5747\u8861\u5668\u5bf9\u5916\u66b4\u9732 HTTPS \u63a5\u53e3\u65f6\u3002</li> <li>\u8d1f\u8f7d\u5747\u8861\u5668\u4e0a\u7684\u8bc1\u4e66\u53ef\u4ee5\u7528\u4e8e\u52a0\u5bc6\u4ece\u5916\u90e8\u5230 <code>kube-apiserver</code> \u7684\u901a\u4fe1\uff0c\u786e\u4fdd\u5ba2\u6237\u7aef\u4e0e\u8d1f\u8f7d\u5747\u8861\u5668\u4e4b\u95f4\u7684\u6d41\u91cf\u662f\u52a0\u5bc6\u7684\u3002</li> <li>\u8d1f\u8f7d\u5747\u8861\u5668\u4ece\u5ba2\u6237\u7aef\u63a5\u6536\u5230 HTTPS \u8bf7\u6c42\u540e\uff0c\u53ef\u4ee5\u5c06\u8bf7\u6c42\u89e3\u5bc6\u5e76\u8f6c\u53d1\u7ed9 Kubernetes \u5185\u90e8\u7684 <code>kube-apiserver</code>\u3002</li> </ul>"},{"location":"devops/K8s_2.html#4-tls","title":"4. \u603b\u7ed3\uff1aTLS \u8bc1\u4e66\u7684\u4e3b\u8981\u7528\u9014","text":"<ul> <li> <p>\u5185\u90e8\u901a\u4fe1\uff1a</p> </li> <li> <p><code>kube-apiserver</code> \u548c\u96c6\u7fa4\u5185\u5176\u4ed6\u7ec4\u4ef6\uff08\u5982 <code>kubelet</code>\u3001<code>etcd</code>\u3001<code>controller-manager</code>\uff09\u4e4b\u95f4\u7684\u52a0\u5bc6\u901a\u4fe1\uff0c\u786e\u4fdd\u4f20\u8f93\u6570\u636e\u7684\u5b89\u5168\u6027\u3002</p> </li> <li>\u4f7f\u7528\u76f8\u540c\u7684 CA \u8bc1\u4e66\u4f7f\u5f97\u96c6\u7fa4\u5185\u7684\u8fd9\u4e9b\u7ec4\u4ef6\u80fd\u591f\u76f8\u4e92\u8ba4\u8bc1\u3002</li> <li> <p>\u5bf9\u5916\u66b4\u9732\u7684\u63a5\u53e3\uff1a</p> </li> <li> <p><code>kube-apiserver</code> \u5bf9\u5916\u66b4\u9732 API \u65f6\uff0c\u4f7f\u7528 TLS \u8bc1\u4e66\u786e\u4fdd\u4e0e\u5ba2\u6237\u7aef\uff08\u5982 <code>kubectl</code>\uff09\u7684\u901a\u4fe1\u662f\u5b89\u5168\u7684\u3002</p> </li> <li>\u5982\u679c\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u4e5f\u53ef\u4ee5\u914d\u7f6e\u8bc1\u4e66\uff0c\u7528\u4e8e\u52a0\u5bc6\u8d1f\u8f7d\u5747\u8861\u5668\u4e0e\u5ba2\u6237\u7aef\u4e4b\u95f4\u7684\u901a\u4fe1\u3002</li> </ul> <p>\u56e0\u6b64\uff0c\u8fd9\u4e9b\u8bc1\u4e66\u4e0d\u4ec5\u4ec5\u7528\u4e8e\u96c6\u7fa4\u5185\u90e8\uff0c\u4e5f\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u7528\u4e8e\u5bf9\u5916\u90e8\u5ba2\u6237\u7aef\u7684\u8ba4\u8bc1\u548c\u52a0\u5bc6\u3002\u5c24\u5176\u662f\u5728\u9ad8\u53ef\u7528\u573a\u666f\u4e0b\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u96c6\u7fa4\u7684\u5b89\u5168\u6027\uff0c\u786e\u4fdd Kubernetes \u5185\u90e8\u548c\u5916\u90e8\u7684\u901a\u4fe1\u90fd\u662f\u901a\u8fc7 HTTPS \u52a0\u5bc6\u8fdb\u884c\uff0c\u4ece\u800c\u4fdd\u62a4\u96c6\u7fa4\u4e2d\u7684\u6570\u636e\u4e0d\u88ab\u6cc4\u9732\u548c\u7be1\u6539\u3002</p> <p>\u5728 Kubernetes \u96c6\u7fa4\u5185\u90e8\u901a\u4fe1\u4e2d\uff0c\u81ea\u7b7e\u540d\u7684\u8bc1\u4e66\u5b8c\u5168\u53ef\u4ee5\u6ee1\u8db3\u9700\u6c42\uff0c\u56e0\u6b64\u4f60\u53ef\u4ee5\u5728\u672c\u5730\u81ea\u5df1\u751f\u6210\u8bc1\u4e66\uff0c\u65e0\u9700\u4f9d\u8d56\u5916\u90e8\u7684\u516c\u5171\u8bc1\u4e66\u9881\u53d1\u673a\u6784 (CA)\u3002\u8fd9\u662f\u56e0\u4e3a Kubernetes \u96c6\u7fa4\u7684\u7ec4\u4ef6\uff08\u5982 <code>kube-apiserver</code>\u3001<code>kubelet</code>\u3001<code>etcd</code> \u7b49\uff09\u53ea\u9700\u8981\u5f7c\u6b64\u4e4b\u95f4\u5efa\u7acb\u4fe1\u4efb\u5173\u7cfb\uff0c\u5e76\u4e0d\u9700\u8981\u901a\u8fc7\u5916\u90e8\u4e92\u8054\u7f51\u8bbf\u95ee\u3002</p>"},{"location":"devops/K8s_2.html#_16","title":"\u4e3a\u4ec0\u4e48\u81ea\u7b7e\u540d\u8bc1\u4e66\u5c31\u8db3\u591f\uff1f","text":"<ol> <li> <p>\u5185\u90e8\u7f51\u7edc\u901a\u4fe1\uff1a</p> </li> <li> <p>Kubernetes \u96c6\u7fa4\u4e2d\u7684\u5927\u591a\u6570\u901a\u4fe1\u90fd\u662f\u5728\u5185\u90e8\u7f51\u7edc\u4e2d\u8fdb\u884c\u7684\uff0c\u6bd4\u5982 <code>kube-apiserver</code> \u548c <code>kubelet</code>\u3001<code>kube-apiserver</code> \u548c <code>etcd</code> \u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u8fd9\u4e9b\u90fd\u662f\u5185\u90e8\u7684 HTTPS \u8bf7\u6c42\u3002</p> </li> <li>\u53ea\u8981\u5728\u8fd9\u4e9b\u7ec4\u4ef6\u4e4b\u95f4\u5efa\u7acb\u4e86\u4fe1\u4efb\u5173\u7cfb\uff08\u4f8b\u5982\uff0c\u901a\u8fc7\u4f7f\u7528\u540c\u4e00\u4e2a\u81ea\u7b7e\u540d CA\uff09\uff0c\u5c31\u80fd\u4fdd\u8bc1\u6570\u636e\u4f20\u8f93\u7684\u5b89\u5168\u6027\u3002</li> <li> <p>\u63a7\u5236\u4fe1\u4efb\u94fe\uff1a</p> </li> <li> <p>\u4f7f\u7528\u81ea\u7b7e\u540d CA \u751f\u6210\u8bc1\u4e66\uff0c\u4f60\u53ef\u4ee5\u5b8c\u5168\u63a7\u5236\u8bc1\u4e66\u7684\u751f\u6210\u548c\u7ba1\u7406\u6d41\u7a0b\u3002\u8fd9\u610f\u5473\u7740\u4f60\u53ef\u4ee5\u6309\u7167\u81ea\u5df1\u7684\u9700\u6c42\u751f\u6210 CA \u548c\u7ec4\u4ef6\u7684\u8bc1\u4e66\uff0c\u6307\u5b9a\u6709\u6548\u671f\u548c\u4fe1\u4efb\u5173\u7cfb\uff0c\u7075\u6d3b\u6027\u66f4\u9ad8\u3002</p> </li> <li>\u5c06\u81ea\u7b7e\u540d CA \u7684\u6839\u8bc1\u4e66 (<code>ca.crt</code>) \u5206\u53d1\u7ed9 <code>kube-apiserver</code>\u3001<code>kubelet</code> \u548c <code>etcd</code>\uff0c\u8ba9\u8fd9\u4e9b\u7ec4\u4ef6\u4fe1\u4efb\u81ea\u7b7e\u540d\u7684 CA \u8bc1\u4e66\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u96c6\u7fa4\u5185\u90e8\u5efa\u7acb\u4e00\u4e2a\u81ea\u5305\u542b\u7684\u4fe1\u4efb\u94fe\u3002</li> <li> <p>\u4e0d\u4f9d\u8d56\u5916\u90e8\u7f51\u7edc\uff1a</p> </li> <li> <p>\u7531\u4e8e\u81ea\u7b7e\u540d\u8bc1\u4e66\u5728\u672c\u5730\u751f\u6210\uff0c\u4e0d\u9700\u8981\u4f9d\u8d56\u5916\u90e8\u7684\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff0c\u5c24\u5176\u9002\u5408\u4e8e\u79c1\u6709\u4e91\u6216\u5185\u90e8\u90e8\u7f72\u7684 Kubernetes \u96c6\u7fa4\u3002</p> </li> <li>\u5728\u5185\u90e8\u73af\u5883\u4e2d\uff0c\u4f7f\u7528\u672c\u5730\u751f\u6210\u7684\u8bc1\u4e66\u8fd8\u80fd\u907f\u514d\u5728\u66f4\u65b0\u6216\u7eed\u671f\u8bc1\u4e66\u65f6\uff0c\u53d7\u5230\u5916\u90e8\u7f51\u7edc\u56e0\u7d20\u7684\u5f71\u54cd\u3002</li> </ol>"},{"location":"devops/K8s_2.html#ca","title":"\u4ec0\u4e48\u65f6\u5019\u9700\u8981\u5916\u90e8 CA\uff1f","text":"<p>\u867d\u7136\u81ea\u7b7e\u540d\u8bc1\u4e66\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u5df2\u7ecf\u8db3\u591f\uff0c\u4f46\u5728\u4ee5\u4e0b\u573a\u666f\u4e2d\uff0c\u53ef\u80fd\u9700\u8981\u8003\u8651\u4f7f\u7528\u5916\u90e8 CA \u7b7e\u53d1\u7684\u8bc1\u4e66\uff1a</p> <ol> <li> <p>\u4ece\u5916\u90e8\u8bbf\u95ee\u65f6\u9700\u8981\u516c\u4fe1\u529b\uff1a</p> </li> <li> <p>\u5982\u679c\u4f60\u7684 Kubernetes API \u9700\u8981\u66b4\u9732\u5728\u4e92\u8054\u7f51\u4e0a\uff0c\u5e76\u4e14\u9700\u8981\u5916\u90e8\u7528\u6237\u6216\u7cfb\u7edf\u901a\u8fc7 HTTPS \u8bbf\u95ee\uff0c\u90a3\u4e48\u4f7f\u7528\u516c\u5171 CA \u7b7e\u53d1\u7684\u8bc1\u4e66\u53ef\u4ee5\u907f\u514d\u6d4f\u89c8\u5668\u548c\u5176\u4ed6\u5ba2\u6237\u7aef\u51fa\u73b0\u201c\u4e0d\u53d7\u4fe1\u4efb\u7684\u8bc1\u4e66\u201d\u8b66\u544a\u3002</p> </li> <li>\u4f8b\u5982\uff0c\u4f60\u53ef\u80fd\u4f1a\u901a\u8fc7 HTTPS \u66b4\u9732 Kubernetes \u7684 API Server \u4ee5\u4fbf\u5728\u8fdc\u7a0b\u7ba1\u7406\u96c6\u7fa4\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528\u5916\u90e8 CA \u8bc1\u4e66\u53ef\u4ee5\u63d0\u4f9b\u66f4\u597d\u7684\u7528\u6237\u4f53\u9a8c\u3002</li> <li> <p>\u4f01\u4e1a\u5185\u90e8\u7edf\u4e00\u7684\u8bc1\u4e66\u7b56\u7565\uff1a</p> </li> <li> <p>\u5728\u67d0\u4e9b\u4f01\u4e1a\u4e2d\uff0c\u53ef\u80fd\u6709\u5185\u90e8\u7684 IT \u653f\u7b56\uff0c\u8981\u6c42\u6240\u6709\u7684\u670d\u52a1\u90fd\u4f7f\u7528\u7531\u4f01\u4e1a\u5185\u90e8 CA\uff08\u5982 Active Directory Certificate Services\uff09\u6216\u5176\u4ed6\u53d7\u4fe1\u4efb\u7684\u8bc1\u4e66\u7ba1\u7406\u7cfb\u7edf\u9881\u53d1\u7684\u8bc1\u4e66\u3002</p> </li> <li>\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528\u4f01\u4e1a\u5185\u90e8\u7684 CA \u6765\u7b7e\u53d1 Kubernetes \u96c6\u7fa4\u6240\u9700\u7684\u8bc1\u4e66\uff0c\u7b26\u5408\u4f01\u4e1a\u7684\u5408\u89c4\u8981\u6c42\u3002</li> </ol>"},{"location":"devops/K8s_2.html#_17","title":"\u672c\u5730\u751f\u6210\u8bc1\u4e66\u7684\u65b9\u6cd5","text":"<p>\u5982\u679c\u4f60\u51b3\u5b9a\u4f7f\u7528\u81ea\u7b7e\u540d\u8bc1\u4e66\uff0c\u672c\u5730\u751f\u6210\u8bc1\u4e66\u7684\u6b65\u9aa4\u901a\u5e38\u5305\u62ec\uff1a</p> <ol> <li>\u751f\u6210\u81ea\u7b7e\u540d CA\uff1a</li> <li>\u4f7f\u7528 <code>openssl</code> \u6216 <code>cfssl</code> \u751f\u6210 CA \u8bc1\u4e66\uff0c\u7528\u4e8e\u7b7e\u53d1\u5176\u4ed6\u7ec4\u4ef6\u7684\u8bc1\u4e66\u3002</li> <li>\u751f\u6210\u7ec4\u4ef6\u7684\u8bc1\u4e66\uff1a</li> <li>\u4f7f\u7528\u81ea\u7b7e\u540d\u7684 CA\uff0c\u751f\u6210 <code>kube-apiserver</code>\u3001<code>etcd</code> \u7b49\u7ec4\u4ef6\u7684\u8bc1\u4e66\u3002</li> <li>\u5206\u53d1 CA \u8bc1\u4e66\uff1a</li> <li>\u5c06 CA \u8bc1\u4e66\u5206\u53d1\u5230\u5404\u4e2a\u8282\u70b9\uff0c\u5e76\u914d\u7f6e\u5404\u4e2a\u7ec4\u4ef6\u4fe1\u4efb\u8be5 CA\u3002</li> <li>\u914d\u7f6e Kubernetes \u7ec4\u4ef6\u4f7f\u7528\u8bc1\u4e66\uff1a</li> <li>\u5728\u6bcf\u4e2a\u7ec4\u4ef6\u7684\u542f\u52a8\u914d\u7f6e\u4e2d\uff0c\u6307\u5b9a\u5b83\u4eec\u4f7f\u7528\u7684\u8bc1\u4e66\u548c CA\u3002</li> </ol> <p>\u4f8b\u5982\uff0c\u751f\u6210 CA \u548c\u81ea\u7b7e\u540d\u8bc1\u4e66\u7684\u5e38\u7528 <code>openssl</code> \u547d\u4ee4\uff1a</p> <p>```bash</p>"},{"location":"devops/K8s_2.html#ca-ca","title":"\u751f\u6210 CA \u79c1\u94a5\u548c CA \u8bc1\u4e66","text":"<p>openssl genrsa -out ca.key 2048 openssl req -x509 -new -nodes -key ca.key -subj \"/CN=kubernetes-ca\" -days 10000 -out ca.crt</p>"},{"location":"devops/K8s_2.html#kube-apiserver","title":"\u4e3a kube-apiserver \u751f\u6210\u79c1\u94a5\u548c\u8bc1\u4e66\u8bf7\u6c42","text":"<p>openssl genrsa -out kube-apiserver.key 2048 openssl req -new -key kube-apiserver.key -subj \"/CN=kube-apiserver\" -out kube-apiserver.csr</p>"},{"location":"devops/K8s_2.html#ca-kube-apiserver","title":"\u4f7f\u7528 CA \u7b7e\u53d1 kube-apiserver \u7684\u8bc1\u4e66","text":"<p>openssl x509 -req -in kube-apiserver.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out kube-apiserver.crt -days 10000 ```</p> <p>\u5c06\u751f\u6210\u7684 <code>ca.crt</code>\u3001<code>kube-apiserver.crt</code> \u548c <code>kube-apiserver.key</code> \u90e8\u7f72\u5230 Kubernetes \u7ec4\u4ef6\u7684\u76f8\u5e94\u4f4d\u7f6e\uff0c\u5e76\u5728\u7ec4\u4ef6\u542f\u52a8\u65f6\u6307\u5b9a\u8fd9\u4e9b\u6587\u4ef6\u3002</p>"},{"location":"devops/K8s_2.html#_18","title":"\u603b\u7ed3","text":"<ul> <li>\u81ea\u7b7e\u540d\u8bc1\u4e66 \u5728 Kubernetes \u96c6\u7fa4\u4e2d\u5e7f\u6cdb\u4f7f\u7528\uff0c\u5c24\u5176\u662f\u5728\u5185\u90e8\u7f51\u7edc\u4e2d\uff0c\u56e0\u4e3a\u5b83\u8db3\u591f\u6ee1\u8db3\u5185\u90e8\u901a\u4fe1\u7684\u52a0\u5bc6\u9700\u6c42\uff0c\u5e76\u4e14\u53ef\u4ee5\u5b8c\u5168\u63a7\u5236\u8bc1\u4e66\u7684\u9881\u53d1\u548c\u7ba1\u7406\u3002</li> <li>\u516c\u5171 CA \u53ea\u6709\u5728\u5916\u90e8\u8bbf\u95ee\u9700\u8981\u516c\u4fe1\u529b\u6216\u7b26\u5408\u4f01\u4e1a\u5408\u89c4\u8981\u6c42\u65f6\u624d\u9700\u8981\u3002</li> <li>\u672c\u5730\u751f\u6210\u81ea\u7b7e\u540d\u8bc1\u4e66\u7684\u6d41\u7a0b\u8f83\u4e3a\u7b80\u5355\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>openssl</code> \u6216 <code>cfssl</code> \u7b49\u5de5\u5177\u6765\u5b8c\u6210\u3002</li> </ul> <p>\u4f7f\u7528\u81ea\u7b7e\u540d\u8bc1\u4e66\u53ef\u4ee5\u51cf\u5c11\u5bf9\u5916\u90e8\u670d\u52a1\u7684\u4f9d\u8d56\uff0c\u5e76\u5728\u914d\u7f6e\u6b63\u786e\u7684\u60c5\u51b5\u4e0b\uff0c\u63d0\u4f9b\u548c\u516c\u5171 CA \u7c7b\u4f3c\u7684\u52a0\u5bc6\u901a\u4fe1\u5b89\u5168\u3002\u5e0c\u671b\u8fd9\u4e9b\u89e3\u91ca\u80fd\u5e2e\u52a9\u4f60\u66f4\u597d\u5730\u7406\u89e3 Kubernetes \u7684\u8bc1\u4e66\u7ba1\u7406\uff01\u5982\u679c\u6709\u5176\u4ed6\u95ee\u9898\uff0c\u968f\u65f6\u63d0\u95ee\uff01</p> <p>\u5728\u914d\u7f6e Kubernetes \u591a Master \u8282\u70b9\u7684\u9ad8\u53ef\u7528\u73af\u5883\u65f6\uff0cTLS \u8bc1\u4e66\u7684\u6b63\u786e\u914d\u7f6e\u662f\u81f3\u5173\u91cd\u8981\u7684\u3002<code>kube-apiserver</code> \u548c\u5176\u4ed6\u7ec4\u4ef6\uff08\u5982 <code>kubelet</code>\u3001<code>etcd</code>\uff09\u4e4b\u95f4\u7684\u901a\u4fe1\u901a\u5e38\u901a\u8fc7 HTTPS \u8fdb\u884c\uff0c\u56e0\u6b64\u9700\u8981\u786e\u4fdd\u6240\u6709 Master \u8282\u70b9\u4e0a\u7684\u8bc1\u4e66\u4e00\u81f4\uff0c\u4e14\u4fe1\u4efb\u540c\u4e00\u4e2a CA\uff08Certificate Authority\uff09\u3002\u4ee5\u4e0b\u662f\u914d\u7f6e TLS \u8bc1\u4e66\u7684\u4e00\u822c\u6b65\u9aa4\uff0c\u5305\u62ec\u624b\u52a8\u751f\u6210\u8bc1\u4e66\u3001\u81ea\u52a8\u5316\u5de5\u5177\u7684\u4f7f\u7528\u4ee5\u53ca\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u8bc1\u4e66\u914d\u7f6e\u3002</p>"},{"location":"devops/K8s_2.html#1-tls","title":"1. \u624b\u52a8\u751f\u6210\u548c\u914d\u7f6e TLS \u8bc1\u4e66","text":"<p>\u5982\u679c\u9009\u62e9\u624b\u52a8\u7ba1\u7406 TLS \u8bc1\u4e66\uff0c\u901a\u5e38\u9700\u8981\u751f\u6210 CA \u8bc1\u4e66\u3001<code>kube-apiserver</code> \u8bc1\u4e66\u548c <code>etcd</code> \u8bc1\u4e66\u3002\u53ef\u4ee5\u4f7f\u7528 <code>openssl</code> \u6216 <code>cfssl</code> \u6765\u751f\u6210\u8fd9\u4e9b\u8bc1\u4e66\u3002</p>"},{"location":"devops/K8s_2.html#1-ca","title":"\u6b65\u9aa4 1\uff1a\u751f\u6210 CA \u8bc1\u4e66","text":"<p>\u9996\u5148\uff0c\u751f\u6210 CA \u7684\u79c1\u94a5\u548c\u8bc1\u4e66\u3002\u8fd9\u4e2a CA \u5c06\u7528\u4e8e\u7b7e\u53d1 <code>kube-apiserver</code> \u548c\u5176\u4ed6\u7ec4\u4ef6\u7684\u8bc1\u4e66\u3002</p> <p><code>bash openssl genrsa -out ca.key 2048 openssl req -x509 -new -nodes -key ca.key -subj \"/CN=kubernetes-ca\" -days 10000 -out ca.crt</code></p> <ul> <li><code>ca.key</code> \u662f CA \u7684\u79c1\u94a5\u3002</li> <li><code>ca.crt</code> \u662f CA \u7684\u8bc1\u4e66\u3002</li> </ul>"},{"location":"devops/K8s_2.html#2-api-server-csr","title":"\u6b65\u9aa4 2\uff1a\u751f\u6210 API Server \u7684\u79c1\u94a5\u548c\u8bc1\u4e66\u8bf7\u6c42\uff08CSR\uff09","text":"<p>\u4e3a <code>kube-apiserver</code> \u751f\u6210\u79c1\u94a5\u548c CSR\uff08Certificate Signing Request\uff09\u3002</p> <p><code>bash openssl genrsa -out kube-apiserver.key 2048 openssl req -new -key kube-apiserver.key -subj \"/CN=kube-apiserver\" -out kube-apiserver.csr \\     -config &lt;(cat &lt;&lt;EOF [req] distinguished_name = req_distinguished_name [req_distinguished_name] [ v3_ext ] subjectAltName = @alt_names [alt_names] DNS.1 = kube-apiserver DNS.2 = kube-apiserver.kube-system.svc DNS.3 = kube-apiserver.kube-system.svc.cluster.local DNS.4 = &lt;your-load-balancer-domain&gt; IP.1 = 127.0.0.1 IP.2 = &lt;your-load-balancer-ip&gt; EOF )</code></p> <ul> <li><code>kube-apiserver.key</code> \u662f <code>kube-apiserver</code> \u7684\u79c1\u94a5\u3002</li> <li><code>kube-apiserver.csr</code> \u662f <code>kube-apiserver</code> \u7684 CSR \u6587\u4ef6\u3002</li> <li>\u5728 <code>subjectAltName</code> \u4e2d\u9700\u8981\u5305\u542b <code>kube-apiserver</code> \u7684 DNS \u540d\u79f0\u548c IP \u5730\u5740\uff0c\u4ee5\u53ca\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u57df\u540d\u6216 IP \u5730\u5740\u3002</li> </ul>"},{"location":"devops/K8s_2.html#3-ca-kube-apiserver","title":"\u6b65\u9aa4 3\uff1a\u4f7f\u7528 CA \u7b7e\u53d1 <code>kube-apiserver</code> \u8bc1\u4e66","text":"<p>\u4f7f\u7528 CA \u8bc1\u4e66\u5bf9 <code>kube-apiserver.csr</code> \u8fdb\u884c\u7b7e\u540d\uff0c\u751f\u6210 <code>kube-apiserver</code> \u7684\u8bc1\u4e66\u3002</p> <p><code>bash openssl x509 -req -in kube-apiserver.csr -CA ca.crt -CAkey ca.key -CAcreateserial \\     -out kube-apiserver.crt -days 10000 -extensions v3_ext -extfile &lt;(cat &lt;&lt;EOF [ v3_ext ] subjectAltName = @alt_names [alt_names] DNS.1 = kube-apiserver DNS.2 = kube-apiserver.kube-system.svc DNS.3 = kube-apiserver.kube-system.svc.cluster.local DNS.4 = &lt;your-load-balancer-domain&gt; IP.1 = 127.0.0.1 IP.2 = &lt;your-load-balancer-ip&gt; EOF )</code></p> <ul> <li><code>kube-apiserver.crt</code> \u662f\u7b7e\u540d\u540e\u7684 <code>kube-apiserver</code> \u8bc1\u4e66\u3002</li> </ul>"},{"location":"devops/K8s_2.html#4-master","title":"\u6b65\u9aa4 4\uff1a\u5c06\u8bc1\u4e66\u5206\u53d1\u5230\u6bcf\u4e2a Master \u8282\u70b9","text":"<p>\u5c06\u751f\u6210\u7684\u4ee5\u4e0b\u6587\u4ef6\u5206\u53d1\u5230\u6bcf\u4e2a Master \u8282\u70b9\uff1a</p> <ul> <li><code>ca.crt</code></li> <li><code>kube-apiserver.crt</code></li> <li><code>kube-apiserver.key</code></li> </ul> <p>\u786e\u4fdd\u6bcf\u4e2a Master \u8282\u70b9\u7684 <code>kube-apiserver</code> \u4f7f\u7528\u76f8\u540c\u7684\u8bc1\u4e66\u6587\u4ef6\u3002</p>"},{"location":"devops/K8s_2.html#5-kube-apiserver","title":"\u6b65\u9aa4 5\uff1a\u914d\u7f6e <code>kube-apiserver</code> \u4f7f\u7528\u8bc1\u4e66","text":"<p>\u5728\u6bcf\u4e2a Master \u8282\u70b9\u7684 <code>kube-apiserver</code> \u542f\u52a8\u53c2\u6570\u4e2d\uff0c\u6307\u5b9a\u8bc1\u4e66\u548c\u5bc6\u94a5\u8def\u5f84\uff1a</p> <p><code>bash kube-apiserver \\   --advertise-address=&lt;master-ip&gt; \\   --tls-cert-file=/path/to/kube-apiserver.crt \\   --tls-private-key-file=/path/to/kube-apiserver.key \\   --client-ca-file=/path/to/ca.crt \\   ...</code></p>"},{"location":"devops/K8s_2.html#2-kubeadm","title":"2. \u4f7f\u7528 <code>kubeadm</code> \u751f\u6210\u8bc1\u4e66","text":"<p>\u5982\u679c\u4f7f\u7528 <code>kubeadm</code> \u521d\u59cb\u5316\u96c6\u7fa4\uff0c\u53ef\u4ee5\u7b80\u5316\u8bc1\u4e66\u7684\u751f\u6210\u8fc7\u7a0b\u3002<code>kubeadm</code> \u53ef\u4ee5\u81ea\u52a8\u751f\u6210\u5e76\u7ba1\u7406 Kubernetes \u6240\u9700\u7684\u8bc1\u4e66\uff0c\u5e76\u4e14\u80fd\u591f\u4fdd\u8bc1\u6240\u6709\u8282\u70b9\u4e0a\u7684\u8bc1\u4e66\u4e00\u81f4\u3002</p> <ul> <li>\u5728\u4f7f\u7528 <code>kubeadm</code> \u521d\u59cb\u5316\u7b2c\u4e00\u4e2a Master \u8282\u70b9\u65f6\uff0c\u8bc1\u4e66\u4f1a\u81ea\u52a8\u751f\u6210\u5e76\u5b58\u50a8\u5728 <code>/etc/kubernetes/pki/</code> \u76ee\u5f55\u4e0b\u3002</li> <li>\u5728\u521d\u59cb\u5316\u5176\u4ed6 Master \u8282\u70b9\u65f6\uff0c\u53ef\u4ee5\u5c06\u7b2c\u4e00\u4e2a\u8282\u70b9\u4e0a\u7684 <code>pki</code> \u6587\u4ef6\u5939\u590d\u5236\u5230\u5176\u4ed6 Master \u8282\u70b9\u4e0a\uff0c\u4ee5\u786e\u4fdd\u6240\u6709\u8282\u70b9\u5171\u4eab\u76f8\u540c\u7684\u8bc1\u4e66\u3002</li> </ul> <p>```bash</p>"},{"location":"devops/K8s_2.html#master1","title":"\u5728 master1 \u4e0a","text":"<p>scp -r /etc/kubernetes/pki user@master2:/etc/kubernetes/ scp -r /etc/kubernetes/pki user@master3:/etc/kubernetes/ ```</p> <p>\u7136\u540e\u4f7f\u7528 <code>kubeadm join</code> \u547d\u4ee4\u5728\u5176\u4ed6 Master \u8282\u70b9\u4e0a\u52a0\u5165\u96c6\u7fa4\u5373\u53ef\u3002</p>"},{"location":"devops/K8s_2.html#3-cert-manager","title":"3. \u81ea\u52a8\u5316\u8bc1\u4e66\u7ba1\u7406 - \u4f7f\u7528 <code>cert-manager</code>","text":"<p>\u5982\u679c\u9700\u8981\u81ea\u52a8\u5316\u8bc1\u4e66\u7684\u7ba1\u7406\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>cert-manager</code> \u8fd9\u4e2a Kubernetes \u5185\u90e8\u7684\u8bc1\u4e66\u7ba1\u7406\u5de5\u5177\u3002</p> <p><code>cert-manager</code> \u53ef\u4ee5\u81ea\u52a8\u751f\u6210\u548c\u7ba1\u7406 Kubernetes \u96c6\u7fa4\u5185\u90e8\u7684\u8bc1\u4e66\uff0c\u5e76\u652f\u6301\u591a\u79cd\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08\u5982 Let's Encrypt\u3001\u5185\u90e8 CA\uff09\u3002</p>"},{"location":"devops/K8s_2.html#cert-manager","title":"\u5b89\u88c5 <code>cert-manager</code>","text":"<ol> <li>\u5b89\u88c5 <code>cert-manager</code>\uff1a</li> </ol> <p><code>bash    kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.11.0/cert-manager.yaml</code> 2. \u521b\u5efa\u4e00\u4e2a <code>ClusterIssuer</code> \u5bf9\u8c61\uff0c\u4f7f\u7528 <code>cert-manager</code> \u9881\u53d1 CA \u7b7e\u53d1\u7684\u8bc1\u4e66\u3002</p> <p>\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a <code>ca-issuer.yaml</code> \u7684\u6587\u4ef6\uff1a</p> <p><code>yaml    apiVersion: cert-manager.io/v1    kind: ClusterIssuer    metadata:      name: ca-issuer    spec:      ca:        secretName: ca-secret</code> 3. \u521b\u5efa CA \u79d8\u94a5\u5e76\u5b58\u50a8\u4e3a Kubernetes Secret\uff1a</p> <p><code>bash    kubectl create secret tls ca-secret --cert=ca.crt --key=ca.key -n cert-manager</code> 4. \u521b\u5efa <code>Certificate</code> \u5bf9\u8c61\u6765\u81ea\u52a8\u9881\u53d1\u8bc1\u4e66\uff1a</p> <p><code>yaml    apiVersion: cert-manager.io/v1    kind: Certificate    metadata:      name: kube-apiserver-cert      namespace: kube-system    spec:      secretName: kube-apiserver-tls      issuerRef:        name: ca-issuer        kind: ClusterIssuer      commonName: kube-apiserver      dnsNames:      - kube-apiserver      - &lt;your-load-balancer-domain&gt;      ipAddresses:      - &lt;your-load-balancer-ip&gt;      - 127.0.0.1</code> 5. <code>cert-manager</code> \u4f1a\u81ea\u52a8\u751f\u6210\u548c\u66f4\u65b0 <code>kube-apiserver</code> \u6240\u9700\u7684\u8bc1\u4e66\uff0c\u5e76\u5c06\u5176\u5b58\u50a8\u5728 <code>kube-system</code> \u547d\u540d\u7a7a\u95f4\u4e2d\u7684 <code>kube-apiserver-tls</code> Secret \u4e2d\u3002</p>"},{"location":"devops/K8s_2.html#4","title":"4. \u4e3a\u8d1f\u8f7d\u5747\u8861\u5668\u914d\u7f6e\u901a\u914d\u7b26\u8bc1\u4e66","text":"<p>\u5982\u679c\u4f60\u4f7f\u7528\u7684\u662f HTTPS \u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u53ef\u4ee5\u4e3a\u8d1f\u8f7d\u5747\u8861\u5668\u914d\u7f6e\u4e00\u4e2a\u901a\u914d\u7b26\u8bc1\u4e66\uff0c\u786e\u4fdd\u8d1f\u8f7d\u5747\u8861\u5668\u548c <code>kube-apiserver</code> \u4e4b\u95f4\u7684\u901a\u4fe1\u662f\u52a0\u5bc6\u7684\u3002</p> <ul> <li>\u53ef\u4ee5\u4f7f\u7528 Let's Encrypt \u6216 \u5546\u4e1a CA \u6765\u7b7e\u53d1\u901a\u914d\u7b26\u8bc1\u4e66\u3002</li> <li>\u5c06\u751f\u6210\u7684\u8bc1\u4e66\u548c\u5bc6\u94a5\u4e0a\u4f20\u5230\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u5e76\u914d\u7f6e\u8d1f\u8f7d\u5747\u8861\u5668\u76d1\u542c HTTPS \u8bf7\u6c42\u3002</li> </ul>"},{"location":"devops/K8s_2.html#nginx-haproxy-ssl","title":"Nginx \u6216 HAProxy \u7684 SSL \u914d\u7f6e\u793a\u4f8b\uff08\u7b80\u5316\uff09","text":"<p>\u5bf9\u4e8e HAProxy\uff0c\u53ef\u4ee5\u5728\u914d\u7f6e\u4e2d\u6dfb\u52a0\u8bc1\u4e66\u8def\u5f84\u6765\u542f\u7528 HTTPS\uff1a</p> <p><code>haproxy frontend kubernetes-api     bind *:6443 ssl crt /etc/ssl/certs/kubernetes.pem     mode tcp     default_backend kubernetes-api-backend</code></p> <p><code>/etc/ssl/certs/kubernetes.pem</code> \u662f\u5305\u542b\u4e86 <code>kube-apiserver</code> \u8bc1\u4e66\u3001\u5bc6\u94a5\u548c CA \u7684 PEM \u683c\u5f0f\u6587\u4ef6\u3002</p>"},{"location":"devops/K8s_2.html#_19","title":"\u603b\u7ed3","text":"<ol> <li>\u624b\u52a8\u914d\u7f6e\u8bc1\u4e66\uff1a\u9002\u5408\u5bf9\u8bc1\u4e66\u7ba1\u7406\u6709\u7279\u6b8a\u9700\u6c42\u7684\u73af\u5883\uff0c\u9700\u8981\u624b\u52a8\u751f\u6210 CA \u548c <code>kube-apiserver</code> \u8bc1\u4e66\uff0c\u5e76\u786e\u4fdd\u6240\u6709 Master \u8282\u70b9\u4f7f\u7528\u76f8\u540c\u7684\u8bc1\u4e66\u3002</li> <li>\u4f7f\u7528 <code>kubeadm</code>\uff1a\u7b80\u5316\u8bc1\u4e66\u7ba1\u7406\uff0c\u9002\u5408\u4f7f\u7528 <code>kubeadm</code> \u521d\u59cb\u5316\u548c\u6269\u5c55 Kubernetes \u96c6\u7fa4\u7684\u573a\u666f\u3002</li> <li>\u4f7f\u7528 <code>cert-manager</code>\uff1a\u81ea\u52a8\u5316\u8bc1\u4e66\u7ba1\u7406\uff0c\u9002\u5408\u5e0c\u671b\u5728 Kubernetes \u5185\u90e8\u7ba1\u7406\u8bc1\u4e66\u5e76\u81ea\u52a8\u66f4\u65b0\u7684\u573a\u666f\u3002</li> <li>**\u8d1f\u8f7d\u5747\u8861\u5668</li> </ol>"},{"location":"devops/K8s_2.html#526","title":"5.2.6 \u5907\u4efd\u4e0e\u8fd8\u539f","text":"<p>\u8fd9\u4e2a\u8fc7\u7a0b\u5e76\u4e0d\u4f1a\u81ea\u52a8\u5907\u4efd\u5176\u4ed6\u5982\u8282\u70b9\u4e0a\u7684\u5bb9\u5668\u6570\u636e\uff08\u5982\u5e94\u7528\u7a0b\u5e8f\u672c\u8eab\u7684\u6570\u636e\uff09\uff0c\u5b83\u53ea\u662f\u7528\u6765\u4fdd\u969c Kubernetes \u96c6\u7fa4\u914d\u7f6e\u548c\u72b6\u6001\u4fe1\u606f\u7684\u6062\u590d\u3002\u5982\u679c\u4f60\u9700\u8981\u66f4\u5168\u9762\u7684\u6570\u636e\u4fdd\u62a4\uff0c\u8fd8\u9700\u8981\u4e3a\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\u7684\u5e94\u7528\u7a0b\u5e8f\u548c\u5b58\u50a8\u5377\u8bbe\u7f6e\u76f8\u5e94\u7684\u6570\u636e\u5907\u4efd\u7b56\u7565\u3002</p> <p>\u5728 Kubernetes \u4e2d\uff0c<code>etcd</code> \u5b58\u50a8\u4e86\u6240\u6709 API \u5bf9\u8c61\u7684\u6570\u636e\uff0c\u5305\u62ec\u8282\u70b9\u4fe1\u606f\u3001Pod\u3001ConfigMap\u3001Secrets \u7b49\u3002\u7531\u4e8e <code>etcd</code> \u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027\u4f9d\u8d56\u4e8e\u5206\u5e03\u5f0f\u6570\u636e\u5b58\u50a8\uff0c\u4f46\u4efb\u4f55\u914d\u7f6e\u9519\u8bef\u3001\u786c\u4ef6\u6545\u969c\u6216\u8005\u4eba\u4e3a\u64cd\u4f5c\u5931\u8bef\u7b49\u90fd\u53ef\u80fd\u5bfc\u81f4\u6570\u636e\u4e22\u5931\u6216\u635f\u574f\u3002\u56e0\u6b64\uff0c\u5373\u4fbf <code>etcd</code> \u81ea\u8eab\u5177\u5907\u9ad8\u53ef\u7528\u7279\u6027\uff0c\u5b9a\u671f\u5907\u4efd\u548c\u8fd8\u539f <code>etcd</code> \u6570\u636e \u4ecd\u7136\u662f\u975e\u5e38\u91cd\u8981\u7684\uff0c\u8fd9\u662f\u786e\u4fdd\u96c6\u7fa4\u5728\u6545\u969c\u540e\u53ef\u4ee5\u6062\u590d\u5230\u6b63\u5e38\u72b6\u6001\u7684\u5173\u952e\u6b65\u9aa4\u3002</p> <p>\u603b\u7ed3\u6765\u8bf4\uff0c\u8fd9\u4e2a\u5907\u4efd\u548c\u8fd8\u539f\u8fc7\u7a0b\u4e13\u6ce8\u4e8e\uff1a</p> <ol> <li>\u5907\u4efd etcd \u6570\u636e \uff1a\u521b\u5efa <code>etcd</code> \u7684\u5feb\u7167\uff0c\u4ee5\u786e\u4fdd Kubernetes \u96c6\u7fa4\u72b6\u6001\u80fd\u591f\u5728\u9700\u8981\u65f6\u6062\u590d\u3002</li> <li>\u8fd8\u539f etcd \u6570\u636e \uff1a\u5728\u96c6\u7fa4\u53d1\u751f\u91cd\u5927\u6545\u969c\u65f6\uff0c\u4ece\u5feb\u7167\u4e2d\u6062\u590d <code>etcd</code>\uff0c\u4ee5\u786e\u4fdd Kubernetes \u96c6\u7fa4\u80fd\u591f\u6b63\u5e38\u6062\u590d\u8fd0\u884c\u3002</li> </ol>"},{"location":"devops/K8s_2.html#1-etcdctl","title":"1. \u5b89\u88c5 etcdctl \u5de5\u5177","text":"<p><code>etcdctl</code> \u5de5\u5177\u662f <code>etcd</code> \u7684\u547d\u4ee4\u884c\u5ba2\u6237\u7aef\uff0c\u7528\u4e8e\u7ba1\u7406\u548c\u5907\u4efd\u7b49\u64cd\u4f5c\u3002\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u5b89\u88c5 <code>etcdctl</code>\uff1a</p> <p>```bash</p>"},{"location":"devops/K8s_2.html#etcdctl","title":"\u5b89\u88c5 etcdctl","text":"<p>apt-get install etcd-client  # Ubuntu yum install etcd -y          # CentOS ```</p> <p>\u6216\u8005\u901a\u8fc7\u4e8c\u8fdb\u5236\u65b9\u5f0f\u76f4\u63a5\u4e0b\u8f7d <code>etcd</code>\uff0c\u89e3\u538b\u7f29\u540e\uff0c<code>etcdctl</code> \u901a\u5e38\u4e0e <code>etcd</code> \u653e\u5728\u540c\u4e00\u4e2a\u76ee\u5f55\u4e2d\u3002</p>"},{"location":"devops/K8s_2.html#2-etcd_1","title":"2. \u5907\u4efd etcd \u6570\u636e","text":"<p><code>etcdctl</code> \u5de5\u5177\u53ef\u4ee5\u7528\u6765\u521b\u5efa\u96c6\u7fa4\u72b6\u6001\u7684\u5feb\u7167\u5907\u4efd\uff0c\u4ee5\u4e0b\u662f\u5177\u4f53\u7684\u5907\u4efd\u547d\u4ee4\uff1a</p> <p>```bash</p>"},{"location":"devops/K8s_2.html#etcdctl-etcd","title":"\u4f7f\u7528 etcdctl \u8fdb\u884c etcd \u6570\u636e\u5feb\u7167\u5907\u4efd","text":"<p>etcdctl --endpoints=\"http://127.0.0.1:2379\" snapshot save /path/to/backup.db ```</p> <p>\u5728\u5907\u4efd\u8fc7\u7a0b\u4e2d\uff0c\u8bf7\u786e\u4fdd\u4ee5\u4e0b\u53c2\u6570\u6b63\u786e\uff1a</p> <ul> <li>--endpoints\uff1a\u8bbe\u7f6e <code>etcd</code> \u7684\u8bbf\u95ee\u5730\u5740\u548c\u7aef\u53e3\uff08\u4f8b\u5982 <code>http://127.0.0.1:2379</code>\uff09\uff0c\u9700\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u4fee\u6539\u3002</li> <li>/path/to/backup.db\uff1a\u4fdd\u5b58\u5907\u4efd\u5feb\u7167\u7684\u8def\u5f84\uff0c\u53ef\u4ee5\u662f\u4f60\u5e0c\u671b\u5b58\u653e\u5907\u4efd\u6587\u4ef6\u7684\u672c\u5730\u8def\u5f84\u3002</li> </ul> <p>\u6b64\u5916\uff0c\u63a8\u8350\u5b9a\u671f\u901a\u8fc7 <code>cron</code> \u5b9a\u65f6\u4efb\u52a1\u8fdb\u884c\u81ea\u52a8\u5907\u4efd\uff0c\u4f8b\u5982\uff0c\u6bcf\u5929\u51cc\u6668 1 \u70b9\u5907\u4efd\u4e00\u6b21\uff1a</p> <p>```bash</p>"},{"location":"devops/K8s_2.html#cron","title":"\u521b\u5efa cron \u4efb\u52a1\uff0c\u6267\u884c\u5907\u4efd\u64cd\u4f5c","text":"<p>0 1 * * * etcdctl --endpoints=\"http://127.0.0.1:2379\" snapshot save /backups/etcd/backup-$(date +\\%Y-\\%m-\\%d).db ```</p>"},{"location":"devops/K8s_2.html#3_1","title":"3. \u5907\u4efd\u5b58\u50a8\u7ba1\u7406","text":"<p>\u5b9a\u671f\u5907\u4efd\u7684\u6570\u636e\u5e94\u8be5\u5c3d\u91cf\u5b58\u653e\u5728\u5f02\u5730\u5b89\u5168\u4f4d\u7f6e\uff0c\u4ee5\u9632\u6b62\u96c6\u7fa4\u7684\u91cd\u5927\u6545\u969c\u5bfc\u81f4\u6570\u636e\u5b8c\u5168\u4e22\u5931\u3002\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u4ee5\u4e0b\u65b9\u5f0f\u8fdb\u884c\u5907\u4efd\u5b58\u50a8\u7ba1\u7406\uff1a</p> <ul> <li>\u4f7f\u7528 <code>rsync</code> \u5b9a\u671f\u540c\u6b65\u5907\u4efd\u6587\u4ef6\u5230\u8fdc\u7a0b\u670d\u52a1\u5668\u3002</li> <li>\u5c06\u5907\u4efd\u6587\u4ef6\u63a8\u9001\u5230\u5bf9\u8c61\u5b58\u50a8\uff08\u4f8b\u5982 AWS S3 \u6216\u963f\u91cc\u4e91 OSS\uff09\u3002</li> <li>\u901a\u8fc7 <code>scp</code> \u547d\u4ee4\u5c06\u5907\u4efd\u6587\u4ef6\u590d\u5236\u5230\u5f02\u5730\u670d\u52a1\u5668\u3002</li> </ul> <p>\u4f8b\u5982\uff0c\u901a\u8fc7 <code>rsync</code> \u5c06\u5907\u4efd\u63a8\u9001\u5230\u8fdc\u7a0b\u670d\u52a1\u5668\uff1a</p> <p><code>bash rsync -av /backups/etcd/backup-*.db user@remote-server:/remote/backups/</code></p>"},{"location":"devops/K8s_2.html#4-etcd","title":"4. \u6062\u590d etcd \u6570\u636e","text":"<p>\u5728\u53d1\u751f\u91cd\u5927\u6545\u969c\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u5feb\u7167\u6570\u636e\u6062\u590d <code>etcd</code> \u96c6\u7fa4\u72b6\u6001\u3002\u4ee5\u4e0b\u662f\u6062\u590d <code>etcd</code> \u7684\u5177\u4f53\u6b65\u9aa4\uff1a</p>"},{"location":"devops/K8s_2.html#41-etcd","title":"4.1 \u505c\u6b62 etcd \u670d\u52a1","text":"<p>\u5728\u6062\u590d\u4e4b\u524d\uff0c\u9996\u5148\u505c\u6b62\u6b63\u5728\u8fd0\u884c\u7684 <code>etcd</code> \u670d\u52a1\uff0c\u4ee5\u514d\u8986\u76d6\u73b0\u6709\u6570\u636e\uff1a</p> <p><code>bash systemctl stop etcd</code></p>"},{"location":"devops/K8s_2.html#42","title":"4.2 \u4ece\u5feb\u7167\u6587\u4ef6\u6062\u590d\u6570\u636e","text":"<p>\u53ef\u4ee5\u4f7f\u7528 <code>etcdctl snapshot restore</code> \u547d\u4ee4\u4ece\u5feb\u7167\u6587\u4ef6\u6062\u590d <code>etcd</code> \u6570\u636e\uff0c\u4ee5\u4e0b\u662f\u6062\u590d\u547d\u4ee4\uff1a</p> <p><code>bash etcdctl snapshot restore /path/to/backup.db --name &lt;etcd-node-name&gt; --initial-cluster &lt;initial-cluster&gt; --initial-advertise-peer-urls &lt;initial-advertise-peer-urls&gt;</code></p> <p>\u53c2\u6570\u8bf4\u660e\uff1a</p> <ul> <li>/path/to/backup.db\uff1a\u5907\u4efd\u6587\u4ef6\u7684\u8def\u5f84\u3002</li> <li>--name <code>&lt;etcd-node-name&gt;</code>\uff1a\u8981\u6062\u590d\u7684 <code>etcd</code> \u8282\u70b9\u7684\u540d\u79f0\uff0c\u5e94\u4e0e\u539f\u6765\u7684\u540d\u79f0\u4e00\u81f4\u3002</li> <li>--initial-cluster <code>&lt;initial-cluster&gt;</code>\uff1a\u96c6\u7fa4\u7684\u521d\u59cb\u6210\u5458\u5217\u8868\uff0c\u683c\u5f0f\u4e3a <code>&lt;name&gt;=&lt;url&gt;</code>\uff0c\u4f8b\u5982 <code>etcd1=http://127.0.0.1:2380,etcd2=http://192.168.0.2:2380</code>\u3002</li> <li>--initial-advertise-peer-urls <code>&lt;initial-advertise-peer-urls&gt;</code>\uff1a\u8be5\u8282\u70b9\u5bf9\u5916\u63d0\u4f9b\u7684\u670d\u52a1\u5730\u5740\uff0c\u4f8b\u5982 <code>http://127.0.0.1:2380</code>\u3002</li> </ul> <p>\u4f8b\u5982\uff1a</p> <p><code>bash etcdctl snapshot restore /backups/etcd/backup-2024-10-17.db \\   --name etcd-node1 \\   --initial-cluster etcd-node1=http://127.0.0.1:2380 \\   --initial-advertise-peer-urls http://127.0.0.1:2380</code></p>"},{"location":"devops/K8s_2.html#43","title":"4.3 \u91cd\u7f6e\u6570\u636e\u76ee\u5f55","text":"<p>\u6062\u590d\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5\u5c06\u6062\u590d\u7684\u6570\u636e\u76ee\u5f55\u66ff\u6362\u4e3a <code>etcd</code> \u7684\u6570\u636e\u76ee\u5f55\u3002\u4f8b\u5982\uff0c\u5c06\u6062\u590d\u7684\u6570\u636e\u653e\u7f6e\u5230 <code>/var/lib/etcd</code> \u76ee\u5f55\u4e2d\uff1a</p> <p><code>bash mv /path/to/restored-data-dir /var/lib/etcd</code></p>"},{"location":"devops/K8s_2.html#44-etcd","title":"4.4 \u542f\u52a8 etcd \u670d\u52a1","text":"<p>\u6062\u590d\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5\u91cd\u65b0\u542f\u52a8 <code>etcd</code> \u670d\u52a1\uff1a</p> <p><code>bash systemctl start etcd</code></p>"},{"location":"devops/K8s_2.html#5_1","title":"5. \u68c0\u67e5\u6062\u590d\u72b6\u6001","text":"<p>\u6062\u590d\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7 <code>etcdctl</code> \u5de5\u5177\u67e5\u770b\u96c6\u7fa4\u72b6\u6001\uff0c\u786e\u4fdd\u6062\u590d\u6210\u529f\uff1a</p> <p><code>bash etcdctl --endpoints=\"http://127.0.0.1:2379\" endpoint status</code></p> <p>\u786e\u8ba4 <code>etcd</code> \u96c6\u7fa4\u6240\u6709\u8282\u70b9\u7684\u72b6\u6001\u548c\u6570\u636e\u90fd\u6b63\u5e38\u540c\u6b65\u540e\uff0c\u5373\u53ef\u91cd\u65b0\u542f\u7528\u96c6\u7fa4\u3002</p>"},{"location":"devops/K8s_2.html#_20","title":"\u603b\u7ed3","text":"<ul> <li>\u5907\u4efd\uff1a\u4f7f\u7528 <code>etcdctl snapshot save</code> \u547d\u4ee4\u5b9a\u671f\u8fdb\u884c\u5feb\u7167\u5907\u4efd\uff0c\u5e76\u5b58\u50a8\u5230\u5f02\u5730\u3002</li> <li>\u6062\u590d\uff1a\u4f7f\u7528 <code>etcdctl snapshot restore</code> \u547d\u4ee4\u6062\u590d\u6570\u636e\uff0c\u786e\u4fdd\u5907\u4efd\u6587\u4ef6\u5b89\u5168\u6709\u6548\u3002</li> <li>\u5b9a\u671f\u68c0\u67e5\uff1a\u5b9a\u671f\u68c0\u67e5 <code>etcd</code> \u7684\u5065\u5eb7\u72b6\u6001\uff0c\u4ee5\u4fbf\u5c3d\u65e9\u53d1\u73b0\u5e76\u89e3\u51b3\u95ee\u9898\u3002</li> </ul> <p>\u5982\u679c\u6709\u4efb\u4f55\u5176\u4ed6\u95ee\u9898\u6216\u9700\u8981\u8fdb\u4e00\u6b65\u7684\u5e2e\u52a9\uff0c\u6b22\u8fce\u7ee7\u7eed\u63d0\u95ee\u3002</p>"},{"location":"devops/K8s_2.html#527","title":"5.2.7  \u65f6\u95f4\u540c\u6b65","text":"<p>\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u65f6\u95f4\u540c\u6b65 \u5bf9\u4e8e\u65e5\u5fd7\u5206\u6790\u3001\u8c03\u8bd5\u3001\u4ee5\u53ca <code>etcd</code> \u7684\u4e00\u81f4\u6027\u534f\u8bae\uff08\u5982 Raft\uff09\u662f\u975e\u5e38\u91cd\u8981\u7684\u3002\u5efa\u8bae\u5728\u6240\u6709 Master \u8282\u70b9\u548c etcd \u8282\u70b9\u4e0a\u914d\u7f6e NTP\uff08Network Time Protocol\uff09\uff0c\u4ee5\u786e\u4fdd\u65f6\u95f4\u4e00\u81f4\u3002</p> <pre><code>sudo apt install ntp\nsudo systemctl enable ntp\nsudo systemctl start ntp\n</code></pre>"},{"location":"devops/K8s_2.html#528-leader-election","title":"5.2.8. Leader Election\uff08\u9886\u5bfc\u9009\u4e3e\uff09","text":"<p>\u5728\u591a Master \u8282\u70b9\u914d\u7f6e\u4e2d\uff0c<code>kube-scheduler</code> \u548c <code>kube-controller-manager</code> \u90fd\u9700\u8981\u542f\u7528 Leader Election \u6a21\u5f0f\uff0c\u4ee5\u786e\u4fdd\u540c\u4e00\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u6d3b\u8dc3\u7684 <code>scheduler</code> \u548c <code>controller-manager</code>\uff0c\u907f\u514d\u8d44\u6e90\u4e89\u593a\u548c\u91cd\u590d\u64cd\u4f5c\u3002</p> <ul> <li><code>kube-scheduler</code> \u548c <code>kube-controller-manager</code> \u7684\u914d\u7f6e\u4e2d\uff0c\u9700\u8981\u542f\u7528 <code>--leader-elect=true</code> \u53c2\u6570\uff08\u9ed8\u8ba4\u662f\u542f\u7528\u7684\uff09\uff1a   <code>bash   kube-controller-manager --leader-elect=true   kube-scheduler --leader-elect=true</code></li> </ul> <p>Leader Election \u7684\u673a\u5236\u4fdd\u8bc1\u4e86\u5728\u67d0\u4e2a Master \u8282\u70b9\u6545\u969c\u65f6\uff0c\u5176\u4ed6\u8282\u70b9\u53ef\u4ee5\u81ea\u52a8\u9009\u4e3e\u51fa\u65b0\u7684\u9886\u5bfc\u8005\u6765\u7ee7\u7eed\u5de5\u4f5c\u3002</p>"},{"location":"devops/K8s_2.html#529","title":"5.2.9. \u707e\u96be\u6062\u590d\u7b56\u7565","text":"<p>\u5728\u914d\u7f6e\u9ad8\u53ef\u7528\u96c6\u7fa4\u65f6\uff0c\u9664\u4e86\u5197\u4f59\u90e8\u7f72\uff0c\u8fd8\u9700\u8981\u5236\u5b9a\u8be6\u7ec6\u7684\u707e\u96be\u6062\u590d\u7b56\u7565\uff0c\u4ee5\u5e94\u5bf9\u96c6\u7fa4\u7684\u90e8\u5206\u6216\u5168\u90e8\u5931\u6548\u3002</p> <ul> <li>Master \u8282\u70b9\u6062\u590d\u6b65\u9aa4\uff1a\u9700\u8981\u6d4b\u8bd5\u5982\u4f55\u5728\u73b0\u6709\u7684\u9ad8\u53ef\u7528\u73af\u5883\u4e2d\u6dfb\u52a0\u65b0\u7684 Master \u8282\u70b9\uff0c\u6216\u5728\u67d0\u4e2a Master \u8282\u70b9\u5931\u6548\u540e\u8fdb\u884c\u66ff\u6362\u3002</li> <li>etcd \u8282\u70b9\u7684\u6062\u590d\uff1a\u638c\u63e1\u5982\u4f55\u5728 <code>etcd</code> \u8282\u70b9\u5931\u6548\u65f6\uff0c\u901a\u8fc7\u5907\u4efd\u6570\u636e\u8fdb\u884c\u6062\u590d\uff0c\u5e76\u91cd\u65b0\u52a0\u5165\u5230\u96c6\u7fa4\u4e2d\u3002</li> <li>\u65e5\u5fd7\u7ba1\u7406\uff1a\u901a\u8fc7 ELK\uff08Elasticsearch, Logstash, Kibana\uff09\u7b49\u65e5\u5fd7\u7ba1\u7406\u5de5\u5177\uff0c\u6536\u96c6\u548c\u76d1\u63a7 Master \u8282\u70b9\u548c <code>etcd</code> \u7684\u65e5\u5fd7\uff0c\u4fbf\u4e8e\u6545\u969c\u8bca\u65ad\u548c\u6062\u590d\u3002</li> </ul>"},{"location":"devops/K8s_3.html","title":"K8s \u76f8\u5173\u95ee\u9898\u96c6\u9526\uff08\u4e09\uff09","text":""},{"location":"devops/K8s_3.html#53-kubernetes-deployment","title":"5.3 \u5728 Kubernetes \u4e2d\u6eda\u52a8\u66f4\u65b0\u4e00\u4e2a Deployment\uff1f","text":"<p>\u66f4\u65b0\u4e00\u4e2aDeployment \u6709\u4ee5\u4e0b\u51e0\u79cd\u65b9\u6cd5\uff0c\u6eda\u52a8\u662f\u5176\u4e2d\u7684\u4e00\u79cd\uff0c\u73b0\u5728\u5206\u522b\u8bf4\u4e00\u4e0b\u8fd9\u4e9b\u65b9\u6cd5\u7684\u5b9e\u73b0</p> <ul> <li>\u6eda\u52a8\u66f4\u65b0\uff08Rolling Update\uff09\uff1aKubernetes \u7684\u9ed8\u8ba4\u66f4\u65b0\u7b56\u7565\uff0c\u9010\u6b65\u66ff\u6362\u65e7\u7248\u672c Pod\uff0c\u7528\u65b0\u7248\u672c\u4fdd\u6301\u670d\u52a1\u4e0d\u4e2d\u65ad\u3002</li> <li>\u91cd\u5efa\uff08Recreate\uff09\uff1a\u5220\u9664\u6240\u6709\u65e7\u7684 Pod\uff0c\u7136\u540e\u4e00\u6b21\u6027\u542f\u52a8\u65b0\u7248\u672c\uff0c\u901f\u5ea6\u5feb\u4f46\u6709\u4e2d\u65ad\u98ce\u9669\u3002</li> <li>\u84dd\u7eff\u90e8\u7f72\uff08Blue-Green Deployment\uff09\uff1a\u901a\u8fc7\u8fd0\u884c\u4e24\u4e2a\u5e76\u884c\u7684\u7248\u672c\u6765\u8fdb\u884c\u5207\u6362\uff0c\u6613\u4e8e\u56de\u6eda\uff0c\u4f46\u9700\u8981\u989d\u5916\u8d44\u6e90\u3002</li> <li>\u91d1\u4e1d\u96c0\u90e8\u7f72\uff08Canary Deployment\uff09\uff1a\u9010\u6b65\u5f15\u5165\u65b0\u7248\u672c\uff0c\u89c2\u5bdf\u65b0\u7248\u672c\u7684\u7a33\u5b9a\u6027\uff0c\u9002\u7528\u4e8e\u964d\u4f4e\u98ce\u9669\u3002</li> <li>A/B \u6d4b\u8bd5\uff08A/B Testing\uff09\uff1a\u7c7b\u4f3c\u4e8e\u91d1\u4e1d\u96c0\uff0c\u4f46\u91cd\u70b9\u662f\u5bf9\u6bd4\u6d4b\u8bd5\u4e24\u4e2a\u7248\u672c\u7684\u8868\u73b0\u3002</li> <li>\u6eda\u52a8\u66f4\u65b0 + Pause/Resume\uff1a\u624b\u52a8\u63a7\u5236\u66f4\u65b0\u7684\u8282\u594f\uff0c\u9002\u5408\u9700\u8981\u7ec6\u7c92\u5ea6\u63a7\u5236\u66f4\u65b0\u7684\u60c5\u51b5\u3002</li> </ul>"},{"location":"devops/K8s_3.html#531-rolling-update","title":"5.3.1 \u6eda\u52a8\u66f4\u65b0\uff08Rolling Update\uff09","text":"<p>\u6eda\u52a8\u66f4\u65b0\uff08Rolling Update\uff09\u662f Kubernetes \u4e2d <code>Deployment</code> \u8fdb\u884c\u66f4\u65b0\u7684\u4e00\u79cd\u5e38\u7528\u65b9\u5f0f\uff0c\u5b83\u7684\u76ee\u7684\u662f\u9010\u6b65\u5730\u7528\u65b0\u7248\u672c\u66ff\u6362\u65e7\u7248\u672c\uff0c\u786e\u4fdd\u5e94\u7528\u5728\u66f4\u65b0\u8fc7\u7a0b\u4e2d\u59cb\u7ec8\u53ef\u7528\u3002\u9664\u4e86\u6eda\u52a8\u66f4\u65b0\uff0cKubernetes \u8fd8\u652f\u6301\u5176\u4ed6\u51e0\u79cd\u66f4\u65b0\u7b56\u7565\u548c\u65b9\u5f0f\uff1a</p>"},{"location":"devops/K8s_3.html#1-rolling-update","title":"1. \u6eda\u52a8\u66f4\u65b0\uff08Rolling Update\uff09","text":"<p>\u8fd9\u662f <code>Deployment</code> \u7684\u9ed8\u8ba4\u66f4\u65b0\u7b56\u7565\uff0c\u901a\u8fc7\u9010\u4e2a\u66ff\u6362\u65e7\u7248\u672c\u7684 Pod\uff0c\u7528\u65b0\u7684 Pod \u9010\u6b65\u53d6\u4ee3\u3002\u8fd9\u6837\uff0c\u96c6\u7fa4\u4e2d\u7684\u670d\u52a1\u53ef\u4ee5\u5728\u66f4\u65b0\u671f\u95f4\u4fdd\u6301\u53ef\u7528\u3002</p> <ul> <li>\u4f18\u70b9\uff1a\u9010\u6b65\u66ff\u6362\u65e7\u7684 Pod\uff0c\u670d\u52a1\u4e0d\u4e2d\u65ad\u3002</li> <li>\u7f3a\u70b9\uff1a\u66f4\u65b0\u901f\u5ea6\u8f83\u6162\uff0c\u4f9d\u8d56\u591a\u4e2a Pod \u6765\u786e\u4fdd\u4e0d\u4e2d\u65ad\u3002</li> </ul>"},{"location":"devops/K8s_3.html#_1","title":"\u63a7\u5236\u6eda\u52a8\u66f4\u65b0","text":"<p>\u4f60\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539 <code>spec.strategy</code> \u6765\u81ea\u5b9a\u4e49\u6eda\u52a8\u66f4\u65b0\u7684\u884c\u4e3a\uff1a</p> <ul> <li>maxUnavailable\uff1a\u6307\u5b9a\u5728\u66f4\u65b0\u8fc7\u7a0b\u4e2d\uff0c\u6700\u591a\u53ef\u4ee5\u6709\u591a\u5c11\u4e2a\u4e0d\u53ef\u7528\u7684 Pod\u3002</li> <li>maxSurge\uff1a\u6307\u5b9a\u5728\u66f4\u65b0\u8fc7\u7a0b\u4e2d\uff0c\u6700\u591a\u53ef\u4ee5\u589e\u52a0\u591a\u5c11\u4e2a\u989d\u5916\u7684 Pod\u3002</li> </ul> <p>\u4f8b\u5982\uff1a</p> <p><code>yaml strategy:   type: RollingUpdate   rollingUpdate:     maxUnavailable: 1     maxSurge: 2</code></p> <ul> <li>maxUnavailable: 1\uff1a\u8868\u793a\u5728\u66f4\u65b0\u8fc7\u7a0b\u4e2d\uff0c\u6700\u591a\u53ea\u80fd\u6709 1 \u4e2a Pod \u4e0d\u53ef\u7528\u3002</li> <li>maxSurge: 2\uff1a\u8868\u793a\u5728\u66f4\u65b0\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u6700\u591a\u989d\u5916\u521b\u5efa 2 \u4e2a Pod\u3002</li> </ul> <p>\u5728 Kubernetes \u4e2d\uff0c\u6eda\u52a8\u66f4\u65b0 <code>Deployment</code> \u662f\u4e00\u79cd\u5e38\u89c1\u7684\u65b9\u6cd5\u6765\u66f4\u65b0\u5e94\u7528\u7a0b\u5e8f\uff0c\u540c\u65f6\u786e\u4fdd\u66f4\u65b0\u671f\u95f4\u4fdd\u6301\u53ef\u7528\u6027\u3002\u6eda\u52a8\u66f4\u65b0\u53ef\u4ee5\u901a\u8fc7\u4e24\u79cd\u65b9\u5f0f\u5b9e\u73b0\uff1a\u4f7f\u7528 <code>kubectl set image</code> \u547d\u4ee4\u6765\u66f4\u65b0\u955c\u50cf\uff0c\u6216\u8005\u76f4\u63a5\u4fee\u6539 <code>Deployment</code> \u7684 YAML \u914d\u7f6e\u6587\u4ef6\u5e76\u91cd\u65b0\u5e94\u7528\u3002</p> <p>\u4ee5\u4e0b\u662f\u8be6\u7ec6\u7684\u64cd\u4f5c\u6b65\u9aa4\uff1a</p>"},{"location":"devops/K8s_3.html#1-kubectl-set-image","title":"\u65b9\u6cd5 1\uff1a\u4f7f\u7528 <code>kubectl set image</code> \u8fdb\u884c\u6eda\u52a8\u66f4\u65b0","text":""},{"location":"devops/K8s_3.html#1-deployment","title":"1. \u67e5\u770b\u73b0\u6709\u7684 Deployment","text":"<p>\u9996\u5148\uff0c\u67e5\u770b\u73b0\u6709\u7684 <code>Deployment</code>\uff0c\u4ee5\u4fbf\u83b7\u53d6\u5b83\u7684\u540d\u79f0\u548c\u4e86\u89e3\u5176\u5f53\u524d\u72b6\u6001\uff1a</p> <p><code>bash kubectl get deployments</code></p> <p>\u4f60\u53ef\u4ee5\u67e5\u770b\u5230\u7c7b\u4f3c\u7684\u8f93\u51fa\uff1a</p> <p><code>plaintext NAME          READY   UP-TO-DATE   AVAILABLE   AGE myapp         3/3     3            3           10m</code></p> <p>\u8fd9\u91cc\uff0c<code>myapp</code> \u5c31\u662f <code>Deployment</code> \u7684\u540d\u79f0\u3002</p>"},{"location":"devops/K8s_3.html#2","title":"2. \u66f4\u65b0\u955c\u50cf","text":"<p>\u4f7f\u7528 <code>kubectl set image</code> \u547d\u4ee4\u6765\u66f4\u65b0 <code>Deployment</code> \u4e2d\u7684\u5bb9\u5668\u955c\u50cf\uff1a</p> <p><code>bash kubectl set image deployment/myapp mycontainer=myimage:v2</code></p> <ul> <li>deployment/myapp\uff1a\u8fd9\u662f <code>Deployment</code> \u7684\u540d\u79f0\uff0c\u8868\u793a\u9700\u8981\u66f4\u65b0\u54ea\u4e2a <code>Deployment</code>\u3002</li> <li>mycontainer\uff1a\u8fd9\u662f\u5bb9\u5668\u7684\u540d\u79f0\uff0c\u5fc5\u987b\u4e0e\u539f\u6765\u7684\u540d\u79f0\u4e00\u81f4\u3002</li> <li>myimage:v2\uff1a\u8fd9\u662f\u65b0\u955c\u50cf\u7684\u540d\u79f0\u548c\u7248\u672c\u3002</li> </ul> <p>\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u7684 <code>Deployment</code> \u6709\u4e00\u4e2a\u540d\u4e3a <code>nginx</code> \u7684\u5bb9\u5668\uff0c\u4f60\u60f3\u5c06\u955c\u50cf\u4ece <code>nginx:1.19</code> \u66f4\u65b0\u5230 <code>nginx:1.20</code>\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <p><code>bash kubectl set image deployment/nginx-deployment nginx=nginx:1.20</code></p>"},{"location":"devops/K8s_3.html#3","title":"3. \u67e5\u770b\u6eda\u52a8\u66f4\u65b0\u7684\u72b6\u6001","text":"<p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6765\u67e5\u770b\u66f4\u65b0\u7684\u72b6\u6001\uff1a</p> <p><code>bash kubectl rollout status deployment/myapp</code></p> <p>\u6b64\u547d\u4ee4\u4f1a\u76d1\u89c6 <code>Deployment</code> \u7684\u72b6\u6001\uff0c\u76f4\u5230\u66f4\u65b0\u5b8c\u6210\u3002\u4f60\u5c06\u4f1a\u770b\u5230\u7c7b\u4f3c\u7684\u8f93\u51fa\uff1a</p> <p><code>plaintext deployment \"myapp\" successfully rolled out</code></p>"},{"location":"devops/K8s_3.html#4","title":"4. \u67e5\u770b\u66f4\u65b0\u5386\u53f2","text":"<p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6765\u67e5\u770b <code>Deployment</code> \u7684\u6eda\u52a8\u66f4\u65b0\u5386\u53f2\uff1a</p> <p><code>bash kubectl rollout history deployment/myapp</code></p> <p>\u8fd9\u4f1a\u663e\u793a\u6bcf\u6b21\u66f4\u65b0\u7684\u4fee\u8ba2\u7248\u672c\u3002</p>"},{"location":"devops/K8s_3.html#5","title":"5. \u56de\u6eda\u66f4\u65b0\uff08\u5982\u679c\u6709\u95ee\u9898\uff09","text":"<p>\u5982\u679c\u53d1\u73b0\u65b0\u7248\u672c\u6709\u95ee\u9898\uff0c\u53ef\u4ee5\u56de\u6eda\u5230\u4e4b\u524d\u7684\u7248\u672c\uff1a</p> <p><code>bash kubectl rollout undo deployment/myapp</code></p> <p>\u5982\u679c\u4f60\u6709\u591a\u4e2a\u4fee\u8ba2\u7248\u672c\uff0c\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a\u7279\u5b9a\u7684\u4fee\u8ba2\u7248\u672c\u8fdb\u884c\u56de\u6eda\uff1a</p> <p><code>bash kubectl rollout undo deployment/myapp --to-revision=1</code></p>"},{"location":"devops/K8s_3.html#2-deployment","title":"\u65b9\u6cd5 2\uff1a\u4fee\u6539 Deployment \u914d\u7f6e\u6587\u4ef6\u5e76\u91cd\u65b0\u5e94\u7528","text":""},{"location":"devops/K8s_3.html#1-deployment_1","title":"1. \u83b7\u53d6\u5e76\u7f16\u8f91 Deployment \u914d\u7f6e\u6587\u4ef6","text":"<p>\u4f7f\u7528 <code>kubectl get deployment</code> \u547d\u4ee4\u83b7\u53d6\u5f53\u524d\u7684 <code>Deployment</code> \u7684 YAML \u914d\u7f6e\u6587\u4ef6\u5e76\u5bfc\u51fa\u4e3a\u6587\u4ef6\uff1a</p> <p><code>bash kubectl get deployment myapp -o yaml &gt; myapp-deployment.yaml</code></p>"},{"location":"devops/K8s_3.html#2_1","title":"2. \u7f16\u8f91\u914d\u7f6e\u6587\u4ef6","text":"<p>\u6253\u5f00 <code>myapp-deployment.yaml</code> \u6587\u4ef6\uff0c\u627e\u5230 <code>spec.template.spec.containers</code> \u90e8\u5206\uff0c\u5e76\u4fee\u6539\u955c\u50cf\u7248\u672c\u3002\u4f8b\u5982\uff1a</p> <p><code>yaml spec:   template:     spec:       containers:       - name: mycontainer         image: myimage:v2</code></p> <p>\u5c06 <code>image</code> \u7684\u503c\u66f4\u65b0\u5230\u4f60\u60f3\u8981\u7684\u7248\u672c\u3002</p>"},{"location":"devops/K8s_3.html#3_1","title":"3. \u5e94\u7528\u4fee\u6539\u540e\u7684\u914d\u7f6e\u6587\u4ef6","text":"<p>\u4fdd\u5b58\u4fee\u6539\u5e76\u4f7f\u7528 <code>kubectl apply</code> \u547d\u4ee4\u91cd\u65b0\u5e94\u7528\u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\uff1a</p> <p><code>bash kubectl apply -f myapp-deployment.yaml</code></p>"},{"location":"devops/K8s_3.html#4_1","title":"4. \u67e5\u770b\u6eda\u52a8\u66f4\u65b0\u7684\u72b6\u6001","text":"<p>\u548c\u524d\u9762\u7684\u64cd\u4f5c\u4e00\u6837\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u6eda\u52a8\u66f4\u65b0\u72b6\u6001\uff1a</p> <p><code>bash kubectl rollout status deployment/myapp</code></p>"},{"location":"devops/K8s_3.html#_2","title":"\u6eda\u52a8\u66f4\u65b0\u7684\u6d41\u7a0b\u89e3\u91ca","text":"<ul> <li>\u6eda\u52a8\u66f4\u65b0 \u662f Kubernetes \u9ed8\u8ba4\u7684\u66f4\u65b0\u65b9\u5f0f\u3002\u5b83\u9010\u6e10\u66f4\u65b0 Pod\uff0c\u4ee5\u4fdd\u6301\u670d\u52a1\u53ef\u7528\u6027\u3002\u5728\u65b0\u7684 Pod \u521b\u5efa\u4e4b\u524d\uff0c\u65e7\u7684 Pod \u4e0d\u4f1a\u7acb\u523b\u88ab\u5220\u9664\u3002</li> <li>\u6eda\u52a8\u66f4\u65b0\u7684\u597d\u5904\uff1a</li> <li>\u4fdd\u8bc1\u5e94\u7528\u7a0b\u5e8f\u6301\u7eed\u53ef\u7528\u3002</li> <li>\u9047\u5230\u95ee\u9898\u65f6\u53ef\u4ee5\u65b9\u4fbf\u5730\u8fdb\u884c\u56de\u6eda\u3002</li> <li>\u53ef\u63a7\u5236\u6eda\u52a8\u66f4\u65b0\u7684\u901f\u5ea6\u548c\u6682\u505c\u6761\u4ef6\u3002</li> </ul>"},{"location":"devops/K8s_3.html#_3","title":"\u5c0f\u7ed3","text":"<ol> <li>\u4f7f\u7528 <code>kubectl set image</code> \u53ef\u4ee5\u5feb\u901f\u66f4\u65b0\u955c\u50cf\u3002</li> <li>\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539 <code>Deployment</code> \u7684\u914d\u7f6e\u6587\u4ef6\u5e76\u91cd\u65b0\u5e94\u7528\u3002</li> <li>\u4f7f\u7528 <code>kubectl rollout status</code> \u6765\u76d1\u63a7\u66f4\u65b0\u72b6\u6001\uff0c\u5e76\u5728\u9700\u8981\u65f6\u4f7f\u7528 <code>kubectl rollout undo</code> \u8fdb\u884c\u56de\u6eda\u3002</li> </ol> <p>\u5982\u679c\u4f60\u9700\u8981\u66f4\u8fdb\u4e00\u6b65\u7684\u5e2e\u52a9\uff0c\u6b22\u8fce\u7ee7\u7eed\u63d0\u95ee\uff01</p>"},{"location":"devops/K8s_3.html#532-recreate","title":"5.3.2 \u91cd\u5efa\uff08Recreate\uff09","text":""},{"location":"devops/K8s_3.html#2-recreate","title":"2. \u91cd\u5efa\uff08Recreate\uff09","text":"<p>\u91cd\u5efa\uff08Recreate\uff09\u7b56\u7565\u662f\u4e00\u79cd\u7b80\u5355\u4f46\u5177\u6709\u98ce\u9669\u7684\u66f4\u65b0\u65b9\u5f0f\u3002\u5b83\u4f1a\u9996\u5148\u5220\u9664\u6240\u6709\u65e7\u7248\u672c\u7684 Pod\uff0c\u7136\u540e\u542f\u52a8\u65b0\u7248\u672c\u7684 Pod\u3002</p> <ul> <li>\u4f18\u70b9\uff1a\u9002\u7528\u4e8e\u4e0d\u9700\u8981\u4fdd\u6301\u65e7\u7248\u672c\u8fd0\u884c\u7684\u573a\u666f\uff0c\u66f4\u65b0\u901f\u5ea6\u5feb\u3002</li> <li>\u7f3a\u70b9\uff1a\u5b58\u5728\u5e94\u7528\u670d\u52a1\u4e0d\u53ef\u7528\u7684\u65f6\u95f4\uff0c\u56e0\u4e3a\u6240\u6709\u65e7\u7248\u672c\u7684 Pod \u4f1a\u88ab\u540c\u65f6\u5220\u9664\u3002</li> </ul> <p>\u53ef\u4ee5\u5728 <code>Deployment</code> \u4e2d\u914d\u7f6e\u91cd\u5efa\u7b56\u7565\uff1a</p> <p><code>yaml strategy:   type: Recreate</code></p> <p>\u5982\u4f55\u4f7f\u7528 \u91cd\u5efa\uff08Recreate\uff09 \u7b56\u7565\u6765\u66f4\u65b0 Kubernetes \u4e2d\u7684 <code>Deployment</code>\u3002\u8fd9\u79cd\u65b9\u5f0f\u5148\u5220\u9664\u6240\u6709\u73b0\u6709\u7684 Pod\uff0c\u7136\u540e\u542f\u52a8\u65b0\u7684 Pod\uff0c\u56e0\u6b64\u5728\u66f4\u65b0\u671f\u95f4\u5e94\u7528\u670d\u52a1\u4f1a\u77ed\u65f6\u95f4\u4e0d\u53ef\u7528\u3002</p>"},{"location":"devops/K8s_3.html#recreate","title":"\u91cd\u5efa\uff08Recreate\uff09\u7b56\u7565\u7684\u8be6\u7ec6\u6b65\u9aa4","text":"<p>\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684 Nginx <code>Deployment</code>\uff0c\u5e76\u901a\u8fc7\u8bbe\u7f6e\u66f4\u65b0\u7b56\u7565\u4e3a <code>Recreate</code> \u6765\u8fdb\u884c\u90e8\u7f72\u548c\u66f4\u65b0\u64cd\u4f5c\u3002</p>"},{"location":"devops/K8s_3.html#1-deployment_2","title":"\u6b65\u9aa4 1\uff1a\u521b\u5efa\u521d\u59cb <code>Deployment</code>","text":"<p>\u9996\u5148\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u5305\u542b <code>nginx</code> \u5bb9\u5668\u7684 <code>Deployment</code>\uff0c\u5e76\u4f7f\u7528\u9ed8\u8ba4\u7684\u66f4\u65b0\u7b56\u7565\uff08\u6eda\u52a8\u66f4\u65b0\uff09\u6765\u542f\u52a8\u670d\u52a1\u3002</p> <p>1.1. \u521b\u5efa <code>nginx-deployment.yaml</code> \u6587\u4ef6</p> <p><code>yaml apiVersion: apps/v1 kind: Deployment metadata:   name: nginx-deployment spec:   replicas: 3   selector:     matchLabels:       app: nginx   template:     metadata:       labels:         app: nginx     spec:       containers:       - name: nginx         image: nginx:1.19         ports:         - containerPort: 80</code></p> <p>1.2. \u5e94\u7528 <code>Deployment</code> \u914d\u7f6e\u6587\u4ef6</p> <p>\u4f7f\u7528 <code>kubectl</code> \u547d\u4ee4\u6765\u5e94\u7528\u914d\u7f6e\u6587\u4ef6\uff1a</p> <p><code>bash kubectl apply -f nginx-deployment.yaml</code></p> <p>1.3. \u9a8c\u8bc1 <code>Deployment</code> \u662f\u5426\u6210\u529f\u90e8\u7f72</p> <p>\u67e5\u770b Pod \u7684\u72b6\u6001\uff0c\u786e\u4fdd\u5b83\u4eec\u5df2\u6210\u529f\u542f\u52a8\uff1a</p> <p><code>bash kubectl get pods -l app=nginx</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <p><code>plaintext NAME                                READY   STATUS    RESTARTS   AGE nginx-deployment-6b7f6b4c7d-1abc    1/1     Running   0          2m nginx-deployment-6b7f6b4c7d-2def    1/1     Running   0          2m nginx-deployment-6b7f6b4c7d-3ghi    1/1     Running   0          2m</code></p>"},{"location":"devops/K8s_3.html#2-deployment-recreate","title":"\u6b65\u9aa4 2\uff1a\u4fee\u6539 <code>Deployment</code> \u4f7f\u7528 Recreate \u7b56\u7565","text":"<p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c06\u4fee\u6539 <code>Deployment</code> \u7684\u66f4\u65b0\u7b56\u7565\u4e3a <code>Recreate</code>\uff0c\u4ee5\u4fbf\u5728\u66f4\u65b0\u955c\u50cf\u7248\u672c\u65f6\u5148\u5220\u9664\u6240\u6709\u65e7\u7248\u672c\u7684 Pod\uff0c\u7136\u540e\u542f\u52a8\u65b0\u7248\u672c\u3002</p> <p>2.1. \u4fee\u6539 <code>nginx-deployment.yaml</code> \u914d\u7f6e</p> <p>\u6253\u5f00\u4e4b\u524d\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5c06 <code>spec.strategy</code> \u8bbe\u7f6e\u4e3a <code>Recreate</code>\uff0c\u540c\u65f6\u5c06 <code>nginx</code> \u955c\u50cf\u7248\u672c\u66f4\u65b0\u4e3a <code>nginx:1.20</code>\u3002</p> <p>\u4fee\u6539\u540e\u7684 <code>nginx-deployment.yaml</code> \u6587\u4ef6\u5982\u4e0b\uff1a</p> <p><code>yaml apiVersion: apps/v1 kind: Deployment metadata:   name: nginx-deployment spec:   replicas: 3   strategy:     type: Recreate   selector:     matchLabels:       app: nginx   template:     metadata:       labels:         app: nginx     spec:       containers:       - name: nginx         image: nginx:1.20         ports:         - containerPort: 80</code></p> <p>2.2. \u91cd\u65b0\u5e94\u7528\u66f4\u65b0\u540e\u7684 <code>Deployment</code> \u914d\u7f6e</p> <p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6765\u5e94\u7528\u4fee\u6539\u540e\u7684\u914d\u7f6e\u6587\u4ef6\uff1a</p> <p><code>bash kubectl apply -f nginx-deployment.yaml</code></p>"},{"location":"devops/K8s_3.html#3_2","title":"\u6b65\u9aa4 3\uff1a\u67e5\u770b\u91cd\u5efa\u8fc7\u7a0b","text":"<p>\u7531\u4e8e\u6211\u4eec\u4f7f\u7528\u4e86 <code>Recreate</code> \u7b56\u7565\uff0cKubernetes \u4f1a\u5148\u5220\u9664\u6240\u6709\u65e7\u7684 Pod\uff0c\u7136\u540e\u518d\u542f\u52a8\u65b0\u7684 Pod\u3002\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u670d\u52a1\u77ed\u65f6\u95f4\u4e0d\u53ef\u7528\u3002</p> <p>3.1. \u67e5\u770b\u66f4\u65b0\u72b6\u6001</p> <p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b <code>Deployment</code> \u7684\u66f4\u65b0\u72b6\u6001\uff1a</p> <p><code>bash kubectl rollout status deployment/nginx-deployment</code></p> <p>\u4f60\u4f1a\u770b\u5230\u7c7b\u4f3c\u5982\u4e0b\u7684\u4fe1\u606f\uff1a</p> <p><code>plaintext Waiting for deployment \"nginx-deployment\" rollout to finish: 0 out of 3 new replicas have been updated...</code></p> <p>\u8be5\u4fe1\u606f\u8868\u660e\uff0c\u65e7\u7684 Pod \u5df2\u7ecf\u88ab\u5220\u9664\uff0cKubernetes \u6b63\u5728\u542f\u52a8\u65b0\u7684 Pod\u3002</p> <p>3.2. \u9a8c\u8bc1\u66f4\u65b0\u7ed3\u679c</p> <p>\u67e5\u770b <code>Deployment</code> \u4e2d\u65b0\u7684 Pod \u662f\u5426\u5df2\u5168\u90e8\u542f\u52a8\uff1a</p> <p><code>bash kubectl get pods -l app=nginx</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <p><code>plaintext NAME                                READY   STATUS    RESTARTS   AGE nginx-deployment-54c8d5dfb8-1jkl    1/1     Running   0          1m nginx-deployment-54c8d5dfb8-2mno    1/1     Running   0          1m nginx-deployment-54c8d5dfb8-3pqr    1/1     Running   0          1m</code></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u65e7\u7248\u672c\u7684 Pod \u5df2\u88ab\u5220\u9664\uff0c\u5e76\u4e14\u65b0\u7684 Pod \u5df2\u542f\u52a8\u3002</p>"},{"location":"devops/K8s_3.html#4_2","title":"\u6b65\u9aa4 4\uff1a\u9a8c\u8bc1\u5e94\u7528\u670d\u52a1\u7684\u53ef\u7528\u6027","text":"<p>\u7531\u4e8e <code>Recreate</code> \u7b56\u7565\u4f1a\u5148\u5220\u9664\u65e7\u7684 Pod\uff0c\u56e0\u6b64\u5728\u65b0 Pod \u542f\u52a8\u4e4b\u524d\uff0c\u53ef\u80fd\u4f1a\u6709\u77ed\u65f6\u95f4\u7684\u670d\u52a1\u4e0d\u53ef\u7528\u671f\u3002\u5728\u66f4\u65b0\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee Nginx \u670d\u52a1\u9a8c\u8bc1\u5176\u53ef\u7528\u6027\uff1a</p> <p>4.1. \u66b4\u9732\u670d\u52a1</p> <p>\u4e3a\u4e86\u9a8c\u8bc1\u5e94\u7528\uff0c\u6211\u4eec\u53ef\u4ee5\u66b4\u9732 <code>Deployment</code>\uff0c\u4ee5\u4fbf\u5916\u90e8\u8bbf\u95ee Pod\uff1a</p> <p><code>bash kubectl expose deployment/nginx-deployment --type=NodePort --name=nginx-service</code></p> <p>4.2. \u83b7\u53d6\u670d\u52a1\u7684\u8bbf\u95ee\u7aef\u53e3</p> <p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u83b7\u53d6\u670d\u52a1\u7684\u7aef\u53e3\uff1a</p> <p><code>bash kubectl get service nginx-service</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <p><code>plaintext NAME            TYPE       CLUSTER-IP     EXTERNAL-IP   PORT(S)          AGE nginx-service   NodePort   10.96.128.25   &lt;none&gt;        80:31001/TCP     2m</code></p> <ul> <li>31001 \u662f <code>NodePort</code> \u66b4\u9732\u7684\u7aef\u53e3\uff0c\u8bbf\u95ee\u96c6\u7fa4\u8282\u70b9\u7684 IP \u5730\u5740\u548c\u8be5\u7aef\u53e3\uff0c\u53ef\u4ee5\u9a8c\u8bc1\u5e94\u7528\u7a0b\u5e8f\u662f\u5426\u53ef\u7528\u3002</li> </ul>"},{"location":"devops/K8s_3.html#_4","title":"\u603b\u7ed3","text":"<ul> <li>\u91cd\u5efa\uff08Recreate\uff09\u7b56\u7565 \u4f1a\u5148\u5220\u9664\u6240\u6709\u65e7\u7248\u672c\u7684 Pod\uff0c\u7136\u540e\u518d\u542f\u52a8\u65b0\u7248\u672c\uff0c\u8fd9\u610f\u5473\u7740\u5e94\u7528\u4f1a\u6709\u4e00\u6bb5\u65f6\u95f4\u5904\u4e8e\u4e0d\u53ef\u7528\u72b6\u6001\u3002\u56e0\u6b64\uff0c\u91cd\u5efa\u7b56\u7565\u9002\u7528\u4e8e\u90a3\u4e9b\u5bf9\u77ed\u65f6\u95f4\u670d\u52a1\u4e2d\u65ad\u4e0d\u654f\u611f\u7684\u573a\u666f\u3002</li> <li>\u8be6\u7ec6\u6b65\u9aa4\u5305\u62ec\u521b\u5efa\u521d\u59cb <code>Deployment</code>\uff0c\u4fee\u6539 <code>Deployment</code> \u4f7f\u7528 <code>Recreate</code> \u7b56\u7565\u5e76\u66f4\u65b0\u955c\u50cf\u7248\u672c\uff0c\u7136\u540e\u91cd\u65b0\u5e94\u7528\u914d\u7f6e\uff0c\u9a8c\u8bc1\u66f4\u65b0\u8fc7\u7a0b\u548c\u5e94\u7528\u670d\u52a1\u53ef\u7528\u6027\u3002</li> </ul> <p>\u5982\u679c\u4f60\u6709\u5176\u4ed6\u95ee\u9898\u6216\u9700\u8981\u66f4\u8be6\u7ec6\u7684\u6307\u5bfc\uff0c\u6b22\u8fce\u7ee7\u7eed\u63d0\u95ee\uff01</p>"},{"location":"devops/K8s_3.html#533-blue-green-deployment","title":"5.3.3 \u84dd\u7eff\u90e8\u7f72\uff08Blue-Green Deployment\uff09","text":"<p>\u84dd\u7eff\u90e8\u7f72 \u662f\u4e00\u79cd\u5e76\u884c\u90e8\u7f72\u7684\u65b0\u7248\u672c\u548c\u65e7\u7248\u672c\u7b56\u7565\u3002\u84dd\u7eff\u90e8\u7f72\u901a\u5e38\u4e0d\u4f1a\u76f4\u63a5\u901a\u8fc7 <code>Deployment</code> \u63a7\u5236\u5668\u5b9e\u73b0\uff0c\u800c\u662f\u7ed3\u5408 Kubernetes \u7684 Service \u548c\u4e00\u4e9b\u989d\u5916\u7684\u7ba1\u7406\u5de5\u5177\u5b9e\u73b0\u3002</p> <ul> <li>\u539f\u7406\uff1a\u84dd\u7eff\u90e8\u7f72\u4e2d\uff0c\u4f60\u7ef4\u62a4\u4e24\u4e2a\u73af\u5883\uff1a<code>\u84dd</code>\u4ee3\u8868\u65e7\u73af\u5883\uff0c<code>\u7eff</code>\u4ee3\u8868\u65b0\u73af\u5883\u3002\u5728\u65b0\u7248\u672c\u5c31\u7eea\u5e76\u901a\u8fc7\u6d4b\u8bd5\u540e\uff0c\u53ea\u9700\u5c06\u670d\u52a1\u7684\u6d41\u91cf\u5207\u6362\u5230\u65b0\u7248\u672c\u5373\u53ef\u3002</li> <li>\u6b65\u9aa4\uff1a</li> <li>\u521b\u5efa\u4e0e\u65e7\u7248\u672c\u76f8\u540c\u7684\u65b0\u7248\u672c <code>Deployment</code>\uff08\u4f8b\u5982 <code>blue</code> \u4e3a\u5f53\u524d\u7248\u672c\uff0c<code>green</code> \u4e3a\u65b0\u7248\u672c\uff09\u3002</li> <li>\u4f7f\u7528 Kubernetes <code>Service</code> \u6765\u5173\u8054\u8fd9\u4e24\u4e2a\u7248\u672c\u7684 <code>Deployment</code>\u3002</li> <li>\u9a8c\u8bc1\u65b0\u7248\u672c\u540e\uff0c\u901a\u8fc7\u66f4\u6539 <code>Service</code> \u7684\u9009\u62e9\u5668\uff0c\u5c06\u6d41\u91cf\u4ece\u65e7\u7248\u672c\u5207\u6362\u5230\u65b0\u7248\u672c\u3002</li> </ul> <p>\u84dd\u7eff\u90e8\u7f72\u7684\u4f18\u52bf\u5728\u4e8e\u53ef\u4ee5\u66f4\u5feb\u5730\u56de\u6eda\uff0c\u56e0\u4e3a\u4f60\u53ea\u9700\u8981\u628a\u6d41\u91cf\u5207\u56de\u65e7\u7248\u672c\u3002</p> <p>\u5f53\u7136\uff0c\u4ee5\u4e0b\u662f\u5982\u4f55\u5728 Kubernetes \u4e2d\u5b9e\u73b0\u84dd\u7eff\u90e8\u7f72\u7684\u8be6\u7ec6\u6b65\u9aa4\u3002\u84dd\u7eff\u90e8\u7f72\u7684\u57fa\u672c\u601d\u60f3\u662f\u5728\u96c6\u7fa4\u4e2d\u7ef4\u62a4\u4e24\u4e2a\u73af\u5883\uff08\u4f8b\u5982 \"\u84dd\" \u548c \"\u7eff\"\uff09\uff0c\u540c\u65f6\u8fd0\u884c\u65e7\u7248\u672c\u548c\u65b0\u7248\u672c\u3002\u5f53\u65b0\u7248\u672c\u9a8c\u8bc1\u901a\u8fc7\u540e\uff0c\u901a\u8fc7 Kubernetes \u7684 <code>Service</code> \u5c06\u6d41\u91cf\u4ece\u65e7\u7248\u672c\u5207\u6362\u5230\u65b0\u7248\u672c\uff0c\u8fd9\u6837\u53ef\u4ee5\u786e\u4fdd\u66f4\u65b0\u8fc7\u7a0b\u4e2d\u7684\u670d\u52a1\u5e73\u6ed1\u4e14\u98ce\u9669\u8f83\u4f4e\u3002</p>"},{"location":"devops/K8s_3.html#_5","title":"\u84dd\u7eff\u90e8\u7f72\u8be6\u7ec6\u6b65\u9aa4","text":""},{"location":"devops/K8s_3.html#_6","title":"\u5047\u8bbe\u573a\u666f","text":"<ul> <li>\u84dd\u73af\u5883\uff08Blue Environment\uff09\uff1a\u5f53\u524d\u7a33\u5b9a\u7684\u7248\u672c\uff0c\u547d\u540d\u4e3a <code>blue-deployment</code>\uff0c\u4f8b\u5982\uff0c\u8fd0\u884c <code>nginx:1.19</code>\u3002</li> <li>\u7eff\u73af\u5883\uff08Green Environment\uff09\uff1a\u65b0\u7248\u672c\u73af\u5883\uff0c\u547d\u540d\u4e3a <code>green-deployment</code>\uff0c\u4f8b\u5982\uff0c\u8fd0\u884c <code>nginx:1.20</code>\u3002</li> <li>\u4f7f\u7528\u4e00\u4e2a Kubernetes Service \u6765\u8def\u7531\u6d41\u91cf\u5230\u5f53\u524d\u6d3b\u52a8\u7684\u73af\u5883\u3002</li> </ul>"},{"location":"devops/K8s_3.html#1blue-deployment","title":"\u6b65\u9aa4 1\uff1a\u521b\u5efa\u84dd\u8272\u73af\u5883\uff08Blue Deployment\uff09","text":"<p>\u9996\u5148\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u5305\u542b <code>nginx</code> \u955c\u50cf\u7684 <code>Deployment</code>\uff0c\u4ee3\u8868\u5f53\u524d\u751f\u4ea7\u73af\u5883\uff0c\u5373 \"\u84dd\u8272\u73af\u5883\"\u3002</p> <p>1.1. \u521b\u5efa <code>blue-deployment.yaml</code> \u6587\u4ef6</p> <p><code>yaml apiVersion: apps/v1 kind: Deployment metadata:   name: blue-deployment   labels:     app: myapp     environment: blue spec:   replicas: 3   selector:     matchLabels:       app: myapp       environment: blue   template:     metadata:       labels:         app: myapp         environment: blue     spec:       containers:       - name: nginx         image: nginx:1.19         ports:         - containerPort: 80</code></p> <p>1.2. \u5e94\u7528\u84dd\u8272\u73af\u5883 <code>Deployment</code> \u914d\u7f6e</p> <p>\u4f7f\u7528 <code>kubectl</code> \u547d\u4ee4\u6765\u5e94\u7528\u914d\u7f6e\u6587\u4ef6\uff1a</p> <p><code>bash kubectl apply -f blue-deployment.yaml</code></p> <p>1.3. \u521b\u5efa\u84dd\u8272\u73af\u5883\u7684 Service</p> <p>\u63a5\u4e0b\u6765\u521b\u5efa\u4e00\u4e2a <code>Service</code>\uff0c\u5c06\u6d41\u91cf\u8def\u7531\u5230\u5f53\u524d\u7684\u84dd\u8272\u73af\u5883\uff1a</p> <p>\u521b\u5efa <code>service.yaml</code> \u6587\u4ef6</p> <p><code>yaml apiVersion: v1 kind: Service metadata:   name: myapp-service spec:   selector:     app: myapp     environment: blue   ports:     - protocol: TCP       port: 80       targetPort: 80   type: LoadBalancer</code></p> <ul> <li>selector\uff1a\u5c06\u6d41\u91cf\u8def\u7531\u5230\u5177\u6709\u6807\u7b7e <code>app: myapp</code> \u548c <code>environment: blue</code> \u7684 Pod \u4e0a\u3002</li> </ul> <p>\u5e94\u7528 Service \u914d\u7f6e</p> <p><code>bash kubectl apply -f service.yaml</code></p>"},{"location":"devops/K8s_3.html#2green-deployment","title":"\u6b65\u9aa4 2\uff1a\u521b\u5efa\u7eff\u8272\u73af\u5883\uff08Green Deployment\uff09","text":"<p>\u7eff\u8272\u73af\u5883\u4ee3\u8868\u8981\u90e8\u7f72\u7684\u65b0\u7248\u672c\uff0c\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 <code>Deployment</code>\uff0c\u4f7f\u7528\u66f4\u9ad8\u7248\u672c\u7684 <code>nginx</code> \u955c\u50cf\u3002</p> <p>2.1. \u521b\u5efa <code>green-deployment.yaml</code> \u6587\u4ef6</p> <p><code>yaml apiVersion: apps/v1 kind: Deployment metadata:   name: green-deployment   labels:     app: myapp     environment: green spec:   replicas: 3   selector:     matchLabels:       app: myapp       environment: green   template:     metadata:       labels:         app: myapp         environment: green     spec:       containers:       - name: nginx         image: nginx:1.20         ports:         - containerPort: 80</code></p> <p>2.2. \u5e94\u7528\u7eff\u8272\u73af\u5883 <code>Deployment</code> \u914d\u7f6e</p> <p><code>bash kubectl apply -f green-deployment.yaml</code></p>"},{"location":"devops/K8s_3.html#3green-deployment","title":"\u6b65\u9aa4 3\uff1a\u9a8c\u8bc1\u7eff\u8272\u73af\u5883\uff08Green Deployment\uff09","text":"<p>\u5728\u5c06\u6d41\u91cf\u5207\u6362\u5230\u7eff\u8272\u73af\u5883\u4e4b\u524d\uff0c\u9700\u8981\u9a8c\u8bc1\u65b0\u7248\u672c\u7684\u8fd0\u884c\u72b6\u51b5\uff0c\u786e\u4fdd\u5b83\u6b63\u5e38\u5de5\u4f5c\u3002</p> <p>3.1. \u9a8c\u8bc1 Pod \u72b6\u6001</p> <p>\u67e5\u770b\u7eff\u8272\u73af\u5883\u7684 Pod \u662f\u5426\u6b63\u5e38\u8fd0\u884c\uff1a</p> <p><code>bash kubectl get pods -l app=myapp,environment=green</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <p><code>plaintext NAME                                READY   STATUS    RESTARTS   AGE green-deployment-6c8f8d5b6c-1abc    1/1     Running   0          1m green-deployment-6c8f8d5b6c-2def    1/1     Running   0          1m green-deployment-6c8f8d5b6c-3ghi    1/1     Running   0          1m</code></p> <p>3.2. \u8fdb\u884c\u6d4b\u8bd5</p> <p>\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u4e34\u65f6\u7aef\u53e3\u66b4\u9732\u670d\u52a1\uff0c\u6216\u8005\u901a\u8fc7 <code>kubectl port-forward</code> \u547d\u4ee4\u8bbf\u95ee\u65b0\u7248\u672c\u7684\u670d\u52a1\u8fdb\u884c\u6d4b\u8bd5\uff1a</p> <p><code>bash kubectl port-forward deployment/green-deployment 8080:80</code></p> <p>\u8bbf\u95ee <code>http://localhost:8080</code> \u786e\u8ba4\u65b0\u7248\u672c\u662f\u5426\u6b63\u5e38\u5de5\u4f5c\u3002</p>"},{"location":"devops/K8s_3.html#4-service","title":"\u6b65\u9aa4 4\uff1a\u5207\u6362 Service \u9009\u62e9\u5668\u5230\u7eff\u8272\u73af\u5883","text":"<p>\u4e00\u65e6\u7eff\u8272\u73af\u5883\u88ab\u9a8c\u8bc1\u6b63\u5e38\uff0c\u53ef\u4ee5\u901a\u8fc7\u66f4\u6539 <code>Service</code> \u7684\u9009\u62e9\u5668\u5c06\u6d41\u91cf\u5207\u6362\u5230\u7eff\u8272\u73af\u5883\u3002</p> <p>4.1. \u4fee\u6539 <code>service.yaml</code></p> <p>\u5c06 <code>service.yaml</code> \u6587\u4ef6\u4e2d\u7684\u9009\u62e9\u5668\u4fee\u6539\u4e3a\u7eff\u8272\u73af\u5883\u7684\u6807\u7b7e\uff1a</p> <p><code>yaml apiVersion: v1 kind: Service metadata:   name: myapp-service spec:   selector:     app: myapp     environment: green  # \u5207\u6362\u5230\u7eff\u8272\u73af\u5883   ports:     - protocol: TCP       port: 80       targetPort: 80   type: LoadBalancer</code></p> <p>4.2. \u91cd\u65b0\u5e94\u7528 Service</p> <p><code>bash kubectl apply -f service.yaml</code></p> <p>\u6b64\u65f6\uff0c<code>Service</code> \u4f1a\u5c06\u6240\u6709\u6d41\u91cf\u8def\u7531\u5230\u7eff\u8272\u73af\u5883\u7684 Pod\u3002</p>"},{"location":"devops/K8s_3.html#5_1","title":"\u6b65\u9aa4 5\uff1a\u9a8c\u8bc1\u5207\u6362\u540e\u7684\u670d\u52a1","text":"<p>\u68c0\u67e5\u670d\u52a1\u662f\u5426\u6210\u529f\u5207\u6362\u5230\u7eff\u8272\u73af\u5883\uff1a</p> <p><code>bash kubectl get service myapp-service</code></p> <p>\u4f60\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee <code>Service</code> \u7684\u5916\u90e8\u5730\u5740\u9a8c\u8bc1\u670d\u52a1\u662f\u5426\u6b63\u5e38\u5de5\u4f5c\uff0c\u4ee5\u53ca\u662f\u5426\u5207\u6362\u5230\u4e86\u7eff\u8272\u73af\u5883\u3002</p>"},{"location":"devops/K8s_3.html#6","title":"\u6b65\u9aa4 6\uff1a\u5220\u9664\u84dd\u8272\u73af\u5883\uff08\u53ef\u9009\uff09","text":"<p>\u4e00\u65e6\u7eff\u8272\u73af\u5883\u7a33\u5b9a\u8fd0\u884c\u5e76\u4e14\u9a8c\u8bc1\u901a\u8fc7\uff0c\u84dd\u8272\u73af\u5883\u7684 <code>Deployment</code> \u5c31\u53ef\u4ee5\u5220\u9664\u4ee5\u91ca\u653e\u8d44\u6e90\uff1a</p> <p><code>bash kubectl delete deployment blue-deployment</code></p> <p>\u5982\u679c\u9700\u8981\u5feb\u901f\u56de\u6eda\uff0c\u53ea\u9700\u5c06 <code>Service</code> \u7684\u9009\u62e9\u5668\u6539\u56de <code>blue</code> \u5373\u53ef\uff0c\u65e0\u9700\u7acb\u5373\u5220\u9664\u84dd\u8272\u73af\u5883\uff0c\u8fd9\u4e5f\u662f\u84dd\u7eff\u90e8\u7f72\u7684\u4e00\u4e2a\u4f18\u52bf\u3002</p>"},{"location":"devops/K8s_3.html#_7","title":"\u603b\u7ed3","text":"<ul> <li>\u84dd\u7eff\u90e8\u7f72\u662f\u901a\u8fc7\u521b\u5efa\u4e24\u4e2a\u72ec\u7acb\u7684\u73af\u5883\uff08\u4f8b\u5982\u84dd\u8272\u73af\u5883\u548c\u7eff\u8272\u73af\u5883\uff09\u6765\u5b9e\u73b0\u5e94\u7528\u7a0b\u5e8f\u7684\u65b0\u7248\u672c\u53d1\u5e03\u3002</li> <li>\u5173\u952e\u6b65\u9aa4\uff1a</li> <li>\u521b\u5efa\u65e7\u7248\u672c\u7684 <code>Deployment</code>\uff08\u84dd\u8272\u73af\u5883\uff09\u548c\u5bf9\u5e94\u7684 <code>Service</code>\u3002</li> <li>\u90e8\u7f72\u65b0\u7248\u672c\u7684 <code>Deployment</code>\uff08\u7eff\u8272\u73af\u5883\uff09\u3002</li> <li>\u9a8c\u8bc1\u65b0\u7248\u672c\u73af\u5883\u662f\u5426\u8fd0\u884c\u6b63\u5e38\u3002</li> <li>\u4fee\u6539 <code>Service</code> \u7684\u9009\u62e9\u5668\uff0c\u5c06\u6d41\u91cf\u5207\u6362\u5230\u7eff\u8272\u73af\u5883\u3002</li> <li>\u786e\u8ba4\u5207\u6362\u6210\u529f\u540e\uff0c\u53ef\u4ee5\u9009\u62e9\u5220\u9664\u65e7\u7248\u672c\u7684 <code>Deployment</code>\u3002</li> <li>\u4f18\u52bf\uff1a\u84dd\u7eff\u90e8\u7f72\u7684\u6700\u5927\u4f18\u52bf\u5728\u4e8e\u66f4\u5feb\u7684\u56de\u6eda\u548c\u670d\u52a1\u7684\u5e73\u6ed1\u5207\u6362\u3002\u5982\u679c\u65b0\u7248\u672c\u51fa\u73b0\u95ee\u9898\uff0c\u53ea\u9700\u5c06 <code>Service</code> \u7684\u9009\u62e9\u5668\u5207\u56de\u65e7\u7248\u672c\u5373\u53ef\u5feb\u901f\u6062\u590d\u3002</li> </ul> <p>\u5982\u679c\u4f60\u8fd8\u6709\u4efb\u4f55\u5176\u4ed6\u95ee\u9898\u6216\u9700\u8981\u66f4\u8be6\u7ec6\u7684\u89e3\u91ca\uff0c\u6b22\u8fce\u7ee7\u7eed\u8ba8\u8bba\uff01</p>"},{"location":"devops/K8s_3.html#534-canary-deployment","title":"5.3.4 \u91d1\u4e1d\u96c0\u90e8\u7f72\uff08Canary Deployment\uff09","text":"<p>\u91d1\u4e1d\u96c0\u90e8\u7f72 \u662f\u4e00\u79cd\u6e10\u8fdb\u5f0f\u7684\u66f4\u65b0\u7b56\u7565\uff0c\u76ee\u7684\u662f\u5c06\u65b0\u7248\u672c\u7684\u4ee3\u7801\u9010\u6e10\u5f15\u5165\u5230\u751f\u4ea7\u73af\u5883\u4e2d\u3002</p> <ul> <li>\u539f\u7406\uff1a\u5728\u521d\u59cb\u9636\u6bb5\uff0c\u9996\u5148\u5c06\u5c11\u91cf\u6d41\u91cf\u5f15\u5bfc\u5230\u65b0\u7248\u672c\u4e2d\u3002\u5982\u679c\u6ca1\u6709\u53d1\u73b0\u95ee\u9898\uff0c\u5219\u9010\u6b65\u589e\u52a0\u65b0\u7248\u672c\u7684\u6d41\u91cf\u5206\u914d\uff0c\u76f4\u5230\u65b0\u7248\u672c\u5b8c\u5168\u66ff\u4ee3\u65e7\u7248\u672c\u3002</li> <li>\u6b65\u9aa4\uff1a</li> <li>\u5728\u73b0\u6709 <code>Deployment</code> \u7684\u57fa\u7840\u4e0a\u90e8\u7f72\u4e00\u90e8\u5206\u65b0\u7248\u672c\u7684 Pod\uff0c\u4fdd\u6301\u5927\u90e8\u5206\u6d41\u91cf\u4ecd\u7136\u6307\u5411\u65e7\u7248\u672c\u3002</li> <li>\u9010\u6b65\u589e\u52a0\u65b0\u7248\u672c\u7684\u526f\u672c\u6570\uff0c\u76f4\u5230\u5b8c\u6210\u66f4\u65b0\u3002</li> </ul> <p>\u8fd9\u79cd\u65b9\u5f0f\u6709\u52a9\u4e8e\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u63d0\u524d\u53d1\u73b0\u6f5c\u5728\u7684\u95ee\u9898\uff0c\u5e76\u5c06\u5176\u5bf9\u7528\u6237\u7684\u5f71\u54cd\u6700\u5c0f\u5316\u3002</p> <p>\u91d1\u4e1d\u96c0\u90e8\u7f72\u53ef\u4ee5\u901a\u8fc7\u624b\u52a8\u8c03\u6574 <code>Deployment</code> \u7684\u526f\u672c\u6570\u6765\u5b9e\u73b0\uff0c\u6216\u8005\u4f7f\u7528\u4e13\u95e8\u7684 CI/CD \u5de5\u5177\uff08\u5982 Argo Rollouts\u3001Spinnaker \u7b49\uff09\u6765\u5b9e\u73b0\u81ea\u52a8\u5316\u7684\u91d1\u4e1d\u96c0\u90e8\u7f72\u3002</p> <p>\u91d1\u4e1d\u96c0\u90e8\u7f72\uff08Canary Deployment\uff09\u662f\u4e00\u79cd\u7a33\u59a5\u7684\u53d1\u5e03\u7b56\u7565\uff0c\u901a\u8fc7\u5c06\u65b0\u7248\u672c\u7684\u66f4\u65b0\u9010\u6e10\u5f15\u5165\u751f\u4ea7\u73af\u5883\uff0c\u53ef\u4ee5\u5728\u5c0f\u8303\u56f4\u5185\u9a8c\u8bc1\u65b0\u7248\u672c\u7684\u7a33\u5b9a\u6027\uff0c\u51cf\u5c11\u66f4\u65b0\u98ce\u9669\u3002\u4ee5\u4e0b\u662f\u5982\u4f55\u5728 Kubernetes \u4e2d\u5b9e\u73b0\u91d1\u4e1d\u96c0\u90e8\u7f72\u7684\u8be6\u7ec6\u6b65\u9aa4\u3002</p>"},{"location":"devops/K8s_3.html#_8","title":"\u91d1\u4e1d\u96c0\u90e8\u7f72\u7684\u8be6\u7ec6\u6b65\u9aa4","text":""},{"location":"devops/K8s_3.html#_9","title":"\u5047\u8bbe\u573a\u666f","text":"<p>\u6211\u4eec\u6709\u4e00\u4e2a\u73b0\u6709\u7684 <code>Deployment</code>\uff0c\u4f7f\u7528\u955c\u50cf\u7248\u672c\u4e3a <code>nginx:1.19</code>\uff0c\u5b83\u4ee3\u8868\u5f53\u524d\u7684\u751f\u4ea7\u73af\u5883\u3002\u6211\u4eec\u9700\u8981\u5c06\u8be5 <code>Deployment</code> \u66f4\u65b0\u5230 <code>nginx:1.20</code>\uff0c\u5e76\u91c7\u7528\u91d1\u4e1d\u96c0\u90e8\u7f72\u7684\u65b9\u5f0f\u9010\u6b65\u5f15\u5165\u65b0\u7248\u672c\u3002</p> <ul> <li>\u91d1\u4e1d\u96c0 Pod\uff1a\u5c11\u91cf\u65b0\u7248\u672c Pod\uff0c\u7528\u4e8e\u6d4b\u8bd5\u65b0\u7248\u672c\u3002</li> <li>\u6e10\u8fdb\u5f0f\uff1a\u6839\u636e\u60c5\u51b5\u9010\u6b65\u589e\u52a0\u65b0\u7248\u672c\u7684\u6d41\u91cf\uff0c\u6700\u7ec8\u5168\u90e8\u66ff\u6362\u65e7\u7248\u672c\u3002</li> </ul>"},{"location":"devops/K8s_3.html#1-deployment_3","title":"\u6b65\u9aa4 1\uff1a\u521b\u5efa\u65e7\u7248\u672c Deployment\uff08\u5f53\u524d\u7248\u672c\uff09","text":"<p>\u9996\u5148\uff0c\u521b\u5efa\u5e76\u90e8\u7f72\u5f53\u524d\u751f\u4ea7\u73af\u5883\u7684 <code>Deployment</code>\u3002</p> <p>1.1. \u521b\u5efa <code>current-deployment.yaml</code> \u6587\u4ef6</p> <p><code>yaml apiVersion: apps/v1 kind: Deployment metadata:   name: myapp-deployment   labels:     app: myapp spec:   replicas: 5   selector:     matchLabels:       app: myapp       version: v1   template:     metadata:       labels:         app: myapp         version: v1     spec:       containers:       - name: nginx         image: nginx:1.19         ports:         - containerPort: 80</code></p> <p>1.2. \u5e94\u7528 <code>Deployment</code> \u914d\u7f6e</p> <p><code>bash kubectl apply -f current-deployment.yaml</code></p>"},{"location":"devops/K8s_3.html#2-deployment_1","title":"\u6b65\u9aa4 2\uff1a\u521b\u5efa\u91d1\u4e1d\u96c0\u7248\u672c Deployment\uff08\u65b0\u7248\u672c\uff09","text":"<p>\u91d1\u4e1d\u96c0\u7248\u672c\u7684 <code>Deployment</code> \u901a\u5e38\u4f1a\u6709\u5c11\u91cf\u7684 Pod\uff0c\u8fd9\u6837\u53ef\u4ee5\u5c06\u90e8\u5206\u6d41\u91cf\u8def\u7531\u5230\u65b0\u7248\u672c\uff0c\u8fdb\u884c\u5c0f\u8303\u56f4\u6d4b\u8bd5\u3002</p> <p>2.1. \u521b\u5efa <code>canary-deployment.yaml</code> \u6587\u4ef6</p> <p><code>yaml apiVersion: apps/v1 kind: Deployment metadata:   name: myapp-canary   labels:     app: myapp spec:   replicas: 1   selector:     matchLabels:       app: myapp       version: canary   template:     metadata:       labels:         app: myapp         version: canary     spec:       containers:       - name: nginx         image: nginx:1.20         ports:         - containerPort: 80</code></p> <ul> <li>replicas\uff1a\u91d1\u4e1d\u96c0\u7248\u672c\u7684\u526f\u672c\u6570\u91cf\u8bbe\u7f6e\u4e3a <code>1</code>\uff0c\u7528\u6765\u6d4b\u8bd5\u65b0\u7248\u672c\u3002</li> <li>version: canary\uff1a\u4f7f\u7528\u6807\u7b7e\u6807\u8bc6\u8fd9\u4e2a\u662f\u91d1\u4e1d\u96c0\u7248\u672c\u7684 Pod\u3002</li> </ul> <p>2.2. \u5e94\u7528\u91d1\u4e1d\u96c0\u7248\u672c\u7684 <code>Deployment</code></p> <p><code>bash kubectl apply -f canary-deployment.yaml</code></p>"},{"location":"devops/K8s_3.html#3-service","title":"\u6b65\u9aa4 3\uff1a\u521b\u5efa Service \u8fdb\u884c\u6d41\u91cf\u5206\u914d","text":"<p>\u91d1\u4e1d\u96c0\u90e8\u7f72\u9700\u8981\u4e00\u4e2a <code>Service</code> \u6765\u5c06\u6d41\u91cf\u5206\u914d\u5230\u65e7\u7248\u672c\u548c\u65b0\u7248\u672c\u4e0a\u3002</p> <p>3.1. \u521b\u5efa <code>service.yaml</code> \u6587\u4ef6</p> <p><code>yaml apiVersion: v1 kind: Service metadata:   name: myapp-service spec:   selector:     app: myapp   ports:     - protocol: TCP       port: 80       targetPort: 80   type: LoadBalancer</code></p> <p>3.2. \u5e94\u7528 Service \u914d\u7f6e</p> <p><code>bash kubectl apply -f service.yaml</code></p>"},{"location":"devops/K8s_3.html#4_3","title":"\u6b65\u9aa4 4\uff1a\u9a8c\u8bc1\u91d1\u4e1d\u96c0\u7248\u672c\uff08\u6d4b\u8bd5\u65b0\u7248\u672c\uff09","text":"<p>4.1. \u67e5\u770b Pod \u7684\u72b6\u6001</p> <p>\u9a8c\u8bc1\u91d1\u4e1d\u96c0\u7248\u672c\u548c\u65e7\u7248\u672c\u7684 Pod \u662f\u5426\u6b63\u5e38\u8fd0\u884c\uff1a</p> <p><code>bash kubectl get pods -l app=myapp</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <p><code>plaintext NAME                               READY   STATUS    RESTARTS   AGE myapp-deployment-5f99d67b7f-abc    1/1     Running   0          10m myapp-deployment-5f99d67b7f-def    1/1     Running   0          10m myapp-deployment-5f99d67b7f-ghi    1/1     Running   0          10m myapp-canary-7fbbd9cccd-jkl        1/1     Running   0          2m</code></p> <ul> <li>\u8fd9\u91cc\u6709 5 \u4e2a\u65e7\u7248\u672c\u7684 Pod\uff08<code>myapp-deployment</code>\uff09\u548c 1 \u4e2a\u91d1\u4e1d\u96c0\u7248\u672c\u7684 Pod\uff08<code>myapp-canary</code>\uff09\u3002</li> </ul> <p>4.2. \u9a8c\u8bc1\u670d\u52a1\u662f\u5426\u6b63\u5e38</p> <p>\u901a\u8fc7\u8bbf\u95ee <code>Service</code> \u7684\u5916\u90e8\u5730\u5740\uff0c\u53ef\u4ee5\u67e5\u770b\u91d1\u4e1d\u96c0\u7248\u672c\u662f\u5426\u6b63\u5e38\u5de5\u4f5c\uff0c\u5e76\u901a\u8fc7\u89c2\u5bdf\u8bf7\u6c42\u8fd4\u56de\u7ed3\u679c\u786e\u8ba4\u65e7\u7248\u672c\u4e0e\u65b0\u7248\u672c\u7684\u884c\u4e3a\u662f\u5426\u4e00\u81f4\u3002</p>"},{"location":"devops/K8s_3.html#5_2","title":"\u6b65\u9aa4 5\uff1a\u9010\u6b65\u589e\u52a0\u91d1\u4e1d\u96c0\u7248\u672c\u6d41\u91cf","text":"<p>\u5982\u679c\u91d1\u4e1d\u96c0\u7248\u672c\u8fd0\u884c\u6b63\u5e38\u5e76\u4e14\u901a\u8fc7\u4e86\u6d4b\u8bd5\uff0c\u53ef\u4ee5\u9010\u6b65\u589e\u52a0\u65b0\u7248\u672c\u7684\u526f\u672c\u6570\u91cf\uff0c\u76f4\u5230\u65b0\u7248\u672c\u66ff\u4ee3\u6240\u6709\u65e7\u7248\u672c\u3002</p> <p>5.1. \u589e\u52a0\u91d1\u4e1d\u96c0\u7248\u672c\u7684\u526f\u672c\u6570</p> <p>\u66f4\u65b0 <code>canary-deployment.yaml</code> \u6587\u4ef6\u4e2d\u7684\u526f\u672c\u6570\uff0c\u5c06 <code>replicas</code> \u589e\u52a0\u4e3a <code>3</code>\uff0c\u7136\u540e\u91cd\u65b0\u5e94\u7528\u914d\u7f6e\uff1a</p> <p><code>yaml apiVersion: apps/v1 kind: Deployment metadata:   name: myapp-canary   labels:     app: myapp spec:   replicas: 3   selector:     matchLabels:       app: myapp       version: canary   template:     metadata:       labels:         app: myapp         version: canary     spec:       containers:       - name: nginx         image: nginx:1.20         ports:         - containerPort: 80</code></p> <p>\u5e94\u7528\u66f4\u65b0\u540e\u7684\u914d\u7f6e\uff1a</p> <p><code>bash kubectl apply -f canary-deployment.yaml</code></p> <p>5.2. \u67e5\u770b Pod \u7684\u72b6\u6001</p> <p>\u518d\u6b21\u67e5\u770b\u91d1\u4e1d\u96c0\u7248\u672c\u548c\u65e7\u7248\u672c\u7684 Pod\uff1a</p> <p><code>bash kubectl get pods -l app=myapp</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <p><code>plaintext NAME                               READY   STATUS    RESTARTS   AGE myapp-deployment-5f99d67b7f-abc    1/1     Running   0          15m myapp-deployment-5f99d67b7f-def    1/1     Running   0          15m myapp-canary-7fbbd9cccd-jkl        1/1     Running   0          7m myapp-canary-7fbbd9cccd-mno        1/1     Running   0          1m myapp-canary-7fbbd9cccd-pqr        1/1     Running   0          1m</code></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u91d1\u4e1d\u96c0\u7248\u672c\u7684 Pod \u5df2\u589e\u52a0\u5230 <code>3</code> \u4e2a\u3002</p>"},{"location":"devops/K8s_3.html#6_1","title":"\u6b65\u9aa4 6\uff1a\u5b8c\u6210\u66f4\u65b0\u5e76\u66ff\u6362\u65e7\u7248\u672c","text":"<p>\u4e00\u65e6\u786e\u8ba4\u91d1\u4e1d\u96c0\u7248\u672c\u7a33\u5b9a\uff0c\u5b8c\u5168\u53ef\u4ee5\u66ff\u4ee3\u65e7\u7248\u672c\u65f6\uff0c\u53ef\u4ee5\u5c06\u91d1\u4e1d\u96c0\u7248\u672c\u7684\u526f\u672c\u6570\u91cf\u589e\u52a0\u5230 5\uff08\u6216\u66f4\u591a\uff09\uff0c\u540c\u65f6\u5220\u9664\u65e7\u7248\u672c\u7684 <code>Deployment</code>\uff0c\u4ee5\u5b8c\u6210\u65b0\u7248\u672c\u7684\u66ff\u6362\u3002</p> <p>6.1. \u589e\u52a0\u91d1\u4e1d\u96c0\u7248\u672c\u7684\u526f\u672c\u6570\u5230 <code>5</code></p> <p>\u4fee\u6539 <code>canary-deployment.yaml</code> \u6587\u4ef6\uff0c\u5c06\u526f\u672c\u6570\u6539\u4e3a <code>5</code>\uff0c\u5e76\u91cd\u65b0\u5e94\u7528\uff1a</p> <p><code>yaml spec:   replicas: 5</code></p> <p><code>bash kubectl apply -f canary-deployment.yaml</code></p> <p>6.2. \u5220\u9664\u65e7\u7248\u672c Deployment</p> <p><code>bash kubectl delete deployment myapp-deployment</code></p> <p>\u6b64\u65f6\uff0c\u65b0\u7248\u672c\u7684 <code>Deployment</code>\uff08\u5373\u91d1\u4e1d\u96c0\u7248\u672c\uff09\u5b8c\u5168\u66ff\u4ee3\u4e86\u65e7\u7248\u672c\u7684 Pod\u3002</p>"},{"location":"devops/K8s_3.html#_10","title":"\u603b\u7ed3","text":"<ul> <li>\u91d1\u4e1d\u96c0\u90e8\u7f72 \u662f\u4e00\u79cd\u9010\u6b65\u5f15\u5165\u65b0\u7248\u672c\u5e76\u76d1\u63a7\u5176\u6027\u80fd\u548c\u7a33\u5b9a\u6027\u7684\u7b56\u7565\u3002</li> <li>\u5173\u952e\u6b65\u9aa4\uff1a</li> <li>\u4fdd\u6301\u5f53\u524d\u751f\u4ea7\u73af\u5883\u7684 <code>Deployment</code> \u8fd0\u884c\uff0c\u521b\u5efa\u91d1\u4e1d\u96c0\u7248\u672c\u7684 <code>Deployment</code>\uff0c\u521d\u59cb\u526f\u672c\u6570\u91cf\u8f83\u5c11\u3002</li> <li>\u4f7f\u7528 <code>Service</code> \u4f7f\u6d41\u91cf\u540c\u65f6\u8fdb\u5165\u65e7\u7248\u672c\u548c\u91d1\u4e1d\u96c0\u7248\u672c\u3002</li> <li>\u6d4b\u8bd5\u65b0\u7248\u672c\uff0c\u5982\u679c\u65b0\u7248\u672c\u901a\u8fc7\u9a8c\u8bc1\uff0c\u9010\u6b65\u589e\u52a0\u5176\u526f\u672c\u6570\u91cf\u3002</li> <li>\u6700\u7ec8\u7528\u65b0\u7248\u672c\u5b8c\u5168\u66ff\u6362\u65e7\u7248\u672c\uff0c\u5b8c\u6210\u66f4\u65b0\u3002</li> <li>\u4f18\u70b9\uff1a\u53ef\u4ee5\u5728\u5c0f\u8303\u56f4\u5185\u9a8c\u8bc1\u65b0\u7248\u672c\u7684\u7a33\u5b9a\u6027\uff0c\u51cf\u5c11\u5bf9\u751f\u4ea7\u73af\u5883\u7684\u98ce\u9669\u3002</li> <li>\u6311\u6218\uff1a\u6d41\u91cf\u7684\u63a7\u5236\u548c\u76d1\u63a7\u53ef\u80fd\u9700\u8981\u66f4\u591a\u7684\u7ba1\u7406\u5de5\u5177\u548c\u7ec6\u7c92\u5ea6\u63a7\u5236\uff0c\u4f8b\u5982\u7ed3\u5408\u6d41\u91cf\u7ba1\u7406\u5de5\u5177\uff08\u5982 Istio\uff09\u6765\u5b9e\u73b0\u66f4\u7cbe\u51c6\u7684\u6d41\u91cf\u5206\u914d\u548c\u76d1\u63a7\u3002</li> </ul> <p>\u5982\u679c\u4f60\u6709\u4efb\u4f55\u5176\u4ed6\u95ee\u9898\u6216\u9700\u8981\u8fdb\u4e00\u6b65\u7684\u5e2e\u52a9\uff0c\u6b22\u8fce\u7ee7\u7eed\u63d0\u95ee\uff01</p>"},{"location":"devops/K8s_3.html#535-ab-testing","title":"5.3.5 \u5206\u6279\u53d1\u5e03\uff08A/B Testing\uff09","text":"<p>A/B \u6d4b\u8bd5 \u66f4\u65b0\u7c7b\u4f3c\u4e8e\u91d1\u4e1d\u96c0\u90e8\u7f72\uff0c\u4f46\u66f4\u5173\u6ce8\u4e8e\u65b0\u65e7\u7248\u672c\u7684\u5bf9\u6bd4\u6d4b\u8bd5\u548c\u6d41\u91cf\u5207\u5206\uff0c\u4e3b\u8981\u76ee\u7684\u662f\u6d4b\u8bd5\u4e24\u4e2a\u7248\u672c\u5728\u4e0d\u540c\u7528\u6237\u7fa4\u4f53\u4e2d\u7684\u8868\u73b0\u3002</p> <ul> <li>\u539f\u7406\uff1a\u901a\u8fc7 <code>Deployment</code> \u548c\u4e00\u4e9b\u8def\u7531\u63a7\u5236\u5de5\u5177\u6765\u63a7\u5236\u7279\u5b9a\u6d41\u91cf\u6307\u5411\u65b0\u7248\u672c\uff0c\u83b7\u53d6\u7528\u6237\u7684\u53cd\u9988\u6765\u8bc4\u4f30\u65b0\u7248\u672c\u7684\u6548\u679c\u3002</li> <li> <p>\u6b65\u9aa4\uff1a</p> </li> <li> <p>\u521b\u5efa\u4e24\u4e2a\u4e0d\u540c\u7248\u672c\u7684 <code>Deployment</code>\u3002</p> </li> <li>\u4f7f\u7528 Kubernetes \u4e4b\u5916\u7684\u8def\u7531\u5de5\u5177\uff08\u5982 Istio \u6216 NGINX\uff09\u5c06\u7528\u6237\u8bf7\u6c42\u6309\u7167\u6bd4\u4f8b\u8def\u7531\u5230\u4e0d\u540c\u7684\u7248\u672c\u3002</li> </ul> <p>A/B \u6d4b\u8bd5\uff08A/B Testing\uff09\u662f\u4e00\u79cd\u7528\u6765\u9a8c\u8bc1\u65b0\u65e7\u7248\u672c\u5728\u4e0d\u540c\u7528\u6237\u7fa4\u4f53\u4e2d\u7684\u8868\u73b0\u7684\u65b9\u6cd5\uff0c\u65e8\u5728\u8bc4\u4f30\u65b0\u529f\u80fd\u6216\u65b0\u7248\u672c\u7684\u6548\u679c\uff0c\u8fdb\u800c\u505a\u51fa\u51b3\u7b56\u3002\u8fd9\u79cd\u65b9\u5f0f\u975e\u5e38\u9002\u5408\u9700\u8981\u5bf9\u6bd4\u4e0d\u540c\u7248\u672c\u7684\u7528\u6237\u4f53\u9a8c\u6216\u529f\u80fd\u6539\u8fdb\u5bf9\u7528\u6237\u7fa4\u4f53\u4ea7\u751f\u5f71\u54cd\u7684\u573a\u666f\u3002\u5728 Kubernetes \u4e2d\uff0cA/B \u6d4b\u8bd5\u901a\u5e38\u7ed3\u5408 Service \u548c\u5916\u90e8\u6d41\u91cf\u63a7\u5236\u5de5\u5177\uff08\u5982 Istio\u3001NGINX\u3001Traefik\uff09\u6765\u5b9e\u73b0\u5bf9\u6d41\u91cf\u7684\u63a7\u5236\u3002</p> <p>\u4ee5\u4e0b\u662f\u5982\u4f55\u5728 Kubernetes \u4e2d\u5b9e\u73b0\u91d1\u4e1d\u96c0\u90e8\u7f72\u7684\u8be6\u7ec6\u6b65\u9aa4\u3002</p> <p>### A/B \u6d4b\u8bd5\u90e8\u7f72\u7684\u8be6\u7ec6\u6b65\u9aa4</p> <p>#### \u5047\u8bbe\u573a\u666f</p> <p>\u6211\u4eec\u6709\u4e00\u4e2a\u5f53\u524d\u7684\u7a33\u5b9a\u7248\u672c\uff0c\u79f0\u4e3a A \u7248\u672c\uff0c\u4f7f\u7528\u955c\u50cf <code>nginx:1.19</code>\u3002\u9700\u8981\u5c06\u8fd9\u4e2a <code>Deployment</code> \u7684\u4e00\u90e8\u5206\u6d41\u91cf\u5f15\u5bfc\u5230 B \u7248\u672c\uff0c\u5373\u65b0\u7248\u672c\u7684 <code>Deployment</code>\uff0c\u4f7f\u7528\u955c\u50cf <code>nginx:1.20</code>\uff0c\u6765\u5bf9\u6bd4\u65b0\u65e7\u7248\u672c\u7684\u8868\u73b0\u3002</p> <p>#### \u6b65\u9aa4 1\uff1a\u521b\u5efa A \u7248\u672c Deployment\uff08\u5f53\u524d\u7248\u672c\uff09</p> <p>\u9996\u5148\uff0c\u521b\u5efa\u5f53\u524d\u6b63\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u8fd0\u884c\u7684\u7a33\u5b9a\u7248\u672c A\u3002</p> <p>1.1. \u521b\u5efa <code>a-deployment.yaml</code> \u6587\u4ef6</p> <p><code>yaml   apiVersion: apps/v1   kind: Deployment   metadata:     name: a-deployment     labels:       app: myapp       version: a   spec:     replicas: 5     selector:       matchLabels:         app: myapp         version: a     template:       metadata:         labels:           app: myapp           version: a       spec:         containers:         - name: nginx           image: nginx:1.19           ports:           - containerPort: 80</code></p> <p>1.2. \u5e94\u7528 A \u7248\u672c\u7684 <code>Deployment</code> \u914d\u7f6e</p> <p><code>bash   kubectl apply -f a-deployment.yaml</code></p> <p>#### \u6b65\u9aa4 2\uff1a\u521b\u5efa B \u7248\u672c Deployment\uff08\u65b0\u7248\u672c\uff09</p> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u65b0\u7248\u672c B \u7684 <code>Deployment</code>\uff0c\u4f5c\u4e3a A/B \u6d4b\u8bd5\u7684\u65b0\u7248\u672c\u3002</p> <p>2.1. \u521b\u5efa <code>b-deployment.yaml</code> \u6587\u4ef6</p> <p><code>yaml   apiVersion: apps/v1   kind: Deployment   metadata:     name: b-deployment     labels:       app: myapp       version: b   spec:     replicas: 2     selector:       matchLabels:         app: myapp         version: b     template:       metadata:         labels:           app: myapp           version: b       spec:         containers:         - name: nginx           image: nginx:1.20           ports:           - containerPort: 80</code></p> <p>2.2. \u5e94\u7528 B \u7248\u672c\u7684 <code>Deployment</code> \u914d\u7f6e</p> <p><code>bash   kubectl apply -f b-deployment.yaml</code></p> <p>#### \u6b65\u9aa4 3\uff1a\u521b\u5efa Service</p> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2a Service\uff0c\u8be5 Service \u5c06\u4e0e A \u548c B \u4e24\u4e2a\u7248\u672c\u5173\u8054\uff0c\u7528\u4e8e\u5c06\u5916\u90e8\u6d41\u91cf\u8def\u7531\u5230\u5b83\u4eec\u3002</p> <p>3.1. \u521b\u5efa <code>service.yaml</code> \u6587\u4ef6</p> <p><code>yaml   apiVersion: v1   kind: Service   metadata:     name: myapp-service   spec:     selector:       app: myapp     ports:       - protocol: TCP         port: 80         targetPort: 80     type: LoadBalancer</code></p> <p>3.2. \u5e94\u7528 Service \u914d\u7f6e</p> <p><code>bash   kubectl apply -f service.yaml</code></p> <p>#### \u6b65\u9aa4 4\uff1a\u4f7f\u7528\u8def\u7531\u5de5\u5177\u63a7\u5236\u6d41\u91cf</p> <p>\u4e3a\u4e86\u5b9e\u73b0 A/B \u6d4b\u8bd5\uff0c\u6211\u4eec\u9700\u8981\u5c06\u4e00\u90e8\u5206\u6d41\u91cf\uff08\u4f8b\u5982 90%\uff09\u5f15\u5bfc\u5230 A \u7248\u672c\uff0c\u5176\u4f59\u6d41\u91cf\uff08\u4f8b\u5982 10%\uff09\u5f15\u5bfc\u5230 B \u7248\u672c\u3002\u8fd9\u9700\u8981\u4f7f\u7528\u6d41\u91cf\u8def\u7531\u63a7\u5236\u5de5\u5177\uff0c\u5982 Istio \u6216 NGINX\uff0c\u6765\u5b9e\u73b0\u8fd9\u79cd\u6d41\u91cf\u63a7\u5236\u3002</p> <p>##### \u4f7f\u7528 Istio \u5b9e\u73b0 A/B \u6d4b\u8bd5</p> <p>4.1. \u5b89\u88c5 Istio</p> <p>\u9996\u5148\u9700\u8981\u5728 Kubernetes \u96c6\u7fa4\u4e2d\u5b89\u88c5 Istio\uff0c\u53ef\u4ee5\u901a\u8fc7\u5b98\u65b9\u6587\u6863\u4e2d\u7684\u6307\u5357\u8fdb\u884c\u5b89\u88c5\uff1ahttps://istio.io/latest/docs/setup/getting-started/</p> <p>4.2. \u5b9a\u4e49\u865a\u62df\u670d\u52a1\uff08VirtualService\uff09</p> <p>Istio \u7684 <code>VirtualService</code> \u53ef\u4ee5\u7528\u4e8e\u63a7\u5236\u6d41\u91cf\u7684\u5206\u914d\u3002\u521b\u5efa\u4e00\u4e2a <code>virtualservice.yaml</code> \u6587\u4ef6\uff1a</p> <p><code>yaml   apiVersion: networking.istio.io/v1alpha3   kind: VirtualService   metadata:     name: myapp-virtualservice   spec:     hosts:     - \"*\"     gateways:     - myapp-gateway     http:     - route:       - destination:           host: a-deployment         weight: 90       - destination:           host: b-deployment         weight: 10</code></p> <ul> <li>hosts\uff1a\u6307\u5b9a\u5c06\u670d\u52a1\u8bf7\u6c42\u53d1\u9001\u5230\u54ea\u4e2a\u4e3b\u673a\uff0c\u8fd9\u91cc\u53ef\u4ee5\u662f <code>Service</code> \u7684\u540d\u79f0\u6216\u57df\u540d\u3002</li> <li>route\uff1a\u5b9a\u4e49\u6d41\u91cf\u7684\u5206\u914d\u6bd4\u4f8b\uff0c90% \u7684\u6d41\u91cf\u53d1\u9001\u5230 A \u7248\u672c\uff0c10% \u7684\u6d41\u91cf\u53d1\u9001\u5230 B \u7248\u672c\u3002</li> </ul> <p>4.3. \u521b\u5efa\u7f51\u5173\uff08Gateway\uff09</p> <p>\u4e3a\u4e86\u5141\u8bb8\u5916\u90e8\u8bbf\u95ee\u96c6\u7fa4\u5185\u7684\u670d\u52a1\uff0c\u8fd8\u9700\u8981\u521b\u5efa\u4e00\u4e2a Istio <code>Gateway</code>\uff1a</p> <p><code>yaml   apiVersion: networking.istio.io/v1alpha3   kind: Gateway   metadata:     name: myapp-gateway   spec:     selector:       istio: ingressgateway # \u4f7f\u7528 Istio \u7684 Ingress \u7f51\u5173     servers:     - port:         number: 80         name: http         protocol: HTTP       hosts:       - \"*\"</code></p> <p>4.4. \u5e94\u7528 Gateway \u548c VirtualService \u914d\u7f6e</p> <p><code>bash   kubectl apply -f gateway.yaml   kubectl apply -f virtualservice.yaml</code></p> <p>4.5. \u9a8c\u8bc1 A/B \u6d4b\u8bd5\u6d41\u91cf\u5206\u914d</p> <p>\u901a\u8fc7\u8bbf\u95ee <code>VirtualService</code> \u6307\u5b9a\u7684\u5916\u90e8\u5730\u5740\uff0c\u53ef\u4ee5\u9a8c\u8bc1\u8bf7\u6c42\u7684\u5206\u914d\u60c5\u51b5\u3002\u901a\u5e38\u53ef\u4ee5\u901a\u8fc7\u5de5\u5177\uff08\u5982 <code>curl</code>\uff09\u591a\u6b21\u8bf7\u6c42\uff0c\u89c2\u5bdf\u65e5\u5fd7\uff0c\u786e\u4fdd\u6d41\u91cf\u6309\u7167\u671f\u671b\u7684\u6bd4\u4f8b\u5206\u914d\u3002</p> <p><code>bash   curl http://&lt;external-ip&gt;</code></p> <p>\u53ef\u4ee5\u901a\u8fc7 <code>kubectl logs</code> \u547d\u4ee4\u67e5\u770b Pod \u7684\u65e5\u5fd7\uff0c\u786e\u8ba4\u6d41\u91cf\u662f\u5426\u88ab\u6b63\u786e\u5730\u5206\u914d\u5230\u4e0d\u540c\u7684\u7248\u672c\u3002</p> <p>##### \u4f7f\u7528 NGINX \u5b9e\u73b0 A/B \u6d4b\u8bd5</p> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528 NGINX \u53cd\u5411\u4ee3\u7406\u914d\u7f6e\u6765\u63a7\u5236\u6d41\u91cf\u7684\u5206\u914d\u3002\u4ee5\u4e0b\u662f\u57fa\u672c\u7684\u6b65\u9aa4\uff1a</p> <p>4.1. \u90e8\u7f72 NGINX</p> <p>\u9996\u5148\u5728 Kubernetes \u4e2d\u90e8\u7f72\u4e00\u4e2a NGINX \u4f5c\u4e3a\u53cd\u5411\u4ee3\u7406\u3002</p> <p>4.2. \u914d\u7f6e NGINX \u53cd\u5411\u4ee3\u7406</p> <p>\u5728 NGINX \u914d\u7f6e\u4e2d\uff0c\u8bbe\u7f6e\u53cd\u5411\u4ee3\u7406\u89c4\u5219\u6765\u5206\u914d\u6d41\u91cf\u3002\u4ee5\u4e0b\u662f\u4e00\u4e2a\u793a\u4f8b\u914d\u7f6e\uff0c\u5c06 90% \u7684\u6d41\u91cf\u8def\u7531\u5230 A \u7248\u672c\uff0c10% \u7684\u6d41\u91cf\u8def\u7531\u5230 B \u7248\u672c\u3002</p> <p>```nginx   http {       upstream myapp {           server a-deployment:80 weight=90;           server b-deployment:80 weight=10;       }</p> <pre><code>  server {\n      listen 80;\n\n      location / {\n          proxy_pass http://myapp;\n      }\n  }\n</code></pre> <p>}   ```</p> <p>4.3. \u5e94\u7528 NGINX \u914d\u7f6e</p> <p>\u5c06 NGINX \u7684\u914d\u7f6e\u5e94\u7528\u5230\u96c6\u7fa4\u4e2d\uff0c\u786e\u4fdd NGINX \u6210\u4e3a\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u5c06\u8bf7\u6c42\u5206\u914d\u5230 A \u548c B \u4e24\u4e2a\u7248\u672c\u3002</p> <p>#### \u603b\u7ed3</p> <ul> <li>A/B \u6d4b\u8bd5\u662f\u4e00\u79cd\u5c06\u4e0d\u540c\u7248\u672c\u5e94\u7528\u90e8\u7f72\u5230\u96c6\u7fa4\u4e2d\uff0c\u5e76\u5c06\u7528\u6237\u6d41\u91cf\u6309\u7167\u4e00\u5b9a\u6bd4\u4f8b\u5f15\u5bfc\u5230\u4e0d\u540c\u7248\u672c\u7684\u65b9\u6cd5\uff0c\u4e3b\u8981\u7528\u4e8e\u6d4b\u8bd5\u65b0\u65e7\u7248\u672c\u7684\u8868\u73b0\u5dee\u5f02\u3002</li> <li>\u5173\u952e\u6b65\u9aa4\uff1a<ol> <li>\u521b\u5efa\u65e7\u7248\u672c\u548c\u65b0\u7248\u672c\u7684 <code>Deployment</code>\uff0c\u5206\u522b\u4ee3\u8868 A \u7248\u672c\u548c B \u7248\u672c\u3002</li> <li>\u4f7f\u7528 Kubernetes \u7684 <code>Service</code> \u7edf\u4e00\u8bbf\u95ee\u5165\u53e3\u3002</li> <li>\u4f7f\u7528\u5916\u90e8\u8def\u7531\u5de5\u5177\uff08\u5982 Istio \u6216 NGINX\uff09\u6765\u63a7\u5236\u6d41\u91cf\u5206\u914d\u5230\u4e0d\u540c\u7248\u672c\u3002</li> </ol> </li> <li>\u4f18\u52bf\uff1aA/B \u6d4b\u8bd5\u53ef\u4ee5\u8ba9\u4f60\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u6d4b\u8bd5\u65b0\u7248\u672c\u5bf9\u7528\u6237\u7684\u5f71\u54cd\uff0c\u63d0\u4f9b\u771f\u5b9e\u7684\u7528\u6237\u53cd\u9988\uff0c\u4ee5\u8bc4\u4f30\u65b0\u529f\u80fd\u6216\u6539\u8fdb\u7684\u6548\u679c\u3002</li> <li>\u6311\u6218\uff1a\u9700\u8981\u989d\u5916\u914d\u7f6e\u590d\u6742\u7684\u6d41\u91cf\u7ba1\u7406\u5de5\u5177\uff0c\u5982 Istio \u6216 NGINX\uff0c\u4ee5\u5b9e\u73b0\u7cbe\u7ec6\u7684\u6d41\u91cf\u63a7\u5236\u3002</li> </ul> <p>\u5982\u679c\u4f60\u6709\u4efb\u4f55\u95ee\u9898\u6216\u8005\u9700\u8981\u8fdb\u4e00\u6b65\u7684\u5e2e\u52a9\uff0c\u8bf7\u968f\u65f6\u63d0\u95ee\uff01</p>"},{"location":"devops/K8s_3.html#536-pauseresume","title":"5.3.6 \u6eda\u52a8\u66f4\u65b0 + Pause/Resume\uff08\u624b\u52a8\u63a7\u5236\u66f4\u65b0\uff09","text":"<p>Kubernetes \u4e5f\u5141\u8bb8\u4f60\u901a\u8fc7 <code>pause</code> \u548c <code>resume</code> \u6765\u624b\u52a8\u63a7\u5236\u6eda\u52a8\u66f4\u65b0\u7684\u8282\u594f\u3002</p> <ul> <li>\u6b65\u9aa4\uff1a</li> <li>\u5728\u5f00\u59cb\u6eda\u52a8\u66f4\u65b0\u540e\u6682\u505c\u66f4\u65b0\uff0c\u67e5\u770b\u90e8\u5206 Pod \u8fd0\u884c\u72b6\u51b5\u3002</li> <li>\u5982\u679c\u786e\u8ba4\u6ca1\u6709\u95ee\u9898\uff0c\u518d\u7ee7\u7eed\u66f4\u65b0\u3002</li> </ul> <p>\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u5b9e\u73b0\uff1a</p> <p>```bash</p>"},{"location":"devops/K8s_3.html#_11","title":"\u6682\u505c\u66f4\u65b0","text":"<p>kubectl rollout pause deployment/myapp</p>"},{"location":"devops/K8s_3.html#_12","title":"\u6062\u590d\u66f4\u65b0","text":"<p>kubectl rollout resume deployment/myapp ```</p> <p>\u8fd9\u79cd\u65b9\u5f0f\u9002\u7528\u4e8e\u5e0c\u671b\u5bf9\u66f4\u65b0\u8fc7\u7a0b\u6709\u66f4\u7ec6\u7c92\u5ea6\u63a7\u5236\u7684\u573a\u666f\u3002</p> <p>\u6eda\u52a8\u66f4\u65b0\u7684 <code>Pause/Resume</code> \u529f\u80fd\u4f7f\u5f97\u4f60\u53ef\u4ee5\u624b\u52a8\u63a7\u5236 Kubernetes <code>Deployment</code> \u7684\u66f4\u65b0\u8fc7\u7a0b\u3002\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u4f60\u53ef\u80fd\u5e0c\u671b\u5728\u66f4\u65b0\u8fc7\u7a0b\u4e2d\u6682\u505c\uff0c\u4ee5\u4fbf\u68c0\u67e5\u5f53\u524d\u7684\u66f4\u65b0\u72b6\u6001\uff0c\u786e\u4fdd Pod \u6b63\u5e38\u8fd0\u884c\uff0c\u6216\u8005\u8fdb\u884c\u4e00\u4e9b\u624b\u52a8\u9a8c\u8bc1\uff0c\u907f\u514d\u65b0\u7248\u672c\u5f15\u5165\u7684\u95ee\u9898\u5f71\u54cd\u6574\u4e2a\u96c6\u7fa4\u3002\u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u5bf9\u66f4\u65b0\u8fc7\u7a0b\u8fdb\u884c\u66f4\u7ec6\u7c92\u5ea6\u7684\u63a7\u5236\u3002</p> <p>\u4ee5\u4e0b\u662f\u5982\u4f55\u5728 Kubernetes \u4e2d\u4f7f\u7528 <code>Pause/Resume</code> \u6765\u63a7\u5236\u6eda\u52a8\u66f4\u65b0\u7684\u8be6\u7ec6\u6b65\u9aa4\u3002</p>"},{"location":"devops/K8s_3.html#pauseresume","title":"\u6eda\u52a8\u66f4\u65b0 + Pause/Resume \u8be6\u7ec6\u6b65\u9aa4","text":""},{"location":"devops/K8s_3.html#_13","title":"\u573a\u666f\u5047\u8bbe","text":"<p>\u6211\u4eec\u6709\u4e00\u4e2a\u73b0\u6709\u7684 <code>Deployment</code>\uff0c\u4f7f\u7528\u955c\u50cf <code>nginx:1.19</code>\uff0c\u9700\u8981\u5c06\u8fd9\u4e2a <code>Deployment</code> \u6eda\u52a8\u66f4\u65b0\u5230 <code>nginx:1.20</code>\u3002\u4f46\u662f\uff0c\u4e3a\u4e86\u786e\u4fdd\u65b0\u7248\u672c\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u5b89\u5168\u8fd0\u884c\uff0c\u6211\u4eec\u5e0c\u671b\u5206\u9636\u6bb5\u624b\u52a8\u68c0\u67e5\u548c\u9a8c\u8bc1\u66f4\u65b0\u7684 Pod \u72b6\u6001\u3002</p>"},{"location":"devops/K8s_3.html#1-deployment_4","title":"\u6b65\u9aa4 1\uff1a\u521b\u5efa\u521d\u59cb <code>Deployment</code>","text":"<p>\u9996\u5148\uff0c\u521b\u5efa\u5e76\u90e8\u7f72\u5f53\u524d\u7248\u672c\u7684 <code>Deployment</code>\u3002</p> <p>1.1. \u521b\u5efa <code>myapp-deployment.yaml</code> \u6587\u4ef6</p> <p><code>yaml apiVersion: apps/v1 kind: Deployment metadata:   name: myapp-deployment   labels:     app: myapp spec:   replicas: 5   selector:     matchLabels:       app: myapp   template:     metadata:       labels:         app: myapp     spec:       containers:       - name: nginx         image: nginx:1.19         ports:         - containerPort: 80</code></p> <p>1.2. \u5e94\u7528 <code>Deployment</code> \u914d\u7f6e</p> <p><code>bash kubectl apply -f myapp-deployment.yaml</code></p>"},{"location":"devops/K8s_3.html#2_2","title":"\u6b65\u9aa4 2\uff1a\u5f00\u59cb\u6eda\u52a8\u66f4\u65b0","text":"<p>\u63a5\u4e0b\u6765\uff0c\u5c06\u955c\u50cf\u7248\u672c\u66f4\u65b0\u4e3a <code>nginx:1.20</code>\uff0c\u5e76\u5e94\u7528\u6eda\u52a8\u66f4\u65b0\u7b56\u7565\u3002</p> <p>2.1. \u4fee\u6539 <code>myapp-deployment.yaml</code> \u6587\u4ef6</p> <p>\u5c06\u5bb9\u5668\u955c\u50cf\u7684\u7248\u672c\u4ece <code>nginx:1.19</code> \u66f4\u65b0\u5230 <code>nginx:1.20</code>\uff1a</p> <p><code>yaml containers: - name: nginx   image: nginx:1.20</code></p> <p>2.2. \u5e94\u7528\u66f4\u65b0\u540e\u7684\u914d\u7f6e</p> <p><code>bash kubectl apply -f myapp-deployment.yaml</code></p> <p>\u6b64\u65f6\uff0cKubernetes \u4f1a\u5f00\u59cb\u6eda\u52a8\u66f4\u65b0\u65e7\u7684 Pod\uff0c\u5c06\u5b83\u4eec\u66ff\u6362\u4e3a\u65b0\u7684\u7248\u672c\u3002</p>"},{"location":"devops/K8s_3.html#3_3","title":"\u6b65\u9aa4 3\uff1a\u6682\u505c\u6eda\u52a8\u66f4\u65b0","text":"<p>\u6eda\u52a8\u66f4\u65b0\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>pause</code> \u547d\u4ee4\u624b\u52a8\u6682\u505c\u66f4\u65b0\uff0c\u8fd9\u6837\u53ef\u4ee5\u9010\u6b65\u68c0\u67e5\u65b0\u7248\u672c Pod \u7684\u72b6\u6001\uff0c\u786e\u4fdd\u5b83\u4eec\u6b63\u5e38\u5de5\u4f5c\u3002</p> <p>3.1. \u6682\u505c\u6eda\u52a8\u66f4\u65b0</p> <p><code>bash kubectl rollout pause deployment/myapp-deployment</code></p> <p>\u6b64\u547d\u4ee4\u4f1a\u7acb\u5373\u6682\u505c\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u7684\u6eda\u52a8\u66f4\u65b0\uff0c\u66f4\u65b0\u64cd\u4f5c\u4f1a\u4fdd\u6301\u5f53\u524d\u72b6\u6001\u3002</p> <p>3.2. \u67e5\u770b\u6682\u505c\u540e\u7684\u72b6\u6001</p> <p>\u4f60\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b <code>Deployment</code> \u7684\u72b6\u6001\uff0c\u786e\u8ba4\u5b83\u5df2\u7ecf\u88ab\u6682\u505c\uff1a</p> <p><code>bash kubectl rollout status deployment/myapp-deployment</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff08\u663e\u793a\u66f4\u65b0\u8fdb\u5c55\u88ab\u6682\u505c\uff09\uff1a</p> <p><code>plaintext deployment \"myapp-deployment\" paused</code></p> <p>\u6b64\u65f6\uff0c\u90e8\u5206 Pod \u5df2\u7ecf\u88ab\u66f4\u65b0\u4e3a\u65b0\u7248\u672c\uff0c\u90e8\u5206 Pod \u4ecd\u7136\u662f\u65e7\u7248\u672c\uff0c\u4f60\u53ef\u4ee5\u68c0\u67e5\u5b83\u4eec\u7684\u8fd0\u884c\u72b6\u6001\u3002</p> <p>3.3. \u68c0\u67e5 Pod \u72b6\u6001</p> <p>\u67e5\u770b Pod \u7684\u72b6\u6001\uff0c\u786e\u8ba4\u65b0\u7248\u672c\u662f\u5426\u6b63\u5e38\u8fd0\u884c\uff1a</p> <p><code>bash kubectl get pods -l app=myapp</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <p><code>plaintext NAME                             READY   STATUS    RESTARTS   AGE myapp-deployment-7d8d7bd8c-abc   1/1     Running   0          5m myapp-deployment-7d8d7bd8c-def   1/1     Running   0          5m myapp-deployment-7d8d7bd8c-ghi   1/1     Running   0          3m myapp-deployment-7d8d7bd8c-jkl   1/1     Running   0          1m myapp-deployment-7d8d7bd8c-mno   1/1     Running   0          1m</code></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u90e8\u5206 Pod \u8fd0\u884c\u65f6\u95f4\u8f83\u77ed\uff0c\u8bf4\u660e\u5b83\u4eec\u5df2\u7ecf\u88ab\u66f4\u65b0\u4e3a\u65b0\u7248\u672c\u3002</p>"},{"location":"devops/K8s_3.html#4_4","title":"\u6b65\u9aa4 4\uff1a\u6062\u590d\u6eda\u52a8\u66f4\u65b0","text":"<p>\u5982\u679c\u786e\u8ba4\u65b0\u7248\u672c\u7684 Pod \u6b63\u5e38\u8fd0\u884c\uff0c\u53ef\u4ee5\u7ee7\u7eed\u6eda\u52a8\u66f4\u65b0\u4ee5\u5b8c\u6210\u6240\u6709 Pod \u7684\u66f4\u65b0\u3002</p> <p>4.1. \u6062\u590d\u6eda\u52a8\u66f4\u65b0</p> <p><code>bash kubectl rollout resume deployment/myapp-deployment</code></p> <p>4.2. \u67e5\u770b\u66f4\u65b0\u72b6\u6001</p> <p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u76d1\u63a7\u6eda\u52a8\u66f4\u65b0\u7684\u8fdb\u5ea6\uff0c\u786e\u4fdd\u6240\u6709 Pod \u66f4\u65b0\u4e3a\u65b0\u7248\u672c\uff1a</p> <p><code>bash kubectl rollout status deployment/myapp-deployment</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <p><code>plaintext deployment \"myapp-deployment\" successfully rolled out</code></p>"},{"location":"devops/K8s_3.html#5_3","title":"\u6b65\u9aa4 5\uff1a\u56de\u6eda\u66f4\u65b0\uff08\u5982\u679c\u6709\u95ee\u9898\uff09","text":"<p>\u5982\u679c\u5728\u6062\u590d\u6eda\u52a8\u66f4\u65b0\u540e\u53d1\u73b0\u65b0\u7248\u672c\u6709\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528\u56de\u6eda\u547d\u4ee4\u5c06 <code>Deployment</code> \u6062\u590d\u5230\u4e4b\u524d\u7684\u7a33\u5b9a\u7248\u672c\u3002</p> <p>5.1. \u56de\u6eda\u5230\u4e4b\u524d\u7684\u7248\u672c</p> <p><code>bash kubectl rollout undo deployment/myapp-deployment</code></p> <p>\u6b64\u547d\u4ee4\u4f1a\u5c06 <code>Deployment</code> \u6062\u590d\u5230\u66f4\u65b0\u524d\u7684\u7248\u672c\uff0c\u4ee5\u786e\u4fdd\u5e94\u7528\u7684\u7a33\u5b9a\u6027\u3002</p>"},{"location":"devops/K8s_3.html#_14","title":"\u603b\u7ed3","text":"<ul> <li>\u6eda\u52a8\u66f4\u65b0 + Pause/Resume \u63d0\u4f9b\u4e86\u624b\u52a8\u63a7\u5236\u6eda\u52a8\u66f4\u65b0\u7684\u529f\u80fd\uff0c\u9002\u7528\u4e8e\u5e0c\u671b\u5728\u66f4\u65b0\u8fc7\u7a0b\u4e2d\u8fdb\u884c\u9010\u6b65\u9a8c\u8bc1\u7684\u573a\u666f\u3002</li> <li>\u5173\u952e\u6b65\u9aa4\uff1a</li> <li>\u6eda\u52a8\u66f4\u65b0\u5f00\u59cb\uff1a\u66f4\u65b0\u955c\u50cf\u7248\u672c\u5e76\u542f\u52a8\u6eda\u52a8\u66f4\u65b0\u3002</li> <li>\u6682\u505c\u66f4\u65b0\uff1a\u4f7f\u7528 <code>kubectl rollout pause</code> \u6682\u505c\u66f4\u65b0\uff0c\u9a8c\u8bc1\u90e8\u5206\u65b0\u7248\u672c Pod \u7684\u8fd0\u884c\u72b6\u6001\u3002</li> <li>\u6062\u590d\u66f4\u65b0\uff1a\u4f7f\u7528 <code>kubectl rollout resume</code> \u7ee7\u7eed\u66f4\u65b0\u5269\u4f59\u7684 Pod\u3002</li> <li>\u56de\u6eda\u66f4\u65b0\uff08\u5982\u679c\u6709\u95ee\u9898\uff09\uff1a\u4f7f\u7528 <code>kubectl rollout undo</code> \u5c06 <code>Deployment</code> \u6062\u590d\u5230\u4e4b\u524d\u7684\u7a33\u5b9a\u7248\u672c\u3002</li> <li>\u4f18\u52bf\uff1a\u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u5bf9\u66f4\u65b0\u8fc7\u7a0b\u6709\u66f4\u7ec6\u7c92\u5ea6\u7684\u63a7\u5236\uff0c\u80fd\u591f\u5728\u65b0\u7248\u672c\u4e2d\u53d1\u73b0\u95ee\u9898\u65f6\u7acb\u5373\u6682\u505c\u66f4\u65b0\uff0c\u9632\u6b62\u95ee\u9898\u5f71\u54cd\u5230\u6574\u4e2a\u96c6\u7fa4\u7684\u53ef\u7528\u6027\u3002</li> </ul> <p>\u5982\u679c\u4f60\u8fd8\u6709\u5176\u4ed6\u95ee\u9898\uff0c\u6b22\u8fce\u7ee7\u7eed\u63d0\u95ee\uff01</p>"},{"location":"devops/K8s_3.html#54-statefulset-deployment","title":"5.4 \u4ec0\u4e48\u662f StatefulSet\uff1f\u4e0e Deployment \u6709\u4ec0\u4e48\u533a\u522b\uff1f","text":"<p>\u5728 Kubernetes \u4e2d\uff0c<code>StatefulSet</code> \u548c <code>Deployment</code> \u90fd\u662f\u7ba1\u7406 Pod \u7684\u4e00\u79cd\u63a7\u5236\u5668\uff0c\u4f46\u5b83\u4eec\u9002\u7528\u4e8e\u4e0d\u540c\u7c7b\u578b\u7684\u5e94\u7528\u573a\u666f\u3002\u4ee5\u4e0b\u662f\u5173\u4e8e <code>StatefulSet</code> \u53ca\u5176\u4e0e <code>Deployment</code> \u7684\u533a\u522b\u3001\u4ee5\u53ca\u5982\u4f55\u4f7f\u7528\u5b83\u4eec\u7684\u8be6\u7ec6\u8bf4\u660e\u548c\u64cd\u4f5c\u6b65\u9aa4\u3002</p> <p>\u4f01\u4e1a ERP \u7cfb\u7edf\u90e8\u7f72\u9009\u7528StatefulSet \u6a21\u5f0f</p> <p>\u4f01\u4e1a ERP \u7cfb\u7edf\u5982\u679c\u90e8\u7f72\u5728 Kubernetes \u4e0a\uff0c\u901a\u5e38\u4f1a\u4f7f\u7528 StatefulSet\u3002\u8fd9\u662f\u56e0\u4e3a ERP \u7cfb\u7edf\u4e00\u822c\u9700\u8981\u5904\u7406\u5927\u91cf\u7684\u6709\u72b6\u6001\u6570\u636e\uff0c\u6bd4\u5982\u6570\u636e\u5e93\u548c\u7528\u6237\u4f1a\u8bdd\u72b6\u6001\u7b49\uff0cStatefulSet \u53ef\u4ee5\u66f4\u597d\u5730\u7ba1\u7406\u548c\u4fdd\u6301\u8fd9\u4e9b\u72b6\u6001\u7684\u4e00\u81f4\u6027\u548c\u6301\u4e45\u6027\u3002</p> <p>\u4ee5\u4e0b\u662f\u9009\u62e9 StatefulSet \u4f5c\u4e3a\u4f01\u4e1a ERP \u7cfb\u7edf\u5728 Kubernetes \u4e0a\u90e8\u7f72\u7684\u539f\u56e0\uff0c\u4ee5\u53ca\u4e00\u4e9b\u5e38\u89c1\u7684\u573a\u666f\uff1a</p>"},{"location":"devops/K8s_3.html#statefulset","title":"\u4ec0\u4e48\u662f StatefulSet\uff1f","text":"<p><code>StatefulSet</code> \u662f Kubernetes \u4e2d\u7684\u4e00\u79cd\u63a7\u5236\u5668\uff0c\u7528\u4e8e\u7ba1\u7406\u6709\u72b6\u6001\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u5c24\u5176\u9002\u5408\u90a3\u4e9b\u5bf9\u6570\u636e\u6301\u4e45\u5316\u548c\u90e8\u7f72\u987a\u5e8f\u6709\u4e25\u683c\u8981\u6c42\u7684\u573a\u666f\u3002<code>StatefulSet</code> \u7684\u4e3b\u8981\u7279\u70b9\u5305\u62ec\uff1a</p> <ol> <li>\u6709\u5e8f\u90e8\u7f72\u548c\u66f4\u65b0\uff1a<code>StatefulSet</code> \u6309\u7167\u987a\u5e8f\uff08\u4ece 0 \u5f00\u59cb\u7684\u7f16\u53f7\uff09\u521b\u5efa\u3001\u66f4\u65b0\u548c\u5220\u9664 Pod\u3002</li> <li>\u7a33\u5b9a\u7684\u7f51\u7edc\u6807\u8bc6\uff1a\u6bcf\u4e2a Pod \u90fd\u6709\u4e00\u4e2a\u7a33\u5b9a\u7684\u7f51\u7edc\u6807\u8bc6\uff0c\u8fd9\u4e9b\u6807\u8bc6\u5728\u91cd\u542f\u6216\u91cd\u65b0\u8c03\u5ea6\u65f6\u4fdd\u6301\u4e0d\u53d8\u3002</li> <li>\u6301\u4e45\u5b58\u50a8\uff1a\u6bcf\u4e2a Pod \u90fd\u6709\u4e00\u4e2a\u4e0e\u4e4b\u7ed1\u5b9a\u7684\u72ec\u7acb\u7684\u5b58\u50a8\u5377\uff0c\u5b58\u50a8\u5377\u5728 Pod \u91cd\u5efa\u540e\u4e5f\u4e0d\u4f1a\u88ab\u5220\u9664\u3002</li> </ol> <p><code>StatefulSet</code> \u9002\u7528\u4e8e\u6709\u72b6\u6001\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u6bd4\u5982\u6570\u636e\u5e93\uff08\u5982 MySQL\u3001PostgreSQL\uff09\u3001\u5206\u5e03\u5f0f\u7cfb\u7edf\uff08\u5982 ZooKeeper\u3001Kafka\uff09\u7b49\u3002</p>"},{"location":"devops/K8s_3.html#statefulset-deployment","title":"StatefulSet \u548c Deployment \u7684\u533a\u522b","text":"\u7279\u6027 StatefulSet Deployment \u9002\u7528\u573a\u666f \u6709\u72b6\u6001\u5e94\u7528\uff0c\u5982\u6570\u636e\u5e93\u3001\u9700\u8981\u6301\u4e45\u5316\u7684\u6570\u636e \u65e0\u72b6\u6001\u5e94\u7528\uff0c\u5982 Web \u670d\u52a1\u3001API \u670d\u52a1\u5668 Pod \u7684\u552f\u4e00\u6807\u8bc6 \u6bcf\u4e2a Pod \u6709\u552f\u4e00\u7684\u540d\u5b57\uff08\u7a33\u5b9a\u7684\u7f51\u7edc\u6807\u8bc6\uff09 Pod \u540d\u5b57\u4e0d\u7a33\u5b9a\uff0cPod \u91cd\u542f\u540e\u540d\u5b57\u4f1a\u6539\u53d8 \u5b58\u50a8\u5377 \u6bcf\u4e2a Pod \u90fd\u6709\u72ec\u7acb\u7684\u6301\u4e45\u5377\uff0c\u4e14\u4e0d\u4f1a\u5728 Pod \u5220\u9664\u65f6\u4e22\u5931 \u901a\u5e38\u4f7f\u7528\u5171\u4eab\u5b58\u50a8\uff0cPod \u5220\u9664\u540e\u5b58\u50a8\u4e5f\u4f1a\u88ab\u56de\u6536 \u90e8\u7f72\u987a\u5e8f \u6309\u5e8f\u90e8\u7f72\uff0c\u6309\u7f16\u53f7\u987a\u5e8f\u542f\u52a8\u548c\u5220\u9664 Pod \u65e0\u5e8f\u90e8\u7f72\uff0cPod \u542f\u52a8\u548c\u5220\u9664\u662f\u5e76\u884c\u7684"},{"location":"devops/K8s_3.html#statefulset_1","title":"\u4f7f\u7528 StatefulSet \u7684\u8be6\u7ec6\u64cd\u4f5c\u6b65\u9aa4","text":"<p>\u4ee5\u4e0b\u662f\u5982\u4f55\u5728 Kubernetes \u4e2d\u521b\u5efa\u4e00\u4e2a <code>StatefulSet</code> \u7684\u8be6\u7ec6\u6b65\u9aa4\uff1a</p>"},{"location":"devops/K8s_3.html#1-configmap-service","title":"1. \u521b\u5efa ConfigMap \u548c Service","text":"<p><code>StatefulSet</code> \u901a\u5e38\u4f1a\u914d\u5408 <code>Headless Service</code> \u4e00\u8d77\u4f7f\u7528\uff0c\u4ee5\u786e\u4fdd\u6bcf\u4e2a Pod \u6709\u7a33\u5b9a\u7684\u7f51\u7edc\u8bbf\u95ee\u5730\u5740\u3002</p> <ol> <li>\u521b\u5efa\u4e00\u4e2a Headless Service\uff1a</li> </ol> <p>Headless Service \u5141\u8bb8\u4f60\u4e3a <code>StatefulSet</code> \u4e2d\u7684\u6bcf\u4e2a Pod \u5206\u914d\u4e00\u4e2a\u7a33\u5b9a\u7684 DNS \u540d\u79f0\u3002</p> <p>\u521b\u5efa\u4e00\u4e2a <code>headless-service.yaml</code> \u6587\u4ef6\uff1a</p> <p><code>yaml apiVersion: v1 kind: Service metadata:   name: myapp-headless   labels:     app: myapp spec:   ports:     - port: 80       name: web   clusterIP: None   selector:     app: myapp</code></p> <p>\u5e94\u7528 Service\uff1a</p> <p><code>bash kubectl apply -f headless-service.yaml</code></p> <ol> <li>\u521b\u5efa StatefulSet \u914d\u7f6e\u6587\u4ef6</li> </ol> <p>\u521b\u5efa\u4e00\u4e2a <code>statefulset.yaml</code> \u6587\u4ef6\uff0c\u5b9a\u4e49 <code>StatefulSet</code> \u7684\u914d\u7f6e\u3002\u4f8b\u5982\uff0c\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684 Nginx \u5e94\u7528\uff1a</p> <p><code>yaml apiVersion: apps/v1 kind: StatefulSet metadata:   name: myapp spec:   serviceName: \"myapp-headless\"   replicas: 3   selector:     matchLabels:       app: myapp   template:     metadata:       labels:         app: myapp     spec:       containers:       - name: nginx         image: nginx:1.21         ports:         - containerPort: 80           name: web   volumeClaimTemplates:   - metadata:       name: www     spec:       accessModes: [\"ReadWriteOnce\"]       resources:         requests:           storage: 1Gi</code></p> <p>\u4e3b\u8981\u5b57\u6bb5\u8bf4\u660e\uff1a</p> <ul> <li>serviceName\uff1a\u6307\u5b9a\u4e0e <code>StatefulSet</code> \u5173\u8054\u7684 <code>Headless Service</code>\u3002</li> <li>replicas\uff1a\u526f\u672c\u6570\u91cf\u3002</li> <li>volumeClaimTemplates\uff1a\u4e3a\u6bcf\u4e2a Pod \u521b\u5efa\u72ec\u7acb\u7684\u6301\u4e45\u5b58\u50a8\u5377\u3002</li> </ul>"},{"location":"devops/K8s_3.html#2-statefulset","title":"2. \u90e8\u7f72 StatefulSet","text":"<p>\u5e94\u7528 <code>statefulset.yaml</code> \u6587\u4ef6\uff1a</p> <p><code>bash kubectl apply -f statefulset.yaml</code></p>"},{"location":"devops/K8s_3.html#3-statefulset","title":"3. \u9a8c\u8bc1 StatefulSet \u7684\u90e8\u7f72","text":"<ul> <li>\u67e5\u770b <code>StatefulSet</code> \u7684\u72b6\u6001\uff1a</li> </ul> <p><code>bash   kubectl get statefulset</code></p> <p>\u4f60\u5c06\u770b\u5230\u7c7b\u4f3c\u7684\u8f93\u51fa\uff1a</p> <p><code>plaintext   NAME    READY   AGE   myapp   3/3     5m</code> - \u67e5\u770b Pod \u7684\u72b6\u6001\uff1a</p> <p><code>bash   kubectl get pods -l app=myapp</code></p> <p>\u8f93\u51fa\u7c7b\u4f3c\u5982\u4e0b\uff1a</p> <p><code>plaintext   NAME        READY   STATUS    RESTARTS   AGE   myapp-0     1/1     Running   0          5m   myapp-1     1/1     Running   0          4m   myapp-2     1/1     Running   0          3m</code></p> <p>\u6bcf\u4e2a Pod \u90fd\u6709\u4e00\u4e2a\u7a33\u5b9a\u7684\u540d\u79f0\uff0c\u6bd4\u5982 <code>myapp-0</code>\u3001<code>myapp-1</code>\u3001<code>myapp-2</code>\u3002</p>"},{"location":"devops/K8s_3.html#4-statefulset","title":"4. \u66f4\u65b0 StatefulSet","text":"<p>\u66f4\u65b0 <code>StatefulSet</code> \u4e0e\u66f4\u65b0 <code>Deployment</code> \u7c7b\u4f3c\uff0c\u4f60\u53ef\u4ee5\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u955c\u50cf\u7248\u672c\uff0c\u7136\u540e\u5e94\u7528\u66f4\u6539\uff1a</p> <ul> <li>\u4fee\u6539 <code>statefulset.yaml</code> \u4e2d\u7684\u955c\u50cf\u7248\u672c\uff0c\u4f8b\u5982\uff0c\u5c06 Nginx \u7684\u955c\u50cf\u66f4\u65b0\u4e3a <code>nginx:1.22</code>\uff1a   ```yaml   containers:</li> <li>name: nginx     image: nginx:1.22   ```</li> </ul> <p>\u91cd\u65b0\u5e94\u7528\u6587\u4ef6\uff1a</p> <p><code>bash kubectl apply -f statefulset.yaml</code></p> <p>\u67e5\u770b\u6eda\u52a8\u66f4\u65b0\u72b6\u6001\uff1a</p> <p><code>bash kubectl rollout status statefulset/myapp</code></p>"},{"location":"devops/K8s_3.html#5-pod","title":"5. \u9a8c\u8bc1 Pod \u7684\u6301\u4e45\u6027\u548c\u987a\u5e8f\u6027","text":"<ul> <li>\u5220\u9664 Pod \u5e76\u67e5\u770b\u91cd\u5efa\uff1a\u5220\u9664\u67d0\u4e2a Pod\uff0c\u89c2\u5bdf\u5176\u91cd\u5efa\u60c5\u51b5\uff1a</li> </ul> <p><code>bash   kubectl delete pod myapp-0</code></p> <p>\u4f60\u4f1a\u53d1\u73b0 Kubernetes \u4f1a\u81ea\u52a8\u6309\u987a\u5e8f\u91cd\u5efa\u8fd9\u4e2a Pod\uff0c\u4e14\u540d\u79f0\u4fdd\u6301\u4e0d\u53d8\u3002 - \u9a8c\u8bc1\u6301\u4e45\u5b58\u50a8\u5377\uff1a\u6bcf\u4e2a Pod \u7684\u6570\u636e\u5b58\u50a8\u5377\u662f\u72ec\u7acb\u7684\u4e14\u6301\u4e45\u5316\uff0c\u5373\u4f7f Pod \u5220\u9664\u540e\uff0c\u6570\u636e\u5377\u4e0d\u4f1a\u4e22\u5931\u3002\u4f60\u53ef\u4ee5\u67e5\u770b Persistent Volume Claim (PVC)\uff1a</p> <p><code>bash   kubectl get pvc</code></p> <p>\u4f60\u4f1a\u770b\u5230\u6bcf\u4e2a Pod \u5bf9\u5e94\u7684 PVC\uff0c\u4f8b\u5982\uff1a</p> <p><code>plaintext   NAME         STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE   www-myapp-0  Bound    pvc-12345678-1234-5678-1234-567812345678   1Gi        RWO            standard       10m   www-myapp-1  Bound    pvc-22345678-2234-5678-2234-567822345678   1Gi        RWO            standard       9m</code></p>"},{"location":"devops/K8s_3.html#_15","title":"\u603b\u7ed3","text":"<ul> <li><code>StatefulSet</code> \u9002\u7528\u4e8e\u6709\u72b6\u6001\u7684\u5e94\u7528\uff0c\u80fd\u591f\u4fdd\u8bc1 Pod \u7684\u987a\u5e8f\u6027\u3001\u7f51\u7edc\u6807\u8bc6\u548c\u6301\u4e45\u5b58\u50a8\u3002</li> <li>\u4e0e <code>Deployment</code> \u4e0d\u540c\uff0c<code>StatefulSet</code> \u786e\u4fdd\u6bcf\u4e2a Pod \u7684\u8eab\u4efd\u552f\u4e00\u5e76\u4e14\u6301\u4e45\u5316\u6570\u636e\u5377\u4e0d\u4f1a\u4e22\u5931\u3002</li> <li>\u4f7f\u7528 <code>StatefulSet</code> \u65f6\uff0c\u901a\u5e38\u9700\u8981\u4e0e <code>Headless Service</code> \u914d\u5408\u4f7f\u7528\uff0c\u4ee5\u786e\u4fdd\u6bcf\u4e2a Pod \u6709\u7a33\u5b9a\u7684 DNS \u540d\u79f0\u3002</li> </ul>"},{"location":"devops/K8s_3.html#1-statefulset","title":"1. StatefulSet \u7684\u7279\u70b9\u9002\u5408\u6709\u72b6\u6001\u5e94\u7528","text":"<p>StatefulSet \u662f Kubernetes \u4e2d\u7684\u4e00\u79cd\u63a7\u5236\u5668\uff0c\u4e13\u95e8\u7528\u4e8e\u7ba1\u7406\u6709\u72b6\u6001\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u4ee5\u4e0b\u662f\u5b83\u7684\u51e0\u4e2a\u91cd\u8981\u7279\u70b9\uff0c\u8fd9\u4e9b\u7279\u70b9\u4f7f\u5f97\u5b83\u975e\u5e38\u9002\u5408\u7528\u4e8e\u4f01\u4e1a ERP \u7cfb\u7edf\u7684\u90e8\u7f72\uff1a</p> <ul> <li>\u6709\u5e8f\u90e8\u7f72\u548c\u66f4\u65b0\uff1aStatefulSet \u4fdd\u8bc1 Pod \u6309\u5e8f\u521b\u5efa\u3001\u66f4\u65b0\u548c\u5220\u9664\u3002\u8fd9\u5bf9\u4e8e ERP \u7cfb\u7edf\u4e2d\u9700\u8981\u6709\u987a\u5e8f\u4f9d\u8d56\u7684\u7ec4\u4ef6\u6765\u8bf4\u975e\u5e38\u91cd\u8981\u3002</li> <li>\u7a33\u5b9a\u7684\u7f51\u7edc\u6807\u8bc6\uff1aStatefulSet \u4e2d\u6bcf\u4e2a Pod \u90fd\u6709\u4e00\u4e2a\u7a33\u5b9a\u7684 DNS \u540d\u79f0\uff0c\u5373\u4f7f Pod \u91cd\u542f\u6216\u8fc1\u79fb\uff0c\u540d\u79f0\u4e5f\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316\u3002\u5bf9\u4e8e\u9700\u8981\u6301\u4e45\u8fde\u63a5\u7684 ERP \u7ec4\u4ef6\uff0c\u6bd4\u5982\u4e0e\u6570\u636e\u5e93\u7684\u8fde\u63a5\uff0c\u8fd9\u79cd\u7279\u6027\u975e\u5e38\u91cd\u8981\u3002</li> <li>\u6301\u4e45\u5b58\u50a8\u5377\uff1a\u6bcf\u4e2a StatefulSet \u7684 Pod \u90fd\u6709\u72ec\u7acb\u7684\u6301\u4e45\u5b58\u50a8\u5377\uff0c\u8fd9\u4e9b\u5b58\u50a8\u5377\u4e0e Pod \u7ed1\u5b9a\u5728\u4e00\u8d77\uff0c\u5373\u4f7f Pod \u91cd\u5efa\uff0c\u5b58\u50a8\u5377\u4e5f\u4e0d\u4f1a\u4e22\u5931\u3002ERP \u7cfb\u7edf\u7684\u6570\u636e\u5e93\u3001\u7528\u6237\u4f1a\u8bdd\u548c\u7f13\u5b58\u7b49\u6570\u636e\u9700\u8981\u6301\u4e45\u5316\uff0cStatefulSet \u53ef\u4ee5\u5f88\u597d\u5730\u652f\u6301\u8fd9\u4e9b\u9700\u6c42\u3002</li> </ul>"},{"location":"devops/K8s_3.html#2-erp","title":"2. ERP \u7cfb\u7edf\u901a\u5e38\u9700\u8981\u6709\u72b6\u6001\u7684\u6301\u4e45\u6027","text":"<p>\u4f01\u4e1a ERP \u7cfb\u7edf\u7684\u7279\u6027\u51b3\u5b9a\u4e86\u5b83\u5bf9\u6570\u636e\u7684\u6301\u4e45\u6027\u548c\u4e00\u81f4\u6027\u6709\u975e\u5e38\u9ad8\u7684\u8981\u6c42\uff0c\u5305\u62ec\uff1a</p> <ul> <li>\u6570\u636e\u5e93\u5b58\u50a8\uff1aERP \u7cfb\u7edf\u4e2d\u5f80\u5f80\u6d89\u53ca\u5927\u578b\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff08\u5982 MySQL\u3001PostgreSQL\u3001Oracle \u7b49\uff09\uff0c\u7528\u4e8e\u5b58\u50a8\u5ba2\u6237\u4fe1\u606f\u3001\u8d22\u52a1\u6570\u636e\u3001\u91c7\u8d2d\u6570\u636e\u7b49\u3002\u8fd9\u4e9b\u6570\u636e\u5e93\u5fc5\u987b\u6301\u4e45\u5316\uff0c\u56e0\u6b64\u9002\u5408\u4f7f\u7528 StatefulSet\uff0c\u4fdd\u8bc1\u6bcf\u4e2a\u6570\u636e\u5e93\u5b9e\u4f8b\u90fd\u6709\u4e00\u4e2a\u6301\u4e45\u5b58\u50a8\u5377\u3002</li> <li>\u4f1a\u8bdd\u7ba1\u7406\uff1aERP \u7cfb\u7edf\u4e2d\u7684\u7528\u6237\u4f1a\u8bdd\u901a\u5e38\u9700\u8981\u6301\u4e45\u5316\uff0c\u4ee5\u4fdd\u8bc1\u5728 Pod \u91cd\u542f\u6216\u8fc1\u79fb\u65f6\u7528\u6237\u4e0d\u9700\u8981\u91cd\u65b0\u767b\u5f55\u3002\u8fd9\u4e5f\u662f StatefulSet \u7684\u4e00\u4e2a\u91cd\u8981\u7528\u4f8b\u3002</li> <li>\u7ec4\u4ef6\u95f4\u7684\u6709\u5e8f\u4f9d\u8d56\uff1aERP \u7cfb\u7edf\u7531\u591a\u4e2a\u7ec4\u4ef6\uff08\u5982\u5e94\u7528\u670d\u52a1\u5668\u3001\u6d88\u606f\u961f\u5217\u3001\u6570\u636e\u5e93\u7b49\uff09\u7ec4\u6210\uff0c\u5e76\u4e14\u8fd9\u4e9b\u7ec4\u4ef6\u4e4b\u95f4\u5b58\u5728\u76f8\u4e92\u4f9d\u8d56\u7684\u5173\u7cfb\u3002StatefulSet \u7684\u6709\u5e8f\u6027\u90e8\u7f72\u548c\u7ec8\u6b62\u80fd\u591f\u5e2e\u52a9\u8fd9\u4e9b\u7ec4\u4ef6\u6309\u4f9d\u8d56\u5173\u7cfb\u542f\u52a8\u548c\u5173\u95ed\uff0c\u4fdd\u8bc1\u7cfb\u7edf\u7684\u7a33\u5b9a\u6027\u3002</li> </ul>"},{"location":"devops/K8s_3.html#statefulset-erp","title":"\u4f7f\u7528 StatefulSet \u90e8\u7f72 ERP \u7cfb\u7edf\u7684\u5e38\u89c1\u573a\u666f","text":"<p>\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5e38\u89c1\u7684 ERP \u7cfb\u7edf\u5728 Kubernetes \u4e0a\u90e8\u7f72\u65f6\u4f7f\u7528 StatefulSet \u7684\u573a\u666f\uff1a</p> <ol> <li> <p>\u6570\u636e\u5e93\u90e8\u7f72\uff1a</p> </li> <li> <p>ERP \u7cfb\u7edf\u4f9d\u8d56\u4e8e\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0c\u800c\u6570\u636e\u5e93\u662f\u5178\u578b\u7684\u6709\u72b6\u6001\u5e94\u7528\u3002\u4f7f\u7528 StatefulSet \u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u4e2a\u6570\u636e\u5e93\u5b9e\u4f8b\u7684\u6570\u636e\u5377\u7684\u6301\u4e45\u6027\u548c\u7f51\u7edc\u6807\u8bc6\u7684\u7a33\u5b9a\u6027\u3002</p> </li> <li>\u6bd4\u5982\uff0c\u53ef\u4ee5\u7528 StatefulSet \u90e8\u7f72 MySQL\u3001PostgreSQL \u7b49\u4e3b\u4ece\u67b6\u6784\u7684\u6570\u636e\u5e93\u96c6\u7fa4\u3002</li> <li> <p>\u5e94\u7528\u670d\u52a1\u5668\u7684\u6709\u72b6\u6001\u7ba1\u7406\uff1a</p> </li> <li> <p>ERP \u7cfb\u7edf\u7684\u5e94\u7528\u670d\u52a1\u5668\u90e8\u5206\u53ef\u80fd\u9700\u8981\u7ef4\u62a4\u7528\u6237\u4f1a\u8bdd\u3001\u7f13\u5b58\u548c\u672c\u5730\u72b6\u6001\uff0c\u8fd9\u4e9b\u90fd\u9700\u8981\u6301\u4e45\u5b58\u50a8\u3002StatefulSet \u53ef\u4ee5\u786e\u4fdd\u5e94\u7528\u670d\u52a1\u5668\u7684 Pod \u5728\u91cd\u542f\u65f6\u4fdd\u7559\u5176\u72b6\u6001\u548c\u6570\u636e\u5377\u3002</p> </li> <li> <p>\u6d88\u606f\u961f\u5217\u548c\u7f13\u5b58\uff1a</p> </li> <li> <p>ERP \u7cfb\u7edf\u4e2d\u53ef\u80fd\u4f1a\u4f7f\u7528\u6d88\u606f\u961f\u5217\uff08\u5982 Kafka\uff09\u6216\u5206\u5e03\u5f0f\u7f13\u5b58\uff08\u5982 Redis\uff09\u3002\u8fd9\u4e9b\u7ec4\u4ef6\u540c\u6837\u9700\u8981\u6570\u636e\u6301\u4e45\u5316\u548c\u7a33\u5b9a\u7684\u7f51\u7edc\u6807\u8bc6\uff0c\u56e0\u6b64\u4e5f\u53ef\u4ee5\u901a\u8fc7 StatefulSet \u6765\u8fdb\u884c\u90e8\u7f72\u3002</p> </li> <li>Kafka \u96c6\u7fa4\u6216 Redis \u96c6\u7fa4\u7684\u8282\u70b9\u9700\u8981\u7a33\u5b9a\u7684\u4e3b\u673a\u540d\u4ee5\u4fdd\u8bc1\u96c6\u7fa4\u7684\u4e00\u81f4\u6027\uff0cStatefulSet \u53ef\u4ee5\u5f88\u597d\u5730\u6ee1\u8db3\u8fd9\u79cd\u9700\u6c42\u3002</li> </ol>"},{"location":"devops/K8s_3.html#deployment","title":"\u548c Deployment \u7684\u5bf9\u6bd4","text":"<p>StatefulSet \u548c Deployment \u7684\u533a\u522b\u5728\u4e8e\u6709\u65e0\u72b6\u6001\u7684\u7ba1\u7406\u80fd\u529b\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48 ERP \u7cfb\u7edf\u66f4\u9002\u5408\u4f7f\u7528 StatefulSet \u7684\u539f\u56e0\uff1a</p> <ul> <li>StatefulSet \u9002\u5408\u6709\u72b6\u6001\u5e94\u7528\uff0c\u4fdd\u8bc1 Pod \u7684\u7f51\u7edc\u6807\u8bc6\u548c\u5b58\u50a8\u5377\u7684\u4e00\u81f4\u6027\u3002\u800c Deployment \u9002\u5408\u65e0\u72b6\u6001\u5e94\u7528\uff0c\u6bd4\u5982\u524d\u7aef Web \u670d\u52a1\uff0cPod \u7684\u72b6\u6001\u3001\u987a\u5e8f\u548c\u6301\u4e45\u5b58\u50a8\u5bf9\u5b83\u4eec\u6765\u8bf4\u5e76\u4e0d\u91cd\u8981\u3002</li> <li>Deployment \u65e0\u6cd5\u4fdd\u8bc1 Pod \u542f\u52a8\u7684\u987a\u5e8f\u548c\u5b58\u50a8\u7684\u7a33\u5b9a\u6027\uff0c\u56e0\u6b64\u5bf9\u4e8e\u6570\u636e\u5e93\u6216\u8005\u9700\u8981\u4fdd\u8bc1\u72b6\u6001\u4e00\u81f4\u6027\u7684 ERP \u7ec4\u4ef6\u6765\u8bf4\u5e76\u4e0d\u662f\u6700\u597d\u7684\u9009\u62e9\u3002</li> </ul>"},{"location":"devops/K8s_3.html#_16","title":"\u90e8\u7f72\u5efa\u8bae","text":"<ol> <li> <p>\u6570\u636e\u5e93\u72ec\u7acb\u90e8\u7f72\uff1a</p> </li> <li> <p>ERP \u7cfb\u7edf\u7684\u6570\u636e\u5e93\u5efa\u8bae\u901a\u8fc7 StatefulSet \u72ec\u7acb\u90e8\u7f72\uff0c\u4ee5\u4fdd\u6301\u5176\u9ad8\u53ef\u7528\u6027\u548c\u6301\u4e45\u6027\u3002\u53ef\u4ee5\u7ed3\u5408 PersistentVolume\uff08PV\uff09\u548c PersistentVolumeClaim\uff08PVC\uff09\u6765\u63d0\u4f9b\u5e95\u5c42\u5b58\u50a8\u652f\u6301\u3002</p> </li> <li> <p>\u5e94\u7528\u670d\u52a1\u5668\u53ef\u5206\u4e3a\u591a\u79cd\u65b9\u5f0f\uff1a</p> </li> <li> <p>\u5bf9\u4e8e\u65e0\u72b6\u6001\u7684\u90e8\u5206\uff0c\u4f8b\u5982\u7528\u6237\u754c\u9762\u6216\u4e1a\u52a1\u903b\u8f91\u670d\u52a1\uff0c\u53ef\u4ee5\u4f7f\u7528 Deployment \u8fdb\u884c\u6c34\u5e73\u6269\u5c55\u3002</p> </li> <li>\u5bf9\u4e8e\u6709\u72b6\u6001\u7684\u90e8\u5206\uff0c\u4f8b\u5982\u9700\u8981\u4f1a\u8bdd\u6301\u4e45\u5316\u7684\u5e94\u7528\u670d\u52a1\u5668\u5b9e\u4f8b\uff0c\u53ef\u4ee5\u4f7f\u7528 StatefulSet \u8fdb\u884c\u7ba1\u7406\u3002</li> <li> <p>\u7ed3\u5408\u5176\u4ed6 Kubernetes \u5de5\u5177\uff1a</p> </li> <li> <p>Headless Service\uff1aStatefulSet \u4e00\u822c\u9700\u8981\u7ed3\u5408 Headless Service \u4f7f\u7528\uff0c\u4ee5\u786e\u4fdd\u6bcf\u4e2a Pod \u6709\u4e00\u4e2a\u7a33\u5b9a\u7684 DNS \u540d\u79f0\u3002</p> </li> <li>PersistentVolume\uff1a\u4e3a StatefulSet \u4e2d\u7684\u6bcf\u4e2a Pod \u63d0\u4f9b\u72ec\u7acb\u7684\u6301\u4e45\u5b58\u50a8\u3002</li> </ol> <p>\u5728 Kubernetes \u4e2d\u90e8\u7f72\u4f01\u4e1a ERP \u7cfb\u7edf\uff0cStatefulSet \u662f\u975e\u5e38\u5e38\u89c1\u7684\u9009\u62e9\uff0c\u5c24\u5176\u662f\u5bf9\u4e8e\u9700\u8981\u6301\u4e45\u5316\u548c\u7a33\u5b9a\u72b6\u6001\u7684\u7ec4\u4ef6\uff0c\u4f8b\u5982\u6570\u636e\u5e93\u3001\u6d88\u606f\u961f\u5217\u548c\u5e94\u7528\u670d\u52a1\u5668\u7b49\u3002StatefulSet \u80fd\u591f\u63d0\u4f9b\u6709\u5e8f\u90e8\u7f72\u3001\u7a33\u5b9a\u7f51\u7edc\u6807\u8bc6\u548c\u6301\u4e45\u5b58\u50a8\u5377\uff0c\u8fd9\u4e9b\u90fd\u662f\u4f01\u4e1a ERP \u7cfb\u7edf\u6b63\u5e38\u8fd0\u884c\u7684\u5173\u952e\u6761\u4ef6\u3002</p> <p>\u5bf9\u4e8e\u65e0\u72b6\u6001\u7684\u670d\u52a1\u90e8\u5206\uff0c\u4ecd\u7136\u53ef\u4ee5\u4f7f\u7528 Deployment \u6765\u5b9e\u73b0\u5feb\u901f\u6269\u5c55\u548c\u66f4\u65b0\uff0c\u4f46\u5bf9\u4e8e\u6570\u636e\u6301\u4e45\u6027\u8981\u6c42\u9ad8\u7684\u90e8\u5206\uff0cStatefulSet \u662f\u6700\u4f73\u9009\u62e9\u3002</p>"},{"location":"devops/K8s_4.html","title":"K8s \u76f8\u5173\u95ee\u9898\u96c6\u9526\uff08\u56db\uff09","text":""},{"location":"devops/K8s_4.html#6","title":"6 \u5b89\u5168\u7c7b","text":""},{"location":"devops/K8s_4.html#61","title":"6.1 \u7ba1\u7406\u8bbf\u95ee\u63a7\u5236","text":"<p>\u901a\u8fc7 RBAC\uff08Role-Based Access Control\uff09\u7ba1\u7406\u7528\u6237\u548c\u670d\u52a1\u8d26\u6237\u7684\u6743\u9650\uff0c\u63cf\u8ff0 Role\u3001ClusterRole\u3001RoleBinding\u3001ClusterRoleBinding \u7684\u4f5c\u7528\u3002</p> <p>Kubernetes \u4e2d\u7684\u8bbf\u95ee\u63a7\u5236\u7ba1\u7406\u901a\u8fc7 RBAC\uff08\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236\uff09\u6765\u5b9e\u73b0\uff0cRBAC \u5141\u8bb8\u4f60\u5bf9\u96c6\u7fa4\u4e2d\u8d44\u6e90\u7684\u8bbf\u95ee\u8fdb\u884c\u63a7\u5236\u3002RBAC \u7684\u7ba1\u7406\u4e3b\u8981\u4f9d\u8d56\u4e8e\u4ee5\u4e0b\u51e0\u4e2a\u5bf9\u8c61\uff1aRole\u3001ClusterRole\u3001RoleBinding\u3001ClusterRoleBinding\u3002</p>"},{"location":"devops/K8s_4.html#1-role-clusterrole","title":"1. Role \u548c ClusterRole","text":"<ul> <li>Role \u662f\u5728\u547d\u540d\u7a7a\u95f4\u5185\u5b9a\u4e49\u7684\u8bbf\u95ee\u6743\u9650\u96c6\u5408\uff0c\u7528\u4e8e\u63a7\u5236\u7279\u5b9a\u547d\u540d\u7a7a\u95f4\u5185\u8d44\u6e90\u7684\u8bbf\u95ee\u6743\u9650\u3002</li> <li>\u4f8b\u5982\uff0c\u5141\u8bb8\u7528\u6237\u5728\u547d\u540d\u7a7a\u95f4 <code>dev</code> \u4e2d\u8bfb\u53d6\u6240\u6709\u7684 pod\u3002</li> <li>ClusterRole \u5219\u4f5c\u7528\u4e8e\u6574\u4e2a\u96c6\u7fa4\uff0c\u53ef\u4ee5\u7528\u4e8e\u8de8\u591a\u4e2a\u547d\u540d\u7a7a\u95f4\uff0c\u6216\u8005\u5728\u6ca1\u6709\u7279\u5b9a\u547d\u540d\u7a7a\u95f4\u7684\u8d44\u6e90\uff08\u5982\u8282\u70b9\uff09\u4e0a\u8fdb\u884c\u6743\u9650\u63a7\u5236\u3002</li> <li>\u4f8b\u5982\uff0c\u5141\u8bb8\u7528\u6237\u5728\u6574\u4e2a\u96c6\u7fa4\u4e2d\u8bfb\u53d6\u6240\u6709\u547d\u540d\u7a7a\u95f4\u7684 pod\u3002</li> </ul>"},{"location":"devops/K8s_4.html#_1","title":"\u793a\u4f8b\uff1a","text":"<p>```yaml</p>"},{"location":"devops/K8s_4.html#role-dev-pod","title":"\u5b9a\u4e49\u4e00\u4e2a Role\uff0c\u5141\u8bb8\u7528\u6237\u5728 dev \u547d\u540d\u7a7a\u95f4\u4e2d\u8bfb\u53d6 Pod \u8d44\u6e90","text":"<p>apiVersion: rbac.authorization.k8s.io/v1 kind: Role metadata:   namespace: dev   name: pod-reader rules: - apiGroups: [\"\"]   resources: [\"pods\"]   verbs: [\"get\", \"list\", \"watch\"] ```</p> <p>```yaml</p>"},{"location":"devops/K8s_4.html#clusterrole-pod","title":"\u5b9a\u4e49\u4e00\u4e2a ClusterRole\uff0c\u5141\u8bb8\u7528\u6237\u8bfb\u53d6\u96c6\u7fa4\u4e2d\u6240\u6709\u547d\u540d\u7a7a\u95f4\u7684 Pod","text":"<p>apiVersion: rbac.authorization.k8s.io/v1 kind: ClusterRole metadata:   name: cluster-pod-reader rules: - apiGroups: [\"\"]   resources: [\"pods\"]   verbs: [\"get\", \"list\", \"watch\"] ```</p>"},{"location":"devops/K8s_4.html#2-rolebinding-clusterrolebinding","title":"2. RoleBinding \u548c ClusterRoleBinding","text":"<ul> <li>RoleBinding \u5c06 Role \u7ed1\u5b9a\u5230\u4e00\u4e2a\u7528\u6237\u6216\u670d\u52a1\u8d26\u6237\u4e0a\uff0c\u4ece\u800c\u8d4b\u4e88\u8be5\u7528\u6237\u5bf9\u7279\u5b9a\u547d\u540d\u7a7a\u95f4\u7684\u8d44\u6e90\u7684\u8bbf\u95ee\u6743\u9650\u3002</li> <li>ClusterRoleBinding \u5c06 ClusterRole \u7ed1\u5b9a\u5230\u4e00\u4e2a\u7528\u6237\u6216\u670d\u52a1\u8d26\u6237\u4e0a\uff0c\u4ece\u800c\u8d4b\u4e88\u8be5\u7528\u6237\u5bf9\u6574\u4e2a\u96c6\u7fa4\u7684\u8d44\u6e90\u7684\u8bbf\u95ee\u6743\u9650\u3002</li> </ul>"},{"location":"devops/K8s_4.html#_2","title":"\u793a\u4f8b\uff1a","text":"<p>```yaml</p>"},{"location":"devops/K8s_4.html#rolebinding-pod-reader-role","title":"\u5b9a\u4e49\u4e00\u4e2a RoleBinding\uff0c\u5c06 pod-reader Role \u7ed1\u5b9a\u5230\u4e00\u4e2a\u7528\u6237\uff08\u6216\u670d\u52a1\u8d26\u6237\uff09\u4e0a","text":"<p>apiVersion: rbac.authorization.k8s.io/v1 kind: RoleBinding metadata:   name: read-pods-binding   namespace: dev subjects: - kind: User   name: jane  # \u7528\u6237\u540d\u79f0   apiGroup: rbac.authorization.k8s.io roleRef:   kind: Role   name: pod-reader   apiGroup: rbac.authorization.k8s.io ```</p> <p>```yaml</p>"},{"location":"devops/K8s_4.html#clusterrolebinding-cluster-pod-reader-clusterrole","title":"\u5b9a\u4e49\u4e00\u4e2a ClusterRoleBinding\uff0c\u5c06 cluster-pod-reader ClusterRole \u7ed1\u5b9a\u5230\u4e00\u4e2a\u7528\u6237\u4e0a","text":"<p>apiVersion: rbac.authorization.k8s.io/v1 kind: ClusterRoleBinding metadata:   name: cluster-read-pods-binding subjects: - kind: User   name: john  # \u7528\u6237\u540d\u79f0   apiGroup: rbac.authorization.k8s.io roleRef:   kind: ClusterRole   name: cluster-pod-reader   apiGroup: rbac.authorization.k8s.io ```</p>"},{"location":"devops/K8s_4.html#_3","title":"\u64cd\u4f5c\u6b65\u9aa4","text":"<ol> <li> <p>\u521b\u5efa Role \u6216 ClusterRole\uff1a</p> </li> <li> <p>\u4f7f\u7528 <code>kubectl apply -f role.yaml</code> \u547d\u4ee4\u521b\u5efa Role\u3002</p> </li> <li>\u4f7f\u7528 <code>kubectl apply -f clusterrole.yaml</code> \u547d\u4ee4\u521b\u5efa ClusterRole\u3002</li> <li> <p>\u521b\u5efa RoleBinding \u6216 ClusterRoleBinding\uff1a</p> </li> <li> <p>\u4f7f\u7528 <code>kubectl apply -f rolebinding.yaml</code> \u521b\u5efa RoleBinding\uff0c\u5c06 Role \u7ed1\u5b9a\u5230\u7528\u6237\u3002</p> </li> <li>\u4f7f\u7528 <code>kubectl apply -f clusterrolebinding.yaml</code> \u521b\u5efa ClusterRoleBinding\uff0c\u5c06 ClusterRole \u7ed1\u5b9a\u5230\u7528\u6237\u3002</li> <li> <p>\u9a8c\u8bc1\u6743\u9650\uff1a</p> </li> <li> <p>\u4f60\u53ef\u4ee5\u4f7f\u7528 <code>kubectl auth can-i</code> \u547d\u4ee4\u6765\u9a8c\u8bc1\u4e00\u4e2a\u7528\u6237\u662f\u5426\u5177\u6709\u7279\u5b9a\u64cd\u4f5c\u6743\u9650\u3002\u4f8b\u5982\uff1a      <code>sh      kubectl auth can-i list pods --namespace dev --as jane</code></p> </li> <li>\u4ee5\u4e0a\u547d\u4ee4\u4f1a\u8fd4\u56de <code>yes</code> \u6216 <code>no</code>\uff0c\u8868\u793a <code>jane</code> \u7528\u6237\u662f\u5426\u6709\u6743\u9650\u5217\u51fa <code>dev</code> \u547d\u540d\u7a7a\u95f4\u7684 Pod\u3002</li> </ol>"},{"location":"devops/K8s_4.html#_4","title":"\u603b\u7ed3","text":"<ul> <li>Role\uff1a\u4e3a\u67d0\u4e2a\u547d\u540d\u7a7a\u95f4\u5b9a\u4e49\u6743\u9650\u3002</li> <li>ClusterRole\uff1a\u4e3a\u96c6\u7fa4\u4e2d\u6240\u6709\u547d\u540d\u7a7a\u95f4\u6216\u96c6\u7fa4\u7ea7\u8d44\u6e90\u5b9a\u4e49\u6743\u9650\u3002</li> <li>RoleBinding\uff1a\u5c06\u4e00\u4e2a Role \u7ed1\u5b9a\u5230\u7528\u6237\u6216\u670d\u52a1\u8d26\u6237\u4e0a\uff0c\u4f7f\u5176\u5728\u547d\u540d\u7a7a\u95f4\u4e2d\u83b7\u5f97\u76f8\u5e94\u6743\u9650\u3002</li> <li>ClusterRoleBinding\uff1a\u5c06 ClusterRole \u7ed1\u5b9a\u5230\u7528\u6237\u6216\u670d\u52a1\u8d26\u6237\u4e0a\uff0c\u4f7f\u5176\u83b7\u5f97\u96c6\u7fa4\u7ea7\u6743\u9650\u3002</li> </ul> <p>\u901a\u8fc7\u7075\u6d3b\u5730\u914d\u7f6e\u8fd9\u4e9b\u8d44\u6e90\uff0cKubernetes \u7684\u8bbf\u95ee\u63a7\u5236\u53ef\u4ee5\u5f88\u597d\u5730\u5b9e\u73b0\u6700\u5c0f\u6743\u9650\u539f\u5219\uff0c\u4ece\u800c\u4fdd\u969c\u96c6\u7fa4\u7684\u5b89\u5168\u6027\u3002</p>"},{"location":"devops/K8s_4.html#62-podsecuritypolicy","title":"6.2 PodSecurityPolicy \u662f\u4ec0\u4e48\uff1f","text":"<p>PodSecurityPolicy \u662f\u4ec0\u4e48\uff1f- PodSecurityPolicy \u7528\u4e8e\u5b9a\u4e49\u548c\u63a7\u5236 Pod \u7684\u5b89\u5168\u7b56\u7565\uff0c\u6bd4\u5982\u662f\u5426\u5141\u8bb8\u7279\u6743\u5bb9\u5668\u3001\u6302\u8f7d\u5377\u7684\u7c7b\u578b\u7b49\u3002</p> <p>PodSecurityPolicy\uff08PSP\uff09\u662f Kubernetes \u63d0\u4f9b\u7684\u4e00\u79cd\u7528\u4e8e\u63a7\u5236\u548c\u5b9a\u4e49 Pod \u5b89\u5168\u6027\u8bbe\u7f6e\u7684\u7b56\u7565\u5bf9\u8c61\u3002\u901a\u8fc7 PodSecurityPolicy\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u5bf9 Pod \u7684\u5b89\u5168\u76f8\u5173\u5c5e\u6027\u8fdb\u884c\u9650\u5236\uff0c\u786e\u4fdd\u96c6\u7fa4\u4e2d\u7684 Pod \u9075\u5faa\u5b89\u5168\u7b56\u7565\uff0c\u51cf\u5c11\u6f5c\u5728\u7684\u5b89\u5168\u98ce\u9669\u3002</p>"},{"location":"devops/K8s_4.html#1-podsecuritypolicy","title":"1. PodSecurityPolicy \u7684\u4f5c\u7528","text":"<p>PodSecurityPolicy \u4e3b\u8981\u7528\u4e8e\u5b9a\u4e49\u548c\u63a7\u5236 Pod \u7684\u4ee5\u4e0b\u5b89\u5168\u8bbe\u7f6e\uff1a</p> <ul> <li>\u7279\u6743\u5bb9\u5668\uff1a\u662f\u5426\u5141\u8bb8 Pod \u8fd0\u884c\u4e3a\u7279\u6743\u5bb9\u5668\u3002</li> <li>\u5377\u6302\u8f7d\u7c7b\u578b\uff1a\u9650\u5236 Pod \u53ef\u6302\u8f7d\u7684\u5377\u7c7b\u578b\uff0c\u5982 <code>hostPath</code>\u3001<code>NFS</code> \u7b49\u3002</li> <li>\u5bbf\u4e3b\u673a\u6587\u4ef6\u7cfb\u7edf\uff1a\u63a7\u5236\u662f\u5426\u5141\u8bb8 Pod \u6302\u8f7d\u5bbf\u4e3b\u673a\u4e0a\u7684\u76ee\u5f55\u3002</li> <li>Linux \u80fd\u529b\uff1a\u9650\u5236\u5bb9\u5668\u4e2d\u6dfb\u52a0\u7684 Linux \u80fd\u529b\uff08Capabilities\uff09\u3002</li> <li>\u7528\u6237\u548c\u7ec4\uff1a\u63a7\u5236\u8fd0\u884c\u5bb9\u5668\u7684\u7528\u6237\u548c\u7ec4 ID\uff0c\u786e\u4fdd Pod \u4e0d\u4f1a\u4ee5\u7279\u6743\u7528\u6237\u8eab\u4efd\u8fd0\u884c\u3002</li> <li>Root \u6743\u9650\uff1a\u9650\u5236\u5bb9\u5668\u662f\u5426\u80fd\u4ee5 root \u8eab\u4efd\u8fd0\u884c\u3002</li> <li>SELinux\uff1a\u9650\u5236 Pod \u7684 SELinux \u4e0a\u4e0b\u6587\u3002</li> <li>AppArmor\uff1a\u5b9a\u4e49\u5bb9\u5668\u7684 AppArmor \u5b89\u5168\u914d\u7f6e\u3002</li> </ul> <p>\u901a\u8fc7 PSP\uff0c\u53ef\u4ee5\u63a7\u5236\u54ea\u4e9b Pod \u80fd\u591f\u5728\u96c6\u7fa4\u4e2d\u90e8\u7f72\uff0c\u9650\u5236\u7279\u5b9a\u884c\u4e3a\uff08\u4f8b\u5982\u4f7f\u7528\u7279\u6743\u5bb9\u5668\uff09\uff0c\u4ee5\u9632\u6b62\u67d0\u4e9b\u6076\u610f\u884c\u4e3a\u6216\u8bef\u64cd\u4f5c\u5bf9\u96c6\u7fa4\u9020\u6210\u7684\u6f5c\u5728\u5a01\u80c1\u3002</p>"},{"location":"devops/K8s_4.html#2-podsecuritypolicy","title":"2. PodSecurityPolicy \u793a\u4f8b","text":"<p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u5355\u7684 PodSecurityPolicy YAML \u6587\u4ef6\u793a\u4f8b\uff1a</p> <p><code>yaml apiVersion: policy/v1beta1 kind: PodSecurityPolicy metadata:   name: restricted spec:   privileged: false  # \u4e0d\u5141\u8bb8\u4f7f\u7528\u7279\u6743\u5bb9\u5668   allowPrivilegeEscalation: false  # \u4e0d\u5141\u8bb8\u6743\u9650\u63d0\u5347   seLinux:     rule: RunAsAny  # SELinux \u914d\u7f6e\u89c4\u5219   runAsUser:     rule: MustRunAsNonRoot  # \u5fc5\u987b\u4ee5\u975e root \u7528\u6237\u8fd0\u884c   fsGroup:     rule: MustRunAs     ranges:     - min: 1       max: 65535   volumes:   - 'configMap'   - 'emptyDir'   - 'projected'   - 'secret'</code></p> <p>\u8fd9\u4e2a\u7b56\u7565\u7981\u6b62\u4f7f\u7528\u7279\u6743\u5bb9\u5668\uff0c\u4e0d\u5141\u8bb8\u6743\u9650\u63d0\u5347\uff0c\u8981\u6c42 Pod \u4ee5\u975e root \u7528\u6237\u8eab\u4efd\u8fd0\u884c\uff0c\u5e76\u9650\u5236 Pod \u80fd\u591f\u6302\u8f7d\u7684\u5377\u7c7b\u578b\u3002</p>"},{"location":"devops/K8s_4.html#3-podsecuritypolicy","title":"3. \u542f\u7528\u548c\u4f7f\u7528 PodSecurityPolicy","text":"<ol> <li> <p>\u542f\u7528 PodSecurityPolicy\uff1a</p> </li> <li> <p>\u5728 Kubernetes 1.21 \u53ca\u4e4b\u524d\u7248\u672c\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7 API server \u53c2\u6570 <code>--enable-admission-plugins</code> \u542f\u7528 <code>PodSecurityPolicy</code>\u3002</p> </li> <li> <p>\u521b\u5efa PodSecurityPolicy\uff1a</p> </li> <li> <p>\u4f7f\u7528\u4e0a\u9762\u7684 YAML \u6587\u4ef6\u5b9a\u4e49 PodSecurityPolicy\uff0c\u7136\u540e\u901a\u8fc7 <code>kubectl apply -f psp.yaml</code> \u521b\u5efa\u5b83\u3002</p> </li> <li> <p>\u521b\u5efa RBAC \u7ed1\u5b9a\uff1a</p> </li> <li> <p>PSP \u672c\u8eab\u5e76\u4e0d\u4f1a\u81ea\u52a8\u751f\u6548\uff0c\u5fc5\u987b\u901a\u8fc7 RBAC\uff08Role-Based Access Control\uff09\u5c06\u5176\u4e0e\u7279\u5b9a\u7684\u7528\u6237\u6216\u670d\u52a1\u8d26\u6237\u7ed1\u5b9a\u3002\u53ef\u4ee5\u901a\u8fc7 RoleBinding \u6216 ClusterRoleBinding \u5c06 PodSecurityPolicy \u8d4b\u4e88\u7279\u5b9a\u7528\u6237\u3002</p> </li> </ol> <p><code>yaml apiVersion: rbac.authorization.k8s.io/v1 kind: Role metadata:   name: use-psp   namespace: default rules: - apiGroups:   - policy   resourceNames:   - restricted  # PodSecurityPolicy \u7684\u540d\u79f0   resources:   - podsecuritypolicies   verbs:   - use</code></p> <p><code>yaml apiVersion: rbac.authorization.k8s.io/v1 kind: RoleBinding metadata:   name: use-psp-binding   namespace: default roleRef:   apiGroup: rbac.authorization.k8s.io   kind: Role   name: use-psp subjects: - kind: ServiceAccount   name: default   namespace: default</code></p>"},{"location":"devops/K8s_4.html#4-podsecuritypolicy","title":"4. PodSecurityPolicy \u7684\u5f03\u7528","text":"<p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4ece Kubernetes 1.21 \u5f00\u59cb\uff0cPodSecurityPolicy \u5df2\u88ab\u6807\u8bb0\u4e3a\u5e9f\u5f03\uff0c\u5e76\u8ba1\u5212\u5728 Kubernetes 1.25 \u4e2d\u79fb\u9664\u3002\u4e3a\u4e86\u66ff\u4ee3 PSP\uff0cKubernetes \u793e\u533a\u63a8\u8350\u4f7f\u7528\u66f4\u73b0\u4ee3\u5316\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u5982 Pod Security Admission\uff08\u4e00\u79cd\u65b0\u7684\u5b89\u5168\u6a21\u5f0f\uff09\u6216\u7b2c\u4e09\u65b9\u5de5\u5177\uff0c\u4f8b\u5982 Open Policy Agent\uff08OPA\uff09\u3001Kyverno \u7b49\u3002</p> <p>Pod Security Admission \u4f7f\u7528\u4e09\u79cd\u7b56\u7565\u6765\u63a7\u5236 Pod \u7684\u5b89\u5168\u6027\uff1a</p> <ul> <li>Privileged\uff08\u7279\u6743\u7ea7\uff09\uff1a\u5141\u8bb8\u6240\u6709\u7684 Pod\uff0c\u5b89\u5168\u9650\u5236\u8f83\u5c11\u3002</li> <li>Baseline\uff08\u57fa\u7ebf\u7ea7\uff09\uff1a\u963b\u6b62\u4f7f\u7528\u4e0d\u5b89\u5168\u7684\u914d\u7f6e\uff0c\u4f8b\u5982\u7279\u6743\u5bb9\u5668\uff0c\u4f46\u5141\u8bb8\u666e\u901a\u5e94\u7528\u7a0b\u5e8f\u7684\u5e38\u89c1\u914d\u7f6e\u3002</li> <li>Restricted\uff08\u53d7\u9650\u7ea7\uff09\uff1a\u5bf9 Pod \u8fdb\u884c\u6700\u4e25\u683c\u7684\u5b89\u5168\u9650\u5236\uff0c\u9002\u7528\u4e8e\u9ad8\u5ea6\u5b89\u5168\u7684\u73af\u5883\u3002</li> </ul>"},{"location":"devops/K8s_4.html#_5","title":"\u603b\u7ed3","text":"<ul> <li>PodSecurityPolicy \u662f\u4e00\u79cd\u7528\u4e8e\u63a7\u5236 Pod \u5b89\u5168\u6027\u7684\u7b56\u7565\uff0c\u5e2e\u52a9\u7ba1\u7406\u5458\u5bf9 Pod \u7684\u5b89\u5168\u5c5e\u6027\u8fdb\u884c\u914d\u7f6e\u548c\u9650\u5236\u3002</li> <li>\u5b83\u63a7\u5236\u4e86\u5982\u7279\u6743\u5bb9\u5668\u3001\u6302\u8f7d\u5377\u7c7b\u578b\u3001\u7528\u6237 ID\u3001\u6743\u9650\u63d0\u5347\u7b49\u5b89\u5168\u8bbe\u7f6e\uff0c\u786e\u4fdd Pod \u8fd0\u884c\u65f6\u9075\u5faa\u96c6\u7fa4\u7684\u5b89\u5168\u6807\u51c6\u3002</li> <li>\u4ece Kubernetes 1.21 \u5f00\u59cb\uff0cPSP \u5df2\u88ab\u5e9f\u5f03\uff0c\u63a8\u8350\u4f7f\u7528 Pod Security Admission \u6216\u5176\u4ed6\u73b0\u4ee3\u5316\u7684\u66ff\u4ee3\u65b9\u6848\u3002</li> </ul>"},{"location":"devops/K8s_4.html#63-https","title":"6.3 \u914d\u7f6e HTTPS","text":"<p>\u5728 Kubernetes \u96c6\u7fa4\u4e2d\u542f\u7528 HTTPS \u662f\u786e\u4fdd\u96c6\u7fa4\u901a\u4fe1\u5b89\u5168\u7684\u91cd\u8981\u6b65\u9aa4\uff0c\u901a\u5e38\u5305\u62ec\u4ee5\u4e0b\u4e24\u90e8\u5206\uff1a</p> <ol> <li>\u4e3a\u96c6\u7fa4\u7684 API Server \u914d\u7f6e\u5b89\u5168\u8fde\u63a5\uff08HTTPS\uff09\u3002</li> <li>\u4f7f\u7528\u8bc1\u4e66\u7ba1\u7406\u5de5\u5177\uff08\u4f8b\u5982 cert-manager\uff09\u4e3a\u96c6\u7fa4\u4e2d\u7684\u5e94\u7528\u7a0b\u5e8f\u81ea\u52a8\u7ba1\u7406\u548c\u914d\u7f6e HTTPS\u3002</li> </ol> <p>\u4e0b\u9762\u5206\u522b\u8ba8\u8bba\u5982\u4f55\u5b9e\u73b0\u8fd9\u4e9b\u76ee\u6807\uff1a</p>"},{"location":"devops/K8s_4.html#1-kubernetes-api-server-https","title":"1. \u4e3a Kubernetes API Server \u914d\u7f6e HTTPS","text":"<p>Kubernetes API Server \u662f\u96c6\u7fa4\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u5b83\u4e3a\u5176\u4ed6\u7ec4\u4ef6\u63d0\u4f9b\u4ea4\u4e92\u63a5\u53e3\u3002\u4e3a API Server \u914d\u7f6e HTTPS\uff0c\u786e\u4fdd\u96c6\u7fa4\u901a\u4fe1\u7684\u5b89\u5168\u6027\uff0c\u53ef\u4ee5\u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\u8fdb\u884c\uff1a</p>"},{"location":"devops/K8s_4.html#11","title":"1.1 \u751f\u6210\u8bc1\u4e66\u548c\u5bc6\u94a5","text":"<p>\u9996\u5148\uff0cAPI Server \u9700\u8981\u4f7f\u7528 TLS \u8bc1\u4e66\u8fdb\u884c\u52a0\u5bc6\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528 <code>openssl</code> \u6216\u5176\u4ed6\u8bc1\u4e66\u7ba1\u7406\u5de5\u5177\u6765\u751f\u6210\u8bc1\u4e66\u548c\u79c1\u94a5\u3002</p> <p>\u4f7f\u7528 <code>openssl</code> \u751f\u6210\u81ea\u7b7e\u540d\u8bc1\u4e66\u793a\u4f8b\uff1a</p> <p>```sh</p>"},{"location":"devops/K8s_4.html#ca","title":"\u751f\u6210 CA \u8bc1\u4e66\u548c\u79c1\u94a5","text":"<p>openssl genrsa -out ca.key 2048 openssl req -x509 -new -nodes -key ca.key -subj \"/CN=kubernetes-ca\" -days 365 -out ca.crt</p>"},{"location":"devops/K8s_4.html#api-server","title":"\u751f\u6210 API Server \u79c1\u94a5","text":"<p>openssl genrsa -out apiserver.key 2048</p>"},{"location":"devops/K8s_4.html#api-server-csr","title":"\u751f\u6210 API Server CSR\uff08\u8bc1\u4e66\u7b7e\u540d\u8bf7\u6c42\uff09","text":"<p>openssl req -new -key apiserver.key -subj \"/CN=kubernetes-apiserver\" -out apiserver.csr</p>"},{"location":"devops/K8s_4.html#ca-api-server","title":"\u4f7f\u7528 CA \u7b7e\u7f72 API Server \u8bc1\u4e66","text":"<p>openssl x509 -req -in apiserver.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out apiserver.crt -days 365 ```</p>"},{"location":"devops/K8s_4.html#12-api-server","title":"1.2 \u914d\u7f6e API Server \u4f7f\u7528\u8bc1\u4e66","text":"<p>\u5c06\u751f\u6210\u7684\u8bc1\u4e66\u548c\u79c1\u94a5\u653e\u7f6e\u5728 Kubernetes API Server \u6240\u5728\u7684\u8282\u70b9\u4e0a\u3002\u4f60\u9700\u8981\u7f16\u8f91 Kubernetes API Server \u7684\u542f\u52a8\u914d\u7f6e\uff08\u901a\u5e38\u662f\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\u6216\u670d\u52a1\u542f\u52a8\u53c2\u6570\uff09\uff0c\u6dfb\u52a0\u5982\u4e0b\u53c2\u6570\uff1a</p> <p><code>sh --tls-cert-file=/path/to/apiserver.crt --tls-private-key-file=/path/to/apiserver.key --client-ca-file=/path/to/ca.crt</code></p> <ul> <li><code>--tls-cert-file</code>\uff1a\u6307\u5b9a API Server \u4f7f\u7528\u7684 TLS \u8bc1\u4e66\u8def\u5f84\u3002</li> <li><code>--tls-private-key-file</code>\uff1a\u6307\u5b9a API Server \u4f7f\u7528\u7684\u79c1\u94a5\u8def\u5f84\u3002</li> <li><code>--client-ca-file</code>\uff1a\u7528\u4e8e\u5bf9\u5ba2\u6237\u7aef\u8bc1\u4e66\u8fdb\u884c\u9a8c\u8bc1\u7684 CA \u8bc1\u4e66\u3002</li> </ul> <p>\u7f16\u8f91\u5b8c\u914d\u7f6e\u6587\u4ef6\u540e\uff0c\u91cd\u542f API Server \u670d\u52a1\u4ee5\u4f7f\u65b0\u914d\u7f6e\u751f\u6548\u3002</p>"},{"location":"devops/K8s_4.html#2-cert-manager","title":"2. \u4f7f\u7528 cert-manager \u7ba1\u7406\u8bc1\u4e66","text":"<p>\u5728 Kubernetes \u96c6\u7fa4\u4e2d\uff0c\u4e0d\u4ec5\u9700\u8981\u4e3a API Server \u542f\u7528 HTTPS\uff0c\u8fd8\u9700\u8981\u4e3a\u5e94\u7528\u7a0b\u5e8f\u542f\u7528 HTTPS\u3002cert-manager \u662f Kubernetes \u96c6\u7fa4\u4e2d\u975e\u5e38\u6d41\u884c\u7684\u81ea\u52a8\u5316\u8bc1\u4e66\u7ba1\u7406\u5de5\u5177\u3002</p>"},{"location":"devops/K8s_4.html#21-cert-manager","title":"2.1 cert-manager \u7b80\u4ecb","text":"<p>cert-manager \u662f Kubernetes \u4e0a\u7684\u4e00\u4e2a\u63a7\u5236\u5668\uff0c\u7528\u4e8e\u81ea\u52a8\u7ba1\u7406\u548c\u9881\u53d1 SSL/TLS \u8bc1\u4e66\u3002\u5b83\u53ef\u4ee5\u4f7f\u7528\u50cf Let\u2019s Encrypt \u8fd9\u6837\u7684\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\u6765\u7533\u8bf7\u548c\u81ea\u52a8\u66f4\u65b0\u8bc1\u4e66\uff0c\u786e\u4fdd\u96c6\u7fa4\u4e2d\u7684\u670d\u52a1\u59cb\u7ec8\u4f7f\u7528\u6709\u6548\u7684 HTTPS \u8fde\u63a5\u3002</p>"},{"location":"devops/K8s_4.html#22-cert-manager","title":"2.2 cert-manager \u5b89\u88c5","text":"<p>\u53ef\u4ee5\u4f7f\u7528 <code>kubectl</code> \u548c <code>Helm</code> \u5b89\u88c5 cert-manager\u3002\u4ee5\u4e0b\u662f Helm \u5b89\u88c5\u793a\u4f8b\uff1a</p> <ol> <li>\u6dfb\u52a0 cert-manager \u7684 Helm \u4ed3\u5e93\uff1a</li> </ol> <p><code>sh    helm repo add jetstack https://charts.jetstack.io    helm repo update</code> 2. \u4f7f\u7528 Helm \u5b89\u88c5 cert-manager\uff1a</p> <p><code>sh    kubectl create namespace cert-manager    helm install cert-manager jetstack/cert-manager --namespace cert-manager --version v1.9.1 \\      --set installCRDs=true</code></p> <p>\u5b89\u88c5\u5b8c\u6210\u540e\uff0ccert-manager \u5c06\u90e8\u7f72\u5728 <code>cert-manager</code> \u547d\u540d\u7a7a\u95f4\u4e2d\uff0c\u5e76\u5728\u96c6\u7fa4\u4e2d\u8fd0\u884c\u4ee5\u7ba1\u7406\u8bc1\u4e66\u3002</p>"},{"location":"devops/K8s_4.html#23-issuer-clusterissuer","title":"2.3 \u521b\u5efa Issuer \u548c ClusterIssuer","text":"<p>Issuer \u548c ClusterIssuer \u662f cert-manager \u4e2d\u5b9a\u4e49\u7684\u8d44\u6e90\uff0c\u7528\u4e8e\u6307\u5b9a\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\u3002Issuer \u7528\u4e8e\u7279\u5b9a\u547d\u540d\u7a7a\u95f4\uff0c\u800c ClusterIssuer \u53ef\u4ee5\u5728\u6574\u4e2a\u96c6\u7fa4\u4e2d\u4f7f\u7528\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f7f\u7528 Let\u2019s Encrypt \u521b\u5efa ClusterIssuer \u7684\u793a\u4f8b\uff1a</p> <p><code>yaml apiVersion: cert-manager.io/v1 kind: ClusterIssuer metadata:   name: letsencrypt-prod spec:   acme:     server: https://acme-v02.api.letsencrypt.org/directory     email: your-email@example.com  # \u7533\u8bf7\u8bc1\u4e66\u7684\u90ae\u7bb1     privateKeySecretRef:       name: letsencrypt-prod-private-key     solvers:     - http01:         ingress:           class: nginx  # \u6307\u5b9a Ingress \u63a7\u5236\u5668</code></p>"},{"location":"devops/K8s_4.html#24-ingress-https","title":"2.4 \u4e3a Ingress \u914d\u7f6e HTTPS","text":"<p>\u8981\u4e3a Kubernetes \u4e2d\u7684\u670d\u52a1\u542f\u7528 HTTPS\uff0c\u901a\u5e38\u7ed3\u5408 Ingress \u4f7f\u7528\u3002\u5728 Ingress \u4e2d\u5f15\u7528 cert-manager \u751f\u6210\u7684\u8bc1\u4e66\uff0c\u786e\u4fdd\u670d\u52a1\u901a\u8fc7 HTTPS \u5bf9\u5916\u66b4\u9732\u3002</p> <p>\u4ee5\u4e0b\u662f\u4e00\u4e2a Ingress \u914d\u7f6e\u793a\u4f8b\uff0c\u4f7f\u7528 cert-manager \u7533\u8bf7\u8bc1\u4e66\uff1a</p> <p><code>yaml apiVersion: networking.k8s.io/v1 kind: Ingress metadata:   name: example-ingress   namespace: default   annotations:     cert-manager.io/cluster-issuer: \"letsencrypt-prod\"     nginx.ingress.kubernetes.io/force-ssl-redirect: \"true\" spec:   tls:   - hosts:     - example.com     secretName: example-com-tls  # cert-manager \u5c06\u81ea\u52a8\u521b\u5efa\u8fd9\u4e2a secret   rules:   - host: example.com     http:       paths:       - path: /         pathType: Prefix         backend:           service:             name: example-service             port:               number: 80</code></p> <p>\u5728\u8fd9\u4e2a\u914d\u7f6e\u4e2d\uff1a</p> <ul> <li><code>cert-manager.io/cluster-issuer</code>\uff1a\u6307\u5b9a\u4f7f\u7528\u7684 ClusterIssuer\u3002</li> <li><code>tls</code>\uff1a\u5b9a\u4e49\u4f7f\u7528 TLS \u5e76\u521b\u5efa\u4e00\u4e2a <code>secret</code>\uff0c\u5b58\u50a8\u8bc1\u4e66\u548c\u79c1\u94a5\u3002</li> <li><code>nginx.ingress.kubernetes.io/force-ssl-redirect</code>\uff1a\u5f3a\u5236 HTTP \u8bf7\u6c42\u91cd\u5b9a\u5411\u5230 HTTPS\u3002</li> </ul> <p>\u5f53\u521b\u5efa\u4e86\u8fd9\u4e2a Ingress \u540e\uff0ccert-manager \u5c06\u81ea\u52a8\u5411 Let\u2019s Encrypt \u7533\u8bf7\u8bc1\u4e66\uff0c\u5e76\u5728 <code>example-com-tls</code> Secret \u4e2d\u4fdd\u5b58\u8bc1\u4e66\u548c\u5bc6\u94a5\u3002</p>"},{"location":"devops/K8s_4.html#_6","title":"\u603b\u7ed3","text":"<ul> <li>\u4e3a Kubernetes API Server \u914d\u7f6e HTTPS\uff0c\u53ef\u4ee5\u901a\u8fc7\u751f\u6210\u81ea\u7b7e\u540d\u8bc1\u4e66\u5e76\u914d\u7f6e API Server \u542f\u52a8\u53c2\u6570\u6765\u5b9e\u73b0\u3002</li> <li>cert-manager \u662f Kubernetes \u96c6\u7fa4\u4e2d\u7528\u4e8e\u7ba1\u7406 SSL/TLS \u8bc1\u4e66\u7684\u81ea\u52a8\u5316\u5de5\u5177\uff0c\u53ef\u4ee5\u4e0e Ingress \u4e00\u8d77\u4e3a\u96c6\u7fa4\u4e2d\u7684\u5e94\u7528\u670d\u52a1\u914d\u7f6e\u548c\u7ba1\u7406 HTTPS\u3002</li> <li>\u4f7f\u7528 cert-manager \u53ef\u4ee5\u663e\u8457\u7b80\u5316\u8bc1\u4e66\u7684\u7533\u8bf7\u3001\u7eed\u671f\u548c\u7ba1\u7406\u8fc7\u7a0b\uff0c\u786e\u4fdd\u96c6\u7fa4\u4e2d\u7684\u670d\u52a1\u59cb\u7ec8\u4fdd\u6301\u5b89\u5168\u901a\u4fe1\u3002</li> </ul>"},{"location":"devops/K8s_5.html","title":"K8s \u76f8\u5173\u95ee\u9898\u96c6\u9526\uff08\u4e94\uff09","text":""},{"location":"devops/K8s_5.html#7","title":"7 \u8fd0\u7ef4\u4e0e\u6545\u969c\u6392\u67e5\u7c7b","text":""},{"location":"devops/K8s_5.html#71","title":"7.1 \u67e5\u770b\u96c6\u7fa4\u7684\u5065\u5eb7\u72b6\u6001","text":"<p>\u4f7f\u7528 <code>kubectl get nodes</code> \u67e5\u770b\u8282\u70b9\u72b6\u6001\uff0c\u4f7f\u7528 <code>kubectl describe node</code> \u4e86\u89e3\u8282\u70b9\u8be6\u7ec6\u4fe1\u606f\u3002</p> <p>\u5728 Kubernetes \u96c6\u7fa4\u4e2d\uff0c\u67e5\u770b\u96c6\u7fa4\u7684\u5065\u5eb7\u72b6\u6001\u975e\u5e38\u91cd\u8981\uff0c\u901a\u5e38\u6211\u4eec\u4f1a\u901a\u8fc7 <code>kubectl</code> \u547d\u4ee4\u6765\u4e86\u89e3\u8282\u70b9\u3001Pod \u4ee5\u53ca\u5176\u4ed6\u7ec4\u4ef6\u7684\u72b6\u6001\u3002\u4ee5\u4e0b\u662f\u8be6\u7ec6\u64cd\u4f5c\u548c\u547d\u4ee4\uff0c\u5e2e\u52a9\u4f60\u5168\u9762\u4e86\u89e3 Kubernetes \u96c6\u7fa4\u7684\u5065\u5eb7\u72b6\u51b5\uff1a</p>"},{"location":"devops/K8s_5.html#1","title":"1. \u67e5\u770b\u8282\u70b9\u7684\u5065\u5eb7\u72b6\u6001","text":""},{"location":"devops/K8s_5.html#11-kubectl-get-nodes","title":"1.1 \u4f7f\u7528 <code>kubectl get nodes</code>","text":"<p>\u8fd9\u4e2a\u547d\u4ee4\u53ef\u4ee5\u5e2e\u52a9\u4f60\u5feb\u901f\u67e5\u770b\u96c6\u7fa4\u4e2d\u5404\u4e2a\u8282\u70b9\u7684\u72b6\u6001\uff0c\u5305\u62ec\u5b83\u4eec\u7684 <code>Ready</code> \u72b6\u6001\u4ee5\u53ca\u7248\u672c\u4fe1\u606f\u3002</p> <p><code>sh kubectl get nodes</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <p><code>sh NAME           STATUS   ROLES    AGE   VERSION node1          Ready    master   10d   v1.25.0 node2          Ready    &lt;none&gt;   10d   v1.25.0 node3          NotReady &lt;none&gt;   10d   v1.25.0</code></p> <ul> <li>STATUS\uff1a\u663e\u793a\u8282\u70b9\u7684\u72b6\u6001\u3002\u5e38\u89c1\u7684\u72b6\u6001\u6709 <code>Ready</code>\u3001<code>NotReady</code>\u3001<code>Unknown</code> \u7b49\u3002</li> <li>Ready\uff1a\u8282\u70b9\u6b63\u5e38\u3002</li> <li>NotReady\uff1a\u8282\u70b9\u672a\u51c6\u5907\u597d\uff0c\u53ef\u80fd\u6709\u7f51\u7edc\u95ee\u9898\u6216\u5176\u4ed6\u6545\u969c\u3002</li> </ul>"},{"location":"devops/K8s_5.html#12-kubectl-describe-node","title":"1.2 \u4f7f\u7528 <code>kubectl describe node</code>","text":"<p>\u8981\u67e5\u770b\u8282\u70b9\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f7f\u7528 <code>kubectl describe node</code> \u547d\u4ee4\u3002\u8fd9\u4f1a\u663e\u793a\u8be5\u8282\u70b9\u7684\u8be6\u7ec6\u914d\u7f6e\u548c\u72b6\u6001\u4fe1\u606f\uff0c\u4f8b\u5982\u5bb9\u91cf\u3001\u4f7f\u7528\u60c5\u51b5\u3001\u8fd0\u884c\u7684 Pod\u3001\u72b6\u6001\u4e8b\u4ef6\u7b49\u3002</p> <p><code>sh kubectl describe node &lt;node-name&gt;</code></p> <p>\u4f8b\u5982\uff1a</p> <p><code>sh kubectl describe node node1</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff08\u90e8\u5206\uff09\uff1a</p> <p><code>yaml Name:               node1 Roles:              master Labels:             kubernetes.io/hostname=node1                     node-role.kubernetes.io/master= CreationTimestamp:  Mon, 10 Oct 2024 12:00:00 +0800 Taints:             &lt;none&gt; Capacity:   cpu:              4   memory:           8Gi Allocatable:   cpu:              4   memory:           7.5Gi Conditions:   Type             Status    LastHeartbeatTime                 Reason          Message   ----             ------    -----------------                 ------          -------   Ready            True      Mon, 10 Oct 2024 12:01:00 +0800   KubeletReady    kubelet is posting ready status ...</code></p> <p>Conditions \u4e2d <code>Ready</code> \u7684\u72b6\u6001\u8868\u660e\u8282\u70b9\u662f\u5426\u53ef\u7528\uff1b\u5176\u4ed6\u5b57\u6bb5\u5982 <code>MemoryPressure</code>\u3001<code>DiskPressure</code> \u4e5f\u663e\u793a\u8282\u70b9\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u3002</p>"},{"location":"devops/K8s_5.html#2-pod","title":"2. \u67e5\u770b\u8282\u70b9\u4e2d\u7684 Pod \u72b6\u6001","text":""},{"location":"devops/K8s_5.html#21-kubectl-get-pods-o-wide-pod","title":"2.1 \u4f7f\u7528 <code>kubectl get pods -o wide</code> \u67e5\u770b Pod \u72b6\u6001","text":"<p>\u53ef\u4ee5\u67e5\u770b\u6574\u4e2a\u96c6\u7fa4\u7684 Pod \u72b6\u6001\uff0c\u5e76\u5305\u62ec\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982\u5b83\u4eec\u5728\u54ea\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\u3002</p> <p><code>sh kubectl get pods -o wide --all-namespaces</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <p><code>sh NAMESPACE     NAME                                  READY   STATUS    RESTARTS   AGE     IP            NODE kube-system   kube-dns-598d7fb7d4-5kfz2              3/3     Running   2          7d      10.244.1.2    node1 default       nginx-deployment-6d8ff7cc8b-qsdjf      1/1     Running   0          2d      10.244.2.4    node2</code></p> <ul> <li>READY\uff1a\u663e\u793a\u5bb9\u5668\u7684\u5c31\u7eea\u60c5\u51b5\uff0c\u5982 <code>1/1</code> \u8868\u793a 1 \u4e2a\u5bb9\u5668\u5df2\u7ecf\u5c31\u7eea\u3002</li> <li>STATUS\uff1aPod \u7684\u72b6\u6001\uff0c\u5305\u62ec <code>Running</code>\u3001<code>Pending</code>\u3001<code>Failed</code>\u3001<code>CrashLoopBackOff</code> \u7b49\u3002</li> <li>NODE\uff1a\u663e\u793a Pod \u6b63\u5728\u54ea\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\u3002</li> </ul>"},{"location":"devops/K8s_5.html#22-kubectl-describe-pod-pod","title":"2.2 \u4f7f\u7528 <code>kubectl describe pod</code> \u67e5\u770b Pod \u8be6\u60c5","text":"<p>\u5982\u679c\u67d0\u4e2a Pod \u51fa\u73b0\u4e86\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>kubectl describe pod</code> \u67e5\u770b\u8be5 Pod \u7684\u8be6\u7ec6\u72b6\u6001\u3001\u4e8b\u4ef6\u548c\u65e5\u5fd7\u3002</p> <p><code>sh kubectl describe pod &lt;pod-name&gt; -n &lt;namespace&gt;</code></p> <p>\u4f8b\u5982\uff1a</p> <p><code>sh kubectl describe pod nginx-deployment-6d8ff7cc8b-qsdjf -n default</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff08\u90e8\u5206\uff09\uff1a</p> <p><code>yaml Name:         nginx-deployment-6d8ff7cc8b-qsdjf Namespace:    default Node:         node2/192.168.1.11 Containers:   nginx:     Container ID:   docker://abc123     Image:          nginx:1.19.3     State:          Running     Ready:          True     Restart Count:  0 Events:   Type    Reason     Age   From               Message   ----    ------     ----  ----               -------   Normal  Scheduled  2d    default-scheduler  Successfully assigned default/nginx-deployment-6d8ff7cc8b-qsdjf to node2   Normal  Started    2d    kubelet            Started container nginx</code></p> <p>\u8fd9\u91cc\u7684 Events \u90e8\u5206\u53ef\u4ee5\u5e2e\u52a9\u8bca\u65ad Pod \u95ee\u9898\uff0c\u5982\u8c03\u5ea6\u5931\u8d25\u3001\u5bb9\u5668\u542f\u52a8\u5931\u8d25\u7b49\u3002</p>"},{"location":"devops/K8s_5.html#3","title":"3. \u67e5\u770b\u96c6\u7fa4\u7ec4\u4ef6\u7684\u5065\u5eb7\u72b6\u6001","text":""},{"location":"devops/K8s_5.html#31-kubectl-get-componentstatuses","title":"3.1 \u4f7f\u7528 <code>kubectl get componentstatuses</code>","text":"<p>\u53ef\u4ee5\u67e5\u770b Kubernetes \u96c6\u7fa4\u5173\u952e\u7ec4\u4ef6\uff08\u5982 scheduler\u3001controller-manager\uff09\u7684\u5065\u5eb7\u72b6\u6001\u3002</p> <p><code>sh kubectl get componentstatuses</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <p><code>sh NAME                 STATUS    MESSAGE             ERROR scheduler            Healthy   ok controller-manager   Healthy   ok etcd-0               Healthy   {\"health\":\"true\"}</code></p> <ul> <li>STATUS\uff1a\u663e\u793a\u7ec4\u4ef6\u7684\u5065\u5eb7\u72b6\u6001\uff0c\u5982\u679c\u4e3a <code>Healthy</code>\uff0c\u8868\u793a\u7ec4\u4ef6\u6b63\u5e38\u5de5\u4f5c\u3002</li> <li>MESSAGE\uff1a\u5305\u542b\u9644\u52a0\u4fe1\u606f\u3002</li> </ul>"},{"location":"devops/K8s_5.html#4","title":"4. \u67e5\u770b\u96c6\u7fa4\u7684\u8be6\u7ec6\u5065\u5eb7\u62a5\u544a","text":""},{"location":"devops/K8s_5.html#41-kubectl-get-events","title":"4.1 \u4f7f\u7528 <code>kubectl get events</code>","text":"<p>\u53ef\u4ee5\u67e5\u770b\u6574\u4e2a\u96c6\u7fa4\u4e2d\u7684\u4e8b\u4ef6\uff0c\u5305\u62ec\u8282\u70b9\u3001Pod\u3001\u670d\u52a1\u7b49\u7684\u4e8b\u4ef6\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4e8b\u4ef6\u53ef\u4ee5\u7528\u6765\u4e86\u89e3\u96c6\u7fa4\u4e2d\u662f\u5426\u53d1\u751f\u4e86\u4e00\u4e9b\u5f02\u5e38\u60c5\u51b5\u3002</p> <p><code>sh kubectl get events --all-namespaces</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <p><code>sh LAST SEEN   TYPE      REASON                    OBJECT                         MESSAGE 10s         Warning   BackOff                   pod/nginx-5bb69b79f9-ht4vh     Back-off restarting failed container 20s         Normal    ScalingReplicaSet         deployment/nginx-deployment    Scaled up replica set nginx-5bb69b79f9 to 3</code></p> <p>\u8fd9\u91cc\u53ef\u4ee5\u770b\u5230\u96c6\u7fa4\u4e2d\u5404\u4e2a\u7ec4\u4ef6\u7684\u4e8b\u4ef6\uff0c\u4f8b\u5982 Pod \u7684\u91cd\u542f\u3001\u8282\u70b9\u7684\u53d8\u5316\u7b49\u3002</p>"},{"location":"devops/K8s_5.html#5","title":"5. \u5176\u4ed6\u6709\u7528\u7684\u68c0\u67e5\u547d\u4ee4","text":"<ul> <li>\u67e5\u770b kube-system \u547d\u540d\u7a7a\u95f4\u4e2d\u7684 Pod \u72b6\u6001\uff0c\u68c0\u67e5\u5173\u952e\u7ec4\u4ef6\u662f\u5426\u6b63\u5e38\u8fd0\u884c\uff1a</li> </ul> <p><code>sh   kubectl get pods -n kube-system</code> - \u68c0\u67e5 kubelet \u670d\u52a1\u65e5\u5fd7\uff1a   \u5982\u679c\u8282\u70b9\u51fa\u73b0\u95ee\u9898\uff0c\u53ef\u4ee5\u5728\u8282\u70b9\u4e0a\u68c0\u67e5 <code>kubelet</code> \u670d\u52a1\u7684\u65e5\u5fd7\uff1a</p> <p><code>sh   journalctl -u kubelet</code></p>"},{"location":"devops/K8s_5.html#_1","title":"\u603b\u7ed3","text":"<ol> <li>\u67e5\u770b\u8282\u70b9\u7684\u72b6\u6001\uff1a\u4f7f\u7528 <code>kubectl get nodes</code>\uff0c\u5e76\u901a\u8fc7 <code>kubectl describe node</code> \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\u3002</li> <li>\u67e5\u770b Pod \u72b6\u6001\uff1a\u4f7f\u7528 <code>kubectl get pods -o wide --all-namespaces</code> \u548c <code>kubectl describe pod</code>\u3002</li> <li>\u67e5\u770b\u5173\u952e\u7ec4\u4ef6\u5065\u5eb7\u72b6\u6001\uff1a\u4f7f\u7528 <code>kubectl get componentstatuses</code>\u3002</li> <li>\u67e5\u770b\u96c6\u7fa4\u4e8b\u4ef6\uff1a\u4f7f\u7528 <code>kubectl get events --all-namespaces</code>\u3002</li> <li>\u68c0\u67e5 kubelet \u670d\u52a1\u65e5\u5fd7\uff1a\u5728\u8282\u70b9\u4e0a\u67e5\u770b kubelet \u65e5\u5fd7\uff0c\u6392\u67e5\u8282\u70b9\u95ee\u9898\u3002</li> </ol> <p>\u901a\u8fc7\u8fd9\u4e9b\u547d\u4ee4\uff0c\u53ef\u4ee5\u5168\u9762\u4e86\u89e3 Kubernetes \u96c6\u7fa4\u7684\u5065\u5eb7\u72b6\u6001\uff0c\u53ca\u65f6\u53d1\u73b0\u5e76\u5904\u7406\u6f5c\u5728\u95ee\u9898\u3002</p>"},{"location":"devops/K8s_5.html#72-service","title":"7.2 \u8c03\u8bd5\u65e0\u6cd5\u8bbf\u95ee\u7684 Service","text":"<p>\u53ef\u80fd\u9700\u8981\u68c0\u67e5 Service\u3001Endpoint\u3001Pod \u72b6\u6001\uff0c\u9a8c\u8bc1\u7f51\u7edc\u7b56\u7565\uff0c\u4f7f\u7528 <code>kubectl exec</code> \u8fdb\u5165\u5bb9\u5668\u8fdb\u884c\u7f51\u7edc\u6d4b\u8bd5\u3002</p> <p>\u5728 Kubernetes \u4e2d\uff0cService \u8d1f\u8d23\u5c06\u8bf7\u6c42\u5206\u53d1\u5230\u540e\u7aef Pod\uff0c\u4ece\u800c\u5b9e\u73b0\u5e94\u7528\u7684\u8d1f\u8f7d\u5747\u8861\u3002\u7136\u800c\uff0c\u6709\u65f6\u4f60\u53ef\u80fd\u4f1a\u9047\u5230 Service \u65e0\u6cd5\u8bbf\u95ee\u7684\u60c5\u51b5\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8c03\u8bd5\u6b65\u9aa4\u4e3b\u8981\u5305\u62ec\u68c0\u67e5 Service\u3001Endpoint\u3001Pod \u7684\u72b6\u6001\uff0c\u9a8c\u8bc1\u7f51\u7edc\u7b56\u7565\uff0c\u5e76\u8fdb\u5165\u5bb9\u5668\u8fdb\u884c\u7f51\u7edc\u6d4b\u8bd5\u3002\u4ee5\u4e0b\u662f\u8be6\u7ec6\u7684\u8c03\u8bd5\u6b65\u9aa4\u548c\u64cd\u4f5c\u547d\u4ee4\uff1a</p>"},{"location":"devops/K8s_5.html#1-service","title":"1. \u68c0\u67e5 Service \u7684\u72b6\u6001","text":"<p>\u9996\u5148\u68c0\u67e5 Service \u662f\u5426\u5b58\u5728\uff0c\u7c7b\u578b\u662f\u5426\u6b63\u786e\uff0c\u662f\u5426\u66b4\u9732\u4e86\u671f\u671b\u7684\u7aef\u53e3\u3002</p>"},{"location":"devops/K8s_5.html#11-kubectl-get-services","title":"1.1 \u4f7f\u7528 <code>kubectl get services</code>","text":"<p><code>sh kubectl get svc -n &lt;namespace&gt;</code></p> <p>\u4f8b\u5982\uff1a</p> <p><code>sh kubectl get svc -n default</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <p><code>sh NAME           TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)        AGE my-service     ClusterIP   10.0.0.1        &lt;none&gt;        80/TCP         3d</code></p> <ul> <li>CLUSTER-IP\uff1a\u68c0\u67e5\u662f\u5426\u6709\u6709\u6548\u7684 Cluster IP \u5730\u5740\u3002</li> <li>PORT(S)\uff1a\u786e\u4fdd\u670d\u52a1\u7684\u7aef\u53e3\u8bbe\u7f6e\u6b63\u786e\u3002</li> </ul>"},{"location":"devops/K8s_5.html#12-kubectl-describe-service","title":"1.2 \u4f7f\u7528 <code>kubectl describe service</code>","text":"<p><code>sh kubectl describe svc &lt;service-name&gt; -n &lt;namespace&gt;</code></p> <p>\u4f8b\u5982\uff1a</p> <p><code>sh kubectl describe svc my-service -n default</code></p> <p>\u68c0\u67e5\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <ul> <li>Selectors\uff1a\u786e\u4fdd Service \u7684 selector \u4e0e Pod \u7684\u6807\u7b7e\u5339\u914d\u3002</li> <li>Endpoints\uff1a\u786e\u4fdd Service \u5df2\u6b63\u786e\u5173\u8054\u5230 Pod\u3002\u5982\u679c <code>Endpoints</code> \u4e3a\u7a7a\uff0c\u8bf4\u660e\u6ca1\u6709 Pod \u88ab\u7ed1\u5b9a\u5230\u8be5 Service\u3002</li> </ul>"},{"location":"devops/K8s_5.html#2-endpoint","title":"2. \u68c0\u67e5 Endpoint \u7684\u72b6\u6001","text":"<p>Service \u662f\u901a\u8fc7 Endpoint \u5173\u8054 Pod \u7684\uff0c\u786e\u4fdd Service \u5177\u5907\u6709\u6548\u7684 Endpoint\u3002</p>"},{"location":"devops/K8s_5.html#21-kubectl-get-endpoints","title":"2.1 \u4f7f\u7528 <code>kubectl get endpoints</code>","text":"<p><code>sh kubectl get endpoints &lt;service-name&gt; -n &lt;namespace&gt;</code></p> <p>\u4f8b\u5982\uff1a</p> <p><code>sh kubectl get endpoints my-service -n default</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <p><code>sh NAME         ENDPOINTS           AGE my-service   10.244.1.2:80       3d</code></p> <ul> <li>\u5982\u679c <code>ENDPOINTS</code> \u4e3a\u7a7a\uff0c\u8bf4\u660e\u6ca1\u6709 Pod \u88ab\u5173\u8054\u5230 Service\u3002\u4f60\u9700\u8981\u68c0\u67e5 Pod \u7684\u6807\u7b7e\u662f\u5426\u4e0e Service \u7684 selector \u5339\u914d\u3002</li> </ul>"},{"location":"devops/K8s_5.html#3-pod","title":"3. \u68c0\u67e5 Pod \u7684\u72b6\u6001","text":"<p>\u786e\u8ba4 Pod \u662f\u5426\u5728\u8fd0\u884c\uff0c\u4e14\u65e0\u5f02\u5e38\u3002</p>"},{"location":"devops/K8s_5.html#31-kubectl-get-pods","title":"3.1 \u4f7f\u7528 <code>kubectl get pods</code>","text":"<p><code>sh kubectl get pods -n &lt;namespace&gt; -o wide</code></p> <p>\u4f8b\u5982\uff1a</p> <p><code>sh kubectl get pods -n default -o wide</code></p> <ul> <li>\u786e\u4fdd Pod \u7684\u72b6\u6001\u4e3a <code>Running</code>\uff0c\u5e76\u6ce8\u610f Pod \u6240\u5728\u8282\u70b9\u3002</li> <li>RESTARTS \u8ba1\u6570\uff1a\u5982\u679c Pod \u591a\u6b21\u91cd\u542f\uff0c\u53ef\u80fd\u5b58\u5728\u914d\u7f6e\u95ee\u9898\u6216\u5d29\u6e83\u3002</li> </ul>"},{"location":"devops/K8s_5.html#32-kubectl-describe-pod","title":"3.2 \u4f7f\u7528 <code>kubectl describe pod</code>","text":"<p>\u5982\u679c Pod \u65e0\u6cd5\u8fd0\u884c\u6216\u72b6\u6001\u5f02\u5e38\uff0c\u4f7f\u7528 <code>kubectl describe</code> \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\u548c\u4e8b\u4ef6\u3002</p> <p><code>sh kubectl describe pod &lt;pod-name&gt; -n &lt;namespace&gt;</code></p> <ul> <li>\u68c0\u67e5 Events \u90e8\u5206\uff0c\u5bfb\u627e\u542f\u52a8\u5931\u8d25\u3001\u63a2\u9488\u5931\u8d25\u7b49\u9519\u8bef\u4fe1\u606f\u3002</li> </ul>"},{"location":"devops/K8s_5.html#4_1","title":"4. \u9a8c\u8bc1\u7f51\u7edc\u7b56\u7565","text":"<p>Kubernetes \u4e2d\u53ef\u4ee5\u901a\u8fc7 NetworkPolicy \u63a7\u5236\u7f51\u7edc\u6d41\u91cf\uff0c\u5982\u679c\u5b58\u5728\u9519\u8bef\u7684\u7b56\u7565\u914d\u7f6e\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u65e0\u6cd5\u8bbf\u95ee Service\u3002</p>"},{"location":"devops/K8s_5.html#41-kubectl-get-networkpolicies","title":"4.1 \u4f7f\u7528 <code>kubectl get networkpolicies</code>","text":"<p><code>sh kubectl get networkpolicies -n &lt;namespace&gt;</code></p> <p>\u67e5\u770b\u662f\u5426\u5b58\u5728\u7f51\u7edc\u7b56\u7565\u6765\u963b\u6b62\u5bf9 Service \u6216 Pod \u7684\u8bbf\u95ee\u3002</p>"},{"location":"devops/K8s_5.html#42-kubectl-describe-networkpolicy","title":"4.2 \u4f7f\u7528 <code>kubectl describe networkpolicy</code>","text":"<p><code>sh kubectl describe networkpolicy &lt;networkpolicy-name&gt; -n &lt;namespace&gt;</code></p> <p>\u68c0\u67e5\u7b56\u7565\u914d\u7f6e\uff0c\u786e\u4fdd\u5141\u8bb8\u6240\u9700\u7684\u5165\u7ad9\u548c\u51fa\u7ad9\u6d41\u91cf\u3002</p>"},{"location":"devops/K8s_5.html#5-kubectl-exec","title":"5. \u4f7f\u7528 <code>kubectl exec</code> \u8fdb\u884c\u7f51\u7edc\u6d4b\u8bd5","text":"<p>\u8fdb\u5165 Pod\uff0c\u68c0\u67e5\u662f\u5426\u80fd\u591f\u8bbf\u95ee\u76ee\u6807 Pod \u7684 IP \u548c\u7aef\u53e3\uff0c\u6216\u8005\u6d4b\u8bd5\u8bbf\u95ee Service \u7684 Cluster IP\u3002</p>"},{"location":"devops/K8s_5.html#51-kubectl-exec-pod","title":"5.1 \u4f7f\u7528 <code>kubectl exec</code> \u8fdb\u5165 Pod","text":"<p><code>sh kubectl exec -it &lt;pod-name&gt; -n &lt;namespace&gt; -- /bin/sh</code></p> <p>\u4f8b\u5982\uff1a</p> <p><code>sh kubectl exec -it nginx-deployment-5bb69b79f9-ht4vh -n default -- /bin/sh</code></p>"},{"location":"devops/K8s_5.html#52-curl-wget","title":"5.2 \u4f7f\u7528 <code>curl</code> \u6216 <code>wget</code> \u6d4b\u8bd5\u7f51\u7edc\u8fde\u63a5","text":"<p>\u5728 Pod \u5185\u90e8\uff0c\u4f7f\u7528 <code>curl</code> \u6216 <code>wget</code> \u547d\u4ee4\u6d4b\u8bd5\u4e0e Service \u6216 Pod \u7684\u8fde\u63a5\uff1a</p> <ul> <li>\u6d4b\u8bd5\u901a\u8fc7 Service Cluster IP \u8bbf\u95ee\uff1a   <code>sh   curl http://&lt;service-cluster-ip&gt;:&lt;port&gt;</code></li> <li>\u6d4b\u8bd5\u901a\u8fc7 Pod \u7684 IP \u8bbf\u95ee\uff1a   <code>sh   curl http://&lt;pod-ip&gt;:&lt;port&gt;</code></li> </ul> <p>\u5982\u679c\u80fd\u591f\u901a\u8fc7 Pod \u7684 IP \u8bbf\u95ee\uff0c\u4f46\u65e0\u6cd5\u901a\u8fc7 Service \u7684 Cluster IP \u8bbf\u95ee\uff0c\u5219\u53ef\u80fd\u662f Service \u6216 Endpoint \u914d\u7f6e\u6709\u95ee\u9898\u3002</p>"},{"location":"devops/K8s_5.html#6-dns","title":"6. \u68c0\u67e5 DNS \u670d\u52a1","text":"<p>\u5982\u679c Service \u662f\u901a\u8fc7\u57df\u540d\u8bbf\u95ee\u7684\uff0c\u9700\u8981\u786e\u4fdd Kubernetes DNS \u670d\u52a1\u6b63\u5e38\u5de5\u4f5c\u3002</p>"},{"location":"devops/K8s_5.html#61-dns-pod","title":"6.1 \u68c0\u67e5 DNS Pod","text":"<p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b <code>kube-dns</code> \u6216 <code>coredns</code> \u7684\u72b6\u6001\uff1a</p> <p><code>sh kubectl get pods -n kube-system -l k8s-app=kube-dns</code></p> <p>\u786e\u4fdd DNS Pod \u5904\u4e8e <code>Running</code> \u72b6\u6001\u3002</p>"},{"location":"devops/K8s_5.html#62-dns","title":"6.2 \u6d4b\u8bd5 DNS \u89e3\u6790","text":"<p>\u8fdb\u5165 Pod \u4e2d\u6d4b\u8bd5\u57df\u540d\u89e3\u6790\uff1a</p> <p><code>sh kubectl exec -it &lt;pod-name&gt; -n &lt;namespace&gt; -- nslookup &lt;service-name&gt;</code></p> <p>\u5982\u679c DNS \u65e0\u6cd5\u89e3\u6790\uff0c\u5219\u53ef\u80fd\u662f <code>kube-dns</code> \u6216 <code>coredns</code> \u7684\u95ee\u9898\uff0c\u9700\u8981\u8fdb\u4e00\u6b65\u68c0\u67e5 DNS Pod \u7684\u65e5\u5fd7\u3002</p>"},{"location":"devops/K8s_5.html#7-kube-proxy-ip","title":"7. \u68c0\u67e5 Kube Proxy \u548c IP \u8def\u7531","text":"<p>Service \u7684\u6d41\u91cf\u901a\u8fc7 kube-proxy \u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\uff0c\u5982\u679c kube-proxy \u51fa\u73b0\u95ee\u9898\uff0c\u4e5f\u4f1a\u5bfc\u81f4\u670d\u52a1\u4e0d\u53ef\u7528\u3002</p>"},{"location":"devops/K8s_5.html#71-kube-proxy-pod","title":"7.1 \u67e5\u770b kube-proxy Pod \u72b6\u6001","text":"<p><code>sh kubectl get pods -n kube-system -l k8s-app=kube-proxy</code></p> <p>\u786e\u4fdd kube-proxy Pod \u6b63\u5e38\u8fd0\u884c\u3002</p>"},{"location":"devops/K8s_5.html#72-ip","title":"7.2 \u68c0\u67e5\u8282\u70b9 IP \u8def\u7531","text":"<p>\u5728\u8282\u70b9\u4e0a\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b iptables \u89c4\u5219\uff0c\u4ee5\u786e\u4fdd kube-proxy \u6b63\u5e38\u914d\u7f6e\uff1a</p> <p><code>sh iptables -t nat -L -n | grep &lt;service-name&gt;</code></p> <p>\u786e\u4fdd\u6d41\u91cf\u8f6c\u53d1\u89c4\u5219\u6b63\u786e\u3002</p>"},{"location":"devops/K8s_5.html#_2","title":"\u603b\u7ed3","text":"<ol> <li>\u68c0\u67e5 Service \u7684\u72b6\u6001\uff1a\u4f7f\u7528 <code>kubectl get svc</code> \u548c <code>kubectl describe svc</code> \u786e\u8ba4 Service \u7684\u914d\u7f6e\u662f\u5426\u6b63\u786e\u3002</li> <li>\u68c0\u67e5 Endpoint\uff1a\u4f7f\u7528 <code>kubectl get endpoints</code> \u786e\u8ba4 Pod \u662f\u5426\u6b63\u786e\u5173\u8054\u5230 Service\u3002</li> <li>\u68c0\u67e5 Pod \u7684\u72b6\u6001\uff1a\u4f7f\u7528 <code>kubectl get pods</code> \u548c <code>kubectl describe pod</code> \u786e\u4fdd Pod \u6b63\u5e38\u8fd0\u884c\u3002</li> <li>\u9a8c\u8bc1\u7f51\u7edc\u7b56\u7565\uff1a\u4f7f\u7528 <code>kubectl get networkpolicies</code> \u548c <code>kubectl describe networkpolicy</code> \u786e\u8ba4\u7f51\u7edc\u7b56\u7565\u4e0d\u4f1a\u963b\u6b62\u6d41\u91cf\u3002</li> <li>\u4f7f\u7528 <code>kubectl exec</code> \u8fdb\u884c\u7f51\u7edc\u6d4b\u8bd5\uff1a\u8fdb\u5165 Pod \u5185\u90e8\uff0c\u4f7f\u7528 <code>curl</code> \u6216 <code>wget</code> \u6d4b\u8bd5\u8fde\u63a5\u3002</li> <li>\u68c0\u67e5 DNS \u670d\u52a1\uff1a\u786e\u8ba4 DNS \u670d\u52a1\u6b63\u5e38\u5de5\u4f5c\u5e76\u53ef\u4ee5\u89e3\u6790 Service \u57df\u540d\u3002</li> <li>\u68c0\u67e5 kube-proxy\uff1a\u786e\u4fdd kube-proxy \u6b63\u5e38\u8fd0\u884c\uff0c\u67e5\u770b iptables \u89c4\u5219\u662f\u5426\u6b63\u786e\u3002</li> </ol> <p>\u901a\u8fc7\u8fd9\u4e9b\u6b65\u9aa4\uff0c\u53ef\u4ee5\u6709\u6548\u5730\u8c03\u8bd5\u65e0\u6cd5\u8bbf\u95ee\u7684 Kubernetes Service \u95ee\u9898\uff0c\u5e76\u9010\u6b65\u6392\u67e5\u670d\u52a1\u65e0\u6cd5\u8bbf\u95ee\u7684\u539f\u56e0\u3002</p>"},{"location":"devops/K8s_5.html#73-etcd","title":"7.3 \u5907\u4efd\u548c\u6062\u590d etcd \u6570\u636e","text":"<p>\u4f7f\u7528 <code>etcdctl</code> \u5de5\u5177\u8fdb\u884c\u5907\u4efd\u548c\u6062\u590d\uff0c\u786e\u4fdd\u6570\u636e\u5b89\u5168\u3002</p> <p>Kubernetes \u96c6\u7fa4\u4f7f\u7528 etcd \u4f5c\u4e3a\u5176\u5206\u5e03\u5f0f\u952e\u503c\u5b58\u50a8\uff0c\u5b58\u50a8\u7740\u6574\u4e2a\u96c6\u7fa4\u7684\u914d\u7f6e\u548c\u72b6\u6001\u6570\u636e\u3002\u56e0\u6b64\uff0c\u5907\u4efd\u548c\u6062\u590d etcd \u6570\u636e\u662f\u786e\u4fdd\u96c6\u7fa4\u5b89\u5168\u548c\u707e\u96be\u6062\u590d\u7684\u91cd\u8981\u6b65\u9aa4\u3002\u901a\u5e38\u4f7f\u7528 <code>etcdctl</code> \u5de5\u5177\u6765\u5907\u4efd\u548c\u6062\u590d etcd \u6570\u636e\u3002</p> <p>\u4ee5\u4e0b\u662f\u8be6\u7ec6\u64cd\u4f5c\u6b65\u9aa4\uff0c\u5305\u62ec\u5907\u4efd\u548c\u6062\u590d etcd \u6570\u636e\u7684\u65b9\u6cd5\uff1a</p>"},{"location":"devops/K8s_5.html#1-etcd","title":"1. etcd \u5907\u4efd","text":"<p>\u4e3a\u4e86\u786e\u4fdd Kubernetes \u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027\uff0c\u5efa\u8bae\u5b9a\u671f\u5bf9 etcd \u6570\u636e\u8fdb\u884c\u5907\u4efd\u3002</p>"},{"location":"devops/K8s_5.html#11","title":"1.1 \u524d\u63d0\u6761\u4ef6","text":"<ul> <li>etcdctl \u5de5\u5177\u5df2\u7ecf\u5b89\u88c5\u3002</li> <li>\u786e\u4fdd\u4e0e etcd \u670d\u52a1\u901a\u4fe1\u7684\u6b63\u786e\u8bbf\u95ee\u6743\u9650\u548c\u8bc1\u4e66\u3002</li> </ul> <p>\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b etcdctl \u7248\u672c\uff1a</p> <p><code>sh etcdctl version</code></p> <p>\u6ce8\u610f\uff1a\u5907\u4efd\u548c\u6062\u590d\u64cd\u4f5c\u9700\u8981\u4ee5 root \u7528\u6237\u6216\u5177\u6709\u76f8\u5e94\u6743\u9650\u7684\u7528\u6237\u6267\u884c\u3002</p>"},{"location":"devops/K8s_5.html#12","title":"1.2 \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf","text":"<p>\u8bbe\u7f6e\u4ee5\u4e0b\u73af\u5883\u53d8\u91cf\u4ee5\u4fbf etcdctl \u8bbf\u95ee etcd \u96c6\u7fa4\uff1a</p> <p><code>sh export ETCDCTL_API=3 export ETCDCTL_CACERT=/etc/kubernetes/pki/etcd/ca.crt export ETCDCTL_CERT=/etc/kubernetes/pki/etcd/server.crt export ETCDCTL_KEY=/etc/kubernetes/pki/etcd/server.key</code></p> <p>\u4ee5\u4e0a\u8def\u5f84\u662f etcd \u7684\u9ed8\u8ba4\u8bc1\u4e66\u8def\u5f84\uff0c\u5177\u4f53\u8def\u5f84\u53ef\u80fd\u56e0\u96c6\u7fa4\u914d\u7f6e\u4e0d\u540c\u800c\u6709\u6240\u5dee\u5f02\u3002</p>"},{"location":"devops/K8s_5.html#13-etcdctl-etcd","title":"1.3 \u4f7f\u7528 etcdctl \u5907\u4efd etcd \u6570\u636e","text":"<p>\u4f7f\u7528 <code>etcdctl snapshot save</code> \u547d\u4ee4\u8fdb\u884c\u5907\u4efd\uff0c\u5c06 etcd \u6570\u636e\u4fdd\u5b58\u4e3a\u5feb\u7167\u6587\u4ef6\u3002</p> <p><code>sh etcdctl --endpoints=https://127.0.0.1:2379 snapshot save /path/to/backup/etcd-backup.db</code></p> <ul> <li>--endpoints\uff1aetcd \u7684\u8bbf\u95ee\u5730\u5740\uff0c\u4e00\u822c\u4e3a\u672c\u5730\u5730\u5740 <code>https://127.0.0.1:2379</code>\u3002</li> <li>/path/to/backup/etcd-backup.db\uff1a\u4fdd\u5b58\u5907\u4efd\u7684\u8def\u5f84\uff0c\u5efa\u8bae\u5b58\u50a8\u5728\u5b89\u5168\u7684\u5730\u65b9\u3002</li> </ul> <p>\u6210\u529f\u5907\u4efd\u540e\uff0c\u4f1a\u663e\u793a\u7c7b\u4f3c\u4ee5\u4e0b\u8f93\u51fa\uff1a</p> <p><code>sh Snapshot saved at /path/to/backup/etcd-backup.db</code></p>"},{"location":"devops/K8s_5.html#2-etcd","title":"2. etcd \u6062\u590d","text":"<p>\u6062\u590d etcd \u6570\u636e\u9700\u8981\u4ece\u4e4b\u524d\u4fdd\u5b58\u7684\u5feb\u7167\u6587\u4ef6\u4e2d\u91cd\u5efa etcd \u96c6\u7fa4\uff0c\u901a\u5e38\u7528\u4e8e\u96c6\u7fa4\u4e2d etcd \u6570\u636e\u635f\u574f\u6216\u4e22\u5931\u7684\u60c5\u51b5\u3002</p>"},{"location":"devops/K8s_5.html#21-kube-apiserver","title":"2.1 \u505c\u6b62 kube-apiserver","text":"<p>\u5728\u6062\u590d etcd \u4e4b\u524d\uff0c\u5efa\u8bae\u5148\u505c\u6b62 Kubernetes API Server \u4ee5\u9632\u6b62\u96c6\u7fa4\u4e0e\u635f\u574f\u7684 etcd \u6570\u636e\u8fdb\u884c\u4ea4\u4e92\u3002</p> <p><code>sh systemctl stop kube-apiserver</code></p> <p>\u5728\u5927\u591a\u6570\u96c6\u7fa4\u4e2d\uff0ckube-apiserver \u662f\u901a\u8fc7 systemd \u8fdb\u884c\u7ba1\u7406\u7684\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528 <code>systemctl</code> \u547d\u4ee4\u3002</p>"},{"location":"devops/K8s_5.html#22-etcdctl","title":"2.2 \u4f7f\u7528 etcdctl \u6062\u590d\u5feb\u7167","text":"<p>\u4f7f\u7528 <code>etcdctl snapshot restore</code> \u547d\u4ee4\u4ece\u5907\u4efd\u6587\u4ef6\u4e2d\u6062\u590d etcd \u6570\u636e\u3002</p> <p><code>sh etcdctl snapshot restore /path/to/backup/etcd-backup.db --name &lt;etcd-node-name&gt; --data-dir /var/lib/etcd-restored</code></p> <ul> <li>/path/to/backup/etcd-backup.db\uff1a\u4e4b\u524d\u521b\u5efa\u7684\u5907\u4efd\u6587\u4ef6\u7684\u8def\u5f84\u3002</li> <li>--name\uff1aetcd \u8282\u70b9\u7684\u540d\u79f0\uff0c\u901a\u5e38\u53ef\u4ee5\u901a\u8fc7\u67e5\u770b\u539f etcd \u914d\u7f6e\u6587\u4ef6\u83b7\u5f97\u3002</li> <li>--data-dir\uff1a\u6062\u590d\u6570\u636e\u7684\u8def\u5f84\uff0c\u53ef\u4ee5\u662f <code>/var/lib/etcd</code>\uff0c\u4f46\u63a8\u8350\u4f7f\u7528\u4e0d\u540c\u7684\u76ee\u5f55\uff0c\u5982 <code>/var/lib/etcd-restored</code>\uff0c\u4ee5\u907f\u514d\u8986\u76d6\u73b0\u6709\u6570\u636e\u3002</li> </ul> <p>\u6210\u529f\u6062\u590d\u540e\uff0c\u4f1a\u663e\u793a\u7c7b\u4f3c\u4ee5\u4e0b\u8f93\u51fa\uff1a</p> <p><code>sh Snapshot restored and written to /var/lib/etcd-restored</code></p>"},{"location":"devops/K8s_5.html#23-etcd","title":"2.3 \u66f4\u65b0 etcd \u6570\u636e\u76ee\u5f55","text":"<p>\u6062\u590d\u5b8c\u6210\u540e\uff0c\u9700\u8981\u5c06 etcd \u670d\u52a1\u7684 <code>--data-dir</code> \u53c2\u6570\u6307\u5411\u6062\u590d\u540e\u7684\u6570\u636e\u76ee\u5f55\u3002\u4f8b\u5982\uff1a \u7f16\u8f91 etcd \u7684 systemd \u670d\u52a1\u6587\u4ef6 <code>/etc/systemd/system/etcd.service</code>\uff0c\u627e\u5230 <code>--data-dir</code> \u76f8\u5173\u914d\u7f6e\u5e76\u66f4\u65b0\u4e3a\u6062\u590d\u540e\u7684\u76ee\u5f55 <code>/var/lib/etcd-restored</code>\u3002</p> <p><code>sh --data-dir=/var/lib/etcd-restored</code></p>"},{"location":"devops/K8s_5.html#24-etcd-kube-apiserver","title":"2.4 \u542f\u52a8 etcd \u548c kube-apiserver","text":"<p>\u5b8c\u6210 etcd \u6062\u590d\u540e\uff0c\u91cd\u65b0\u542f\u52a8 etcd \u670d\u52a1\u548c kube-apiserver \u670d\u52a1\u3002</p> <p>```sh</p>"},{"location":"devops/K8s_5.html#etcd","title":"\u542f\u52a8 etcd \u670d\u52a1","text":"<p>systemctl daemon-reload systemctl start etcd</p>"},{"location":"devops/K8s_5.html#kube-apiserver","title":"\u542f\u52a8 kube-apiserver \u670d\u52a1","text":"<p>systemctl start kube-apiserver ```</p>"},{"location":"devops/K8s_5.html#3-etcd","title":"3. \u9a8c\u8bc1 etcd \u6062\u590d\u7ed3\u679c","text":""},{"location":"devops/K8s_5.html#31-etcd","title":"3.1 \u9a8c\u8bc1 etcd \u96c6\u7fa4\u5065\u5eb7\u72b6\u6001","text":"<p>\u4f7f\u7528 <code>etcdctl</code> \u67e5\u770b etcd \u96c6\u7fa4\u7684\u5065\u5eb7\u72b6\u6001\uff0c\u786e\u4fdd\u6062\u590d\u540e\u7684 etcd \u8282\u70b9\u5904\u4e8e\u6b63\u5e38\u72b6\u6001\u3002</p> <p><code>sh etcdctl --endpoints=https://127.0.0.1:2379 endpoint health</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <p><code>sh https://127.0.0.1:2379 is healthy: successfully committed proposal</code></p>"},{"location":"devops/K8s_5.html#32-kubernetes","title":"3.2 \u9a8c\u8bc1 Kubernetes \u96c6\u7fa4\u72b6\u6001","text":"<p>\u5728\u6062\u590d\u548c\u542f\u52a8\u6240\u6709\u670d\u52a1\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>kubectl</code> \u9a8c\u8bc1 Kubernetes \u96c6\u7fa4\u7684\u5065\u5eb7\u72b6\u6001\uff0c\u4f8b\u5982\u67e5\u770b\u8282\u70b9\u548c Pod \u7684\u72b6\u6001\uff1a</p> <p><code>sh kubectl get nodes kubectl get pods --all-namespaces</code></p> <p>\u786e\u4fdd\u6240\u6709\u7ec4\u4ef6\u6b63\u5e38\u8fd0\u884c\u3002</p>"},{"location":"devops/K8s_5.html#_3","title":"\u603b\u7ed3","text":"<ol> <li> <p>\u5907\u4efd etcd \u6570\u636e\uff1a</p> </li> <li> <p>\u4f7f\u7528 <code>etcdctl snapshot save</code> \u547d\u4ee4\u521b\u5efa\u5feb\u7167\u5907\u4efd\u3002</p> </li> <li>\u5b9a\u671f\u5907\u4efd\u5e76\u5c06\u5907\u4efd\u6587\u4ef6\u5b58\u50a8\u5728\u5b89\u5168\u4f4d\u7f6e\u3002</li> <li> <p>\u6062\u590d etcd \u6570\u636e\uff1a</p> </li> <li> <p>\u505c\u6b62 <code>kube-apiserver</code>\uff0c\u9632\u6b62\u4e0d\u5fc5\u8981\u7684\u64cd\u4f5c\u5f71\u54cd\u6062\u590d\u3002</p> </li> <li>\u4f7f\u7528 <code>etcdctl snapshot restore</code> \u547d\u4ee4\u4ece\u5feb\u7167\u6062\u590d\u6570\u636e\u3002</li> <li>\u66f4\u65b0 etcd \u7684 <code>--data-dir</code>\uff0c\u5e76\u91cd\u542f etcd \u548c <code>kube-apiserver</code> \u670d\u52a1\u3002</li> <li> <p>\u9a8c\u8bc1\uff1a</p> </li> <li> <p>\u4f7f\u7528 <code>etcdctl</code> \u9a8c\u8bc1 etcd \u96c6\u7fa4\u5065\u5eb7\u72b6\u6001\u3002</p> </li> <li>\u4f7f\u7528 <code>kubectl</code> \u67e5\u770b Kubernetes \u96c6\u7fa4\u4e2d\u8282\u70b9\u548c Pod \u7684\u72b6\u6001\uff0c\u786e\u4fdd\u6240\u6709\u7ec4\u4ef6\u6b63\u5e38\u8fd0\u884c\u3002</li> </ol> <p>\u901a\u8fc7\u4ee5\u4e0a\u6b65\u9aa4\uff0c\u80fd\u591f\u6709\u6548\u5730\u5907\u4efd\u548c\u6062\u590d etcd \u6570\u636e\uff0c\u4fdd\u969c Kubernetes \u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027\u548c\u6570\u636e\u5b89\u5168\u6027\u3002</p>"},{"location":"devops/K8s_5.html#74","title":"7.4 \u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u8d44\u6e90\u7d27\u5f20\u65f6\u5e94\u8be5\u600e\u4e48\u505a\uff1f","text":"<p>\u8003\u8651\u8282\u70b9\u6269\u5c55\u3001Pod \u8d44\u6e90\u914d\u989d\u7ba1\u7406\uff08\u5982 requests \u548c limits \u7684\u8bbe\u7f6e\uff09\uff0c\u6216\u8005\u4f7f\u7528 Node Affinity \u548c Taints/Tolerations \u8c03\u6574\u8c03\u5ea6\u7b56\u7565\u3002</p> <p>\u5728 Kubernetes \u96c6\u7fa4\u4e2d\uff0c\u5f53\u8282\u70b9\u8d44\u6e90\u7d27\u5f20\u65f6\uff0c\u9700\u8981\u5408\u7406\u7ba1\u7406\u548c\u8c03\u4f18\u8d44\u6e90\uff0c\u4ee5\u786e\u4fdd\u96c6\u7fa4\u7684\u7a33\u5b9a\u6027\u548c\u670d\u52a1\u7684\u6b63\u5e38\u8fd0\u884c\u3002\u4ee5\u4e0b\u662f\u5e94\u5bf9\u96c6\u7fa4\u8282\u70b9\u8d44\u6e90\u7d27\u5f20\u7684\u4e00\u4e9b\u89e3\u51b3\u65b9\u6848\uff1a</p>"},{"location":"devops/K8s_5.html#1_1","title":"1. \u8282\u70b9\u6269\u5c55\uff08\u6c34\u5e73\u6269\u5c55\u96c6\u7fa4\uff09","text":"<p>\u6700\u76f4\u63a5\u7684\u89e3\u51b3\u65b9\u6cd5\u662f\u901a\u8fc7\u6dfb\u52a0\u66f4\u591a\u7684\u8282\u70b9\u6765\u6269\u5c55\u96c6\u7fa4\u7684\u5bb9\u91cf\uff0c\u4ee5\u7f13\u89e3\u8d44\u6e90\u7d27\u5f20\u7684\u60c5\u51b5\u3002\u8fd9\u53ef\u4ee5\u624b\u52a8\u589e\u52a0\u8282\u70b9\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u81ea\u52a8\u6269\u5c55\u6765\u5b9e\u73b0\u3002</p>"},{"location":"devops/K8s_5.html#11_1","title":"1.1 \u624b\u52a8\u589e\u52a0\u8282\u70b9","text":"<ul> <li>\u624b\u52a8\u589e\u52a0\u865a\u62df\u673a\u6216\u7269\u7406\u673a\uff0c\u5e76\u5c06\u5176\u52a0\u5165 Kubernetes \u96c6\u7fa4\u3002</li> <li>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5c06\u65b0\u8282\u70b9\u52a0\u5165\u96c6\u7fa4\uff1a   <code>sh   kubeadm join &lt;master-ip&gt;:&lt;master-port&gt; --token &lt;token&gt; --discovery-token-ca-cert-hash sha256:&lt;hash&gt;</code></li> </ul> <p>\u4ee5\u4e0a\u547d\u4ee4\u9700\u8981\u5728\u65b0\u8282\u70b9\u4e0a\u6267\u884c\uff0c\u5e76\u901a\u8fc7\u9002\u5f53\u7684\u8ba4\u8bc1\u52a0\u5165\u5230\u73b0\u6709\u96c6\u7fa4\u4e2d\u3002</p>"},{"location":"devops/K8s_5.html#12-cluster-autoscaler","title":"1.2 \u81ea\u52a8\u6269\u5c55\uff08Cluster Autoscaler\uff09","text":"<ul> <li>Cluster Autoscaler \u662f Kubernetes \u63d0\u4f9b\u7684\u81ea\u52a8\u6269\u5c55\u7ec4\u4ef6\uff0c\u7528\u4e8e\u6839\u636e Pod \u8d44\u6e90\u9700\u6c42\u81ea\u52a8\u589e\u52a0\u6216\u51cf\u5c11\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u6570\u91cf\u3002</li> <li>\u914d\u7f6e Cluster Autoscaler \u540e\uff0c\u5b83\u4f1a\u81ea\u52a8\u68c0\u6d4b\u8282\u70b9\u8d44\u6e90\u4e0d\u8db3\u7684\u60c5\u51b5\uff0c\u5e76\u5411\u96c6\u7fa4\u4e2d\u6dfb\u52a0\u8282\u70b9\uff0c\u786e\u4fdd\u65b0\u521b\u5efa\u7684 Pod \u80fd\u591f\u6210\u529f\u8c03\u5ea6\u3002</li> </ul> <p>\u5b89\u88c5 Cluster Autoscaler \u7684\u6b65\u9aa4\uff1a</p> <ul> <li>\u53ef\u4ee5\u4f7f\u7528 Helm \u6216 <code>kubectl apply</code> \u5b89\u88c5 Cluster Autoscaler\uff0c\u5e76\u6839\u636e\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u7684\u8bbe\u7f6e\u8fdb\u884c\u914d\u7f6e\u3002</li> </ul>"},{"location":"devops/K8s_5.html#2-pod_1","title":"2. Pod \u8d44\u6e90\u914d\u989d\u7ba1\u7406","text":"<p>\u7ba1\u7406 Pod \u7684\u8d44\u6e90\u4f7f\u7528\u662f\u7f13\u89e3\u8d44\u6e90\u7d27\u5f20\u7684\u91cd\u8981\u624b\u6bb5\u3002\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e requests \u548c limits \u6765\u63a7\u5236\u5bb9\u5668\u7684 CPU \u548c\u5185\u5b58\u8d44\u6e90\u4f7f\u7528\u3002</p>"},{"location":"devops/K8s_5.html#21-requests-limits","title":"2.1 \u914d\u7f6e requests \u548c limits","text":"<ul> <li>requests\uff1a\u8868\u793a\u5bb9\u5668\u8fd0\u884c\u65f6\u9700\u8981\u7684\u6700\u4f4e\u8d44\u6e90\uff0c\u8c03\u5ea6\u5668\u4f1a\u6839\u636e requests \u786e\u5b9a Pod \u662f\u5426\u80fd\u88ab\u5206\u914d\u5230\u67d0\u4e2a\u8282\u70b9\u4e0a\u3002</li> <li>limits\uff1a\u8868\u793a\u5bb9\u5668\u6700\u591a\u53ef\u4ee5\u4f7f\u7528\u7684\u8d44\u6e90\u4e0a\u9650\uff0c\u7528\u4e8e\u9632\u6b62\u5355\u4e2a\u5bb9\u5668\u8fc7\u5ea6\u6d88\u8017\u8d44\u6e90\uff0c\u5f71\u54cd\u5176\u4ed6\u5bb9\u5668\u7684\u8fd0\u884c\u3002</li> </ul> <p>\u793a\u4f8b YAML \u6587\u4ef6\uff1a</p> <p><code>yaml apiVersion: v1 kind: Pod metadata:   name: resource-demo   namespace: default spec:   containers:   - name: resource-container     image: nginx     resources:       requests:         cpu: \"500m\"        # 500 \u6beb\u6838         memory: \"256Mi\"    # 256 MiB \u5185\u5b58       limits:         cpu: \"1\"           # 1 \u6838 CPU         memory: \"512Mi\"    # 512 MiB \u5185\u5b58</code></p> <p>\u901a\u8fc7\u5408\u7406\u8bbe\u7f6e requests \u548c limits\uff0c\u53ef\u4ee5\u907f\u514d Pod \u8fc7\u5ea6\u5360\u7528\u8282\u70b9\u8d44\u6e90\uff0c\u786e\u4fdd\u96c6\u7fa4\u8d44\u6e90\u80fd\u591f\u5408\u7406\u5206\u914d\u3002</p>"},{"location":"devops/K8s_5.html#3-node-affinity-taintstolerations","title":"3. \u4f7f\u7528 Node Affinity \u548c Taints/Tolerations \u8c03\u6574\u8c03\u5ea6\u7b56\u7565","text":"<p>\u8c03\u6574\u8c03\u5ea6\u7b56\u7565\u662f\u4f18\u5316\u8d44\u6e90\u5229\u7528\u7387\u3001\u51cf\u5c11\u8282\u70b9\u538b\u529b\u7684\u6709\u6548\u624b\u6bb5\u3002</p>"},{"location":"devops/K8s_5.html#31-node-affinity","title":"3.1 Node Affinity","text":"<p>Node Affinity \u662f Kubernetes \u8c03\u5ea6\u7b56\u7565\u7684\u4e00\u79cd\uff0c\u5b83\u5141\u8bb8\u7528\u6237\u5c06 Pod \u8c03\u5ea6\u5230\u7279\u5b9a\u5c5e\u6027\u7684\u8282\u70b9\u4e0a\u3002\u4f8b\u5982\uff0c\u5c06\u8ba1\u7b97\u5bc6\u96c6\u578b\u4efb\u52a1\u8c03\u5ea6\u5230\u9ad8\u6027\u80fd\u7684\u8282\u70b9\u3002</p> <p>Node Affinity \u793a\u4f8b\uff1a</p> <p><code>yaml apiVersion: v1 kind: Pod metadata:   name: affinity-demo spec:   affinity:     nodeAffinity:       requiredDuringSchedulingIgnoredDuringExecution:         nodeSelectorTerms:         - matchExpressions:           - key: node-type             operator: In             values:             - high-performance   containers:   - name: nginx     image: nginx</code></p> <p>\u901a\u8fc7\u4f7f\u7528 Node Affinity\uff0c\u53ef\u4ee5\u786e\u4fdd\u7279\u5b9a\u7684 Pod \u88ab\u8c03\u5ea6\u5230\u9002\u5408\u5176\u9700\u6c42\u7684\u8282\u70b9\u4e0a\uff0c\u907f\u514d\u5bf9\u8d44\u6e90\u7d27\u5f20\u8282\u70b9\u7684\u8fdb\u4e00\u6b65\u538b\u529b\u3002</p>"},{"location":"devops/K8s_5.html#32-taints-tolerations","title":"3.2 Taints \u548c Tolerations","text":"<p>Taints \u548c Tolerations \u7528\u4e8e\u63a7\u5236\u54ea\u4e9b Pod \u53ef\u4ee5\u8c03\u5ea6\u5230\u54ea\u4e9b\u8282\u70b9\u4e0a\u3002\u5f53\u8282\u70b9\u4e0a\u6253\u4e86 taint\uff0c\u53ea\u6709\u5e26\u6709\u76f8\u5e94 toleration \u7684 Pod \u624d\u80fd\u8c03\u5ea6\u5230\u8be5\u8282\u70b9\u3002</p> <p>Taints \u793a\u4f8b\uff1a</p> <p><code>sh kubectl taint nodes node1 key=value:NoSchedule</code></p> <p>\u8be5\u547d\u4ee4\u4f1a\u5728 <code>node1</code> \u8282\u70b9\u4e0a\u6253\u4e0a taint\uff0c\u53ea\u6709\u5305\u542b\u5bf9\u5e94 toleration \u7684 Pod \u624d\u80fd\u8c03\u5ea6\u5230\u8be5\u8282\u70b9\u4e0a\u3002</p> <p>Tolerations \u914d\u7f6e\uff1a</p> <p><code>yaml apiVersion: v1 kind: Pod metadata:   name: toleration-demo spec:   tolerations:   - key: \"key\"     operator: \"Equal\"     value: \"value\"     effect: \"NoSchedule\"   containers:   - name: nginx     image: nginx</code></p> <p>\u901a\u8fc7\u4f7f\u7528 Taints \u548c Tolerations\uff0c\u53ef\u4ee5\u628a\u67d0\u4e9b\u8282\u70b9\u7684\u8d44\u6e90\u4fdd\u62a4\u8d77\u6765\uff0c\u7528\u4e8e\u7279\u5b9a\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u907f\u514d\u6240\u6709 Pod \u88ab\u8c03\u5ea6\u5230\u540c\u4e00\u8282\u70b9\u9020\u6210\u8d44\u6e90\u7d27\u5f20\u3002</p>"},{"location":"devops/K8s_5.html#4-vertical-pod-autoscaler-horizontal-pod-autoscaler","title":"4. \u4f7f\u7528 Vertical Pod Autoscaler \u6216 Horizontal Pod Autoscaler","text":""},{"location":"devops/K8s_5.html#41-horizontal-pod-autoscalerhpa","title":"4.1 Horizontal Pod Autoscaler\uff08HPA\uff09","text":"<p>HPA \u53ef\u4ee5\u6839\u636e CPU \u4f7f\u7528\u7387\u6216\u81ea\u5b9a\u4e49\u6307\u6807\u81ea\u52a8\u8c03\u6574 Deployment\u3001ReplicaSet \u7b49\u8d44\u6e90\u7684\u526f\u672c\u6570\u91cf\uff0c\u5e73\u8861\u8282\u70b9\u95f4\u7684\u8d1f\u8f7d\uff0c\u51cf\u5c11\u5355\u4e2a\u8282\u70b9\u7684\u8d44\u6e90\u7d27\u5f20\u3002</p> <p>\u793a\u4f8b HPA \u914d\u7f6e\uff1a</p> <p><code>sh kubectl autoscale deployment my-deployment --cpu-percent=50 --min=1 --max=10</code></p> <ul> <li>--cpu-percent\uff1a\u5f53 CPU \u4f7f\u7528\u7387\u8d85\u8fc7 50% \u65f6\uff0cHPA \u5c06\u81ea\u52a8\u589e\u52a0\u526f\u672c\u6570\u91cf\u3002</li> </ul>"},{"location":"devops/K8s_5.html#42-vertical-pod-autoscalervpa","title":"4.2 Vertical Pod Autoscaler\uff08VPA\uff09","text":"<p>VPA \u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u52a8\u6001\u8c03\u6574 Pod \u7684 CPU \u548c\u5185\u5b58 requests/limits\uff0c\u786e\u4fdd\u8d44\u6e90\u5229\u7528\u7387\u6700\u5927\u5316\uff0c\u5e76\u51cf\u5c11\u8d44\u6e90\u6d6a\u8d39\u3002</p> <p>\u5b89\u88c5 VPA \u53ef\u4ee5\u901a\u8fc7 Helm \u6216\u76f4\u63a5\u5e94\u7528 VPA \u7684 YAML \u6587\u4ef6\uff0c\u5177\u4f53\u914d\u7f6e\u53c2\u8003 Kubernetes \u5b98\u65b9\u6587\u6863\u3002</p>"},{"location":"devops/K8s_5.html#5-resource-quotalimitrange","title":"5. \u8d44\u6e90\u914d\u989d\uff08Resource Quota\uff09\u548c\u9650\u5236\u8303\u56f4\uff08LimitRange\uff09","text":"<p>\u4e3a\u786e\u4fdd\u4e0d\u540c\u547d\u540d\u7a7a\u95f4\u4e4b\u95f4\u7684\u8d44\u6e90\u516c\u5e73\u5206\u914d\uff0c\u53ef\u4ee5\u4f7f\u7528 Resource Quota \u548c LimitRange\u3002</p>"},{"location":"devops/K8s_5.html#51-resource-quota","title":"5.1 Resource Quota","text":"<p>Resource Quota \u7528\u4e8e\u9650\u5236\u547d\u540d\u7a7a\u95f4\u7ea7\u522b\u7684\u8d44\u6e90\u4f7f\u7528\uff0c\u9632\u6b62\u67d0\u4e00\u547d\u540d\u7a7a\u95f4\u72ec\u5360\u96c6\u7fa4\u8d44\u6e90\u3002</p> <p>\u793a\u4f8b Resource Quota\uff1a</p> <p><code>yaml apiVersion: v1 kind: ResourceQuota metadata:   name: ns-quota   namespace: default spec:   hard:     pods: \"10\"  # \u9650\u5236\u6700\u591a\u53ef\u4ee5\u521b\u5efa 10 \u4e2a Pod     requests.cpu: \"4\"  # CPU \u8bf7\u6c42\u603b\u91cf\u4e0d\u80fd\u8d85\u8fc7 4 \u6838     requests.memory: \"8Gi\"  # \u5185\u5b58\u8bf7\u6c42\u603b\u91cf\u4e0d\u80fd\u8d85\u8fc7 8 GiB     limits.cpu: \"8\"     limits.memory: \"16Gi\"</code></p>"},{"location":"devops/K8s_5.html#52-limitrange","title":"5.2 LimitRange","text":"<p>LimitRange \u7528\u4e8e\u5728\u547d\u540d\u7a7a\u95f4\u4e2d\u8bbe\u7f6e Pod \u6216\u5bb9\u5668\u7684\u9ed8\u8ba4 requests \u548c limits\uff0c\u786e\u4fdd\u6240\u6709 Pod \u9075\u5faa\u5408\u7406\u7684\u8d44\u6e90\u4f7f\u7528\u8303\u56f4\u3002</p> <p>\u793a\u4f8b LimitRange\uff1a</p> <p><code>yaml apiVersion: v1 kind: LimitRange metadata:   name: limits   namespace: default spec:   limits:   - default:       cpu: \"1\"       memory: \"512Mi\"     defaultRequest:       cpu: \"500m\"       memory: \"256Mi\"     type: Container</code></p>"},{"location":"devops/K8s_5.html#_4","title":"\u603b\u7ed3","text":"<ol> <li>\u8282\u70b9\u6269\u5c55\uff1a\u53ef\u4ee5\u901a\u8fc7\u624b\u52a8\u589e\u52a0\u8282\u70b9\u6216\u4f7f\u7528 Cluster Autoscaler \u81ea\u52a8\u6269\u5c55\u8282\u70b9\u6570\u91cf\u3002</li> <li>Pod \u8d44\u6e90\u914d\u989d\u7ba1\u7406\uff1a\u901a\u8fc7\u5408\u7406\u8bbe\u7f6e requests \u548c limits\uff0c\u786e\u4fdd\u8d44\u6e90\u7684\u5408\u7406\u5206\u914d\u548c\u4f7f\u7528\u3002</li> <li>\u8c03\u6574\u8c03\u5ea6\u7b56\u7565\uff1a\u4f7f\u7528 Node Affinity\u3001Taints/Tolerations \u63a7\u5236 Pod \u7684\u8c03\u5ea6\uff0c\u907f\u514d\u8282\u70b9\u8d44\u6e90\u4e0d\u5747\u8861\u3002</li> <li>\u4f7f\u7528 HPA/VPA \u81ea\u52a8\u6269\u5c55\uff1a\u6839\u636e\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\uff0c\u81ea\u52a8\u589e\u52a0 Pod \u526f\u672c\u6216\u8c03\u6574\u8d44\u6e90\u8bf7\u6c42\u3002</li> <li>Resource Quota \u548c LimitRange\uff1a\u63a7\u5236\u4e0d\u540c\u547d\u540d\u7a7a\u95f4\u7684\u8d44\u6e90\u4f7f\u7528\uff0c\u9632\u6b62\u8d44\u6e90\u72ec\u5360\u6216\u6d6a\u8d39\u3002</li> </ol> <p>\u901a\u8fc7\u4ee5\u4e0a\u65b9\u6cd5\uff0c\u53ef\u4ee5\u6709\u6548\u5e94\u5bf9 Kubernetes \u96c6\u7fa4\u4e2d\u8282\u70b9\u8d44\u6e90\u7d27\u5f20\u7684\u60c5\u51b5\uff0c\u786e\u4fdd\u96c6\u7fa4\u7a33\u5b9a\u3001\u9ad8\u6548\u5730\u8fd0\u884c\u3002</p>"},{"location":"devops/K8s_5.html#741","title":"7.4.1 \u624b\u52a8\u589e\u52a0\u8282\u70b9","text":"<p>\u5047\u8bbe\u5df2\u7ecf\u5efa\u7acb\u4e86\u4e00\u4e2a 3\u4e2amaster\u7684\u8282\u70b9\u7684k8s \u96c6\u7fa4\uff0c\u90a3\u4e48\u6211\u73b0\u5728\u6240\u9762\u4e34\u7684\u6709\u53ef\u80fd\u662f\u589e\u52a0\u4e00\u4e2amaster\u8282\u70b9\uff0c\u6216\u662f\u589e\u52a0\u591a\u4e2a slave \u8282\u70b9\uff0c\u5728\u65b0\u7684\u7269\u7406\u673a\u5668\u4e0a\u8981\u90e8\u7f72\u4ec0\u4e48\u4ec0\u4e48\uff0c\u505a\u4ec0\u4e48\u64cd\u4f5c\uff0c\u4ec0\u4e48\u914d\u7f6e\uff0c\u4ec0\u4e48\u547d\u4ee4</p> <p>\u5728 Kubernetes \u96c6\u7fa4\u4e2d\u6269\u5c55\u8282\u70b9\u65f6\uff0c\u53ef\u4ee5\u6839\u636e\u96c6\u7fa4\u7684\u9700\u6c42\u6dfb\u52a0\u65b0\u7684 Master \u8282\u70b9\uff08\u63a7\u5236\u5e73\u9762\u8282\u70b9\uff09\u6216 Worker \u8282\u70b9\uff08\u4e5f\u79f0\u4e3a Slave \u8282\u70b9\uff09\u3002\u4ee5\u4e0b\u662f\u8be6\u7ec6\u7684\u64cd\u4f5c\u6b65\u9aa4\uff0c\u5305\u62ec\u5728\u65b0\u7269\u7406\u673a\u5668\u4e0a\u9700\u8981\u90e8\u7f72\u7684\u7ec4\u4ef6\u3001\u914d\u7f6e\u64cd\u4f5c\uff0c\u4ee5\u53ca\u52a0\u5165\u96c6\u7fa4\u7684\u547d\u4ee4\u3002</p>"},{"location":"devops/K8s_5.html#master","title":"\u4e00\u3001\u589e\u52a0\u4e00\u4e2a Master \u8282\u70b9","text":"<p>\u589e\u52a0\u4e00\u4e2a Master \u8282\u70b9\u7684\u76ee\u7684\u662f\u63d0\u9ad8\u63a7\u5236\u5e73\u9762\u7684\u9ad8\u53ef\u7528\u6027\u3002\u589e\u52a0\u65b0\u7684 Master \u8282\u70b9\u9700\u8981\u786e\u4fdd\u5b83\u53ef\u4ee5\u4e0e\u5176\u4ed6 Master \u8282\u70b9\u8fdb\u884c\u901a\u4fe1\u5e76\u53c2\u4e0e etcd \u96c6\u7fa4\u3002</p>"},{"location":"devops/K8s_5.html#111-kubernetes","title":"1.1.1 \u5728\u65b0\u673a\u5668\u4e0a\u5b89\u88c5 Kubernetes \u7ec4\u4ef6","text":"<p>\u5728\u65b0\u7684\u7269\u7406\u673a\u5668\u4e0a\uff0c\u9996\u5148\u9700\u8981\u5b89\u88c5 Kubernetes \u76f8\u5173\u7ec4\u4ef6\uff0c\u5305\u62ec kubeadm\u3001kubelet \u548c kubectl\uff0c\u8fd9\u4e9b\u7ec4\u4ef6\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u6b65\u9aa4\u5b89\u88c5\uff1a</p> <ol> <li>\u66f4\u65b0\u7cfb\u7edf\u5e76\u5b89\u88c5\u4f9d\u8d56\u5305\uff1a</li> </ol> <p><code>sh    sudo apt-get update    sudo apt-get install -y apt-transport-https ca-certificates curl</code> 2. \u6dfb\u52a0 Kubernetes \u4ed3\u5e93\u7684 GPG \u5bc6\u94a5\u548c\u4ed3\u5e93\u5730\u5740\uff1a</p> <p><code>sh    curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add -    cat &lt;&lt;EOF | sudo tee /etc/apt/sources.list.d/kubernetes.list    deb https://apt.kubernetes.io/ kubernetes-xenial main    EOF</code> 3. \u5b89\u88c5 kubeadm\u3001kubelet \u548c kubectl\uff1a</p> <p><code>sh    sudo apt-get update    sudo apt-get install -y kubelet kubeadm kubectl    sudo apt-mark hold kubelet kubeadm kubectl</code></p>"},{"location":"devops/K8s_5.html#112","title":"1.1.2 \u914d\u7f6e\u4e3b\u673a","text":"<ol> <li>\u7981\u7528\u4ea4\u6362\u5206\u533a\uff08Kubernetes \u4e0d\u652f\u6301\u4ea4\u6362\u5206\u533a\uff09\uff1a</li> </ol> <p><code>sh    sudo swapoff -a</code></p> <p>\u8fd8\u9700\u8981\u6ce8\u91ca <code>/etc/fstab</code> \u4e2d\u7684\u4ea4\u6362\u5206\u533a\u6761\u76ee\uff0c\u786e\u4fdd\u91cd\u542f\u540e\u4ea4\u6362\u5206\u533a\u4f9d\u65e7\u5173\u95ed\u3002 2. \u4fee\u6539\u7f51\u7edc\u914d\u7f6e\uff1a    \u786e\u4fdd\u8282\u70b9\u4e4b\u95f4\u53ef\u4ee5\u4e92\u76f8\u901a\u4fe1\uff0c\u5e76\u8bbe\u7f6e\u5408\u9002\u7684\u4e3b\u673a\u540d\u548c <code>/etc/hosts</code> \u6587\u4ef6\uff0c\u786e\u4fdd\u5176\u4ed6 Master \u8282\u70b9\u7684 IP \u548c\u4e3b\u673a\u540d\u53ef\u88ab\u89e3\u6790\u3002</p>"},{"location":"devops/K8s_5.html#113","title":"1.1.3 \u52a0\u5165\u96c6\u7fa4","text":"<ol> <li>\u83b7\u53d6\u96c6\u7fa4\u52a0\u5165\u7684 token \u548c <code>discovery-token-ca-cert-hash</code>\uff1a    \u5728\u73b0\u6709\u7684\u4efb\u610f\u4e00\u4e2a Master \u8282\u70b9\u4e0a\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u83b7\u53d6 token \u548c hash\uff1a</li> </ol> <p><code>sh    kubeadm token create --print-join-command</code></p> <p>\u8be5\u547d\u4ee4\u4f1a\u8f93\u51fa\u7c7b\u4f3c\u4ee5\u4e0b\u7684 <code>kubeadm join</code> \u547d\u4ee4\uff0c\u5176\u4e2d\u5305\u542b <code>--token</code> \u548c <code>--discovery-token-ca-cert-hash</code>\uff0c\u4f8b\u5982\uff1a</p> <p><code>sh    kubeadm join 10.0.0.1:6443 --token abc123.0123456789abcdef --discovery-token-ca-cert-hash sha256:1234567890abcdef...</code> 2. \u5728\u65b0 Master \u8282\u70b9\u4e0a\u6267\u884c\u52a0\u5165\u547d\u4ee4\uff1a    \u4f7f\u7528\u4e0a\u4e00\u6b65\u751f\u6210\u7684 <code>kubeadm join</code> \u547d\u4ee4\uff0c\u5c06\u65b0 Master \u8282\u70b9\u52a0\u5165\u96c6\u7fa4\uff0c\u5e76\u6307\u5b9a\u8be5\u8282\u70b9\u4e3a\u63a7\u5236\u5e73\u9762\u8282\u70b9\uff1a</p> <p><code>sh    kubeadm join &lt;master-ip&gt;:&lt;master-port&gt; --token &lt;token&gt; --discovery-token-ca-cert-hash sha256:&lt;hash&gt; --control-plane</code></p> <p>\u793a\u4f8b\uff1a</p> <p><code>sh    kubeadm join 10.0.0.1:6443 --token abc123.0123456789abcdef --discovery-token-ca-cert-hash sha256:1234567890abcdef... --control-plane</code></p>"},{"location":"devops/K8s_5.html#114-etcd-kubeadm","title":"1.1.4 \u786e\u4fdd etcd \u548c kubeadm \u8bc1\u4e66\u5171\u4eab","text":"<p>\u5728\u591a Master \u8282\u70b9\u914d\u7f6e\u4e2d\uff0c\u6240\u6709 Master \u8282\u70b9\u9700\u8981\u5171\u4eab etcd \u8bc1\u4e66\u548c kubeadm \u7684 CA \u8bc1\u4e66\u3002\u53ef\u4ee5\u5c06\u73b0\u6709 Master \u8282\u70b9\u7684 <code>/etc/kubernetes/pki</code> \u76ee\u5f55\uff08\u5305\u542b\u8bc1\u4e66\u548c\u5bc6\u94a5\uff09\u590d\u5236\u5230\u65b0 Master \u8282\u70b9\uff0c\u786e\u4fdd\u6240\u6709\u8bc1\u4e66\u4e00\u81f4\u3002</p>"},{"location":"devops/K8s_5.html#workerslave","title":"\u4e8c\u3001\u589e\u52a0 Worker\uff08Slave\uff09\u8282\u70b9","text":"<p>\u589e\u52a0 Worker \u8282\u70b9\u53ef\u4ee5\u6269\u5c55\u96c6\u7fa4\u7684\u8ba1\u7b97\u548c\u5b58\u50a8\u5bb9\u91cf\uff0c\u4f7f\u5f97\u66f4\u591a\u7684\u5de5\u4f5c\u8d1f\u8f7d\u80fd\u591f\u5728\u96c6\u7fa4\u4e2d\u8fd0\u884c\u3002</p>"},{"location":"devops/K8s_5.html#121-kubernetes","title":"1.2.1 \u5728\u65b0\u673a\u5668\u4e0a\u5b89\u88c5 Kubernetes \u7ec4\u4ef6","text":"<p>\u4e0e\u589e\u52a0 Master \u8282\u70b9\u7c7b\u4f3c\uff0c\u589e\u52a0 Worker \u8282\u70b9\u540c\u6837\u9700\u8981\u5b89\u88c5 Kubernetes \u76f8\u5173\u7ec4\u4ef6\u3002</p> <ol> <li>\u66f4\u65b0\u7cfb\u7edf\u5e76\u5b89\u88c5\u4f9d\u8d56\u5305\uff1a</li> </ol> <p><code>sh    sudo apt-get update    sudo apt-get install -y apt-transport-https ca-certificates curl</code> 2. \u6dfb\u52a0 Kubernetes \u4ed3\u5e93\u7684 GPG \u5bc6\u94a5\u548c\u4ed3\u5e93\u5730\u5740\uff1a</p> <p><code>sh    curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add -    cat &lt;&lt;EOF | sudo tee /etc/apt/sources.list.d/kubernetes.list    deb https://apt.kubernetes.io/ kubernetes-xenial main    EOF</code> 3. \u5b89\u88c5 kubeadm\u3001kubelet \u548c kubectl\uff1a</p> <p><code>sh    sudo apt-get update    sudo apt-get install -y kubelet kubeadm kubectl    sudo apt-mark hold kubelet kubeadm kubectl</code></p>"},{"location":"devops/K8s_5.html#122","title":"1.2.2 \u914d\u7f6e\u4e3b\u673a","text":"<ol> <li>\u7981\u7528\u4ea4\u6362\u5206\u533a\uff1a</li> </ol> <p><code>sh    sudo swapoff -a</code></p> <p>\u6ce8\u91ca <code>/etc/fstab</code> \u4e2d\u7684\u4ea4\u6362\u5206\u533a\u6761\u76ee\uff0c\u786e\u4fdd\u91cd\u542f\u540e\u4ea4\u6362\u5206\u533a\u4f9d\u65e7\u5173\u95ed\u3002 2. \u4fee\u6539\u7f51\u7edc\u914d\u7f6e\uff1a    \u786e\u4fdd\u8282\u70b9\u4e4b\u95f4\u53ef\u4ee5\u4e92\u76f8\u901a\u4fe1\uff0c\u5e76\u8bbe\u7f6e\u5408\u9002\u7684\u4e3b\u673a\u540d\u548c <code>/etc/hosts</code> \u6587\u4ef6\uff0c\u786e\u4fdd\u5176\u4ed6 Master \u548c Worker \u8282\u70b9\u7684 IP \u548c\u4e3b\u673a\u540d\u53ef\u88ab\u89e3\u6790\u3002</p>"},{"location":"devops/K8s_5.html#123","title":"1.2.3 \u52a0\u5165\u96c6\u7fa4","text":"<ol> <li>\u83b7\u53d6\u96c6\u7fa4\u52a0\u5165\u7684 token \u548c <code>discovery-token-ca-cert-hash</code>\uff1a    \u5728\u73b0\u6709 Master \u8282\u70b9\u4e0a\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u83b7\u53d6\u52a0\u5165\u547d\u4ee4\uff1a</li> </ol> <p><code>sh    kubeadm token create --print-join-command</code></p> <p>\u8f93\u51fa\u7c7b\u4f3c\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <p><code>sh    kubeadm join 10.0.0.1:6443 --token abc123.0123456789abcdef --discovery-token-ca-cert-hash sha256:1234567890abcdef...</code> 2. \u5728\u65b0 Worker \u8282\u70b9\u4e0a\u6267\u884c\u52a0\u5165\u547d\u4ee4\uff1a    \u5728\u65b0 Worker \u8282\u70b9\u4e0a\u8fd0\u884c\u4e0a\u4e00\u6b65\u7684 <code>kubeadm join</code> \u547d\u4ee4\uff1a</p> <p><code>sh    kubeadm join 10.0.0.1:6443 --token abc123.0123456789abcdef --discovery-token-ca-cert-hash sha256:1234567890abcdef...</code></p> <p>\u8fd9\u6837\uff0c\u65b0 Worker \u8282\u70b9\u5c31\u4f1a\u52a0\u5165\u96c6\u7fa4\uff0c\u5e76\u80fd\u591f\u88ab Master \u8282\u70b9\u8c03\u5ea6 Pod \u5de5\u4f5c\u8d1f\u8f7d\u3002</p>"},{"location":"devops/K8s_5.html#_5","title":"\u4e09\u3001\u68c0\u67e5\u8282\u70b9\u662f\u5426\u6210\u529f\u52a0\u5165","text":"<ol> <li>\u5728\u4efb\u610f\u4e00\u4e2a Master \u8282\u70b9\u4e0a\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u8282\u70b9\u7684\u72b6\u6001\uff1a</li> </ol> <p><code>sh    kubectl get nodes</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a    <code>sh    NAME           STATUS   ROLES           AGE   VERSION    master1        Ready    control-plane   10d   v1.25.0    master2        Ready    control-plane   10d   v1.25.0    master3        Ready    control-plane   10d   v1.25.0    new-master     Ready    control-plane   1h    v1.25.0    worker1        Ready    &lt;none&gt;          10d   v1.25.0    new-worker     Ready    &lt;none&gt;          20m   v1.25.0</code></p> <ul> <li>STATUS\uff1a\u5e94\u4e3a <code>Ready</code>\uff0c\u8868\u793a\u8282\u70b9\u5df2\u7ecf\u6210\u529f\u52a0\u5165\u5e76\u6b63\u5e38\u8fd0\u884c\u3002</li> <li>ROLES\uff1a<code>control-plane</code> \u8868\u793a Master \u8282\u70b9\uff0c<code>&lt;none&gt;</code> \u8868\u793a Worker \u8282\u70b9\u3002</li> </ul>"},{"location":"devops/K8s_5.html#_6","title":"\u603b\u7ed3","text":"<ul> <li>\u5b89\u88c5 Kubernetes \u7ec4\u4ef6\uff1a\u5728\u65b0 Master \u6216 Worker \u8282\u70b9\u4e0a\uff0c\u9700\u8981\u5b89\u88c5 <code>kubeadm</code>\u3001<code>kubelet</code> \u548c <code>kubectl</code>\u3002</li> <li>\u7981\u7528\u4ea4\u6362\u5206\u533a\uff1a\u786e\u4fdd\u5173\u95ed\u4ea4\u6362\u5206\u533a\u5e76\u5728 <code>/etc/fstab</code> \u4e2d\u6ce8\u91ca\u76f8\u5173\u6761\u76ee\u3002</li> <li>\u52a0\u5165\u96c6\u7fa4\uff1a</li> <li>Master \u8282\u70b9\uff1a\u4f7f\u7528 <code>kubeadm join</code> \u547d\u4ee4\u5e76\u52a0\u4e0a <code>--control-plane</code> \u53c2\u6570\u3002</li> <li>Worker \u8282\u70b9\uff1a\u4f7f\u7528 <code>kubeadm join</code> \u547d\u4ee4\u52a0\u5165\u5230\u96c6\u7fa4\u4e2d\u3002</li> <li>\u5171\u4eab\u8bc1\u4e66\uff1a\u5728\u589e\u52a0 Master \u8282\u70b9\u65f6\uff0c\u9700\u8981\u786e\u4fdd\u6240\u6709\u63a7\u5236\u5e73\u9762\u8282\u70b9\u4e4b\u95f4\u7684\u8bc1\u4e66\u4e00\u81f4\u3002</li> </ul> <p>\u901a\u8fc7\u4ee5\u4e0a\u6b65\u9aa4\uff0c\u53ef\u4ee5\u6210\u529f\u6269\u5c55 Kubernetes \u96c6\u7fa4\uff0c\u65e0\u8bba\u662f\u589e\u52a0 Master \u8282\u70b9\u8fd8\u662f Worker \u8282\u70b9\uff0c\u5747\u53ef\u4ee5\u5e2e\u52a9\u7f13\u89e3\u96c6\u7fa4\u4e2d\u7684\u8d44\u6e90\u7d27\u5f20\u95ee\u9898\uff0c\u63d0\u9ad8\u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\u6027\u548c\u6269\u5c55\u80fd\u529b\u3002</p>"},{"location":"devops/K8s_5.html#742","title":"7.4.2 \u81ea\u52a8\u589e\u52a0\u8282\u70b9","text":"<p>Cluster Autoscaler \u662f Kubernetes \u96c6\u7fa4\u7684\u4e00\u4e2a\u7ec4\u4ef6\uff0c\u5b83\u53ef\u4ee5\u81ea\u52a8\u68c0\u6d4b\u96c6\u7fa4\u4e2d\u7684\u8d44\u6e90\u5229\u7528\u60c5\u51b5\uff0c\u5e76\u6839\u636e\u5de5\u4f5c\u8d1f\u8f7d\u7684\u9700\u6c42\u52a8\u6001\u8c03\u6574\u8282\u70b9\u7684\u6570\u91cf\u3002\u8fd9\u5bf9\u4e8e\u5728\u9ad8\u5cf0\u65f6\u81ea\u52a8\u6269\u5c55\u96c6\u7fa4\uff0c\u6216\u5728\u8d44\u6e90\u4f7f\u7528\u7387\u8f83\u4f4e\u65f6\u51cf\u5c11\u8282\u70b9\u6570\u91cf\u4ee5\u8282\u7701\u6210\u672c\u7279\u522b\u6709\u7528\u3002</p> <p>Cluster Autoscaler \u7684\u81ea\u52a8\u6269\u5c55\u914d\u7f6e\u4e3b\u8981\u4f9d\u8d56\u4e8e\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u63d0\u4f9b\u7684 API\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u7ba1\u7406\u8282\u70b9\uff08\u865a\u62df\u673a\u5b9e\u4f8b\uff09\uff0c\u56e0\u6b64\u5728\u4e91\u73af\u5883\u4e2d\uff08\u5982 AWS\u3001GCP\u3001Azure\uff09\u6548\u679c\u6700\u4f73\u3002\u4ee5\u4e0b\u662f\u8be6\u7ec6\u7684\u8bbe\u7f6e\u6b65\u9aa4\u548c\u914d\u7f6e\u9009\u9879\u3002</p>"},{"location":"devops/K8s_5.html#1-cluster-autoscaler","title":"1. \u5b89\u88c5 Cluster Autoscaler","text":"<p>\u53ef\u4ee5\u901a\u8fc7 <code>kubectl apply</code> \u6216 Helm \u6765\u5b89\u88c5 Cluster Autoscaler\u3002\u5b89\u88c5\u4e4b\u524d\u9700\u8981\u786e\u4fdd Kubernetes \u96c6\u7fa4\u80fd\u591f\u7ba1\u7406\u8282\u70b9\uff0c\u5e76\u4e14\u4f60\u6709\u5408\u9002\u7684\u4e91\u63d0\u4f9b\u5546\u96c6\u6210\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u7684\u96c6\u7fa4\u90e8\u7f72\u5728 AWS \u4e0a\uff0c\u5219\u9700\u8981\u5c06 IAM \u89d2\u8272\u548c\u6743\u9650\u6b63\u786e\u914d\u7f6e\uff0c\u4ee5\u5141\u8bb8\u81ea\u52a8\u6269\u5c55\u3002</p>"},{"location":"devops/K8s_5.html#11-kubectl-cluster-autoscaler","title":"1.1 \u4f7f\u7528 kubectl \u5b89\u88c5 Cluster Autoscaler","text":"<p>Step 1: \u4e0b\u8f7d Cluster Autoscaler \u7684\u914d\u7f6e\u6587\u4ef6\u3002</p> <ul> <li>Kubernetes \u5b98\u65b9\u63d0\u4f9b\u4e86\u9002\u7528\u4e8e\u4e0d\u540c\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u7684 YAML \u914d\u7f6e\u6587\u4ef6\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u4f60\u5728 AWS \u4e0a\u8fd0\u884c\u96c6\u7fa4\uff0c\u53ef\u4ee5\u4e0b\u8f7d\u4ee5\u4e0b\u6587\u4ef6\u5e76\u8fdb\u884c\u4fee\u6539\uff1a   <code>sh   curl -O https://raw.githubusercontent.com/kubernetes/autoscaler/cluster-autoscaler-release-1.25/cluster-autoscaler/cloudprovider/aws/examples/cluster-autoscaler-autodiscover.yaml</code></li> </ul> <p>Step 2: \u7f16\u8f91\u6587\u4ef6\u5e76\u6839\u636e\u96c6\u7fa4\u914d\u7f6e\u8fdb\u884c\u8c03\u6574\u3002</p> <ul> <li>\u9700\u8981\u8bbe\u7f6e\u9002\u5408\u4f60\u7684\u4e91\u63d0\u4f9b\u5546\u7684\u53c2\u6570\uff0c\u901a\u5e38\u5305\u62ec <code>cluster-name</code>\u3001<code>node-group</code> \u540d\u79f0\u7b49\u3002</li> </ul> <p>\u4f8b\u5982\uff0c\u6587\u4ef6\u4e2d\u53ef\u80fd\u5305\u542b\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u7684\u914d\u7f6e\u90e8\u5206\uff0c\u4f60\u9700\u8981\u6839\u636e\u96c6\u7fa4\u73af\u5883\u8fdb\u884c\u4fee\u6539\uff1a</p> <p><code>yaml command:   - ./cluster-autoscaler   - --v=4   - --stderrthreshold=info   - --cloud-provider=aws   - --skip-nodes-with-local-storage=false   - --expander=least-waste   - --nodes=1:10:&lt;node-group-name&gt;   # \u9700\u8981\u6839\u636e\u4f60\u7684\u96c6\u7fa4\u914d\u7f6e\u4fee\u6539 node group \u540d\u79f0</code></p> <ul> <li><code>--cloud-provider=aws</code>\uff1a\u6839\u636e\u4f60\u7684\u4e91\u63d0\u4f9b\u5546\u914d\u7f6e\uff0c\u53ef\u80fd\u662f <code>aws</code>\u3001<code>gce</code>\u3001<code>azure</code>\u3001<code>alibaba</code> \u7b49\u3002</li> <li><code>--nodes=1:10:&lt;node-group-name&gt;</code>\uff1a\u8868\u793a\u5728\u7279\u5b9a\u7684\u8282\u70b9\u7ec4\uff08Node Group\uff09\u4e2d\uff0c\u6700\u5c11\u6709 1 \u4e2a\u8282\u70b9\uff0c\u6700\u591a\u6709 10 \u4e2a\u8282\u70b9\u3002<code>&lt;node-group-name&gt;</code> \u5e94\u66ff\u6362\u4e3a\u4f60\u7684\u8282\u70b9\u7ec4\u540d\u79f0\u3002</li> </ul> <p>Step 3: \u5e94\u7528 Cluster Autoscaler \u7684 YAML \u6587\u4ef6\u3002</p> <p><code>sh kubectl apply -f cluster-autoscaler-autodiscover.yaml</code></p>"},{"location":"devops/K8s_5.html#12-helm-cluster-autoscaler","title":"1.2 \u4f7f\u7528 Helm \u5b89\u88c5 Cluster Autoscaler","text":"<p>\u4e5f\u53ef\u4ee5\u4f7f\u7528 Helm Charts \u8fdb\u884c\u5b89\u88c5\uff0c\u8fd9\u79cd\u65b9\u6cd5\u6bd4\u8f83\u65b9\u4fbf\uff0c\u7279\u522b\u662f\u9700\u8981\u5b89\u88c5\u7279\u5b9a\u7248\u672c\u65f6\u3002</p> <p>Step 1: \u6dfb\u52a0 Helm \u4ed3\u5e93\u3002</p> <p><code>sh helm repo add autoscaler https://kubernetes.github.io/autoscaler helm repo update</code></p> <p>Step 2: \u4f7f\u7528 Helm \u5b89\u88c5 Cluster Autoscaler\u3002</p> <p><code>sh helm install cluster-autoscaler autoscaler/cluster-autoscaler \\   --namespace kube-system \\   --set cloudProvider=aws \\   --set awsRegion=&lt;your-region&gt; \\   --set rbac.create=true</code></p> <ul> <li><code>cloudProvider</code>\uff1a\u6839\u636e\u4f60\u7684\u96c6\u7fa4\u6240\u5728\u7684\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u8bbe\u7f6e\u4e3a <code>aws</code>\u3001<code>gce</code>\u3001<code>azure</code> \u7b49\u3002</li> <li><code>awsRegion</code>\uff1a\u8bbe\u7f6e\u4e3a\u4f60\u7684\u96c6\u7fa4\u6240\u5728\u7684 AWS \u533a\u57df\uff08\u4f8b\u5982 <code>us-west-2</code>\uff09\u3002</li> </ul>"},{"location":"devops/K8s_5.html#2-cloud-provider","title":"2. \u914d\u7f6e Cloud Provider \u6743\u9650","text":"<p>Cluster Autoscaler \u9700\u8981\u7ba1\u7406\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\uff0c\u56e0\u6b64\u9700\u8981\u8db3\u591f\u7684\u6743\u9650\u5728\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u7684\u73af\u5883\u4e2d\u521b\u5efa\u3001\u5220\u9664\u8282\u70b9\u3002</p> <p>\u4ee5 AWS \u4e3a\u4f8b\uff1a</p>"},{"location":"devops/K8s_5.html#21-iam","title":"2.1 \u914d\u7f6e IAM \u89d2\u8272","text":"<ul> <li>\u5728 AWS \u4e0a\u8fd0\u884c\u7684\u8282\u70b9\u5fc5\u987b\u6709\u5408\u9002\u7684 IAM \u89d2\u8272\uff0c\u4f7f\u5f97 Cluster Autoscaler \u53ef\u4ee5\u7ba1\u7406\u8fd9\u4e9b\u8282\u70b9\u3002</li> <li>IAM \u89d2\u8272\u4e2d\u9700\u8981\u6dfb\u52a0\u4ee5\u4e0b\u6743\u9650\uff1a</li> </ul> <p><code>json {     \"Version\": \"2012-10-17\",     \"Statement\": [         {             \"Effect\": \"Allow\",             \"Action\": [                 \"autoscaling:DescribeAutoScalingGroups\",                 \"autoscaling:DescribeAutoScalingInstances\",                 \"autoscaling:DescribeTags\",                 \"autoscaling:SetDesiredCapacity\",                 \"autoscaling:TerminateInstanceInAutoScalingGroup\",                 \"ec2:DescribeLaunchTemplateVersions\"             ],             \"Resource\": \"*\"         }     ] }</code></p> <ul> <li>\u8fd9\u5c06\u5141\u8bb8 Cluster Autoscaler \u5728\u8282\u70b9\u7ec4\uff08Node Group\uff09\u4e2d\u589e\u52a0\u6216\u5220\u9664\u8282\u70b9\u3002</li> </ul>"},{"location":"devops/K8s_5.html#22-node-group","title":"2.2 \u914d\u7f6e\u8282\u70b9\u7ec4\uff08Node Group\uff09","text":"<ul> <li>\u5728 AWS \u4e2d\uff0c\u4f60\u7684 Kubernetes \u96c6\u7fa4\u7684\u8282\u70b9\u901a\u5e38\u7531 Auto Scaling Group (ASG) \u7ba1\u7406\u3002Cluster Autoscaler \u4f7f\u7528\u8fd9\u4e9b ASG \u6765\u6dfb\u52a0\u6216\u5220\u9664\u8282\u70b9\u3002</li> <li>\u5728\u8282\u70b9\u7ec4\u7684\u914d\u7f6e\u4e2d\uff0c\u8bbe\u7f6e\u6700\u5c0f\u548c\u6700\u5927\u8282\u70b9\u6570\u91cf\uff0c\u4f8b\u5982\u6700\u5c11 1 \u4e2a\u8282\u70b9\uff0c\u6700\u591a 10 \u4e2a\u8282\u70b9\u3002</li> <li>Cluster Autoscaler \u4f1a\u81ea\u52a8\u8c03\u6574\u8282\u70b9\u6570\u91cf\uff0c\u4ee5\u786e\u4fdd\u6ee1\u8db3 Pod \u7684\u8d44\u6e90\u8bf7\u6c42\u3002</li> </ul>"},{"location":"devops/K8s_5.html#3-cluster-autoscaler","title":"3. \u914d\u7f6e Cluster Autoscaler \u53c2\u6570","text":"<p>\u4e3a\u4e86\u66f4\u597d\u5730\u7ba1\u7406\u8282\u70b9\u6269\u5c55\u884c\u4e3a\uff0c\u4f60\u53ef\u4ee5\u914d\u7f6e Cluster Autoscaler \u7684\u4e00\u4e9b\u5e38\u7528\u53c2\u6570\uff1a</p> <ul> <li><code>--balance-similar-node-groups</code>\uff1a\u786e\u4fdd\u6269\u5c55\u65f6\uff0c\u5728\u4e0d\u540c\u7684\u8282\u70b9\u7ec4\u95f4\u4fdd\u6301\u5e73\u8861\u3002</li> <li><code>--skip-nodes-with-system-pods=false</code>\uff1a\u5141\u8bb8\u5305\u542b\u7cfb\u7edf Pod \u7684\u8282\u70b9\u88ab\u5220\u9664\u3002</li> <li><code>--expander</code>\uff1a\u6307\u5b9a\u6269\u5c55\u7b56\u7565\u3002</li> <li><code>random</code>\uff1a\u968f\u673a\u9009\u62e9\u4e00\u4e2a\u8282\u70b9\u7ec4\u8fdb\u884c\u6269\u5c55\u3002</li> <li><code>least-waste</code>\uff1a\u6700\u5c0f\u5316\u8d44\u6e90\u6d6a\u8d39\uff0c\u9009\u62e9\u6700\u5408\u9002\u7684\u8282\u70b9\u7ec4\u8fdb\u884c\u6269\u5c55\u3002</li> <li><code>most-pods</code>\uff1a\u9009\u62e9\u62e5\u6709\u6700\u591a Pod \u6570\u91cf\u7684\u8282\u70b9\u7ec4\u8fdb\u884c\u6269\u5c55\u3002</li> <li><code>--scale-down-enabled</code>\uff1a\u662f\u5426\u5141\u8bb8\u81ea\u52a8\u7f29\u51cf\u8282\u70b9\u6570\u91cf\u3002</li> <li><code>--scale-down-delay-after-add=10m</code>\uff1a\u5728\u65b0\u589e\u8282\u70b9\u540e\u7684 10 \u5206\u949f\u540e\uff0c\u624d\u5141\u8bb8\u8fdb\u884c\u7f29\u51cf\u64cd\u4f5c\u3002</li> </ul>"},{"location":"devops/K8s_5.html#4-cluster-autoscaler","title":"4. \u9a8c\u8bc1 Cluster Autoscaler \u662f\u5426\u5de5\u4f5c","text":"<p>Step 1: \u786e\u8ba4 Cluster Autoscaler Pod \u6b63\u5728\u8fd0\u884c\u3002</p> <p><code>sh kubectl get pods -n kube-system | grep cluster-autoscaler</code></p> <p>\u8f93\u51fa\u793a\u4f8b\uff1a</p> <p><code>sh cluster-autoscaler-xxxxxxxxxx-yyyyy   1/1     Running   0          1m</code></p> <p>Step 2: \u67e5\u770b Cluster Autoscaler \u7684\u65e5\u5fd7\uff0c\u786e\u4fdd\u5b83\u6b63\u5e38\u5de5\u4f5c\u5e76\u6839\u636e\u9700\u8981\u8c03\u6574\u8282\u70b9\u6570\u91cf\u3002</p> <p><code>sh kubectl logs -f deployment/cluster-autoscaler -n kube-system</code></p> <p>\u5728\u65e5\u5fd7\u4e2d\u53ef\u4ee5\u770b\u5230 Cluster Autoscaler \u5728\u68c0\u67e5\u96c6\u7fa4\u72b6\u6001\uff0c\u51b3\u5b9a\u662f\u5426\u589e\u52a0\u6216\u5220\u9664\u8282\u70b9\u3002</p>"},{"location":"devops/K8s_5.html#5_1","title":"5. \u6d4b\u8bd5\u81ea\u52a8\u6269\u5c55","text":"<p>\u4e3a\u4e86\u6d4b\u8bd5 Cluster Autoscaler \u662f\u5426\u6b63\u5e38\u5de5\u4f5c\uff0c\u4f60\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u9700\u8981\u5927\u91cf\u8d44\u6e90\u7684 Deployment\u3002\u4f8b\u5982\uff1a</p> <p>Step 1: \u521b\u5efa\u4e00\u4e2a Deployment \u9700\u8981\u5927\u91cf CPU \u548c\u5185\u5b58\u3002</p> <p><code>yaml apiVersion: apps/v1 kind: Deployment metadata:   name: stress-deployment   namespace: default spec:   replicas: 10   selector:     matchLabels:       app: stress   template:     metadata:       labels:         app: stress     spec:       containers:       - name: stress         image: busybox         command: [\"sh\", \"-c\", \"while true; do echo 'Stress test'; sleep 10; done\"]         resources:           requests:             cpu: \"500m\"             memory: \"512Mi\"</code></p> <p>\u5e94\u7528\u8be5\u6587\u4ef6\u540e\uff0c\u96c6\u7fa4\u53ef\u80fd\u4f1a\u56e0\u8d44\u6e90\u4e0d\u8db3\u800c\u5bfc\u81f4\u90e8\u5206 Pod \u5904\u4e8e <code>Pending</code> \u72b6\u6001\uff0cCluster Autoscaler \u5e94\u8be5\u4f1a\u68c0\u6d4b\u5230\u8fd9\u4e00\u70b9\u5e76\u81ea\u52a8\u6269\u5c55\u8282\u70b9\u4ee5\u5bb9\u7eb3\u65b0 Pod\u3002</p> <p>Step 2: \u89c2\u5bdf\u6269\u5c55\u60c5\u51b5\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u8282\u70b9\u72b6\u6001\uff0c\u89c2\u5bdf\u662f\u5426\u6709\u65b0\u7684\u8282\u70b9\u52a0\u5165\u96c6\u7fa4\uff1a</p> <p><code>sh kubectl get nodes</code></p>"},{"location":"devops/K8s_5.html#_7","title":"\u603b\u7ed3","text":"<ol> <li> <p>\u5b89\u88c5 Cluster Autoscaler\uff1a</p> </li> <li> <p>\u53ef\u4ee5\u901a\u8fc7 <code>kubectl apply</code> \u6216 Helm \u5b89\u88c5\u3002</p> </li> <li>\u9700\u8981\u6839\u636e\u4e91\u63d0\u4f9b\u5546\uff08\u5982 AWS\u3001GCP\u3001Azure \u7b49\uff09\u8fdb\u884c\u7279\u5b9a\u914d\u7f6e\u3002</li> <li> <p>\u914d\u7f6e Cloud Provider \u6743\u9650\uff1a</p> </li> <li> <p>\u5728 AWS \u4e0a\u9700\u8981\u914d\u7f6e IAM \u89d2\u8272\uff0c\u5e76\u786e\u4fdd\u8282\u70b9\u7ec4\u652f\u6301\u6269\u5c55\u3002</p> </li> <li>\u8bbe\u7f6e\u8282\u70b9\u7ec4\uff08Node Group\uff09\u7684\u6700\u5c0f\u548c\u6700\u5927\u8282\u70b9\u6570\u91cf\u3002</li> <li> <p>\u914d\u7f6e Cluster Autoscaler \u53c2\u6570\uff1a</p> </li> <li> <p>\u53ef\u4ee5\u901a\u8fc7 <code>--expander</code>\u3001<code>--scale-down-enabled</code> \u7b49\u53c2\u6570\u8c03\u6574 Cluster Autoscaler \u7684\u884c\u4e3a\u3002</p> </li> <li> <p>\u9a8c\u8bc1\u548c\u6d4b\u8bd5 Cluster Autoscaler\uff1a</p> </li> <li> <p>\u67e5\u770b Cluster Autoscaler Pod \u72b6\u6001\u548c\u65e5\u5fd7\uff0c\u786e\u4fdd\u5176\u6b63\u5e38\u5de5\u4f5c\u3002</p> </li> <li>\u901a\u8fc7\u521b\u5efa\u9700\u8981\u5927\u91cf\u8d44\u6e90\u7684 Deployment \u6d4b\u8bd5\u81ea\u52a8\u6269\u5c55\u529f\u80fd\u3002</li> </ol> <p>\u901a\u8fc7\u6b63\u786e\u914d\u7f6e Cluster Autoscaler\uff0c\u53ef\u4ee5\u6709\u6548\u5e94\u5bf9 Kubernetes \u96c6\u7fa4\u4e2d\u7684\u8d44\u6e90\u4e0d\u8db3\u95ee\u9898\uff0c\u5b9e\u73b0\u8282\u70b9\u7684\u81ea\u52a8\u6269\u5c55\u548c\u7f29\u51cf\uff0c\u63d0\u9ad8\u96c6\u7fa4\u7684\u7075\u6d3b\u6027\u548c\u7a33\u5b9a\u6027\u3002</p>"},{"location":"devops/K8s_5.html#743-pod","title":"7.4.3 Pod \u8d44\u6e90\u914d\u989d\u7ba1\u7406","text":"<p>\u5728 Kubernetes \u4e2d\uff0c\u901a\u8fc7\u4e3a Pod \u914d\u7f6e requests \u548c limits\uff0c\u53ef\u4ee5\u6709\u6548\u5730\u7ba1\u7406\u96c6\u7fa4\u4e2d\u7684\u8d44\u6e90\uff0c\u786e\u4fdd\u5bb9\u5668\u4e4b\u95f4\u7684\u516c\u5e73\u8d44\u6e90\u5206\u914d\uff0c\u907f\u514d\u4e2a\u522b\u5bb9\u5668\u5360\u7528\u8fc7\u591a\u8d44\u6e90\u800c\u5bfc\u81f4\u5176\u4ed6\u5bb9\u5668\u53d7\u5f71\u54cd\u3002\u8fd9\u79cd\u7ba1\u7406\u65b9\u5f0f\u5bf9\u4e8e\u96c6\u7fa4\u8d44\u6e90\u7d27\u5f20\u60c5\u51b5\u4e0b\u7684\u8d44\u6e90\u4f18\u5316\u5206\u914d\u5c24\u5176\u91cd\u8981\u3002\u4ee5\u4e0b\u662f\u5bf9 <code>requests</code> \u548c <code>limits</code> \u7684\u8be6\u7ec6\u8bf4\u660e\uff0c\u4ee5\u53ca\u4e3a\u4ec0\u4e48\u5408\u7406\u8bbe\u7f6e\u5b83\u4eec\u53ef\u4ee5\u6709\u6548\u7f13\u89e3\u8282\u70b9\u8d44\u6e90\u7d27\u5f20\u3002</p>"},{"location":"devops/K8s_5.html#1-requests-limits","title":"1. requests \u548c limits \u8be6\u7ec6\u89e3\u91ca","text":"<ul> <li> <p>requests\uff1a</p> </li> <li> <p>\u8d44\u6e90\u8bf7\u6c42\uff08Resource Requests\uff09\u662f\u5bb9\u5668\u8fd0\u884c\u65f6\u6240\u9700\u7684\u6700\u5c0f\u8d44\u6e90\u91cf\u3002</p> </li> <li>Kubernetes \u8c03\u5ea6\u5668\u4f1a\u6839\u636e Pod \u7684 <code>requests</code> \u503c\u6765\u786e\u5b9a\u8be5 Pod \u80fd\u591f\u88ab\u5206\u914d\u5230\u54ea\u4e2a\u8282\u70b9\u4e0a\u3002</li> <li>\u4f8b\u5982\uff0c\u5982\u679c\u67d0\u4e2a\u5bb9\u5668\u8bf7\u6c42\u4e86 500m CPU\uff08500 \u6beb\u6838\uff09\uff0c\u8c03\u5ea6\u5668\u4f1a\u67e5\u627e\u5177\u6709\u81f3\u5c11 500m \u53ef\u7528 CPU \u7684\u8282\u70b9\uff0c\u4ee5\u5c06 Pod \u8c03\u5ea6\u5230\u8be5\u8282\u70b9\u4e0a\u3002</li> <li> <p>limits\uff1a</p> </li> <li> <p>\u8d44\u6e90\u4e0a\u9650\uff08Resource Limits\uff09\u662f\u5bb9\u5668\u5728\u8fd0\u884c\u65f6\u53ef\u4ee5\u4f7f\u7528\u7684\u6700\u5927\u8d44\u6e90\u91cf\u3002</p> </li> <li>\u5bb9\u5668\u53ef\u4ee5\u5728 <code>requests</code> \u548c <code>limits</code> \u4e4b\u95f4\u81ea\u7531\u6d88\u8017\u8d44\u6e90\uff0c\u4f46\u662f\u65e0\u6cd5\u8d85\u51fa <code>limits</code> \u8bbe\u5b9a\u7684\u503c\u3002</li> <li>\u4f8b\u5982\uff0cCPU \u9650\u5236\u8bbe\u7f6e\u4e3a 1 \u6838\uff0c\u8868\u793a\u8be5\u5bb9\u5668\u6700\u591a\u53ea\u80fd\u4f7f\u7528 1 \u6838 CPU\uff0c\u5373\u4fbf\u96c6\u7fa4\u4e2d\u6709\u66f4\u591a\u7a7a\u95f2\u8d44\u6e90\u3002</li> </ul> <p>\u901a\u8fc7\u5408\u7406\u8bbe\u7f6e <code>requests</code> \u548c <code>limits</code>\uff0c\u53ef\u4ee5\u5b9e\u73b0\u4ee5\u4e0b\u6548\u679c\uff1a</p> <ul> <li>\u63d0\u9ad8\u96c6\u7fa4\u8d44\u6e90\u7684\u5229\u7528\u6548\u7387\u3002</li> <li>\u9632\u6b62\u8d44\u6e90\u4e89\u7528\uff0c\u5373\u67d0\u4e9b\u5bb9\u5668\u5360\u7528\u8fc7\u591a\u7684\u8d44\u6e90\u800c\u5f71\u54cd\u5176\u4ed6\u5bb9\u5668\u7684\u6b63\u5e38\u8fd0\u884c\u3002</li> <li>\u652f\u6301\u8d44\u6e90\u8c03\u5ea6\u7684\u516c\u5e73\u6027\uff0c\u4f7f\u8c03\u5ea6\u5668\u6839\u636e\u8bf7\u6c42\u7684\u8d44\u6e90\u91cf\u5408\u7406\u5206\u914d Pod \u5230\u5408\u9002\u7684\u8282\u70b9\u4e0a\u3002</li> </ul>"},{"location":"devops/K8s_5.html#2-yaml","title":"2. \u793a\u4f8b YAML \u6587\u4ef6\u89e3\u91ca","text":"<p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u793a\u4f8b YAML \u6587\u4ef6\uff0c\u901a\u8fc7\u5b9a\u4e49 <code>requests</code> \u548c <code>limits</code> \u6765\u7ba1\u7406\u8d44\u6e90\u3002</p> <p><code>yaml apiVersion: v1 kind: Pod metadata:   name: resource-demo   namespace: default spec:   containers:   - name: resource-container     image: nginx     resources:       requests:         cpu: \"500m\"        # 500 \u6beb\u6838 CPU         memory: \"256Mi\"    # 256 MiB \u5185\u5b58       limits:         cpu: \"1\"           # 1 \u6838 CPU         memory: \"512Mi\"    # 512 MiB \u5185\u5b58</code></p>"},{"location":"devops/K8s_5.html#21","title":"2.1 \u914d\u7f6e\u9879\u8bf4\u660e","text":"<ul> <li> <p>requests:</p> </li> <li> <p><code>cpu: \"500m\"</code> \u8868\u793a\u5bb9\u5668\u9700\u8981 500 \u6beb\u6838 CPU\uff08\u5373 0.5 \u6838\uff09\u3002</p> </li> <li><code>memory: \"256Mi\"</code> \u8868\u793a\u5bb9\u5668\u9700\u8981 256 MiB \u5185\u5b58\u3002</li> <li>\u5f53 Pod \u521b\u5efa\u65f6\uff0cKubernetes \u8c03\u5ea6\u5668\u4f1a\u786e\u4fdd\u5bb9\u5668\u8c03\u5ea6\u5230\u4e00\u4e2a\u62e5\u6709\u8db3\u591f\u8d44\u6e90\u7684\u8282\u70b9\u4e0a\u3002\u5982\u679c\u67d0\u4e2a\u8282\u70b9\u53ef\u7528\u8d44\u6e90\u4e0d\u8db3\u4ee5\u6ee1\u8db3 <code>requests</code>\uff0c\u90a3\u4e48\u8be5 Pod \u5c06\u4e0d\u4f1a\u88ab\u8c03\u5ea6\u5230\u8be5\u8282\u70b9\u4e0a\u3002</li> <li> <p>limits:</p> </li> <li> <p><code>cpu: \"1\"</code> \u8868\u793a\u5bb9\u5668\u6700\u591a\u53ef\u4ee5\u4f7f\u7528 1 \u6838 CPU\u3002</p> </li> <li><code>memory: \"512Mi\"</code> \u8868\u793a\u5bb9\u5668\u6700\u591a\u53ef\u4ee5\u4f7f\u7528 512 MiB \u5185\u5b58\u3002</li> <li>\u5f53\u5bb9\u5668\u5c1d\u8bd5\u4f7f\u7528\u8d85\u8fc7 <code>limits</code> \u7684\u8d44\u6e90\u65f6\uff0cKubernetes \u4f1a\u91c7\u53d6\u63aa\u65bd\u9650\u5236\u4f7f\u7528\u3002<ul> <li>CPU \u8d85\u8fc7 <code>limits</code>\uff1a\u5bb9\u5668\u4f1a\u88ab\u9650\u5236\u4f7f\u7528\u66f4\u591a CPU\uff0c\u4f46\u662f\u4e0d\u4f1a\u88ab\u5f3a\u884c\u6740\u6b7b\u3002Kubernetes \u4f7f\u7528 CFS \u5e26\u5bbd\uff08CFS quota\uff09\u6765\u5bf9 CPU \u8fdb\u884c\u8282\u6d41\u3002</li> <li>\u5185\u5b58\u8d85\u8fc7 <code>limits</code>\uff1a\u5bb9\u5668\u4f1a\u88ab\u7cfb\u7edf\u7ec8\u6b62\uff08OOM\uff0c\u5373\u5185\u5b58\u6ea2\u51fa\uff09\u4ee5\u4fdd\u62a4\u8282\u70b9\u7684\u5176\u4ed6\u5bb9\u5668\u3002</li> </ul> </li> </ul>"},{"location":"devops/K8s_5.html#3-requests-limits","title":"3. requests \u548c limits \u7684\u4f5c\u7528\u53ca\u5176\u5f71\u54cd","text":"<ol> <li> <p>\u8d44\u6e90\u8c03\u5ea6\uff1a</p> </li> <li> <p>requests \u5bf9\u5e94\u7684\u662f Kubernetes \u8c03\u5ea6\u5668\u7684\u51b3\u7b56\u3002\u8c03\u5ea6\u5668\u6839\u636e\u8bf7\u6c42\u503c\u51b3\u5b9a\u54ea\u4e2a\u8282\u70b9\u9002\u5408\u5bb9\u7eb3\u65b0\u7684 Pod\u3002</p> </li> <li>\u5982\u679c\u8bbe\u7f6e <code>requests</code> \u8fc7\u9ad8\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4 Pod \u96be\u4ee5\u88ab\u8c03\u5ea6\uff0c\u56e0\u4e3a\u9700\u8981\u6709\u8db3\u591f\u8d44\u6e90\u7684\u8282\u70b9\u624d\u80fd\u63a5\u53d7\u8be5 Pod\u3002\u5982\u679c\u8bbe\u7f6e\u8fc7\u4f4e\uff0cPod \u4f1a\u88ab\u8c03\u5ea6\u5230\u8d44\u6e90\u4e0d\u8db3\u7684\u8282\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u6f5c\u5728\u7684\u8d44\u6e90\u4e89\u7528\u95ee\u9898\u3002</li> <li> <p>\u8d44\u6e90\u9650\u5236\uff1a</p> </li> <li> <p>limits \u5b9a\u4e49\u4e86\u5bb9\u5668\u4f7f\u7528\u8d44\u6e90\u7684\u4e0a\u9650\uff0c\u7528\u4e8e\u786e\u4fdd\u67d0\u4e2a Pod \u4e0d\u4f1a\u5360\u7528\u8d85\u8fc7\u5176\u914d\u989d\u7684\u8d44\u6e90\u3002</p> </li> <li>\u8bbe\u7f6e\u5408\u7406\u7684 <code>limits</code> \u53ef\u4ee5\u9632\u6b62\u201c\u8d44\u6e90\u62a2\u5360\u201d\u2014\u2014\u67d0\u4e2a\u5bb9\u5668\u5360\u7528\u5927\u91cf\u8d44\u6e90\u800c\u5f71\u54cd\u5230\u5176\u4ed6\u5bb9\u5668\u7684\u60c5\u51b5\u3002\u5982\u679c\u4e0d\u8bbe\u5b9a <code>limits</code>\uff0c\u67d0\u4e9b\u5de5\u4f5c\u8d1f\u8f7d\u53ef\u80fd\u4f1a\u65e0\u9650\u5236\u5730\u6d88\u8017\u8d44\u6e90\uff0c\u5bfc\u81f4\u5176\u4ed6\u5173\u952e\u4efb\u52a1\u65e0\u6cd5\u8fd0\u884c\u3002</li> <li> <p>\u9632\u6b62\u8d44\u6e90\u4e89\u7528\uff1a</p> </li> <li> <p>\u901a\u8fc7\u5bf9\u6bcf\u4e2a Pod \u7684 CPU \u548c\u5185\u5b58\u8fdb\u884c\u9650\u5236\uff0cKubernetes \u53ef\u4ee5\u786e\u4fdd\u6240\u6709\u5de5\u4f5c\u8d1f\u8f7d\u6309\u7167\u8bbe\u5b9a\u7684\u8d44\u6e90\u7ea6\u675f\u8fd0\u884c\uff0c\u9632\u6b62\u67d0\u4e9b\u5de5\u4f5c\u8d1f\u8f7d\u56e0\u7f16\u7a0b\u9519\u8bef\u6216\u5176\u4ed6\u539f\u56e0\u6d88\u8017\u8fc7\u591a\u8d44\u6e90\u800c\u5bfc\u81f4\u6574\u4e2a\u8282\u70b9\u6027\u80fd\u4e0b\u964d\u3002</p> </li> <li> <p>\u63d0\u9ad8\u8d44\u6e90\u5229\u7528\u7387\uff1a</p> </li> <li> <p>\u901a\u8fc7\u7cbe\u786e\u7684 <code>requests</code> \u548c <code>limits</code> \u914d\u7f6e\uff0c\u53ef\u4ee5\u66f4\u9ad8\u6548\u5730\u5229\u7528\u8282\u70b9\u4e0a\u7684\u8d44\u6e90\u3002</p> </li> <li>\u4f8b\u5982\uff0c\u5047\u8bbe\u8282\u70b9\u4e0a\u6709 4 \u6838 CPU\uff0c\u5982\u679c\u591a\u4e2a Pod \u7684 <code>requests</code> \u52a0\u8d77\u6765\u4e0d\u8d85\u8fc7 4 \u6838\uff0c\u8c03\u5ea6\u5668\u4f1a\u5408\u7406\u5730\u5206\u914d\u5b83\u4eec\u5230\u8fd9\u4e2a\u8282\u70b9\u4e2d\uff0c\u5145\u5206\u5229\u7528\u8d44\u6e90\u3002</li> </ol>"},{"location":"devops/K8s_5.html#4_2","title":"4. \u793a\u4f8b\u5206\u6790\uff1a\u4e3a\u4f55\u5408\u7406\u914d\u7f6e\u975e\u5e38\u91cd\u8981\uff1f","text":"<p>\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5e38\u89c1\u7684\u914d\u7f6e\u65b9\u6848\u4ee5\u53ca\u5b83\u4eec\u7684\u6548\u679c\uff1a</p>"},{"location":"devops/K8s_5.html#41-requests-limits","title":"4.1 \u6ca1\u6709\u8bbe\u7f6e <code>requests</code> \u548c <code>limits</code>","text":"<ul> <li>\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e <code>requests</code>\uff0c\u8c03\u5ea6\u5668\u5c06\u8ba4\u4e3a\u8be5 Pod \u7684\u8d44\u6e90\u9700\u6c42\u4e3a 0\uff0c\u8fd9\u610f\u5473\u7740 Pod \u53ef\u4ee5\u88ab\u8c03\u5ea6\u5230\u4efb\u4f55\u8282\u70b9\uff0c\u5373\u4f7f\u8be5\u8282\u70b9\u51e0\u4e4e\u6ca1\u6709\u53ef\u7528\u8d44\u6e90\u3002</li> <li>\u6ca1\u6709 <code>limits</code> \u610f\u5473\u7740\u5bb9\u5668\u53ef\u4ee5\u65e0\u9650\u5236\u5730\u6d88\u8017\u8282\u70b9\u8d44\u6e90\uff0c\u53ef\u80fd\u5bfc\u81f4\u7cfb\u7edf OOM\uff08Out of Memory\uff09\u5e76\u5f3a\u5236\u7ec8\u6b62\u5176\u4ed6\u5bb9\u5668\u3002</li> </ul>"},{"location":"devops/K8s_5.html#42-requests-limits","title":"4.2 \u8bbe\u7f6e\u4e86 <code>requests</code> \u4f46\u6ca1\u6709\u8bbe\u7f6e <code>limits</code>","text":"<ul> <li>Pod \u4f1a\u88ab\u8c03\u5ea6\u5230\u6709\u8db3\u591f\u53ef\u7528\u8d44\u6e90\u7684\u8282\u70b9\u4e0a\uff0c\u4f46\u7531\u4e8e\u6ca1\u6709 <code>limits</code>\uff0c\u5bb9\u5668\u4ecd\u7136\u53ef\u4ee5\u5360\u7528\u66f4\u591a\u8d44\u6e90\uff0c\u53ef\u80fd\u5bfc\u81f4\u5f71\u54cd\u5176\u4ed6\u5bb9\u5668\u3002</li> </ul>"},{"location":"devops/K8s_5.html#43-requests-limits","title":"4.3 \u8bbe\u7f6e\u4e86\u5408\u7406\u7684 <code>requests</code> \u548c <code>limits</code>","text":"<ul> <li>\u8c03\u5ea6\u5668\u4f1a\u6839\u636e <code>requests</code> \u786e\u5b9a\u662f\u5426\u6709\u8db3\u591f\u8d44\u6e90\u53ef\u4f9b\u5206\u914d\uff0c\u800c <code>limits</code> \u4f1a\u9650\u5236\u5bb9\u5668\u6700\u5927\u8d44\u6e90\u4f7f\u7528\uff0c\u786e\u4fdd\u8d44\u6e90\u4e0d\u4f1a\u88ab\u5355\u4e2a\u5bb9\u5668\u62a2\u5360\uff0c\u4ece\u800c\u4fdd\u62a4\u5176\u4ed6\u5bb9\u5668\u7684\u8fd0\u884c\u3002</li> </ul>"},{"location":"devops/K8s_5.html#5_2","title":"5. \u5c0f\u7ed3\u548c\u6700\u4f73\u5b9e\u8df5","text":"<ul> <li> <p>\u4e3a\u6240\u6709 Pod \u8bbe\u7f6e requests \u548c limits\uff1a</p> </li> <li> <p>\u4e3a Pod \u8bbe\u7f6e\u5408\u7406\u7684 <code>requests</code> \u548c <code>limits</code>\uff0c\u53ef\u4ee5\u907f\u514d\u8d44\u6e90\u4e89\u7528\u5e76\u63d0\u9ad8\u8c03\u5ea6\u7684\u51c6\u786e\u6027\u3002</p> </li> <li> <p>\u5408\u7406\u8bbe\u7f6e\u503c\uff1a</p> </li> <li> <p><code>requests</code> \u5e94\u8be5\u8bbe\u7f6e\u4e3a\u5bb9\u5668\u7684\u6b63\u5e38\u8fd0\u884c\u6240\u9700\u7684\u8d44\u6e90\uff0c\u4ee5\u786e\u4fdd Pod \u80fd\u88ab\u8c03\u5ea6\u5230\u5408\u9002\u7684\u8282\u70b9\u3002</p> </li> <li><code>limits</code> \u5219\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u7a0d\u9ad8\u4e8e <code>requests</code>\uff0c\u4ee5\u786e\u4fdd\u5728\u9ad8\u8d1f\u8f7d\u65f6\u5bb9\u5668\u6709\u80fd\u529b\u4f7f\u7528\u66f4\u591a\u8d44\u6e90\uff0c\u4f46\u4ecd\u53d7\u9650\u4e8e\u4e0a\u9650\u503c\u3002</li> <li> <p>\u76d1\u63a7\u548c\u8c03\u6574\uff1a</p> </li> <li> <p>\u4f7f\u7528\u76d1\u63a7\u5de5\u5177\uff08\u5982 Prometheus \u548c Grafana\uff09\u6765\u89c2\u5bdf Pod \u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\uff0c\u5b9a\u671f\u8c03\u6574 <code>requests</code> \u548c <code>limits</code> \u7684\u914d\u7f6e\uff0c\u4ee5\u9002\u5e94\u5e94\u7528\u7a0b\u5e8f\u7684\u8d44\u6e90\u9700\u6c42\u53d8\u5316\u3002</p> </li> <li> <p>\u5e73\u8861\u8d44\u6e90\u5229\u7528\u7387\u4e0e\u8c03\u5ea6\u7075\u6d3b\u6027\uff1a</p> </li> <li> <p>\u5982\u679c <code>requests</code> \u8bbe\u7f6e\u8fc7\u5927\uff0c\u53ef\u80fd\u5bfc\u81f4 Pod \u96be\u4ee5\u88ab\u8c03\u5ea6\uff1b\u5982\u679c\u8bbe\u7f6e\u8fc7\u5c0f\uff0c\u5219\u53ef\u80fd\u5bfc\u81f4\u8282\u70b9\u8d44\u6e90\u7d27\u5f20\uff0c\u56e0\u6b64\u9700\u8981\u6839\u636e\u5b9e\u9645\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u8fdb\u884c\u8c03\u6574\u3002</p> </li> </ul> <p>\u901a\u8fc7\u5408\u7406\u7684\u8d44\u6e90\u914d\u7f6e\uff0cKubernetes \u53ef\u4ee5\u786e\u4fdd\u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\u90fd\u80fd\u83b7\u5f97\u6240\u9700\u7684\u8d44\u6e90\uff0c\u907f\u514d\u8fc7\u5ea6\u5206\u914d\u548c\u8d44\u6e90\u4e89\u7528\u95ee\u9898\uff0c\u4ece\u800c\u63d0\u9ad8\u6574\u4e2a\u96c6\u7fa4\u7684\u7a33\u5b9a\u6027\u548c\u8d44\u6e90\u5229\u7528\u7387\u3002</p>"},{"location":"devops/K8s_6.html","title":"K8s \u76f8\u5173\u95ee\u9898\u96c6\u9526\uff08\u4e94\uff09","text":""},{"location":"devops/K8s_6.html#8","title":"8 \u5b9e\u6218\u95ee\u9898","text":""},{"location":"devops/K8s_6.html#81-pod-pod","title":"8.1 \u5982\u679c\u4e00\u4e2a Pod \u9700\u8981\u8bbf\u95ee\u53e6\u4e00\u4e2a Pod\uff0c\u5e94\u8be5\u600e\u4e48\u505a\uff1f","text":"<p>\u4f7f\u7528 Kubernetes Service \u521b\u5efa\u7a33\u5b9a\u7684\u8bbf\u95ee\u5165\u53e3\uff0c\u6216\u8005\u914d\u7f6e Ingress \u89c4\u5219\u3002</p> <p>\u4ee5\u4e0b\u662f\u5b9e\u73b0 Pod \u4e4b\u95f4\u76f8\u4e92\u8bbf\u95ee\u7684\u6b65\u9aa4\u548c\u5bf9\u5e94\u7684\u547d\u4ee4\u793a\u4f8b\uff1a</p>"},{"location":"devops/K8s_6.html#1-pod","title":"1. \u521b\u5efa\u4e24\u4e2a Pod","text":"<p>\u5148\u521b\u5efa\u4e24\u4e2a Pod\uff0c\u5047\u8bbe\u7b2c\u4e00\u4e2a Pod \u8fd0\u884c nginx\uff0c\u53e6\u4e00\u4e2a Pod \u8fd0\u884c\u4e00\u4e2a\u7b80\u5355\u7684 HTTP \u670d\u52a1\u5668\u3002</p>"},{"location":"devops/K8s_6.html#nginx-pod","title":"\u521b\u5efa nginx Pod","text":"<p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6765\u521b\u5efa\u4e00\u4e2a\u8fd0\u884c nginx \u7684 Pod\uff1a</p> <p><code>bash kubectl run nginx-pod --image=nginx --port=80</code></p>"},{"location":"devops/K8s_6.html#http-pod","title":"\u521b\u5efa HTTP \u670d\u52a1\u5668 Pod","text":"<p>\u4f7f\u7528 Python \u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684 HTTP \u670d\u52a1\u5668\uff1a</p> <p><code>bash kubectl run http-server-pod --image=hashicorp/http-echo -- -text=\"Hello from http-server-pod\"</code></p>"},{"location":"devops/K8s_6.html#2-service-nginx-pod","title":"2. \u521b\u5efa Service \u4e3a nginx Pod \u66b4\u9732\u670d\u52a1","text":"<p>\u4e3a\u4e86\u8ba9\u5176\u4ed6 Pod \u53ef\u4ee5\u8bbf\u95ee\u5230 <code>nginx-pod</code>\uff0c\u6211\u4eec\u9700\u8981\u4e3a\u5b83\u521b\u5efa\u4e00\u4e2a Service\u3002</p>"},{"location":"devops/K8s_6.html#clusterip-service","title":"\u521b\u5efa ClusterIP Service","text":"<p><code>bash kubectl expose pod nginx-pod --port=80 --target-port=80 --name=nginx-service</code></p> <p>\u8fd9\u5c06\u4e3a <code>nginx-pod</code> \u521b\u5efa\u4e00\u4e2a\u540d\u4e3a <code>nginx-service</code> \u7684 ClusterIP \u7c7b\u578b\u7684 Service\u3002\u5176\u4ed6 Pod \u53ef\u4ee5\u901a\u8fc7 <code>nginx-service</code> \u7684 DNS \u540d\u79f0\u6765\u8bbf\u95ee\u5b83\u3002</p>"},{"location":"devops/K8s_6.html#3-nginx-pod","title":"3. \u8bbf\u95ee nginx Pod","text":"<p>\u8fdb\u5165 <code>http-server-pod</code>\uff0c\u4f7f\u7528 <code>curl</code> \u6765\u8bbf\u95ee <code>nginx-service</code>\uff1a</p> <p><code>bash kubectl exec -it http-server-pod -- /bin/sh</code></p> <p>\u5728 Pod \u7684\u7ec8\u7aef\u4e2d\uff0c\u4f7f\u7528 <code>curl</code> \u547d\u4ee4\u6765\u8bbf\u95ee <code>nginx-service</code>\uff1a</p> <p><code>sh curl http://nginx-service</code></p> <p>\u8fd9\u4f1a\u8fd4\u56de <code>nginx</code> \u7684\u9ed8\u8ba4\u9996\u9875\u5185\u5bb9\u3002</p>"},{"location":"devops/K8s_6.html#_1","title":"\u603b\u7ed3","text":"<ol> <li>\u521b\u5efa Pod\uff1a\u901a\u8fc7 <code>kubectl run</code> \u521b\u5efa\u6240\u9700\u7684 Pod\u3002</li> <li>\u66b4\u9732\u670d\u52a1\uff1a\u901a\u8fc7 <code>kubectl expose</code> \u521b\u5efa\u4e00\u4e2a Service \u6765\u63d0\u4f9b\u7a33\u5b9a\u7684\u8bbf\u95ee\u5165\u53e3\u3002</li> <li>\u901a\u8fc7 DNS \u540d\u79f0\u8bbf\u95ee\uff1aPod \u4e4b\u95f4\u53ef\u4ee5\u4f7f\u7528 Service \u540d\u79f0\u4f5c\u4e3a DNS \u6765\u4e92\u76f8\u8bbf\u95ee\u3002</li> </ol>"},{"location":"devops/K8s_6.html#82-kubernetes","title":"8.2 \u5982\u4f55\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u4fdd\u8bc1 Kubernetes \u5e94\u7528\u7684\u9ad8\u53ef\u7528\u6027\u548c\u7a33\u5b9a\u6027\uff1f","text":"<p>\u8ba8\u8bba\u6eda\u52a8\u66f4\u65b0\u7b56\u7565\u3001\u5065\u5eb7\u68c0\u67e5\uff08Liveness \u548c Readiness Probe\uff09\u3001\u65e5\u5fd7\u76d1\u63a7\u548c\u81ea\u52a8\u6269\u5c55\u3002</p> <p>\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u4fdd\u8bc1 Kubernetes \u5e94\u7528\u7684\u9ad8\u53ef\u7528\u6027\u548c\u7a33\u5b9a\u6027\u975e\u5e38\u91cd\u8981\u3002\u53ef\u4ee5\u4ece\u591a\u4e2a\u65b9\u9762\u5165\u624b\uff0c\u5305\u62ec\u6eda\u52a8\u66f4\u65b0\u7b56\u7565\u3001\u5065\u5eb7\u68c0\u67e5\u3001\u65e5\u5fd7\u76d1\u63a7\u548c\u81ea\u52a8\u6269\u5c55\u7b49\u3002\u4ee5\u4e0b\u662f\u8fd9\u4e9b\u7b56\u7565\u7684\u8be6\u7ec6\u4ecb\u7ecd\uff1a</p>"},{"location":"devops/K8s_6.html#1-rolling-update","title":"1. \u6eda\u52a8\u66f4\u65b0\u7b56\u7565\uff08Rolling Update\uff09","text":"<p>\u6eda\u52a8\u66f4\u65b0\u662f\u4e00\u79cd\u65e0\u7f1d\u66f4\u65b0\u5e94\u7528\u7a0b\u5e8f\u7684\u65b9\u5f0f\uff0c\u5728\u4e0d\u4e2d\u65ad\u670d\u52a1\u7684\u60c5\u51b5\u4e0b\u9010\u6b65\u66ff\u6362\u65e7\u7248\u672c\u7684 Pod\uff0c\u4ee5\u4fdd\u8bc1\u5e94\u7528\u7684\u9ad8\u53ef\u7528\u6027\u548c\u7a33\u5b9a\u6027\u3002</p> <ul> <li> <p>\u4f7f\u7528 Rolling Update\uff1a</p> </li> <li> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cKubernetes \u4f7f\u7528\u6eda\u52a8\u66f4\u65b0\u6765\u66f4\u65b0 Deployment \u4e2d\u7684 Pod\u3002</p> </li> <li>\u5728\u6eda\u52a8\u66f4\u65b0\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u9010\u4e2a\u66ff\u6362\u65e7\u7684 Pod\uff0c\u4ee5\u907f\u514d\u670d\u52a1\u4e2d\u65ad\u3002</li> <li> <p>\u5982\u4f55\u8bbe\u7f6e\u6eda\u52a8\u66f4\u65b0\u7b56\u7565\uff1a</p> </li> <li> <p><code>maxUnavailable</code>\uff1a\u8bbe\u7f6e\u66f4\u65b0\u65f6\u6700\u591a\u53ef\u4ee5\u4e0d\u53ef\u7528\u7684 Pod \u6570\u91cf\uff0c\u53ef\u4ee5\u662f\u7edd\u5bf9\u6570\uff08\u5982 <code>1</code>\uff09\u6216\u767e\u5206\u6bd4\uff08\u5982 <code>25%</code>\uff09\u3002</p> </li> <li><code>maxSurge</code>\uff1a\u8bbe\u7f6e\u66f4\u65b0\u65f6\u53ef\u4ee5\u989d\u5916\u521b\u5efa\u7684\u65b0 Pod \u6570\u91cf\uff0c\u907f\u514d\u5728\u5347\u7ea7\u671f\u95f4\u7f29\u5bb9\u592a\u5feb\u5bfc\u81f4\u670d\u52a1\u4e0d\u53ef\u7528\u3002</li> </ul> <p>\u793a\u4f8b\uff1aDeployment \u4e2d\u6eda\u52a8\u66f4\u65b0\u914d\u7f6e</p> <p><code>yaml apiVersion: apps/v1 kind: Deployment metadata:   name: example-deployment spec:   replicas: 3   strategy:     type: RollingUpdate     rollingUpdate:       maxUnavailable: 1       maxSurge: 1   template:     metadata:       labels:         app: example     spec:       containers:       - name: example-container         image: example/image:latest</code></p>"},{"location":"devops/K8s_6.html#2-liveness-readiness-probe","title":"2. \u5065\u5eb7\u68c0\u67e5\uff08Liveness \u548c Readiness Probe\uff09","text":"<p>\u5065\u5eb7\u68c0\u67e5\u7528\u4e8e\u786e\u4fdd\u5e94\u7528\u7a0b\u5e8f\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u7684\u7a33\u5b9a\u6027\uff0c\u5e76\u53ca\u65f6\u5904\u7406\u6545\u969c\u3002</p> <ul> <li> <p>Liveness Probe\uff1a</p> </li> <li> <p>\u7528\u4e8e\u68c0\u6d4b\u5e94\u7528\u7a0b\u5e8f\u662f\u5426\u5361\u6b7b\u6216\u5931\u53bb\u54cd\u5e94\u3002</p> </li> <li>\u5982\u679c Liveness Probe \u68c0\u6d4b\u5230\u5e94\u7528\u5f02\u5e38\uff0cKubernetes \u5c06\u91cd\u65b0\u542f\u52a8\u8be5\u5bb9\u5668\u3002</li> <li> <p>Readiness Probe\uff1a</p> </li> <li> <p>\u7528\u4e8e\u68c0\u6d4b\u5e94\u7528\u7a0b\u5e8f\u662f\u5426\u53ef\u4ee5\u6b63\u5e38\u63a5\u6536\u6d41\u91cf\u3002</p> </li> <li>\u5982\u679c Readiness Probe \u5931\u8d25\uff0c\u5219\u8be5 Pod \u4e0d\u4f1a\u63a5\u6536\u6765\u81ea Service \u7684\u6d41\u91cf\uff0c\u4ece\u800c\u907f\u514d\u5c06\u8bf7\u6c42\u53d1\u9001\u7ed9\u4e0d\u5065\u5eb7\u7684\u5b9e\u4f8b\u3002</li> </ul> <p>\u793a\u4f8b\uff1aLiveness \u548c Readiness Probe \u914d\u7f6e</p> <p><code>yaml apiVersion: v1 kind: Pod metadata:   name: example-pod spec:   containers:   - name: example-container     image: example/image:latest     livenessProbe:       httpGet:         path: /healthz         port: 8080       initialDelaySeconds: 3       periodSeconds: 10     readinessProbe:       httpGet:         path: /readiness         port: 8080       initialDelaySeconds: 3       periodSeconds: 10</code></p> <ul> <li><code>initialDelaySeconds</code>\uff1a\u5bb9\u5668\u542f\u52a8\u540e\u7b49\u5f85\u591a\u957f\u65f6\u95f4\u5f00\u59cb\u63a2\u6d4b\u3002</li> <li><code>periodSeconds</code>\uff1a\u63a2\u6d4b\u7684\u95f4\u9694\u65f6\u95f4\u3002</li> </ul>"},{"location":"devops/K8s_6.html#3","title":"3. \u65e5\u5fd7\u76d1\u63a7","text":"<p>\u4e3a\u4e86\u53ca\u65f6\u53d1\u73b0\u95ee\u9898\u548c\u5f02\u5e38\uff0c\u9700\u8981\u5bf9\u5e94\u7528\u7a0b\u5e8f\u8fdb\u884c\u65e5\u5fd7\u76d1\u63a7\u548c\u5b9e\u65f6\u544a\u8b66\u3002</p> <ul> <li> <p>\u65e5\u5fd7\u6536\u96c6\u548c\u96c6\u4e2d\u5316\u7ba1\u7406\uff1a</p> </li> <li> <p>\u5728 Kubernetes \u4e2d\uff0cPod \u7684\u65e5\u5fd7\u53ef\u4ee5\u901a\u8fc7 <code>kubectl logs</code> \u547d\u4ee4\u67e5\u770b\uff0c\u4f46\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u9700\u8981\u96c6\u4e2d\u5316\u7684\u65e5\u5fd7\u7ba1\u7406\u3002</p> </li> <li>\u901a\u8fc7\u5de5\u5177\u5982 ELK\uff08Elasticsearch, Logstash, Kibana\uff09 \u6216 EFK\uff08Elasticsearch, Fluentd, Kibana\uff09 \u5806\u6808\u5c06\u65e5\u5fd7\u96c6\u4e2d\u6536\u96c6\u3001\u5b58\u50a8\u548c\u5206\u6790\u3002</li> <li> <p>\u76d1\u63a7\u7cfb\u7edf\uff1a</p> </li> <li> <p>\u53ef\u4ee5\u4f7f\u7528 Prometheus + Grafana \u6765\u5bf9\u5e94\u7528\u7a0b\u5e8f\u8fdb\u884c\u76d1\u63a7\u3002</p> </li> <li>Prometheus \u53ef\u4ee5\u91c7\u96c6\u5e94\u7528\u7684\u6307\u6807\u6570\u636e\uff0cGrafana \u7528\u4e8e\u5c55\u793a\u548c\u544a\u8b66\u3002</li> <li> <p>\u65e5\u5fd7\u8f6e\u8f6c\uff08Log Rotation\uff09\uff1a</p> </li> <li> <p>Kubernetes \u4e0d\u4f1a\u81ea\u52a8\u7ba1\u7406\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\u548c\u5386\u53f2\u6570\u636e\u3002\u53ef\u4ee5\u901a\u8fc7 <code>logrotate</code> \u7b49\u5de5\u5177\u7ba1\u7406\u65e5\u5fd7\u7684\u8f6e\u8f6c\uff0c\u907f\u514d\u65e5\u5fd7\u6587\u4ef6\u5360\u7528\u5927\u91cf\u78c1\u76d8\u7a7a\u95f4\u3002</p> </li> </ul>"},{"location":"devops/K8s_6.html#4-horizontal-pod-autoscaler-vertical-pod-autoscaler","title":"4. \u81ea\u52a8\u6269\u5c55\uff08Horizontal Pod Autoscaler, Vertical Pod Autoscaler\uff09","text":"<p>\u4e3a\u4e86\u5e94\u5bf9\u8d1f\u8f7d\u7684\u53d8\u5316\uff0cKubernetes \u63d0\u4f9b\u4e86\u81ea\u52a8\u6269\u5c55\u529f\u80fd\u3002</p> <ul> <li>\u6c34\u5e73\u81ea\u52a8\u6269\u5c55\uff08Horizontal Pod Autoscaler, HPA\uff09\uff1a</li> <li>HPA \u53ef\u4ee5\u6839\u636e CPU \u4f7f\u7528\u7387\u6216\u81ea\u5b9a\u4e49\u6307\u6807\u6765\u81ea\u52a8\u589e\u52a0\u6216\u51cf\u5c11 Pod \u7684\u6570\u91cf\uff0c\u4ece\u800c\u9002\u5e94\u4e0d\u540c\u7684\u8d1f\u8f7d\u3002</li> <li>\u4f8b\u5982\uff0c\u5f53 CPU \u4f7f\u7528\u7387\u8d85\u8fc7\u8bbe\u5b9a\u7684\u9608\u503c\u65f6\uff0cHPA \u4f1a\u589e\u52a0 Pod \u7684\u526f\u672c\u6570\uff0c\u4fdd\u8bc1\u670d\u52a1\u7684\u9ad8\u53ef\u7528\u6027\u3002</li> </ul> <p>\u793a\u4f8b\uff1aHPA \u914d\u7f6e</p> <p><code>yaml apiVersion: autoscaling/v2 kind: HorizontalPodAutoscaler metadata:   name: example-hpa spec:   scaleTargetRef:     apiVersion: apps/v1     kind: Deployment     name: example-deployment   minReplicas: 2   maxReplicas: 10   metrics:   - type: Resource     resource:       name: cpu       target:         type: Utilization         averageUtilization: 80</code></p> <ul> <li><code>minReplicas</code> \u548c <code>maxReplicas</code>\uff1a\u5b9a\u4e49 Pod \u7684\u6700\u5c0f\u548c\u6700\u5927\u6570\u91cf\u3002</li> <li><code>averageUtilization</code>\uff1a\u5f53 CPU \u4f7f\u7528\u7387\u8d85\u8fc7 80% \u65f6\uff0cHPA \u4f1a\u5f00\u59cb\u6269\u5bb9\u3002</li> <li> <p>\u5782\u76f4\u81ea\u52a8\u6269\u5c55\uff08Vertical Pod Autoscaler, VPA\uff09\uff1a</p> </li> <li> <p>VPA \u53ef\u4ee5\u81ea\u52a8\u8c03\u6574 Pod \u4e2d\u5bb9\u5668\u7684\u8d44\u6e90\u8bf7\u6c42\uff08CPU \u548c\u5185\u5b58\uff09\uff0c\u4ece\u800c\u9002\u5e94\u5e94\u7528\u7a0b\u5e8f\u7684\u9700\u6c42\u3002</p> </li> <li>VPA \u4e3b\u8981\u7528\u4e8e\u786e\u4fdd\u8d44\u6e90\u5206\u914d\u7684\u5408\u7406\u6027\uff0c\u907f\u514d\u8d44\u6e90\u7684\u8fc7\u5ea6\u4f7f\u7528\u6216\u4e0d\u8db3\u3002</li> </ul>"},{"location":"devops/K8s_6.html#5","title":"5. \u603b\u7ed3","text":"<p>\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u4fdd\u969c Kubernetes \u5e94\u7528\u9ad8\u53ef\u7528\u6027\u548c\u7a33\u5b9a\u6027\u7684\u51e0\u79cd\u6709\u6548\u63aa\u65bd\uff1a</p> <ul> <li>\u6eda\u52a8\u66f4\u65b0\u7b56\u7565\uff1a\u901a\u8fc7\u8bbe\u7f6e <code>maxUnavailable</code> \u548c <code>maxSurge</code> \u786e\u4fdd\u5e94\u7528\u5e73\u6ed1\u5347\u7ea7\uff0c\u907f\u514d\u4e2d\u65ad\u3002</li> <li>\u5065\u5eb7\u68c0\u67e5\uff08Liveness \u548c Readiness Probe\uff09\uff1a\u901a\u8fc7\u914d\u7f6e\u63a2\u9488\u786e\u4fdd\u5e94\u7528\u8fd0\u884c\u72b6\u51b5\u826f\u597d\uff0c\u5e76\u53ca\u65f6\u6062\u590d\u6545\u969c\u3002</li> <li>\u65e5\u5fd7\u76d1\u63a7\uff1a\u4f7f\u7528 ELK/EFK \u5806\u6808\u96c6\u4e2d\u7ba1\u7406\u65e5\u5fd7\uff0c\u7ed3\u5408 Prometheus \u548c Grafana \u5b9e\u73b0\u53ef\u89c6\u5316\u76d1\u63a7\u548c\u544a\u8b66\u3002</li> <li>\u81ea\u52a8\u6269\u5c55\uff1a\u901a\u8fc7 HPA \u548c VPA \u81ea\u52a8\u8c03\u6574\u5e94\u7528\u7684\u526f\u672c\u6570\u91cf\u548c\u8d44\u6e90\u5206\u914d\uff0c\u5e94\u5bf9\u8d1f\u8f7d\u53d8\u5316\u3002 </li> </ul>"},{"location":"devops/K8s_6.html#83","title":"8.3 \u5982\u4f55\u5904\u7406\u96c6\u7fa4\u4e2d\u67d0\u4e2a\u8282\u70b9\u9891\u7e41\u91cd\u542f\u7684\u95ee\u9898\uff1f","text":"<p>\u9700\u8981\u68c0\u67e5\u8282\u70b9\u65e5\u5fd7\u3001\u5206\u6790 kubelet \u548c kube-proxy \u7684\u8fd0\u884c\u72b6\u6001\uff0c\u53ef\u80fd\u9700\u8981\u8bca\u65ad\u64cd\u4f5c\u7cfb\u7edf\u548c\u786c\u4ef6\u95ee\u9898\u3002</p> <p>\u8981\u5904\u7406 Kubernetes \u96c6\u7fa4\u4e2d\u67d0\u4e2a\u8282\u70b9\u9891\u7e41\u91cd\u542f\u7684\u95ee\u9898\uff0c\u9700\u8981\u8fdb\u884c\u5168\u9762\u7684\u6545\u969c\u6392\u67e5\uff0c\u4ee5\u627e\u51fa\u95ee\u9898\u7684\u6839\u672c\u539f\u56e0\u3002\u4ee5\u4e0b\u662f\u53ef\u80fd\u7684\u6b65\u9aa4\u548c\u8981\u68c0\u67e5\u7684\u7ec6\u8282\uff1a</p>"},{"location":"devops/K8s_6.html#1","title":"1. \u68c0\u67e5\u8282\u70b9\u65e5\u5fd7","text":""},{"location":"devops/K8s_6.html#_2","title":"\u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7","text":"<p>\u8282\u70b9\u9891\u7e41\u91cd\u542f\u65f6\uff0c\u9996\u5148\u9700\u8981\u68c0\u67e5\u7cfb\u7edf\u7ea7\u522b\u7684\u65e5\u5fd7\u3002\u901a\u8fc7 SSH \u8fde\u63a5\u5230\u51fa\u95ee\u9898\u7684\u8282\u70b9\u4e0a\uff0c\u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\uff0c\u4ee5\u786e\u5b9a\u662f\u5426\u5b58\u5728\u5185\u6838\u5d29\u6e83\u3001\u5185\u5b58\u4e0d\u8db3\u3001\u786c\u4ef6\u6545\u969c\u7b49\u95ee\u9898\u3002</p> <ul> <li>\u4f7f\u7528 <code>journalctl</code> \u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\uff1a</li> </ul> <p><code>bash   journalctl -xe</code></p> <ul> <li>\u53ef\u4ee5\u901a\u8fc7 <code>journalctl</code> \u68c0\u67e5\u7cfb\u7edf\u542f\u52a8\u5931\u8d25\u7684\u539f\u56e0\u4ee5\u53ca\u5185\u6838\u76f8\u5173\u7684\u9519\u8bef\u3002</li> </ul>"},{"location":"devops/K8s_6.html#docker-containerd","title":"\u67e5\u770b Docker / Containerd \u65e5\u5fd7","text":"<p>Kubernetes \u8282\u70b9\u4f7f\u7528\u5bb9\u5668\u8fd0\u884c\u65f6\u6765\u7ba1\u7406\u5bb9\u5668\uff08\u4f8b\u5982 Docker \u6216 Containerd\uff09\u3002\u53ef\u4ee5\u901a\u8fc7\u67e5\u770b\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u65e5\u5fd7\u6765\u786e\u5b9a\u8282\u70b9\u95ee\u9898\u3002</p> <ul> <li>\u67e5\u770b Docker \u65e5\u5fd7\uff1a</li> </ul> <p><code>bash   journalctl -u docker</code> - \u67e5\u770b Containerd \u65e5\u5fd7\uff1a</p> <p><code>bash   journalctl -u containerd</code></p> <p>\u8fd9\u4e9b\u65e5\u5fd7\u53ef\u4ee5\u5e2e\u52a9\u786e\u5b9a\u5bb9\u5668\u8fd0\u884c\u65f6\u662f\u5426\u9047\u5230\u9519\u8bef\uff0c\u4f8b\u5982\u56e0\u4e3a\u8d44\u6e90\u9650\u5236\u800c\u9891\u7e41\u91cd\u542f\u5bb9\u5668\u3002</p>"},{"location":"devops/K8s_6.html#2-kubelet","title":"2. \u5206\u6790 <code>kubelet</code> \u72b6\u6001","text":"<p><code>kubelet</code> \u662f Kubernetes \u96c6\u7fa4\u4e2d\u8d1f\u8d23\u7ba1\u7406\u548c\u76d1\u63a7 Pod \u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u5982\u679c\u5b83\u51fa\u73b0\u95ee\u9898\uff0c\u8282\u70b9\u7684\u7a33\u5b9a\u6027\u4e5f\u4f1a\u53d7\u5230\u5f71\u54cd\u3002</p> <ul> <li>\u68c0\u67e5 <code>kubelet</code> \u72b6\u6001\uff1a</li> </ul> <p><code>bash   systemctl status kubelet</code></p> <ul> <li>\u786e\u4fdd <code>kubelet</code> \u6b63\u5728\u6b63\u5e38\u8fd0\u884c\uff0c\u5982\u679c\u6709\u4efb\u4f55\u9519\u8bef\u4fe1\u606f\uff0c\u901a\u5e38\u4f1a\u5728\u8f93\u51fa\u4e2d\u663e\u793a\u3002</li> <li>\u8fd8\u53ef\u4ee5\u4f7f\u7528 <code>journalctl -u kubelet</code> \u67e5\u770b kubelet \u7684\u65e5\u5fd7\uff0c\u4e86\u89e3\u8be6\u7ec6\u7684\u9519\u8bef\u4fe1\u606f\u3002</li> <li> <p>\u5e38\u89c1\u95ee\u9898\uff1a</p> </li> <li> <p>\u8282\u70b9\u4e0d\u53ef\u8c03\u5ea6\uff1a\u68c0\u67e5 kubelet \u662f\u5426\u56e0\u4e3a\u8282\u70b9\u8d44\u6e90\u4e0d\u8db3\u800c\u505c\u6b62\u8c03\u5ea6 Pod\u3002</p> </li> <li>\u5185\u5b58\u4e0d\u8db3\uff1a\u5982\u679c\u8282\u70b9\u5185\u5b58\u4e0d\u8db3\uff0ckubelet \u53ef\u80fd\u4f1a\u5c1d\u8bd5\u9a71\u9010 Pod\u3002</li> <li>\u78c1\u76d8\u538b\u529b\uff1a\u5f53\u78c1\u76d8\u538b\u529b\u5f88\u5927\u65f6\uff0ckubelet \u4f1a\u505c\u6b62\u8c03\u5ea6\u65b0\u5bb9\u5668\u4ee5\u907f\u514d\u66f4\u591a\u78c1\u76d8\u5199\u5165\u3002</li> </ul>"},{"location":"devops/K8s_6.html#3-kube-proxy","title":"3. \u68c0\u67e5 <code>kube-proxy</code> \u72b6\u6001","text":"<p><code>kube-proxy</code> \u8d1f\u8d23\u7ba1\u7406\u8282\u70b9\u7684\u7f51\u7edc\u4ee3\u7406\u548c\u8d1f\u8f7d\u5747\u8861\u3002\u5982\u679c <code>kube-proxy</code> \u51fa\u73b0\u6545\u969c\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cd\u8282\u70b9\u7684\u7f51\u7edc\u8bbf\u95ee\u548c\u670d\u52a1\u6d41\u91cf\u3002</p> <ul> <li>\u67e5\u770b <code>kube-proxy</code> \u7684\u8fd0\u884c\u72b6\u6001\uff1a</li> </ul> <p><code>bash   systemctl status kube-proxy</code> - \u67e5\u770b <code>kube-proxy</code> \u65e5\u5fd7\uff1a</p> <p><code>bash   journalctl -u kube-proxy</code> - \u68c0\u67e5\u7f51\u7edc\u914d\u7f6e\uff1a</p> <ul> <li>\u67e5\u770b\u8282\u70b9\u7684\u7f51\u7edc\u8bbe\u7f6e\uff0c\u786e\u8ba4 <code>iptables</code> \u6216 <code>ipvs</code> \u89c4\u5219\u662f\u5426\u6b63\u5e38\u3002</li> <li>\u68c0\u67e5\u8282\u70b9\u4e0a\u662f\u5426\u5b58\u5728 IP \u51b2\u7a81\u6216\u8005\u9632\u706b\u5899\u89c4\u5219\u9519\u8bef\u7b49\u95ee\u9898\u3002</li> </ul>"},{"location":"devops/K8s_6.html#4","title":"4. \u8bca\u65ad\u64cd\u4f5c\u7cfb\u7edf\u548c\u786c\u4ef6\u95ee\u9898","text":"<p>\u5982\u679c\u8282\u70b9\u9891\u7e41\u91cd\u542f\uff0c\u5e76\u4e14\u4e0d\u662f\u7531 Kubernetes \u7ec4\u4ef6\u5f15\u8d77\u7684\uff0c\u5219\u53ef\u80fd\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u6216\u8005\u786c\u4ef6\u95ee\u9898\u76f8\u5173\u3002</p> <ul> <li> <p>\u5185\u5b58\u4e0d\u8db3\uff08OOM\uff09\uff1a</p> </li> <li> <p>\u5982\u679c\u8282\u70b9\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u6216 Pod \u5360\u7528\u4e86\u592a\u591a\u5185\u5b58\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u7cfb\u7edf OOM\uff08\u5185\u5b58\u4e0d\u8db3\uff09\u5e76\u91cd\u542f\u3002</p> </li> <li> <p>\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u68c0\u67e5\u662f\u5426\u6709 OOM \u76f8\u5173\u7684\u65e5\u5fd7\uff1a</p> <p><code>bash dmesg | grep -i oom</code> - \u78c1\u76d8\u95ee\u9898\uff1a</p> </li> <li> <p>\u68c0\u67e5\u78c1\u76d8\u4f7f\u7528\u60c5\u51b5\uff0c\u786e\u4fdd\u6ca1\u6709\u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3\u7684\u95ee\u9898\uff1a</p> <p><code>bash df -h</code>   - \u78c1\u76d8 I/O \u95ee\u9898\u4e5f\u53ef\u80fd\u5bfc\u81f4\u8282\u70b9\u91cd\u542f\u3002 - \u786c\u4ef6\u95ee\u9898\uff1a</p> </li> <li> <p>\u5982\u679c\u662f\u7269\u7406\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u68c0\u67e5\u786c\u4ef6\u76d1\u63a7\u5de5\u5177\uff08\u4f8b\u5982 Dell iDRAC \u6216 HP iLO\uff09\u67e5\u770b\u786c\u4ef6\u662f\u5426\u51fa\u73b0\u6545\u969c\u3002</p> </li> <li>\u5982\u679c\u662f\u4e91\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u8054\u7cfb\u4e91\u4f9b\u5e94\u5546\u68c0\u67e5\u5e95\u5c42\u786c\u4ef6\u72b6\u6001\u3002</li> </ul>"},{"location":"devops/K8s_6.html#5-kubernetes","title":"5. \u68c0\u67e5 Kubernetes \u4e8b\u4ef6","text":"<p>Kubernetes \u4e8b\u4ef6\u4e2d\u4f1a\u8bb0\u5f55\u96c6\u7fa4\u548c\u8282\u70b9\u76f8\u5173\u7684\u72b6\u6001\u548c\u8b66\u544a\u4fe1\u606f\uff0c\u8fd9\u53ef\u4ee5\u5e2e\u52a9\u5206\u6790\u8282\u70b9\u9891\u7e41\u91cd\u542f\u7684\u539f\u56e0\u3002</p> <ul> <li>\u67e5\u770b\u8282\u70b9\u4e8b\u4ef6\uff1a</li> </ul> <p><code>bash   kubectl describe node &lt;node-name&gt;</code></p> <ul> <li>\u901a\u8fc7 <code>kubectl describe</code> \u53ef\u4ee5\u770b\u5230\u4e0e\u8be5\u8282\u70b9\u76f8\u5173\u7684\u4e8b\u4ef6\u65e5\u5fd7\uff0c\u5176\u4e2d\u53ef\u80fd\u5305\u542b\u8282\u70b9\u91cd\u542f\u7684\u539f\u56e0\uff08\u4f8b\u5982\u5185\u5b58\u4e0d\u8db3\u3001\u78c1\u76d8\u538b\u529b\u7b49\uff09\u3002</li> </ul>"},{"location":"devops/K8s_6.html#6","title":"6. \u68c0\u67e5\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5","text":"<p>\u53ef\u4ee5\u4f7f\u7528\u76d1\u63a7\u5de5\u5177\uff08\u4f8b\u5982 Prometheus \u548c Grafana\uff09\u6765\u76d1\u63a7\u8282\u70b9\u7684 CPU\u3001\u5185\u5b58\u548c\u78c1\u76d8\u4f7f\u7528\u60c5\u51b5\uff0c\u5e2e\u52a9\u786e\u5b9a\u8282\u70b9\u662f\u5426\u56e0\u4e3a\u8d44\u6e90\u8017\u5c3d\u800c\u91cd\u542f\u3002</p> <ul> <li>\u4f7f\u7528 <code>top</code> \u67e5\u770b\u8d44\u6e90\u4f7f\u7528\uff1a</li> </ul> <p><code>bash   top</code> - \u4f7f\u7528 <code>kubectl top</code> \u67e5\u770b\u8282\u70b9\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\uff1a</p> <p><code>bash   kubectl top nodes   kubectl top pods --namespace=&lt;namespace&gt;</code></p>"},{"location":"devops/K8s_6.html#7","title":"7. \u6700\u540e\u63aa\u65bd\uff1a\u9694\u79bb\u8282\u70b9","text":"<p>\u5982\u679c\u95ee\u9898\u4e00\u76f4\u65e0\u6cd5\u89e3\u51b3\uff0c\u53ef\u4ee5\u5c06\u95ee\u9898\u8282\u70b9\u4ece\u96c6\u7fa4\u4e2d\u9694\u79bb\u51fa\u6765\uff0c\u505c\u6b62\u8c03\u5ea6\u65b0\u7684 Pod \u5230\u8be5\u8282\u70b9\uff0c\u76f4\u5230\u95ee\u9898\u5f7b\u5e95\u6392\u67e5\u5b8c\u6210\u3002</p> <ul> <li>\u9694\u79bb\u8282\u70b9\uff1a</li> </ul> <p><code>bash   kubectl cordon &lt;node-name&gt;</code></p> <ul> <li>\u901a\u8fc7 <code>cordon</code> \u547d\u4ee4\u53ef\u4ee5\u5c06\u8282\u70b9\u6807\u8bb0\u4e3a\u4e0d\u53ef\u8c03\u5ea6\u3002</li> <li>\u5982\u679c\u9700\u8981\u8fc1\u79fb Pod\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>kubectl drain</code> \u547d\u4ee4\u5c06 Pod \u8fc1\u79fb\u5230\u5176\u4ed6\u8282\u70b9\u3002</li> </ul>"},{"location":"devops/K8s_6.html#_3","title":"\u603b\u7ed3","text":"<ol> <li>\u68c0\u67e5\u8282\u70b9\u65e5\u5fd7\uff1a\u901a\u8fc7 <code>journalctl</code> \u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\u3001Docker/Containerd \u65e5\u5fd7\u548c <code>kubelet</code> \u65e5\u5fd7\uff0c\u4ee5\u786e\u5b9a\u95ee\u9898\u7684\u6839\u672c\u539f\u56e0\u3002</li> <li>\u5206\u6790 <code>kubelet</code> \u548c <code>kube-proxy</code> \u72b6\u6001\uff1a\u786e\u4fdd\u8fd9\u4e9b\u6838\u5fc3\u7ec4\u4ef6\u6b63\u5e38\u8fd0\u884c\u3002</li> <li>\u8bca\u65ad\u64cd\u4f5c\u7cfb\u7edf\u548c\u786c\u4ef6\u95ee\u9898\uff1a\u68c0\u67e5\u5185\u5b58\u3001\u78c1\u76d8\u548c\u786c\u4ef6\u6545\u969c\u3002</li> <li>\u67e5\u770b Kubernetes \u4e8b\u4ef6\uff1a\u901a\u8fc7 <code>kubectl describe node</code> \u67e5\u770b\u4e0e\u8282\u70b9\u76f8\u5173\u7684\u4e8b\u4ef6\u3002</li> <li>\u76d1\u63a7\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\uff1a\u5229\u7528\u76d1\u63a7\u5de5\u5177\u548c <code>kubectl top</code> \u786e\u8ba4\u662f\u5426\u56e0\u8d44\u6e90\u95ee\u9898\u5bfc\u81f4\u8282\u70b9\u91cd\u542f\u3002</li> <li>\u9694\u79bb\u8282\u70b9\uff1a\u5fc5\u8981\u65f6\uff0c\u5c06\u8282\u70b9\u4ece\u96c6\u7fa4\u4e2d\u9694\u79bb\uff0c\u907f\u514d\u5f71\u54cd\u6574\u4e2a\u96c6\u7fa4\u7684\u7a33\u5b9a\u6027\u3002 </li> </ol>"},{"location":"devops/K8s_7.html","title":"Kubernetes \u7684\u76ee\u5f55\u7ed3\u6784","text":""},{"location":"devops/K8s_7.html#master","title":"Master\u8282\u70b9","text":"<p>\u5728 Kubernetes \u96c6\u7fa4\u4e2d\uff0c<code>master</code> \u8282\u70b9\uff08\u5373\u63a7\u5236\u5e73\u9762\uff09\u662f\u8d1f\u8d23\u96c6\u7fa4\u7ba1\u7406\u7684\u6838\u5fc3\u3002\u63a7\u5236\u5e73\u9762\u901a\u5e38\u5305\u62ec\u4e00\u4e9b\u5173\u952e\u7ec4\u4ef6\uff0c\u5982 <code>kube-apiserver</code>\u3001<code>kube-scheduler</code>\u3001<code>kube-controller-manager</code>\u3001<code>etcd</code> \u7b49\u3002Kubernetes \u7684\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u548c\u6570\u636e\u6587\u4ef6\u5728 master \u8282\u70b9\u4e0a\u5206\u5e03\u5728\u4e0d\u540c\u7684\u76ee\u5f55\u4e2d\uff0c\u4e0b\u9762\u8be6\u7ec6\u4ecb\u7ecd\u8fd9\u4e9b\u76ee\u5f55\u7ed3\u6784\u548c\u914d\u7f6e\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002</p> <p>Kubernetes Master \u8282\u70b9\u4e0a\u7684\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u548c\u76ee\u5f55\u53ef\u4ee5\u6982\u62ec\u5982\u4e0b\uff1a</p> <ul> <li>\u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\u7684\u9759\u6001 Pod \u914d\u7f6e\uff1a<code>/etc/kubernetes/manifests/</code></li> <li>\u8bc1\u4e66\u4e0e\u5bc6\u94a5\uff1a<code>/etc/kubernetes/pki/</code></li> <li>\u96c6\u7fa4\u8bbf\u95ee\u914d\u7f6e\uff1a<code>/etc/kubernetes/admin.conf</code></li> <li>kubelet \u670d\u52a1\u914d\u7f6e\uff1a<code>/etc/systemd/system/kubelet.service.d/</code></li> <li>etcd \u6570\u636e\u5b58\u50a8\uff1a<code>/var/lib/etcd/</code></li> <li>CNI \u63d2\u4ef6\u914d\u7f6e\uff1a<code>/etc/cni/net.d/</code> \u548c <code>/opt/cni/bin/</code></li> <li>\u65e5\u5fd7\u6587\u4ef6\uff1a<code>/var/log/</code></li> </ul>"},{"location":"devops/K8s_7.html#kubernetes-master","title":"\u4e00\u3001Kubernetes Master \u8282\u70b9\u4e0a\u7684\u4e3b\u8981\u76ee\u5f55\u7ed3\u6784","text":"<ol> <li> <p><code>/etc/kubernetes</code>\uff1a</p> </li> <li> <p><code>/etc/kubernetes/manifests</code>\uff1a\u5b58\u653e Kubernetes \u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\u7684\u9759\u6001 Pod \u914d\u7f6e\u6587\u4ef6\u3002\u4f8b\u5982\uff0c<code>kube-apiserver.yaml</code>\u3001<code>kube-scheduler.yaml</code>\u3001<code>kube-controller-manager.yaml</code> \u7b49\u3002\u901a\u8fc7\u9759\u6001 Pod \u65b9\u5f0f\u6765\u542f\u52a8\u548c\u7ba1\u7406\u8fd9\u4e9b\u7ec4\u4ef6\u3002</p> </li> <li><code>/etc/kubernetes/pki</code>\uff1a\u5b58\u653e Kubernetes \u96c6\u7fa4\u4e2d\u4f7f\u7528\u7684\u8bc1\u4e66\u548c\u5bc6\u94a5\u6587\u4ef6\uff0c\u5305\u62ec API \u670d\u52a1\u5668\u3001etcd \u7b49\u7ec4\u4ef6\u7684 CA \u8bc1\u4e66\u548c\u5176\u4ed6\u5bc6\u94a5\u3002</li> <li><code>/etc/kubernetes/admin.conf</code>\uff1a\u96c6\u7fa4\u7684\u7ba1\u7406\u5458\u914d\u7f6e\u6587\u4ef6\uff0c\u7528\u4e8e <code>kubectl</code> \u547d\u4ee4\u4e0e\u96c6\u7fa4\u4ea4\u4e92\u3002\u5176\u4ed6\u8282\u70b9\u4e5f\u53ef\u80fd\u6709\u7c7b\u4f3c\u7684 <code>kubelet.conf</code>\u3001<code>controller-manager.conf</code>\u3001<code>scheduler.conf</code> \u7b49\u914d\u7f6e\u6587\u4ef6\u3002</li> <li> <p><code>/var/lib/kubelet</code>\uff1a</p> </li> <li> <p>\u5b58\u653e kubelet \u7ec4\u4ef6\u7684\u914d\u7f6e\u548c\u6570\u636e\u3002kubelet \u662f\u8d1f\u8d23\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u7ba1\u7406 Pod \u7684\u6838\u5fc3\u7ec4\u4ef6\u3002</p> </li> <li> <p><code>/var/lib/etcd</code>\uff1a</p> </li> <li> <p>etcd \u662f Kubernetes \u7684\u6570\u636e\u5b58\u50a8\u7ec4\u4ef6\uff0c\u7528\u4e8e\u5b58\u50a8\u96c6\u7fa4\u7684\u72b6\u6001\u548c\u914d\u7f6e\u4fe1\u606f\u3002\u8be5\u76ee\u5f55\u5b58\u653e etcd \u7684\u6570\u636e\u6587\u4ef6\uff0c\u662f\u6574\u4e2a\u96c6\u7fa4\u7684\u6838\u5fc3\u6570\u636e\u5b58\u50a8\u3002</p> </li> <li> <p><code>/etc/systemd/system/kubelet.service.d</code>\uff1a</p> </li> <li> <p>\u7528\u4e8e\u5b58\u653e <code>kubelet</code> \u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u901a\u5e38\u5728\u8fd9\u91cc\u627e\u5230\u4e00\u4e2a <code>10-kubeadm.conf</code> \u6587\u4ef6\uff0c\u7528\u4e8e\u8bbe\u7f6e kubelet \u542f\u52a8\u65f6\u7684\u53c2\u6570\uff0c\u4f8b\u5982 API \u670d\u52a1\u5668\u5730\u5740\u7b49\u3002</p> </li> <li> <p><code>/opt/cni/bin</code> \u548c <code>/etc/cni/net.d</code>**\uff1a</p> </li> <li> <p><code>/opt/cni/bin</code>\uff1a\u5b58\u653e\u7f51\u7edc\u63d2\u4ef6\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5982 Flannel\u3001Calico\u3001Weave \u7b49\u3002</p> </li> <li><code>/etc/cni/net.d</code>\uff1a\u5b58\u653e\u7f51\u7edc\u63d2\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4f8b\u5982 <code>10-flannel.conflist</code> \u6216 <code>calico.conflist</code>\u3002</li> <li> <p><code>/var/log</code>\uff1a</p> </li> <li> <p>\u8be5\u76ee\u5f55\u4e2d\u5b58\u653e\u4e86\u5404\u4e2a\u7ec4\u4ef6\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u4f8b\u5982 kubelet\u3001kube-apiserver\u3001kube-controller-manager\u3001etcd \u7684\u65e5\u5fd7\u3002\u5177\u4f53\u65e5\u5fd7\u6587\u4ef6\u89c6\u5177\u4f53\u7684\u7cfb\u7edf\u914d\u7f6e\u800c\u5b9a\uff0c\u901a\u5e38\u65e5\u5fd7\u88ab\u5b58\u50a8\u5728 <code>/var/log</code> \u4e0b\uff0c\u6216\u8005\u901a\u8fc7 systemd journal \u7ba1\u7406\u3002</p> </li> </ol>"},{"location":"devops/K8s_7.html#master_1","title":"\u4e8c\u3001Master \u8282\u70b9\u4e0a\u7684\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u4f4d\u7f6e\u53ca\u4f5c\u7528","text":"<ol> <li> <p>\u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\u7684\u9759\u6001 Pod \u914d\u7f6e\u6587\u4ef6\uff1a</p> </li> <li> <p>\u8def\u5f84\uff1a<code>/etc/kubernetes/manifests/</code></p> </li> <li>\u6587\u4ef6\uff1a<ul> <li><code>kube-apiserver.yaml</code>\uff1aAPI \u670d\u52a1\u5668\u7684\u9759\u6001 Pod \u914d\u7f6e\u6587\u4ef6\u3002</li> <li><code>kube-scheduler.yaml</code>\uff1a\u8c03\u5ea6\u5668\u7684\u9759\u6001 Pod \u914d\u7f6e\u6587\u4ef6\u3002</li> <li><code>kube-controller-manager.yaml</code>\uff1a\u63a7\u5236\u5668\u7ba1\u7406\u5668\u7684\u9759\u6001 Pod \u914d\u7f6e\u6587\u4ef6\u3002</li> <li><code>etcd.yaml</code>\uff1aetcd \u6570\u636e\u5e93\u7684\u9759\u6001 Pod \u914d\u7f6e\u6587\u4ef6\u3002</li> </ul> </li> <li> <p>Kubernetes \u8bc1\u4e66\u4e0e\u5bc6\u94a5\uff1a</p> </li> <li> <p>\u8def\u5f84\uff1a<code>/etc/kubernetes/pki/</code></p> </li> <li>\u6587\u4ef6\uff1a<ul> <li><code>ca.crt</code> \u548c <code>ca.key</code>\uff1aCA \u8bc1\u4e66\u548c\u5bc6\u94a5\u3002</li> <li><code>apiserver.crt</code> \u548c <code>apiserver.key</code>\uff1aAPI \u670d\u52a1\u5668\u7684\u8bc1\u4e66\u548c\u5bc6\u94a5\u3002</li> <li><code>etcd/</code>\uff1aetcd \u7ec4\u4ef6\u7684\u8bc1\u4e66\u548c\u5bc6\u94a5\uff0c\u901a\u5e38\u4f4d\u4e8e <code>pki</code> \u4e0b\u7684\u5b50\u76ee\u5f55 <code>etcd</code> \u4e2d\u3002</li> </ul> </li> <li> <p>\u96c6\u7fa4\u8bbf\u95ee\u914d\u7f6e\u6587\u4ef6\uff1a</p> </li> <li> <p>\u8def\u5f84\uff1a<code>/etc/kubernetes/admin.conf</code></p> </li> <li>\u6587\u4ef6\uff1a<ul> <li><code>admin.conf</code>\uff1a\u96c6\u7fa4\u7ba1\u7406\u5458\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u7528\u4e8e\u901a\u8fc7 <code>kubectl</code> \u547d\u4ee4\u4e0e\u96c6\u7fa4\u901a\u4fe1\u3002\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u5305\u542b API \u670d\u52a1\u5668\u7684\u5730\u5740\u3001\u8bc1\u4e66\u3001\u4ee4\u724c\u7b49\u4fe1\u606f\u3002</li> </ul> </li> <li> <p>kubelet \u670d\u52a1\u914d\u7f6e\uff1a</p> </li> <li> <p>\u8def\u5f84\uff1a<code>/etc/systemd/system/kubelet.service.d/</code></p> </li> <li>\u6587\u4ef6\uff1a<ul> <li><code>10-kubeadm.conf</code>\uff1a\u7528\u4e8e\u914d\u7f6e kubelet \u670d\u52a1\u7684\u542f\u52a8\u53c2\u6570\u3002\u6b64\u914d\u7f6e\u6587\u4ef6\u5305\u62ec\u4e00\u4e9b\u73af\u5883\u53d8\u91cf\u914d\u7f6e\uff0c\u4f8b\u5982 API \u670d\u52a1\u5668\u5730\u5740\u3001\u8bc1\u4e66\u4f4d\u7f6e\u3001\u7f51\u7edc\u53c2\u6570\u7b49\u3002</li> </ul> </li> <li> <p>etcd \u6570\u636e\u5b58\u50a8\uff1a</p> </li> <li> <p>\u8def\u5f84\uff1a<code>/var/lib/etcd/</code></p> </li> <li>\u6587\u4ef6\uff1a<ul> <li>etcd \u7684\u6570\u636e\u6587\u4ef6\u548c\u5feb\u7167\u5b58\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e2d\uff0c\u7528\u4e8e\u5b58\u50a8 Kubernetes \u96c6\u7fa4\u7684\u72b6\u6001\u4fe1\u606f\uff0c\u662f\u6574\u4e2a\u96c6\u7fa4\u6700\u4e3a\u5173\u952e\u7684\u6570\u636e\u5b58\u50a8\u4f4d\u7f6e\u3002</li> </ul> </li> <li> <p>CNI \u63d2\u4ef6\u76f8\u5173\u914d\u7f6e\uff1a</p> </li> <li> <p>\u8def\u5f84\uff1a<code>/etc/cni/net.d/</code> \u548c <code>/opt/cni/bin/</code></p> </li> <li>\u6587\u4ef6\uff1a<ul> <li>\u7f51\u7edc\u63d2\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6\uff08\u4f8b\u5982 flannel\u3001calico\uff09\uff0c\u901a\u5e38\u4ee5 <code>.conf</code> \u6216 <code>.conflist</code> \u7ed3\u5c3e\u3002</li> <li>\u7f51\u7edc\u63d2\u4ef6\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff08\u4f8b\u5982 CNI \u63d2\u4ef6\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff09\u3002</li> </ul> </li> <li> <p>\u65e5\u5fd7\u6587\u4ef6\uff1a</p> </li> <li> <p>\u8def\u5f84\uff1a<code>/var/log/</code></p> </li> <li>\u6587\u4ef6\uff1a<ul> <li><code>kube-apiserver.log</code>\u3001<code>kube-scheduler.log</code>\u3001<code>kube-controller-manager.log</code> \u7b49\uff0c\u5b58\u653e\u4e86\u8fd9\u4e9b\u7ec4\u4ef6\u7684\u8fd0\u884c\u65e5\u5fd7\uff0c\u4fbf\u4e8e\u7ba1\u7406\u5458\u8fdb\u884c\u8c03\u8bd5\u548c\u6545\u969c\u6392\u67e5\u3002</li> </ul> </li> </ol>"},{"location":"devops/K8s_7.html#worker","title":"Worker\u8282\u70b9","text":"<p>\u5728 Kubernetes \u96c6\u7fa4\u4e2d\uff0c<code>worker</code> \u8282\u70b9\uff08\u4e5f\u53eb\u8ba1\u7b97\u8282\u70b9\u6216\u5de5\u4f5c\u8282\u70b9\uff09\u662f\u8d1f\u8d23\u8fd0\u884c\u5bb9\u5668\u5316\u5e94\u7528\u7684\u8282\u70b9\uff0c\u4e3b\u8981\u6258\u7ba1\u5b9e\u9645\u7684 Pod\uff0c\u5e76\u6267\u884c\u63a7\u5236\u5e73\u9762\u4e0b\u53d1\u7684\u4efb\u52a1\u3002Worker \u8282\u70b9\u4e0a\u4e5f\u6709\u8bb8\u591a\u914d\u7f6e\u6587\u4ef6\u548c\u76ee\u5f55\u7ed3\u6784\uff0c\u4e0b\u9762\u6211\u6765\u8be6\u7ec6\u4ecb\u7ecd\u3002</p> <p>\u5728 Kubernetes \u7684 Worker \u8282\u70b9\u4e0a\uff0c\u4e3b\u8981\u7684\u76ee\u5f55\u7ed3\u6784\u548c\u914d\u7f6e\u6587\u4ef6\u5982\u4e0b\uff1a</p> <ul> <li>kubelet \u914d\u7f6e\u6587\u4ef6\uff1a<code>/etc/kubernetes/kubelet.conf</code>\uff0c\u7528\u4e8e kubelet \u4e0e API \u670d\u52a1\u5668\u901a\u4fe1\u3002</li> <li>kubelet \u670d\u52a1\u914d\u7f6e\uff1a<code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code>\uff0c\u7528\u4e8e kubelet \u542f\u52a8\u53c2\u6570\u7684\u914d\u7f6e\u3002</li> <li>\u8bc1\u4e66\u548c\u5bc6\u94a5\u6587\u4ef6\uff1a<code>/etc/kubernetes/pki/</code>\uff0c\u5b58\u653e kubelet \u7684\u8bc1\u4e66\u548c\u5bc6\u94a5\u3002</li> <li>CNI \u63d2\u4ef6\u76f8\u5173\u914d\u7f6e\uff1a<code>/opt/cni/bin/</code> \u548c <code>/etc/cni/net.d/</code>\uff0c\u7528\u4e8e Pod \u7684\u7f51\u7edc\u914d\u7f6e\u3002</li> <li>kubelet \u6570\u636e\u76ee\u5f55\uff1a<code>/var/lib/kubelet</code>\uff0c\u5b58\u653e kubelet \u76f8\u5173\u7684\u8fd0\u884c\u6570\u636e\u3002</li> <li>\u5bb9\u5668\u8fd0\u884c\u65f6\u6570\u636e\u76ee\u5f55\uff1a<code>/var/lib/docker</code>\uff08\u6216 <code>/var/lib/containerd</code>\uff09\uff0c\u5b58\u653e\u5bb9\u5668\u955c\u50cf\u548c\u8fd0\u884c\u6570\u636e\u3002</li> <li>\u65e5\u5fd7\u6587\u4ef6\uff1a<code>/var/log/kubelet.log</code> \u548c <code>/var/log/containers/</code>\uff0c\u7528\u4e8e\u8bb0\u5f55\u8282\u70b9\u548c Pod \u7684\u8fd0\u884c\u65e5\u5fd7\u3002</li> </ul>"},{"location":"devops/K8s_7.html#worker_1","title":"\u4e00\u3001Worker \u8282\u70b9\u7684\u4e3b\u8981\u76ee\u5f55\u7ed3\u6784","text":"<ol> <li> <p><code>/etc/kubernetes</code>\uff1a</p> </li> <li> <p><code>/etc/kubernetes/kubelet.conf</code>\uff1akubelet \u914d\u7f6e\u6587\u4ef6\uff0cworker \u8282\u70b9\u7684 kubelet \u4f7f\u7528\u8be5\u6587\u4ef6\u4e0e\u96c6\u7fa4 API \u670d\u52a1\u5668\u901a\u4fe1\u3002</p> </li> <li><code>/etc/kubernetes/pki</code>\uff1a\u5b58\u653e\u7528\u4e8e kubelet \u4e0e API \u670d\u52a1\u5668\u901a\u4fe1\u7684\u8bc1\u4e66\u548c\u5bc6\u94a5\uff0c\u4f8b\u5982 kubelet \u7684 CA \u8bc1\u4e66\u3002</li> <li> <p><code>/var/lib/kubelet</code>\uff1a</p> </li> <li> <p>kubelet \u662f worker \u8282\u70b9\u7684\u6838\u5fc3\u7ec4\u4ef6\u4e4b\u4e00\uff0c\u8d1f\u8d23\u7ba1\u7406\u8282\u70b9\u4e0a\u7684\u5bb9\u5668\u3002\u8be5\u76ee\u5f55\u5305\u542b kubelet \u7684\u6570\u636e\u3001\u914d\u7f6e\u548c\u7ba1\u7406 Pod \u6240\u9700\u7684\u72b6\u6001\u6587\u4ef6\u3002</p> </li> <li><code>/var/lib/kubelet/pods</code>\uff1a\u5b58\u50a8\u4e0e\u8282\u70b9\u4e0a\u8fd0\u884c\u7684 Pod \u76f8\u5173\u7684\u6570\u636e\uff0c\u5305\u62ec Pod \u7684\u914d\u7f6e\u4fe1\u606f\u3001\u8fd0\u884c\u72b6\u6001\u548c\u4e34\u65f6\u6570\u636e\u3002</li> <li> <p><code>/etc/systemd/system/kubelet.service.d</code>\uff1a</p> </li> <li> <p><code>10-kubeadm.conf</code>\uff1a\u7528\u4e8e\u914d\u7f6e kubelet \u7684\u542f\u52a8\u53c2\u6570\u548c\u4e00\u4e9b\u91cd\u8981\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5982 API \u670d\u52a1\u5668\u5730\u5740\u3001\u8bc1\u4e66\u8def\u5f84\u7b49\u3002</p> </li> <li> <p><code>/opt/cni/bin</code> \u548c <code>/etc/cni/net.d</code>\uff1a</p> </li> <li> <p><code>/opt/cni/bin</code>\uff1a\u5b58\u653e CNI \u7f51\u7edc\u63d2\u4ef6\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4f8b\u5982 Flannel\u3001Calico\u3001Weave \u7b49\u63d2\u4ef6\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002</p> </li> <li><code>/etc/cni/net.d</code>\uff1a\u5b58\u653e CNI \u7f51\u7edc\u63d2\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u7528\u4e8e\u5b9a\u4e49\u8282\u70b9\u4e0a Pod \u7684\u7f51\u7edc\u8fde\u63a5\u65b9\u5f0f\uff0c\u4f8b\u5982 <code>10-flannel.conflist</code> \u6216 <code>calico.conflist</code>\u3002</li> <li> <p><code>/var/lib/docker</code>\uff08\u6216\u5176\u4ed6\u5bb9\u5668\u8fd0\u884c\u65f6\u76ee\u5f55\uff0c\u5982 containerd\uff09\uff1a</p> </li> <li> <p>\u5b58\u653e Docker \u5bb9\u5668\uff08\u6216\u5176\u4ed6\u5bb9\u5668\u8fd0\u884c\u65f6\uff09\u76f8\u5173\u7684\u6570\u636e\uff0c\u5305\u62ec\u5bb9\u5668\u955c\u50cf\u3001\u5bb9\u5668\u914d\u7f6e\u7b49\u3002</p> </li> <li>\u5982\u679c\u4f7f\u7528 <code>containerd</code>\uff0c\u5219\u76ee\u5f55\u4e3a <code>/var/lib/containerd</code>\u3002</li> <li> <p><code>/var/log</code>\uff1a</p> </li> <li> <p><code>/var/log/kubelet.log</code>\uff1a\u8bb0\u5f55 kubelet \u7ec4\u4ef6\u7684\u8fd0\u884c\u65e5\u5fd7\u4fe1\u606f\uff0c\u4fbf\u4e8e\u7ba1\u7406\u5458\u6392\u67e5\u8282\u70b9\u4e0a\u7684\u95ee\u9898\u3002</p> </li> <li><code>/var/log/containers/</code>\uff1a\u5b58\u653e\u8fd0\u884c\u4e2d\u7684\u5bb9\u5668\u65e5\u5fd7\uff0c\u6bcf\u4e2a\u5bb9\u5668\u90fd\u4f1a\u6709\u4e00\u4e2a\u76f8\u5e94\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u4fbf\u4e8e\u8ffd\u8e2a\u5e94\u7528\u7684\u8fd0\u884c\u72b6\u6001\u548c\u6392\u67e5\u95ee\u9898\u3002</li> </ol>"},{"location":"devops/K8s_7.html#worker_2","title":"\u4e8c\u3001Worker \u8282\u70b9\u7684\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u4f4d\u7f6e\u53ca\u4f5c\u7528","text":"<ol> <li> <p>kubelet \u914d\u7f6e\u6587\u4ef6\uff1a</p> </li> <li> <p>\u8def\u5f84\uff1a<code>/etc/kubernetes/kubelet.conf</code></p> </li> <li>\u4f5c\u7528\uff1a<ul> <li>\u8be5\u6587\u4ef6\u662f worker \u8282\u70b9\u4e0a kubelet \u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u7528\u4e8e\u4e0e Kubernetes API \u670d\u52a1\u5668\u901a\u4fe1\u3002\u5b83\u5305\u542b\u4e86\u96c6\u7fa4\u7684 API \u670d\u52a1\u5668\u5730\u5740\u3001\u8ba4\u8bc1\u8bc1\u4e66\u548c\u6388\u6743\u4fe1\u606f\u7b49\u3002</li> </ul> </li> <li> <p>kubelet \u670d\u52a1\u914d\u7f6e\uff1a</p> </li> <li> <p>\u8def\u5f84\uff1a<code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code></p> </li> <li>\u4f5c\u7528\uff1a<ul> <li>\u7528\u4e8e\u8bbe\u7f6e kubelet \u7684\u542f\u52a8\u53c2\u6570\u3002\u5305\u62ec\u4e86 kubelet \u542f\u52a8\u65f6\u9700\u8981\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5982 <code>KUBELET_KUBECONFIG_ARGS</code>\uff08kubelet \u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff09\u3001<code>KUBELET_CERTIFICATE_ARGS</code>\uff08\u8bc1\u4e66\u8def\u5f84\uff09\u7b49\u3002</li> </ul> </li> <li> <p>\u8bc1\u4e66\u548c\u5bc6\u94a5\u6587\u4ef6\uff1a</p> </li> <li> <p>\u8def\u5f84\uff1a<code>/etc/kubernetes/pki</code></p> </li> <li>\u4f5c\u7528\uff1a<ul> <li>\u5b58\u653e\u7528\u4e8e\u8eab\u4efd\u8ba4\u8bc1\u7684\u8bc1\u4e66\u548c\u5bc6\u94a5\uff0c\u5982 kubelet \u7684 CA \u8bc1\u4e66\uff08<code>ca.crt</code>\uff09\uff0c\u7528\u4e8e\u4fdd\u8bc1 kubelet \u4e0e API \u670d\u52a1\u5668\u4e4b\u95f4\u901a\u4fe1\u7684\u5b89\u5168\u6027\u3002</li> </ul> </li> <li> <p>CNI \u63d2\u4ef6\u76f8\u5173\u914d\u7f6e\uff1a</p> </li> <li> <p>\u8def\u5f84\uff1a</p> <ul> <li><code>/opt/cni/bin</code>\uff1a\u5b58\u653e CNI \u7f51\u7edc\u63d2\u4ef6\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002</li> <li><code>/etc/cni/net.d/</code>\uff1a\u5b58\u653e\u7f51\u7edc\u63d2\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u7528\u4e8e\u5b9a\u4e49 Pod \u7684\u7f51\u7edc\u914d\u7f6e\u3002</li> </ul> </li> <li>\u4f5c\u7528\uff1a<ul> <li>CNI \u63d2\u4ef6\u8d1f\u8d23\u4e3a Pod \u914d\u7f6e\u7f51\u7edc\uff0c\u4f7f\u5f97\u96c6\u7fa4\u5185\u7684 Pod \u53ef\u4ee5\u76f8\u4e92\u901a\u4fe1\u3002</li> </ul> </li> <li> <p>kubelet \u6570\u636e\u76ee\u5f55\uff1a</p> </li> <li> <p>\u8def\u5f84\uff1a<code>/var/lib/kubelet</code></p> </li> <li>\u4f5c\u7528\uff1a<ul> <li>kubelet \u4f7f\u7528\u8be5\u76ee\u5f55\u6765\u5b58\u50a8\u8fd0\u884c\u4e2d\u7684 Pod \u7684\u4fe1\u606f\uff0c\u5305\u62ec\u6bcf\u4e2a Pod \u7684\u72b6\u6001\u3001\u6302\u8f7d\u7684\u5377\u3001\u7f51\u7edc\u4fe1\u606f\u7b49\u3002</li> </ul> </li> <li> <p>\u5bb9\u5668\u8fd0\u884c\u65f6\u6570\u636e\u76ee\u5f55\uff1a</p> </li> <li> <p>\u8def\u5f84\uff1a<code>/var/lib/docker</code> \u6216 <code>/var/lib/containerd</code></p> </li> <li>\u4f5c\u7528\uff1a<ul> <li>\u5982\u679c\u4f7f\u7528 Docker \u4f5c\u4e3a\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u5219 <code>/var/lib/docker</code> \u4f1a\u5305\u542b\u6240\u6709\u5bb9\u5668\u955c\u50cf\u3001\u5bb9\u5668\u5b9e\u4f8b\u7684\u5b58\u50a8\u4fe1\u606f\u3002</li> <li>\u5982\u679c\u4f7f\u7528 <code>containerd</code> \u4f5c\u4e3a\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u5219\u76f8\u5173\u6570\u636e\u5b58\u653e\u5728 <code>/var/lib/containerd</code> \u76ee\u5f55\u4e2d\u3002</li> </ul> </li> <li> <p>\u65e5\u5fd7\u6587\u4ef6\uff1a</p> </li> <li> <p>\u8def\u5f84\uff1a</p> <ul> <li><code>/var/log/kubelet.log</code>\uff1akubelet \u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u8bb0\u5f55 kubelet \u5728\u8282\u70b9\u4e0a\u8fd0\u884c\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</li> <li><code>/var/log/containers/</code>\uff1a\u6bcf\u4e2a Pod \u5bb9\u5668\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u65b9\u4fbf\u8c03\u8bd5\u548c\u8ddf\u8e2a\u5e94\u7528\u7684\u8fd0\u884c\u72b6\u6001\u3002</li> </ul> </li> <li>\u4f5c\u7528\uff1a<ul> <li>\u65e5\u5fd7\u6587\u4ef6\u5bf9\u6392\u67e5\u8282\u70b9\u4e0a\u7684\u95ee\u9898\u548c\u5e94\u7528\u8fd0\u884c\u65f6\u7684\u95ee\u9898\u975e\u5e38\u6709\u7528\u3002\u7ba1\u7406\u5458\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e9b\u65e5\u5fd7\u4e86\u89e3 Pod \u7684\u8fd0\u884c\u60c5\u51b5\u548c\u8282\u70b9\u7684\u72b6\u6001\u3002</li> </ul> </li> </ol>"},{"location":"devops/K8s_8.html","title":"K8s \u76f8\u5173\u95ee\u9898\u96c6\u9526\uff08\u4e09\uff09","text":""},{"location":"devops/K8s_8.html#6","title":"6. \u5b89\u5168\u6027\u7c7b\uff1a","text":"<ul> <li>Kubernetes \u4e2d\u5982\u4f55\u7ba1\u7406\u8bbf\u95ee\u63a7\u5236\uff1f</li> <li>\u901a\u8fc7 RBAC\uff08Role-Based Access Control\uff09\u7ba1\u7406\u7528\u6237\u548c\u670d\u52a1\u8d26\u6237\u7684\u6743\u9650\uff0c\u63cf\u8ff0 Role\u3001ClusterRole\u3001RoleBinding\u3001ClusterRoleBinding \u7684\u4f5c\u7528\u3002</li> <li>PodSecurityPolicy \u662f\u4ec0\u4e48\uff1f</li> <li>PodSecurityPolicy \u7528\u4e8e\u5b9a\u4e49\u548c\u63a7\u5236 Pod \u7684\u5b89\u5168\u7b56\u7565\uff0c\u6bd4\u5982\u662f\u5426\u5141\u8bb8\u7279\u6743\u5bb9\u5668\u3001\u6302\u8f7d\u5377\u7684\u7c7b\u578b\u7b49\u3002</li> <li>\u5982\u4f55\u4e3a Kubernetes \u96c6\u7fa4\u542f\u7528 HTTPS\uff1f</li> <li>\u8ba8\u8bba\u4f7f\u7528\u8bc1\u4e66\u7ba1\u7406\u5de5\u5177\uff08\u5982 cert-manager\uff09\u548c\u914d\u7f6e API Server \u7684\u5b89\u5168\u8fde\u63a5\u3002</li> </ul>"},{"location":"devops/K8s_8.html#7","title":"7. \u8fd0\u7ef4\u4e0e\u6545\u969c\u6392\u67e5\u7c7b\uff1a","text":"<ul> <li>\u5982\u4f55\u67e5\u770b Kubernetes \u96c6\u7fa4\u7684\u5065\u5eb7\u72b6\u6001\uff1f</li> <li>\u4f7f\u7528 <code>kubectl get nodes</code> \u67e5\u770b\u8282\u70b9\u72b6\u6001\uff0c\u4f7f\u7528 <code>kubectl describe node</code> \u4e86\u89e3\u8282\u70b9\u8be6\u7ec6\u4fe1\u606f\u3002</li> <li>\u5982\u4f55\u8c03\u8bd5\u4e00\u4e2a\u65e0\u6cd5\u8bbf\u95ee\u7684 Service\uff1f</li> <li>\u53ef\u80fd\u9700\u8981\u68c0\u67e5 Service\u3001Endpoint\u3001Pod \u72b6\u6001\uff0c\u9a8c\u8bc1\u7f51\u7edc\u7b56\u7565\uff0c\u4f7f\u7528 <code>kubectl exec</code> \u8fdb\u5165\u5bb9\u5668\u8fdb\u884c\u7f51\u7edc\u6d4b\u8bd5\u3002</li> <li>\u5982\u4f55\u5907\u4efd\u548c\u6062\u590d etcd \u6570\u636e\uff1f</li> <li>\u4f7f\u7528 <code>etcdctl</code> \u5de5\u5177\u8fdb\u884c\u5907\u4efd\u548c\u6062\u590d\uff0c\u786e\u4fdd\u6570\u636e\u5b89\u5168\u3002</li> <li>\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u8d44\u6e90\u7d27\u5f20\u65f6\u5e94\u8be5\u600e\u4e48\u505a\uff1f</li> <li>\u8003\u8651\u8282\u70b9\u6269\u5c55\u3001Pod \u8d44\u6e90\u914d\u989d\u7ba1\u7406\uff08\u5982 requests \u548c limits \u7684\u8bbe\u7f6e\uff09\uff0c\u6216\u8005\u4f7f\u7528 Node Affinity \u548c Taints/Tolerations \u8c03\u6574\u8c03\u5ea6\u7b56\u7565\u3002</li> </ul>"},{"location":"devops/K8s_8.html#8","title":"8. \u5b9e\u9645\u573a\u666f\u7c7b\u95ee\u9898\uff1a","text":"<ul> <li>\u5982\u679c\u4e00\u4e2a Pod \u9700\u8981\u8bbf\u95ee\u53e6\u4e00\u4e2a Pod\uff0c\u5e94\u8be5\u600e\u4e48\u505a\uff1f</li> <li>\u4f7f\u7528 Kubernetes Service \u521b\u5efa\u7a33\u5b9a\u7684\u8bbf\u95ee\u5165\u53e3\uff0c\u6216\u8005\u914d\u7f6e Ingress \u89c4\u5219\u3002</li> <li>\u5982\u4f55\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u4fdd\u8bc1 Kubernetes \u5e94\u7528\u7684\u9ad8\u53ef\u7528\u6027\u548c\u7a33\u5b9a\u6027\uff1f</li> <li>\u8ba8\u8bba\u6eda\u52a8\u66f4\u65b0\u7b56\u7565\u3001\u5065\u5eb7\u68c0\u67e5\uff08Liveness \u548c Readiness Probe\uff09\u3001\u65e5\u5fd7\u76d1\u63a7\u548c\u81ea\u52a8\u6269\u5c55\u3002</li> <li>\u5982\u4f55\u5904\u7406\u96c6\u7fa4\u4e2d\u67d0\u4e2a\u8282\u70b9\u9891\u7e41\u91cd\u542f\u7684\u95ee\u9898\uff1f</li> <li>\u9700\u8981\u68c0\u67e5\u8282\u70b9\u65e5\u5fd7\u3001\u5206\u6790 kubelet \u548c kube-proxy \u7684\u8fd0\u884c\u72b6\u6001\uff0c\u53ef\u80fd\u9700\u8981\u8bca\u65ad\u64cd\u4f5c\u7cfb\u7edf\u548c\u786c\u4ef6\u95ee\u9898\u3002</li> </ul> <p>\u8fd9\u4e9b\u95ee\u9898\u6db5\u76d6\u4e86 Kubernetes \u7684\u6838\u5fc3\u6982\u5ff5\u3001\u5b9e\u6218\u64cd\u4f5c\u548c\u8fd0\u7ef4\u7ba1\u7406\uff0c\u5e2e\u52a9\u9762\u8bd5\u8005\u4e86\u89e3\u5019\u9009\u4eba\u662f\u5426\u5177\u5907\u4f7f\u7528 Kubernetes \u8fdb\u884c\u751f\u4ea7\u73af\u5883\u8fd0\u7ef4\u7684\u80fd\u529b\u3002\u5728\u51c6\u5907\u9762\u8bd5\u65f6\uff0c\u9664\u4e86\u7406\u89e3\u7406\u8bba\u77e5\u8bc6\uff0c\u4e5f\u53ef\u4ee5\u5728\u672c\u5730\u73af\u5883\u6216\u4e91\u4e0a\u5b9e\u9645\u90e8\u7f72 Kubernetes \u8fdb\u884c\u64cd\u4f5c\u5b9e\u8df5\uff0c\u4ee5\u66f4\u597d\u5730\u5e94\u5bf9\u9762\u8bd5\u4e2d\u53ef\u80fd\u51fa\u73b0\u7684\u5b9e\u64cd\u95ee\u9898\u3002</p>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html","title":"Windows \u57df\u63a7\u670d\u52a1\u5668\u90e8\u7f72\u4e0e\u914d\u7f6e","text":"<p>\u9002\u7528\u8bfb\u8005\uff1a\u4f01\u4e1a IT \u7ba1\u7406\u5458\u3001\u7cfb\u7edf\u5de5\u7a0b\u5e08 \u76ee\u6807\uff1a\u4ece\u96f6\u5f00\u59cb\u90e8\u7f72 Windows Server Active Directory \u57df\u63a7\u5236\u5668\uff0c\u914d\u7f6e\u57df\u7b56\u7565\u3001\u7528\u6237\u7ba1\u7406\u3001\u7ec4\u7ec7\u5355\u5143\u7ed3\u6784\u3002</p>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#1-active-directory","title":"1. Active Directory \u6982\u8ff0","text":""},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#11-active-directory","title":"1.1 \u4ec0\u4e48\u662f Active Directory","text":"<p>Active Directory (AD) \u662f Microsoft \u7684\u76ee\u5f55\u670d\u52a1\uff0c\u7528\u4e8e\uff1a - \u96c6\u4e2d\u7ba1\u7406\uff1a\u7edf\u4e00\u7ba1\u7406\u7528\u6237\u3001\u8ba1\u7b97\u673a\u3001\u7ec4\u3001\u6743\u9650 - \u8eab\u4efd\u8ba4\u8bc1\uff1a\u5355\u70b9\u767b\u5f55\uff08SSO\uff09 - \u7ec4\u7b56\u7565\uff1a\u96c6\u4e2d\u914d\u7f6e\u548c\u7ba1\u7406\u5ba2\u6237\u7aef - \u8d44\u6e90\u8bbf\u95ee\uff1a\u63a7\u5236\u6587\u4ef6\u3001\u6253\u5370\u673a\u3001\u5e94\u7528\u7684\u8bbf\u95ee\u6743\u9650</p>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#12","title":"1.2 \u6838\u5fc3\u6982\u5ff5","text":"\u6982\u5ff5 \u8bf4\u660e \u793a\u4f8b \u57df\uff08Domain\uff09 \u7ba1\u7406\u8fb9\u754c\uff0c\u5171\u4eab\u540c\u4e00\u4e2a AD \u6570\u636e\u5e93 <code>pharma.local</code> \u57df\u63a7\u5236\u5668\uff08DC\uff09 \u8fd0\u884c AD \u670d\u52a1\u7684\u670d\u52a1\u5668 <code>DC01.pharma.local</code> \u7ec4\u7ec7\u5355\u5143\uff08OU\uff09 \u5bb9\u5668\uff0c\u7528\u4e8e\u7ec4\u7ec7\u5bf9\u8c61 <code>OU=Users,OU=Shanghai,DC=pharma,DC=local</code> \u7528\u6237\uff08User\uff09 \u7528\u6237\u8d26\u53f7 <code>john.doe@pharma.local</code> \u7ec4\uff08Group\uff09 \u7528\u6237\u96c6\u5408\uff0c\u7528\u4e8e\u6743\u9650\u7ba1\u7406 <code>GG_IT_Admins</code> \u7ec4\u7b56\u7565\uff08GPO\uff09 \u914d\u7f6e\u7b56\u7565\uff0c\u5e94\u7528\u5230\u7528\u6237\u6216\u8ba1\u7b97\u673a <code>Desktop Wallpaper Policy</code> \u6797\uff08Forest\uff09 \u591a\u4e2a\u57df\u7684\u96c6\u5408 <code>pharma.local</code> + <code>research.pharma.local</code>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#13","title":"1.3 \u57df\u63a7\u67b6\u6784","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              pharma.local \u57df                     \u2502\n\u2502                                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502  \u2502   DC01       \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502   DC02       \u2502      \u2502\n\u2502  \u2502 (\u4e3b\u57df\u63a7)      \u2502  \u590d\u5236   \u2502 (\u5907\u57df\u63a7)      \u2502      \u2502\n\u2502  \u2502 \u4e0a\u6d77\u673a\u623f      \u2502        \u2502 \u5317\u4eac\u673a\u623f      \u2502      \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2502         \u2502                        \u2502             \u2502\n\u2502         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518             \u2502\n\u2502                      \u2502                         \u2502\n\u2502         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510             \u2502\n\u2502         \u2502   \u5ba2\u6237\u7aef\u8ba1\u7b97\u673a           \u2502             \u2502\n\u2502         \u2502   (\u52a0\u5165\u57df)              \u2502             \u2502\n\u2502         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#2","title":"2. \u73af\u5883\u51c6\u5907","text":""},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#21","title":"2.1 \u786c\u4ef6\u8981\u6c42","text":"\u7ec4\u4ef6 \u6700\u4f4e\u914d\u7f6e \u63a8\u8350\u914d\u7f6e\uff08500 \u7528\u6237\uff09 CPU 2 \u6838 4 \u6838 \u5185\u5b58 4GB 16GB \u78c1\u76d8 60GB 200GB\uff08SSD\uff09 \u7f51\u7edc 1Gbps 1Gbps\uff08\u53cc\u7f51\u5361\u5197\u4f59\uff09"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#22","title":"2.2 \u8f6f\u4ef6\u8981\u6c42","text":"<ul> <li>\u64cd\u4f5c\u7cfb\u7edf\uff1aWindows Server 2022 Standard/Datacenter</li> <li>\u8bb8\u53ef\u8bc1\uff1aWindows Server CAL\uff08\u5ba2\u6237\u7aef\u8bbf\u95ee\u8bb8\u53ef\u8bc1\uff09</li> <li>\u7f51\u7edc\uff1a\u56fa\u5b9a IP \u5730\u5740\u3001DNS \u914d\u7f6e</li> </ul>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#23","title":"2.3 \u7f51\u7edc\u89c4\u5212","text":"<pre><code>\u57df\u63a7\u670d\u52a1\u5668\uff1a\n- \u4e3b\u57df\u63a7\uff08DC01\uff09\uff1a10.10.40.10\n- \u5907\u57df\u63a7\uff08DC02\uff09\uff1a10.10.40.11\n- \u5b50\u7f51\u63a9\u7801\uff1a255.255.255.0\n- \u7f51\u5173\uff1a10.10.40.1\n- DNS\uff1a127.0.0.1\uff08\u6307\u5411\u81ea\u5df1\uff09\n\n\u57df\u540d\uff1a\n- NetBIOS \u540d\u79f0\uff1aPHARMA\n- \u5b8c\u5168\u9650\u5b9a\u57df\u540d\uff08FQDN\uff09\uff1apharma.local\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#3-dc01","title":"3. \u5b89\u88c5\u4e3b\u57df\u63a7\uff08DC01\uff09","text":""},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#31","title":"3.1 \u914d\u7f6e\u670d\u52a1\u5668\u57fa\u672c\u4fe1\u606f","text":"<pre><code># \u8bbe\u7f6e\u8ba1\u7b97\u673a\u540d\nRename-Computer -NewName \"DC01\" -Restart\n\n# \u8bbe\u7f6e\u9759\u6001 IP\nNew-NetIPAddress -InterfaceAlias \"Ethernet\" -IPAddress 10.10.40.10 -PrefixLength 24 -DefaultGateway 10.10.40.1\n\n# \u8bbe\u7f6e DNS\uff08\u6682\u65f6\u6307\u5411\u516c\u5171 DNS\uff0c\u5b89\u88c5 AD \u540e\u6539\u4e3a 127.0.0.1\uff09\nSet-DnsClientServerAddress -InterfaceAlias \"Ethernet\" -ServerAddresses (\"8.8.8.8\",\"8.8.4.4\")\n\n# \u7981\u7528 IPv6\uff08\u53ef\u9009\uff09\nDisable-NetAdapterBinding -Name \"Ethernet\" -ComponentID ms_tcpip6\n\n# \u8bbe\u7f6e\u65f6\u533a\nSet-TimeZone -Id \"China Standard Time\"\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#32-ad-ds","title":"3.2 \u5b89\u88c5 AD DS \u89d2\u8272","text":"<pre><code># \u5b89\u88c5 Active Directory \u57df\u670d\u52a1\u89d2\u8272\nInstall-WindowsFeature -Name AD-Domain-Services -IncludeManagementTools\n\n# \u9a8c\u8bc1\u5b89\u88c5\nGet-WindowsFeature -Name AD-Domain-Services\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#33","title":"3.3 \u63d0\u5347\u4e3a\u57df\u63a7\u5236\u5668","text":"<pre><code># \u5bfc\u5165 AD DS \u90e8\u7f72\u6a21\u5757\nImport-Module ADDSDeployment\n\n# \u521b\u5efa\u65b0\u6797\u548c\u57df\nInstall-ADDSForest `\n    -DomainName \"pharma.local\" `\n    -DomainNetbiosName \"PHARMA\" `\n    -ForestMode \"WinThreshold\" `\n    -DomainMode \"WinThreshold\" `\n    -InstallDns:$true `\n    -DatabasePath \"C:\\Windows\\NTDS\" `\n    -LogPath \"C:\\Windows\\NTDS\" `\n    -SysvolPath \"C:\\Windows\\SYSVOL\" `\n    -Force:$true\n\n# \u8f93\u5165 DSRM\uff08\u76ee\u5f55\u670d\u52a1\u8fd8\u539f\u6a21\u5f0f\uff09\u5bc6\u7801\n# \u670d\u52a1\u5668\u5c06\u81ea\u52a8\u91cd\u542f\n</code></pre> <p>\u53c2\u6570\u8bf4\u660e\uff1a - <code>DomainName</code>\uff1a\u57df\u7684 FQDN - <code>DomainNetbiosName</code>\uff1aNetBIOS \u540d\u79f0\uff0815 \u5b57\u7b26\u4ee5\u5185\uff09 - <code>ForestMode</code> / <code>DomainMode</code>\uff1a\u529f\u80fd\u7ea7\u522b\uff08WinThreshold = Windows Server 2016\uff09 - <code>InstallDns</code>\uff1a\u81ea\u52a8\u5b89\u88c5 DNS \u670d\u52a1\u5668 - <code>DatabasePath</code>\uff1aAD \u6570\u636e\u5e93\u8def\u5f84 - <code>SysvolPath</code>\uff1aSYSVOL \u5171\u4eab\u8def\u5f84</p>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#34","title":"3.4 \u9a8c\u8bc1\u5b89\u88c5","text":"<pre><code># \u91cd\u542f\u540e\uff0c\u4ee5\u57df\u7ba1\u7406\u5458\u8eab\u4efd\u767b\u5f55\uff1aPHARMA\\Administrator\n\n# \u9a8c\u8bc1\u57df\u63a7\u89d2\u8272\nGet-ADDomainController\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\n# ComputerObjectDN  : CN=DC01,OU=Domain Controllers,DC=pharma,DC=local\n# DefaultPartition  : DC=pharma,DC=local\n# Domain            : pharma.local\n# Enabled           : True\n# Forest            : pharma.local\n# HostName          : DC01.pharma.local\n# IPv4Address       : 10.10.40.10\n# IsGlobalCatalog   : True\n# IsReadOnly        : False\n# OperatingSystem   : Windows Server 2022 Standard\n\n# \u9a8c\u8bc1 DNS\nnslookup pharma.local\n# \u5e94\u8fd4\u56de 10.10.40.10\n\n# \u9a8c\u8bc1 FSMO \u89d2\u8272\uff085 \u4e2a\u64cd\u4f5c\u4e3b\u673a\u89d2\u8272\uff09\nnetdom query fsmo\n# \u8f93\u51fa\uff1a\n# Schema master               DC01.pharma.local\n# Domain naming master        DC01.pharma.local\n# PDC                         DC01.pharma.local\n# RID pool manager            DC01.pharma.local\n# Infrastructure master       DC01.pharma.local\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#35-dns","title":"3.5 \u914d\u7f6e DNS \u6307\u5411\u81ea\u5df1","text":"<pre><code># \u5c06 DNS \u6307\u5411\u81ea\u5df1\uff08127.0.0.1\uff09\nSet-DnsClientServerAddress -InterfaceAlias \"Ethernet\" -ServerAddresses (\"127.0.0.1\",\"10.10.40.11\")\n# 10.10.40.11 \u662f\u5907\u57df\u63a7\uff08\u7a0d\u540e\u90e8\u7f72\uff09\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#4-dc02","title":"4. \u5b89\u88c5\u5907\u57df\u63a7\uff08DC02\uff09","text":""},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#41","title":"4.1 \u914d\u7f6e\u670d\u52a1\u5668\u57fa\u672c\u4fe1\u606f","text":"<pre><code># \u8bbe\u7f6e\u8ba1\u7b97\u673a\u540d\nRename-Computer -NewName \"DC02\" -Restart\n\n# \u8bbe\u7f6e\u9759\u6001 IP\nNew-NetIPAddress -InterfaceAlias \"Ethernet\" -IPAddress 10.10.40.11 -PrefixLength 24 -DefaultGateway 10.10.40.1\n\n# \u8bbe\u7f6e DNS\uff08\u6307\u5411\u4e3b\u57df\u63a7\uff09\nSet-DnsClientServerAddress -InterfaceAlias \"Ethernet\" -ServerAddresses (\"10.10.40.10\",\"127.0.0.1\")\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#42-ad-ds","title":"4.2 \u5b89\u88c5 AD DS \u89d2\u8272","text":"<pre><code>Install-WindowsFeature -Name AD-Domain-Services -IncludeManagementTools\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#43","title":"4.3 \u52a0\u5165\u73b0\u6709\u57df\u5e76\u63d0\u5347\u4e3a\u57df\u63a7","text":"<pre><code># \u5bfc\u5165\u6a21\u5757\nImport-Module ADDSDeployment\n\n# \u52a0\u5165\u73b0\u6709\u57df\nInstall-ADDSDomainController `\n    -DomainName \"pharma.local\" `\n    -InstallDns:$true `\n    -Credential (Get-Credential PHARMA\\Administrator) `\n    -DatabasePath \"C:\\Windows\\NTDS\" `\n    -LogPath \"C:\\Windows\\NTDS\" `\n    -SysvolPath \"C:\\Windows\\SYSVOL\" `\n    -Force:$true\n\n# \u8f93\u5165\u57df\u7ba1\u7406\u5458\u5bc6\u7801\u548c DSRM \u5bc6\u7801\n# \u670d\u52a1\u5668\u5c06\u81ea\u52a8\u91cd\u542f\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#44","title":"4.4 \u9a8c\u8bc1\u590d\u5236","text":"<pre><code># \u5728 DC01 \u6216 DC02 \u4e0a\u6267\u884c\n\n# \u67e5\u770b\u590d\u5236\u72b6\u6001\nrepadmin /replsummary\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\n# Replication Summary Start Time: 2025-11-11 16:00:00\n# Beginning data collection for replication summary, this may take awhile:\n#   .....\n# Source DSA          largest delta    fails/total %%   error\n# DC01                00m:15s          0 /   5    0\n# DC02                00m:20s          0 /   5    0\n\n# \u67e5\u770b\u590d\u5236\u4f19\u4f34\nrepadmin /showrepl\n\n# \u5f3a\u5236\u590d\u5236\nrepadmin /syncall /AdeP\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#5-ou","title":"5. \u521b\u5efa\u7ec4\u7ec7\u5355\u5143\uff08OU\uff09\u7ed3\u6784","text":""},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#51-ou","title":"5.1 OU \u8bbe\u8ba1\u539f\u5219","text":"<pre><code>\u63a8\u8350\u7684 OU \u7ed3\u6784\uff08\u6309\u5730\u7406\u4f4d\u7f6e + \u90e8\u95e8\uff09\uff1a\n\npharma.local\n\u251c\u2500\u2500 Domain Controllers\uff08\u7cfb\u7edf\u81ea\u52a8\u521b\u5efa\uff09\n\u251c\u2500\u2500 Shanghai\uff08\u4e0a\u6d77\uff09\n\u2502   \u251c\u2500\u2500 Users\uff08\u7528\u6237\uff09\n\u2502   \u2502   \u251c\u2500\u2500 IT\n\u2502   \u2502   \u251c\u2500\u2500 RD\uff08\u7814\u53d1\uff09\n\u2502   \u2502   \u251c\u2500\u2500 QA\uff08\u8d28\u91cf\uff09\n\u2502   \u2502   \u251c\u2500\u2500 Production\uff08\u751f\u4ea7\uff09\n\u2502   \u2502   \u2514\u2500\u2500 Admin\uff08\u884c\u653f\uff09\n\u2502   \u251c\u2500\u2500 Computers\uff08\u8ba1\u7b97\u673a\uff09\n\u2502   \u2502   \u251c\u2500\u2500 Desktops\n\u2502   \u2502   \u251c\u2500\u2500 Laptops\n\u2502   \u2502   \u2514\u2500\u2500 Servers\n\u2502   \u2514\u2500\u2500 Groups\uff08\u7ec4\uff09\n\u251c\u2500\u2500 Beijing\uff08\u5317\u4eac\uff09\n\u2502   \u251c\u2500\u2500 Users\n\u2502   \u251c\u2500\u2500 Computers\n\u2502   \u2514\u2500\u2500 Groups\n\u2514\u2500\u2500 Service Accounts\uff08\u670d\u52a1\u8d26\u53f7\uff09\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#52-ou","title":"5.2 \u521b\u5efa OU","text":"<pre><code># \u521b\u5efa\u9876\u7ea7 OU\nNew-ADOrganizationalUnit -Name \"Shanghai\" -Path \"DC=pharma,DC=local\"\nNew-ADOrganizationalUnit -Name \"Beijing\" -Path \"DC=pharma,DC=local\"\nNew-ADOrganizationalUnit -Name \"Service Accounts\" -Path \"DC=pharma,DC=local\"\n\n# \u521b\u5efa\u4e0a\u6d77\u5b50 OU\nNew-ADOrganizationalUnit -Name \"Users\" -Path \"OU=Shanghai,DC=pharma,DC=local\"\nNew-ADOrganizationalUnit -Name \"Computers\" -Path \"OU=Shanghai,DC=pharma,DC=local\"\nNew-ADOrganizationalUnit -Name \"Groups\" -Path \"OU=Shanghai,DC=pharma,DC=local\"\n\n# \u521b\u5efa\u90e8\u95e8 OU\n$departments = @(\"IT\", \"RD\", \"QA\", \"Production\", \"Admin\")\nforeach ($dept in $departments) {\n    New-ADOrganizationalUnit -Name $dept -Path \"OU=Users,OU=Shanghai,DC=pharma,DC=local\"\n}\n\n# \u521b\u5efa\u8ba1\u7b97\u673a\u7c7b\u578b OU\n$computerTypes = @(\"Desktops\", \"Laptops\", \"Servers\")\nforeach ($type in $computerTypes) {\n    New-ADOrganizationalUnit -Name $type -Path \"OU=Computers,OU=Shanghai,DC=pharma,DC=local\"\n}\n\n# \u9a8c\u8bc1 OU \u7ed3\u6784\nGet-ADOrganizationalUnit -Filter * | Select-Object Name, DistinguishedName\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#6","title":"6. \u521b\u5efa\u7528\u6237\u548c\u7ec4","text":""},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#61","title":"6.1 \u521b\u5efa\u7528\u6237","text":"<pre><code># \u521b\u5efa\u5355\u4e2a\u7528\u6237\nNew-ADUser `\n    -Name \"John Doe\" `\n    -GivenName \"John\" `\n    -Surname \"Doe\" `\n    -SamAccountName \"john.doe\" `\n    -UserPrincipalName \"john.doe@pharma.local\" `\n    -Path \"OU=IT,OU=Users,OU=Shanghai,DC=pharma,DC=local\" `\n    -AccountPassword (ConvertTo-SecureString \"P@ssw0rd123!\" -AsPlainText -Force) `\n    -Enabled $true `\n    -ChangePasswordAtLogon $true `\n    -EmailAddress \"john.doe@pharma.com\" `\n    -Title \"IT Manager\" `\n    -Department \"IT\" `\n    -Company \"Pharma Corp\" `\n    -OfficePhone \"+86-21-12345678\" `\n    -MobilePhone \"+86-138-0000-0000\"\n\n# \u6279\u91cf\u521b\u5efa\u7528\u6237\uff08\u4ece CSV\uff09\n# \u51c6\u5907 CSV \u6587\u4ef6\uff1ausers.csv\n# FirstName,LastName,Username,Department,Title\n# John,Doe,john.doe,IT,IT Manager\n# Jane,Smith,jane.smith,RD,Scientist\n\n$users = Import-Csv -Path \"C:\\users.csv\"\nforeach ($user in $users) {\n    $ouPath = \"OU=$($user.Department),OU=Users,OU=Shanghai,DC=pharma,DC=local\"\n    New-ADUser `\n        -Name \"$($user.FirstName) $($user.LastName)\" `\n        -GivenName $user.FirstName `\n        -Surname $user.LastName `\n        -SamAccountName $user.Username `\n        -UserPrincipalName \"$($user.Username)@pharma.local\" `\n        -Path $ouPath `\n        -AccountPassword (ConvertTo-SecureString \"P@ssw0rd123!\" -AsPlainText -Force) `\n        -Enabled $true `\n        -ChangePasswordAtLogon $true `\n        -Department $user.Department `\n        -Title $user.Title\n}\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#62","title":"6.2 \u521b\u5efa\u7ec4","text":"<pre><code># \u521b\u5efa\u5168\u5c40\u5b89\u5168\u7ec4\uff08\u7528\u4e8e\u6743\u9650\u7ba1\u7406\uff09\nNew-ADGroup `\n    -Name \"GG_IT_Admins\" `\n    -GroupScope Global `\n    -GroupCategory Security `\n    -Path \"OU=Groups,OU=Shanghai,DC=pharma,DC=local\" `\n    -Description \"IT Administrators\"\n\nNew-ADGroup -Name \"GG_FileServer_RD_Read\" -GroupScope Global -GroupCategory Security -Path \"OU=Groups,OU=Shanghai,DC=pharma,DC=local\"\nNew-ADGroup -Name \"GG_FileServer_RD_Write\" -GroupScope Global -GroupCategory Security -Path \"OU=Groups,OU=Shanghai,DC=pharma,DC=local\"\nNew-ADGroup -Name \"GG_LIMS_Users\" -GroupScope Global -GroupCategory Security -Path \"OU=Groups,OU=Shanghai,DC=pharma,DC=local\"\nNew-ADGroup -Name \"GG_VPN_Users\" -GroupScope Global -GroupCategory Security -Path \"OU=Groups,OU=Shanghai,DC=pharma,DC=local\"\n\n# \u5c06\u7528\u6237\u6dfb\u52a0\u5230\u7ec4\nAdd-ADGroupMember -Identity \"GG_IT_Admins\" -Members \"john.doe\"\nAdd-ADGroupMember -Identity \"GG_VPN_Users\" -Members \"john.doe\",\"jane.smith\"\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#63","title":"6.3 \u7ec4\u547d\u540d\u89c4\u8303","text":"<pre><code>\u63a8\u8350\u547d\u540d\u89c4\u8303\uff1a\n- GG_\uff1a\u5168\u5c40\u7ec4\uff08Global Group\uff09\n- DL_\uff1a\u57df\u672c\u5730\u7ec4\uff08Domain Local Group\uff09\n- UG_\uff1a\u901a\u7528\u7ec4\uff08Universal Group\uff09\n\n\u793a\u4f8b\uff1a\n- GG_IT_Admins\uff1aIT \u7ba1\u7406\u5458\u5168\u5c40\u7ec4\n- DL_FileServer_RD_Read\uff1a\u7814\u53d1\u6587\u4ef6\u5939\u53ea\u8bfb\u6743\u9650\uff08\u57df\u672c\u5730\u7ec4\uff09\n- GG_VPN_Users\uff1aVPN \u7528\u6237\u5168\u5c40\u7ec4\n\n\u6743\u9650\u5206\u914d\u6a21\u5f0f\uff08AGDLP\uff09\uff1a\n1. \u7528\u6237\u8d26\u53f7\uff08Account\uff09\u2192 \u5168\u5c40\u7ec4\uff08Global Group\uff09\n2. \u5168\u5c40\u7ec4 \u2192 \u57df\u672c\u5730\u7ec4\uff08Domain Local Group\uff09\n3. \u57df\u672c\u5730\u7ec4 \u2192 \u8d44\u6e90\u6743\u9650\uff08Permission\uff09\n\n\u793a\u4f8b\uff1a\n- john.doe \u2192 GG_RD_Staff \u2192 DL_FileServer_RD_Write \u2192 \u7814\u53d1\u6587\u4ef6\u5939\uff08\u5199\u6743\u9650\uff09\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#7-gpo","title":"7. \u914d\u7f6e\u7ec4\u7b56\u7565\uff08GPO\uff09","text":""},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#71-gpo","title":"7.1 \u521b\u5efa GPO","text":"<pre><code># \u521b\u5efa\u65b0\u7684 GPO\nNew-GPO -Name \"Desktop Wallpaper Policy\" -Comment \"Set company wallpaper\"\n\n# \u94fe\u63a5 GPO \u5230 OU\nNew-GPLink -Name \"Desktop Wallpaper Policy\" -Target \"OU=Users,OU=Shanghai,DC=pharma,DC=local\"\n\n# \u67e5\u770b GPO\nGet-GPO -All | Select-Object DisplayName, GpoStatus, CreationTime\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#72-gpo","title":"7.2 \u5e38\u7528 GPO \u914d\u7f6e","text":""},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#721","title":"7.2.1 \u5bc6\u7801\u7b56\u7565","text":"<pre><code>\u8def\u5f84\uff1aComputer Configuration &gt; Policies &gt; Windows Settings &gt; Security Settings &gt; Account Policies &gt; Password Policy\n\n\u914d\u7f6e\uff1a\n- Enforce password history: 24 passwords remembered\n- Maximum password age: 90 days\n- Minimum password age: 1 day\n- Minimum password length: 12 characters\n- Password must meet complexity requirements: Enabled\n- Store passwords using reversible encryption: Disabled\n</code></pre> <pre><code># \u4f7f\u7528 PowerShell \u914d\u7f6e\uff08\u9700\u8981\u5728 DC \u4e0a\u6267\u884c\uff09\nSet-ADDefaultDomainPasswordPolicy `\n    -Identity pharma.local `\n    -ComplexityEnabled $true `\n    -MinPasswordLength 12 `\n    -MaxPasswordAge 90.00:00:00 `\n    -MinPasswordAge 1.00:00:00 `\n    -PasswordHistoryCount 24\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#722","title":"7.2.2 \u8d26\u6237\u9501\u5b9a\u7b56\u7565","text":"<pre><code>\u8def\u5f84\uff1aComputer Configuration &gt; Policies &gt; Windows Settings &gt; Security Settings &gt; Account Policies &gt; Account Lockout Policy\n\n\u914d\u7f6e\uff1a\n- Account lockout duration: 30 minutes\n- Account lockout threshold: 5 invalid logon attempts\n- Reset account lockout counter after: 30 minutes\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#723","title":"7.2.3 \u684c\u9762\u58c1\u7eb8","text":"<pre><code>\u8def\u5f84\uff1aUser Configuration &gt; Policies &gt; Administrative Templates &gt; Desktop &gt; Desktop &gt; Desktop Wallpaper\n\n\u914d\u7f6e\uff1a\n- Enabled\n- Wallpaper Name: \\\\pharma.local\\NETLOGON\\wallpaper.jpg\n- Wallpaper Style: Fill\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#724-usb","title":"7.2.4 \u7981\u7528 USB \u5b58\u50a8","text":"<pre><code>\u8def\u5f84\uff1aComputer Configuration &gt; Policies &gt; Administrative Templates &gt; System &gt; Removable Storage Access\n\n\u914d\u7f6e\uff1a\n- Removable Disks: Deny read access: Enabled\n- Removable Disks: Deny write access: Enabled\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#725","title":"7.2.5 \u8f6f\u4ef6\u90e8\u7f72","text":"<pre><code>\u8def\u5f84\uff1aComputer Configuration &gt; Policies &gt; Software Settings &gt; Software installation\n\n\u6b65\u9aa4\uff1a\n1. \u53f3\u952e &gt; New &gt; Package\n2. \u9009\u62e9 MSI \u6587\u4ef6\uff08\u5b58\u653e\u5728\u7f51\u7edc\u5171\u4eab\uff09\n3. \u9009\u62e9\u90e8\u7f72\u65b9\u5f0f\uff1aAssigned\uff08\u5f3a\u5236\u5b89\u88c5\uff09\u6216 Published\uff08\u53ef\u9009\u5b89\u88c5\uff09\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#726","title":"7.2.6 \u6620\u5c04\u7f51\u7edc\u9a71\u52a8\u5668","text":"<pre><code>\u8def\u5f84\uff1aUser Configuration &gt; Preferences &gt; Windows Settings &gt; Drive Maps\n\n\u914d\u7f6e\uff1a\n- Action: Create\n- Location: \\\\pharma.local\\shares\\department\n- Drive Letter: H:\n- Reconnect: Enabled\n- Label as: Department Share\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#73-gpo","title":"7.3 GPO \u4f18\u5148\u7ea7","text":"<pre><code>GPO \u5e94\u7528\u987a\u5e8f\uff08\u4ece\u4f4e\u5230\u9ad8\uff09\uff1a\n1. Local\uff08\u672c\u5730\u7b56\u7565\uff09\n2. Site\uff08\u7ad9\u70b9\uff09\n3. Domain\uff08\u57df\uff09\n4. OU\uff08\u7ec4\u7ec7\u5355\u5143\uff09\n\n\u540e\u5e94\u7528\u7684\u7b56\u7565\u4f1a\u8986\u76d6\u5148\u5e94\u7528\u7684\u7b56\u7565\u3002\n\n\u793a\u4f8b\uff1a\n- Domain GPO\uff1a\u5bc6\u7801\u957f\u5ea6 8 \u4f4d\n- OU GPO\uff1a\u5bc6\u7801\u957f\u5ea6 12 \u4f4d\n- \u6700\u7ec8\u7ed3\u679c\uff1a12 \u4f4d\uff08OU \u7b56\u7565\u4f18\u5148\u7ea7\u66f4\u9ad8\uff09\n\n\u5f3a\u5236\uff08Enforced\uff09\u548c\u963b\u6b62\u7ee7\u627f\uff08Block Inheritance\uff09\uff1a\n- Enforced\uff1a\u5f3a\u5236\u5e94\u7528\uff0c\u4e0d\u88ab\u5b50 OU \u8986\u76d6\n- Block Inheritance\uff1a\u963b\u6b62\u7ee7\u627f\u7236 OU \u7684\u7b56\u7565\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#74-gpo","title":"7.4 \u5237\u65b0 GPO","text":"<pre><code># \u5728\u5ba2\u6237\u7aef\u5f3a\u5236\u5237\u65b0 GPO\ngpupdate /force\n\n# \u67e5\u770b\u5e94\u7528\u7684 GPO\ngpresult /r\n\n# \u751f\u6210\u8be6\u7ec6\u62a5\u544a\uff08HTML\uff09\ngpresult /h C:\\gpo_report.html\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#8","title":"8. \u5ba2\u6237\u7aef\u52a0\u5165\u57df","text":""},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#81-dns","title":"8.1 \u914d\u7f6e\u5ba2\u6237\u7aef DNS","text":"<pre><code>\u5728\u5ba2\u6237\u7aef\u8ba1\u7b97\u673a\u4e0a\uff1a\n1. \u6253\u5f00\"\u7f51\u7edc\u548c\u5171\u4eab\u4e2d\u5fc3\"\n2. \u66f4\u6539\u9002\u914d\u5668\u8bbe\u7f6e\n3. \u53f3\u952e\u7f51\u5361 &gt; \u5c5e\u6027 &gt; IPv4\n4. \u8bbe\u7f6e DNS\uff1a\n   - \u9996\u9009 DNS\uff1a10.10.40.10\uff08\u4e3b\u57df\u63a7\uff09\n   - \u5907\u7528 DNS\uff1a10.10.40.11\uff08\u5907\u57df\u63a7\uff09\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#82-gui","title":"8.2 \u52a0\u5165\u57df\uff08GUI\uff09","text":"<pre><code>1. \u53f3\u952e\"\u6b64\u7535\u8111\" &gt; \u5c5e\u6027\n2. \u70b9\u51fb\"\u66f4\u6539\u8bbe\u7f6e\"\n3. \u70b9\u51fb\"\u66f4\u6539\"\n4. \u9009\u62e9\"\u57df\"\uff0c\u8f93\u5165\uff1apharma.local\n5. \u70b9\u51fb\"\u786e\u5b9a\"\n6. \u8f93\u5165\u57df\u7ba1\u7406\u5458\u8d26\u53f7\uff1aPHARMA\\Administrator\n7. \u91cd\u542f\u8ba1\u7b97\u673a\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#83-powershell","title":"8.3 \u52a0\u5165\u57df\uff08PowerShell\uff09","text":"<pre><code># \u5728\u5ba2\u6237\u7aef\u6267\u884c\nAdd-Computer -DomainName \"pharma.local\" -Credential (Get-Credential PHARMA\\Administrator) -Restart\n\n# \u6216\u6307\u5b9a OU\nAdd-Computer `\n    -DomainName \"pharma.local\" `\n    -OUPath \"OU=Laptops,OU=Computers,OU=Shanghai,DC=pharma,DC=local\" `\n    -Credential (Get-Credential PHARMA\\Administrator) `\n    -Restart\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#84","title":"8.4 \u9a8c\u8bc1\u52a0\u5165\u57df","text":"<pre><code># \u67e5\u770b\u8ba1\u7b97\u673a\u57df\u4fe1\u606f\nGet-ComputerInfo | Select-Object CsDomain, CsDomainRole\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\n# CsDomain      : pharma.local\n# CsDomainRole  : MemberWorkstation\n\n# \u6d4b\u8bd5\u57df\u8fde\u63a5\nTest-ComputerSecureChannel -Verbose\n# \u8f93\u51fa\uff1aTrue\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#9","title":"9. \u65e5\u5e38\u7ba1\u7406","text":""},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#91","title":"9.1 \u91cd\u7f6e\u7528\u6237\u5bc6\u7801","text":"<pre><code># \u91cd\u7f6e\u5bc6\u7801\nSet-ADAccountPassword -Identity john.doe -Reset -NewPassword (ConvertTo-SecureString \"NewP@ssw0rd!\" -AsPlainText -Force)\n\n# \u8981\u6c42\u4e0b\u6b21\u767b\u5f55\u65f6\u66f4\u6539\u5bc6\u7801\nSet-ADUser -Identity john.doe -ChangePasswordAtLogon $true\n\n# \u89e3\u9501\u8d26\u6237\nUnlock-ADAccount -Identity john.doe\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#92","title":"9.2 \u7981\u7528/\u542f\u7528\u7528\u6237","text":"<pre><code># \u7981\u7528\u7528\u6237\nDisable-ADAccount -Identity john.doe\n\n# \u542f\u7528\u7528\u6237\nEnable-ADAccount -Identity john.doe\n\n# \u67e5\u770b\u7981\u7528\u7684\u7528\u6237\nSearch-ADAccount -AccountDisabled | Select-Object Name, SamAccountName\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#93","title":"9.3 \u67e5\u8be2\u7528\u6237\u4fe1\u606f","text":"<pre><code># \u67e5\u8be2\u5355\u4e2a\u7528\u6237\nGet-ADUser -Identity john.doe -Properties *\n\n# \u67e5\u8be2\u6240\u6709\u7528\u6237\nGet-ADUser -Filter * | Select-Object Name, SamAccountName, Enabled\n\n# \u67e5\u8be2\u7279\u5b9a\u90e8\u95e8\u7684\u7528\u6237\nGet-ADUser -Filter {Department -eq \"IT\"} | Select-Object Name, Title\n\n# \u67e5\u8be2\u6700\u8fd1 30 \u5929\u672a\u767b\u5f55\u7684\u7528\u6237\n$date = (Get-Date).AddDays(-30)\nGet-ADUser -Filter {LastLogonDate -lt $date} -Properties LastLogonDate | Select-Object Name, LastLogonDate\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#94-ad","title":"9.4 \u5907\u4efd AD","text":"<pre><code># \u4f7f\u7528 Windows Server Backup \u5907\u4efd\u7cfb\u7edf\u72b6\u6001\uff08\u5305\u542b AD\uff09\nwbadmin start systemstatebackup -backupTarget:E: -quiet\n\n# \u6216\u4f7f\u7528 PowerShell\nInstall-WindowsFeature Windows-Server-Backup\n$policy = New-WBPolicy\n$target = New-WBBackupTarget -VolumePath E:\nAdd-WBBackupTarget -Policy $policy -Target $target\nAdd-WBSystemState -Policy $policy\nStart-WBBackup -Policy $policy\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#10","title":"10. \u76d1\u63a7\u4e0e\u6545\u969c\u6392\u67e5","text":""},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#101-ad","title":"10.1 \u76d1\u63a7 AD \u5065\u5eb7\u72b6\u6001","text":"<pre><code># \u68c0\u67e5 AD \u590d\u5236\nrepadmin /replsummary\n\n# \u68c0\u67e5 FSMO \u89d2\u8272\nnetdom query fsmo\n\n# \u68c0\u67e5 DNS\ndcdiag /test:dns\n\n# \u5168\u9762\u8bca\u65ad\ndcdiag /v\n\n# \u68c0\u67e5 SYSVOL \u590d\u5236\ndfsrdiag replicationstate\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#102","title":"10.2 \u5e38\u89c1\u95ee\u9898","text":""},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#1","title":"\u95ee\u9898 1\uff1a\u5ba2\u6237\u7aef\u65e0\u6cd5\u52a0\u5165\u57df","text":"<pre><code>\u9519\u8bef\uff1a\u627e\u4e0d\u5230\u7f51\u7edc\u8def\u5f84\n\n\u6392\u67e5\u6b65\u9aa4\uff1a\n1. \u68c0\u67e5\u5ba2\u6237\u7aef DNS \u662f\u5426\u6307\u5411\u57df\u63a7\n2. Ping \u57df\u540d\uff1aping pharma.local\n3. \u68c0\u67e5\u9632\u706b\u5899\uff08\u7aef\u53e3 53, 88, 389, 445, 3268\uff09\n4. \u68c0\u67e5\u65f6\u95f4\u540c\u6b65\uff08\u8bef\u5dee\u4e0d\u80fd\u8d85\u8fc7 5 \u5206\u949f\uff09\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#2gpo","title":"\u95ee\u9898 2\uff1aGPO \u672a\u5e94\u7528","text":"<pre><code>\u6392\u67e5\u6b65\u9aa4\uff1a\n1. \u5728\u5ba2\u6237\u7aef\u8fd0\u884c\uff1agpupdate /force\n2. \u68c0\u67e5 GPO \u94fe\u63a5\uff1aGet-GPInheritance -Target \"OU=Users,OU=Shanghai,DC=pharma,DC=local\"\n3. \u68c0\u67e5 GPO \u72b6\u6001\uff1aGet-GPO -Name \"Desktop Wallpaper Policy\"\n4. \u67e5\u770b\u4e8b\u4ef6\u65e5\u5fd7\uff1aEvent Viewer &gt; Applications and Services Logs &gt; Microsoft &gt; Windows &gt; GroupPolicy\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#3ad","title":"\u95ee\u9898 3\uff1aAD \u590d\u5236\u5931\u8d25","text":"<pre><code>\u6392\u67e5\u6b65\u9aa4\uff1a\n1. \u68c0\u67e5\u7f51\u7edc\u8fde\u63a5\uff1aping DC02.pharma.local\n2. \u68c0\u67e5\u590d\u5236\u72b6\u6001\uff1arepadmin /showrepl\n3. \u5f3a\u5236\u590d\u5236\uff1arepadmin /syncall /AdeP\n4. \u68c0\u67e5\u4e8b\u4ef6\u65e5\u5fd7\uff1aEvent Viewer &gt; Directory Service\n</code></pre>"},{"location":"enterprise/Windows%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE.html#11","title":"11. \u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u81f3\u5c11\u90e8\u7f72 2 \u53f0\u57df\u63a7\uff1a\u4e3b\u5907\u5197\u4f59</li> <li>\u5b9a\u671f\u5907\u4efd\uff1a\u6bcf\u5929\u5907\u4efd\u7cfb\u7edf\u72b6\u6001</li> <li>\u76d1\u63a7\u590d\u5236\uff1a\u786e\u4fdd DC \u4e4b\u95f4\u6b63\u5e38\u590d\u5236</li> <li>OU \u7ed3\u6784\u6e05\u6670\uff1a\u4fbf\u4e8e\u7ba1\u7406\u548c\u5e94\u7528 GPO</li> <li>\u7ec4\u547d\u540d\u89c4\u8303\uff1a\u4f7f\u7528\u524d\u7f00\uff08GG_\u3001DL_\uff09</li> <li>\u6700\u5c0f\u6743\u9650\u539f\u5219\uff1a\u4e0d\u8981\u6ee5\u7528 Domain Admins</li> <li>\u5b9a\u671f\u5ba1\u67e5\u6743\u9650\uff1a\u6bcf\u5b63\u5ea6\u5ba1\u67e5\u7528\u6237\u548c\u7ec4</li> <li>\u6d4b\u8bd5 GPO\uff1a\u5148\u5728\u6d4b\u8bd5 OU \u6d4b\u8bd5\uff0c\u518d\u63a8\u5e7f</li> <li>\u6587\u6863\u5316\uff1a\u8bb0\u5f55 OU \u7ed3\u6784\u3001GPO \u914d\u7f6e</li> <li>\u65f6\u95f4\u540c\u6b65\uff1a\u786e\u4fdd\u6240\u6709\u670d\u52a1\u5668\u65f6\u95f4\u4e00\u81f4</li> </ol> <p>\u53c2\u8003\u8d44\u6e90\uff1a - Microsoft Active Directory \u5b98\u65b9\u6587\u6863 - Windows Server 2022 \u7ba1\u7406\u6307\u5357 - Active Directory Best Practices</p>"},{"location":"enterprise/aliecs.html","title":"ALIECS","text":"<p>A technical exploration and guide</p>"},{"location":"enterprise/aliecs.html#content","title":"Content","text":""},{"location":"enterprise/aliecs.html#_1","title":"\u963f\u91cc\u4e91\u8f7b\u91cf\u5e94\u7528\u4e91\u670d\u52a1\u5668\u90e8\u7f72","text":"<p>\u672c\u6587\u4ecb\u7ecd\u4e86\u5982\u4f55\u5728\u963f\u91cc\u4e91\u8f7b\u91cf\u5e94\u7528\u670d\u52a1\u5668\u4e0a\u90e8\u7f72\u5e94\u7528\u3002\u4ee5\u4e0b\u662f\u76f8\u5173\u6559\u7a0b\u89c6\u9891\uff1a</p>"},{"location":"enterprise/ansible-enterprise-practical-guide.html","title":"Ansible \u4f01\u4e1a\u5b9e\u6218\u65b9\u6848\uff1a\u4e2d\u578b\u4f01\u4e1a\u4ece\u5b89\u88c5\u5230\u7b56\u7565\u843d\u5730\uff08\u542b\u547d\u4ee4\uff09","text":"<p>\u672c\u6587\u4ee5\u201c\u4e2d\u578b\u4f01\u4e1a IT \u8fd0\u7ef4\u201d\u4e3a\u573a\u666f\uff0c\u865a\u62df\u6784\u5efa\u4e00\u5957\u5178\u578b\u7684\u4e1a\u52a1\u4e0e\u7f51\u7edc\u62d3\u6251\uff0c\u6f14\u793a\u5982\u4f55\u7528 Ansible \u4ece 0 \u5230 1 \u5b8c\u6210\u5b89\u88c5\u3001\u5206\u5c42\u89c4\u5212\u3001\u57fa\u7840\u914d\u7f6e\u3001\u7f51\u7edc\u4e0e\u5b89\u5168\u3001\u5e94\u7528\u53d1\u5e03\u4e0e\u76d1\u63a7\u63a5\u5165\uff0c\u9762\u5411\u521d\u5b66\u8005\u63d0\u4f9b\u5b9e\u9645\u53ef\u590d\u7528\u7684\u547d\u4ee4\u4e0e\u6e05\u5355\u6837\u4f8b\u3002</p>"},{"location":"enterprise/ansible-enterprise-practical-guide.html#1","title":"1. \u573a\u666f\u4e0e\u62d3\u6251\uff08\u865a\u62df\u4f01\u4e1a\uff09","text":"<ul> <li>\u603b\u90e8\uff08HQ\uff09\u4e0e\u4e00\u5904\u673a\u623f\uff08DC\uff09\uff0c\u4e24\u73af\u5883\uff08prod/dev\uff09\uff0c\u4e00\u8df3\u5821\u5792\u673a\uff08bastion\uff09</li> <li>\u4e1a\u52a1\uff1aNginx Web \u524d\u7aef\u3001Java \u5e94\u7528\u3001PostgreSQL \u6570\u636e\u5e93\u3001Redis\u3001\u5bf9\u8c61\u5b58\u50a8\u7f51\u5173</li> <li>\u7f51\u7edc\u4e0e VLAN\uff08\u793a\u4f8b\uff09</li> <li>\u7ba1\u7406\u7f51 10.10.0.0/24\uff08bastion/\u8df3\u677f\u4e0e Ansible \u63a7\u5236\u7aef\uff09</li> <li>\u751f\u4ea7\u533a 10.10.10.0/24\uff0c\u5f00\u53d1\u533a 10.10.20.0/24</li> <li>\u6570\u636e\u5e93\u533a 10.10.30.0/24\uff0c\u5b58\u50a8/\u5907\u4efd\u533a 10.10.40.0/24</li> </ul> <p>ASCII \u62d3\u6251\uff08\u7b80\u5316\uff09\uff1a</p> <pre><code>Laptop -&gt; VPN -&gt; Bastion(10.10.0.10) -&gt; { prod, dev }\n                                   \\-&gt; DB(10.10.30.x)\n                                     -&gt; Web/App(10.10.10.x / 20.x)\n</code></pre>"},{"location":"enterprise/ansible-enterprise-practical-guide.html#2","title":"2. \u5b89\u88c5\u4e0e\u57fa\u7840\u51c6\u5907","text":""},{"location":"enterprise/ansible-enterprise-practical-guide.html#21-ansible","title":"2.1 \u5b89\u88c5 Ansible\uff08\u5efa\u8bae\u865a\u62df\u73af\u5883\uff09","text":"<ul> <li>Ubuntu/Debian</li> </ul> <pre><code>sudo apt update &amp;&amp; sudo apt install -y python3-venv python3-pip\npython3 -m venv ~/.venvs/ansible &amp;&amp; source ~/.venvs/ansible/bin/activate\npip install --upgrade pip &amp;&amp; pip install ansible==9.* ansible-lint\nansible --version\n</code></pre> <ul> <li>RHEL/CentOS/Rocky</li> </ul> <pre><code>sudo dnf install -y python3 python3-pip\npython3 -m venv ~/.venvs/ansible &amp;&amp; source ~/.venvs/ansible/bin/activate\npip install --upgrade pip &amp;&amp; pip install ansible==9.*\n</code></pre>"},{"location":"enterprise/ansible-enterprise-practical-guide.html#22","title":"2.2 \u76ee\u5f55\u7ed3\u6784\uff08\u63a8\u8350\uff09","text":"<pre><code>enterprise-ansible/\n\u251c\u2500 ansible.cfg\n\u251c\u2500 inventories/\n\u2502  \u251c\u2500 prod/hosts.ini\n\u2502  \u2514\u2500 dev/hosts.ini\n\u251c\u2500 group_vars/{all,prod,dev}.yml\n\u251c\u2500 host_vars/\n\u251c\u2500 roles/\n\u2502  \u251c\u2500 base_hardening/{tasks,templates,files}\n\u2502  \u251c\u2500 linux_network/{tasks,templates}\n\u2502  \u251c\u2500 web_nginx/{tasks,templates}\n\u2502  \u251c\u2500 db_postgresql/{tasks,templates}\n\u2502  \u2514\u2500 exporters_node/{tasks,templates}\n\u2514\u2500 site.yml\n</code></pre>"},{"location":"enterprise/ansible-enterprise-practical-guide.html#23-ansiblecfg","title":"2.3 ansible.cfg\uff08\u793a\u4f8b\uff09","text":"<pre><code>[defaults]\ninventory = inventories/prod/hosts.ini\nforks = 20\ntimeout = 30\nhost_key_checking = False\ninterpreter_python = auto_silent\nretry_files_enabled = False\nstdout_callback = yaml\n</code></pre>"},{"location":"enterprise/ansible-enterprise-practical-guide.html#24-ssh","title":"2.4 SSH \u4e0e\u63d0\u6743","text":"<pre><code># ~/.ssh/config\uff08\u8df3\u677f\uff09\nHost bastion\n  HostName 10.10.0.10\n  User ops\nHost 10.10.*.*\n  ProxyJump bastion\n\n# \u76ee\u6807\u673a\u63d0\u4f9b sudo \u6743\u9650\uff08\u514d\u5bc6\u7801\u6216\u9650\u547d\u4ee4\uff09\n</code></pre>"},{"location":"enterprise/ansible-enterprise-practical-guide.html#3-inventory","title":"3. \u6e05\u5355\uff08Inventory\uff09\u4e0e\u5206\u7ec4","text":"<p>inventories/prod/hosts.ini\uff1a</p> <pre><code>[web]\nweb01 ansible_host=10.10.10.11 env=prod\nweb02 ansible_host=10.10.10.12 env=prod\n\n[app]\napp01 ansible_host=10.10.10.21 env=prod\n\n[db]\ndb01 ansible_host=10.10.30.31 env=prod pg_role=primary\n\n[all:vars]\nansible_user=ops\nansible_become=true\n</code></pre> <p>group_vars/all.yml\uff08\u57fa\u7840\u53c2\u6570\uff09\uff1a</p> <pre><code>ntp_servers: [time1.aliyun.com, time2.aliyun.com]\ntimezone: Asia/Shanghai\nssh_allow_groups: [ops]\nfirewall_allowed:\n  - { port: 22, proto: tcp }\n  - { port: 80, proto: tcp }\n  - { port: 443, proto: tcp }\n</code></pre> <p>group_vars/prod.yml\uff08\u751f\u4ea7\u504f\u597d\uff09\uff1a</p> <pre><code>packages_common: [vim, curl, htop, chrony]\n</code></pre>"},{"location":"enterprise/ansible-enterprise-practical-guide.html#4","title":"4. \u89d2\u8272\u4e0e\u4efb\u52a1\uff08\u793a\u4f8b\uff09","text":""},{"location":"enterprise/ansible-enterprise-practical-guide.html#41-rolesbase_hardeningtasksmainyml","title":"4.1 \u57fa\u7ebf\u52a0\u56fa\uff1aroles/base_hardening/tasks/main.yml","text":"<pre><code>- name: \u8bbe\u7f6e\u65f6\u533a\n  community.general.timezone:\n    name: \"{{ timezone }}\"\n\n- name: \u5b89\u88c5\u57fa\u7840\u5305\n  ansible.builtin.package:\n    name: \"{{ packages_common }}\"\n    state: present\n\n- name: \u542f\u7528\u5e76\u914d\u7f6e chrony\n  ansible.builtin.service:\n    name: chronyd\n    state: started\n    enabled: true\n\n- name: \u52a0\u56fa sshd\n  ansible.builtin.lineinfile:\n    path: /etc/ssh/sshd_config\n    regexp: '^#?PasswordAuthentication'\n    line: 'PasswordAuthentication no'\n    backup: yes\n  notify: Restart sshd\n\n- name: \u914d\u7f6e\u9632\u706b\u5899\uff08\u4ee5 firewalld \u4e3a\u4f8b\uff09\n  ansible.posix.firewalld:\n    port: \"{{ item.port }}/{{ item.proto }}\"\n    permanent: true\n    immediate: true\n    state: enabled\n  loop: \"{{ firewall_allowed }}\"\n\n- name: \u6536\u96c6\u8d44\u4ea7\uff08facts\uff09\u5230\u6587\u4ef6\n  ansible.builtin.copy:\n    content: \"{{ ansible_facts | to_nice_yaml }}\\n\"\n    dest: \"/var/tmp/facts_{{ inventory_hostname }}.yml\"\n</code></pre> <p>handlers/main.yml\uff1a</p> <pre><code>- name: Restart sshd\n  ansible.builtin.service:\n    name: sshd\n    state: restarted\n</code></pre>"},{"location":"enterprise/ansible-enterprise-practical-guide.html#42-roleslinux_networktasksmainyml","title":"4.2 \u7f51\u7edc\u914d\u7f6e\uff1aroles/linux_network/tasks/main.yml\uff08\u793a\u4f8b\uff09","text":"<ul> <li>Ubuntu(Netplan) \u521b\u5efa VLAN \u63a5\u53e3 vlan10\uff1a</li> </ul> <pre><code>- name: \u6e32\u67d3 netplan\n  ansible.builtin.template:\n    src: netplan.yaml.j2\n    dest: /etc/netplan/01-netcfg.yaml\n  notify: Apply netplan\n</code></pre> <p>handlers\uff1a</p> <pre><code>- name: Apply netplan\n  ansible.builtin.command: netplan apply\n</code></pre> <ul> <li>RHEL \u4f7f\u7528 nmcli\uff08\u793a\u4f8b ad-hoc\uff09</li> </ul> <pre><code>ansible all -m community.general.nmcli -a \\\n\"conn_name=vlan10 ifname=eth0.10 type=vlan vlandev=eth0 vlan_id=10 ip4=10.10.10.11/24 gw4=10.10.10.1 state=present\"\n</code></pre>"},{"location":"enterprise/ansible-enterprise-practical-guide.html#43-web","title":"4.3 Web \u4e0e\u6570\u636e\u5e93\uff08\u793a\u4f8b\uff09","text":"<p>roles/web_nginx/tasks/main.yml\uff1a</p> <pre><code>- name: \u5b89\u88c5\u5e76\u542f\u7528 Nginx\n  ansible.builtin.package:\n    name: nginx\n    state: present\n- ansible.builtin.service:\n    name: nginx\n    state: started\n    enabled: true\n- name: \u90e8\u7f72\u7ad9\u70b9\u6a21\u677f\n  ansible.builtin.template:\n    src: default.conf.j2\n    dest: /etc/nginx/conf.d/default.conf\n  notify: Reload nginx\n</code></pre> <p>handlers\uff1a</p> <pre><code>- name: Reload nginx\n  ansible.builtin.service:\n    name: nginx\n    state: reloaded\n</code></pre> <p>roles/db_postgresql/tasks/main.yml\uff08\u5b89\u88c5\u3001\u521d\u59cb\u5316\u7565\uff09</p>"},{"location":"enterprise/ansible-enterprise-practical-guide.html#44","title":"4.4 \u5bfc\u51fa\u5668\uff08\u76d1\u63a7\u63a5\u5165\uff09","text":"<p>roles/exporters_node/tasks/main.yml\uff1a</p> <pre><code>- name: \u4e0b\u8f7d\u5e76\u5b89\u88c5 node_exporter\n  ansible.builtin.unarchive:\n    src: https://github.com/prometheus/node_exporter/releases/download/v1.8.1/node_exporter-1.8.1.linux-amd64.tar.gz\n    dest: /opt/\n    remote_src: yes\n- name: \u914d\u7f6e systemd\n  ansible.builtin.copy:\n    dest: /etc/systemd/system/node_exporter.service\n    content: |\n      [Unit]\n      Description=Node Exporter\n      [Service]\n      ExecStart=/opt/node_exporter-1.8.1.linux-amd64/node_exporter\n      [Install]\n      WantedBy=multi-user.target\n- name: \u542f\u52a8\u5e76\u542f\u7528\n  ansible.builtin.systemd:\n    name: node_exporter\n    state: started\n    enabled: true\n</code></pre>"},{"location":"enterprise/ansible-enterprise-practical-guide.html#5-playbook","title":"5. Playbook \u6c47\u603b\u4e0e\u6267\u884c","text":"<p>site.yml\uff1a</p> <pre><code>- hosts: all\n  roles:\n    - base_hardening\n    - linux_network\n    - exporters_node\n\n- hosts: web\n  roles:\n    - web_nginx\n\n- hosts: db\n  roles:\n    - db_postgresql\n</code></pre> <p>\u6267\u884c\uff1a</p> <pre><code># \u5148\u505a\u8fde\u901a\u6027\u4e0e\u63d0\u6743\u68c0\u67e5\nansible all -m ping\nansible all -m command -a 'id'\n\n# \u6b63\u5f0f\u6267\u884c\uff08\u4ee5 prod \u5e93\u5b58\u4e3a\u4f8b\uff09\nANSIBLE_CONFIG=./ansible.cfg ansible-playbook -i inventories/prod/hosts.ini site.yml -t base_hardening\n</code></pre>"},{"location":"enterprise/ansible-enterprise-practical-guide.html#6-ad-hoc","title":"6. \u5e38\u7528 ad-hoc \u547d\u4ee4\u4e0e\u6280\u5de7","text":"<pre><code># \u63a8\u9001\u6587\u4ef6/\u6a21\u677f\na nsible all -m copy -a \"src=./file dest=/tmp/file mode=0644\"\nansible web -m template -a \"src=nginx.j2 dest=/etc/nginx/nginx.conf\"\n\n# \u7528\u6237\u4e0e\u5bc6\u94a5\nansible all -m user -a \"name=deploy shell=/bin/bash state=present\"\nansible all -m authorized_key -a \"user=deploy key='{{ lookup('file','~/.ssh/id_rsa.pub') }}'\"\n\n# \u5305\u4e0e\u670d\u52a1\nansible all -m package -a \"name=htop state=present\"\nansible web -m service -a \"name=nginx state=restarted\"\n</code></pre> <ul> <li>\u673a\u5bc6\u4f7f\u7528 ansible-vault\uff1a</li> </ul> <pre><code>ansible-vault create group_vars/prod/vault.yml\n# \u5728\u4efb\u52a1\u4e2d\u901a\u8fc7 vars_files \u5f15\u7528\uff0c\u6216\u4f7f\u7528 vars: vault_xxx\n</code></pre>"},{"location":"enterprise/ansible-enterprise-practical-guide.html#7","title":"7. \u7b56\u7565\u843d\u5730\u4e0e\u6700\u4f73\u5b9e\u8df5","text":"<ul> <li>\u5206\u5c42\uff1ainventory(\u73af\u5883) \u2192 group_vars(\u57df) \u2192 role\uff08\u804c\u8d23\uff09 \u2192 playbook\uff08\u7f16\u6392\uff09</li> <li>\u53d8\u66f4\u5b89\u5168\uff1a--check\u3001--diff\u3001\u5206\u6279\u6eda\u52a8\u3001\u84dd\u7eff/\u91d1\u4e1d\u96c0</li> <li>\u5ba1\u8ba1\uff1a\u96c6\u4e2d facts\u3001\u751f\u6210 CMDB\uff08ansible-cmdb\uff09\u3001\u65e5\u5fd7\u7559\u75d5</li> <li>\u4e0e\u76d1\u63a7\u8054\u52a8\uff1a\u90e8\u7f72 exporter\u3001\u63a5\u5165 Alertmanager/Grafana</li> <li>\u4e0e\u5907\u4efd\u8054\u52a8\uff1a\u6267\u884c\u524d\u540e Hook \u4e0e NetBackup \u5907\u4efd/\u6062\u590d\u811a\u672c</li> </ul>"},{"location":"enterprise/ansible-enterprise-practical-guide.html#8","title":"8. \u5e38\u89c1\u5751","text":"<ul> <li>Python \u4e0e\u7cfb\u7edf Python \u51b2\u7a81\uff1a\u4f7f\u7528 venv \u9694\u79bb</li> <li>SSH \u8df3\u677f\u94fe\u8def\uff1aProxyJump\uff0c\u6216 ansible_ssh_common_args=-o ProxyCommand</li> <li>\u9632\u706b\u5899/SELinux\uff1a\u4ee5\u6a21\u5757\u7ba1\u7406\uff0c\u4e0d\u624b\u52a8\u6539\u914d\u7f6e</li> <li>\u5e42\u7b49\u6027\uff1a\u4f18\u5148\u4f7f\u7528\u6a21\u5757\uff08package/service/template\uff09\uff0c\u907f\u514d\u88f8 command/shell</li> </ul>"},{"location":"enterprise/enterprise-security-strategy-and-governance.html","title":"\u4f01\u4e1a IT \u7cfb\u7edf\u5b89\u5168\u6cbb\u7406\uff1a\u7b56\u7565\u3001\u89c4\u8303\u4e0e\u751f\u547d\u5468\u671f\u7ba1\u7406","text":"<p>\u8fd9\u7bc7\u6587\u7ae0\u4ece \u7b56\u7565 \u2192 \u89c4\u8303 \u2192 \u751f\u547d\u5468\u671f\u7ba1\u7406 \u4e09\u4e2a\u5c42\u9762\uff0c\u8c08\u4e00\u8c08\u4f01\u4e1a IT \u7cfb\u7edf\u5b89\u5168\u5e94\u8be5\u600e\u4e48\u505a\uff0c\u4ee5\u53ca\u6211\u4e2a\u4eba\u5728\u5b9e\u9645\u5de5\u4f5c\u4e2d\u7684\u7406\u89e3\u548c\u505a\u6cd5\u3002</p>"},{"location":"enterprise/enterprise-security-strategy-and-governance.html#1","title":"1. \u5148\u6709\u4e1a\u52a1\uff0c\u518d\u6709\u5b89\u5168\uff1a\u6839\u636e\u4e1a\u52a1\u5236\u5b9a\u5b89\u5168\u7b56\u7565","text":"<p>\u5b89\u5168\u4e0d\u662f\u51ed\u7a7a\u51fa\u73b0\u7684\u4e00\u5957\u201c\u6a21\u677f\u201d\uff0c\u800c\u662f \u56f4\u7ed5\u5177\u4f53\u4e1a\u52a1\u573a\u666f\u8bbe\u8ba1\u51fa\u6765\u7684\u7cfb\u7edf\u5316\u7b56\u7565\u3002</p> <ul> <li>\u6709\u4ec0\u4e48\u6837\u7684\u4e1a\u52a1\uff0c\u5c31\u5e94\u8be5\u6709\u4ec0\u4e48\u6837\u7684\u5b89\u5168\u7b56\u7565\u3002</li> <li>\u4e0d\u540c\u4e1a\u52a1\u5bf9\u4fdd\u5bc6\u6027\u3001\u5b8c\u6574\u6027\u3001\u53ef\u7528\u6027\u7684\u8981\u6c42\u5b8c\u5168\u4e0d\u540c\uff1a</li> <li>\u9762\u5411\u5916\u7f51\u7684\u95e8\u6237\u7f51\u7ad9\uff0c\u91cd\u70b9\u662f\u9632\u5165\u4fb5\u3001\u9632\u7be1\u6539\u3001\u9632 DDoS\uff1b</li> <li>\u6838\u5fc3\u4ea4\u6613\u7cfb\u7edf\uff0c\u8981\u4f18\u5148\u4fdd\u969c\u6570\u636e\u4e00\u81f4\u6027\u3001\u4e8b\u52a1\u5b8c\u6574\u6027\u4e0e\u9ad8\u53ef\u7528\uff1b</li> <li>\u5185\u7f51\u6587\u4ef6\u5171\u4eab\u5e73\u53f0\uff0c\u66f4\u5173\u6ce8\u6743\u9650\u8fb9\u754c\u4e0e\u5ba1\u8ba1\u7559\u75d5\u3002</li> </ul> <p>\u4e00\u4e2a\u5408\u7406\u7684\u505a\u6cd5\u662f\uff1a 1. \u68b3\u7406\u4e1a\u52a1\u8d44\u4ea7\uff1a\u7cfb\u7edf\u5217\u8868\u3001\u6570\u636e\u5206\u7c7b\u5206\u7ea7\u3001\u5173\u952e\u94fe\u8def\u4f9d\u8d56\uff1b 2. \u8bc6\u522b\u5a01\u80c1\u4e0e\u98ce\u9669\u70b9\uff1a\u5165\u53e3\u3001\u66b4\u9732\u9762\u3001\u4eba\u4e3a\u64cd\u4f5c\u3001\u7b2c\u4e09\u65b9\u7cfb\u7edf\u7b49\uff1b 3. \u57fa\u4e8e\u98ce\u9669\u5236\u5b9a\u7b56\u7565\uff1a\u8bbf\u95ee\u63a7\u5236\u7b56\u7565\u3001\u7f51\u7edc\u5206\u533a\u7b56\u7565\u3001\u5907\u4efd\u4e0e\u6062\u590d\u7b56\u7565\u3001\u53d8\u66f4\u7b56\u7565\u7b49\u3002</p> <p>\u5b89\u5168\u7b56\u7565\u5e94\u8be5\u662f\u53ef\u843d\u5730\u7684 \u9ad8\u5c42\u539f\u5219\uff0c\u4e3a\u540e\u7eed\u7684\u89c4\u8303\u3001\u5236\u5ea6\u548c\u6280\u672f\u914d\u7f6e\u63d0\u4f9b\u65b9\u5411\u3002</p>"},{"location":"enterprise/enterprise-security-strategy-and-governance.html#2-vs","title":"2. \u6839\u636e\u7b56\u7565\u5236\u5b9a\u89c4\u8303\uff1a\u7cfb\u7edf\u89c4\u8303 vs. \u4eba\u7684\u89c4\u8303","text":"<p>\u5728\u7b56\u7565\u660e\u786e\u4e4b\u540e\uff0c\u9700\u8981\u628a\u5b83\u62c6\u89e3\u6210 \u53ef\u6267\u884c\u7684\u89c4\u8303\u3002\u8fd9\u4e9b\u89c4\u8303\u5927\u81f4\u53ef\u4ee5\u5206\u4e3a\u4e24\u7c7b\uff1a</p> <ol> <li>\u5bf9\u7cfb\u7edf\u7ec4\u4ef6\u7684\u89c4\u8303\uff08\u6280\u672f\u5c42\u9762\uff09</li> <li>\u5bf9\u4eba\u7684\u89c4\u8303\uff08\u884c\u4e3a\u4e0e\u6d41\u7a0b\u5c42\u9762\uff09</li> </ol> <p>\u4ece\u6211\u7684\u7ecf\u9a8c\u6765\u770b\uff0c\u5f88\u591a\u4e25\u91cd\u7684\u5b89\u5168\u95ee\u9898\u5e76\u4e0d\u662f\u6280\u672f\u6808\u591a\u201c\u8001\u65e7\u201d\u9020\u6210\u7684\uff0c\u800c\u662f \u4eba\u7684\u884c\u52a8\u4e0d\u53ef\u9884\u6d4b\u3001\u7f3a\u4e4f\u7ea6\u675f \u5bfc\u81f4\u7684\uff1a</p> <ul> <li>\u4eba\u7684\u9519\u8bef\u884c\u4e3a\u88ab\u89c6\u4e3a\u5bfc\u81f4\u504f\u5dee\u548c\u4e8b\u6545\u7684\u5173\u952e\u539f\u56e0\u4e4b\u4e00\uff1b</li> <li>\u6ca1\u6709\u89c4\u8303\u548c\u57f9\u8bad\uff0c\u518d\u5f3a\u7684\u5b89\u5168\u8bbe\u5907\u4e5f\u53ef\u80fd\u88ab\u201c\u4e00\u6b21\u8bef\u64cd\u4f5c\u201d\u7ed5\u8fc7\u3002</li> </ul>"},{"location":"enterprise/enterprise-security-strategy-and-governance.html#21","title":"2.1 \u7cfb\u7edf\u7ec4\u4ef6\u7684\u89c4\u8303\uff08\u76f8\u5bf9\u5bb9\u6613\u7406\u89e3\uff09","text":"<p>\u7cfb\u7edf\u7ec4\u4ef6\u5c42\u9762\u7684\u89c4\u8303\u901a\u5e38\u662f\u5927\u5bb6\u6bd4\u8f83\u719f\u6089\u7684\u90e8\u5206\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>\u7f51\u7edc\u4e0e\u8bbf\u95ee\u63a7\u5236</li> <li>\u9632\u706b\u5899\u7b56\u7565\uff1a\u53ea\u5f00\u653e\u5fc5\u8981\u7aef\u53e3\u3001\u7f51\u6bb5\u767d\u540d\u5355\u3001\u4e1c\u897f\u5411\u6d41\u91cf\u63a7\u5236\uff1b</li> <li>ACL \u7b56\u7565\uff1a\u5bf9\u4ea4\u6362\u673a\u3001\u8def\u7531\u5668\u3001\u8d1f\u8f7d\u5747\u8861\u8bbe\u5907\u4e0a\u7684\u8bbf\u95ee\u63a7\u5236\u5217\u8868\u8fdb\u884c\u7edf\u4e00\u89c4\u5212\uff1b</li> <li> <p>\u96f6\u4fe1\u4efb\u7406\u5ff5\uff1a\u5185\u90e8\u7f51\u7edc\u4e5f\u8981\u8fdb\u884c\u8eab\u4efd\u8ba4\u8bc1\u4e0e\u8bbf\u95ee\u63a7\u5236\uff0c\u800c\u4e0d\u662f\u201c\u5185\u7f51\u5373\u53ef\u4fe1\u201d\u3002</p> </li> <li> <p>\u8eab\u4efd\u4e0e\u6743\u9650\u7ba1\u7406</p> </li> <li>\u7528\u6237\u89d2\u8272\u5212\u5206\uff1a\u533a\u5206\u7cfb\u7edf\u7ba1\u7406\u5458\u3001\u4e1a\u52a1\u7ba1\u7406\u5458\u3001\u666e\u901a\u7528\u6237\u3001\u5ba1\u8ba1\u5458\u7b49\u89d2\u8272\uff1b</li> <li>\u6700\u5c0f\u6743\u9650\u539f\u5219\uff1a\u6743\u9650\u6309\u201c\u591f\u7528\u5373\u53ef\u201d\u5206\u914d\uff0c\u800c\u4e0d\u662f\u201c\u5148\u7ed9\u5927\u6743\u9650\u518d\u6162\u6162\u6536\u201d\uff1b</li> <li> <p>\u8d26\u53f7\u751f\u547d\u5468\u671f\uff1a\u521b\u5efa\u3001\u53d8\u66f4\u3001\u79bb\u804c\u56de\u6536\u5168\u7a0b\u53ef\u8ffd\u8e2a\u3002</p> </li> <li> <p>\u7cfb\u7edf\u4e0e\u6570\u636e\u5b89\u5168\u914d\u7f6e</p> </li> <li>\u57fa\u7ebf\u52a0\u56fa\uff1a\u64cd\u4f5c\u7cfb\u7edf\u3001\u6570\u636e\u5e93\u3001\u4e2d\u95f4\u4ef6\u6309\u7167\u5b89\u5168\u57fa\u7ebf\u8fdb\u884c\u914d\u7f6e\uff1b</li> <li>\u65e5\u5fd7\u4e0e\u5ba1\u8ba1\uff1a\u5173\u952e\u64cd\u4f5c\u5fc5\u987b\u843d\u65e5\u5fd7\uff0c\u5e76\u4fdd\u8bc1\u65e5\u5fd7\u53ef\u96c6\u4e2d\u5ba1\u8ba1\u4e0e\u957f\u671f\u4fdd\u5b58\uff1b</li> <li>\u5907\u4efd\u4e0e\u52a0\u5bc6\uff1a\u5bf9\u654f\u611f\u6570\u636e\u8fdb\u884c\u5907\u4efd\u4e0e\u52a0\u5bc6\u5b58\u50a8\uff0c\u9632\u6b62\u6cc4\u9732\u4e0e\u8bef\u5220\u3002</li> </ul> <p>\u8fd9\u4e9b\u662f\u76f8\u5bf9\u201c\u6280\u672f\u5316\u201d\u7684\u5185\u5bb9\uff0c\u5b9e\u65bd\u8d77\u6765\u6709\u660e\u786e\u53c2\u8003\u6807\u51c6\u548c\u5de5\u5177\u53ef\u7528\u3002</p>"},{"location":"enterprise/enterprise-security-strategy-and-governance.html#22","title":"2.2 \u5bf9\u4eba\u7684\u89c4\u8303\uff08\u5b89\u5168\u5de5\u4f5c\u7684\u6838\u5fc3\uff09","text":"<p>\u5bf9\u4eba\u7684\u89c4\u8303 \u5f80\u5f80\u88ab\u4f4e\u4f30\uff0c\u4f46\u5b83\u5176\u5b9e\u662f\u7cfb\u7edf\u5b89\u5168\u7684\u6838\u5fc3\u90e8\u5206\u4e4b\u4e00\u3002</p> <p>\u5728\u65e2\u5b9a\u5b89\u5168\u7b56\u7565\u7684\u524d\u63d0\u4e0b\uff0c\u9700\u8981\u4ece\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\u7ba1\u7406\u201c\u4eba\u201d\u7684\u884c\u4e3a\uff1a</p> <ol> <li>\u7528\u6237\u4e0e\u8fd0\u7ef4\u4eba\u5458\u57f9\u8bad</li> <li>\u8ba9\u76f8\u5173\u4eba\u5458\u7406\u89e3\uff1a\u4e3a\u4ec0\u4e48\u8981\u8fd9\u6837\u914d\u7f6e\u3001\u8fd9\u6837\u64cd\u4f5c\uff0c\u5982\u679c\u4e0d\u9075\u5b88\u4f1a\u6709\u4ec0\u4e48\u540e\u679c\uff1b</li> <li> <p>\u5b9a\u671f\u7684\u5b89\u5168\u610f\u8bc6\u57f9\u8bad\uff1a\u9493\u9c7c\u90ae\u4ef6\u3001\u5bc6\u7801\u7ba1\u7406\u3001\u8fdc\u7a0b\u8bbf\u95ee\u3001\u6570\u636e\u4e0b\u8f7d\u7b49\u65e5\u5e38\u573a\u666f\u7684\u98ce\u9669\u63d0\u793a\u3002</p> </li> <li> <p>SOP\uff08Standard Operating Procedure \u6807\u51c6\u4f5c\u4e1a\u7a0b\u5e8f\uff09</p> </li> <li>\u4e3a\u5e38\u89c1\u7684\u64cd\u4f5c\u5efa\u7acb\u6807\u51c6\u6b65\u9aa4\uff0c\u4f8b\u5982\uff1a<ul> <li>\u65b0\u7cfb\u7edf\u4e0a\u7ebf\u6d41\u7a0b\uff1b</li> <li>\u53d8\u66f4\u4e0e\u53d1\u5e03\u6d41\u7a0b\uff1b</li> <li>\u6545\u969c\u5904\u7406\u6d41\u7a0b\uff1b</li> </ul> </li> <li> <p>SOP \u53ef\u4ee5\u5c3d\u91cf\u505a\u5230\u201c\u62ff\u7740\u6587\u6863\u5c31\u80fd\u6309\u6b65\u9aa4\u505a\u201d\uff0c\u51cf\u5c11\u4e2a\u4eba\u7ecf\u9a8c\u5dee\u5f02\u5e26\u6765\u7684\u98ce\u9669\u3002</p> </li> <li> <p>WI\uff08Work Instruction \u4f5c\u4e1a\u6307\u5bfc\u4e66\uff09</p> </li> <li>\u6bd4 SOP \u66f4\u7ec6\u3001\u9762\u5411\u5177\u4f53\u5c97\u4f4d / \u5177\u4f53\u64cd\u4f5c\u7684\u8bf4\u660e\uff1b</li> <li>\u4f8b\u5982\u201c\u5982\u4f55\u5728\u67d0\u67d0\u7cfb\u7edf\u4e0a\u4e3a\u65b0\u5458\u5de5\u5f00\u901a\u8d26\u53f7\u201d\u7684\u8be6\u7ec6\u64cd\u4f5c\u6b65\u9aa4\u4e0e\u622a\u56fe\uff1b</li> <li> <p>\u8ba9\u65b0\u4eba\u5728\u77ed\u65f6\u95f4\u5185\u4e5f\u80fd\u6309\u89c4\u8303\u5b8c\u6210\u5de5\u4f5c\uff0c\u964d\u4f4e\u201c\u62cd\u8111\u888b\u64cd\u4f5c\u201d\u7684\u6982\u7387\u3002</p> </li> <li> <p>\u6743\u9650\u4e0e\u8d23\u4efb\u8fb9\u754c\u7684\u660e\u786e</p> </li> <li>\u8c01\u6709\u6743\u505a\u4ec0\u4e48\u3001\u66f4\u6539\u4ec0\u4e48\u914d\u7f6e\u3001\u67e5\u770b\u4ec0\u4e48\u6570\u636e\uff0c\u6700\u597d\u90fd\u5199\u8fdb\u5236\u5ea6\uff1b</li> <li>\u53d1\u751f\u95ee\u9898\u65f6\u53ef\u4ee5\u5feb\u901f\u8ffd\u6eaf\uff0c\u4e5f\u80fd\u907f\u514d\u201c\u5927\u5bb6\u90fd\u80fd\u6539\uff0c\u51fa\u4e86\u95ee\u9898\u6ca1\u4eba\u8d1f\u8d23\u201d\u7684\u60c5\u51b5\u3002</li> </ol> <p>\u53ef\u4ee5\u8bf4\uff0c\u7cfb\u7edf\u5b89\u5168\u7684\u5f88\u591a\u8584\u5f31\u70b9\uff0c\u90fd\u662f\u56e0\u4e3a\u201c\u4eba\u7684\u89c4\u8303\u201d\u7f3a\u5931\u6216\u6267\u884c\u4e0d\u5230\u4f4d \u5bfc\u81f4\u7684\u3002</p>"},{"location":"enterprise/enterprise-security-strategy-and-governance.html#3","title":"3. \u5b89\u5168\u662f\u4e00\u4e2a\u6301\u7eed\u8fc7\u7a0b\uff1a\u751f\u547d\u5468\u671f\u7ba1\u7406","text":"<p>\u5b89\u5168\u5de5\u4f5c\u4e0d\u662f\u4e00\u6b21\u6027\u9879\u76ee\uff0c\u800c\u662f \u8d2f\u7a7f\u6574\u4e2a\u4e1a\u52a1\u751f\u547d\u5468\u671f \u7684\u957f\u671f\u5de5\u4f5c\u3002</p> <p>\u4ece\u7cfb\u7edf\u7acb\u9879\u3001\u8bbe\u8ba1\u3001\u4e0a\u7ebf\uff0c\u5230\u8fd0\u884c\u3001\u53d8\u66f4\u3001\u4e0b\u7ebf\uff0c\u6bcf\u4e2a\u9636\u6bb5\u90fd\u9700\u8981\u6709\u5bf9\u5e94\u7684\u5b89\u5168\u6d3b\u52a8\uff1a</p> <ol> <li>\u7acb\u9879 / \u9700\u6c42\u9636\u6bb5\uff1a</li> <li>\u8fdb\u884c\u6570\u636e\u5206\u7c7b\u5206\u7ea7\uff0c\u660e\u786e\u5408\u89c4\u8981\u6c42\uff1b</li> <li> <p>\u8bc4\u4f30\u4e1a\u52a1\u5bf9\u5b89\u5168\u6027\u7684\u8981\u6c42\uff08\u4fdd\u5bc6\u6027\u3001\u5b8c\u6574\u6027\u3001\u53ef\u7528\u6027\uff09\u3002</p> </li> <li> <p>\u8bbe\u8ba1 / \u65b9\u6848\u9636\u6bb5\uff1a</p> </li> <li>\u5728\u67b6\u6784\u8bbe\u8ba1\u4e2d\u5c31\u8003\u8651\u7f51\u7edc\u5206\u533a\u3001\u8eab\u4efd\u8ba4\u8bc1\u3001\u6743\u9650\u6a21\u578b\u3001\u65e5\u5fd7\u4f53\u7cfb\uff1b</li> <li> <p>\u8bc4\u5ba1\u7b2c\u4e09\u65b9\u7ec4\u4ef6\u4e0e\u4e91\u670d\u52a1\u7684\u5b89\u5168\u6027\u548c\u5408\u89c4\u6027\u3002</p> </li> <li> <p>\u5efa\u8bbe / \u4e0a\u7ebf\u9636\u6bb5\uff1a</p> </li> <li>\u6309\u7167\u5b89\u5168\u57fa\u7ebf\u8fdb\u884c\u90e8\u7f72\u548c\u914d\u7f6e\uff1b</li> <li> <p>\u5728\u4e0a\u7ebf\u524d\u8fdb\u884c\u5fc5\u8981\u7684\u5b89\u5168\u6d4b\u8bd5\u6216\u6f0f\u6d1e\u626b\u63cf\u3002</p> </li> <li> <p>\u8fd0\u884c / \u8fd0\u7ef4\u9636\u6bb5\uff1a</p> </li> <li>\u65e5\u5e38\u5de1\u68c0\u3001\u65e5\u5fd7\u5ba1\u8ba1\u3001\u544a\u8b66\u5904\u7406\uff1b</li> <li> <p>\u5b9a\u671f\u8fdb\u884c\u6743\u9650\u590d\u6838\u3001\u7b56\u7565\u56de\u987e\u3001\u5e94\u6025\u6f14\u7ec3\u3002</p> </li> <li> <p>\u53d8\u66f4 / \u4e0b\u7ebf\u9636\u6bb5\uff1a</p> </li> <li>\u53d8\u66f4\u524d\u8fdb\u884c\u98ce\u9669\u8bc4\u4f30\u548c\u56de\u6eda\u9884\u6848\u8bbe\u8ba1\uff1b</li> <li>\u7cfb\u7edf\u4e0b\u7ebf\u65f6\u5bf9\u6570\u636e\u8fdb\u884c\u59a5\u5584\u5904\u7406\uff08\u5f52\u6863\u3001\u533f\u540d\u5316\u3001\u9500\u6bc1\u7b49\uff09\uff0c\u56de\u6536\u8d26\u53f7\u4e0e\u6743\u9650\u3002</li> </ol> <p>\u5728\u6574\u4e2a\u751f\u547d\u5468\u671f\u4e2d\uff0c\u8fc7\u7a0b\u7ba1\u7406\u7279\u522b\u5173\u952e\uff1a - \u786e\u4fdd\u8fc7\u7a0b\u6b63\u786e\uff0c\u662f\u786e\u4fdd\u7ed3\u679c\u53ef\u63a7\u3001\u4e00\u81f4\u7684\u91cd\u8981\u524d\u63d0\uff1b - \u5728\u8fc7\u7a0b\u4e2d\u8fdb\u884c\u5468\u671f\u6027\u7684\u68c0\u67e5\u548c\u56de\u987e\uff0c\u624d\u80fd\u53ca\u65f6\u53d1\u73b0\u504f\u5dee\u5e76\u7ea0\u6b63\u3002</p>"},{"location":"enterprise/enterprise-security-strategy-and-governance.html#4","title":"4. \u6211\u7684\u5b9e\u8df5\u6001\u5ea6\u4e0e\u540e\u7eed\u8ba1\u5212","text":"<p>\u4ece\u5b9e\u9645\u5de5\u4f5c\u89c2\u5bdf\u6765\u770b\uff0c\u5927\u90e8\u5206\u516c\u53f8\u5728\u4ee5\u4e0b\u65b9\u9762\u5df2\u7ecf\u505a\u5f97\u76f8\u5bf9\u4e0d\u9519\uff1a</p> <ul> <li>\u80fd\u591f \u5236\u5b9a\u6574\u4f53\u5b89\u5168\u7b56\u7565\uff1b</li> <li>\u80fd\u591f\u4e3a\u7cfb\u7edf\u7ec4\u4ef6\u5236\u5b9a\u4e00\u5b9a\u7a0b\u5ea6\u7684\u6280\u672f\u89c4\u8303\uff08\u9632\u706b\u5899\u3001ACL\u3001\u89d2\u8272\u5212\u5206\u7b49\uff09\u3002</li> </ul> <p>\u5728\u8fd9\u4e9b\u57fa\u7840\u5de5\u4f5c\u4e0a\uff0c\u6211\u4f1a\u91cd\u70b9\u505a\u597d\uff1a</p> <ol> <li>\u8ba4\u771f\u5c65\u884c\u65e2\u5b9a\u7b56\u7565\u4e0e\u89c4\u8303\uff1a</li> <li>\u5728\u65e5\u5e38\u8fd0\u7ef4\u4e2d\u4e25\u683c\u6267\u884c\u65e2\u5b9a\u5b89\u5168\u7b56\u7565\u548c\u7cfb\u7edf\u914d\u7f6e\u8981\u6c42\uff1b</li> <li> <p>\u505a\u597d\u5468\u671f\u6027\u68c0\u67e5\u548c\u56de\u987e\uff0c\u6839\u636e\u7cfb\u7edf\u53d8\u5316\u53ca\u65f6\u8c03\u6574\u4e0e\u5b8c\u5584\u7ec6\u8282\u3002</p> </li> <li> <p>\u52a0\u5f3a\u5bf9\u4eba\u7684\u7ba1\u7406\u4e0e\u652f\u6491\uff1a</p> </li> <li>\u6211\u8ba4\u4e3a\u201c\u5bf9\u4eba\u7684\u89c4\u8303\u201d\u662f\u7cfb\u7edf\u5b89\u5168\u7684\u6838\u5fc3\u4e4b\u4e00\uff1b</li> <li> <p>\u5728\u719f\u6089\u7cfb\u7edf\u4e00\u6bb5\u65f6\u95f4\u540e\uff0c\u6211\u4f1a\u9010\u6b65\u8865\u5145\u5e76\u5b8c\u5584\uff1a</p> <ul> <li>\u7528\u6237\u53ca\u8fd0\u7ef4\u4eba\u5458\u7684\u5b89\u5168\u57f9\u8bad\u5185\u5bb9\uff1b</li> <li>\u9488\u5bf9\u5173\u952e\u64cd\u4f5c\u7684 SOP \u548c WI \u6587\u6863\uff1b</li> <li>\u5e38\u89c1\u95ee\u9898\u548c\u98ce\u9669\u573a\u666f\u7684\u64cd\u4f5c\u6307\u5357\u3002</li> </ul> </li> <li> <p>\u63a8\u52a8\u5b89\u5168\u4e0e\u4e1a\u52a1\u7684\u826f\u6027\u5faa\u73af\uff1a</p> </li> <li>\u901a\u8fc7\u6587\u6863\u5316\u3001\u6807\u51c6\u5316\uff0c\u8ba9\u5b89\u5168\u8981\u6c42\u66f4\u5bb9\u6613\u88ab\u6267\u884c\uff1b</li> <li>\u901a\u8fc7\u5468\u671f\u6027\u56de\u987e\uff0c\u628a\u7ebf\u4e0a\u5b9e\u9645\u60c5\u51b5\u53cd\u9988\u5230\u7b56\u7565\u548c\u89c4\u8303\u4e2d\u53bb\uff1b</li> <li>\u6700\u7ec8\u8ba9\u5b89\u5168\u5de5\u4f5c\u4e0d\u53ea\u662f\u201c\u7ba1\u63a7\u201d\uff0c\u800c\u662f\u4e1a\u52a1\u7a33\u5b9a\u8fd0\u884c\u7684\u57fa\u7840\u8bbe\u65bd\u3002</li> </ol> <p>\u4ece\u7b56\u7565\u3001\u89c4\u8303\u5230\u751f\u547d\u5468\u671f\u7ba1\u7406\uff0c\u7cfb\u7edf\u5b89\u5168\u672c\u8d28\u4e0a\u662f\u4e00\u9879 \u6301\u7eed\u7684\u7ba1\u7406\u5de5\u7a0b\u3002\u6280\u672f\u63aa\u65bd\u56fa\u7136\u91cd\u8981\uff0c\u4f46\u5982\u679c\u6ca1\u6709\u5bf9\u4eba\u7684\u7ea6\u675f\u3001\u57f9\u8bad\u548c\u5f15\u5bfc\uff0c\u5b89\u5168\u4f53\u7cfb\u5c31\u96be\u4ee5\u843d\u5730\u3002\u53ea\u6709\u628a\u201c\u6280\u672f + \u5236\u5ea6 + \u4eba\u201d\u7ed3\u5408\u8d77\u6765\uff0c\u5b89\u5168\u5de5\u4f5c\u624d\u80fd\u771f\u6b63\u878d\u5165\u4e1a\u52a1\uff0c\u800c\u4e0d\u662f\u6e38\u79bb\u5728\u4e1a\u52a1\u4e4b\u5916\u3002</p>"},{"location":"enterprise/netbackup-data-domain-quantum-guide.html","title":"\u4f01\u4e1a\u5907\u4efd\u4e0e\u5bb9\u707e\uff1aVeritas NetBackup + Data Domain + Quantum \u5b9e\u6218","text":"<p>\u672c\u6587\u7b80\u4ecb\u4f01\u4e1a\u7ea7\u5907\u4efd/\u5bb9\u707e\u4f53\u7cfb\uff0c\u57fa\u4e8e Veritas NetBackup\uff08NBU\uff09\u4e3a\u6838\u5fc3\u8c03\u5ea6\uff0c\u96c6\u6210 Dell EMC Data Domain\uff08DD Boost/OST\uff09\u4f5c\u4e3a\u78c1\u76d8\u5f52\u6863\u6c60\uff0c\u5e76\u5f15\u5165 Quantum Scalar \u78c1\u5e26\u5e93\u7528\u4e8e\u957f\u671f\u79bb\u7ebf\u5f52\u6863\uff0c\u7ed9\u51fa\u5173\u952e\u6982\u5ff5\u3001\u90e8\u7f72\u6b65\u9aa4\u4e0e\u547d\u4ee4\u793a\u4f8b\u3002</p>"},{"location":"enterprise/netbackup-data-domain-quantum-guide.html#1","title":"1. \u67b6\u6784\u4e0e\u89d2\u8272","text":"<ul> <li>NBU Master Server\uff1a\u76ee\u5f55/\u7b56\u7565/\u8c03\u5ea6/\u5143\u6570\u636e\uff08EMM\uff09</li> <li>NBU Media Server\uff1a\u6570\u636e\u4f20\u8f93\u4e0e\u5b58\u50a8\u7ba1\u7406\uff08\u8fde\u63a5 DD \u4e0e\u78c1\u5e26\uff09</li> <li>Clients\uff1a\u4e1a\u52a1\u4e3b\u673a\uff08\u6570\u636e\u5e93/\u6587\u4ef6/\u865a\u62df\u5316\uff09</li> <li>\u5b58\u50a8\uff1a</li> <li>Data Domain\uff1a\u4f5c\u4e3a OST \u5b58\u50a8\u670d\u52a1\u5668\uff08DD Boost\uff09\uff0c\u9ad8\u53bb\u91cd\u541e\u5410</li> <li>Quantum Scalar\uff08\u6216 DXi\uff09\uff1a\u4f5c\u4e3a\u78c1\u5e26\u673a\u5668\u4eba\uff08TLD\uff09\uff0c\u957f\u671f\u4fdd\u7559\u4e0e\u79bb\u7ebf</li> <li>\u5efa\u8bae\uff1a</li> <li>\u4f7f\u7528 SLP\uff08Storage Lifecycle Policy\uff09\u5b9e\u73b0\u201c\u5148\u843d DD\u2192\u5468\u671f\u6027\u590d\u5236\u5230\u5e26\u5e93\u201d</li> <li>\u5907\u4efd\u7f51\u4e0e\u4e1a\u52a1\u7f51\u5206\u79bb\uff0c\u4f7f\u7528\u5e76\u884c\u6d41\u63d0\u5347\u541e\u5410</li> </ul>"},{"location":"enterprise/netbackup-data-domain-quantum-guide.html#2","title":"2. \u5b89\u88c5\u4e0e\u524d\u7f6e","text":"<ul> <li>\u7aef\u53e3\uff1a\u786e\u4fdd PBX(1556)\u3001vnetd(13724)\u3001bpcd(13782) \u7b49\u8fde\u901a</li> <li>\u5b89\u88c5 NBU Master/Media\uff08\u7565\uff0c\u53c2\u8003\u5b98\u65b9\u6307\u5357\uff09\uff1b\u914d\u7f6e\u57df\u540d\u89e3\u6790\u4e0e\u65f6\u95f4\u540c\u6b65</li> <li>\u5728 Media Server \u5b89\u88c5 OST \u63d2\u4ef6\uff08DD Boost \u63d2\u4ef6\uff09\uff1a</li> </ul> <pre><code># \u4ee5 RHEL \u4e3a\u4f8b\nrpm -ivh VRTSdd*.rpm    # \u4ece Veritas \u4e0b\u8f7d\u5339\u914d\u7248\u672c\nnbdevquery -liststs     # \u9a8c\u8bc1 OST \u6846\u67b6\u53ef\u7528\n</code></pre>"},{"location":"enterprise/netbackup-data-domain-quantum-guide.html#3-data-domaindd-boost","title":"3. \u914d\u7f6e Data Domain\uff08DD Boost\uff09","text":"<p>\u5728 Data Domain CLI\uff1a</p> <pre><code># \u767b\u5f55\nessh sysadmin@&lt;dd-ip&gt;\n# \u542f\u7528 ddboost \u5e76\u521b\u5efa\u7528\u6237\nddboost enable\nuser add &lt;nbu-user&gt; role admin password ****\n# \u521b\u5efa\u5b58\u50a8\u5355\u5143\uff08\u53ef\u6309\u4e1a\u52a1\u5212\u5206\uff09\nddboost storage-unit create su_nbu_prod user &lt;nbu-user&gt;\n# \uff08\u53ef\u9009\uff09\u542f\u7528\u5206\u5e03\u5f0f\u5206\u6bb5\u4e0e\u538b\u7f29\nddboost option set distributed-segment yes\n</code></pre> <p>\u5728 NetBackup \u4fa7\uff08Master/Media\uff09\uff1a</p> <pre><code># \u6ce8\u518c Data Domain \u4e3a\u5b58\u50a8\u670d\u52a1\u5668\uff08Storage Server\uff09\nnbdevconfig -creatests -storage_server &lt;dd-fqdn&gt; -stype DataDomain -stype_options server=&lt;dd-fqdn&gt;,mode=advanced\n# \u521b\u5efa\u78c1\u76d8\u6c60\uff08Disk Pool\uff09\nnbdevconfig -createdp -stype DataDomain -storage_server &lt;dd-fqdn&gt; -dp DD_DP_Prod -sts su_nbu_prod\n# \u521b\u5efa\u5b58\u50a8\u5355\u5143\uff08Storage Unit\uff09\nbrmservers -addmedia &lt;media-fqdn&gt;\nnbstlutil list -U\n</code></pre> <p>\u6216\u4f7f\u7528 Java GUI\uff1aMedia and Device Management \u2192 Configure Disk Storage Servers\uff08OST\uff09\u3002</p>"},{"location":"enterprise/netbackup-data-domain-quantum-guide.html#4-quantum-scalar","title":"4. \u914d\u7f6e Quantum \u78c1\u5e26\u5e93\uff08Scalar\uff09","text":"<pre><code># \u8bc6\u522b\u673a\u5668\u4eba\u4e0e\u9a71\u52a8\u5668\uff08\u793a\u4f8b\u547d\u4ee4\uff0c\u56e0 HBA/OS \u800c\u5f02\uff09\nsg_map -i | egrep -i 'changer|tape'\n# \u5728 NBU \u4e2d\u6dfb\u52a0\u673a\u5668\u4eba\u4e0e\u9a71\u52a8\u5668\ntpconfig -add -robot_type tld -robot_number 0 -robothost &lt;media-fqdn&gt; -tsdpath /dev/sgX\n# \u53d1\u73b0\u9a71\u52a8\u5668\u5e76\u751f\u6210\u8bbe\u5907\u6570\u636e\u5e93\nvmupdate -rt tld -rn 0 -rh &lt;master-fqdn&gt; -rescan\n# \u5e93\u76d8\u4f4d\u6761\u76ee\u66f4\u65b0\ntownet -standalone\n</code></pre> <p>\u5efa\u8bae\u5728\u5e93\u4fa7\u542f\u7528\u6761\u7801\u4e0e\u5206\u533a\uff0c\u6e05\u6d01\u76d8\u4f4d\u914d\u7f6e\uff1b\u5c06\u6e05\u6d01\u4efb\u52a1\u4ea4\u7531 NBU \u7ba1\u7406\u3002</p>"},{"location":"enterprise/netbackup-data-domain-quantum-guide.html#5-slp","title":"5. \u7b56\u7565\u4e0e SLP\uff08\u793a\u4f8b\uff09","text":"<ul> <li>\u7b56\u7565\uff1a\u6587\u4ef6\u7cfb\u7edf\u5168\u91cf/\u589e\u91cf\u3001\u6570\u636e\u5e93\u70ed\u5907\u3001\u865a\u62df\u5316\u4ee3\u7406\uff08vSphere/Hyper-V\uff09</li> <li>\u793a\u4f8b\uff1a\u6587\u4ef6\u5907\u4efd\u7b56\u7565\uff08CLI\uff09</li> </ul> <pre><code># \u65b0\u5efa\u7b56\u7565\necho \"NEW\" | bpplnew FS_Prod -v -M &lt;master&gt;\n# \u9009\u62e9\u5907\u4efd\u5ba2\u6237\u7aef\nbpclient -add -client &lt;client1&gt; -no_hostname_alias\n# \u5907\u4efd\u8def\u5f84\nbpplinclude FS_Prod -add /var/www\nbpplinclude FS_Prod -add /etc\n# \u8c03\u5ea6\uff1a\u5468\u65e5\u5168\u91cf\u3001\u5de5\u4f5c\u65e5\u589e\u91cf\nbpplsched FS_Prod -add Full -st FULL -freq 604800 -maxmpx 4 -residence Any\nbpplsched FS_Prod -add Incr -st INCR -freq 86400 -maxmpx 4 -residence Any\n</code></pre> <ul> <li>SLP\uff1a</li> </ul> <pre><code># \u521b\u5efa SLP\uff1a\u843d\u76d8\u5230 DD\uff0c7 \u5929\u540e\u590d\u5236\u5230\u5e26\u5e93\u3001\u4fdd\u7559 12 \u4e2a\u6708\nnbstl FS2Tape -add_version\nnbstl FS2Tape -add_primary_operation Backup -storage DD_STU -retention 1w\nnbstl FS2Tape -add_secondary_operation Duplication -storage TAPE_STU -retention 12m -start_window 22:00-06:00\nnbstl FS2Tape -active 1\n</code></pre>"},{"location":"enterprise/netbackup-data-domain-quantum-guide.html#6","title":"6. \u9a8c\u8bc1\u4e0e\u6392\u9519","text":"<pre><code># \u8fde\u901a\u6027\u4e0e\u8bc1\u4e66\nbptestbpcd -client &lt;client&gt;\nbptestnetconn -host &lt;media-fqdn&gt;\n\n# \u4f5c\u4e1a\u72b6\u6001\ntphoenix -status | head\nbpdbjobs -summary\n\n# OST \u5b58\u50a8\nnbdevquery -liststs -U\nnbdevquery -listdv -stype DataDomain -U\n\n# \u65e5\u5fd7\u4e0e\u9519\u8bef\nbperror -problems -hours 4\n</code></pre>"},{"location":"enterprise/netbackup-data-domain-quantum-guide.html#7","title":"7. \u6700\u4f73\u5b9e\u8df5","text":"<ul> <li>\u5907\u4efd\u7f51\uff1a\u72ec\u7acb VLAN \u4e0e\u4e07\u5146\u94fe\u8def\uff1b\u542f\u7528\u5e76\u53d1\u6570\u636e\u6d41\uff08\u591a\u6570\u636e\u6d41\uff09</li> <li>\u5ba2\u6237\u7aef\u4e0e\u7b56\u7565\uff1a\u6309\u4e1a\u52a1\u4e0e RPO/RTO \u5206\u5c42\uff1b\u6570\u636e\u5e93\u4f7f\u7528\u539f\u5382\u4ee3\u7406/\u5728\u7ebf\u70ed\u5907</li> <li>\u53bb\u91cd\u4e0e\u52a0\u5bc6\uff1a\u5728 DD \u4fa7\u5f00\u542f\u538b\u7f29/\u52a0\u5bc6\uff1b\u5728 NBU \u4e2d\u8bbe\u7f6e\u5ba2\u6237\u7aef/\u4f20\u8f93\u52a0\u5bc6</li> <li>SLP\uff1a\u5408\u7406\u7a97\u53e3\uff0c\u907f\u514d\u5e26\u5e93/\u7f51\u7edc\u62e5\u585e\uff1b\u5b9a\u671f\u505a\u6062\u590d\u6f14\u7ec3</li> <li>\u76d1\u63a7\uff1aNBU \u4f5c\u4e1a\u544a\u8b66\u3001DD \u5bb9\u91cf\u544a\u8b66\u3001\u5e26\u5e93\u4ecb\u8d28\u5065\u5eb7\uff08\u6e05\u6d01/\u5bff\u547d\uff09</li> </ul>"},{"location":"enterprise/prometheus-grafana-monitoring-for-enterprise.html","title":"Prometheus + Grafana \u76d1\u63a7\u4f53\u7cfb\uff08\u7ed3\u5408 Ansible \u7684\u4f01\u4e1a\u843d\u5730\uff09","text":"<p>\u672c\u6587\u5728\u201cAnsible \u4f01\u4e1a\u5b9e\u6218\u201d\u540c\u4e00\u865a\u62df\u4f01\u4e1a\u573a\u666f\u4e0b\uff0c\u6784\u5efa\u4e00\u5957\u901a\u7528\u7684\u6307\u6807\u76d1\u63a7\u4e0e\u544a\u8b66\u4f53\u7cfb\uff1aPrometheus + Alertmanager + Grafana\uff0c\u5e76\u901a\u8fc7 Ansible \u81ea\u52a8\u5316\u5b8c\u6210\u5b89\u88c5\u4e0e\u914d\u7f6e\uff0c\u8986\u76d6 Exporter \u90e8\u7f72\u3001\u91c7\u96c6\u4e0e\u89c4\u5219\u3001\u4eea\u8868\u677f\u4e0e\u544a\u8b66\u8054\u52a8\u3002</p>"},{"location":"enterprise/prometheus-grafana-monitoring-for-enterprise.html#1","title":"1. \u76ee\u6807\u4e0e\u8303\u56f4","text":"<ul> <li>\u76ee\u6807\uff1a\u7edf\u4e00\u91c7\u96c6\u7cfb\u7edf\u6307\u6807\u3001\u670d\u52a1\u53ef\u7528\u6027\u4e0e\u4e1a\u52a1\u63a2\u6d3b\uff0c\u96c6\u4e2d\u5c55\u793a\u5e76\u544a\u8b66</li> <li>\u7ec4\u4ef6\uff1a</li> <li>Node Exporter\uff08\u4e3b\u673a\u6307\u6807\uff09</li> <li>Blackbox Exporter\uff08HTTP/TCP/ICMP \u63a2\u6d4b\uff09</li> <li>Prometheus Server\uff08\u6293\u53d6\u4e0e\u89c4\u5219/\u8bb0\u5f55/\u544a\u8b66\uff09</li> <li>Alertmanager\uff08\u8def\u7531\u4e0e\u901a\u77e5\uff09</li> <li>Grafana\uff08\u53ef\u89c6\u5316\u4e0e\u770b\u677f\uff09</li> <li>\u539f\u5219\uff1a\u4ee5 Ansible \u89d2\u8272\u6279\u91cf\u90e8\u7f72\uff0c\u5e42\u7b49\u3001\u81ea\u63cf\u8ff0\u3001\u53ef\u56de\u6eda</li> </ul>"},{"location":"enterprise/prometheus-grafana-monitoring-for-enterprise.html#2-ansible","title":"2. Ansible \u89d2\u8272\u7ed3\u6784\uff08\u793a\u4f8b\uff09","text":"<pre><code>roles/\n\u251c\u2500 exporters_node/\n\u2502  \u2514\u2500 tasks/main.yml  # \u5b89\u88c5 Node Exporter\n\u251c\u2500 exporters_blackbox/\n\u2502  \u2514\u2500 tasks/main.yml  # \u5b89\u88c5 Blackbox Exporter\n\u251c\u2500 prometheus_server/\n\u2502  \u251c\u2500 tasks/main.yml\n\u2502  \u2514\u2500 templates/{prometheus.yml.j2, rules.yml.j2}\n\u251c\u2500 alertmanager/\n\u2502  \u251c\u2500 tasks/main.yml\n\u2502  \u2514\u2500 templates/alertmanager.yml.j2\n\u2514\u2500 grafana/\n   \u2514\u2500 tasks/main.yml\n</code></pre>"},{"location":"enterprise/prometheus-grafana-monitoring-for-enterprise.html#3-exporter","title":"3. Exporter \u90e8\u7f72\uff08\u7247\u6bb5\uff09","text":"<p>Node Exporter\uff08roles/exporters_node/tasks/main.yml\uff09\uff1a</p> <pre><code>- name: \u5b89\u88c5 node_exporter\n  ansible.builtin.unarchive:\n    src: https://github.com/prometheus/node_exporter/releases/download/v1.8.1/node_exporter-1.8.1.linux-amd64.tar.gz\n    dest: /opt/\n    remote_src: yes\n- name: systemd unit\n  ansible.builtin.copy:\n    dest: /etc/systemd/system/node_exporter.service\n    content: |\n      [Unit]\n      Description=Node Exporter\n      [Service]\n      ExecStart=/opt/node_exporter-1.8.1.linux-amd64/node_exporter\n      [Install]\n      WantedBy=multi-user.target\n- ansible.builtin.systemd:\n    name: node_exporter\n    state: started\n    enabled: true\n</code></pre> <p>Blackbox Exporter\uff08roles/exporters_blackbox/tasks/main.yml\uff09\uff1a</p> <pre><code>- name: \u5b89\u88c5 blackbox_exporter\n  ansible.builtin.unarchive:\n    src: https://github.com/prometheus/blackbox_exporter/releases/download/v0.25.0/blackbox_exporter-0.25.0.linux-amd64.tar.gz\n    dest: /opt/\n    remote_src: yes\n- name: systemd\n  ansible.builtin.copy:\n    dest: /etc/systemd/system/blackbox_exporter.service\n    content: |\n      [Unit]\n      Description=Blackbox Exporter\n      [Service]\n      ExecStart=/opt/blackbox_exporter-0.25.0.linux-amd64/blackbox_exporter --config.file=/opt/blackbox.yml\n      [Install]\n      WantedBy=multi-user.target\n- name: \u914d\u7f6e\u9ed1\u76d2\u6a21\u5757\n  ansible.builtin.copy:\n    dest: /opt/blackbox.yml\n    content: |\n      modules:\n        http_2xx:\n          prober: http\n          timeout: 5s\n- ansible.builtin.systemd:\n    name: blackbox_exporter\n    state: started\n    enabled: true\n</code></pre>"},{"location":"enterprise/prometheus-grafana-monitoring-for-enterprise.html#4-prometheus-server","title":"4. Prometheus Server \u4e0e\u89c4\u5219","text":"<p>roles/prometheus_server/templates/prometheus.yml.j2\uff1a</p> <pre><code>global:\n  scrape_interval: 15s\nscrape_configs:\n  - job_name: 'nodes'\n    static_configs:\n      - targets: {{ groups['all'] | map('extract', hostvars, ['ansible_host']) | list | to_nice_json }}\n  - job_name: 'blackbox'\n    metrics_path: /probe\n    params:\n      module: [http_2xx]\n    static_configs:\n      - targets: ['https://www.example.com','http://10.10.10.11']\n    relabel_configs:\n      - source_labels: [__address__]\n        target_label: __param_target\n      - target_label: __address__\n        replacement: 127.0.0.1:9115\n</code></pre> <p>rules.yml.j2\uff08\u8bb0\u5f55\u4e0e\u544a\u8b66\u7247\u6bb5\uff09\uff1a</p> <pre><code>groups:\n- name: host.rules\n  rules:\n  - record: node:cpu_util:avg5m\n    expr: avg by(instance) (rate(node_cpu_seconds_total{mode!=\"idle\"}[5m]))\n  - alert: HostHighCPU\n    expr: node:cpu_util:avg5m &gt; 0.8\n    for: 10m\n    labels: {severity: warning}\n    annotations:\n      summary: \"\u9ad8 CPU \u5360\u7528 {{ $labels.instance }}\"\n</code></pre> <p>roles/prometheus_server/tasks/main.yml\uff1a</p> <pre><code>- name: \u521b\u5efa\u76ee\u5f55\n  ansible.builtin.file: { path: /etc/prometheus, state: directory }\n- name: \u90e8\u7f72\u914d\u7f6e\n  ansible.builtin.template: { src: prometheus.yml.j2, dest: /etc/prometheus/prometheus.yml }\n- name: \u90e8\u7f72\u89c4\u5219\n  ansible.builtin.template: { src: rules.yml.j2, dest: /etc/prometheus/rules.yml }\n- name: \u90e8\u7f72\u4e8c\u8fdb\u5236\uff08\u7565\uff1a\u540c exporter \u4e0b\u8f7d\u89e3\u538b\uff09\n- name: systemd unit\n  ansible.builtin.copy:\n    dest: /etc/systemd/system/prometheus.service\n    content: |\n      [Unit]\n      Description=Prometheus\n      [Service]\n      ExecStart=/opt/prometheus/prometheus --config.file=/etc/prometheus/prometheus.yml --web.enable-lifecycle\n      [Install]\n      WantedBy=multi-user.target\n- ansible.builtin.systemd: { name: prometheus, state: started, enabled: true }\n</code></pre>"},{"location":"enterprise/prometheus-grafana-monitoring-for-enterprise.html#5-alertmanager","title":"5. Alertmanager \u4e0e\u901a\u77e5","text":"<p>roles/alertmanager/templates/alertmanager.yml.j2\uff1a</p> <pre><code>route:\n  receiver: default\nreceivers:\n- name: default\n  email_configs:\n  - to: ops@example.com\n    from: monitor@example.com\n    smarthost: smtp.example.com:25\n</code></pre> <p>roles/alertmanager/tasks/main.yml\uff1a</p> <pre><code>- name: \u5b89\u88c5\u5e76\u914d\u7f6e alertmanager\uff08\u540c prometheus \u7565\uff09\n- name: systemd \u542f\u52a8\n  ansible.builtin.systemd: { name: alertmanager, state: started, enabled: true }\n</code></pre>"},{"location":"enterprise/prometheus-grafana-monitoring-for-enterprise.html#6-grafana","title":"6. Grafana \u90e8\u7f72","text":"<p>\u7b80\u6613\u6cd5\uff08Docker\uff09\uff1a</p> <pre><code>docker run -d --name=grafana -p 3000:3000 grafana/grafana:10.4.1\n</code></pre> <p>\u6216\u4f7f\u7528\u5305\u7ba1\u7406\u5668\uff1a</p> <pre><code># Debian/Ubuntu \u793a\u4f8b\nsudo apt-get install -y adduser libfontconfig1\nwget https://dl.grafana.com/oss/release/grafana_10.4.1_amd64.deb\nsudo dpkg -i grafana_10.4.1_amd64.deb\nsudo systemctl enable --now grafana-server\n</code></pre> <p>\u6570\u636e\u6e90\u914d\u7f6e\uff08Grafana UI \u6216 Provisioning\uff09\uff1a</p> <pre><code>apiVersion: 1\ndatasources:\n- name: Prometheus\n  type: prometheus\n  url: http://prometheus:9090\n  access: proxy\n  isDefault: true\n</code></pre> <p>\u5bfc\u5165\u5e38\u7528\u770b\u677f\uff1aNode Exporter Full\uff08ID: 1860\uff09\u7b49\u3002</p>"},{"location":"enterprise/prometheus-grafana-monitoring-for-enterprise.html#7","title":"7. \u6821\u9a8c\u4e0e\u8fd0\u7ef4","text":"<pre><code># Prometheus \u914d\u7f6e\u70ed\u52a0\u8f7d\ncurl -X POST http://localhost:9090/-/reload\n# \u89c4\u5219\u68c0\u67e5\npromtool check rules /etc/prometheus/rules.yml\n# Exporter/\u6307\u6807\u63a2\u67e5\ncurl -s localhost:9100/metrics | head\ncurl -s \"localhost:9115/probe?module=http_2xx&amp;target=http://10.10.10.11\" | head\n</code></pre>"},{"location":"enterprise/prometheus-grafana-monitoring-for-enterprise.html#8-ansible","title":"8. \u4e0e Ansible \u7684\u4e00\u81f4\u6027","text":"<ul> <li>\u4f7f\u7528\u540c\u4e00 inventory \u4e0e\u5206\u7ec4\uff1b\u5c06\u4e1a\u52a1\u4e3b\u673a\u81ea\u52a8\u7eb3\u5165\u6293\u53d6\u76ee\u6807</li> <li>\u4ee5\u89d2\u8272\u65b9\u5f0f\u7ba1\u7406\u914d\u7f6e\uff0c\u652f\u6301\u591a\u73af\u5883\uff08prod/dev\uff09\u4e0e\u5e42\u7b49</li> <li>\u7ed3\u5408\u53d8\u66f4\u7a97\u53e3\u4e0e --limit/--tags \u505a\u9010\u6b65\u53d1\u5e03\u4e0e\u56de\u6eda</li> <li>\u5c06\u76d1\u63a7\u4f5c\u4e3a\u53d1\u5e03\u6d41\u6c34\u7ebf\u7684\u9a8c\u6536\u6b65\u9aa4\u4e4b\u4e00\uff08\u53ef\u81ea\u52a8\u5316\u63a2\u6d4b\u4e0e\u544a\u8b66\u6291\u5236\uff09</li> </ul>"},{"location":"enterprise/server-oob-management-guide.html","title":"\u670d\u52a1\u5668\u5e26\u5916\u7ba1\u7406\uff08OOB\uff09\u6982\u89c8\u4e0e\u5b9e\u8df5\uff1aIPMI / iDRAC / iLO / Redfish","text":"<p>\u672c\u6587\u9762\u5411\u4f01\u4e1a IT/\u6570\u636e\u4e2d\u5fc3\u8fd0\u7ef4\uff0c\u7cfb\u7edf\u68b3\u7406\u670d\u52a1\u5668\u201c\u5e26\u5916\u7ba1\u7406\u201d\uff08Out-of-Band Management, OOBM\uff09\u7684\u6982\u5ff5\u3001\u4e3b\u6d41\u6280\u672f\u4e0e\u786c\u4ef6\u9009\u578b\uff0c\u5e76\u4ee5\u5e38\u89c1\u7684 Dell iDRAC \u4e0e\u901a\u7528 IPMI/Redfish \u4e3a\u4f8b\uff0c\u7ed9\u51fa\u53ef\u64cd\u4f5c\u7684\u4f7f\u7528\u65b9\u6cd5\u3001\u547d\u4ee4\u793a\u4f8b\u4e0e\u6700\u4f73\u5b9e\u8df5\u3002</p>"},{"location":"enterprise/server-oob-management-guide.html#1-oob","title":"1. \u4ec0\u4e48\u662f\u5e26\u5916\u7ba1\u7406\uff08OOB\uff09","text":"<ul> <li>\u5e26\u5916\uff08Out-of-Band\uff09\uff1a\u72ec\u7acb\u4e8e\u4e1a\u52a1\u64cd\u4f5c\u7cfb\u7edf\u548c\u4e1a\u52a1\u7f51\u7edc\u7684\u201c\u7ba1\u7406\u901a\u9053\u201d\u3002\u5373\u4f7f\u670d\u52a1\u5668\u5173\u673a\u3001\u7cfb\u7edf\u635f\u574f\u3001\u84dd\u5c4f\u6216\u65e0\u7f51\u5361\u9a71\u52a8\uff0c\u4ecd\u53ef\u901a\u8fc7 OOB \u8fdb\u884c\u7535\u6e90\u63a7\u5236\u3001KVM \u8fdc\u7a0b\u63a7\u5236\u53f0\u3001\u865a\u62df\u4ecb\u8d28\u6302\u8f7d\u3001\u786c\u4ef6\u4f20\u611f\u5668\u76d1\u63a7\u3001\u65e5\u5fd7\u4e0e\u56fa\u4ef6\u7ef4\u62a4\u3002</li> <li>\u5b9e\u73b0\u6838\u5fc3\uff1aBMC\uff08Baseboard Management Controller\uff0c\u4e3b\u677f\u4e0a\u7684\u72ec\u7acb\u7ba1\u7406\u63a7\u5236\u5668\uff09\uff0c\u914d\u5408\u4e13\u7528/\u5171\u4eab\u7684\u7ba1\u7406\u7f51\u53e3\u4e0e\u7ba1\u7406\u56fa\u4ef6\u3002</li> <li>\u5e38\u89c1\u80fd\u529b</li> <li>\u8fdc\u7a0b\u7535\u6e90\uff1a\u5f00/\u5173/\u91cd\u542f/\u8f6f\u5173\u673a</li> <li>\u8fdc\u7a0b\u63a7\u5236\u53f0\uff1aKVM over IP\uff08HTML5/Java\uff09\uff0c\u53ef\u8fdb BIOS\u3001\u67e5\u770b POST \u65e5\u5fd7</li> <li>\u865a\u62df\u4ecb\u8d28\uff1a\u4ece\u8fdc\u7a0b ISO/\u955c\u50cf\u542f\u52a8\u5b89\u88c5\u7cfb\u7edf</li> <li>\u4f20\u611f\u5668/\u65e5\u5fd7\uff1a\u6e29\u5ea6\u3001\u7535\u538b\u3001\u98ce\u6247\u3001SEL \u4e8b\u4ef6\u65e5\u5fd7</li> <li>\u56fa\u4ef6\u4e0e\u914d\u7f6e\uff1a\u5347\u7ea7 BIOS/BMC\u3001\u8bbe\u7f6e\u5f15\u5bfc\u987a\u5e8f\u3001\u8d44\u4ea7\u4fe1\u606f\uff08FRU\uff09</li> </ul>"},{"location":"enterprise/server-oob-management-guide.html#2","title":"2. \u4e3b\u6d41\u6280\u672f\u4e0e\u751f\u6001","text":"<ul> <li>IPMI\uff08Intelligent Platform Management Interface\uff09</li> <li>\u5386\u53f2\u6700\u4e45\u7684\u5e26\u5916\u6807\u51c6\uff0c\u547d\u4ee4\u884c\u5de5\u5177 <code>ipmitool</code> \u5e7f\u6cdb\u53ef\u7528\uff1b\u901a\u8fc7 LAN/LANPlus \u6267\u884c\u7535\u6e90/\u4f20\u611f\u5668/\u65e5\u5fd7\u64cd\u4f5c\u3002</li> <li>\u5c40\u9650\uff1a\u5b89\u5168\u6027\u4e0e\u73b0\u4ee3\u5316\u4e0d\u8db3\uff08\u90e8\u5206\u5b9e\u73b0\u9ed8\u8ba4\u5f31\u7b97\u6cd5/\u5f31\u52a0\u5bc6\uff09\uff1b\u9010\u6b65\u88ab Redfish \u66ff\u4ee3\u3002</li> <li>Redfish\uff08DMTF \u6807\u51c6\uff09</li> <li>\u57fa\u4e8e HTTPS/JSON \u7684\u73b0\u4ee3\u63a5\u53e3\uff0c\u6a21\u578b\u6e05\u6670\uff0c\u6613\u96c6\u6210 DevOps\uff08Ansible\u3001Python\u3001Terraform \u63d2\u4ef6\u7b49\uff09\u3002</li> <li>\u4f9b\u5e94\u5546\u5b9e\u73b0\u5e7f\u6cdb\uff1aDell iDRAC\u3001HPE iLO\u3001Lenovo XCC\u3001Supermicro\u3001OpenBMC \u7b49\u3002</li> <li>\u5382\u5546\u5b9e\u73b0\uff08BMC \u54c1\u724c\uff09</li> <li>Dell iDRAC\uff08\u5f53\u524d\u4e3b\u6d41 iDRAC9/10\uff09</li> <li>HPE iLO\uff08iLO 5/6\uff09</li> <li>Lenovo XCC/IMM\u3001Supermicro IPMI\u3001Cisco CIMC\u3001Huawei iBMC \u7b49</li> <li>Intel AMT/vPro\uff08\u66f4\u591a\u7528\u4e8e PC/\u5de5\u4f5c\u7ad9\u7ea7\u8fdc\u7a0b\u7ba1\u7406\uff09</li> <li>\u66ff\u4ee3/\u8865\u5145\u5f62\u6001</li> <li>\u5916\u7f6e KVM over IP \u8bbe\u5907\uff08Aten/Raritan \u7b49\uff09\uff0c\u9002\u5408\u65e0 BMC \u7684\u65e7\u673a\u6216\u591a\u673a\u7edf\u4e00\u63a5\u5165</li> <li>OpenBMC \u793e\u533a\u56fa\u4ef6\uff08\u9700\u8981\u786c\u4ef6\u652f\u6301\uff09</li> </ul>"},{"location":"enterprise/server-oob-management-guide.html#3","title":"3. \u67b6\u6784\u4e0e\u9009\u578b\u5efa\u8bae","text":"<ul> <li>\u7f51\u7edc\uff1a\u5efa\u8bae\u4f7f\u7528\u72ec\u7acb\u201c\u7ba1\u7406 VLAN/\u5b50\u7f51\u201d\uff0c\u4e0e\u4e1a\u52a1\u7f51\u7edc\u9694\u79bb\uff1b\u4ec5\u5185\u90e8\u8bbf\u95ee/\u6216\u7ecf VPN/\u5821\u5792\u673a\u8bbf\u95ee\u3002\u4e0d\u8981\u66b4\u9732\u5230\u516c\u7f51\u3002</li> <li>\u63a5\u53e3\uff1a\u4f18\u5148\u4f7f\u7528\u201c\u4e13\u7528\u7ba1\u7406\u53e3\u201d\uff08Dedicated NIC\uff09\uff1b\u82e5\u53d7\u9650\uff0c\u53ef\u7528\u5171\u4eab LOM\uff08\u4e0e\u4e1a\u52a1\u7f51\u53e3\u5171\u4eab\uff09\u3002</li> <li>\u534f\u8bae\uff1a\u4f18\u5148\u4f7f\u7528 Redfish\uff08HTTPS+JSON\uff09\uff1b\u4fdd\u7559 IPMI \u4f5c\u4e3a\u4f4e\u7ea7\u6545\u969c\u6392\u969c\u624b\u6bb5\u3002</li> <li>\u6d4f\u89c8\u5668\u63a7\u5236\u53f0\uff1a\u4f18\u5148\u542f\u7528 HTML5 \u63a7\u5236\u53f0\uff08\u907f\u514d Java/ActiveX \u4f9d\u8d56\uff09\u3002</li> <li>\u8bc1\u4e66\uff1a\u4e3a BMC/\u7ba1\u7406\u53e3\u90e8\u7f72\u53d7\u4fe1\u4efb\u7684 TLS \u8bc1\u4e66\uff08\u4f01\u4e1a CA \u6216 Let\u2019s Encrypt \u5185\u7f51 ACME\uff09\uff0c\u53bb\u9664\u6d4f\u89c8\u5668\u4e0d\u5b89\u5168\u63d0\u793a\u3002</li> </ul>"},{"location":"enterprise/server-oob-management-guide.html#4-dell-idrac","title":"4. \u5feb\u901f\u4e0a\u624b\uff08\u4ee5 Dell iDRAC \u4e3a\u4f8b\uff09","text":""},{"location":"enterprise/server-oob-management-guide.html#41","title":"4.1 \u521d\u59cb\u63a5\u5165\u4e0e\u7f51\u7edc","text":"<p>1) \u8fde\u63a5 iDRAC \u4e13\u7528\u7ba1\u7406\u53e3\u81f3\u201c\u7ba1\u7406\u4ea4\u6362\u673a/\u7ba1\u7406 VLAN\u201d\u3002 2) \u9ed8\u8ba4\u5730\u5740\u901a\u5e38\u4e3a DHCP\uff1b\u5982\u65e0 DHCP\uff0c\u53ef\u901a\u8fc7\u524d\u9762\u677f/LCD/BIOS \u8bbe\u7f6e\u9759\u6001 IP\uff1b\u4e5f\u53ef\u7528 <code>racadm</code> \u4ece\u672c\u673a\u5e26\u5916\u53e3\u914d\u7f6e\u3002 3) \u786e\u8ba4\u80fd\u4ece\u8fd0\u7ef4\u7f51\u7edc\u8bbf\u95ee https:///\uff0c\u9996\u6b21\u767b\u5f55\u4fee\u6539\u9ed8\u8ba4\u5bc6\u7801\uff0c\u521b\u5efa\u4e2a\u4eba\u8d26\u53f7\u5e76\u5206\u914d\u6700\u5c0f\u6743\u9650\u3002"},{"location":"enterprise/server-oob-management-guide.html#42-web-ui","title":"4.2 Web UI \u5e38\u7528\u64cd\u4f5c","text":"<ul> <li>Dashboard\uff1a\u67e5\u770b\u786c\u4ef6\u5065\u5eb7\u3001\u544a\u8b66\u3001\u56fa\u4ef6\u7248\u672c</li> <li>Power\uff1aOn/Off/Reset\uff1b\u201cGraceful Shutdown\u201d \u9700 OS \u652f\u6301 ACPI</li> <li>Console &amp; Media\uff1a\u542f\u52a8 HTML5 \u8fdc\u7a0b\u63a7\u5236\u53f0\uff1b\u201cVirtual Media\u201d \u6302\u8f7d ISO\uff0c\u652f\u6301\u901a\u8fc7 HTTP/SMB/NFS \u8def\u5f84</li> <li>Configuration\uff1a\u5f15\u5bfc\u987a\u5e8f\u8bbe\u7f6e\u3001\u201cOne-Time Boot to PXE/Virtual CD/DVD\u201d</li> <li>Maintenance\uff1a\u56fa\u4ef6/\u9a71\u52a8\u5347\u7ea7\u3001\u5bfc\u51fa/\u5bfc\u5165\u914d\u7f6e\u3001\u91c7\u96c6\u786c\u4ef6\u6e05\u5355</li> </ul>"},{"location":"enterprise/server-oob-management-guide.html#43-racadm","title":"4.3 RACADM \u547d\u4ee4\u793a\u4f8b\uff08\u672c\u673a\u6216\u8fdc\u7a0b\uff09","text":"<ul> <li>\u67e5\u770b/\u914d\u7f6e\u7ba1\u7406\u53e3</li> </ul> <pre><code>racadm getniccfg\nracadm set iDRAC.NIC.DNSRacName myserver-bmc\nracadm set iDRAC.IPv4.Address 10.10.10.10\nracadm set iDRAC.IPv4.Netmask 255.255.255.0\nracadm set iDRAC.IPv4.Gateway 10.10.10.1\n</code></pre> <ul> <li>\u7535\u6e90\u4e0e\u5f15\u5bfc</li> </ul> <pre><code>racadm serveraction powerstatus\nracadm serveraction powercycle\nracadm config -g cfgServerInfo -o cfgServerBootOnce 1\nracadm config -g cfgServerInfo -o cfgServerFirstBootDevice PXE\n</code></pre> <ul> <li>\u65e5\u5fd7\u4e0e\u5065\u5eb7</li> </ul> <pre><code>racadm getsensorinfo\nracadm getsel\nracadm clearlog\n</code></pre>"},{"location":"enterprise/server-oob-management-guide.html#44-ipmi","title":"4.4 IPMI \u901a\u7528\u547d\u4ee4\uff08\u8de8\u5382\u5546\uff09","text":"<ul> <li>\u901a\u8fc7\u7f51\u7edc\uff08LANPlus\uff09</li> </ul> <pre><code>ipmitool -I lanplus -H &lt;BMC_IP&gt; -U &lt;USER&gt; -a chassis status\nipmitool -I lanplus -H &lt;BMC_IP&gt; -U &lt;USER&gt; -a power cycle\nipmitool -I lanplus -H &lt;BMC_IP&gt; -U &lt;USER&gt; -a sensor list\nipmitool -I lanplus -H &lt;BMC_IP&gt; -U &lt;USER&gt; -a sel list\n</code></pre> <ul> <li>\u4e32\u884c over LAN\uff08SOL\uff09</li> </ul> <pre><code>ipmitool -I lanplus -H &lt;BMC_IP&gt; -U &lt;USER&gt; -a sol activate\n</code></pre>"},{"location":"enterprise/server-oob-management-guide.html#45-redfish","title":"4.5 Redfish \u793a\u4f8b\uff08\u6807\u51c6\u3001\u6613\u96c6\u6210\uff09","text":"<ul> <li>\u83b7\u53d6\u7ba1\u7406\u5668\u4e0e\u7cfb\u7edf\u8d44\u6e90</li> </ul> <pre><code>curl -k -u admin:*** https://&lt;BMC_IP&gt;/redfish/v1/\ncurl -k -u admin:*** https://&lt;BMC_IP&gt;/redfish/v1/Managers/\ncurl -k -u admin:*** https://&lt;BMC_IP&gt;/redfish/v1/Systems/\n</code></pre> <ul> <li>\u7535\u6e90\u63a7\u5236\u4e0e\u4e00\u6b21\u6027\u5f15\u5bfc</li> </ul> <pre><code># \u7535\u6e90\u91cd\u542f\ncurl -k -u admin:*** -H \"Content-Type: application/json\" -X POST \\\n  -d '{\"ResetType\":\"GracefulRestart\"}' \\\n  https://&lt;BMC_IP&gt;/redfish/v1/Systems/System.Embedded.1/Actions/ComputerSystem.Reset\n\n# \u4e00\u6b21\u6027\u5f15\u5bfc\u5230 PXE\uff08\u5c5e\u6027\u540d\u79f0\u968f\u5382\u5546\u8d44\u6e90\u7565\u6709\u4e0d\u540c\uff09\ncurl -k -u admin:*** -H \"Content-Type: application/json\" -X PATCH \\\n  -d '{\"Boot\":{\"BootSourceOverrideEnabled\":\"Once\",\"BootSourceOverrideTarget\":\"Pxe\"}}' \\\n  https://&lt;BMC_IP&gt;/redfish/v1/Systems/System.Embedded.1\n</code></pre>"},{"location":"enterprise/server-oob-management-guide.html#5-hpe-ilo","title":"5. HPE iLO \u5feb\u901f\u6307\u5f15\uff08\u8865\u5145\uff09","text":"<ul> <li>\u521d\u59cb\u8bbf\u95ee https://\uff0c\u9996\u6b21\u767b\u5f55\u66f4\u6539\u9ed8\u8ba4\u53e3\u4ee4\u3002 <li>Web \u529f\u80fd\u4e0e iDRAC \u7c7b\u4f3c\uff1a\u7535\u6e90\u3001\u63a7\u5236\u53f0\uff08HTML5/iKVM\uff09\u3001\u865a\u62df\u4ecb\u8d28\u3001\u56fa\u4ef6\u66f4\u65b0\u3001Active Health System \u65e5\u5fd7\u3002</li> <li>iLO REST/Redfish \u652f\u6301\u826f\u597d\uff0c\u53ef\u7528 <code>curl</code> \u6216 Ansible \u6a21\u5757\u3002</li> <li>\u5e38\u89c1\u7aef\u53e3\uff1a443\uff08HTTPS \u7ba1\u7406\uff09\uff0c\u53ef\u9009 17990\uff08\u63a7\u5236\u53f0\u8f6c\u53d1\uff0c\u89c6\u7248\u672c\u800c\u5b9a\uff09\u3002</li>"},{"location":"enterprise/server-oob-management-guide.html#6","title":"6. \u81ea\u52a8\u5316\u4e0e\u96c6\u6210","text":"<ul> <li>Ansible</li> <li><code>community.general.redfish_info</code>\u3001<code>community.general.redfish_command</code> \u7b49\u6a21\u5757\u7528\u4e8e\u67e5\u8be2\u4e0e\u63a7\u5236</li> <li>\u9002\u7528\u4e8e\u6279\u91cf\u5f00\u5173\u673a\u3001\u56fa\u4ef6\u7f16\u6392\u3001\u8d44\u4ea7\u91c7\u96c6\u3001PXE \u5b89\u88c5\u524d\u7f6e\u914d\u7f6e</li> <li>Python</li> <li><code>python-redfish</code> \u6216\u5382\u5546 SDK\uff08\u5982 <code>omsdk</code>\u3001<code>hpilo</code>\uff09\u8fdb\u884c\u4e8c\u6b21\u5f00\u53d1</li> <li>\u76d1\u63a7\u4e0e\u544a\u8b66</li> <li>\u901a\u8fc7 Redfish \u4e8b\u4ef6/\u544a\u8b66\u3001SNMP Trap\u3001Syslog \u5c06\u786c\u4ef6\u72b6\u6001\u9001\u5165\u76d1\u63a7\u5e73\u53f0\uff08\u5982 Prometheus + exporter\u3001Zabbix\u3001\u4f01\u4e1a\u4e8b\u4ef6\u5e73\u53f0\uff09</li> </ul>"},{"location":"enterprise/server-oob-management-guide.html#7","title":"7. \u5b89\u5168\u4e0e\u5408\u89c4\u6700\u4f73\u5b9e\u8df5","text":"<ul> <li>\u7f51\u7edc\u9694\u79bb\uff1a\u4e3a OOB \u4f7f\u7528\u4e13\u7528 VLAN/\u5b50\u7f51\uff0c\u4ec5\u7ecf\u5185\u7f51/VPN/\u5821\u5792\u673a\u8bbf\u95ee\uff1b\u7981\u6b62\u66b4\u9732\u516c\u7f51\u3002</li> <li>\u8d26\u6237\u4e0e\u6743\u9650\uff1a\u66f4\u6539\u9ed8\u8ba4\u5bc6\u7801\uff1b\u6309\u89d2\u8272\u5206\u6743\uff08\u53ea\u8bfb\u3001\u64cd\u4f5c\u3001\u7ba1\u7406\u5458\uff09\uff1b\u542f\u7528\u8d26\u6237\u9501\u5b9a\u4e0e\u590d\u6742\u5ea6\u7b56\u7565\u3002</li> <li>TLS \u4e0e\u8bc1\u4e66\uff1a\u4e3a BMC \u90e8\u7f72\u53d7\u4fe1\u4efb\u8bc1\u4e66\uff1b\u5173\u95ed\u5f31\u52a0\u5bc6/\u65e7\u534f\u8bae\uff1b\u5b9a\u671f\u66f4\u65b0\u8bc1\u4e66\u4e0e\u56fa\u4ef6\u3002</li> <li>\u5ba1\u8ba1\u4e0e\u65e5\u5fd7\uff1a\u5f00\u542f\u5ba1\u8ba1\u65e5\u5fd7\uff0c\u5b9a\u671f\u6c47\u805a\u5230 SIEM/\u65e5\u5fd7\u5e73\u53f0\uff1b\u5b9a\u671f\u5ba1\u67e5\u5931\u8d25\u767b\u5f55\u548c\u654f\u611f\u64cd\u4f5c\u3002</li> <li>\u56fa\u4ef6\u4e0e\u4f9b\u5e94\u94fe\uff1a\u5b9a\u671f\u68c0\u67e5\u4e0e\u5347\u7ea7 BMC/BIOS/\u9a71\u52a8\uff1b\u5173\u6ce8\u5382\u5546\u5b89\u5168\u901a\u544a\uff08CVE\uff09\u3002</li> <li>\u53d8\u66f4\u4e0e\u5e94\u6025\uff1a\u91cd\u5927\u64cd\u4f5c\uff08\u8fdc\u7a0b\u63a7\u5236\u53f0\u3001\u56fa\u4ef6\u5347\u7ea7\u3001\u7535\u6e90\u64cd\u4f5c\uff09\u9700\u7eb3\u5165\u53d8\u66f4\u6d41\u7a0b\uff0c\u5e76\u8bbe\u7f6e\u201c\u5e26\u5916\u5931\u8054\u5e94\u6025\u9884\u6848\u201d\uff08\u4f8b\u5982\u5e26\u5185/\u73b0\u573a\u56de\u9000\uff09\u3002</li> </ul>"},{"location":"enterprise/server-oob-management-guide.html#8","title":"8. \u5e38\u89c1\u95ee\u9898\u4e0e\u6392\u969c","text":"<ul> <li>\u65e0\u6cd5\u6253\u5f00\u8fdc\u7a0b\u63a7\u5236\u53f0\uff1a</li> <li>\u5207\u6362\u5230 HTML5 \u63a7\u5236\u53f0\uff1b\u68c0\u67e5\u6d4f\u89c8\u5668\u9650\u5236\u4e0e\u5f39\u7a97\uff1b\u786e\u4fdd\u7aef\u53e3 443/\u63a7\u5236\u53f0\u8f6c\u53d1\u7aef\u53e3\u53ef\u8fbe\u3002</li> <li>\u65e0\u6cd5\u6302\u8f7d\u865a\u62df\u4ecb\u8d28\uff1a</li> <li>\u5c1d\u8bd5 HTTP/HTTPS \u5bbf\u4e3b\u8def\u5f84\u6216 SMB/NFS\uff1b\u6ce8\u610f\u8def\u5f84\u6743\u9650\u4e0e\u7f51\u7edc\u53ef\u8fbe\uff1bISO \u6587\u4ef6\u540d\u907f\u514d\u4e2d\u6587\u4e0e\u7a7a\u683c\u3002</li> <li>IPMI \u52a0\u5bc6\u5931\u8d25/\u62a5\u9519\uff1a</li> <li>\u4f7f\u7528 <code>-I lanplus</code>\uff1b\u5347\u7ea7 BMC \u56fa\u4ef6\uff1b\u68c0\u67e5\u662f\u5426\u7981\u7528\u4e86\u5f31\u7b97\u6cd5\u5bfc\u81f4\u65e7 <code>ipmitool</code> \u65e0\u6cd5\u534f\u5546\u3002</li> <li>Redfish \u5c5e\u6027\u8def\u5f84\u5dee\u5f02\uff1a</li> <li>\u4e0d\u540c\u5382\u5546\u8d44\u6e90\u8def\u5f84\u7565\u5f02\uff1b\u5148 GET \u8d44\u6e90\u518d PATCH/POST\uff1b\u4e25\u683c\u4f7f\u7528 <code>Content-Type: application/json</code>\u3002</li> <li>\u5e26\u5916\u53e3\u5730\u5740\u51b2\u7a81\u6216\u65e0\u54cd\u5e94\uff1a</li> <li>\u6539\u7528\u76f4\u8fde\u7b14\u8bb0\u672c + \u4e34\u65f6\u7f51\u6bb5\u6392\u67e5\uff1b\u91cd\u7f6e BMC\uff1b\u5fc5\u8981\u65f6\u65ad\u7535 NVRAM \u6e05\u9664\uff08\u6309\u5382\u5546\u6d41\u7a0b\uff09\u3002</li> </ul>"},{"location":"enterprise/server-oob-management-guide.html#9","title":"9. \u7aef\u53e3\u4e0e\u534f\u8bae\uff08\u53c2\u8003\uff09","text":"<ul> <li>443/TCP\uff1aRedfish \u4e0e Web \u7ba1\u7406\uff08HTTPS\uff09</li> <li>623/UDP\uff1aIPMI\uff08RMCP/RMCP+\uff09</li> <li>5900+/TCP\uff1a\u90e8\u5206\u5382\u5546\u7684 KVM/\u865a\u62df\u5a92\u4f53\u8f6c\u53d1\u7aef\u53e3\uff08\u968f\u5b9e\u73b0\u53d8\u5316\uff0c\u901a\u5e38\u5c01\u88c5\u4e8e 443 \u5185\u90e8\u96a7\u9053\uff09</li> <li>22/TCP\uff1a\u53ef\u9009\u7684 SSH/\u5382\u5546 CLI\uff08\u5982\u90e8\u5206 iLO/iDRAC\uff09</li> </ul>"},{"location":"enterprise/server-oob-management-guide.html#10","title":"10. \u5b9e\u65bd\u6e05\u5355\uff08\u843d\u5730\u5efa\u8bae\uff09","text":"<p>1) \u89c4\u5212\u7ba1\u7406 VLAN \u4e0e\u5730\u5740\uff0c\u786e\u5b9a\u8bbf\u95ee\u8fb9\u754c\uff08VPN/\u5821\u5792\u673a/\u96f6\u4fe1\u4efb\uff09\u3002 2) \u4e3a\u6240\u6709\u670d\u52a1\u5668 BMC \u8bbe\u7f6e\u9759\u6001 IP \u4e0e DNS \u8bb0\u5f55\uff0c\u7edf\u4e00\u547d\u540d\uff08\u5982 bmc-xxx\uff09\u3002 3) \u542f\u7528 HTTPS \u4e0e\u53ef\u4fe1\u8bc1\u4e66\uff1b\u5173\u95ed\u4e0d\u5b89\u5168\u534f\u8bae/\u7b97\u6cd5\u3002 4) \u5efa\u7acb\u89d2\u8272\u4e0e\u6700\u5c0f\u6743\u9650\u8d26\u6237\uff0c\u542f\u7528\u5ba1\u8ba1\u65e5\u5fd7\u4e0e\u96c6\u4e2d\u6536\u96c6\u3002 5) \u7edf\u4e00\u56fa\u4ef6\u751f\u547d\u5468\u671f\u7ba1\u7406\uff08\u5b63\u5ea6\u68c0\u67e5/\u5e74\u5ea6\u5347\u7ea7\uff09\uff0c\u7eb3\u5165\u5b89\u5168\u901a\u544a\u54cd\u5e94\u6d41\u7a0b\u3002 6) \u5efa\u7acb\u81ea\u52a8\u5316\u6d41\u7a0b\uff08Ansible/Redfish\uff09\u8fdb\u884c\u6279\u91cf\u7535\u6e90\u3001\u5f15\u5bfc\u3001\u8d44\u4ea7\u53d1\u73b0\u4e0e\u88c5\u673a\u7f16\u6392\u3002</p>"},{"location":"enterprise/server-oob-management-guide.html#11","title":"11. \u9644\uff1a\u6700\u5c0f\u53ef\u884c\u547d\u4ee4\u901f\u67e5","text":"<ul> <li><code>ipmitool -I lanplus -H &lt;IP&gt; -U &lt;USER&gt; -a power status|on|off|cycle</code></li> <li><code>ipmitool -I lanplus -H &lt;IP&gt; -U &lt;USER&gt; -a sensor list</code></li> <li><code>ipmitool -I lanplus -H &lt;IP&gt; -U &lt;USER&gt; -a sel list</code></li> <li><code>curl -k -u user:pass https://&lt;IP&gt;/redfish/v1/</code></li> <li><code>racadm serveraction powercycle</code></li> <li><code>racadm getniccfg</code></li> </ul> <p>\u5efa\u8bae\u5c06\u4ee5\u4e0a\u547d\u4ee4\u5c01\u88c5\u6210\u811a\u672c/Ansible \u89d2\u8272\uff0c\u7ed3\u5408\u8d44\u4ea7\u6e05\u5355\u5b9e\u73b0\u6279\u91cf\u64cd\u4f5c\u4e0e\u5ba1\u8ba1\u7559\u75d5\u3002</p>"},{"location":"enterprise/server-raid-configuration-dell-perc.html","title":"\u670d\u52a1\u5668 RAID \u914d\u7f6e\u5b9e\u6218\uff1a\u4ee5 Dell PERC (perccli/storcli) \u4e3a\u4f8b","text":"<p>\u672c\u6587\u4ee5 Dell PERC \u63a7\u5236\u5668\u4e3a\u4f8b\uff08\u547d\u4ee4\u4e0e LSI/Broadcom \u7684 storcli/perccli \u517c\u5bb9\uff09\uff0c\u4ecb\u7ecd\u4ece\u89c4\u5212\u5230\u843d\u5730\u7684 RAID \u914d\u7f6e\u4e0e\u7ef4\u62a4\u6d41\u7a0b\uff0c\u8986\u76d6\u521b\u5efa\u865a\u62df\u76d8\u3001\u521d\u59cb\u5316\u3001\u70ed\u5907\u3001\u6545\u969c\u66f4\u6362\u4e0e\u91cd\u5efa\u3001\u7b56\u7565\u8c03\u4f18\u7b49\u5e38\u89c1\u64cd\u4f5c\uff0c\u9644\u5b8c\u6574\u547d\u4ee4\u884c\u6837\u4f8b\u3002</p>"},{"location":"enterprise/server-raid-configuration-dell-perc.html#1","title":"1. \u89c4\u5212\u4e0e\u547d\u540d","text":"<ul> <li>\u76ee\u6807\uff1a</li> <li>OS \u76d8\uff1aRAID1\uff082 \u5757 SSD\uff09</li> <li>\u6570\u636e\u76d8\uff1aRAID10\uff084~8 \u5757\uff09</li> <li>\u70ed\u5907\uff1a1 \u5757 Global Hot Spare\uff08\u53ef\u8de8\u9635\u5217\uff09</li> <li>\u547d\u540d\uff1a\u63a7\u5236\u5668 c0\uff0c\u673a\u7b3c e32\uff08\u793a\u4f8b\uff09\uff0c\u63d2\u69fd sX\uff0c\u5982 32:0 \u8868\u793a\u673a\u7b3c 32 \u7684 0 \u53f7\u69fd\u4f4d</li> <li>\u7b56\u7565\uff1a\u5199\u7f13\u5b58\uff08WB\uff09+ \u8bfb\u9884\u8bfb\uff08RA\uff09+ Direct IO\uff1b\u5fc5\u8981\u65f6\u542f\u7528\u78c1\u76d8\u9ad8\u901f\u7f13\u5b58\uff08\u9700\u65ad\u7535\u4fdd\u62a4\uff09</li> </ul>"},{"location":"enterprise/server-raid-configuration-dell-perc.html#2","title":"2. \u5de5\u5177\u51c6\u5907","text":"<ul> <li>Linux \u4e0b\u8f7d\uff1a</li> </ul> <pre><code># \u4efb\u9009\u5176\u4e00\uff08\u4e0d\u540c\u53d1\u884c\u7248\u8def\u5f84\u53ef\u80fd\u4e0d\u540c\uff09\nwget https://\u2026/perccli-linux.tar.gz &amp;&amp; tar xzf perccli-linux.tar.gz\nsudo cp perccli64 /usr/local/bin/perccli\n# \u6216 storcli64\n</code></pre> <ul> <li>\u67e5\u770b\u7248\u672c\u4e0e\u63a7\u5236\u5668</li> </ul> <pre><code>perccli /c0 show\nperccli show ctrl\n</code></pre>"},{"location":"enterprise/server-raid-configuration-dell-perc.html#3","title":"3. \u53d1\u73b0\u786c\u76d8\u4e0e\u5916\u6765\u914d\u7f6e","text":"<pre><code># \u5217\u51fa\u6240\u6709\u7269\u7406\u76d8\uff08enclosure:eId/slot:sId\uff09\nperccli /c0/eall/sall show\n\n# \u5916\u6765\u914d\u7f6e\uff08Foreign\uff09\u6e05\u7406\uff08\u5c0f\u5fc3\u6570\u636e\uff01\uff09\nperccli /c0 /fall delete\n</code></pre>"},{"location":"enterprise/server-raid-configuration-dell-perc.html#4-vd","title":"4. \u521b\u5efa\u9635\u5217\u4e0e\u865a\u62df\u78c1\u76d8\uff08VD\uff09","text":""},{"location":"enterprise/server-raid-configuration-dell-perc.html#41-osraid1","title":"4.1 OS\uff1aRAID1","text":"<pre><code># \u4ee5 e32 \u69fd\u4f4d 0 \u548c 1 \u4e3a\u4f8b\na=32:0;b=32:1\nperccli /c0 add vd r1 size=all drives=$a,$b name=OS wb ra direct\n</code></pre>"},{"location":"enterprise/server-raid-configuration-dell-perc.html#42-raid10","title":"4.2 \u6570\u636e\uff1aRAID10","text":"<pre><code># \u4ee5 e32 \u69fd\u4f4d 2,3,4,5 \u4e3a\u4f8b\uff08\u4e24\u4e24\u6761\u5e26\uff09\nperccli /c0 add vd r10 size=all drives=32:2,32:3,32:4,32:5 name=DATA wb ra direct\n</code></pre>"},{"location":"enterprise/server-raid-configuration-dell-perc.html#43-global-hot-spare","title":"4.3 \u8bbe\u7f6e\u70ed\u5907\uff08Global Hot Spare\uff09","text":"<pre><code>perccli /c0/e32/s7 set di=hotspare\n</code></pre>"},{"location":"enterprise/server-raid-configuration-dell-perc.html#44","title":"4.4 \u7b56\u7565\u4e0e\u521d\u59cb\u5316","text":"<pre><code># \u7b56\u7565\uff1a\u5199\u56de/\u8bfb\u9884\u8bfb/\u76f4\u5199\na=OS; b=DATA\nperccli /c0/vd all set wrcache=wb\nperccli /c0/vd all set rdcache=ra\nperccli /c0/vd all set direct=on\n\n# \u540e\u53f0\u521d\u59cb\u5316\uff08BGI\uff09\nperccli /c0/vd all start init\nperccli /c0/vd all show init\n</code></pre>"},{"location":"enterprise/server-raid-configuration-dell-perc.html#5","title":"5. \u64cd\u4f5c\u7cfb\u7edf\u5c42\u9762","text":"<pre><code># \u67e5\u770b\u5757\u8bbe\u5907\nlsblk -o NAME,SIZE,TYPE,MOUNTPOINT\n# GPT \u5206\u533a\u5e76\u521b\u5efa\u6587\u4ef6\u7cfb\u7edf\nparted /dev/sdb --script mklabel gpt mkpart primary ext4 0% 100%\nmkfs.ext4 /dev/sdb1\n# \u6302\u8f7d\u4e0e\u6301\u4e45\u5316\nmkdir -p /data &amp;&amp; echo '/dev/sdb1 /data ext4 defaults 0 2' &gt;&gt; /etc/fstab &amp;&amp; mount -a\n</code></pre>"},{"location":"enterprise/server-raid-configuration-dell-perc.html#6","title":"6. \u76d1\u63a7\u4e0e\u5065\u5eb7\u68c0\u67e5","text":"<pre><code># \u63a7\u5236\u5668/\u865a\u62df\u76d8/\u7269\u7406\u76d8\u5065\u5eb7\nperccli /c0 show\nperccli /c0/vall show\nperccli /c0/eall/sall show\n\n# \u70b9\u4eae/\u7184\u706d\u6307\u793a\u706f\uff08\u5b9a\u4f4d\u76d8\u4f4d\uff09\nperccli /c0/e32/s5 start locate\nperccli /c0/e32/s5 stop locate\n</code></pre>"},{"location":"enterprise/server-raid-configuration-dell-perc.html#7","title":"7. \u6545\u969c\u66f4\u6362\u4e0e\u91cd\u5efa\uff08\u5178\u578b\u6d41\u7a0b\uff09","text":"<p>1) \u6807\u8bb0\u6545\u969c\u76d8\u5e76\u5b9a\u4f4d\uff1a</p> <pre><code>perccli /c0/e32/s5 show\nperccli /c0/e32/s5 start locate\n</code></pre> <p>2) \u7269\u7406\u66f4\u6362\u78c1\u76d8\uff08\u5bb9\u91cf\u4e0d\u5c0f\u4e8e\u539f\u76d8\uff09 3) \u63a7\u5236\u5668\u81ea\u52a8\u89e6\u53d1\u91cd\u5efa\u6216\u624b\u52a8\u6307\u5b9a\uff1a</p> <pre><code>perccli /c0/e32/s5 set rebuild\nperccli /c0/vall show rebuild\n</code></pre> <p>4) \u9a8c\u8bc1\u9635\u5217\u72b6\u6001\u6062\u590d Optimal</p>"},{"location":"enterprise/server-raid-configuration-dell-perc.html#8-jbod-hba","title":"8. JBOD/\u76f4\u901a\u4e0e HBA \u6a21\u5f0f\uff08\u53ef\u9009\uff09","text":"<pre><code># \u5c06\u7269\u7406\u76d8\u8bbe\u4e3a JBOD \u4f9b\u4e0a\u5c42\u8f6f\u4ef6\uff08\u5982 ZFS/Ceph\uff09\u76f4\u63a5\u4f7f\u7528\nperccli /c0/e32/sall set jbod\n# \u6216\u5c06\u63a7\u5236\u5668\u5207\u6362\u4e3a HBA IT \u6a21\u5f0f\uff08\u89c6\u673a\u578b\u652f\u6301\u4e0e\u56fa\u4ef6\u800c\u5b9a\uff09\n</code></pre>"},{"location":"enterprise/server-raid-configuration-dell-perc.html#9","title":"9. \u5907\u4efd\u914d\u7f6e\u4e0e\u5bfc\u5165\u5bfc\u51fa","text":"<pre><code># \u5bfc\u51fa\u63a7\u5236\u5668\u914d\u7f6e\uff08\u5907\u4efd\uff09\nperccli /c0 show config &gt; /root/perc_config_$(date +%F).txt\n# \u53e6\u53ef\u4f7f\u7528\uff1aperccli /c0/cv show all\n</code></pre>"},{"location":"enterprise/server-raid-configuration-dell-perc.html#10","title":"10. \u6ce8\u610f\u4e0e\u6700\u4f73\u5b9e\u8df5","text":"<ul> <li>\u5199\u7f13\u5b58\u7b56\u7565\uff1a\u4ec5\u5728\u5177\u5907 BBU/\u8d85\u7ea7\u7535\u5bb9\u4fdd\u62a4\u65f6\u542f\u7528\u5199\u56de\uff08WB\uff09</li> <li>\u4e00\u81f4\u6027\u6821\u9a8c\uff1a\u5b9a\u671f\u5de1\u68c0\uff08Consistency Check\uff09\uff0c\u5728\u4e1a\u52a1\u4f4e\u5cf0\u6267\u884c</li> <li>\u56fa\u4ef6\u4e0e\u9a71\u52a8\uff1a\u4fdd\u6301 PERC \u4e0e\u78c1\u76d8\u56fa\u4ef6\u5728\u652f\u6301\u5217\u8868\u7248\u672c</li> <li>\u76d1\u63a7\uff1a\u5c06 <code>perccli</code> \u5de1\u68c0\u7ed3\u679c\u7eb3\u5165\u76d1\u63a7\u544a\u8b66\uff08Zabbix/Prometheus \u81ea\u5b9a\u4e49\u91c7\u96c6\uff09</li> <li>\u53d8\u66f4\uff1a\u521b\u5efa/\u5220\u9664/\u6e05\u5916\u6765\u914d\u7f6e\u524d\u52a1\u5fc5\u786e\u8ba4\u78c1\u76d8\u4e0e\u5377\u8eab\u4efd\uff0c\u907f\u514d\u8bef\u64cd\u4f5c</li> </ul>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88-vSphere-Hadoop-Grafana-Ansible-Chef.html","title":"\u4f01\u4e1a IT \u65e5\u5e38\u8fd0\u7ef4\u65b9\u6848\uff1avSphere / Hadoop / Grafana / Ansible / Chef","text":"<p>\u672c\u6587\u9762\u5411\u4f01\u4e1a IT/\u8fd0\u7ef4\u5de5\u7a0b\u5e08\uff0c\u8986\u76d6 vSphere\u3001Hadoop\u3001Grafana\u3001Ansible\u3001Chef \u7684\u65e5\u5e38\u4f7f\u7528\u65b9\u6848\u3002\u5305\u542b\uff1a\u57fa\u7840\u547d\u4ee4\u901f\u67e5\u3001\u5e38\u89c1\u8fd0\u7ef4\u64cd\u4f5c\u3001\u5b9e\u7528\u793a\u4f8b\u4e0e\u6700\u4f73\u5b9e\u8df5\u3002\u53ef\u76f4\u63a5\u7528\u4e8e\u6392\u969c\u3001\u65e5\u5e38\u5de1\u68c0\u4e0e\u6807\u51c6\u5316\u8fd0\u7ef4\u3002</p>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88-vSphere-Hadoop-Grafana-Ansible-Chef.html#vspherevcenteresxi","title":"vSphere\uff08vCenter/ESXi\uff09","text":"<p>\u9002\u7528\u5bf9\u8c61\uff1a\u865a\u62df\u5316\u5e73\u53f0\u65e5\u5e38\u7ba1\u7406\uff08\u4e3b\u673a/\u96c6\u7fa4/\u6570\u636e\u5b58\u50a8/\u865a\u62df\u673a\uff09\u3002\u63a8\u8350\u5728\u8fd0\u7ef4\u4e3b\u673a\u5b89\u88c5 VMware PowerCLI\uff08Windows/PowerShell\uff09\u6216\u4f7f\u7528 govc\uff08\u8de8\u5e73\u53f0 CLI\uff09\u3002</p>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88-vSphere-Hadoop-Grafana-Ansible-Chef.html#_1","title":"\u90e8\u7f72\u65b9\u6cd5","text":"<ul> <li>\u524d\u7f6e\u51c6\u5907</li> <li>\u786c\u4ef6\u901a\u8fc7 VMware HCL\uff1b\u5f00\u542f VT-x/AMD-V\u3001VT-d/IOMMU\uff1b\u914d\u7f6e\u5e26\u5916\u7ba1\u7406\uff08iDRAC/iLO\uff09</li> <li>\u89c4\u5212\u7ba1\u7406/\u5b58\u50a8/VM \u7f51\u7edc\uff08VLAN\u3001MTU\u3001\u7f51\u5173/DNS/NTP\uff09</li> <li>\u5b89\u88c5 ESXi</li> <li>U \u76d8/\u865a\u62df\u4ecb\u8d28\u5b89\u88c5\uff0c\u914d\u7f6e Management Network \u9759\u6001 IP</li> <li>\u5fc5\u8981\u65f6\u542f\u7528 SSH/ESXi Shell\uff08\u4ec5\u5728\u53d8\u66f4\u7a97\u4e34\u65f6\u5f00\u542f\uff09</li> <li>\u90e8\u7f72 vCenter Server\uff08VCSA\uff09</li> </ul> <pre><code># \u901a\u8fc7 govc \u5bfc\u5165 OVA\uff08\u4e5f\u53ef\u7528\u6d4f\u89c8\u5668\u5b89\u88c5\u5668\uff09\ngovc import.ova -name vcenter -ds datastore1 -folder \"/DC1/vm\" VMware-vCenter-Server-Appliance-*.ova\ngovc vm.power -on vcenter\n</code></pre> <ul> <li>\u5c06 ESXi \u4e3b\u673a\u52a0\u5165 vCenter \u5e76\u5efa\u96c6\u7fa4</li> </ul> <pre><code>govc cluster.create -dc DC1 Cluster\ngovc host.add -hostname esxi01.local -username root -password '***' -cluster \"/DC1/host/Cluster\"\n</code></pre> <ul> <li>\u5b58\u50a8\u4e0e\u7f51\u7edc</li> </ul> <pre><code># NFS \u6570\u636e\u5b58\u50a8\nesxcli storage nfs add -H 10.0.10.10 -s /export/ds1 -v nfs1\n# \u542f\u7528\u8f6f\u4ef6 iSCSI \u5e76\u6dfb\u52a0\u76ee\u6807\nesxcli iscsi software set -e true\nesxcli iscsi adapter discovery sendtarget add -a 10.0.20.20\n</code></pre> <ul> <li> <p>\u540e\u7eed\u914d\u7f6e\uff1a\u5f00\u542f DRS/HA\u3001\u521b\u5efa vDS \u4e0e PortGroup\u3001\u8bbe\u7f6e\u8bb8\u53ef\u8bc1\u3001\u914d\u7f6e VCSA \u5907\u4efd\uff08:5480\uff09</p> </li> <li> <p>\u5e38\u7528\u73af\u5883\u53d8\u91cf\uff08govc\uff09</p> </li> </ul> <pre><code># Linux/macOS\nexport GOVC_URL=\"https://vcenter.example.com\"\nexport GOVC_USERNAME=\"administrator@vsphere.local\"\nexport GOVC_PASSWORD=\"******\"\nexport GOVC_INSECURE=1    # \u5982\u4e3a\u81ea\u7b7e\u540d\u8bc1\u4e66\n\n# Windows PowerShell\n$env:GOVC_URL = \"https://vcenter.example.com\"\n$env:GOVC_USERNAME = \"administrator@vsphere.local\"\n$env:GOVC_PASSWORD = \"******\"\n$env:GOVC_INSECURE = \"1\"\n</code></pre> <ul> <li>\u8d44\u6e90\u67e5\u770b\u4e0e\u68c0\u7d22\uff08govc\uff09</li> </ul> <pre><code># \u6570\u636e\u4e2d\u5fc3/\u96c6\u7fa4/\u4e3b\u673a/\u5b58\u50a8/\u7f51\u7edc\ngovc datacenter.info\ngovc cluster.info\ngovc host.info\ngovc datastore.info\ngovc ls /dc1/network\n\n# \u67e5\u627e VM\ngovc find / -type m -name '*app*'\n# VM \u57fa\u672c\u4fe1\u606f\ngovc vm.info -json myvm | jq '.'\n</code></pre> <ul> <li>\u865a\u673a\u751f\u547d\u5468\u671f\uff08govc\uff09</li> </ul> <pre><code># \u4ece\u6a21\u677f\u514b\u9686\ngovc vm.clone -vm \"tmpl-ubuntu-22\" -on=true \\\n  -ds \"datastore1\" -net \"VM Network\" \\\n  -folder \"/DC1/vm/APP\" -pool \"/DC1/host/Cluster/Resources/Prod\" \\\n  \"app-web-01\"\n\n# \u8c03\u6574\u914d\u7f6e\uff08CPU/Mem/\u7f51\u5361\uff09\ngovc vm.change -vm app-web-01 -c 4 -m 8192\ngovc device.ls -vm app-web-01\n\n# \u7535\u6e90\u4e0e\u5de5\u5177\ngovc vm.power -on  app-web-01\ngovc vm.power -off app-web-01\ngovc vm.tools -vm app-web-01\n</code></pre> <ul> <li>\u5feb\u7167\u4e0e\u8fc1\u79fb\uff08govc\uff09</li> </ul> <pre><code># \u5feb\u7167\ngovc snapshot.create -vm app-web-01 before-patch\ngovc snapshot.tree   -vm app-web-01\ngovc snapshot.revert -vm app-web-01 -s before-patch\ngovc snapshot.remove -vm app-web-01 -s before-patch\n\n# Storage vMotion / vMotion\uff08\u9700\u8bb8\u53ef\u4e0e\u8d44\u6e90\uff09\n# \u8fc1\u79fb\u5230\u5176\u4ed6\u6570\u636e\u5b58\u50a8\ngovc vm.migrate -vm app-web-01 -ds datastore2\n# \u8fc1\u79fb\u5230\u5176\u4ed6\u4e3b\u673a\uff08\u540c\u96c6\u7fa4\uff09\ngovc vm.migrate -vm app-web-01 -host esxi02.local\n</code></pre> <ul> <li>\u4e3b\u673a\u7ef4\u62a4\u4e0e\u6570\u636e\u5b58\u50a8\uff08govc\uff09</li> </ul> <pre><code># \u8fdb\u5165/\u9000\u51fa\u7ef4\u62a4\u6a21\u5f0f\ngovc host.maintenance.enter -host esxi01.local\ngovc host.maintenance.exit  -host esxi01.local\n\n# \u6570\u636e\u5b58\u50a8\u7a7a\u95f4\u4e0e\u6587\u4ef6\ngovc datastore.info -json datastore1 | jq '.'\ngovc datastore.ls -ds datastore1\n</code></pre> <ul> <li>PowerCLI \u5e38\u89c1\u64cd\u4f5c\uff08Windows PowerShell\uff09</li> </ul> <pre><code>Import-Module VMware.PowerCLI\nConnect-VIServer -Server vcenter.example.com -User administrator@vsphere.local -Password ******\n\n# \u67e5\u627e/\u5f00\u5173\u673a/\u514b\u9686\nGet-VM -Name *app* | Select Name,PowerState\nStop-VM -VM app-web-01 -Confirm:$false\nStart-VM -VM app-web-01\nNew-VM -Name app-web-02 -VMHost esxi02 -Template tmpl-ubuntu-22 -Datastore datastore1\n\n# \u5feb\u7167\nNew-Snapshot -VM app-web-01 -Name before-patch\nGet-Snapshot -VM app-web-01 | Remove-Snapshot -Confirm:$false\n</code></pre> <ul> <li>\u5e38\u89c1\u8fd0\u7ef4\u573a\u666f</li> <li>\u6279\u91cf\u8865\u4e01\u524d\u521b\u5efa\u5feb\u7167\u3001\u5b8c\u6210\u540e\u5220\u9664\u5feb\u7167</li> <li>VM \u6269\u5bb9\uff08vCPU/\u5185\u5b58/\u78c1\u76d8\uff09\u4e0e\u5728\u7ebf\u70ed\u6dfb\u52a0\u6821\u9a8c</li> <li>vMotion/Storage vMotion \u51cf\u5c11\u505c\u673a\u8fc1\u79fb</li> <li>ESXi \u7ef4\u62a4\u6a21\u5f0f\u914d\u5408 DRS \u81ea\u52a8\u8fc1\u79fb</li> <li>\u5b9a\u671f\u6e05\u7406\u50f5\u5c38\u5feb\u7167\u4e0e\u672a\u6302\u8f7d ISO</li> </ul>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88-vSphere-Hadoop-Grafana-Ansible-Chef.html#hadoophdfsyarn","title":"Hadoop\uff08HDFS/YARN\uff09","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88-vSphere-Hadoop-Grafana-Ansible-Chef.html#_2","title":"\u90e8\u7f72\u65b9\u6cd5","text":"<ul> <li>\u524d\u7f6e</li> <li>\u540c\u6b65\u65f6\u949f\u3001\u7981\u7528 swap\u3001\u914d\u7f6e /etc/hosts\u3001\u514d\u5bc6 SSH</li> <li>\u5b89\u88c5 JDK 11+/17\uff0c\u521b\u5efa hadoop \u7cfb\u7edf\u7528\u6237</li> <li>\u5b89\u88c5\u4e0e\u521d\u59cb\u5316\uff08\u4ee5 Hadoop 3.x \u4e3a\u4f8b\uff09</li> </ul> <pre><code>sudo apt-get install -y openjdk-11-jdk\n tar -xf hadoop-3.3.6.tar.gz -C /opt &amp;&amp; ln -s /opt/hadoop-3.3.6 /opt/hadoop\n echo 'export HADOOP_HOME=/opt/hadoop; export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin' | sudo tee /etc/profile.d/hadoop.sh\n source /etc/profile.d/hadoop.sh\n</code></pre> <ul> <li>\u57fa\u7840\u914d\u7f6e\u793a\u4f8b</li> </ul> <pre><code>&lt;!-- core-site.xml --&gt;\n&lt;property&gt;&lt;name&gt;fs.defaultFS&lt;/name&gt;&lt;value&gt;hdfs://nn1:8020&lt;/value&gt;&lt;/property&gt;\n&lt;!-- hdfs-site.xml --&gt;\n&lt;property&gt;&lt;name&gt;dfs.replication&lt;/name&gt;&lt;value&gt;3&lt;/value&gt;&lt;/property&gt;\n&lt;!-- yarn-site.xml --&gt;\n&lt;property&gt;&lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;&lt;value&gt;rm1&lt;/value&gt;&lt;/property&gt;\n</code></pre> <ul> <li>\u9996\u6b21\u683c\u5f0f\u5316\u4e0e\u542f\u52a8</li> </ul> <pre><code>hdfs namenode -format\nstart-dfs.sh &amp;&amp; start-yarn.sh\n</code></pre> <ul> <li>HA \u8981\u70b9\uff08\u7b80\u8981\uff09</li> <li>\u90e8\u7f72 3 \u53f0 JournalNode \u4e0e ZooKeeper</li> <li>\u4e3b NN \u683c\u5f0f\u5316\u540e\uff0c\u5907\u7528 NN \u6267\u884c\uff1a<code>hdfs namenode -bootstrapStandby</code></li> <li> <p>\u542f\u52a8\u987a\u5e8f\uff1aJournalNode \u2192 NN/ZN \u2192 DN \u2192 RM/NM</p> </li> <li> <p>HDFS \u57fa\u672c\u547d\u4ee4</p> </li> </ul> <pre><code># \u76ee\u5f55\u4e0e\u7a7a\u95f4\nhdfs dfs -ls -h /data\nhdfs dfs -du -h /data/project\nhdfs dfs -count -q /data/project\n\n# \u8bfb\u5199\u4e0e\u6743\u9650\nhdfs dfs -mkdir -p /data/project/input\nhdfs dfs -put file.csv /data/project/input/\nhdfs dfs -get /data/project/output/part-00000 ./result.txt\nhdfs dfs -rm -r -skipTrash /data/tmp/*\nhdfs dfs -chmod -R 750 /data/project\nhdfs dfs -chown -R app:app /data/project\n\n# \u5065\u5eb7\u4e0e\u72b6\u6001\nhdfs dfsadmin -report\nhdfs fsck / -files -blocks -locations | head -n 50\nhdfs dfsadmin -safemode get|enter|leave\n</code></pre> <ul> <li>YARN/MapReduce</li> </ul> <pre><code># \u5e94\u7528/\u961f\u5217/\u8282\u70b9\nyarn application -list\nyarn application -status application_1731234567890_0010\nyarn node -list\n\n# \u65e5\u5fd7\nyarn logs -applicationId application_1731234567890_0010 | less\n</code></pre> <ul> <li>\u96c6\u7fa4\u7ba1\u7406\uff08\u6309\u90e8\u7f72\u65b9\u5f0f\uff09</li> </ul> <pre><code># \u57fa\u4e8e\u811a\u672c\uff08Apache \u539f\u751f\uff09\nstart-dfs.sh &amp;&amp; start-yarn.sh\nstop-yarn.sh &amp;&amp; stop-dfs.sh\n\n# \u57fa\u4e8e systemd\uff08\u89c6\u53d1\u884c\u7248\u670d\u52a1\u540d\uff09\nsudo systemctl status hadoop-hdfs-namenode\nsudo systemctl restart hadoop-hdfs-namenode\nsudo systemctl restart hadoop-yarn-resourcemanager\n</code></pre> <ul> <li>\u5e38\u89c1\u8fd0\u7ef4\u573a\u666f</li> <li>\u6269\u5bb9 DataNode\uff1a\u5728 workers/slaves \u589e\u52a0\u4e3b\u673a \u2192 \u542f\u52a8 DataNode \u2192 hdfs dfsadmin -report \u6821\u9a8c</li> <li>\u4e0b\u7ebf DataNode\uff1a\u914d\u7f6e exclude \u6587\u4ef6 \u2192 hdfs dfsadmin -refreshNodes \u2192 \u7b49\u5f85\u8fc1\u79fb\u5b8c\u6210</li> <li>\u8d1f\u8f7d\u5747\u8861\uff1a<code>hdfs balancer -threshold 10</code></li> <li>NN HA \u5207\u6362\uff1a<code>hdfs haadmin -getServiceState nn1</code> / <code>hdfs haadmin -failover nn1 nn2</code></li> <li>\u6e05\u7406\u5c0f\u6587\u4ef6\u4e0e\u5408\u5e76\u8f93\u51fa\uff08\u4f7f\u7528 DistCp / Hive / Spark \u4fa7\u5408\u5e76\uff09</li> <li>\u5b9a\u671f\u5bb9\u91cf\u5de1\u68c0\u3001Top N \u5360\u7528\uff1a</li> </ul> <pre><code>hdfs dfs -du -h / | sort -hr | head -n 20\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88-vSphere-Hadoop-Grafana-Ansible-Chef.html#grafana","title":"Grafana\uff08\u76d1\u63a7\u4e0e\u544a\u8b66\uff09","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88-vSphere-Hadoop-Grafana-Ansible-Chef.html#_3","title":"\u90e8\u7f72\u65b9\u6cd5","text":"<ul> <li>\u65b9\u6848 A\uff1a\u5305\u7ba1\u7406\u5668\u5b89\u88c5\uff08Debian/Ubuntu\uff09</li> </ul> <pre><code>sudo apt-get install -y apt-transport-https\nsudo mkdir -p /etc/apt/keyrings &amp;&amp; curl -fsSL https://apt.grafana.com/gpg.key | sudo gpg --dearmor -o /etc/apt/keyrings/grafana.gpg\necho \"deb [signed-by=/etc/apt/keyrings/grafana.gpg] https://apt.grafana.com stable main\" | sudo tee /etc/apt/sources.list.d/grafana.list\nsudo apt update &amp;&amp; sudo apt install -y grafana\nsudo systemctl enable --now grafana-server\n</code></pre> <ul> <li>\u65b9\u6848 B\uff1aDocker Compose</li> </ul> <pre><code>version: '3'\nservices:\n  grafana:\n    image: grafana/grafana:10.4.0\n    ports: [\"3000:3000\"]\n    volumes:\n      - ./grafana:/var/lib/grafana\n      - ./provisioning:/etc/grafana/provisioning\n    environment:\n      - GF_SECURITY_ADMIN_PASSWORD=admin\n</code></pre> <ul> <li>\u5e38\u89c1\u8def\u5f84\u4e0e\u670d\u52a1</li> </ul> <pre><code># \u914d\u7f6e/\u6570\u636e/\u670d\u52a1\n/etc/grafana/grafana.ini\n/etc/grafana/provisioning/{datasources,dashboards}\n/var/lib/grafana/grafana.db  # \u9ed8\u8ba4 SQLite\nsudo systemctl restart grafana-server\n</code></pre> <ul> <li>\u63d2\u4ef6\u4e0e\u7ba1\u7406</li> </ul> <pre><code># \u63d2\u4ef6\nsudo grafana-cli plugins ls\nsudo grafana-cli plugins install grafana-piechart-panel\nsudo systemctl restart grafana-server\n\n# \u7ba1\u7406\u5458\u5bc6\u7801\uff08\u73af\u5883\u53d8\u91cf\u6216 ini\uff09\n# grafana.ini: [security] admin_user, admin_password\n</code></pre> <ul> <li>\u901a\u8fc7 API \u521b\u5efa Prometheus \u6570\u636e\u6e90</li> </ul> <pre><code>curl -X POST http://admin:admin@localhost:3000/api/datasources \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"name\":\"Prometheus\",\n    \"type\":\"prometheus\",\n    \"url\":\"http://prometheus:9090\",\n    \"access\":\"proxy\",\n    \"isDefault\":true\n  }'\n</code></pre> <ul> <li>\u901a\u8fc7 API \u5907\u4efd/\u5bfc\u5165\u4eea\u8868\u76d8</li> </ul> <pre><code># \u5bfc\u51fa\ncurl -s -H \"Authorization: Bearer $GRAFANA_TOKEN\" \\\n  http://localhost:3000/api/dashboards/uid/abcd1234 | jq '.dashboard' &gt; dash.json\n\n# \u5bfc\u5165\ncurl -X POST -H \"Authorization: Bearer $GRAFANA_TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"dashboard\":'\"$(cat dash.json)\"',\"overwrite\":true}' \\\n  http://localhost:3000/api/dashboards/db\n</code></pre> <ul> <li>\u8fc1\u79fb\u5230 MySQL/PostgreSQL\uff08\u53ef\u9009\uff09</li> </ul> <pre><code># grafana.ini\n[database]\n;type = mysql\n;host = 127.0.0.1:3306\n;name = grafana\n;user = grafana\n;password = ******\n</code></pre> <ul> <li>\u5e38\u89c1\u8fd0\u7ef4\u573a\u666f</li> <li>\u9996\u6b21\u63a5\u5165\uff1a\u901a\u8fc7 Provisioning \u7f16\u5199\u6570\u636e\u6e90/\u4eea\u8868\u76d8 YAML\uff0c\u968f\u670d\u52a1\u81ea\u52a8\u52a0\u8f7d</li> <li>\u5907\u4efd\u6062\u590d\uff1a\u5907\u4efd grafana.db \u6216\u5207\u6362\u5916\u90e8\u6570\u636e\u5e93\uff1b\u5bfc\u51fa/\u5bfc\u5165 Dashboard JSON</li> <li>\u544a\u8b66\uff1a\u7edf\u4e00\u5728 Alerting \u914d\u7f6e\u8054\u7cfb\u70b9\uff08Webhook/Email/DingTalk\uff09\uff0c\u5e76\u5728\u9762\u677f\u4e0a\u5b9a\u4e49\u89c4\u5219</li> </ul>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88-vSphere-Hadoop-Grafana-Ansible-Chef.html#ansible","title":"Ansible\uff08\u81ea\u52a8\u5316\u8fd0\u7ef4\uff09","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88-vSphere-Hadoop-Grafana-Ansible-Chef.html#_4","title":"\u90e8\u7f72\u65b9\u6cd5","text":"<pre><code># \u5b89\u88c5\uff08\u63a8\u8350 pipx\uff09\npython3 -m pip install --user pipx &amp;&amp; pipx ensurepath &amp;&amp; pipx install ansible\nansible --version\n\n# SSH \u51c6\u5907\nssh-keygen -t ed25519 -C \"ansible\"\nssh-copy-id ubuntu@10.0.0.11\n</code></pre> <pre><code># ansible.cfg\uff08\u653e\u9879\u76ee\u6839\u76ee\u5f55\uff09\n[defaults]\ninventory = ./inventory.ini\nhost_key_checking = False\ntimeout = 30\n</code></pre> <ul> <li>Inventory \u4e0e\u8fde\u901a\u6027</li> </ul> <pre><code># inventory.ini\n[web]\nweb01 ansible_host=10.0.0.11 ansible_user=ubuntu\nweb02 ansible_host=10.0.0.12 ansible_user=ubuntu\n\n[db]\ndb01 ansible_host=10.0.1.10 ansible_user=postgres\n</code></pre> <pre><code>ansible -i inventory.ini all -m ping\nansible-inventory -i inventory.ini --graph\n</code></pre> <ul> <li>\u5e38\u7528 ad-hoc \u64cd\u4f5c</li> </ul> <pre><code># \u5305/\u670d\u52a1/\u6587\u4ef6\nansible web -i inventory.ini -b -m apt -a \"name=nginx state=present update_cache=yes\"\nansible web -i inventory.ini -b -m service -a \"name=nginx state=restarted\"\nansible web -i inventory.ini -b -m copy -a \"src=./nginx.conf dest=/etc/nginx/nginx.conf backup=yes\"\n</code></pre> <ul> <li>Playbook \u793a\u4f8b</li> </ul> <pre><code># site.yml\n- hosts: web\n  become: true\n  tasks:\n    - name: Install and start nginx\n      apt:\n        name: nginx\n        state: present\n        update_cache: yes\n    - name: Deploy config\n      template:\n        src: templates/nginx.conf.j2\n        dest: /etc/nginx/nginx.conf\n        backup: yes\n      notify: restart nginx\n  handlers:\n    - name: restart nginx\n      service:\n        name: nginx\n        state: restarted\n</code></pre> <pre><code>ansible-playbook -i inventory.ini site.yml --check --diff\nansible-playbook -i inventory.ini site.yml --limit web01 -t deploy\n</code></pre> <ul> <li>Vault \u4e0e Galaxy</li> </ul> <pre><code># \u673a\u5bc6\u52a0\u5bc6\nansible-vault create secrets.yml\nansible-vault view   secrets.yml\n\n# \u89d2\u8272\u7ba1\u7406\nansible-galaxy init role_web\nansible-galaxy install geerlingguy.nginx\n</code></pre> <ul> <li>\u5e38\u89c1\u8fd0\u7ef4\u573a\u666f</li> <li>\u6279\u91cf\u4fee\u590d\uff1a\u7528 ad-hoc \u5feb\u901f\u6267\u884c\u4e00\u6b21\u6027\u547d\u4ee4\uff08\u5982\u8c03\u6574\u65f6\u533a/\u5185\u6838\u53c2\u6570\uff09</li> <li>\u6807\u51c6\u5316\uff1aPlaybook + Roles \u6309\u73af\u5883\u5206\u5c42\uff08group_vars/host_vars\uff09</li> <li>\u53d8\u66f4\u5b89\u5168\uff1a--check \u9884\u6f14\u3001--diff \u67e5\u770b\u5dee\u5f02\uff0c\u5206\u6279\uff08--limit\uff09\u6267\u884c</li> </ul>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88-vSphere-Hadoop-Grafana-Ansible-Chef.html#chef","title":"Chef\uff08\u914d\u7f6e\u7ba1\u7406\uff09","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88-vSphere-Hadoop-Grafana-Ansible-Chef.html#_5","title":"\u90e8\u7f72\u65b9\u6cd5","text":"<ul> <li>Chef Infra Server\uff08\u81ea\u5efa\uff09</li> </ul> <pre><code># \u5b89\u88c5\u4e0e\u521d\u59cb\u5316\nsudo rpm -Uvh chef-server-core-*.rpm  # \u6216 dpkg -i\nsudo chef-server-ctl reconfigure\nsudo chef-server-ctl user-create admin Admin Admin admin@example.com '***' --filename admin.pem\nsudo chef-server-ctl org-create myorg 'My Org' --association_user admin --filename myorg-validator.pem\n</code></pre> <ul> <li>Chef Workstation</li> </ul> <pre><code>sudo dpkg -i chef-workstation_*.deb  # \u6216 rpm -Uvh\nknife configure\n</code></pre> <ul> <li>\u5f15\u5bfc\u8282\u70b9</li> </ul> <pre><code>knife bootstrap 10.0.0.21 -N web01 -x ubuntu --sudo --ssh-identity-file ~/.ssh/id_rsa\n</code></pre> <ul> <li>\u57fa\u7840\u547d\u4ee4</li> </ul> <pre><code># Workstation \u521d\u59cb\u5316\nchef --version\nknife configure\n\n# \u5f15\u5bfc\u8282\u70b9\uff08SSH\uff09\nknife bootstrap 10.0.0.21 -N web01 -x ubuntu --ssh-password ****** --sudo\n\n# \u8282\u70b9\u4e0e Cookbooks\nknife node list\nknife cookbook create myapp -o cookbooks\nknife cookbook upload myapp\n</code></pre> <ul> <li>Recipe \u793a\u4f8b\uff08myapp/recipes/default.rb\uff09</li> </ul> <pre><code>package 'nginx' do\n  action :install\nend\n\nservice 'nginx' do\n  action [:enable, :start]\nend\n\ncookbook_file '/usr/share/nginx/html/index.html' do\n  source 'index.html'\n  owner 'root'\n  group 'root'\n  mode '0644'\nend\n</code></pre> <ul> <li>Policyfile\uff08\u63a8\u8350\u66ff\u4ee3\u73af\u5883+\u89d2\u8272\u7684\u4f9d\u8d56\u9501\u5b9a\uff09</li> </ul> <pre><code># Policyfile.rb\nname 'myapp'\ndefault_source :supermarket\nrun_list 'myapp::default'\ncookbook 'myapp', path: './cookbooks/myapp'\n</code></pre> <pre><code>chef install\nchef export . ./policy_export\n</code></pre> <ul> <li>\u5e38\u89c1\u8fd0\u7ef4\u573a\u666f</li> <li>\u6279\u91cf\u53d8\u66f4\uff1a\u66f4\u65b0 cookbook \u2192 <code>knife cookbook upload</code> \u2192 \u8282\u70b9 <code>chef-client</code> \u5468\u671f\u62c9\u53d6</li> <li>\u5206\u5c42\u6cbb\u7406\uff1aPolicyfile/\u73af\u5883\u5206\u652f\uff1b\u6570\u636e\u5305\uff08data bag\uff09\u5b58\u653e\u5bc6\u94a5\u4e0e\u914d\u7f6e</li> <li>\u5de1\u68c0\u4e0e\u4fee\u590d\uff1a<code>ohai</code> \u91c7\u96c6\u4e8b\u5b9e\uff1b<code>chef-client -o 'recipe[myapp::fix]'</code> \u6307\u5b9a\u4e00\u6b21\u6027\u4fee\u590d</li> </ul>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT-%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88-vSphere-Hadoop-Grafana-Ansible-Chef.html#_6","title":"\u5907\u6ce8\u4e0e\u5efa\u8bae","text":"<ul> <li>\u7edf\u4e00\u51ed\u636e\u4e0e\u654f\u611f\u4fe1\u606f\u7ba1\u7406\uff08Vault/KMS/Secret Manager\uff09\uff0c\u907f\u514d\u660e\u6587\u51fa\u73b0\u5728\u811a\u672c\u4e2d</li> <li>\u7070\u5ea6\u4e0e\u5206\u6279\uff1a\u4ece 1 \u53f0 \u2192 10% \u2192 50% \u2192 \u5168\u91cf\uff0c\u914d\u5408\u76d1\u63a7\u4e0e\u56de\u6eda</li> <li>\u5c06\u5173\u952e\u64cd\u4f5c\u6c89\u6dc0\u4e3a\u6807\u51c6\u4f5c\u4e1a\u811a\u672c\u4e0e Playbook/Cookbook\uff0c\u7eb3\u5165 CI</li> <li>\u5efa\u7acb\u53d8\u66f4\u524d\u540e\u201c\u57fa\u7ebf\u5feb\u7167\u201d\uff08vSphere \u5feb\u7167 / HDFS \u72b6\u6001 / Grafana Dashboard \u5bfc\u51fa\uff09\u4ee5\u4fbf\u5feb\u901f\u56de\u6eda</li> </ul>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html","title":"\u4f01\u4e1a IT \u7ba1\u7406\u5458\u65b0\u5458\u5de5\u7b14\u8bb0\u672c\u914d\u7f6e\u6307\u5357","text":"<p>\u9002\u7528\u8bfb\u8005\uff1a\u4f01\u4e1a IT \u7ba1\u7406\u5458\u3001\u684c\u9762\u652f\u6301\u5de5\u7a0b\u5e08 \u76ee\u6807\uff1a\u6807\u51c6\u5316\u65b0\u5458\u5de5\u7b14\u8bb0\u672c\u914d\u7f6e\u6d41\u7a0b\uff0c\u4ece\u786c\u4ef6\u51c6\u5907\u5230\u8f6f\u4ef6\u90e8\u7f72\uff0c\u786e\u4fdd\u5feb\u901f\u3001\u5b89\u5168\u3001\u5408\u89c4\u5730\u4ea4\u4ed8\u8bbe\u5907\u3002</p>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#1-it","title":"1. \u65b0\u5458\u5de5\u5165\u804c IT \u6d41\u7a0b","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#11-hr","title":"1.1 \u5165\u804c\u524d\u51c6\u5907\uff08HR \u901a\u77e5\u540e\uff09","text":"<pre><code>\u65f6\u95f4\u7ebf\uff1a\u5165\u804c\u524d 3-5 \u4e2a\u5de5\u4f5c\u65e5\n\n\u4efb\u52a1\u6e05\u5355\uff1a\n\u25a1 \u6536\u5230 HR \u5165\u804c\u901a\u77e5\uff08\u59d3\u540d\u3001\u90e8\u95e8\u3001\u804c\u4f4d\u3001\u5165\u804c\u65e5\u671f\uff09\n\u25a1 \u786e\u8ba4\u786c\u4ef6\u9700\u6c42\uff08\u7b14\u8bb0\u672c\u578b\u53f7\u3001\u663e\u793a\u5668\u3001\u914d\u4ef6\uff09\n\u25a1 \u51c6\u5907\u786c\u4ef6\u8bbe\u5907\uff08\u4ece\u5e93\u5b58\u6216\u91c7\u8d2d\uff09\n\u25a1 \u521b\u5efa AD \u8d26\u53f7\n\u25a1 \u521b\u5efa\u90ae\u7bb1\u8d26\u53f7\n\u25a1 \u5206\u914d\u6743\u9650\uff08\u6587\u4ef6\u5939\u3001\u5e94\u7528\u7cfb\u7edf\uff09\n\u25a1 \u914d\u7f6e\u7b14\u8bb0\u672c\u7535\u8111\n\u25a1 \u51c6\u5907\u6b22\u8fce\u90ae\u4ef6\u548c\u5165\u804c\u6587\u6863\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#12","title":"1.2 \u5165\u804c\u5f53\u5929","text":"<pre><code>\u4efb\u52a1\u6e05\u5355\uff1a\n\u25a1 \u4ea4\u4ed8\u7b14\u8bb0\u672c\u7535\u8111\u548c\u914d\u4ef6\n\u25a1 \u534f\u52a9\u9996\u6b21\u767b\u5f55\n\u25a1 \u914d\u7f6e Outlook \u90ae\u7bb1\n\u25a1 \u6620\u5c04\u7f51\u7edc\u9a71\u52a8\u5668\n\u25a1 \u5b89\u88c5\u90e8\u95e8\u4e13\u7528\u8f6f\u4ef6\n\u25a1 \u57f9\u8bad\u57fa\u672c\u64cd\u4f5c\uff08VPN\u3001\u6253\u5370\u673a\u3001\u6587\u4ef6\u5171\u4eab\uff09\n\u25a1 \u7b7e\u7f72 IT \u8d44\u4ea7\u9886\u7528\u5355\n\u25a1 \u7b7e\u7f72\u4fe1\u606f\u5b89\u5168\u534f\u8bae\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#2","title":"2. \u786c\u4ef6\u51c6\u5907","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#21","title":"2.1 \u6807\u51c6\u914d\u7f6e","text":"\u804c\u4f4d\u7c7b\u578b \u7b14\u8bb0\u672c\u578b\u53f7 \u914d\u7f6e \u914d\u4ef6 \u666e\u901a\u5458\u5de5 Dell Latitude 5440 i5-1345U, 16GB, 512GB SSD \u9f20\u6807\u3001\u7535\u8111\u5305 \u5de5\u7a0b\u5e08/\u7814\u53d1 Dell Precision 5680 i7-13800H, 32GB, 1TB SSD \u9f20\u6807\u3001\u6269\u5c55\u575e\u300127\" \u663e\u793a\u5668 \u9ad8\u7ba1 Dell Latitude 9440 i7-1365U, 32GB, 1TB SSD \u9f20\u6807\u3001\u7535\u8111\u5305\u3001\u964d\u566a\u8033\u673a \u751f\u4ea7\u64cd\u4f5c\u5458 \u7626\u5ba2\u6237\u7aef HP t640, 8GB, 32GB SSD \u952e\u76d8\u3001\u9f20\u6807"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#22","title":"2.2 \u786c\u4ef6\u68c0\u67e5","text":"<pre><code>\u5f00\u7bb1\u68c0\u67e5\uff1a\n\u25a1 \u5916\u89c2\u65e0\u635f\u574f\n\u25a1 \u5e8f\u5217\u53f7\u4e0e\u91c7\u8d2d\u5355\u4e00\u81f4\n\u25a1 \u914d\u4ef6\u9f50\u5168\uff08\u7535\u6e90\u9002\u914d\u5668\u3001\u8bf4\u660e\u4e66\uff09\n\u25a1 \u5f00\u673a\u6d4b\u8bd5\uff08BIOS\u3001\u786c\u4ef6\u81ea\u68c0\uff09\n\u25a1 \u5c4f\u5e55\u65e0\u574f\u70b9\n\u25a1 \u952e\u76d8\u3001\u89e6\u6478\u677f\u6b63\u5e38\n\u25a1 \u7f51\u5361\u3001WiFi \u6b63\u5e38\n\u25a1 \u6444\u50cf\u5934\u3001\u9ea6\u514b\u98ce\u6b63\u5e38\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#23","title":"2.3 \u8d44\u4ea7\u767b\u8bb0","text":"<pre><code>\u8bb0\u5f55\u4fe1\u606f\uff1a\n- \u8d44\u4ea7\u7f16\u53f7\uff1aIT-NB-2025-001\n- \u8bbe\u5907\u578b\u53f7\uff1aDell Latitude 5440\n- \u5e8f\u5217\u53f7\uff1aABCD1234\n- \u91c7\u8d2d\u65e5\u671f\uff1a2025-11-01\n- \u4fdd\u4fee\u671f\uff1a3 \u5e74\uff08\u81f3 2028-11-01\uff09\n- \u5206\u914d\u7ed9\uff1a\u5f20\u4e09\uff08IT \u90e8\u95e8\uff09\n- \u5206\u914d\u65e5\u671f\uff1a2025-11-11\n\n\u5de5\u5177\uff1a\n- Excel \u8868\u683c\n- \u8d44\u4ea7\u7ba1\u7406\u7cfb\u7edf\uff08ServiceNow\u3001Lansweeper\uff09\n- \u8d34\u8d44\u4ea7\u6807\u7b7e\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#3","title":"3. \u64cd\u4f5c\u7cfb\u7edf\u5b89\u88c5\u4e0e\u914d\u7f6e","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#31-windows-1011-enterprise","title":"3.1 \u5b89\u88c5 Windows 10/11 Enterprise","text":"<pre><code>\u65b9\u6cd5 1\uff1a\u4f7f\u7528\u5382\u5546\u9884\u88c5\u955c\u50cf\uff08\u63a8\u8350\uff09\n- Dell\u3001HP \u7b49\u5382\u5546\u63d0\u4f9b\u4f01\u4e1a\u7248\u9884\u88c5\u955c\u50cf\n- \u4f18\u70b9\uff1a\u9a71\u52a8\u9f50\u5168\u3001\u7701\u65f6\n- \u7f3a\u70b9\uff1a\u53ef\u80fd\u5305\u542b\u5382\u5546\u8f6f\u4ef6\n\n\u65b9\u6cd5 2\uff1a\u4f7f\u7528\u81ea\u5b9a\u4e49\u955c\u50cf\uff08MDT/SCCM\uff09\n- \u4f7f\u7528 Microsoft Deployment Toolkit (MDT) \u6216 SCCM\n- \u4f18\u70b9\uff1a\u6807\u51c6\u5316\u3001\u81ea\u52a8\u5316\n- \u7f3a\u70b9\uff1a\u9700\u8981\u524d\u671f\u51c6\u5907\n\n\u65b9\u6cd5 3\uff1a\u624b\u52a8\u5b89\u88c5\uff08\u5c0f\u89c4\u6a21\uff09\n- \u4f7f\u7528 Windows 10/11 Enterprise ISO\n- \u4f18\u70b9\uff1a\u7075\u6d3b\n- \u7f3a\u70b9\uff1a\u8017\u65f6\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#32-bios","title":"3.2 BIOS \u8bbe\u7f6e","text":"<pre><code>\u5f00\u673a\u6309 F2 \u8fdb\u5165 BIOS\uff1a\n\n\u5b89\u5168\u8bbe\u7f6e\uff1a\n\u25a1 \u8bbe\u7f6e BIOS \u7ba1\u7406\u5458\u5bc6\u7801\n\u25a1 \u542f\u7528 Secure Boot\n\u25a1 \u542f\u7528 TPM 2.0\n\u25a1 \u7981\u7528 Legacy Boot\uff08\u4ec5 UEFI\uff09\n\n\u542f\u52a8\u987a\u5e8f\uff1a\n\u25a1 1st Boot Device: Windows Boot Manager\n\u25a1 2nd Boot Device: Network Boot (PXE)\n\n\u5176\u4ed6\uff1a\n\u25a1 \u7981\u7528 USB Boot\uff08\u53ef\u9009\uff0c\u9632\u6b62\u672a\u6388\u6743\u542f\u52a8\uff09\n\u25a1 \u542f\u7528 Virtualization\uff08VT-x/AMD-V\uff09\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#33-windows","title":"3.3 Windows \u521d\u59cb\u914d\u7f6e","text":"<pre><code>\u5b89\u88c5\u540e\u9996\u6b21\u542f\u52a8\uff1a\n\n\u533a\u57df\u548c\u8bed\u8a00\uff1a\n- \u56fd\u5bb6/\u5730\u533a\uff1a\u4e2d\u56fd\n- \u65f6\u533a\uff1a(UTC+08:00) \u5317\u4eac\uff0c\u91cd\u5e86\uff0c\u9999\u6e2f\u7279\u522b\u884c\u653f\u533a\uff0c\u4e4c\u9c81\u6728\u9f50\n- \u952e\u76d8\u5e03\u5c40\uff1a\u4e2d\u6587\uff08\u7b80\u4f53\uff0c\u4e2d\u56fd\uff09\n\n\u7f51\u7edc\uff1a\n- \u8fde\u63a5\u5230\u516c\u53f8 WiFi \u6216\u6709\u7ebf\u7f51\u7edc\n\n\u8d26\u6237\uff1a\n- \u8df3\u8fc7 Microsoft \u8d26\u6237\n- \u521b\u5efa\u672c\u5730\u7ba1\u7406\u5458\u8d26\u6237\uff1aLocalAdmin\n- \u5bc6\u7801\uff1a\u590d\u6742\u5bc6\u7801\uff08\u8bb0\u5f55\u5728\u5bc6\u7801\u7ba1\u7406\u5668\uff09\n\n\u9690\u79c1\u8bbe\u7f6e\uff1a\n- \u5173\u95ed\u6240\u6709\u9065\u6d4b\u548c\u8bca\u65ad\u6570\u636e\uff08\u4f01\u4e1a\u73af\u5883\uff09\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#34-windows","title":"3.4 \u6fc0\u6d3b Windows","text":"<pre><code># \u4f7f\u7528 KMS \u6fc0\u6d3b\uff08\u4f01\u4e1a\u6279\u91cf\u8bb8\u53ef\uff09\nslmgr /ipk NPPR9-FWDCX-D2C8J-H872K-2YT43  # Windows 10 Enterprise KMS Client Key\nslmgr /skms kms.pharma.local:1688\nslmgr /ato\n\n# \u9a8c\u8bc1\u6fc0\u6d3b\u72b6\u6001\nslmgr /xpr\n# \u8f93\u51fa\uff1aWindows(R), Enterprise edition: The machine is permanently activated.\n\n# \u6216\u4f7f\u7528 MAK \u5bc6\u94a5\uff08\u4e00\u6b21\u6027\u6fc0\u6d3b\uff09\nslmgr /ipk XXXXX-XXXXX-XXXXX-XXXXX-XXXXX\nslmgr /ato\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#4","title":"4. \u52a0\u5165\u57df","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#41","title":"4.1 \u914d\u7f6e\u7f51\u7edc","text":"<pre><code># \u8bbe\u7f6e DNS \u6307\u5411\u57df\u63a7\nSet-DnsClientServerAddress -InterfaceAlias \"\u4ee5\u592a\u7f51\" -ServerAddresses (\"10.10.40.10\",\"10.10.40.11\")\n\n# \u9a8c\u8bc1 DNS\nnslookup pharma.local\n# \u5e94\u8fd4\u56de\u57df\u63a7 IP\uff1a10.10.40.10\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#42","title":"4.2 \u52a0\u5165\u57df","text":"<pre><code># \u65b9\u6cd5 1\uff1aPowerShell\nAdd-Computer -DomainName \"pharma.local\" `\n    -OUPath \"OU=Laptops,OU=Computers,OU=Shanghai,DC=pharma,DC=local\" `\n    -Credential (Get-Credential PHARMA\\Administrator) `\n    -Restart\n\n# \u65b9\u6cd5 2\uff1aGUI\n# 1. \u53f3\u952e\"\u6b64\u7535\u8111\" &gt; \u5c5e\u6027 &gt; \u66f4\u6539\u8bbe\u7f6e\n# 2. \u70b9\u51fb\"\u66f4\u6539\" &gt; \u9009\u62e9\"\u57df\" &gt; \u8f93\u5165 pharma.local\n# 3. \u8f93\u5165\u57df\u7ba1\u7406\u5458\u8d26\u53f7\u5bc6\u7801\n# 4. \u91cd\u542f\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#43","title":"4.3 \u91cd\u547d\u540d\u8ba1\u7b97\u673a","text":"<pre><code># \u8ba1\u7b97\u673a\u547d\u540d\u89c4\u8303\uff1a\n# \u683c\u5f0f\uff1a[\u5730\u70b9]-[\u7c7b\u578b]-[\u90e8\u95e8]-[\u5e8f\u53f7]\n# \u793a\u4f8b\uff1aSH-NB-IT-001\uff08\u4e0a\u6d77-\u7b14\u8bb0\u672c-IT\u90e8\u95e8-001\uff09\n\n# \u91cd\u547d\u540d\u5e76\u52a0\u5165\u57df\uff08\u4e00\u6b65\u5b8c\u6210\uff09\nAdd-Computer -DomainName \"pharma.local\" `\n    -NewName \"SH-NB-IT-001\" `\n    -OUPath \"OU=Laptops,OU=Computers,OU=Shanghai,DC=pharma,DC=local\" `\n    -Credential (Get-Credential PHARMA\\Administrator) `\n    -Restart\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#5","title":"5. \u5b89\u88c5\u57fa\u7840\u8f6f\u4ef6","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#51","title":"5.1 \u8f6f\u4ef6\u6e05\u5355","text":"<pre><code>\u5fc5\u88c5\u8f6f\u4ef6\uff08\u6240\u6709\u5458\u5de5\uff09\uff1a\n\u25a1 Microsoft Office 365 ProPlus\n\u25a1 Google Chrome / Microsoft Edge\n\u25a1 Adobe Acrobat Reader DC\n\u25a1 7-Zip\n\u25a1 \u5fae\u4fe1\u4f01\u4e1a\u7248\n\u25a1 \u9489\u9489/\u98de\u4e66\uff08\u5982\u4f7f\u7528\uff09\n\u25a1 Symantec Endpoint Protection / CrowdStrike\uff08\u9632\u75c5\u6bd2\uff09\n\u25a1 Cisco AnyConnect\uff08VPN\uff09\n\nIT \u90e8\u95e8\u989d\u5916\u8f6f\u4ef6\uff1a\n\u25a1 PuTTY / MobaXterm\n\u25a1 WinSCP / FileZilla\n\u25a1 Remote Desktop Manager\n\u25a1 Wireshark\n\u25a1 Visual Studio Code\n\u25a1 Python 3.x\n\n\u7814\u53d1\u90e8\u95e8\u989d\u5916\u8f6f\u4ef6\uff1a\n\u25a1 ChemDraw\n\u25a1 GraphPad Prism\n\u25a1 Python / R\n\u25a1 Git\n\u25a1 Anaconda\n\n\u8d28\u91cf\u90e8\u95e8\u989d\u5916\u8f6f\u4ef6\uff1a\n\u25a1 Minitab\n\u25a1 JMP\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#52-powershell","title":"5.2 \u81ea\u52a8\u5316\u90e8\u7f72\uff08\u4f7f\u7528 PowerShell\uff09","text":"<pre><code># \u4f7f\u7528 Chocolatey \u5305\u7ba1\u7406\u5668\n# \u5b89\u88c5 Chocolatey\nSet-ExecutionPolicy Bypass -Scope Process -Force\n[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072\niex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))\n\n# \u5b89\u88c5\u57fa\u7840\u8f6f\u4ef6\nchoco install googlechrome -y\nchoco install adobereader -y\nchoco install 7zip -y\nchoco install vlc -y\nchoco install notepadplusplus -y\n\n# \u6216\u4f7f\u7528 Winget\uff08Windows 11 \u5185\u7f6e\uff09\nwinget install --id Google.Chrome --silent\nwinget install --id Adobe.Acrobat.Reader.64-bit --silent\nwinget install --id 7zip.7zip --silent\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#53-office-365","title":"5.3 Office 365 \u90e8\u7f72","text":"<pre><code># \u4f7f\u7528 Office Deployment Tool (ODT)\n# 1. \u4e0b\u8f7d ODT\uff1ahttps://www.microsoft.com/en-us/download/details.aspx?id=49117\n# 2. \u521b\u5efa\u914d\u7f6e\u6587\u4ef6\uff1aconfiguration.xml\n\n# configuration.xml \u793a\u4f8b\uff1a\n&lt;Configuration&gt;\n  &lt;Add OfficeClientEdition=\"64\" Channel=\"MonthlyEnterprise\"&gt;\n    &lt;Product ID=\"O365ProPlusRetail\"&gt;\n      &lt;Language ID=\"zh-cn\" /&gt;\n      &lt;Language ID=\"en-us\" /&gt;\n      &lt;ExcludeApp ID=\"Groove\" /&gt;\n      &lt;ExcludeApp ID=\"Lync\" /&gt;\n    &lt;/Product&gt;\n  &lt;/Add&gt;\n  &lt;Display Level=\"None\" AcceptEULA=\"TRUE\" /&gt;\n  &lt;Property Name=\"AUTOACTIVATE\" Value=\"1\" /&gt;\n&lt;/Configuration&gt;\n\n# 3. \u4e0b\u8f7d Office \u5b89\u88c5\u6587\u4ef6\n.\\setup.exe /download configuration.xml\n\n# 4. \u5b89\u88c5 Office\n.\\setup.exe /configure configuration.xml\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#54-gpo","title":"5.4 \u901a\u8fc7 GPO \u90e8\u7f72\u8f6f\u4ef6","text":"<pre><code>\u6b65\u9aa4\uff1a\n1. \u5c06 MSI \u5b89\u88c5\u5305\u653e\u5230\u7f51\u7edc\u5171\u4eab\uff1a\\\\pharma.local\\software\\\n2. \u6253\u5f00 GPMC\uff08\u7ec4\u7b56\u7565\u7ba1\u7406\u63a7\u5236\u53f0\uff09\n3. \u521b\u5efa\u65b0 GPO\uff1aSoftware Deployment - Chrome\n4. \u7f16\u8f91 GPO\uff1a\n   - Computer Configuration &gt; Policies &gt; Software Settings &gt; Software installation\n   - \u53f3\u952e &gt; New &gt; Package\n   - \u9009\u62e9 \\\\pharma.local\\software\\chrome.msi\n   - \u9009\u62e9 Assigned\uff08\u5f3a\u5236\u5b89\u88c5\uff09\n5. \u94fe\u63a5 GPO \u5230\u76ee\u6807 OU\n6. \u5ba2\u6237\u7aef\u8fd0\u884c\uff1agpupdate /force\n7. \u91cd\u542f\u540e\u81ea\u52a8\u5b89\u88c5\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#6","title":"6. \u5b89\u5168\u914d\u7f6e","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#61-bitlocker","title":"6.1 \u542f\u7528 BitLocker \u52a0\u5bc6","text":"<pre><code># \u68c0\u67e5 TPM \u72b6\u6001\nGet-Tpm\n\n# \u542f\u7528 BitLocker\uff08\u9700\u8981 TPM 2.0\uff09\nEnable-BitLocker -MountPoint \"C:\" -EncryptionMethod XtsAes256 -UsedSpaceOnly -TpmProtector\n\n# \u5907\u4efd\u6062\u590d\u5bc6\u94a5\u5230 AD\nBackup-BitLockerKeyProtector -MountPoint \"C:\" -KeyProtectorId (Get-BitLockerVolume -MountPoint \"C:\").KeyProtector[0].KeyProtectorId\n\n# \u67e5\u770b BitLocker \u72b6\u6001\nGet-BitLockerVolume\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#62-windows-defender","title":"6.2 \u914d\u7f6e Windows Defender","text":"<pre><code># \u542f\u7528\u5b9e\u65f6\u4fdd\u62a4\nSet-MpPreference -DisableRealtimeMonitoring $false\n\n# \u542f\u7528\u4e91\u4fdd\u62a4\nSet-MpPreference -MAPSReporting Advanced\n\n# \u542f\u7528\u81ea\u52a8\u6837\u672c\u63d0\u4ea4\nSet-MpPreference -SubmitSamplesConsent SendAllSamples\n\n# \u6dfb\u52a0\u6392\u9664\u9879\uff08\u5982\u9700\u8981\uff09\nAdd-MpPreference -ExclusionPath \"C:\\Program Files\\CustomApp\"\n\n# \u66f4\u65b0\u75c5\u6bd2\u5b9a\u4e49\nUpdate-MpSignature\n\n# \u8fd0\u884c\u5feb\u901f\u626b\u63cf\nStart-MpScan -ScanType QuickScan\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#63-windows","title":"6.3 \u914d\u7f6e Windows \u9632\u706b\u5899","text":"<pre><code># \u542f\u7528\u9632\u706b\u5899\uff08\u6240\u6709\u914d\u7f6e\u6587\u4ef6\uff09\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled True\n\n# \u67e5\u770b\u9632\u706b\u5899\u72b6\u6001\nGet-NetFirewallProfile | Select-Object Name, Enabled\n\n# \u5141\u8bb8\u7279\u5b9a\u7a0b\u5e8f\uff08\u793a\u4f8b\uff1a\u5141\u8bb8 Chrome\uff09\nNew-NetFirewallRule -DisplayName \"Allow Chrome\" -Direction Inbound -Program \"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\" -Action Allow\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#64","title":"6.4 \u7981\u7528\u4e0d\u5fc5\u8981\u7684\u670d\u52a1","text":"<pre><code># \u7981\u7528 Windows Search\uff08\u53ef\u9009\uff0c\u8282\u7701\u8d44\u6e90\uff09\nStop-Service -Name \"WSearch\" -Force\nSet-Service -Name \"WSearch\" -StartupType Disabled\n\n# \u7981\u7528 Xbox \u670d\u52a1\nGet-Service -Name \"XblAuthManager\",\"XblGameSave\",\"XboxNetApiSvc\",\"XboxGipSvc\" | Stop-Service -Force\nGet-Service -Name \"XblAuthManager\",\"XblGameSave\",\"XboxNetApiSvc\",\"XboxGipSvc\" | Set-Service -StartupType Disabled\n\n# \u7981\u7528 Telemetry\nStop-Service -Name \"DiagTrack\" -Force\nSet-Service -Name \"DiagTrack\" -StartupType Disabled\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#7","title":"7. \u7528\u6237\u914d\u7f6e","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#71-ad","title":"7.1 \u521b\u5efa AD \u7528\u6237\u8d26\u53f7","text":"<pre><code># \u5728\u57df\u63a7\u4e0a\u6267\u884c\nNew-ADUser `\n    -Name \"\u5f20\u4e09\" `\n    -GivenName \"\u4e09\" `\n    -Surname \"\u5f20\" `\n    -SamAccountName \"zhang.san\" `\n    -UserPrincipalName \"zhang.san@pharma.local\" `\n    -Path \"OU=IT,OU=Users,OU=Shanghai,DC=pharma,DC=local\" `\n    -AccountPassword (ConvertTo-SecureString \"TempP@ssw0rd!\" -AsPlainText -Force) `\n    -Enabled $true `\n    -ChangePasswordAtLogon $true `\n    -EmailAddress \"zhang.san@pharma.com\" `\n    -Title \"IT Support Engineer\" `\n    -Department \"IT\" `\n    -Company \"Pharma Corp\" `\n    -OfficePhone \"+86-21-12345678\" `\n    -MobilePhone \"+86-138-0000-0000\"\n\n# \u6dfb\u52a0\u5230\u7ec4\nAdd-ADGroupMember -Identity \"GG_IT_Staff\" -Members \"zhang.san\"\nAdd-ADGroupMember -Identity \"GG_VPN_Users\" -Members \"zhang.san\"\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#72-exchange","title":"7.2 \u521b\u5efa\u90ae\u7bb1\uff08Exchange\uff09","text":"<pre><code># \u5728 Exchange \u670d\u52a1\u5668\u4e0a\u6267\u884c\nEnable-Mailbox -Identity \"zhang.san\" -Database \"Mailbox Database 01\"\n\n# \u8bbe\u7f6e\u90ae\u7bb1\u914d\u989d\nSet-Mailbox -Identity \"zhang.san\" -IssueWarningQuota 45GB -ProhibitSendQuota 49GB -ProhibitSendReceiveQuota 50GB\n\n# \u6dfb\u52a0\u90ae\u7bb1\u6743\u9650\uff08\u5982\u9700\u8981\uff09\nAdd-MailboxPermission -Identity \"shared.mailbox@pharma.com\" -User \"zhang.san\" -AccessRights FullAccess -InheritanceType All\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#73","title":"7.3 \u5206\u914d\u6587\u4ef6\u5939\u6743\u9650","text":"<pre><code># \u5728\u6587\u4ef6\u670d\u52a1\u5668\u4e0a\u6267\u884c\n# \u6dfb\u52a0\u7528\u6237\u5230\u6587\u4ef6\u5939\u6743\u9650\u7ec4\nAdd-ADGroupMember -Identity \"GG_FileServer_IT_Write\" -Members \"zhang.san\"\n\n# \u6216\u76f4\u63a5\u8bbe\u7f6e NTFS \u6743\u9650\n$acl = Get-Acl \"\\\\pharma.local\\shares\\IT\"\n$permission = \"PHARMA\\zhang.san\",\"Modify\",\"Allow\"\n$accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule $permission\n$acl.SetAccessRule($accessRule)\nSet-Acl \"\\\\pharma.local\\shares\\IT\" $acl\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#8","title":"8. \u5ba2\u6237\u7aef\u914d\u7f6e","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#81-outlook","title":"8.1 \u914d\u7f6e Outlook","text":"<pre><code>\u81ea\u52a8\u914d\u7f6e\uff08\u63a8\u8350\uff09\uff1a\n1. \u6253\u5f00 Outlook\n2. \u8f93\u5165\u90ae\u7bb1\u5730\u5740\uff1azhang.san@pharma.com\n3. \u8f93\u5165\u57df\u8d26\u53f7\u5bc6\u7801\uff1aPHARMA\\zhang.san\n4. Outlook \u81ea\u52a8\u53d1\u73b0 Exchange \u670d\u52a1\u5668\u5e76\u914d\u7f6e\n\n\u624b\u52a8\u914d\u7f6e\uff1a\n1. \u63a7\u5236\u9762\u677f &gt; \u90ae\u4ef6 &gt; \u7535\u5b50\u90ae\u4ef6\u8d26\u6237 &gt; \u65b0\u5efa\n2. \u9009\u62e9\"\u624b\u52a8\u8bbe\u7f6e\u6216\u5176\u4ed6\u670d\u52a1\u5668\u7c7b\u578b\"\n3. \u9009\u62e9\"Microsoft Exchange\"\n4. \u670d\u52a1\u5668\uff1aexchange.pharma.local\n5. \u7528\u6237\u540d\uff1azhang.san\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#82","title":"8.2 \u6620\u5c04\u7f51\u7edc\u9a71\u52a8\u5668","text":"<pre><code># \u65b9\u6cd5 1\uff1aPowerShell\nNew-PSDrive -Name \"H\" -PSProvider FileSystem -Root \"\\\\pharma.local\\shares\\home\\zhang.san\" -Persist\nNew-PSDrive -Name \"S\" -PSProvider FileSystem -Root \"\\\\pharma.local\\shares\\IT\" -Persist\n\n# \u65b9\u6cd5 2\uff1a\u901a\u8fc7 GPO\uff08\u63a8\u8350\uff09\n# \u5728 GPO \u4e2d\u914d\u7f6e\uff1aUser Configuration &gt; Preferences &gt; Windows Settings &gt; Drive Maps\n# H: \u2192 \\\\pharma.local\\shares\\home\\%username%\n# S: \u2192 \\\\pharma.local\\shares\\IT\n\n# \u65b9\u6cd5 3\uff1a\u767b\u5f55\u811a\u672c\nnet use H: \\\\pharma.local\\shares\\home\\%username% /persistent:yes\nnet use S: \\\\pharma.local\\shares\\IT /persistent:yes\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#83","title":"8.3 \u5b89\u88c5\u6253\u5370\u673a","text":"<pre><code># \u65b9\u6cd5 1\uff1a\u901a\u8fc7\u6253\u5370\u670d\u52a1\u5668\nAdd-Printer -ConnectionName \"\\\\printserver.pharma.local\\HP-LaserJet-Floor3\"\n\n# \u65b9\u6cd5 2\uff1a\u901a\u8fc7 GPO \u90e8\u7f72\n# \u5728 GPO \u4e2d\u914d\u7f6e\uff1aUser Configuration &gt; Preferences &gt; Control Panel Settings &gt; Printers\n\n# \u65b9\u6cd5 3\uff1a\u624b\u52a8\u6dfb\u52a0\n# \u8bbe\u7f6e &gt; \u8bbe\u5907 &gt; \u6253\u5370\u673a\u548c\u626b\u63cf\u4eea &gt; \u6dfb\u52a0\u6253\u5370\u673a\n# \u9009\u62e9\"\u6211\u9700\u8981\u7684\u6253\u5370\u673a\u4e0d\u5728\u5217\u8868\u4e2d\"\n# \u9009\u62e9\"\u6309\u540d\u79f0\u9009\u62e9\u5171\u4eab\u6253\u5370\u673a\"\n# \u8f93\u5165\uff1a\\\\printserver.pharma.local\\HP-LaserJet-Floor3\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#84-vpn","title":"8.4 \u914d\u7f6e VPN","text":"<pre><code>Cisco AnyConnect \u914d\u7f6e\uff1a\n1. \u5b89\u88c5 Cisco AnyConnect \u5ba2\u6237\u7aef\n2. \u6253\u5f00 AnyConnect\n3. \u8f93\u5165 VPN \u670d\u52a1\u5668\u5730\u5740\uff1avpn.pharma.com\n4. \u8f93\u5165\u57df\u8d26\u53f7\uff1aPHARMA\\zhang.san\n5. \u8f93\u5165\u5bc6\u7801\n6. \u8f93\u5165 MFA \u4ee3\u7801\uff08\u5982\u542f\u7528\uff09\n7. \u8fde\u63a5\u6210\u529f\n\n\u81ea\u52a8\u914d\u7f6e\uff08\u901a\u8fc7 GPO\uff09\uff1a\n- \u9884\u914d\u7f6e VPN \u670d\u52a1\u5668\u5730\u5740\n- \u9884\u914d\u7f6e\u8bc1\u4e66\n- \u7528\u6237\u53ea\u9700\u8f93\u5165\u8d26\u53f7\u5bc6\u7801\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#9","title":"9. \u7cfb\u7edf\u4f18\u5316","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#91-windows","title":"9.1 Windows \u66f4\u65b0","text":"<pre><code># \u68c0\u67e5\u66f4\u65b0\nGet-WindowsUpdate\n\n# \u5b89\u88c5\u6240\u6709\u66f4\u65b0\nInstall-WindowsUpdate -AcceptAll -AutoReboot\n\n# \u6216\u901a\u8fc7 WSUS/SCCM \u96c6\u4e2d\u7ba1\u7406\uff08\u63a8\u8350\uff09\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#92","title":"9.2 \u6027\u80fd\u4f18\u5316","text":"<pre><code># \u7981\u7528\u89c6\u89c9\u6548\u679c\uff08\u63d0\u5347\u6027\u80fd\uff09\nSet-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\VisualEffects\" -Name \"VisualFXSetting\" -Value 2\n\n# \u7981\u7528\u4f11\u7720\uff08\u8282\u7701\u78c1\u76d8\u7a7a\u95f4\uff09\npowercfg /h off\n\n# \u6e05\u7406\u78c1\u76d8\ncleanmgr /sagerun:1\n\n# \u4f18\u5316 SSD\uff08\u542f\u7528 TRIM\uff09\nOptimize-Volume -DriveLetter C -ReTrim -Verbose\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#93","title":"9.3 \u7535\u6e90\u7ba1\u7406","text":"<pre><code># \u8bbe\u7f6e\u7535\u6e90\u8ba1\u5212\u4e3a\"\u9ad8\u6027\u80fd\"\uff08\u53f0\u5f0f\u673a\uff09\npowercfg /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c\n\n# \u6216\"\u5e73\u8861\"\uff08\u7b14\u8bb0\u672c\uff09\npowercfg /setactive 381b4222-f694-41f0-9685-ff5bb260df2e\n\n# \u8bbe\u7f6e\u5c4f\u5e55\u5173\u95ed\u65f6\u95f4\uff0810 \u5206\u949f\uff09\npowercfg /change monitor-timeout-ac 10\npowercfg /change monitor-timeout-dc 5\n\n# \u8bbe\u7f6e\u7761\u7720\u65f6\u95f4\uff0830 \u5206\u949f\uff09\npowercfg /change standby-timeout-ac 30\npowercfg /change standby-timeout-dc 15\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#10","title":"10. \u4ea4\u4ed8\u4e0e\u57f9\u8bad","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#101","title":"10.1 \u4ea4\u4ed8\u6e05\u5355","text":"<pre><code>\u786c\u4ef6\uff1a\n\u25a1 \u7b14\u8bb0\u672c\u7535\u8111\uff08\u5df2\u914d\u7f6e\uff09\n\u25a1 \u7535\u6e90\u9002\u914d\u5668\n\u25a1 \u9f20\u6807\n\u25a1 \u7535\u8111\u5305\n\u25a1 \u663e\u793a\u5668\uff08\u5982\u9002\u7528\uff09\n\u25a1 \u6269\u5c55\u575e\uff08\u5982\u9002\u7528\uff09\n\n\u8d26\u53f7\u4fe1\u606f\uff1a\n\u25a1 \u57df\u8d26\u53f7\uff1aPHARMA\\zhang.san\n\u25a1 \u521d\u59cb\u5bc6\u7801\uff1aTempP@ssw0rd!\uff08\u9996\u6b21\u767b\u5f55\u9700\u66f4\u6539\uff09\n\u25a1 \u90ae\u7bb1\uff1azhang.san@pharma.com\n\u25a1 VPN \u5730\u5740\uff1avpn.pharma.com\n\n\u6587\u6863\uff1a\n\u25a1 IT \u5165\u804c\u6307\u5357\n\u25a1 VPN \u4f7f\u7528\u8bf4\u660e\n\u25a1 \u6587\u4ef6\u5171\u4eab\u8bbf\u95ee\u6307\u5357\n\u25a1 \u6253\u5370\u673a\u4f7f\u7528\u8bf4\u660e\n\u25a1 IT \u670d\u52a1\u53f0\u8054\u7cfb\u65b9\u5f0f\n\n\u7b7e\u7f72\uff1a\n\u25a1 IT \u8d44\u4ea7\u9886\u7528\u5355\n\u25a1 \u4fe1\u606f\u5b89\u5168\u534f\u8bae\n\u25a1 \u53ef\u63a5\u53d7\u4f7f\u7528\u653f\u7b56\uff08AUP\uff09\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#102-15","title":"10.2 \u7528\u6237\u57f9\u8bad\uff0815 \u5206\u949f\uff09","text":"<pre><code>\u57f9\u8bad\u5185\u5bb9\uff1a\n1. \u9996\u6b21\u767b\u5f55\uff08\u57df\u8d26\u53f7\uff09\n2. \u66f4\u6539\u5bc6\u7801\n3. \u914d\u7f6e Outlook \u90ae\u7bb1\n4. \u8bbf\u95ee\u6587\u4ef6\u5171\u4eab\uff08H: \u76d8\u3001S: \u76d8\uff09\n5. \u8fde\u63a5 VPN\n6. \u5b89\u88c5\u6253\u5370\u673a\n7. \u63d0\u4ea4 IT \u5de5\u5355\uff08ServiceNow/\u90ae\u4ef6\uff09\n8. \u4fe1\u606f\u5b89\u5168\u6ce8\u610f\u4e8b\u9879\uff1a\n   - \u4e0d\u8981\u5171\u4eab\u5bc6\u7801\n   - \u4e0d\u8981\u70b9\u51fb\u53ef\u7591\u90ae\u4ef6\u94fe\u63a5\n   - \u79bb\u5f00\u65f6\u9501\u5b9a\u7535\u8111\uff08Win+L\uff09\n   - \u4e0d\u8981\u5b89\u88c5\u672a\u6388\u6743\u8f6f\u4ef6\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#103","title":"10.3 \u6b22\u8fce\u90ae\u4ef6\u6a21\u677f","text":"<pre><code>\u4e3b\u9898\uff1a\u6b22\u8fce\u52a0\u5165 Example Corp - IT \u8d26\u53f7\u4fe1\u606f\n\n\u5c0a\u656c\u7684\u5f20\u4e09\uff0c\n\n\u6b22\u8fce\u52a0\u5165 Example Corp\uff01\n\n\u60a8\u7684 IT \u8d26\u53f7\u5df2\u521b\u5efa\uff0c\u8be6\u7ec6\u4fe1\u606f\u5982\u4e0b\uff1a\n\n\u57df\u8d26\u53f7\uff1aEXAMPLE\\zhang.san\n\u90ae\u7bb1\uff1azhang.san@example.com\n\u521d\u59cb\u5bc6\u7801\uff1aTempP@ssw0rd!\uff08\u9996\u6b21\u767b\u5f55\u9700\u66f4\u6539\uff09\n\n\u5e38\u7528\u8d44\u6e90\uff1a\n- \u516c\u53f8\u5185\u7f51\uff1ahttps://intranet.example.com\n- IT \u670d\u52a1\u53f0\uff1ahttps://servicedesk.example.com\n- \u6587\u4ef6\u5171\u4eab\uff1a\\\\example.local\\shares\n- VPN \u5730\u5740\uff1avpn.example.com\n\n\u5982\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u8bf7\u8054\u7cfb IT \u670d\u52a1\u53f0\uff1a\n- \u90ae\u7bb1\uff1ait.support@example.com\n- \u7535\u8bdd\uff1a+86-21-1234-5678\n- \u5de5\u5355\u7cfb\u7edf\uff1ahttps://servicedesk.example.com\n\n\u795d\u5de5\u4f5c\u987a\u5229\uff01\n\nIT \u90e8\u95e8\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#11","title":"11. \u6545\u969c\u6392\u67e5","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#111","title":"11.1 \u5e38\u89c1\u95ee\u9898","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#1","title":"\u95ee\u9898 1\uff1a\u65e0\u6cd5\u52a0\u5165\u57df","text":"<pre><code>\u9519\u8bef\uff1a\u627e\u4e0d\u5230\u7f51\u7edc\u8def\u5f84\n\n\u89e3\u51b3\u65b9\u6848\uff1a\n1. \u68c0\u67e5 DNS\uff1anslookup example.local\n2. Ping \u57df\u63a7\uff1aping dc01.example.local\n3. \u68c0\u67e5\u9632\u706b\u5899\n4. \u68c0\u67e5\u65f6\u95f4\u540c\u6b65\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#2outlook","title":"\u95ee\u9898 2\uff1aOutlook \u65e0\u6cd5\u8fde\u63a5","text":"<pre><code>\u9519\u8bef\uff1a\u65e0\u6cd5\u8fde\u63a5\u5230 Exchange \u670d\u52a1\u5668\n\n\u89e3\u51b3\u65b9\u6848\uff1a\n1. \u68c0\u67e5\u7f51\u7edc\u8fde\u63a5\n2. \u6d4b\u8bd5 Autodiscover\uff1ahttps://testconnectivity.microsoft.com\n3. \u624b\u52a8\u914d\u7f6e Exchange \u670d\u52a1\u5668\u5730\u5740\n4. \u68c0\u67e5\u90ae\u7bb1\u662f\u5426\u5df2\u521b\u5efa\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#3_1","title":"\u95ee\u9898 3\uff1a\u65e0\u6cd5\u8bbf\u95ee\u6587\u4ef6\u5171\u4eab","text":"<pre><code>\u9519\u8bef\uff1a\u6ca1\u6709\u6743\u9650\u8bbf\u95ee\n\n\u89e3\u51b3\u65b9\u6848\uff1a\n1. \u68c0\u67e5\u7528\u6237\u662f\u5426\u5728\u6b63\u786e\u7684 AD \u7ec4\n2. \u68c0\u67e5 NTFS \u6743\u9650\n3. \u68c0\u67e5\u5171\u4eab\u6743\u9650\n4. \u8fd0\u884c\uff1agpupdate /force\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#12_1","title":"12. \u81ea\u52a8\u5316\u811a\u672c","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9AIT%E7%AE%A1%E7%90%86%E5%91%98%E6%96%B0%E5%91%98%E5%B7%A5%E7%AC%94%E8%AE%B0%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97.html#121","title":"12.1 \u4e00\u952e\u914d\u7f6e\u811a\u672c","text":"<pre><code># NewEmployeeSetup.ps1\nparam(\n    [string]$ComputerName,\n    [string]$Username\n)\n\n# 1. \u91cd\u547d\u540d\u8ba1\u7b97\u673a\u5e76\u52a0\u5165\u57df\nAdd-Computer -DomainName \"pharma.local\" `\n    -NewName $ComputerName `\n    -OUPath \"OU=Laptops,OU=Computers,OU=Shanghai,DC=pharma,DC=local\" `\n    -Credential (Get-Credential PHARMA\\Administrator) `\n    -Force\n\n# 2. \u5b89\u88c5\u57fa\u7840\u8f6f\u4ef6\nchoco install googlechrome adobereader 7zip -y\n\n# 3. \u542f\u7528 BitLocker\nEnable-BitLocker -MountPoint \"C:\" -EncryptionMethod XtsAes256 -UsedSpaceOnly -TpmProtector\n\n# 4. \u914d\u7f6e\u9632\u706b\u5899\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled True\n\n# 5. \u6620\u5c04\u7f51\u7edc\u9a71\u52a8\u5668\nNew-PSDrive -Name \"H\" -PSProvider FileSystem -Root \"\\\\pharma.local\\shares\\home\\$Username\" -Persist\n\n# 6. \u91cd\u542f\nRestart-Computer -Force\n</code></pre> <p>\u53c2\u8003\u8d44\u6e90\uff1a - Microsoft Endpoint Manager \u6587\u6863 - Windows 10/11 \u90e8\u7f72\u6307\u5357 - Active Directory \u6700\u4f73\u5b9e\u8df5</p>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html","title":"\u4f01\u4e1a\u6587\u4ef6\u670d\u52a1\u5668\u4e0e\u6743\u9650\u7ba1\u7406","text":"<p>\u9002\u7528\u8bfb\u8005\uff1a\u4f01\u4e1a IT \u7ba1\u7406\u5458\u3001\u7cfb\u7edf\u5de5\u7a0b\u5e08 \u76ee\u6807\uff1a\u90e8\u7f72 Windows \u6587\u4ef6\u670d\u52a1\u5668\uff0c\u914d\u7f6e\u5171\u4eab\u6587\u4ef6\u5939\u3001NTFS \u6743\u9650\u3001DFS \u547d\u540d\u7a7a\u95f4\uff0c\u5b9e\u73b0\u5b89\u5168\u3001\u9ad8\u6548\u7684\u6587\u4ef6\u5171\u4eab\u3002</p>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#1","title":"1. \u6587\u4ef6\u670d\u52a1\u5668\u6982\u8ff0","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#11","title":"1.1 \u6587\u4ef6\u670d\u52a1\u5668\u7684\u4f5c\u7528","text":"<ul> <li>\u96c6\u4e2d\u5b58\u50a8\uff1a\u7edf\u4e00\u7ba1\u7406\u4f01\u4e1a\u6587\u4ef6</li> <li>\u6743\u9650\u63a7\u5236\uff1a\u57fa\u4e8e AD \u7ec4\u7684\u7cbe\u7ec6\u6743\u9650\u7ba1\u7406</li> <li>\u6570\u636e\u5907\u4efd\uff1a\u96c6\u4e2d\u5907\u4efd\uff0c\u9632\u6b62\u6570\u636e\u4e22\u5931</li> <li>\u534f\u4f5c\u5171\u4eab\uff1a\u90e8\u95e8\u95f4\u6587\u4ef6\u5171\u4eab</li> <li>\u5ba1\u8ba1\u8ffd\u8e2a\uff1a\u8bb0\u5f55\u6587\u4ef6\u8bbf\u95ee\u548c\u4fee\u6539</li> </ul>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#12","title":"1.2 \u6587\u4ef6\u670d\u52a1\u5668\u67b6\u6784","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u6587\u4ef6\u670d\u52a1\u5668\u96c6\u7fa4                       \u2502\n\u2502                                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502  \u2502   FS01       \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502   FS02       \u2502      \u2502\n\u2502  \u2502 (\u4e3b\u6587\u4ef6\u670d\u52a1\u5668) \u2502  DFS   \u2502 (\u5907\u6587\u4ef6\u670d\u52a1\u5668) \u2502      \u2502\n\u2502  \u2502 10.10.40.30  \u2502  \u590d\u5236  \u2502 10.10.40.31  \u2502      \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2502         \u2502                        \u2502             \u2502\n\u2502         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518             \u2502\n\u2502                      \u2502                         \u2502\n\u2502         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510             \u2502\n\u2502         \u2502   DFS \u547d\u540d\u7a7a\u95f4           \u2502             \u2502\n\u2502         \u2502   \\\\pharma.local\\shares \u2502             \u2502\n\u2502         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                      \u2502\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502            \u2502            \u2502\n    \u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2510\n    \u2502 \u7528\u6237A   \u2502  \u2502 \u7528\u6237B   \u2502  \u2502 \u7528\u6237C   \u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#2","title":"2. \u73af\u5883\u51c6\u5907","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#21","title":"2.1 \u786c\u4ef6\u8981\u6c42","text":"\u7ec4\u4ef6 \u6700\u4f4e\u914d\u7f6e \u63a8\u8350\u914d\u7f6e\uff08500 \u7528\u6237\uff09 CPU 4 \u6838 8 \u6838 \u5185\u5b58 8GB 32GB \u78c1\u76d8 1TB 10TB+\uff08RAID 10\uff09 \u7f51\u7edc 1Gbps 10Gbps\uff08\u53cc\u7f51\u5361\uff09"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#22","title":"2.2 \u8f6f\u4ef6\u8981\u6c42","text":"<pre><code>\u64cd\u4f5c\u7cfb\u7edf\uff1a\n- Windows Server 2022 Standard/Datacenter\n\n\u89d2\u8272\u548c\u529f\u80fd\uff1a\n- File and Storage Services\n  - File Server\n  - DFS Namespaces\n  - DFS Replication\n  - File Server Resource Manager (FSRM)\n- Active Directory \u57df\u6210\u5458\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#23","title":"2.3 \u78c1\u76d8\u89c4\u5212","text":"<pre><code>\u78c1\u76d8\u914d\u7f6e\uff1a\n- C: \u76d8\uff08\u7cfb\u7edf\uff09\uff1a200GB\uff08RAID 1\uff09\n- D: \u76d8\uff08\u6570\u636e\uff09\uff1a10TB\uff08RAID 10\uff09\n- E: \u76d8\uff08\u5907\u4efd\uff09\uff1a5TB\uff08RAID 5\uff09\n\n\u6587\u4ef6\u5939\u7ed3\u6784\uff1a\nD:\\Shares\\\n\u251c\u2500\u2500 Departments\\\uff08\u90e8\u95e8\u6587\u4ef6\u5939\uff09\n\u2502   \u251c\u2500\u2500 IT\\\n\u2502   \u251c\u2500\u2500 RD\\\uff08\u7814\u53d1\uff09\n\u2502   \u251c\u2500\u2500 QA\\\uff08\u8d28\u91cf\uff09\n\u2502   \u251c\u2500\u2500 Production\\\uff08\u751f\u4ea7\uff09\n\u2502   \u2514\u2500\u2500 Admin\\\uff08\u884c\u653f\uff09\n\u251c\u2500\u2500 Projects\\\uff08\u9879\u76ee\u6587\u4ef6\u5939\uff09\n\u2502   \u251c\u2500\u2500 Project_A\\\n\u2502   \u2514\u2500\u2500 Project_B\\\n\u251c\u2500\u2500 Public\\\uff08\u516c\u5171\u6587\u4ef6\u5939\uff09\n\u2514\u2500\u2500 Home\\\uff08\u7528\u6237\u4e2a\u4eba\u6587\u4ef6\u5939\uff09\n    \u251c\u2500\u2500 zhang.san\\\n    \u2514\u2500\u2500 li.si\\\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#3","title":"3. \u5b89\u88c5\u6587\u4ef6\u670d\u52a1\u5668\u89d2\u8272","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#31","title":"3.1 \u5b89\u88c5\u89d2\u8272","text":"<pre><code># \u5b89\u88c5\u6587\u4ef6\u670d\u52a1\u5668\u89d2\u8272\nInstall-WindowsFeature -Name FS-FileServer, FS-DFS-Namespace, FS-DFS-Replication, FS-Resource-Manager -IncludeManagementTools\n\n# \u9a8c\u8bc1\u5b89\u88c5\nGet-WindowsFeature -Name FS-*\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\n# Display Name                                            Name                       Install State\n# ------------                                            ----                       -------------\n# [X] File and Storage Services                          FileAndStorage-Services        Installed\n#     [X] File and iSCSI Services                         File-Services                  Installed\n#         [X] File Server                                 FS-FileServer                  Installed\n#         [X] DFS Namespaces                              FS-DFS-Namespace               Installed\n#         [X] DFS Replication                             FS-DFS-Replication             Installed\n#         [X] File Server Resource Manager                FS-Resource-Manager            Installed\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#32","title":"3.2 \u914d\u7f6e\u670d\u52a1\u5668\u57fa\u672c\u4fe1\u606f","text":"<pre><code># \u8bbe\u7f6e\u8ba1\u7b97\u673a\u540d\nRename-Computer -NewName \"FS01\" -Restart\n\n# \u8bbe\u7f6e\u9759\u6001 IP\nNew-NetIPAddress -InterfaceAlias \"Ethernet\" -IPAddress 10.10.40.30 -PrefixLength 24 -DefaultGateway 10.10.40.1\nSet-DnsClientServerAddress -InterfaceAlias \"Ethernet\" -ServerAddresses (\"10.10.40.10\",\"10.10.40.11\")\n\n# \u52a0\u5165\u57df\nAdd-Computer -DomainName \"pharma.local\" -Credential (Get-Credential PHARMA\\Administrator) -Restart\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#4","title":"4. \u521b\u5efa\u5171\u4eab\u6587\u4ef6\u5939","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#41","title":"4.1 \u521b\u5efa\u6587\u4ef6\u5939\u7ed3\u6784","text":"<pre><code># \u521b\u5efa\u6839\u76ee\u5f55\nNew-Item -Path \"D:\\Shares\" -ItemType Directory\n\n# \u521b\u5efa\u90e8\u95e8\u6587\u4ef6\u5939\n$departments = @(\"IT\", \"RD\", \"QA\", \"Production\", \"Admin\")\nforeach ($dept in $departments) {\n    New-Item -Path \"D:\\Shares\\Departments\\$dept\" -ItemType Directory\n}\n\n# \u521b\u5efa\u9879\u76ee\u6587\u4ef6\u5939\nNew-Item -Path \"D:\\Shares\\Projects\" -ItemType Directory\n\n# \u521b\u5efa\u516c\u5171\u6587\u4ef6\u5939\nNew-Item -Path \"D:\\Shares\\Public\" -ItemType Directory\n\n# \u521b\u5efa\u7528\u6237\u4e2a\u4eba\u6587\u4ef6\u5939\nNew-Item -Path \"D:\\Shares\\Home\" -ItemType Directory\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#42-smb","title":"4.2 \u521b\u5efa SMB \u5171\u4eab","text":"<pre><code># \u5171\u4eab\u90e8\u95e8\u6587\u4ef6\u5939\nNew-SmbShare -Name \"IT\" -Path \"D:\\Shares\\Departments\\IT\" -FullAccess \"PHARMA\\Domain Admins\" -ChangeAccess \"PHARMA\\GG_IT_Staff\" -ReadAccess \"Everyone\"\n\nNew-SmbShare -Name \"RD\" -Path \"D:\\Shares\\Departments\\RD\" -FullAccess \"PHARMA\\Domain Admins\" -ChangeAccess \"PHARMA\\GG_RD_Staff\"\n\nNew-SmbShare -Name \"QA\" -Path \"D:\\Shares\\Departments\\QA\" -FullAccess \"PHARMA\\Domain Admins\" -ChangeAccess \"PHARMA\\GG_QA_Staff\"\n\n# \u5171\u4eab\u516c\u5171\u6587\u4ef6\u5939\nNew-SmbShare -Name \"Public\" -Path \"D:\\Shares\\Public\" -FullAccess \"PHARMA\\Domain Admins\" -ChangeAccess \"PHARMA\\Domain Users\"\n\n# \u5171\u4eab\u7528\u6237\u4e2a\u4eba\u6587\u4ef6\u5939\uff08\u9690\u85cf\u5171\u4eab\uff09\nNew-SmbShare -Name \"Home$\" -Path \"D:\\Shares\\Home\" -FullAccess \"PHARMA\\Domain Admins\" -ChangeAccess \"PHARMA\\Domain Users\"\n\n# \u67e5\u770b\u5171\u4eab\nGet-SmbShare\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#43-ntfs","title":"4.3 \u914d\u7f6e NTFS \u6743\u9650","text":"<pre><code># \u7981\u7528\u7ee7\u627f\u5e76\u590d\u5236\u73b0\u6709\u6743\u9650\n$acl = Get-Acl \"D:\\Shares\\Departments\\IT\"\n$acl.SetAccessRuleProtection($true, $true)\nSet-Acl \"D:\\Shares\\Departments\\IT\" $acl\n\n# \u79fb\u9664 Users \u7ec4\u6743\u9650\n$acl = Get-Acl \"D:\\Shares\\Departments\\IT\"\n$usersRule = New-Object System.Security.AccessControl.FileSystemAccessRule(\"BUILTIN\\Users\", \"ReadAndExecute\", \"ContainerInherit,ObjectInherit\", \"None\", \"Allow\")\n$acl.RemoveAccessRule($usersRule)\nSet-Acl \"D:\\Shares\\Departments\\IT\" $acl\n\n# \u6dfb\u52a0 IT \u90e8\u95e8\u6743\u9650\uff08\u4fee\u6539\uff09\n$acl = Get-Acl \"D:\\Shares\\Departments\\IT\"\n$itRule = New-Object System.Security.AccessControl.FileSystemAccessRule(\"PHARMA\\GG_IT_Staff\", \"Modify\", \"ContainerInherit,ObjectInherit\", \"None\", \"Allow\")\n$acl.SetAccessRule($itRule)\nSet-Acl \"D:\\Shares\\Departments\\IT\" $acl\n\n# \u6dfb\u52a0\u57df\u7ba1\u7406\u5458\u6743\u9650\uff08\u5b8c\u5168\u63a7\u5236\uff09\n$acl = Get-Acl \"D:\\Shares\\Departments\\IT\"\n$adminRule = New-Object System.Security.AccessControl.FileSystemAccessRule(\"PHARMA\\Domain Admins\", \"FullControl\", \"ContainerInherit,ObjectInherit\", \"None\", \"Allow\")\n$acl.SetAccessRule($adminRule)\nSet-Acl \"D:\\Shares\\Departments\\IT\" $acl\n\n# \u67e5\u770b\u6743\u9650\nGet-Acl \"D:\\Shares\\Departments\\IT\" | Format-List\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#5","title":"5. \u6743\u9650\u7ba1\u7406\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#51-agdlp","title":"5.1 AGDLP \u6743\u9650\u6a21\u578b","text":"<pre><code>AGDLP \u6a21\u578b\uff1a\n- Account\uff08\u7528\u6237\u8d26\u53f7\uff09\u2192 Global Group\uff08\u5168\u5c40\u7ec4\uff09\u2192 Domain Local Group\uff08\u57df\u672c\u5730\u7ec4\uff09\u2192 Permission\uff08\u6743\u9650\uff09\n\n\u793a\u4f8b\uff1a\n1. \u7528\u6237\uff1azhang.san\n2. \u5168\u5c40\u7ec4\uff1aGG_IT_Staff\n3. \u57df\u672c\u5730\u7ec4\uff1aDL_FileServer_IT_Write\n4. \u6743\u9650\uff1aD:\\Shares\\Departments\\IT\uff08\u4fee\u6539\u6743\u9650\uff09\n\n\u4f18\u70b9\uff1a\n- \u7075\u6d3b\uff1a\u7528\u6237\u53d8\u52a8\u53ea\u9700\u4fee\u6539\u7ec4\u6210\u5458\n- \u53ef\u6269\u5c55\uff1a\u652f\u6301\u8de8\u57df\u6743\u9650\u7ba1\u7406\n- \u6613\u7ba1\u7406\uff1a\u6743\u9650\u96c6\u4e2d\u5728\u57df\u672c\u5730\u7ec4\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#52","title":"5.2 \u521b\u5efa\u6743\u9650\u7ec4","text":"<pre><code># \u5728\u57df\u63a7\u4e0a\u6267\u884c\n\n# \u521b\u5efa\u5168\u5c40\u7ec4\uff08\u7528\u6237\u7ec4\uff09\nNew-ADGroup -Name \"GG_IT_Staff\" -GroupScope Global -GroupCategory Security -Path \"OU=Groups,OU=Shanghai,DC=pharma,DC=local\"\nNew-ADGroup -Name \"GG_RD_Staff\" -GroupScope Global -GroupCategory Security -Path \"OU=Groups,OU=Shanghai,DC=pharma,DC=local\"\nNew-ADGroup -Name \"GG_QA_Staff\" -GroupScope Global -GroupCategory Security -Path \"OU=Groups,OU=Shanghai,DC=pharma,DC=local\"\n\n# \u521b\u5efa\u57df\u672c\u5730\u7ec4\uff08\u6743\u9650\u7ec4\uff09\nNew-ADGroup -Name \"DL_FileServer_IT_Read\" -GroupScope DomainLocal -GroupCategory Security -Path \"OU=Groups,OU=Shanghai,DC=pharma,DC=local\"\nNew-ADGroup -Name \"DL_FileServer_IT_Write\" -GroupScope DomainLocal -GroupCategory Security -Path \"OU=Groups,OU=Shanghai,DC=pharma,DC=local\"\nNew-ADGroup -Name \"DL_FileServer_RD_Read\" -GroupScope DomainLocal -GroupCategory Security -Path \"OU=Groups,OU=Shanghai,DC=pharma,DC=local\"\nNew-ADGroup -Name \"DL_FileServer_RD_Write\" -GroupScope DomainLocal -GroupCategory Security -Path \"OU=Groups,OU=Shanghai,DC=pharma,DC=local\"\n\n# \u5c06\u5168\u5c40\u7ec4\u6dfb\u52a0\u5230\u57df\u672c\u5730\u7ec4\nAdd-ADGroupMember -Identity \"DL_FileServer_IT_Write\" -Members \"GG_IT_Staff\"\nAdd-ADGroupMember -Identity \"DL_FileServer_RD_Write\" -Members \"GG_RD_Staff\"\n\n# \u5c06\u7528\u6237\u6dfb\u52a0\u5230\u5168\u5c40\u7ec4\nAdd-ADGroupMember -Identity \"GG_IT_Staff\" -Members \"zhang.san\"\nAdd-ADGroupMember -Identity \"GG_RD_Staff\" -Members \"li.si\"\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#53","title":"5.3 \u5e94\u7528\u6743\u9650\u5230\u6587\u4ef6\u5939","text":"<pre><code># \u5728\u6587\u4ef6\u670d\u52a1\u5668\u4e0a\u6267\u884c\n\n# IT \u6587\u4ef6\u5939\uff1aDL_FileServer_IT_Write\uff08\u4fee\u6539\u6743\u9650\uff09\n$acl = Get-Acl \"D:\\Shares\\Departments\\IT\"\n$rule = New-Object System.Security.AccessControl.FileSystemAccessRule(\"PHARMA\\DL_FileServer_IT_Write\", \"Modify\", \"ContainerInherit,ObjectInherit\", \"None\", \"Allow\")\n$acl.SetAccessRule($rule)\nSet-Acl \"D:\\Shares\\Departments\\IT\" $acl\n\n# RD \u6587\u4ef6\u5939\uff1aDL_FileServer_RD_Write\uff08\u4fee\u6539\u6743\u9650\uff09\n$acl = Get-Acl \"D:\\Shares\\Departments\\RD\"\n$rule = New-Object System.Security.AccessControl.FileSystemAccessRule(\"PHARMA\\DL_FileServer_RD_Write\", \"Modify\", \"ContainerInherit,ObjectInherit\", \"None\", \"Allow\")\n$acl.SetAccessRule($rule)\nSet-Acl \"D:\\Shares\\Departments\\RD\" $acl\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#6-dfs","title":"6. \u914d\u7f6e DFS \u547d\u540d\u7a7a\u95f4","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#61-dfs","title":"6.1 \u521b\u5efa DFS \u547d\u540d\u7a7a\u95f4","text":"<pre><code># \u5b89\u88c5 DFS \u7ba1\u7406\u5de5\u5177\uff08\u5982\u672a\u5b89\u88c5\uff09\nInstall-WindowsFeature -Name RSAT-DFS-Mgmt-Con\n\n# \u521b\u5efa\u57df\u547d\u540d\u7a7a\u95f4\nNew-DfsnRoot -Path \"\\\\pharma.local\\shares\" -TargetPath \"\\\\FS01\\Shares\" -Type DomainV2\n\n# \u9a8c\u8bc1\nGet-DfsnRoot -Path \"\\\\pharma.local\\shares\"\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#62","title":"6.2 \u6dfb\u52a0\u6587\u4ef6\u5939\u76ee\u6807","text":"<pre><code># \u6dfb\u52a0\u90e8\u95e8\u6587\u4ef6\u5939\nNew-DfsnFolder -Path \"\\\\pharma.local\\shares\\IT\" -TargetPath \"\\\\FS01\\IT\"\nNew-DfsnFolder -Path \"\\\\pharma.local\\shares\\RD\" -TargetPath \"\\\\FS01\\RD\"\nNew-DfsnFolder -Path \"\\\\pharma.local\\shares\\QA\" -TargetPath \"\\\\FS01\\QA\"\nNew-DfsnFolder -Path \"\\\\pharma.local\\shares\\Public\" -TargetPath \"\\\\FS01\\Public\"\n\n# \u6dfb\u52a0\u7528\u6237\u4e2a\u4eba\u6587\u4ef6\u5939\nNew-DfsnFolder -Path \"\\\\pharma.local\\shares\\Home\" -TargetPath \"\\\\FS01\\Home$\"\n\n# \u67e5\u770b DFS \u6587\u4ef6\u5939\nGet-DfsnFolder -Path \"\\\\pharma.local\\shares\\*\"\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#63","title":"6.3 \u6dfb\u52a0\u5197\u4f59\u76ee\u6807\uff08\u9ad8\u53ef\u7528\uff09","text":"<pre><code># \u5728 FS02 \u4e0a\u521b\u5efa\u76f8\u540c\u7684\u5171\u4eab\n# \u7136\u540e\u6dfb\u52a0\u4e3a DFS \u76ee\u6807\n\nNew-DfsnFolderTarget -Path \"\\\\pharma.local\\shares\\IT\" -TargetPath \"\\\\FS02\\IT\"\nNew-DfsnFolderTarget -Path \"\\\\pharma.local\\shares\\RD\" -TargetPath \"\\\\FS02\\RD\"\n\n# \u914d\u7f6e DFS \u590d\u5236\uff08\u81ea\u52a8\u540c\u6b65 FS01 \u548c FS02\uff09\nNew-DfsReplicationGroup -GroupName \"Shares Replication\"\nAdd-DfsrMember -GroupName \"Shares Replication\" -ComputerName \"FS01\",\"FS02\"\nAdd-DfsrConnection -GroupName \"Shares Replication\" -SourceComputerName \"FS01\" -DestinationComputerName \"FS02\"\n\nNew-DfsReplicatedFolder -GroupName \"Shares Replication\" -FolderName \"IT\"\nSet-DfsrMembership -GroupName \"Shares Replication\" -FolderName \"IT\" -ComputerName \"FS01\" -ContentPath \"D:\\Shares\\Departments\\IT\" -PrimaryMember $true\nSet-DfsrMembership -GroupName \"Shares Replication\" -FolderName \"IT\" -ComputerName \"FS02\" -ContentPath \"D:\\Shares\\Departments\\IT\"\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#7","title":"7. \u914d\u7f6e\u7528\u6237\u4e2a\u4eba\u6587\u4ef6\u5939","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#71","title":"7.1 \u521b\u5efa\u4e2a\u4eba\u6587\u4ef6\u5939","text":"<pre><code># \u4e3a\u6bcf\u4e2a\u7528\u6237\u521b\u5efa\u4e2a\u4eba\u6587\u4ef6\u5939\n$users = Get-ADUser -Filter * -SearchBase \"OU=Users,OU=Shanghai,DC=pharma,DC=local\"\nforeach ($user in $users) {\n    $username = $user.SamAccountName\n    $homePath = \"D:\\Shares\\Home\\$username\"\n\n    # \u521b\u5efa\u6587\u4ef6\u5939\n    New-Item -Path $homePath -ItemType Directory -Force\n\n    # \u8bbe\u7f6e\u6743\u9650\uff08\u7528\u6237\u5b8c\u5168\u63a7\u5236\uff09\n    $acl = Get-Acl $homePath\n    $acl.SetAccessRuleProtection($true, $false)  # \u7981\u7528\u7ee7\u627f\n\n    # \u6dfb\u52a0\u7528\u6237\u6743\u9650\n    $userRule = New-Object System.Security.AccessControl.FileSystemAccessRule(\"PHARMA\\$username\", \"FullControl\", \"ContainerInherit,ObjectInherit\", \"None\", \"Allow\")\n    $acl.SetAccessRule($userRule)\n\n    # \u6dfb\u52a0\u7ba1\u7406\u5458\u6743\u9650\n    $adminRule = New-Object System.Security.AccessControl.FileSystemAccessRule(\"PHARMA\\Domain Admins\", \"FullControl\", \"ContainerInherit,ObjectInherit\", \"None\", \"Allow\")\n    $acl.SetAccessRule($adminRule)\n\n    Set-Acl $homePath $acl\n}\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#72-ad","title":"7.2 \u914d\u7f6e AD \u7528\u6237\u4e3b\u6587\u4ef6\u5939","text":"<pre><code># \u5728\u57df\u63a7\u4e0a\u6267\u884c\n\n# \u4e3a\u7528\u6237\u914d\u7f6e\u4e3b\u6587\u4ef6\u5939\n$users = Get-ADUser -Filter * -SearchBase \"OU=Users,OU=Shanghai,DC=pharma,DC=local\"\nforeach ($user in $users) {\n    $username = $user.SamAccountName\n    Set-ADUser -Identity $username -HomeDrive \"H:\" -HomeDirectory \"\\\\pharma.local\\shares\\Home\\$username\"\n}\n\n# \u7528\u6237\u767b\u5f55\u540e\uff0cH: \u76d8\u81ea\u52a8\u6620\u5c04\u5230\u4e2a\u4eba\u6587\u4ef6\u5939\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#8","title":"8. \u914d\u7f6e\u6587\u4ef6\u7b5b\u9009\u548c\u914d\u989d","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#81-fsrm","title":"8.1 \u914d\u7f6e\u6587\u4ef6\u7b5b\u9009\uff08FSRM\uff09","text":"<pre><code># \u963b\u6b62\u53ef\u6267\u884c\u6587\u4ef6\uff08\u9632\u6b62\u75c5\u6bd2\uff09\nNew-FsrmFileGroup -Name \"Executable Files\" -IncludePattern @(\"*.exe\",\"*.com\",\"*.bat\",\"*.cmd\",\"*.vbs\",\"*.ps1\")\n\nNew-FsrmFileScreen -Path \"D:\\Shares\\Public\" -Template \"Block Executable Files\"\n\n# \u963b\u6b62\u97f3\u89c6\u9891\u6587\u4ef6\uff08\u8282\u7701\u7a7a\u95f4\uff09\nNew-FsrmFileGroup -Name \"Audio and Video Files\" -IncludePattern @(\"*.mp3\",\"*.mp4\",\"*.avi\",\"*.mkv\",\"*.flv\")\n\nNew-FsrmFileScreen -Path \"D:\\Shares\\Public\" -Template \"Block Audio and Video Files\"\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#82","title":"8.2 \u914d\u7f6e\u914d\u989d","text":"<pre><code># \u4e3a\u90e8\u95e8\u6587\u4ef6\u5939\u8bbe\u7f6e\u914d\u989d\uff08500GB\uff09\nNew-FsrmQuota -Path \"D:\\Shares\\Departments\\IT\" -Size 500GB -Threshold 90\n\n# \u4e3a\u7528\u6237\u4e2a\u4eba\u6587\u4ef6\u5939\u8bbe\u7f6e\u914d\u989d\uff0850GB\uff09\n$users = Get-ChildItem \"D:\\Shares\\Home\"\nforeach ($user in $users) {\n    New-FsrmQuota -Path $user.FullName -Size 50GB -Threshold 90\n}\n\n# \u67e5\u770b\u914d\u989d\nGet-FsrmQuota\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#9","title":"9. \u5ba1\u8ba1\u4e0e\u76d1\u63a7","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#91","title":"9.1 \u542f\u7528\u5ba1\u8ba1","text":"<pre><code># \u542f\u7528\u5bf9\u8c61\u8bbf\u95ee\u5ba1\u8ba1\uff08\u5728\u57df\u63a7\u4e0a\u914d\u7f6e GPO\uff09\n# Computer Configuration &gt; Policies &gt; Windows Settings &gt; Security Settings &gt; Advanced Audit Policy Configuration &gt; Object Access\n# - Audit File System: Success, Failure\n\n# \u5728\u6587\u4ef6\u670d\u52a1\u5668\u4e0a\u914d\u7f6e\u5ba1\u8ba1\n$acl = Get-Acl \"D:\\Shares\\Departments\\IT\"\n$auditRule = New-Object System.Security.AccessControl.FileSystemAuditRule(\"Everyone\", \"Delete,DeleteSubdirectoriesAndFiles,ChangePermissions,TakeOwnership\", \"ContainerInherit,ObjectInherit\", \"None\", \"Success,Failure\")\n$acl.AddAuditRule($auditRule)\nSet-Acl \"D:\\Shares\\Departments\\IT\" $acl\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#92","title":"9.2 \u67e5\u770b\u5ba1\u8ba1\u65e5\u5fd7","text":"<pre><code># \u67e5\u770b\u5b89\u5168\u65e5\u5fd7\nGet-WinEvent -LogName Security -MaxEvents 100 | Where-Object {$_.Id -eq 4663} | Format-Table TimeCreated, Message -AutoSize\n\n# \u6216\u4f7f\u7528\u4e8b\u4ef6\u67e5\u770b\u5668\n# Event Viewer &gt; Windows Logs &gt; Security\n# \u7b5b\u9009\u4e8b\u4ef6 ID\uff1a\n# - 4663\uff1a\u5c1d\u8bd5\u8bbf\u95ee\u5bf9\u8c61\n# - 4660\uff1a\u5220\u9664\u5bf9\u8c61\n# - 4670\uff1a\u66f4\u6539\u5bf9\u8c61\u6743\u9650\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#93","title":"9.3 \u76d1\u63a7\u78c1\u76d8\u7a7a\u95f4","text":"<pre><code># \u67e5\u770b\u78c1\u76d8\u7a7a\u95f4\nGet-PSDrive -PSProvider FileSystem | Select-Object Name, Used, Free, @{Name=\"UsedGB\";Expression={[math]::Round($_.Used/1GB,2)}}, @{Name=\"FreeGB\";Expression={[math]::Round($_.Free/1GB,2)}}\n\n# \u8bbe\u7f6e\u544a\u8b66\uff08\u78c1\u76d8\u7a7a\u95f4 &lt; 10%\uff09\n$disk = Get-PSDrive D\n$freePercent = ($disk.Free / ($disk.Used + $disk.Free)) * 100\nif ($freePercent -lt 10) {\n    Send-MailMessage -From \"fileserver@pharma.com\" -To \"it.admin@pharma.com\" -Subject \"Disk Space Alert\" -Body \"Disk D: free space is below 10%!\" -SmtpServer \"smtp.pharma.local\"\n}\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#10","title":"10. \u5907\u4efd\u4e0e\u6062\u590d","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#101","title":"10.1 \u5907\u4efd\u7b56\u7565","text":"<pre><code># \u4f7f\u7528 Windows Server Backup\nInstall-WindowsFeature Windows-Server-Backup\n\n# \u521b\u5efa\u5907\u4efd\u7b56\u7565\n$policy = New-WBPolicy\n$target = New-WBBackupTarget -VolumePath E:\nAdd-WBBackupTarget -Policy $policy -Target $target\n$volume = Get-WBVolume -VolumePath D:\nAdd-WBVolume -Policy $policy -Volume $volume\n\n# \u8bbe\u7f6e\u5907\u4efd\u8ba1\u5212\uff08\u6bcf\u5929\u51cc\u6668 2 \u70b9\uff09\nSet-WBSchedule -Policy $policy -Schedule 02:00\n\n# \u542f\u7528\u7b56\u7565\nSet-WBPolicy -Policy $policy\n\n# \u6216\u4f7f\u7528\u7b2c\u4e09\u65b9\u5907\u4efd\u8f6f\u4ef6\uff08Veeam\u3001Acronis\uff09\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#102","title":"10.2 \u6062\u590d\u6587\u4ef6","text":"<pre><code># \u4ece Windows Server Backup \u6062\u590d\nStart-WBFileRecovery -BackupSet (Get-WBBackupSet | Select-Object -Last 1) -SourcePath \"D:\\Shares\\Departments\\IT\\important.docx\" -TargetPath \"C:\\Temp\"\n\n# \u6216\u4f7f\u7528\u5377\u5f71\u526f\u672c\uff08VSS\uff09\n# 1. \u542f\u7528\u5377\u5f71\u526f\u672c\nvssadmin create shadow /for=D:\n\n# 2. \u7528\u6237\u53f3\u952e\u6587\u4ef6\u5939 &gt; \u5c5e\u6027 &gt; \u4ee5\u524d\u7684\u7248\u672c\n# 3. \u9009\u62e9\u65f6\u95f4\u70b9\u6062\u590d\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#11_1","title":"11. \u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u6743\u9650\u6700\u5c0f\u5316\uff1a\u7528\u6237\u53ea\u80fd\u8bbf\u95ee\u5de5\u4f5c\u6240\u9700\u7684\u6587\u4ef6\u5939</li> <li>\u4f7f\u7528\u7ec4\u7ba1\u7406\u6743\u9650\uff1a\u4e0d\u8981\u76f4\u63a5\u7ed9\u7528\u6237\u5206\u914d\u6743\u9650</li> <li>\u5b9a\u671f\u5ba1\u67e5\u6743\u9650\uff1a\u6bcf\u5b63\u5ea6\u5ba1\u67e5\u6587\u4ef6\u5939\u6743\u9650</li> <li>\u542f\u7528\u5ba1\u8ba1\uff1a\u8bb0\u5f55\u6587\u4ef6\u8bbf\u95ee\u548c\u4fee\u6539</li> <li>\u914d\u7f6e\u914d\u989d\uff1a\u9632\u6b62\u78c1\u76d8\u7a7a\u95f4\u8017\u5c3d</li> <li>\u4f7f\u7528 DFS\uff1a\u63d0\u9ad8\u53ef\u7528\u6027\u548c\u6027\u80fd</li> <li>\u5b9a\u671f\u5907\u4efd\uff1a\u6bcf\u5929\u5907\u4efd\uff0c\u5f02\u5730\u5b58\u50a8</li> <li>\u76d1\u63a7\u78c1\u76d8\u7a7a\u95f4\uff1a\u8bbe\u7f6e\u544a\u8b66\u9608\u503c</li> <li>\u6587\u6863\u5316\uff1a\u8bb0\u5f55\u6587\u4ef6\u5939\u7ed3\u6784\u548c\u6743\u9650</li> <li>\u7528\u6237\u57f9\u8bad\uff1a\u57f9\u8bad\u7528\u6237\u6b63\u786e\u4f7f\u7528\u6587\u4ef6\u5171\u4eab</li> </ol>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#12_1","title":"12. \u6545\u969c\u6392\u67e5","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#121","title":"12.1 \u5e38\u89c1\u95ee\u9898","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#1_1","title":"\u95ee\u9898 1\uff1a\u65e0\u6cd5\u8bbf\u95ee\u5171\u4eab\u6587\u4ef6\u5939","text":"<pre><code>\u9519\u8bef\uff1a\u6ca1\u6709\u6743\u9650\u8bbf\u95ee\n\n\u6392\u67e5\u6b65\u9aa4\uff1a\n1. \u68c0\u67e5\u7528\u6237\u662f\u5426\u5728\u6b63\u786e\u7684 AD \u7ec4\n2. \u68c0\u67e5\u5171\u4eab\u6743\u9650\uff1aGet-SmbShareAccess -Name \"IT\"\n3. \u68c0\u67e5 NTFS \u6743\u9650\uff1aGet-Acl \"D:\\Shares\\Departments\\IT\"\n4. \u8fd0\u884c\uff1agpupdate /force\n5. \u91cd\u65b0\u767b\u5f55\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#2dfs","title":"\u95ee\u9898 2\uff1aDFS \u547d\u540d\u7a7a\u95f4\u65e0\u6cd5\u8bbf\u95ee","text":"<pre><code>\u9519\u8bef\uff1a\u627e\u4e0d\u5230\u7f51\u7edc\u8def\u5f84\n\n\u6392\u67e5\u6b65\u9aa4\uff1a\n1. \u68c0\u67e5 DFS \u670d\u52a1\uff1aGet-Service -Name \"Dfs\"\n2. \u68c0\u67e5 DFS \u6839\uff1aGet-DfsnRoot\n3. \u68c0\u67e5 DNS \u8bb0\u5f55\uff1anslookup pharma.local\n4. \u68c0\u67e5\u9632\u706b\u5899\uff08\u7aef\u53e3 445\uff09\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86.html#3_1","title":"\u95ee\u9898 3\uff1a\u6587\u4ef6\u590d\u5236\u5931\u8d25","text":"<pre><code>\u9519\u8bef\uff1a\u6587\u4ef6\u8fc7\u5927\u6216\u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3\n\n\u6392\u67e5\u6b65\u9aa4\uff1a\n1. \u68c0\u67e5\u78c1\u76d8\u7a7a\u95f4\uff1aGet-PSDrive D\n2. \u68c0\u67e5\u914d\u989d\uff1aGet-FsrmQuota\n3. \u68c0\u67e5\u6587\u4ef6\u5927\u5c0f\u9650\u5236\n4. \u6e05\u7406\u4e34\u65f6\u6587\u4ef6\n</code></pre> <p>\u53c2\u8003\u8d44\u6e90\uff1a - Windows Server \u6587\u4ef6\u670d\u52a1\u5668\u6587\u6863 - DFS \u547d\u540d\u7a7a\u95f4\u548c\u590d\u5236\u6307\u5357 - NTFS \u6743\u9650\u6700\u4f73\u5b9e\u8df5</p>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html","title":"\u4f01\u4e1a\u90ae\u4ef6\u7cfb\u7edf\u90e8\u7f72\u4e0e\u7ba1\u7406\uff1aExchange Server","text":"<p>\u9002\u7528\u8bfb\u8005\uff1a\u4f01\u4e1a IT \u7ba1\u7406\u5458\u3001\u90ae\u4ef6\u7cfb\u7edf\u7ba1\u7406\u5458 \u76ee\u6807\uff1a\u90e8\u7f72 Exchange Server 2019\uff0c\u914d\u7f6e\u90ae\u7bb1\u3001\u90ae\u4ef6\u6d41\u3001\u5b89\u5168\u7b56\u7565\uff0c\u5b9e\u73b0\u4f01\u4e1a\u7ea7\u90ae\u4ef6\u670d\u52a1\u3002</p>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#1-exchange-server","title":"1. Exchange Server \u6982\u8ff0","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#11-exchange-server","title":"1.1 \u4ec0\u4e48\u662f Exchange Server","text":"<p>Microsoft Exchange Server \u662f\u4f01\u4e1a\u7ea7\u90ae\u4ef6\u548c\u534f\u4f5c\u5e73\u53f0\uff0c\u63d0\u4f9b\uff1a - \u7535\u5b50\u90ae\u4ef6\uff1aSMTP/POP3/IMAP \u90ae\u4ef6\u670d\u52a1 - \u65e5\u5386\uff1a\u4f1a\u8bae\u5b89\u6392\u3001\u8d44\u6e90\u9884\u8ba2 - \u8054\u7cfb\u4eba\uff1a\u5168\u5c40\u5730\u5740\u5217\u8868\uff08GAL\uff09 - \u4efb\u52a1\uff1a\u4efb\u52a1\u7ba1\u7406 - \u79fb\u52a8\u8bbe\u5907\uff1aActiveSync \u540c\u6b65 - Web \u8bbf\u95ee\uff1aOutlook Web App (OWA)</p>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#12-exchange","title":"1.2 Exchange \u7248\u672c\u5bf9\u6bd4","text":"\u7248\u672c \u53d1\u5e03\u65f6\u95f4 \u652f\u6301\u622a\u6b62 \u4e3b\u8981\u7279\u6027 Exchange 2016 2015 2025-10-14 \u9ad8\u53ef\u7528\u6027\u3001\u4e91\u96c6\u6210 Exchange 2019 2018 2025-10-14 \u6027\u80fd\u63d0\u5347\u3001\u5b89\u5168\u589e\u5f3a Exchange Online \u6301\u7eed\u66f4\u65b0 - \u4e91\u7aef\u670d\u52a1\u3001\u65e0\u9700\u7ef4\u62a4"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#13","title":"1.3 \u90e8\u7f72\u67b6\u6784","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u4e92\u8054\u7f51                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502  \u90ae\u4ef6\u7f51\u5173        \u2502\n         \u2502  (Barracuda)    \u2502\n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502  Exchange 2019  \u2502\n         \u2502  (Mailbox Server)\u2502\n         \u2502  10.10.40.20    \u2502\n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502             \u2502             \u2502\n\u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510\n\u2502 Outlook\u2502  \u2502 OWA      \u2502  \u2502 \u79fb\u52a8\u8bbe\u5907\u2502\n\u2502 \u5ba2\u6237\u7aef  \u2502  \u2502 (Web)    \u2502  \u2502(ActiveSync)\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#2","title":"2. \u73af\u5883\u51c6\u5907","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#21","title":"2.1 \u786c\u4ef6\u8981\u6c42","text":"\u7ec4\u4ef6 \u6700\u4f4e\u914d\u7f6e \u63a8\u8350\u914d\u7f6e\uff08500 \u90ae\u7bb1\uff09 CPU 4 \u6838 8 \u6838 \u5185\u5b58 8GB 32GB \u78c1\u76d8 200GB 1TB\uff08SSD + HDD\uff09 \u7f51\u7edc 1Gbps 1Gbps\uff08\u53cc\u7f51\u5361\uff09"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#22","title":"2.2 \u8f6f\u4ef6\u8981\u6c42","text":"<pre><code>\u64cd\u4f5c\u7cfb\u7edf\uff1a\n- Windows Server 2019 Standard/Datacenter\n\n\u524d\u7f6e\u7ec4\u4ef6\uff1a\n- Active Directory\uff08\u57df\u529f\u80fd\u7ea7\u522b Windows Server 2012 R2+\uff09\n- .NET Framework 4.8\n- Visual C++ Redistributable 2013\n- IIS\uff08Internet Information Services\uff09\n- Windows PowerShell 5.1\n\n\u8bb8\u53ef\u8bc1\uff1a\n- Exchange Server 2019 Standard/Enterprise\n- Exchange Server CAL\uff08\u5ba2\u6237\u7aef\u8bbf\u95ee\u8bb8\u53ef\u8bc1\uff09\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#23","title":"2.3 \u7f51\u7edc\u89c4\u5212","text":"<pre><code>Exchange \u670d\u52a1\u5668\uff1a\n- \u4e3b\u673a\u540d\uff1aEXCH01\n- FQDN\uff1aexch01.pharma.local\n- IP \u5730\u5740\uff1a10.10.40.20\n- \u5b50\u7f51\u63a9\u7801\uff1a255.255.255.0\n- \u7f51\u5173\uff1a10.10.40.1\n- DNS\uff1a10.10.40.10, 10.10.40.11\n\n\u90ae\u4ef6\u57df\u540d\uff1a\n- \u5185\u90e8\u57df\u540d\uff1apharma.local\n- \u5916\u90e8\u57df\u540d\uff1apharma.com\n- MX \u8bb0\u5f55\uff1amail.pharma.com \u2192 \u516c\u7f51 IP\n\n\u8bc1\u4e66\uff1a\n- \u8d2d\u4e70 SSL \u8bc1\u4e66\uff08\u901a\u914d\u7b26\u8bc1\u4e66\uff09\uff1a*.pharma.com\n- \u6216\u4f7f\u7528 Let's Encrypt \u514d\u8d39\u8bc1\u4e66\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#3-exchange-server-2019","title":"3. \u5b89\u88c5 Exchange Server 2019","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#31-active-directory","title":"3.1 \u51c6\u5907 Active Directory","text":"<pre><code># \u5728\u57df\u63a7\u4e0a\u6267\u884c\n\n# 1. \u6269\u5c55 AD Schema\n.\\Setup.exe /PrepareSchema /IAcceptExchangeServerLicenseTerms\n\n# 2. \u51c6\u5907 AD\n.\\Setup.exe /PrepareAD /OrganizationName:\"Pharma Corp\" /IAcceptExchangeServerLicenseTerms\n\n# 3. \u51c6\u5907\u57df\n.\\Setup.exe /PrepareDomain /IAcceptExchangeServerLicenseTerms\n\n# \u6216\u4e00\u6b65\u5b8c\u6210\n.\\Setup.exe /PrepareAD /OrganizationName:\"Pharma Corp\" /IAcceptExchangeServerLicenseTerms\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#32","title":"3.2 \u5b89\u88c5\u524d\u7f6e\u7ec4\u4ef6","text":"<pre><code># \u5728 Exchange \u670d\u52a1\u5668\u4e0a\u6267\u884c\n\n# 1. \u5b89\u88c5 .NET Framework 4.8\n# \u4e0b\u8f7d\u5e76\u5b89\u88c5\uff1ahttps://dotnet.microsoft.com/download/dotnet-framework/net48\n\n# 2. \u5b89\u88c5 Visual C++ Redistributable 2013\n# \u4e0b\u8f7d\u5e76\u5b89\u88c5\uff1ahttps://www.microsoft.com/en-us/download/details.aspx?id=40784\n\n# 3. \u5b89\u88c5 Windows \u529f\u80fd\nInstall-WindowsFeature Server-Media-Foundation, NET-Framework-45-Features, RPC-over-HTTP-proxy, RSAT-Clustering, RSAT-Clustering-CmdInterface, RSAT-Clustering-Mgmt, RSAT-Clustering-PowerShell, WAS-Process-Model, Web-Asp-Net45, Web-Basic-Auth, Web-Client-Auth, Web-Digest-Auth, Web-Dir-Browsing, Web-Dyn-Compression, Web-Http-Errors, Web-Http-Logging, Web-Http-Redirect, Web-Http-Tracing, Web-ISAPI-Ext, Web-ISAPI-Filter, Web-Lgcy-Mgmt-Console, Web-Metabase, Web-Mgmt-Console, Web-Mgmt-Service, Web-Net-Ext45, Web-Request-Monitor, Web-Server, Web-Stat-Compression, Web-Static-Content, Web-Windows-Auth, Web-WMI, Windows-Identity-Foundation, RSAT-ADDS\n\n# 4. \u5b89\u88c5 Unified Communications Managed API 4.0\n# \u4e0b\u8f7d\u5e76\u5b89\u88c5\uff1ahttps://www.microsoft.com/en-us/download/details.aspx?id=34992\n\n# 5. \u91cd\u542f\u670d\u52a1\u5668\nRestart-Computer\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#33-exchange-server","title":"3.3 \u5b89\u88c5 Exchange Server","text":"<pre><code># \u6302\u8f7d Exchange 2019 ISO\n\n# \u65b9\u6cd5 1\uff1aGUI \u5b89\u88c5\n# \u8fd0\u884c Setup.exe\uff0c\u6309\u5411\u5bfc\u64cd\u4f5c\n\n# \u65b9\u6cd5 2\uff1a\u547d\u4ee4\u884c\u5b89\u88c5\uff08\u63a8\u8350\uff09\nE:\\Setup.exe /Mode:Install /Role:Mailbox /IAcceptExchangeServerLicenseTerms /OrganizationName:\"Pharma Corp\"\n\n# \u5b89\u88c5\u8fc7\u7a0b\u7ea6 30-60 \u5206\u949f\n# \u5b89\u88c5\u5b8c\u6210\u540e\u81ea\u52a8\u91cd\u542f\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#34","title":"3.4 \u9a8c\u8bc1\u5b89\u88c5","text":"<pre><code># \u68c0\u67e5 Exchange \u670d\u52a1\nGet-Service MSExchange* | Select-Object Name, Status\n\n# \u8f93\u51fa\u793a\u4f8b\uff1a\n# Name                           Status\n# ----                           ------\n# MSExchangeADTopology           Running\n# MSExchangeDelivery             Running\n# MSExchangeFrontEndTransport    Running\n# MSExchangeHM                   Running\n# MSExchangeIS                   Running\n# MSExchangeMailboxAssistants    Running\n# MSExchangeRepl                 Running\n# MSExchangeRPC                  Running\n# MSExchangeServiceHost          Running\n# MSExchangeSubmission           Running\n# MSExchangeThrottling           Running\n# MSExchangeTransport            Running\n# MSExchangeTransportLogSearch   Running\n\n# \u68c0\u67e5 Exchange \u7248\u672c\nGet-ExchangeServer | Format-List Name, Edition, AdminDisplayVersion\n\n# \u8bbf\u95ee EAC\uff08Exchange \u7ba1\u7406\u4e2d\u5fc3\uff09\n# https://exch01.pharma.local/ecp\n# \u4f7f\u7528\u57df\u7ba1\u7406\u5458\u8d26\u53f7\u767b\u5f55\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#4-exchange","title":"4. \u914d\u7f6e Exchange","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#41","title":"4.1 \u914d\u7f6e\u865a\u62df\u76ee\u5f55","text":"<pre><code># \u914d\u7f6e\u5916\u90e8 URL\uff08\u7528\u4e8e\u5916\u7f51\u8bbf\u95ee\uff09\n$ExternalURL = \"https://mail.pharma.com\"\n\n# OWA\uff08Outlook Web App\uff09\nSet-OwaVirtualDirectory -Identity \"EXCH01\\owa (Default Web Site)\" -ExternalUrl \"$ExternalURL/owa\" -InternalUrl \"https://exch01.pharma.local/owa\"\n\n# ECP\uff08Exchange \u7ba1\u7406\u4e2d\u5fc3\uff09\nSet-EcpVirtualDirectory -Identity \"EXCH01\\ecp (Default Web Site)\" -ExternalUrl \"$ExternalURL/ecp\" -InternalUrl \"https://exch01.pharma.local/ecp\"\n\n# ActiveSync\uff08\u79fb\u52a8\u8bbe\u5907\uff09\nSet-ActiveSyncVirtualDirectory -Identity \"EXCH01\\Microsoft-Server-ActiveSync (Default Web Site)\" -ExternalUrl \"$ExternalURL/Microsoft-Server-ActiveSync\" -InternalUrl \"https://exch01.pharma.local/Microsoft-Server-ActiveSync\"\n\n# EWS\uff08Exchange Web Services\uff09\nSet-WebServicesVirtualDirectory -Identity \"EXCH01\\EWS (Default Web Site)\" -ExternalUrl \"$ExternalURL/EWS/Exchange.asmx\" -InternalUrl \"https://exch01.pharma.local/EWS/Exchange.asmx\"\n\n# OAB\uff08\u79bb\u7ebf\u901a\u8baf\u7c3f\uff09\nSet-OabVirtualDirectory -Identity \"EXCH01\\OAB (Default Web Site)\" -ExternalUrl \"$ExternalURL/OAB\" -InternalUrl \"https://exch01.pharma.local/OAB\"\n\n# MAPI/HTTP\nSet-MapiVirtualDirectory -Identity \"EXCH01\\mapi (Default Web Site)\" -ExternalUrl \"$ExternalURL/mapi\" -InternalUrl \"https://exch01.pharma.local/mapi\"\n\n# Autodiscover\nSet-ClientAccessService -Identity EXCH01 -AutoDiscoverServiceInternalUri \"https://exch01.pharma.local/Autodiscover/Autodiscover.xml\"\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#42-ssl","title":"4.2 \u914d\u7f6e SSL \u8bc1\u4e66","text":"<pre><code># \u65b9\u6cd5 1\uff1a\u4f7f\u7528\u5546\u4e1a\u8bc1\u4e66\uff08\u63a8\u8350\uff09\n# 1. \u751f\u6210\u8bc1\u4e66\u8bf7\u6c42\uff08CSR\uff09\n$cert = New-ExchangeCertificate -GenerateRequest -SubjectName \"CN=mail.pharma.com\" -DomainName mail.pharma.com,autodiscover.pharma.com,exch01.pharma.local -PrivateKeyExportable $true\nSet-Content -Path \"C:\\cert_request.csr\" -Value $cert\n\n# 2. \u63d0\u4ea4 CSR \u5230\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\n# 3. \u4e0b\u8f7d\u8bc1\u4e66\u6587\u4ef6\uff08.cer \u6216 .crt\uff09\n# 4. \u5bfc\u5165\u8bc1\u4e66\nImport-ExchangeCertificate -FileData ([System.IO.File]::ReadAllBytes(\"C:\\mail_pharma_com.cer\"))\n\n# 5. \u542f\u7528\u8bc1\u4e66\nEnable-ExchangeCertificate -Thumbprint \"\u8bc1\u4e66\u6307\u7eb9\" -Services IIS,SMTP\n\n# \u65b9\u6cd5 2\uff1a\u4f7f\u7528\u81ea\u7b7e\u540d\u8bc1\u4e66\uff08\u6d4b\u8bd5\u73af\u5883\uff09\nNew-ExchangeCertificate -SubjectName \"CN=mail.pharma.com\" -DomainName mail.pharma.com,autodiscover.pharma.com,exch01.pharma.local -Services IIS,SMTP -PrivateKeyExportable $true\n\n# \u67e5\u770b\u8bc1\u4e66\nGet-ExchangeCertificate | Format-List Thumbprint, Subject, Services, NotAfter\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#43","title":"4.3 \u914d\u7f6e\u63a5\u53d7\u57df","text":"<pre><code># \u67e5\u770b\u73b0\u6709\u63a5\u53d7\u57df\nGet-AcceptedDomain\n\n# \u6dfb\u52a0\u65b0\u7684\u63a5\u53d7\u57df\nNew-AcceptedDomain -Name \"pharma.com\" -DomainName \"pharma.com\" -DomainType Authoritative\n\n# \u8bbe\u7f6e\u9ed8\u8ba4\u63a5\u53d7\u57df\nSet-AcceptedDomain -Identity \"pharma.com\" -MakeDefault $true\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#44","title":"4.4 \u914d\u7f6e\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u7b56\u7565","text":"<pre><code># \u67e5\u770b\u73b0\u6709\u7b56\u7565\nGet-EmailAddressPolicy\n\n# \u521b\u5efa\u65b0\u7b56\u7565\nNew-EmailAddressPolicy -Name \"Default Policy\" -IncludedRecipients AllRecipients -EnabledPrimarySMTPAddressTemplate \"SMTP:%g.%s@pharma.com\"\n\n# \u5e94\u7528\u7b56\u7565\nUpdate-EmailAddressPolicy -Identity \"Default Policy\"\n\n# \u7b56\u7565\u6a21\u677f\u8bf4\u660e\uff1a\n# %g = \u540d\uff08GivenName\uff09\n# %s = \u59d3\uff08Surname\uff09\n# %m = \u522b\u540d\uff08Alias\uff09\n# \u793a\u4f8b\uff1a\u5f20\u4e09 \u2192 zhang.san@pharma.com\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#5","title":"5. \u521b\u5efa\u90ae\u7bb1","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#51","title":"5.1 \u521b\u5efa\u7528\u6237\u90ae\u7bb1","text":"<pre><code># \u4e3a\u73b0\u6709 AD \u7528\u6237\u542f\u7528\u90ae\u7bb1\nEnable-Mailbox -Identity \"zhang.san\" -Database \"Mailbox Database 01\"\n\n# \u521b\u5efa\u65b0\u7528\u6237\u5e76\u542f\u7528\u90ae\u7bb1\nNew-Mailbox -Name \"\u674e\u56db\" -Alias \"li.si\" -UserPrincipalName \"li.si@pharma.local\" -SamAccountName \"li.si\" -FirstName \"\u56db\" -LastName \"\u674e\" -Password (ConvertTo-SecureString \"P@ssw0rd123!\" -AsPlainText -Force) -Database \"Mailbox Database 01\" -OrganizationalUnit \"OU=Users,OU=Shanghai,DC=pharma,DC=local\"\n\n# \u8bbe\u7f6e\u90ae\u7bb1\u914d\u989d\nSet-Mailbox -Identity \"zhang.san\" -IssueWarningQuota 45GB -ProhibitSendQuota 49GB -ProhibitSendReceiveQuota 50GB\n\n# \u8bbe\u7f6e\u90ae\u7bb1\u8bed\u8a00\u548c\u65f6\u533a\nSet-MailboxRegionalConfiguration -Identity \"zhang.san\" -Language zh-CN -TimeZone \"China Standard Time\"\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#52","title":"5.2 \u521b\u5efa\u5171\u4eab\u90ae\u7bb1","text":"<pre><code># \u521b\u5efa\u5171\u4eab\u90ae\u7bb1\uff08\u4e0d\u9700\u8981\u8bb8\u53ef\u8bc1\uff09\nNew-Mailbox -Name \"IT Support\" -Alias \"it.support\" -Shared -PrimarySmtpAddress \"it.support@pharma.com\" -Database \"Mailbox Database 01\"\n\n# \u6388\u4e88\u7528\u6237\u8bbf\u95ee\u6743\u9650\nAdd-MailboxPermission -Identity \"it.support@pharma.com\" -User \"zhang.san\" -AccessRights FullAccess -InheritanceType All\n\n# \u6388\u4e88\u4ee3\u53d1\u6743\u9650\nAdd-RecipientPermission -Identity \"it.support@pharma.com\" -Trustee \"zhang.san\" -AccessRights SendAs -Confirm:$false\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#53","title":"5.3 \u521b\u5efa\u4f1a\u8bae\u5ba4\u90ae\u7bb1","text":"<pre><code># \u521b\u5efa\u4f1a\u8bae\u5ba4\u90ae\u7bb1\nNew-Mailbox -Name \"\u4f1a\u8bae\u5ba4 A\" -Alias \"room.a\" -Room -PrimarySmtpAddress \"room.a@pharma.com\" -Database \"Mailbox Database 01\"\n\n# \u914d\u7f6e\u4f1a\u8bae\u5ba4\u81ea\u52a8\u63a5\u53d7\nSet-CalendarProcessing -Identity \"room.a@pharma.com\" -AutomateProcessing AutoAccept -DeleteSubject $false -AddOrganizerToSubject $false\n\n# \u8bbe\u7f6e\u4f1a\u8bae\u5ba4\u5bb9\u91cf\nSet-Mailbox -Identity \"room.a@pharma.com\" -ResourceCapacity 10\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#54","title":"5.4 \u521b\u5efa\u901a\u8baf\u7ec4","text":"<pre><code># \u521b\u5efa\u901a\u8baf\u7ec4\nNew-DistributionGroup -Name \"IT Team\" -Alias \"it.team\" -PrimarySmtpAddress \"it.team@pharma.com\" -OrganizationalUnit \"OU=Groups,OU=Shanghai,DC=pharma,DC=local\"\n\n# \u6dfb\u52a0\u6210\u5458\nAdd-DistributionGroupMember -Identity \"it.team@pharma.com\" -Member \"zhang.san\"\nAdd-DistributionGroupMember -Identity \"it.team@pharma.com\" -Member \"li.si\"\n\n# \u8bbe\u7f6e\u53ea\u5141\u8bb8\u5185\u90e8\u53d1\u4ef6\u4eba\nSet-DistributionGroup -Identity \"it.team@pharma.com\" -RequireSenderAuthenticationEnabled $true\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#6","title":"6. \u914d\u7f6e\u90ae\u4ef6\u6d41","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#61","title":"6.1 \u914d\u7f6e\u53d1\u9001\u8fde\u63a5\u5668","text":"<pre><code># \u521b\u5efa\u53d1\u9001\u8fde\u63a5\u5668\uff08\u901a\u8fc7\u90ae\u4ef6\u7f51\u5173\u53d1\u9001\uff09\nNew-SendConnector -Name \"Outbound to Internet\" -Usage Internet -AddressSpaces \"SMTP:*;1\" -SourceTransportServers EXCH01 -SmartHosts \"10.10.1.100\" -SmartHostAuthMechanism None -DNSRoutingEnabled $false\n\n# \u6216\u76f4\u63a5\u53d1\u9001\u5230\u4e92\u8054\u7f51\uff08\u9700\u8981\u516c\u7f51 IP\uff09\nNew-SendConnector -Name \"Outbound to Internet\" -Usage Internet -AddressSpaces \"SMTP:*;1\" -SourceTransportServers EXCH01 -DNSRoutingEnabled $true\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#62","title":"6.2 \u914d\u7f6e\u63a5\u6536\u8fde\u63a5\u5668","text":"<pre><code># \u67e5\u770b\u9ed8\u8ba4\u63a5\u6536\u8fde\u63a5\u5668\nGet-ReceiveConnector\n\n# \u521b\u5efa\u81ea\u5b9a\u4e49\u63a5\u6536\u8fde\u63a5\u5668\uff08\u63a5\u6536\u6765\u81ea\u5e94\u7528\u670d\u52a1\u5668\u7684\u90ae\u4ef6\uff09\nNew-ReceiveConnector -Name \"Relay from App Servers\" -Usage Custom -Bindings 10.10.40.20:25 -RemoteIPRanges 10.10.30.0/24 -Server EXCH01 -PermissionGroups AnonymousUsers -AuthMechanism None\n\n# \u6388\u4e88\u533f\u540d\u4e2d\u7ee7\u6743\u9650\nGet-ReceiveConnector \"EXCH01\\Relay from App Servers\" | Add-ADPermission -User \"NT AUTHORITY\\ANONYMOUS LOGON\" -ExtendedRights \"Ms-Exch-SMTP-Accept-Any-Recipient\"\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#63","title":"6.3 \u914d\u7f6e\u90ae\u4ef6\u8def\u7531","text":"<pre><code># \u914d\u7f6e MX \u8bb0\u5f55\uff08\u5728 DNS \u670d\u52a1\u5668\u4e0a\uff09\n# mail.pharma.com \u2192 \u516c\u7f51 IP\uff08\u6307\u5411\u90ae\u4ef6\u7f51\u5173\uff09\n\n# \u914d\u7f6e SPF \u8bb0\u5f55\uff08\u9632\u6b62\u90ae\u4ef6\u88ab\u6807\u8bb0\u4e3a\u5783\u573e\u90ae\u4ef6\uff09\n# TXT \u8bb0\u5f55\uff1apharma.com \u2192 \"v=spf1 ip4:\u516c\u7f51IP a:mail.pharma.com ~all\"\n\n# \u914d\u7f6e DKIM\uff08\u57df\u540d\u5bc6\u94a5\u8bc6\u522b\u90ae\u4ef6\uff09\n# \u5728 Exchange \u4e2d\u542f\u7528 DKIM\uff08\u9700\u8981 Exchange Online \u6216\u7b2c\u4e09\u65b9\u5de5\u5177\uff09\n\n# \u914d\u7f6e DMARC\uff08\u57df\u540d\u6d88\u606f\u8ba4\u8bc1\u62a5\u544a\u548c\u4e00\u81f4\u6027\uff09\n# TXT \u8bb0\u5f55\uff1a_dmarc.pharma.com \u2192 \"v=DMARC1; p=quarantine; rua=mailto:dmarc@pharma.com\"\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#7","title":"7. \u5b89\u5168\u914d\u7f6e","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#71","title":"7.1 \u914d\u7f6e\u53cd\u5783\u573e\u90ae\u4ef6","text":"<pre><code># \u542f\u7528\u53cd\u5783\u573e\u90ae\u4ef6\u4ee3\u7406\n&amp; $env:ExchangeInstallPath\\Scripts\\Install-AntiSpamAgents.ps1\nRestart-Service MSExchangeTransport\n\n# \u914d\u7f6e SCL\uff08\u5783\u573e\u90ae\u4ef6\u53ef\u4fe1\u5ea6\u7ea7\u522b\uff09\u9608\u503c\nSet-OrganizationConfig -SCLJunkThreshold 4\n\n# \u914d\u7f6e\u5185\u5bb9\u8fc7\u6ee4\nSet-ContentFilterConfig -Enabled $true -SCLRejectEnabled $true -SCLRejectThreshold 7 -SCLDeleteEnabled $true -SCLDeleteThreshold 9\n\n# \u914d\u7f6e\u53d1\u4ef6\u4eba\u8fc7\u6ee4\nSet-SenderFilterConfig -Enabled $true -BlankSenderBlockingEnabled $true\n\n# \u914d\u7f6e\u6536\u4ef6\u4eba\u8fc7\u6ee4\nSet-RecipientFilterConfig -Enabled $true -RecipientValidationEnabled $true\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#72","title":"7.2 \u914d\u7f6e\u90ae\u4ef6\u5927\u5c0f\u9650\u5236","text":"<pre><code># \u5168\u5c40\u9650\u5236\uff0825MB\uff09\nSet-TransportConfig -MaxSendSize 25MB -MaxReceiveSize 25MB\n\n# \u90ae\u7bb1\u9650\u5236\nSet-Mailbox -Identity \"zhang.san\" -MaxSendSize 25MB -MaxReceiveSize 25MB\n\n# \u8fde\u63a5\u5668\u9650\u5236\nSet-SendConnector -Identity \"Outbound to Internet\" -MaxMessageSize 25MB\nSet-ReceiveConnector -Identity \"EXCH01\\Default Frontend EXCH01\" -MaxMessageSize 25MB\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#73","title":"7.3 \u914d\u7f6e\u90ae\u4ef6\u4fdd\u7559\u7b56\u7565","text":"<pre><code># \u521b\u5efa\u4fdd\u7559\u6807\u8bb0\uff087 \u5e74\u4fdd\u7559\uff09\nNew-RetentionPolicyTag -Name \"7 Years Delete\" -Type All -AgeLimitForRetention 2555 -RetentionAction DeleteAndAllowRecovery\n\n# \u521b\u5efa\u4fdd\u7559\u7b56\u7565\nNew-RetentionPolicy -Name \"Default Retention Policy\" -RetentionPolicyTagLinks \"7 Years Delete\"\n\n# \u5e94\u7528\u5230\u90ae\u7bb1\nSet-Mailbox -Identity \"zhang.san\" -RetentionPolicy \"Default Retention Policy\"\n\n# \u542f\u7528\u6258\u7ba1\u6587\u4ef6\u5939\u52a9\u7406\nStart-ManagedFolderAssistant -Identity \"zhang.san\"\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#74","title":"7.4 \u914d\u7f6e\u5ba1\u8ba1\u65e5\u5fd7","text":"<pre><code># \u542f\u7528\u90ae\u7bb1\u5ba1\u8ba1\nSet-Mailbox -Identity \"zhang.san\" -AuditEnabled $true -AuditLogAgeLimit 90 -AuditOwner Update,Move,MoveToDeletedItems,SoftDelete,HardDelete -AuditDelegate Update,Move,MoveToDeletedItems,SoftDelete,HardDelete,SendAs,SendOnBehalf -AuditAdmin Update,Move,MoveToDeletedItems,SoftDelete,HardDelete,SendAs,SendOnBehalf,Copy\n\n# \u6279\u91cf\u542f\u7528\nGet-Mailbox -ResultSize Unlimited | Set-Mailbox -AuditEnabled $true\n\n# \u67e5\u770b\u5ba1\u8ba1\u65e5\u5fd7\nSearch-MailboxAuditLog -Identity \"zhang.san\" -LogonTypes Admin,Delegate -ShowDetails -StartDate (Get-Date).AddDays(-7) -EndDate (Get-Date)\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#8","title":"8. \u5907\u4efd\u4e0e\u6062\u590d","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#81","title":"8.1 \u5907\u4efd\u7b56\u7565","text":"<pre><code># \u4f7f\u7528 Windows Server Backup \u5907\u4efd Exchange\n# 1. \u5b89\u88c5 Windows Server Backup\nInstall-WindowsFeature Windows-Server-Backup\n\n# 2. \u521b\u5efa\u5907\u4efd\u7b56\u7565\n$policy = New-WBPolicy\n$target = New-WBBackupTarget -VolumePath E:\nAdd-WBBackupTarget -Policy $policy -Target $target\nAdd-WBSystemState -Policy $policy\nAdd-WBBareMetalRecovery -Policy $policy\n\n# 3. \u542f\u52a8\u5907\u4efd\nStart-WBBackup -Policy $policy\n\n# \u6216\u4f7f\u7528\u7b2c\u4e09\u65b9\u5907\u4efd\u8f6f\u4ef6\uff08Veeam\u3001Commvault\uff09\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#82","title":"8.2 \u6062\u590d\u90ae\u7bb1","text":"<pre><code># \u6062\u590d\u5df2\u5220\u9664\u7684\u90ae\u7bb1\uff0830 \u5929\u5185\uff09\nGet-MailboxDatabase | Get-MailboxStatistics | Where {$_.DisconnectReason -eq \"SoftDeleted\"}\n\n# \u8fde\u63a5\u5df2\u5220\u9664\u7684\u90ae\u7bb1\u5230\u65b0\u7528\u6237\nConnect-Mailbox -Identity \"\u5f20\u4e09\" -Database \"Mailbox Database 01\" -User \"zhang.san\"\n\n# \u6216\u6062\u590d\u5230\u6062\u590d\u6570\u636e\u5e93\nNew-MailboxRestoreRequest -SourceMailbox \"\u5f20\u4e09\" -SourceDatabase \"Mailbox Database 01\" -TargetMailbox \"zhang.san\"\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#9","title":"9. \u76d1\u63a7\u4e0e\u7ef4\u62a4","text":""},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#91","title":"9.1 \u76d1\u63a7\u90ae\u4ef6\u961f\u5217","text":"<pre><code># \u67e5\u770b\u90ae\u4ef6\u961f\u5217\nGet-Queue\n\n# \u67e5\u770b\u961f\u5217\u4e2d\u7684\u90ae\u4ef6\nGet-Message -Queue \"EXCH01\\Submission\"\n\n# \u91cd\u8bd5\u961f\u5217\nRetry-Queue -Identity \"EXCH01\\Submission\"\n\n# \u5220\u9664\u961f\u5217\u4e2d\u7684\u90ae\u4ef6\nRemove-Message -Identity \"EXCH01\\Submission\\12345\" -WithNDR $true\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#92","title":"9.2 \u76d1\u63a7\u6570\u636e\u5e93","text":"<pre><code># \u67e5\u770b\u6570\u636e\u5e93\u72b6\u6001\nGet-MailboxDatabase -Status | Select-Object Name, Mounted, DatabaseSize\n\n# \u67e5\u770b\u6570\u636e\u5e93\u526f\u672c\u72b6\u6001\uff08DAG \u73af\u5883\uff09\nGet-MailboxDatabaseCopyStatus\n\n# \u68c0\u67e5\u6570\u636e\u5e93\u5065\u5eb7\u72b6\u6001\nTest-MapiConnectivity -Database \"Mailbox Database 01\"\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#93","title":"9.3 \u6027\u80fd\u76d1\u63a7","text":"<pre><code># \u4f7f\u7528 Performance Monitor \u76d1\u63a7\u5173\u952e\u6307\u6807\uff1a\n# - MSExchange Database\\I/O Database Reads Average Latency\n# - MSExchange Database\\I/O Database Writes Average Latency\n# - Processor\\% Processor Time\n# - Memory\\Available MBytes\n# - Network Interface\\Bytes Total/sec\n</code></pre>"},{"location":"enterprise/%E4%BC%81%E4%B8%9A%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%AE%A1%E7%90%86-Exchange-Server.html#10","title":"10. \u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u9ad8\u53ef\u7528\u6027\uff1a\u90e8\u7f72 DAG\uff08\u6570\u636e\u5e93\u53ef\u7528\u6027\u7ec4\uff09</li> <li>\u5b9a\u671f\u5907\u4efd\uff1a\u6bcf\u5929\u5907\u4efd\uff0c\u5f02\u5730\u5b58\u50a8</li> <li>\u76d1\u63a7\u544a\u8b66\uff1a\u90ae\u4ef6\u961f\u5217\u3001\u6570\u636e\u5e93\u5927\u5c0f\u3001\u670d\u52a1\u72b6\u6001</li> <li>\u5b89\u5168\u52a0\u56fa\uff1a\u542f\u7528 MFA\u3001\u9650\u5236 OWA \u8bbf\u95ee</li> <li>\u8865\u4e01\u7ba1\u7406\uff1a\u5b9a\u671f\u5b89\u88c5 Exchange CU\uff08\u7d2f\u79ef\u66f4\u65b0\uff09</li> <li>\u5bb9\u91cf\u89c4\u5212\uff1a\u76d1\u63a7\u90ae\u7bb1\u589e\u957f\uff0c\u63d0\u524d\u6269\u5bb9</li> <li>\u6587\u6863\u5316\uff1a\u8bb0\u5f55\u914d\u7f6e\u3001\u53d8\u66f4\u3001\u6545\u969c\u5904\u7406</li> <li>\u6d4b\u8bd5\u6062\u590d\uff1a\u5b9a\u671f\u6d4b\u8bd5\u5907\u4efd\u6062\u590d\u6d41\u7a0b</li> <li>\u7528\u6237\u57f9\u8bad\uff1a\u57f9\u8bad\u7528\u6237\u4f7f\u7528 OWA\u3001\u79fb\u52a8\u8bbe\u5907</li> <li>\u5408\u89c4\u5ba1\u8ba1\uff1a\u542f\u7528\u5ba1\u8ba1\u65e5\u5fd7\uff0c\u5b9a\u671f\u5ba1\u67e5</li> </ol> <p>\u53c2\u8003\u8d44\u6e90\uff1a - Microsoft Exchange Server 2019 \u5b98\u65b9\u6587\u6863 - Exchange Server \u90e8\u7f72\u52a9\u624b - Exchange Team Blog</p>"},{"location":"enterprise/%E5%9F%BA%E4%BA%8EWindows%E7%9A%84%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E8%A1%8C%E4%B8%9A%E8%BD%AF%E4%BB%B6%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88.html","title":"\u57fa\u4e8e Windows \u7684\u751f\u7269\u5236\u836f\u884c\u4e1a\u8f6f\u4ef6\u8fd0\u7ef4\u65b9\u6848","text":"<p>\u9762\u5411 GxP/CSV \u5408\u89c4\u573a\u666f\u7684\u8fd0\u7ef4\u5b9e\u8df5\u6307\u5357\uff0c\u8986\u76d6 LIMS/ELN/CDS/MES/QMS \u7b49\u5178\u578b\u7cfb\u7edf\u5728 Windows \u5e73\u53f0\u4e0a\u7684\u8d26\u6237\u3001\u8865\u4e01\u3001\u5907\u4efd\u3001\u76d1\u63a7\u4e0e\u53d8\u66f4\u7ba1\u7406\u3002</p>"},{"location":"enterprise/%E5%9F%BA%E4%BA%8EWindows%E7%9A%84%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E8%A1%8C%E4%B8%9A%E8%BD%AF%E4%BB%B6%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88.html#_1","title":"\u4e00\u3001\u884c\u4e1a\u4e0e\u5408\u89c4\u7ea6\u675f","text":"<ul> <li>GxP/CSV\uff1aALCOA+\u3001\u5ba1\u8ba1\u8ffd\u8e2a\u3001\u7535\u5b50\u8bb0\u5f55/\u7b7e\u540d\uff0821 CFR Part 11\uff09</li> <li>\u89d2\u8272\u4e0e\u804c\u8d23\uff1aIT/QA/\u4e1a\u52a1/\u4f9b\u5e94\u5546\u5206\u6743\u3001\u53cc\u4eba\u590d\u6838</li> <li>\u6587\u6863\u4e0e\u7559\u75d5\uff1aSOP\u3001\u53d8\u66f4\u5355\u3001\u504f\u5dee/\u504f\u79bb\u3001CAPA</li> </ul>"},{"location":"enterprise/%E5%9F%BA%E4%BA%8EWindows%E7%9A%84%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E8%A1%8C%E4%B8%9A%E8%BD%AF%E4%BB%B6%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88.html#_2","title":"\u4e8c\u3001\u5178\u578b\u7cfb\u7edf\u4e0e\u67b6\u6784","text":"<ul> <li>\u5e94\u7528\u7ed3\u6784\uff1a\u5ba2\u6237\u7aef/\u670d\u52a1\u7aef\u3001\u4e09\u5c42\u67b6\u6784\u3001\u6570\u636e\u5e93\uff08SQL Server/Oracle\uff09</li> <li>\u73af\u5883\u5212\u5206\uff1aDEV/TEST/QA/PROD \u4e0e\u6570\u636e\u751f\u547d\u5468\u671f\u7ba1\u7406</li> <li>\u8eab\u4efd\u4e0e\u8bbf\u95ee\uff1aAD \u96c6\u6210\u3001SSO\uff08Kerberos/SAML/OIDC\uff09\u3001\u6700\u5c0f\u6743\u9650</li> </ul>"},{"location":"enterprise/%E5%9F%BA%E4%BA%8EWindows%E7%9A%84%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E8%A1%8C%E4%B8%9A%E8%BD%AF%E4%BB%B6%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88.html#_3","title":"\u4e09\u3001\u8fd0\u7ef4\u57fa\u7ebf","text":"<ul> <li>\u8865\u4e01\u4e0e\u6740\u6bd2\uff1a\u53d8\u66f4\u7a97\u53e3+\u56de\u6eda\u70b9\uff1b\u767d\u540d\u5355\uff08\u670d\u52a1/\u7aef\u53e3/\u8def\u5f84\uff09</li> <li>\u5907\u4efd\u4e0e\u6062\u590d\uff1a\u5168/\u5dee/\u65e5\u5fd7\uff1b\u5f02\u5730\uff1b\u6f14\u7ec3\u8ba1\u5212\u4e0e\u8bb0\u5f55</li> <li>\u76d1\u63a7\u4e0e\u544a\u8b66\uff1a\u670d\u52a1\u53ef\u7528\u6027\u3001\u6027\u80fd\u3001\u5b58\u50a8\u3001Windows \u4e8b\u4ef6\u3001\u5e94\u7528\u65e5\u5fd7</li> </ul>"},{"location":"enterprise/%E5%9F%BA%E4%BA%8EWindows%E7%9A%84%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E8%A1%8C%E4%B8%9A%E8%BD%AF%E4%BB%B6%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88.html#_4","title":"\u56db\u3001\u53d8\u66f4\u4e0e\u53d1\u5e03","text":"<ul> <li>\u53d8\u66f4\u6d41\u7a0b\uff1a\u9700\u6c42\u2192\u8bc4\u5ba1\u2192\u9a8c\u8bc1\u2192\u5b9e\u65bd\u2192\u9a8c\u8bc1\u2192\u5173\u95ed</li> <li>\u53d1\u5e03\u7b56\u7565\uff1a\u7070\u5ea6/\u84dd\u7eff\uff1b\u56de\u6eda\u9884\u6848\uff1b\u4f9b\u5e94\u5546\u5230\u573a\u652f\u6301\u4e0e\u9a8c\u8bc1\u8bc1\u636e</li> </ul>"},{"location":"enterprise/%E5%9F%BA%E4%BA%8EWindows%E7%9A%84%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E8%A1%8C%E4%B8%9A%E8%BD%AF%E4%BB%B6%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88.html#_5","title":"\u4e94\u3001\u8d26\u6237\u4e0e\u6743\u9650","text":"<ul> <li>\u804c\u80fd\u5206\u79bb\uff1a\u7cfb\u7edf\u7ba1\u7406\u5458/\u6570\u636e\u5e93\u7ba1\u7406\u5458/\u5e94\u7528\u7ba1\u7406\u5458/\u5ba1\u8ba1</li> <li>\u6700\u5c0f\u6743\u9650\u4e0e\u5ba1\u6279\uff1b\u4e34\u65f6\u9ad8\u6743\u9650\u63d0\u6743\u4e0e\u5ba1\u8ba1</li> </ul>"},{"location":"enterprise/%E5%9F%BA%E4%BA%8EWindows%E7%9A%84%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E8%A1%8C%E4%B8%9A%E8%BD%AF%E4%BB%B6%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88.html#_6","title":"\u516d\u3001\u5b89\u5168\u4e0e\u5408\u89c4","text":"<ul> <li>\u5ba1\u8ba1\u8ffd\u8e2a\uff1a\u4e0d\u53ef\u7be1\u6539\u3001\u65f6\u95f4\u540c\u6b65\u3001\u65e5\u5fd7\u4fdd\u7559</li> <li>\u6570\u636e\u4fdd\u62a4\uff1a\u9759\u6001/\u4f20\u8f93\u52a0\u5bc6\u3001\u5bc6\u94a5\u7ba1\u7406\u3001\u8bbf\u95ee\u63a7\u5236</li> <li>\u7b2c\u4e09\u65b9\u7ec4\u4ef6\u6e05\u5355\u4e0e\u6f0f\u6d1e\u4fee\u590d\uff08SBOM/\u8865\u4e01\u5468\u671f\uff09</li> </ul>"},{"location":"enterprise/%E5%9F%BA%E4%BA%8EWindows%E7%9A%84%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E8%A1%8C%E4%B8%9A%E8%BD%AF%E4%BB%B6%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88.html#sla","title":"\u4e03\u3001\u670d\u52a1\u53f0\u4e0eSLA","text":"<ul> <li>\u4e8b\u4ef6\u7ba1\u7406/\u95ee\u9898\u7ba1\u7406/\u9700\u6c42\u7ba1\u7406\uff1b\u4f18\u5148\u7ea7\u4e0e\u54cd\u5e94\u65f6\u95f4</li> <li>\u77e5\u8bc6\u5e93\u5efa\u8bbe\u4e0e\u4f9b\u5e94\u5546\u652f\u6301\u901a\u9053</li> </ul>"},{"location":"enterprise/%E5%9F%BA%E4%BA%8EWindows%E7%9A%84%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E8%A1%8C%E4%B8%9A%E8%BD%AF%E4%BB%B6%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88.html#_7","title":"\u516b\u3001\u8fd0\u7ef4\u6e05\u5355\uff08\u793a\u4f8b\uff09","text":"<ul> <li>[ ] \u5173\u952e\u7cfb\u7edf\u53f0\u8d26\u4e0e\u8d23\u4efb\u4eba</li> <li>[ ] \u5907\u4efd\u4e0e\u6062\u590d\u6f14\u7ec3\u8bb0\u5f55</li> <li>[ ] \u53d1\u5e03\u5355\u4e0e\u53d8\u66f4\u8bb0\u5f55\uff08\u542b\u9a8c\u8bc1\u8bc1\u636e\uff09</li> <li>[ ] \u5b89\u5168\u57fa\u7ebf\u4e0e\u6f0f\u6d1e\u4fee\u590d\u8ba1\u5212</li> </ul>"},{"location":"enterprise/%E5%9F%BA%E4%BA%8EWindows%E7%9A%84%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E8%A1%8C%E4%B8%9A%E8%BD%AF%E4%BB%B6%E8%BF%90%E7%BB%B4%E6%96%B9%E6%A1%88.html#_8","title":"\u9644\u5f55","text":"<ul> <li>\u6587\u6863\u6a21\u677f\uff1a\u53d8\u66f4\u5355\u3001\u9a8c\u8bc1\u8bb0\u5f55\u3001\u56de\u6eda\u65b9\u6848\u3001\u5e94\u6025\u9884\u6848</li> <li>\u53c2\u8003\uff1aGAMP 5\u300121 CFR Part 11\u3001Annex 11\u3001ISPE/ICH \u6307\u5357</li> </ul>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html","title":"\u751f\u7269\u5236\u836f\u4f01\u4e1a IT \u57fa\u7840\u67b6\u6784\u6982\u89c8","text":"<p>\u9002\u7528\u8bfb\u8005\uff1a\u4f01\u4e1a IT \u7ba1\u7406\u5458\u3001\u7cfb\u7edf\u67b6\u6784\u5e08\u3001IT \u65b0\u4eba \u76ee\u6807\uff1a\u5168\u9762\u4e86\u89e3\u751f\u7269\u5236\u836f\u4f01\u4e1a\u7684 IT \u57fa\u7840\u67b6\u6784\uff0c\u5305\u62ec\u6838\u5fc3\u670d\u52a1\u3001\u7f51\u7edc\u67b6\u6784\u3001\u5b89\u5168\u5408\u89c4\u8981\u6c42\u3002</p>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#1-it","title":"1. \u751f\u7269\u5236\u836f\u4f01\u4e1a IT \u7279\u70b9","text":""},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#11","title":"1.1 \u884c\u4e1a\u7279\u6b8a\u6027","text":"<p>\u751f\u7269\u5236\u836f\u4f01\u4e1a\u7684 IT \u57fa\u7840\u67b6\u6784\u4e0e\u4e00\u822c\u4f01\u4e1a\u6709\u663e\u8457\u5dee\u5f02\uff1a</p> \u7279\u70b9 \u8bf4\u660e IT \u5f71\u54cd \u9ad8\u5ea6\u5408\u89c4 FDA 21 CFR Part 11\u3001EU Annex 11\u3001GxP \u7cfb\u7edf\u9a8c\u8bc1\u3001\u5ba1\u8ba1\u8ffd\u8e2a\u3001\u7535\u5b50\u7b7e\u540d \u6570\u636e\u5b8c\u6574\u6027 ALCOA+ \u539f\u5219 \u6570\u636e\u4e0d\u53ef\u7be1\u6539\u3001\u5b8c\u6574\u5907\u4efd \u5b9e\u9a8c\u5ba4\u7cfb\u7edf LIMS\u3001ELN\u3001CDS\u3001SDMS \u4e13\u4e1a\u8f6f\u4ef6\u96c6\u6210 \u6df7\u5408\u73af\u5883 Windows + Linux + \u4e13\u7528\u8bbe\u5907 \u591a\u5e73\u53f0\u7ba1\u7406 \u957f\u671f\u4fdd\u5b58 \u6570\u636e\u4fdd\u7559 25 \u5e74+ \u5f52\u6863\u7cfb\u7edf\u3001\u4ecb\u8d28\u8fc1\u79fb \u5b89\u5168\u9694\u79bb \u751f\u4ea7\u7f51\u7edc\u9694\u79bb \u7f51\u7edc\u5206\u6bb5\u3001\u9632\u706b\u5899"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#12-it","title":"1.2 IT \u7ec4\u7ec7\u67b6\u6784","text":"<pre><code>IT \u603b\u76d1\n\u251c\u2500\u2500 \u57fa\u7840\u67b6\u6784\u56e2\u961f\n\u2502   \u251c\u2500\u2500 \u7f51\u7edc\u5de5\u7a0b\u5e08\n\u2502   \u251c\u2500\u2500 \u7cfb\u7edf\u7ba1\u7406\u5458\uff08Windows/Linux\uff09\n\u2502   \u2514\u2500\u2500 \u684c\u9762\u652f\u6301\u5de5\u7a0b\u5e08\n\u251c\u2500\u2500 \u5e94\u7528\u652f\u6301\u56e2\u961f\n\u2502   \u251c\u2500\u2500 LIMS \u7ba1\u7406\u5458\n\u2502   \u251c\u2500\u2500 ERP \u7ba1\u7406\u5458\uff08SAP/Oracle\uff09\n\u2502   \u2514\u2500\u2500 \u529e\u516c\u8f6f\u4ef6\u652f\u6301\n\u251c\u2500\u2500 \u4fe1\u606f\u5b89\u5168\u56e2\u961f\n\u2502   \u251c\u2500\u2500 \u5b89\u5168\u5de5\u7a0b\u5e08\n\u2502   \u251c\u2500\u2500 \u5408\u89c4\u4e13\u5458\n\u2502   \u2514\u2500\u2500 \u6570\u636e\u4fdd\u62a4\u4e13\u5458\n\u2514\u2500\u2500 \u9a8c\u8bc1\u4e0e\u5408\u89c4\u56e2\u961f\n    \u251c\u2500\u2500 CSV \u5de5\u7a0b\u5e08\n    \u251c\u2500\u2500 \u9a8c\u8bc1\u5de5\u7a0b\u5e08\n    \u2514\u2500\u2500 \u5ba1\u8ba1\u4e13\u5458\n</code></pre>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#2-it","title":"2. \u6838\u5fc3 IT \u670d\u52a1","text":""},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#21","title":"2.1 \u8eab\u4efd\u8ba4\u8bc1\u4e0e\u76ee\u5f55\u670d\u52a1","text":"\u670d\u52a1 \u7528\u9014 \u90e8\u7f72\u65b9\u5f0f Active Directory (AD) \u7528\u6237\u8d26\u53f7\u3001\u7ec4\u7b56\u7565\u3001\u6743\u9650\u7ba1\u7406 \u4e3b\u57df\u63a7 + \u5907\u57df\u63a7\uff08\u81f3\u5c112\u53f0\uff09 Azure AD / Entra ID \u4e91\u670d\u52a1\u96c6\u6210\u3001SSO \u6df7\u5408\u90e8\u7f72 LDAP Linux \u7cfb\u7edf\u8ba4\u8bc1 \u4e0e AD \u96c6\u6210 MFA\uff08\u591a\u56e0\u7d20\u8ba4\u8bc1\uff09 \u589e\u5f3a\u5b89\u5168\u6027 Duo\u3001Azure MFA <p>\u5178\u578b\u90e8\u7f72\uff1a - \u4e3b\u57df\u63a7\uff1aWindows Server 2022\uff0c\u7269\u7406\u673a\u6216\u865a\u62df\u673a - \u5907\u57df\u63a7\uff1a\u5f02\u5730\u673a\u623f\uff0c\u707e\u5907 - \u57df\u529f\u80fd\u7ea7\u522b\uff1aWindows Server 2016 \u6216\u66f4\u9ad8 - \u57df\u540d\u793a\u4f8b\uff1a<code>pharma.local</code> \u6216 <code>corp.pharma.com</code></p>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#22","title":"2.2 \u90ae\u4ef6\u7cfb\u7edf","text":"\u670d\u52a1 \u7528\u9014 \u90e8\u7f72\u65b9\u5f0f Exchange Server \u4f01\u4e1a\u90ae\u4ef6\u3001\u65e5\u5386\u3001\u8054\u7cfb\u4eba \u672c\u5730\u90e8\u7f72\uff082019/2022\uff09 Microsoft 365 (Exchange Online) \u4e91\u90ae\u4ef6\u670d\u52a1 \u6df7\u5408\u90e8\u7f72\u6216\u7eaf\u4e91 \u90ae\u4ef6\u7f51\u5173 \u53cd\u5783\u573e\u90ae\u4ef6\u3001\u75c5\u6bd2\u8fc7\u6ee4 Barracuda\u3001Proofpoint \u90ae\u4ef6\u5f52\u6863 \u5408\u89c4\u5f52\u6863\u3001eDiscovery Mimecast\u3001Veritas <p>\u5178\u578b\u90e8\u7f72\uff1a - Exchange Server 2019\uff08\u672c\u5730\uff09+ Exchange Online\uff08\u4e91\uff09 - \u90ae\u7bb1\u5927\u5c0f\uff1a50GB - 100GB/\u7528\u6237 - \u5f52\u6863\u7b56\u7565\uff1a\u6240\u6709\u90ae\u4ef6\u4fdd\u7559 7 \u5e74</p>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#23","title":"2.3 \u6587\u4ef6\u670d\u52a1","text":"\u670d\u52a1 \u7528\u9014 \u90e8\u7f72\u65b9\u5f0f Windows File Server \u90e8\u95e8\u5171\u4eab\u6587\u4ef6\u5939 Windows Server 2022 + DFS SharePoint \u6587\u6863\u7ba1\u7406\u3001\u534f\u4f5c SharePoint Server \u6216 Online \u7f51\u7edc\u5b58\u50a8 (NAS) \u5927\u5bb9\u91cf\u5b58\u50a8 NetApp\u3001Dell EMC\u3001Synology \u5bf9\u8c61\u5b58\u50a8 \u5f52\u6863\u3001\u5907\u4efd MinIO\u3001AWS S3 <p>\u5178\u578b\u90e8\u7f72\uff1a - \u6587\u4ef6\u670d\u52a1\u5668\uff1a2 \u53f0\uff08\u4e3b\u5907\uff09\uff0cRAID 10\uff0c100TB+ - DFS \u547d\u540d\u7a7a\u95f4\uff1a<code>\\\\pharma.local\\shares</code> - \u6743\u9650\u7ba1\u7406\uff1a\u57fa\u4e8e AD \u7ec4</p>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#24","title":"2.4 \u6253\u5370\u670d\u52a1","text":"\u670d\u52a1 \u7528\u9014 \u90e8\u7f72\u65b9\u5f0f Print Server \u96c6\u4e2d\u7ba1\u7406\u6253\u5370\u673a Windows Server 2022 \u6253\u5370\u5ba1\u8ba1 \u8ddf\u8e2a\u6253\u5370\u8bb0\u5f55 PaperCut\u3001PrinterLogic \u5b89\u5168\u6253\u5370 \u5237\u5361\u53d6\u4ef6 \u96c6\u6210 AD \u8ba4\u8bc1"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#25","title":"2.5 \u8fdc\u7a0b\u8bbf\u95ee","text":"\u670d\u52a1 \u7528\u9014 \u90e8\u7f72\u65b9\u5f0f VPN \u8fdc\u7a0b\u529e\u516c Cisco AnyConnect\u3001Palo Alto GlobalProtect Remote Desktop Gateway \u8fdc\u7a0b\u684c\u9762\u8bbf\u95ee Windows Server 2022 Citrix / VMware Horizon \u865a\u62df\u684c\u9762\uff08VDI\uff09 \u9002\u7528\u4e8e\u5408\u89c4\u73af\u5883 Jump Server \u5821\u5792\u673a \u751f\u4ea7\u73af\u5883\u8bbf\u95ee"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#26","title":"2.6 \u5907\u4efd\u4e0e\u707e\u5907","text":"\u670d\u52a1 \u7528\u9014 \u90e8\u7f72\u65b9\u5f0f Veeam Backup \u865a\u62df\u673a\u5907\u4efd \u5907\u4efd\u670d\u52a1\u5668 + \u5b58\u50a8 Windows Server Backup \u7269\u7406\u670d\u52a1\u5668\u5907\u4efd \u672c\u5730 + \u5f02\u5730 \u6570\u636e\u5e93\u5907\u4efd SQL Server\u3001Oracle RMAN\u3001SQL Agent \u5f02\u5730\u707e\u5907 \u707e\u96be\u6062\u590d \u5f02\u5730\u673a\u623f\u6216\u4e91 <p>\u5907\u4efd\u7b56\u7565\uff1a - \u6bcf\u65e5\u589e\u91cf\u5907\u4efd - \u6bcf\u5468\u5b8c\u5168\u5907\u4efd - \u4fdd\u7559\u671f\uff1a30 \u5929\uff08\u672c\u5730\uff09+ 7 \u5e74\uff08\u5f52\u6863\uff09</p>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#3","title":"3. \u7f51\u7edc\u67b6\u6784","text":""},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#31","title":"3.1 \u7f51\u7edc\u5206\u6bb5","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u4e92\u8054\u7f51                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502  \u9632\u706b\u5899 (Palo Alto) \u2502\n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502             \u2502             \u2502\n\u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510\n\u2502 DMZ    \u2502  \u2502 \u529e\u516c\u7f51\u7edc  \u2502  \u2502 \u751f\u4ea7\u7f51\u7edc\u2502\n\u2502 (\u90ae\u4ef6\u7f51\u5173)\u2502  \u2502 (VLAN 10)\u2502  \u2502 (VLAN 20)\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502             \u2502\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502        \u2502             \u2502        \u2502\n    \u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2510 \u250c\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502 \u7ba1\u7406\u7f51\u7edc\u2502 \u2502 \u8bbf\u5ba2\u7f51\u7edc\u2502 \u2502 \u5b9e\u9a8c\u5ba4\u7f51\u2502 \u2502 \u670d\u52a1\u5668\u7f51\u2502\n    \u2502(VLAN 99)\u2502 \u2502(VLAN 50)\u2502 \u2502(VLAN 30)\u2502 \u2502(VLAN 40)\u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#32-vlan","title":"3.2 VLAN \u5212\u5206","text":"VLAN ID \u7f51\u6bb5 \u7528\u9014 \u5b89\u5168\u7ea7\u522b VLAN 10 10.10.10.0/24 \u529e\u516c\u7f51\u7edc\uff08\u5458\u5de5\u7535\u8111\uff09 \u4e2d VLAN 20 10.10.20.0/24 \u751f\u4ea7\u7f51\u7edc\uff08GxP \u7cfb\u7edf\uff09 \u9ad8 VLAN 30 10.10.30.0/24 \u5b9e\u9a8c\u5ba4\u7f51\u7edc\uff08LIMS\u3001\u4eea\u5668\uff09 \u9ad8 VLAN 40 10.10.40.0/24 \u670d\u52a1\u5668\u7f51\u7edc\uff08AD\u3001Exchange\uff09 \u9ad8 VLAN 50 10.10.50.0/24 \u8bbf\u5ba2\u7f51\u7edc\uff08WiFi\uff09 \u4f4e VLAN 99 10.10.99.0/24 \u7ba1\u7406\u7f51\u7edc\uff08\u4ea4\u6362\u673a\u3001\u9632\u706b\u5899\uff09 \u6700\u9ad8"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#33","title":"3.3 \u9632\u706b\u5899\u89c4\u5219\u793a\u4f8b","text":"<pre><code># \u529e\u516c\u7f51\u7edc \u2192 \u4e92\u8054\u7f51\uff1a\u5141\u8bb8 HTTP/HTTPS\nVLAN 10 \u2192 Internet: Allow TCP 80, 443\n\n# \u529e\u516c\u7f51\u7edc \u2192 \u670d\u52a1\u5668\u7f51\u7edc\uff1a\u5141\u8bb8 AD\u3001Exchange\nVLAN 10 \u2192 VLAN 40: Allow TCP 389, 636, 88, 445, 25, 587\n\n# \u751f\u4ea7\u7f51\u7edc \u2192 \u4e92\u8054\u7f51\uff1a\u62d2\u7edd\uff08\u9694\u79bb\uff09\nVLAN 20 \u2192 Internet: Deny All\n\n# \u5b9e\u9a8c\u5ba4\u7f51\u7edc \u2192 \u670d\u52a1\u5668\u7f51\u7edc\uff1a\u5141\u8bb8 LIMS \u6570\u636e\u5e93\nVLAN 30 \u2192 VLAN 40: Allow TCP 1521 (Oracle), 1433 (SQL Server)\n\n# \u8bbf\u5ba2\u7f51\u7edc \u2192 \u5185\u7f51\uff1a\u62d2\u7edd\nVLAN 50 \u2192 VLAN 10/20/30/40: Deny All\n</code></pre>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#4","title":"4. \u5b9e\u9a8c\u5ba4\u4e13\u7528\u7cfb\u7edf","text":""},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#41-lims","title":"4.1 LIMS\uff08\u5b9e\u9a8c\u5ba4\u4fe1\u606f\u7ba1\u7406\u7cfb\u7edf\uff09","text":"<ul> <li>\u7528\u9014\uff1a\u6837\u54c1\u7ba1\u7406\u3001\u68c0\u6d4b\u6d41\u7a0b\u3001\u7ed3\u679c\u8bb0\u5f55</li> <li>\u5e38\u7528\u8f6f\u4ef6\uff1aLabWare\u3001Thermo SampleManager\u3001Waters NuGenesis</li> <li>\u90e8\u7f72\uff1aWindows Server + SQL Server/Oracle</li> <li>\u5408\u89c4\u8981\u6c42\uff1a21 CFR Part 11 \u9a8c\u8bc1\u3001\u5ba1\u8ba1\u8ffd\u8e2a</li> </ul>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#42-eln","title":"4.2 ELN\uff08\u7535\u5b50\u5b9e\u9a8c\u8bb0\u5f55\u672c\uff09","text":"<ul> <li>\u7528\u9014\uff1a\u5b9e\u9a8c\u8bb0\u5f55\u3001\u7535\u5b50\u7b7e\u540d\u3001\u534f\u4f5c</li> <li>\u5e38\u7528\u8f6f\u4ef6\uff1aBenchling\u3001PerkinElmer E-Notebook\u3001BIOVIA Notebook</li> <li>\u90e8\u7f72\uff1a\u4e91\u7aef\u6216\u672c\u5730</li> <li>\u5408\u89c4\u8981\u6c42\uff1a\u6570\u636e\u5b8c\u6574\u6027\u3001\u7535\u5b50\u7b7e\u540d</li> </ul>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#43-cds","title":"4.3 CDS\uff08\u8272\u8c31\u6570\u636e\u7cfb\u7edf\uff09","text":"<ul> <li>\u7528\u9014\uff1a\u4eea\u5668\u6570\u636e\u91c7\u96c6\u3001\u5206\u6790</li> <li>\u5e38\u7528\u8f6f\u4ef6\uff1aEmpower (Waters)\u3001ChemStation (Agilent)\u3001Chromeleon (Thermo)</li> <li>\u90e8\u7f72\uff1aWindows \u5de5\u4f5c\u7ad9 + \u6587\u4ef6\u670d\u52a1\u5668</li> <li>\u5408\u89c4\u8981\u6c42\uff1a\u5ba1\u8ba1\u8ffd\u8e2a\u3001\u6570\u636e\u5907\u4efd</li> </ul>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#44-sdms","title":"4.4 SDMS\uff08\u79d1\u5b66\u6570\u636e\u7ba1\u7406\u7cfb\u7edf\uff09","text":"<ul> <li>\u7528\u9014\uff1a\u96c6\u4e2d\u5b58\u50a8\u4eea\u5668\u6570\u636e</li> <li>\u5e38\u7528\u8f6f\u4ef6\uff1aWaters NuGenesis SDMS\u3001Thermo Core SDMS</li> <li>\u90e8\u7f72\uff1aWindows Server + SQL Server</li> <li>\u5408\u89c4\u8981\u6c42\uff1a\u957f\u671f\u5f52\u6863\u3001\u6570\u636e\u8fc1\u79fb</li> </ul>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#5","title":"5. \u4f01\u4e1a\u5e94\u7528\u7cfb\u7edf","text":""},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#51-erp","title":"5.1 ERP\uff08\u4f01\u4e1a\u8d44\u6e90\u8ba1\u5212\uff09","text":"<ul> <li>\u5e38\u7528\u8f6f\u4ef6\uff1aSAP\u3001Oracle EBS\u3001Microsoft Dynamics</li> <li>\u6a21\u5757\uff1a\u8d22\u52a1\u3001\u91c7\u8d2d\u3001\u5e93\u5b58\u3001\u751f\u4ea7\u3001\u8d28\u91cf</li> <li>\u90e8\u7f72\uff1a\u672c\u5730\u6216\u4e91\uff08SAP S/4HANA Cloud\uff09</li> <li>\u96c6\u6210\uff1a\u4e0e LIMS\u3001MES \u96c6\u6210</li> </ul>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#52-mes","title":"5.2 MES\uff08\u5236\u9020\u6267\u884c\u7cfb\u7edf\uff09","text":"<ul> <li>\u7528\u9014\uff1a\u751f\u4ea7\u8fc7\u7a0b\u7ba1\u7406\u3001\u6279\u6b21\u8bb0\u5f55</li> <li>\u5e38\u7528\u8f6f\u4ef6\uff1aSiemens Opcenter\u3001Rockwell FactoryTalk\u3001Werum PAS-X</li> <li>\u90e8\u7f72\uff1a\u751f\u4ea7\u7f51\u7edc\uff08VLAN 20\uff09</li> <li>\u5408\u89c4\u8981\u6c42\uff1a\u7535\u5b50\u6279\u8bb0\u5f55\uff08eBR\uff09\u300121 CFR Part 11</li> </ul>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#53-qms","title":"5.3 QMS\uff08\u8d28\u91cf\u7ba1\u7406\u7cfb\u7edf\uff09","text":"<ul> <li>\u7528\u9014\uff1a\u504f\u5dee\u7ba1\u7406\u3001\u53d8\u66f4\u63a7\u5236\u3001CAPA</li> <li>\u5e38\u7528\u8f6f\u4ef6\uff1aVeeva Vault QMS\u3001MasterControl\u3001TrackWise</li> <li>\u90e8\u7f72\uff1a\u4e91\u7aef\u6216\u672c\u5730</li> <li>\u5408\u89c4\u8981\u6c42\uff1a\u5ba1\u8ba1\u8ffd\u8e2a\u3001\u7535\u5b50\u7b7e\u540d</li> </ul>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#54-dms","title":"5.4 DMS\uff08\u6587\u6863\u7ba1\u7406\u7cfb\u7edf\uff09","text":"<ul> <li>\u7528\u9014\uff1aSOP\u3001\u9a8c\u8bc1\u6587\u6863\u3001\u57f9\u8bad\u8bb0\u5f55</li> <li>\u5e38\u7528\u8f6f\u4ef6\uff1aVeeva Vault\u3001MasterControl\u3001SharePoint</li> <li>\u90e8\u7f72\uff1a\u4e91\u7aef\u6216\u672c\u5730</li> <li>\u5408\u89c4\u8981\u6c42\uff1a\u7248\u672c\u63a7\u5236\u3001\u8bbf\u95ee\u6743\u9650</li> </ul>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#6","title":"6. \u5b89\u5168\u4e0e\u5408\u89c4","text":""},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#61","title":"6.1 \u8bbf\u95ee\u63a7\u5236","text":"<pre><code>\u6700\u5c0f\u6743\u9650\u539f\u5219\uff1a\n- \u7528\u6237\u53ea\u80fd\u8bbf\u95ee\u5de5\u4f5c\u6240\u9700\u7684\u7cfb\u7edf\u548c\u6570\u636e\n- \u4f7f\u7528 AD \u7ec4\u7ba1\u7406\u6743\u9650\n- \u5b9a\u671f\u5ba1\u67e5\u6743\u9650\uff08\u6bcf\u5b63\u5ea6\uff09\n\n\u793a\u4f8b AD \u7ec4\u7ed3\u6784\uff1a\n\u251c\u2500\u2500 GG_LIMS_Users\uff08LIMS \u666e\u901a\u7528\u6237\uff09\n\u251c\u2500\u2500 GG_LIMS_Admins\uff08LIMS \u7ba1\u7406\u5458\uff09\n\u251c\u2500\u2500 GG_FileServer_RD_Read\uff08\u7814\u53d1\u90e8\u95e8\u53ea\u8bfb\uff09\n\u251c\u2500\u2500 GG_FileServer_RD_Write\uff08\u7814\u53d1\u90e8\u95e8\u8bfb\u5199\uff09\n\u251c\u2500\u2500 GG_Production_Operators\uff08\u751f\u4ea7\u64cd\u4f5c\u5458\uff09\n\u2514\u2500\u2500 GG_QA_Reviewers\uff08\u8d28\u91cf\u5ba1\u6838\u5458\uff09\n</code></pre>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#62","title":"6.2 \u5ba1\u8ba1\u4e0e\u65e5\u5fd7","text":"\u7cfb\u7edf \u5ba1\u8ba1\u5185\u5bb9 \u4fdd\u7559\u671f Active Directory \u767b\u5f55\u3001\u6743\u9650\u53d8\u66f4 7 \u5e74 LIMS \u6570\u636e\u4fee\u6539\u3001\u7535\u5b50\u7b7e\u540d 25 \u5e74+ \u6587\u4ef6\u670d\u52a1\u5668 \u6587\u4ef6\u8bbf\u95ee\u3001\u4fee\u6539\u3001\u5220\u9664 7 \u5e74 \u9632\u706b\u5899 \u7f51\u7edc\u6d41\u91cf\u3001\u5165\u4fb5\u68c0\u6d4b 1 \u5e74 Exchange \u90ae\u4ef6\u53d1\u9001\u3001\u63a5\u6536 7 \u5e74"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#63","title":"6.3 \u6570\u636e\u5907\u4efd\u4e0e\u6062\u590d","text":"<pre><code>\u5907\u4efd\u7b56\u7565\uff1a\n- RTO\uff08\u6062\u590d\u65f6\u95f4\u76ee\u6807\uff09\uff1a4 \u5c0f\u65f6\n- RPO\uff08\u6062\u590d\u70b9\u76ee\u6807\uff09\uff1a1 \u5c0f\u65f6\n\n\u5907\u4efd\u65b9\u6848\uff1a\n1. \u865a\u62df\u673a\uff1aVeeam \u6bcf\u65e5\u589e\u91cf\u5907\u4efd\n2. \u6570\u636e\u5e93\uff1a\u6bcf\u5c0f\u65f6\u4e8b\u52a1\u65e5\u5fd7\u5907\u4efd\n3. \u6587\u4ef6\u670d\u52a1\u5668\uff1a\u6bcf\u65e5\u589e\u91cf\u5907\u4efd\n4. \u5f02\u5730\u5907\u4efd\uff1a\u6bcf\u5468\u540c\u6b65\u5230\u5f02\u5730\u673a\u623f\n5. \u4e91\u5907\u4efd\uff1a\u5173\u952e\u6570\u636e\u5907\u4efd\u5230 Azure/AWS\n</code></pre>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#64","title":"6.4 \u707e\u96be\u6062\u590d\u6f14\u7ec3","text":"<pre><code>\u6f14\u7ec3\u9891\u7387\uff1a\u6bcf\u5e74 2 \u6b21\n\n\u6f14\u7ec3\u573a\u666f\uff1a\n1. \u4e3b\u57df\u63a7\u6545\u969c \u2192 \u5207\u6362\u5230\u5907\u57df\u63a7\n2. Exchange \u670d\u52a1\u5668\u6545\u969c \u2192 \u4ece\u5907\u4efd\u6062\u590d\n3. \u6587\u4ef6\u670d\u52a1\u5668\u6545\u969c \u2192 \u4ece DFS \u526f\u672c\u6062\u590d\n4. \u673a\u623f\u65ad\u7535 \u2192 \u5207\u6362\u5230\u5f02\u5730\u673a\u623f\n5. \u52d2\u7d22\u8f6f\u4ef6\u653b\u51fb \u2192 \u9694\u79bb\u3001\u6062\u590d\u5907\u4efd\n\n\u6f14\u7ec3\u8bb0\u5f55\uff1a\n- \u6062\u590d\u65f6\u95f4\n- \u6570\u636e\u4e22\u5931\u91cf\n- \u6539\u8fdb\u63aa\u65bd\n</code></pre>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#7","title":"7. \u7ec8\u7aef\u8bbe\u5907\u7ba1\u7406","text":""},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#71","title":"7.1 \u6807\u51c6\u914d\u7f6e","text":"\u8bbe\u5907\u7c7b\u578b \u914d\u7f6e \u7528\u9014 \u529e\u516c\u7b14\u8bb0\u672c Dell Latitude / HP EliteBook, 16GB RAM, 512GB SSD \u65e5\u5e38\u529e\u516c \u5de5\u7a0b\u5e08\u5de5\u4f5c\u7ad9 Dell Precision / HP ZBook, 32GB RAM, 1TB SSD \u5f00\u53d1\u3001\u6570\u636e\u5206\u6790 \u5b9e\u9a8c\u5ba4\u5de5\u4f5c\u7ad9 \u56fa\u5b9a\u914d\u7f6e\uff0cWindows 10 LTSC \u4eea\u5668\u63a7\u5236 \u751f\u4ea7\u7ec8\u7aef \u7626\u5ba2\u6237\u7aef + Citrix VDI \u751f\u4ea7\u73af\u5883"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#72","title":"7.2 \u8bbe\u5907\u7ba1\u7406\u5de5\u5177","text":"<ul> <li>SCCM / Intune\uff1a\u8f6f\u4ef6\u5206\u53d1\u3001\u8865\u4e01\u7ba1\u7406</li> <li>MDM\uff08\u79fb\u52a8\u8bbe\u5907\u7ba1\u7406\uff09\uff1a\u624b\u673a\u3001\u5e73\u677f\u7ba1\u7406</li> <li>\u8d44\u4ea7\u7ba1\u7406\uff1aServiceNow\u3001Lansweeper</li> </ul>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#73","title":"7.3 \u6807\u51c6\u8f6f\u4ef6\u5305","text":"<pre><code>\u57fa\u7840\u8f6f\u4ef6\uff1a\n- Windows 10/11 Enterprise\n- Microsoft Office 365\n- Adobe Acrobat Reader\n- 7-Zip\n- Chrome / Edge\n\n\u5b89\u5168\u8f6f\u4ef6\uff1a\n- \u9632\u75c5\u6bd2\uff1aSymantec Endpoint Protection / CrowdStrike\n- VPN \u5ba2\u6237\u7aef\uff1aCisco AnyConnect\n- \u52a0\u5bc6\u8f6f\u4ef6\uff1aBitLocker\n\n\u4e13\u4e1a\u8f6f\u4ef6\uff08\u6309\u90e8\u95e8\uff09\uff1a\n- \u7814\u53d1\uff1aChemDraw\u3001GraphPad Prism\u3001Python\n- \u8d28\u91cf\uff1aMinitab\u3001JMP\n- IT\uff1aPuTTY\u3001WinSCP\u3001Remote Desktop Manager\n</code></pre>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#8","title":"8. \u5408\u89c4\u4e0e\u9a8c\u8bc1","text":""},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#81-csv","title":"8.1 \u8ba1\u7b97\u673a\u7cfb\u7edf\u9a8c\u8bc1\uff08CSV\uff09","text":"<p>\u751f\u7269\u5236\u836f\u4f01\u4e1a\u7684 GxP \u7cfb\u7edf\u5fc5\u987b\u7ecf\u8fc7\u9a8c\u8bc1\uff1a</p> <pre><code>\u9a8c\u8bc1\u751f\u547d\u5468\u671f\uff1a\n1. \u89c4\u5212\uff08Validation Plan\uff09\n2. \u9700\u6c42\u5206\u6790\uff08URS - User Requirements Specification\uff09\n3. \u98ce\u9669\u8bc4\u4f30\uff08Risk Assessment\uff09\n4. \u8bbe\u8ba1\u786e\u8ba4\uff08DQ - Design Qualification\uff09\n5. \u5b89\u88c5\u786e\u8ba4\uff08IQ - Installation Qualification\uff09\n6. \u8fd0\u884c\u786e\u8ba4\uff08OQ - Operational Qualification\uff09\n7. \u6027\u80fd\u786e\u8ba4\uff08PQ - Performance Qualification\uff09\n8. \u9a8c\u8bc1\u62a5\u544a\uff08Validation Report\uff09\n9. \u5b9a\u671f\u5ba1\u67e5\uff08Periodic Review\uff09\n\n\u9a8c\u8bc1\u8303\u56f4\uff1a\n- LIMS\u3001ELN\u3001CDS\u3001SDMS\n- MES\u3001ERP\uff08GxP \u6a21\u5757\uff09\n- \u6587\u6863\u7ba1\u7406\u7cfb\u7edf\n- \u7535\u5b50\u7b7e\u540d\u7cfb\u7edf\n</code></pre>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#82","title":"8.2 \u53d8\u66f4\u63a7\u5236","text":"<pre><code>\u53d8\u66f4\u6d41\u7a0b\uff1a\n1. \u63d0\u4ea4\u53d8\u66f4\u8bf7\u6c42\uff08Change Request\uff09\n2. \u5f71\u54cd\u8bc4\u4f30\uff08Impact Assessment\uff09\n3. \u5ba1\u6279\uff08QA\u3001IT\u3001\u4e1a\u52a1\u90e8\u95e8\uff09\n4. \u6d4b\u8bd5\uff08Test Environment\uff09\n5. \u5b9e\u65bd\uff08Production Environment\uff09\n6. \u9a8c\u8bc1\uff08Post-Change Validation\uff09\n7. \u5173\u95ed\uff08Change Closure\uff09\n\n\u793a\u4f8b\uff1a\n- Windows \u8865\u4e01\uff1a\u6bcf\u6708\u7b2c\u4e8c\u4e2a\u5468\u4e8c\uff08Patch Tuesday\uff09\n- LIMS \u5347\u7ea7\uff1a\u9700\u8981\u5b8c\u6574\u7684 IQ/OQ/PQ\n- \u7f51\u7edc\u53d8\u66f4\uff1a\u9700\u8981\u56de\u6eda\u8ba1\u5212\n</code></pre>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#9-it","title":"9. IT \u670d\u52a1\u7ba1\u7406","text":""},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#91-service-desk","title":"9.1 \u670d\u52a1\u53f0\uff08Service Desk\uff09","text":"<ul> <li>\u5de5\u5177\uff1aServiceNow\u3001Jira Service Management\u3001Freshservice</li> <li>SLA\uff1a</li> <li>P1\uff08\u7cfb\u7edf\u5b95\u673a\uff09\uff1a15 \u5206\u949f\u54cd\u5e94\uff0c4 \u5c0f\u65f6\u89e3\u51b3</li> <li>P2\uff08\u529f\u80fd\u53d7\u9650\uff09\uff1a1 \u5c0f\u65f6\u54cd\u5e94\uff0c8 \u5c0f\u65f6\u89e3\u51b3</li> <li>P3\uff08\u4e00\u822c\u95ee\u9898\uff09\uff1a4 \u5c0f\u65f6\u54cd\u5e94\uff0c2 \u5929\u89e3\u51b3</li> <li>P4\uff08\u54a8\u8be2\uff09\uff1a1 \u5929\u54cd\u5e94\uff0c5 \u5929\u89e3\u51b3</li> </ul>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#92","title":"9.2 \u5e38\u89c1\u5de5\u5355\u7c7b\u578b","text":"\u7c7b\u578b \u5360\u6bd4 \u793a\u4f8b \u5bc6\u7801\u91cd\u7f6e 30% \u5fd8\u8bb0\u5bc6\u7801\u3001\u8d26\u53f7\u9501\u5b9a \u8f6f\u4ef6\u5b89\u88c5 20% \u5b89\u88c5 Office\u3001\u4e13\u4e1a\u8f6f\u4ef6 \u786c\u4ef6\u6545\u969c 15% \u7535\u8111\u65e0\u6cd5\u542f\u52a8\u3001\u6253\u5370\u673a\u6545\u969c \u7f51\u7edc\u95ee\u9898 10% \u65e0\u6cd5\u8fde\u63a5 WiFi\u3001VPN \u6545\u969c \u6743\u9650\u7533\u8bf7 10% \u6587\u4ef6\u5939\u8bbf\u95ee\u3001\u7cfb\u7edf\u6743\u9650 \u65b0\u5458\u5de5\u5165\u804c 10% \u521b\u5efa\u8d26\u53f7\u3001\u914d\u7f6e\u7535\u8111 \u5176\u4ed6 5% \u54a8\u8be2\u3001\u57f9\u8bad"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#93","title":"9.3 \u77e5\u8bc6\u5e93","text":"<pre><code>\u5e38\u89c1\u95ee\u9898\u6587\u6863\uff1a\n- \u5982\u4f55\u8fde\u63a5 VPN\n- \u5982\u4f55\u6620\u5c04\u7f51\u7edc\u9a71\u52a8\u5668\n- \u5982\u4f55\u8bbe\u7f6e Outlook \u90ae\u7bb1\n- \u5982\u4f55\u7533\u8bf7\u6587\u4ef6\u5939\u6743\u9650\n- \u5982\u4f55\u91cd\u7f6e\u5bc6\u7801\n- \u5982\u4f55\u5b89\u88c5\u6253\u5370\u673a\n\n\u64cd\u4f5c\u624b\u518c\uff1a\n- \u65b0\u5458\u5de5 IT \u5165\u804c\u6307\u5357\n- LIMS \u7528\u6237\u624b\u518c\n- \u8fdc\u7a0b\u529e\u516c\u6307\u5357\n- \u6570\u636e\u5907\u4efd\u4e0e\u6062\u590d\u6d41\u7a0b\n</code></pre>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#10","title":"10. \u6210\u672c\u4e0e\u9884\u7b97","text":""},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#101-it-500","title":"10.1 \u5178\u578b IT \u9884\u7b97\uff08500 \u4eba\u4f01\u4e1a\uff09","text":"\u9879\u76ee \u5e74\u5ea6\u9884\u7b97\uff08\u4e07\u5143\uff09 \u5360\u6bd4 \u4eba\u5458\u6210\u672c 300 40% \u786c\u4ef6\u91c7\u8d2d\uff08\u670d\u52a1\u5668\u3001\u7535\u8111\u3001\u7f51\u7edc\u8bbe\u5907\uff09 150 20% \u8f6f\u4ef6\u8bb8\u53ef\uff08Office 365\u3001LIMS\u3001ERP\uff09 120 16% \u4e91\u670d\u52a1\uff08Azure\u3001AWS\uff09 60 8% \u7f51\u7edc\u4e0e\u5b89\u5168\uff08\u9632\u706b\u5899\u3001VPN\u3001\u9632\u75c5\u6bd2\uff09 45 6% \u7ef4\u4fdd\u4e0e\u652f\u6301\uff08\u5382\u5546\u670d\u52a1\uff09 45 6% \u57f9\u8bad\u4e0e\u8ba4\u8bc1 15 2% \u5176\u4ed6\uff08\u5dee\u65c5\u3001\u529e\u516c\uff09 15 2% \u603b\u8ba1 750 100%"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#102","title":"10.2 \u8bbe\u5907\u66f4\u6362\u5468\u671f","text":"<ul> <li>\u7b14\u8bb0\u672c\u7535\u8111\uff1a3-4 \u5e74</li> <li>\u53f0\u5f0f\u673a\uff1a4-5 \u5e74</li> <li>\u670d\u52a1\u5668\uff1a5-7 \u5e74</li> <li>\u7f51\u7edc\u8bbe\u5907\uff1a7-10 \u5e74</li> <li>\u5b58\u50a8\u8bbe\u5907\uff1a5-7 \u5e74</li> </ul>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#11_1","title":"11. \u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u6587\u6863\u5316\uff1a\u6240\u6709\u7cfb\u7edf\u914d\u7f6e\u3001\u7f51\u7edc\u62d3\u6251\u3001\u64cd\u4f5c\u6d41\u7a0b\u90fd\u8981\u6587\u6863\u5316</li> <li>\u6807\u51c6\u5316\uff1a\u7edf\u4e00\u786c\u4ef6\u578b\u53f7\u3001\u8f6f\u4ef6\u7248\u672c\u3001\u914d\u7f6e\u6a21\u677f</li> <li>\u81ea\u52a8\u5316\uff1a\u4f7f\u7528\u811a\u672c\u3001GPO\u3001SCCM \u81ea\u52a8\u5316\u90e8\u7f72\u548c\u7ba1\u7406</li> <li>\u76d1\u63a7\u544a\u8b66\uff1a\u5b9e\u65f6\u76d1\u63a7\u670d\u52a1\u5668\u3001\u7f51\u7edc\u3001\u5e94\u7528\u72b6\u6001</li> <li>\u5b9a\u671f\u5ba1\u67e5\uff1a\u6bcf\u5b63\u5ea6\u5ba1\u67e5\u6743\u9650\u3001\u5907\u4efd\u3001\u5b89\u5168\u7b56\u7565</li> <li>\u57f9\u8bad\uff1a\u5b9a\u671f\u57f9\u8bad IT \u56e2\u961f\u548c\u6700\u7ec8\u7528\u6237</li> <li>\u4f9b\u5e94\u5546\u7ba1\u7406\uff1a\u7ef4\u62a4\u826f\u597d\u7684\u4f9b\u5e94\u5546\u5173\u7cfb\uff0c\u786e\u4fdd\u53ca\u65f6\u652f\u6301</li> <li>\u707e\u5907\u6f14\u7ec3\uff1a\u6bcf\u5e74\u81f3\u5c11 2 \u6b21\u707e\u96be\u6062\u590d\u6f14\u7ec3</li> <li>\u5408\u89c4\u4f18\u5148\uff1a\u6240\u6709\u53d8\u66f4\u5fc5\u987b\u7b26\u5408 GxP \u8981\u6c42</li> <li>\u7528\u6237\u4f53\u9a8c\uff1a\u5e73\u8861\u5b89\u5168\u6027\u4e0e\u6613\u7528\u6027</li> </ol>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#12","title":"12. \u672a\u6765\u8d8b\u52bf","text":""},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#121","title":"12.1 \u4e91\u5316","text":"<ul> <li>\u6df7\u5408\u4e91\uff1a\u672c\u5730 + Azure/AWS</li> <li>SaaS \u5e94\u7528\uff1aVeeva\u3001Benchling \u7b49\u4e91\u7aef LIMS/ELN</li> <li>\u4e91\u5907\u4efd\uff1a\u5f02\u5730\u707e\u5907</li> </ul>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#122-ai","title":"12.2 \u81ea\u52a8\u5316\u4e0e AI","text":"<ul> <li>RPA\uff1a\u81ea\u52a8\u5316\u91cd\u590d\u6027\u4efb\u52a1</li> <li>AI \u8fd0\u7ef4\uff1a\u667a\u80fd\u544a\u8b66\u3001\u6545\u969c\u9884\u6d4b</li> <li>\u81ea\u52a9\u670d\u52a1\uff1a\u7528\u6237\u81ea\u52a9\u91cd\u7f6e\u5bc6\u7801\u3001\u7533\u8bf7\u6743\u9650</li> </ul>"},{"location":"enterprise/%E7%94%9F%E7%89%A9%E5%88%B6%E8%8D%AF%E4%BC%81%E4%B8%9AIT%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88.html#123","title":"12.3 \u96f6\u4fe1\u4efb\u5b89\u5168","text":"<ul> <li>MFA\uff1a\u6240\u6709\u7cfb\u7edf\u5f3a\u5236\u591a\u56e0\u7d20\u8ba4\u8bc1</li> <li>\u5fae\u5206\u6bb5\uff1a\u66f4\u7ec6\u7c92\u5ea6\u7684\u7f51\u7edc\u9694\u79bb</li> <li>\u6301\u7eed\u9a8c\u8bc1\uff1a\u52a8\u6001\u6743\u9650\u7ba1\u7406</li> </ul> <p>\u53c2\u8003\u8d44\u6e90\uff1a - FDA 21 CFR Part 11 Guidance - GAMP 5\uff08Good Automated Manufacturing Practice\uff09 - ISPE Baseline Guides - Microsoft IT Showcase - NIST Cybersecurity Framework</p>"},{"location":"notes/brandnew-0926-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%85%8D%E7%BD%AE.html","title":"IT Help Desk Access Tool\uff08PyQt5\uff09\u590d\u73b0\u4e0e\u914d\u7f6e","text":"<p>\u66f4\u65b0\u65f6\u95f4\uff1a2025-11-11  \u4f5c\u8005\uff1aLifu</p>"},{"location":"notes/brandnew-0926-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%85%8D%E7%BD%AE.html#_1","title":"\u6982\u8ff0","text":"<p>\u4e00\u6b3e\u7528\u4e8e IT Help Desk \u670d\u52a1\u7684\u8f7b\u91cf PyQt5 \u684c\u9762\u5e94\u7528\uff0c\u805a\u7126\u201c\u8d26\u53f7\u8bbf\u95ee\u5f00\u901a/\u6307\u5f15/\u7edf\u8ba1\u201d\u3002\u7279\u70b9\uff1a - \u6a21\u5757\u5316\uff1a<code>app/common/utils.py</code>\uff08\u7eaf\u51fd\u6570\u4e0e\u5de5\u5177\uff09\u3001<code>app/ui/*.py</code>\uff08\u4e3b\u754c\u9762\u4e0e\u914d\u7f6e\u754c\u9762\uff09 - \u53ef\u914d\u7f6e\uff1a\u6240\u6709\u53ef\u914d\u7f6e\u9879\u96c6\u4e2d\u5728 <code>config/config.ini</code> - \u53ef\u56de\u6eaf\uff1a\u8fd0\u884c\u65e5\u5fd7 <code>logs/app.log</code> - \u53ef\u7edf\u8ba1\uff1a<code>tools/stats.py</code> \u652f\u6301\u65e5\u5fd7\u7edf\u8ba1\uff08\u6709 matplotlib \u5219\u7ed8\u56fe\uff0c\u5426\u5219\u6587\u672c\u56de\u9000\uff09 - \u53ef\u9009 Outlook \u81ea\u52a8\u5316\uff1aWindows \u73af\u5883\u4e0b\uff0c\u901a\u8fc7 <code>pywin32</code> \u8c03\u7528 COM\uff08\u53ef\u9009\uff09</p>"},{"location":"notes/brandnew-0926-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%85%8D%E7%BD%AE.html#_2","title":"\u76ee\u5f55\u7ed3\u6784","text":"<ul> <li>main.py\uff1a\u7a0b\u5e8f\u5165\u53e3</li> <li>app/</li> <li>common/utils.py\uff1a\u914d\u7f6e I/O\u3001\u65e5\u5fd7\u521d\u59cb\u5316\u3001\u6821\u9a8c\u3001OS/\u6d4f\u89c8\u5668\u8f85\u52a9</li> <li>ui/main_window.py\uff1a\u4e3b\u7a97\u4f53\uff08\u6807\u7b7e\u9875\u3001\u83dc\u5355\u3001\u53d1\u4fe1\u3001\u65f6\u949f\uff09</li> <li>ui/config_window.py\uff1a\u914d\u7f6e\u7a97\u4f53\uff08\u7f51\u7ad9/\u80cc\u666f/\u5feb\u6377\u65b9\u5f0f\uff09</li> <li>data/\uff1a\u9ed8\u8ba4\u8d44\u6e90</li> <li>config/config.ini\uff1a\u5168\u90e8\u914d\u7f6e\u9879</li> <li>logs/app.log\uff1a\u8fd0\u884c\u65e5\u5fd7</li> <li>tools/stats.py\uff1a\u65e5\u5fd7\u7edf\u8ba1</li> </ul>"},{"location":"notes/brandnew-0926-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%85%8D%E7%BD%AE.html#_3","title":"\u73af\u5883\u4e0e\u4f9d\u8d56","text":"<pre><code>Python 3.8+\nPyQt5&gt;=5.15\n# \u53ef\u9009\uff1a\nmatplotlib&gt;=3.5\uff08\u7edf\u8ba1\u56fe\u8868\uff09\npywin32&gt;=306\uff08\u4ec5 Windows\uff1bOutlook \u81ea\u52a8\u5316\uff09\n</code></pre> <p>\u5b89\u88c5\uff1a</p> <pre><code>pip install -r requirements.txt\n</code></pre>"},{"location":"notes/brandnew-0926-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%85%8D%E7%BD%AE.html#_4","title":"\u5feb\u901f\u8fd0\u884c","text":"<pre><code>python main.py\n</code></pre> <p>\u9996\u6b21\u8fd0\u884c\u540e\uff0c\u4ece\u201c\u8bbe\u7f6e(Set)\u201d\u83dc\u5355\u6253\u5f00\u914d\u7f6e\u7a97\u53e3\u5b8c\u6210\u5404\u9879\u5b9a\u5236\u3002</p>"},{"location":"notes/brandnew-0926-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%85%8D%E7%BD%AE.html#configconfigini","title":"\u6838\u5fc3\u914d\u7f6e\uff08config/config.ini\uff09","text":"<p>\u4ee5\u4e0b\u4e3a\u5f53\u524d\u9879\u76ee\u4e2d\u7684\u5173\u952e\u53c2\u6570\u4e0e\u9ed8\u8ba4\u503c\u6458\u8981\uff1a</p> <pre><code>[app]\nfont_family = Segoe UI\nfont_size = 11\nicon = Donut.ico\ntimezone_offset_hours = 8\nwindow_width = 500\nwindow_height = 467\n\n[logging]\nlog_dir = logs\nlog_file = app.log\n\n[user]\nbcc_default = [REDACTED]@[REDACTED].com\nbcc_enabled_default = True\n\n[websites]\n# \u5e38\u7528\u94fe\u63a5\uff08\u952e=\u4e2d\u6587/\u82f1\u6587\u540d\u79f0\uff0c\u503c=URL/\u672c\u5730\u76ee\u5f55\uff09\njira_\u529e\u516c\u5ba4 = https://[REDACTED].atlassian.net/issues/?filter=18992\nbetelligent_\u540e\u53f0 = https://rdai.[REDACTED].net/admin/#/admin/organization/user\nbetelligent_prod = https://rdai.[REDACTED].net/#/chat\nbetelligent_uat_\u540e\u53f0 = https://rdai-t.[REDACTED].net/admin/#/admin/organization/user\nbetelligent_uat = https://rdai-t.[REDACTED].net/#/chat\nnetskope = C:\\Users\\YourName\\OneDrive - [REDACTED]\\Plan\\03Betelligent\u8d26\u53f7\\Netskope Fix Script\nkeep_awake = C:\\Users\\YourName\\clock\\keep_awake_gui.py  # \u5feb\u901f\u4fdd\u6301\u5524\u9192\n\n[sendmail]\nshortcut_label = Netskope\u95ee\u9898\u6392\u67e5\nshortcut_cmd = C:\\Users\\YourName\\OneDrive - [REDACTED]\\Plan\\03Betelligent\u8d26\u53f7\\Netskope Fix Script\n\n[background]\nmode = color          # color / image\ncolor = #00aaff\nimage =               # \u53ef\u7559\u7a7a\nlayout = center\nbrightness = 1.00\n\n[teams]\nmessage_text = Hi, Betelligent access has been granted.\\nPlease try to visit https://rdai.[REDACTED].net/#/chat.\\nI will send the user manual to your email later.\n\n[maintenance]\nwelcome_text = hi\uff0c\u6211\u662f Betelligent \u7ba1\u7406\u5458\uff0c\u60a8\u5f53\u524d\u662f\u5426\u65e0\u6cd5\u8bbf\u95ee\uff1f\\n\u8bf7\u534f\u52a9\u6211\u67e5\u770b\u60a8\u7535\u8111\u7684 Netskope \u63d2\u4ef6\u72b6\u6001\uff0c\\n\u53f3\u952e\u5355\u51fb\u6258\u76d8\u56fe\u6807\uff0c\u786e\u8ba4\u662f\u5426\u4e3a\u201c3\u4e2a\u7eff\u706f\u201d\u3002\ndefault_image = C:/Users/YourName/brandnew 0926/Netskope Fix Script/3333.png\ntbd_text = \u8bf7\u5148\u4e0b\u8f7d\u6b64\u5de5\u5177\u5230\u684c\u9762\uff0c\u53cc\u51fb\u8fd0\u884c\uff0c\\n\u7136\u540e\u518d\u6b21\u68c0\u67e5 Netskope \u662f\u5426\u4e3a\u201c3\u4e2a\u7eff\u706f\u201d\uff0c\u4ee5\u53ca Betelligent \u662f\u5426\u53ef\u6b63\u5e38\u8bbf\u95ee\u3002\ndefault_directory = C:/Users/YourName/brandnew 0926/Netskope Fix Script\n</code></pre> <p>\u8bf4\u660e\uff1a - websites\uff1a\u652f\u6301\u540c\u65f6\u914d\u7f6e\u7f51\u9875\u4e0e\u672c\u5730\u76ee\u5f55/\u811a\u672c\u8def\u5f84\uff1bUI \u4e2d\u4f1a\u751f\u6210\u5feb\u6377\u5165\u53e3 - sendmail\uff1a\u7528\u4e8e\u201c\u95ee\u9898\u6392\u67e5\u201d\u7c7b\u4e00\u952e\u90ae\u4ef6/\u811a\u672c\u5165\u53e3 - background\uff1a\u652f\u6301\u7eaf\u8272\u4e0e\u56fe\u7247\u80cc\u666f\uff1b\u53ef\u8c03\u4eae\u5ea6\u4e0e\u5e03\u5c40 - maintenance\uff1a\u7528\u4e8e\u201c\u7ef4\u4fee/\u6392\u67e5\u201dTab \u7684\u5f15\u5bfc\u6587\u6848\u4e0e\u9ed8\u8ba4\u56fe\u7247/\u76ee\u5f55</p>"},{"location":"notes/brandnew-0926-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%85%8D%E7%BD%AE.html#_5","title":"\u4e00\u952e\u590d\u73b0\uff08\u5efa\u8bae\uff09","text":"<pre><code>cd C:\\Users\\YourName\\brandnew 0926\npython -m venv .venv\n.\\.venv\\Scripts\\Activate.ps1\npip install -r requirements.txt\npython main.py\n</code></pre>"},{"location":"notes/brandnew-0926-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%85%8D%E7%BD%AE.html#_6","title":"\u5e38\u89c1\u95ee\u9898","text":"<ul> <li>\u672a\u5b89\u88c5 matplotlib\uff1astatistics \u4ec5\u8f93\u51fa\u6587\u672c\u4e0e\u7b80\u5355 ASCII \u56fe</li> <li>\u65e0 Outlook \u684c\u9762\u7248\u6216\u672a\u5b89\u88c5 pywin32\uff1a\u53d1\u4fe1\u76f8\u5173\u529f\u80fd\u81ea\u52a8\u964d\u7ea7/\u4e0d\u53ef\u7528</li> <li>\u5b57\u4f53/\u56fe\u6807\u627e\u4e0d\u5230\uff1a\u8bf7\u786e\u8ba4 <code>app/data</code> \u4e0e\u5de5\u4f5c\u76ee\u5f55\u4e00\u81f4\uff1b\u6216\u5c06 <code>icon</code> \u6539\u4e3a\u7edd\u5bf9\u8def\u5f84</li> </ul>"},{"location":"notes/ci-cd-github-actions-to-aliyun-ecs.html","title":"\u672c\u5730\u2192GitHub\u2192\u963f\u91cc\u4e91 ECS\uff1a\u9759\u6001\u7ad9\u70b9 CI/CD \u65b9\u6848\uff08my-static-site\uff09","text":"<p>\u672c\u6587\u6574\u7406\u672c\u9879\u76ee\u91c7\u7528\u7684\u53d1\u5e03\u6280\u672f\u8def\u7ebf\uff1a\u672c\u5730\u5f00\u53d1 \u2192 \u63a8\u9001\u5230 GitHub \u2192 GitHub Actions \u901a\u8fc7 SSH \u5c06\u6e90\u7801\u4f20\u5230\u963f\u91cc\u4e91 ECS \u2192 \u5728 ECS \u4e0a\u6784\u5efa\u5e76\u4ee5 Docker \u5bb9\u5668\u65b9\u5f0f\u8fd0\u884c\uff0c\u6700\u540e\u5b8c\u6210\u81ea\u52a8\u5065\u5eb7\u68c0\u67e5\u4e0e\u4e0a\u7ebf\u3002</p>"},{"location":"notes/ci-cd-github-actions-to-aliyun-ecs.html#_1","title":"\u4e00\u3001\u67b6\u6784\u4e0e\u6d41\u7a0b","text":"<p>\u5f00\u53d1\u8005\u672c\u5730\u6539\u52a8 \u2192 git push \u2192 GitHub Actions \u89e6\u53d1 \u2192 \u6253\u5305\u6e90\u7801\u5e76\u901a\u8fc7 SSH \u4e0a\u4f20\u81f3 ECS \u2192 \u8fdc\u7aef\u89e3\u538b\u4e0e docker build \u2192 \u91cd\u542f\u5bb9\u5668\uff08-p 80:80\u3001--restart=always\uff09\u2192 \u5065\u5eb7\u68c0\u67e5 \u2192 \u5bf9\u5916\u751f\u6548\u3002</p> <pre><code>[Local Dev] --push--&gt; [GitHub Repo]\n      |               (Actions Runner)\n      |                   |\n      |                   v\n      |            package &amp; upload (SSH/SCP)\n      |                   |\n      |                   v\n      |           [Aliyun ECS /root/deploy]\n      |                 docker build/run\n      |                   |\n      +----(verify) &lt;-----+\n</code></pre>"},{"location":"notes/ci-cd-github-actions-to-aliyun-ecs.html#_2","title":"\u4e8c\u3001\u4ed3\u5e93\u7ed3\u6784\uff08\u5173\u952e\u6587\u4ef6\uff09","text":"<pre><code>my-static-site/\n\u251c\u2500 .github/workflows/deploy.yml      # \u90e8\u7f72\u5de5\u4f5c\u6d41\n\u251c\u2500 Dockerfile                        # Nginx \u9759\u6001\u7ad9\u955c\u50cf\n\u251c\u2500 index.html / index.js / *.css     # \u7ad9\u70b9\u5165\u53e3\u4e0e\u524d\u7aef\u903b\u8f91\n\u2514\u2500 posts/\n   \u251c\u2500 index.json                     # \u6587\u7ae0\u7d22\u5f15\n   \u2514\u2500 notes/...                      # Notes \u680f\u76ee\u6587\u7ae0\n</code></pre>"},{"location":"notes/ci-cd-github-actions-to-aliyun-ecs.html#_3","title":"\u4e09\u3001\u524d\u7f6e\u6761\u4ef6","text":"<ul> <li>\u4e00\u53f0\u963f\u91cc\u4e91 ECS\uff08Ubuntu 22.04+\uff09\uff0c\u5df2\u5b89\u88c5 Docker\uff0c\u5141\u8bb8 80 \u7aef\u53e3\u5bf9\u5916\u8bbf\u95ee\uff08\u5b89\u5168\u7ec4\u653e\u884c TCP/80\uff09\u3002</li> <li>GitHub \u4ed3\u5e93\uff1ayour-username/your-repo\u3002</li> <li>\u53ea\u4f7f\u7528\u516c\u94a5\u767b\u5f55\uff08\u63a8\u8350\uff09\uff1aECS \u4e0a /root/.ssh/authorized_keys \u5df2\u914d\u7f6e\u90e8\u7f72\u516c\u94a5\u3002</li> </ul>"},{"location":"notes/ci-cd-github-actions-to-aliyun-ecs.html#cicd","title":"\u56db\u3001\u751f\u6210\u201c\u90e8\u7f72\u5bc6\u94a5\u201d\uff08\u672c\u5730\uff0c\u4ec5\u4f9b CI/CD \u4f7f\u7528\uff09","text":"<ul> <li>PowerShell\uff08\u63a8\u8350\uff09\uff1a</li> </ul> <pre><code>ssh-keygen -t ed25519 -f \"$HOME/.ssh/github-actions-aliyun-ecs\" -N \"\" -C \"github-actions@example\"\n</code></pre> <ul> <li>CMD\uff1a</li> </ul> <pre><code>ssh-keygen -t ed25519 -f \"%USERPROFILE%\\.ssh\\github-actions-aliyun-ecs\" -N \"\" -C \"github-actions@example\"\n</code></pre> <p>\u5f97\u5230\uff1a - \u79c1\u94a5\uff1agithub-actions-aliyun-ecs\uff08\u7c98\u8d34\u5230 GitHub Secret\uff09 - \u516c\u94a5\uff1agithub-actions-aliyun-ecs.pub\uff08\u8ffd\u52a0\u5230 ECS \u7684 /root/.ssh/authorized_keys\uff09</p> <p>ECS \u4e0a\u6dfb\u52a0\u516c\u94a5\u793a\u4f8b\uff08\u5df2\u5b8c\u6210\u4e00\u6b21\uff09\uff1a</p> <pre><code>mkdir -p /root/.ssh &amp;&amp; chmod 700 /root/.ssh\ncat &gt;&gt; /root/.ssh/authorized_keys &lt;&lt;'EOF'\nssh-ed25519 AAAA...EXAMPLE_KEY_REDACTED github-actions@example\nEOF\nchmod 600 /root/.ssh/authorized_keys\n</code></pre>"},{"location":"notes/ci-cd-github-actions-to-aliyun-ecs.html#github-secrets-settings-secrets-and-variables-actions","title":"\u4e94\u3001GitHub Secrets\uff08\u4ed3\u5e93 \u2192 Settings \u2192 Secrets and variables \u2192 Actions\uff09","text":"<ul> <li>ECS_HOST = 203.0.113.10</li> <li>ECS_USER = root</li> <li>ECS_SSH_PRIVATE_KEY = \u90e8\u7f72\u79c1\u94a5\u5168\u6587\uff08\u5305\u542b BEGIN/END \u884c\u4e0e\u6240\u6709\u6362\u884c\uff09</li> </ul>"},{"location":"notes/ci-cd-github-actions-to-aliyun-ecs.html#deployyml","title":"\u516d\u3001\u5de5\u4f5c\u6d41 deploy.yml\uff08\u6838\u5fc3\u903b\u8f91\uff09","text":"<p>\u8981\u70b9\uff1a\u4f7f\u7528 git archive \u6253\u5305\u4ed3\u5e93\u5185\u5bb9\uff0c\u907f\u514d tar \u5728\u6253\u5305\u8fc7\u7a0b\u4e2d\u8bfb\u5230\u81ea\u8eab\u8f93\u51fa\u6587\u4ef6\u5bfc\u81f4\u7684\u62a5\u9519\uff1b\u901a\u8fc7 SSH \u628a\u538b\u7f29\u5305\u4f20\u5230 ECS \u5e76\u5728\u8fdc\u7aef\u6784\u5efa\u4e0e\u8fd0\u884c\u5bb9\u5668\u3002</p> <pre><code>name: Deploy my-static-site to Aliyun ECS\non:\n  push:\n    branches: [ main, master ]\n  workflow_dispatch:\nconcurrency:\n  group: deploy-ecs\n  cancel-in-progress: true\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - run: git archive --format=tar.gz -o site.tgz HEAD\n      - name: Setup SSH\n        env:\n          ECS_SSH_PRIVATE_KEY: ${{ secrets.ECS_SSH_PRIVATE_KEY }}\n        run: |\n          mkdir -p ~/.ssh &amp;&amp; chmod 700 ~/.ssh\n          echo \"$ECS_SSH_PRIVATE_KEY\" &gt; ~/.ssh/id_ed25519\n          chmod 600 ~/.ssh/id_ed25519\n          ssh-keyscan -H \"${{ secrets.ECS_HOST }}\" &gt;&gt; ~/.ssh/known_hosts\n      - name: Upload package to ECS\n        run: scp -i ~/.ssh/id_ed25519 site.tgz \"${{ secrets.ECS_USER }}@${{ secrets.ECS_HOST }}:/root/deploy/site.tgz\"\n      - name: Remote build and deploy on ECS\n        run: |\n          ssh -i ~/.ssh/id_ed25519 \"${{ secrets.ECS_USER }}@${{ secrets.ECS_HOST }}\" bash -s &lt;&lt;'EOF'\n          set -euo pipefail\n          cd /root/deploy\n          rm -rf site &amp;&amp; mkdir site\n          tar -xzf site.tgz -C site\n          docker rm -f static-site &gt;/dev/null 2&gt;&amp;1 || true\n          docker rm -f augment-nginx &gt;/dev/null 2&gt;&amp;1 || true\n          docker build -t static-site:latest site\n          docker run -d --name static-site --restart=always -p 80:80 static-site:latest\n          docker ps --format 'table {{.Names}}\\t{{.Image}}\\t{{.Ports}}\\t{{.Status}}' | sed -n '1,2p'\n          (curl -sS --max-time 10 http://127.0.0.1/ || wget -q -O- http://127.0.0.1/) | head -n 2 || true\n          EOF\n</code></pre>"},{"location":"notes/ci-cd-github-actions-to-aliyun-ecs.html#dockerfile","title":"\u4e03\u3001Dockerfile\uff08\u9759\u6001\u7ad9\u5bb9\u5668\uff09","text":"<pre><code>FROM nginx:alpine\nLABEL maintainer=\"augment-agent\" org.opencontainers.image.title=\"my-static-site\"\nCOPY . /usr/share/nginx/html\nHEALTHCHECK --interval=30s --timeout=3s --retries=3 CMD wget -qO- http://127.0.0.1/ &gt;/dev/null || exit 1\n</code></pre>"},{"location":"notes/ci-cd-github-actions-to-aliyun-ecs.html#githubecs","title":"\u516b\u3001\u53d1\u5e03\u6d41\u7a0b\uff08\u672c\u5730\u2192GitHub\u2192ECS\uff09","text":"<p>1) \u5728\u672c\u5730\u4ed3\u5e93 my-static-site \u4fee\u6539\u4efb\u610f\u5185\u5bb9\uff08\u4f8b\u5982\u65b0\u589e\u4e00\u7bc7 Notes \u6587\u7ae0\u6216\u4fee\u8ba2 index.json\uff09\u3002 2) \u63d0\u4ea4\u5e76\u63a8\u9001\uff1a</p> <pre><code>git add -A\ngit commit -m \"docs: update notes\"\ngit push origin main\n</code></pre> <p>3) \u6253\u5f00 GitHub \u2192 Actions \u2192 \u9009\u62e9 \u201cDeploy my-static-site to Aliyun ECS\u201d\uff0c\u67e5\u770b\u8fd0\u884c\u65e5\u5fd7\uff08\u7ea6 1\u20133 \u5206\u949f\uff09\u3002 4) \u6210\u529f\u540e\u8bbf\u95ee http://203.0.113.10/ \u6216 <code>curl -I http://203.0.113.10/</code> \u9a8c\u8bc1\u8fd4\u56de 200\u3002</p> <p>\u53ef\u9009\uff1a\u4e5f\u53ef\u4ee5\u5728 Actions \u9875\u9762\u4f7f\u7528 \u201cRun workflow\u201d\uff08workflow_dispatch\uff09\u624b\u52a8\u89e6\u53d1\u4e00\u6b21\u90e8\u7f72\u3002</p>"},{"location":"notes/ci-cd-github-actions-to-aliyun-ecs.html#_4","title":"\u4e5d\u3001\u56de\u6eda\u4e0e\u91cd\u8dd1","text":"<ul> <li>\u56de\u6eda\u5230\u4e0a\u4e00\u4e2a\u7248\u672c\uff1a</li> <li>Git \u4e0a\u5c06 HEAD \u56de\u9000\u5230\u67d0\u4e2a\u7a33\u5b9a\u63d0\u4ea4\uff1a<code>git revert &lt;commit&gt;</code> \u6216 <code>git reset --hard &lt;commit&gt; &amp;&amp; git push -f</code>\uff08\u8c28\u614e\u4f7f\u7528\uff09</li> <li>\u63a8\u9001\u540e Actions \u4f1a\u81ea\u52a8\u6309\u8be5\u5386\u53f2\u7248\u672c\u91cd\u65b0\u6784\u5efa\u5e76\u4e0a\u7ebf\u3002</li> <li>\u91cd\u8dd1\u672c\u6b21\uff1a\u5728\u5931\u8d25\u7684\u5de5\u4f5c\u6d41\u8fd0\u884c\u8be6\u60c5\u9875\u70b9\u51fb \u201cRe-run jobs\u201d\u3002</li> </ul>"},{"location":"notes/ci-cd-github-actions-to-aliyun-ecs.html#_5","title":"\u5341\u3001\u5e38\u89c1\u95ee\u9898\u4e0e\u6392\u67e5","text":"<ul> <li>tar: file changed as we read it\uff1a</li> <li>\u89e3\u51b3\uff1a\u4f7f\u7528 <code>git archive</code> \u6253\u5305\uff08\u672c\u65b9\u6848\u5df2\u91c7\u7528\uff09\u3002</li> <li>\u65e0\u6cd5\u8bbf\u95ee 80 \u7aef\u53e3\uff1a</li> <li>\u68c0\u67e5\u963f\u91cc\u4e91\u5b89\u5168\u7ec4\u3001ECS \u4e0a <code>docker ps</code> \u6620\u5c04\u662f\u5426\u6709 <code>0.0.0.0:80-&gt;80/tcp</code>\u3002</li> <li>SSH \u8fde\u63a5\u5931\u8d25\uff1a</li> <li>\u786e\u8ba4 Secrets \u4e2d\u79c1\u94a5\u5b8c\u6574\u4e14\u6743\u9650\u5728\u6b65\u9aa4\u4e2d\u5df2 600\uff1bECS authorized_keys \u6b63\u786e\uff0c\u4e14\u4ec5\u5141\u8bb8 publickey \u767b\u5f55\u3002</li> <li>\u6784\u5efa\u8d85\u65f6\uff1a</li> <li>\u67e5\u770b Dockerfile \u6784\u5efa\u8f93\u51fa\uff1b\u5fc5\u8981\u65f6\u542f\u7528\u955c\u50cf\u52a0\u901f\u6216\u5728 ECS \u4e0a\u9884\u62c9\u53d6\u57fa\u7840\u955c\u50cf\u3002</li> <li>CRLF \u8b66\u544a\uff1a</li> <li>Windows \u73af\u5883\u6b63\u5e38\u73b0\u8c61\uff0c\u4e0d\u5f71\u54cd\u90e8\u7f72\uff1b\u53ef\u5728\u4ed3\u5e93\u5c42\u9762\u7edf\u4e00 <code>* text=auto</code>\u3002</li> </ul>"},{"location":"notes/ci-cd-github-actions-to-aliyun-ecs.html#_6","title":"\u5341\u4e00\u3001\u5b89\u5168\u4e0e\u7ef4\u62a4\u5efa\u8bae","text":"<ul> <li>\u90e8\u7f72\u5bc6\u94a5\u4e0e\u4eba\u5de5\u767b\u5f55\u5bc6\u94a5\u5206\u79bb\uff08\u5df2\u5b8c\u6210\uff09\u3002</li> <li>\u4ec5\u5141\u8bb8\u516c\u94a5\u8ba4\u8bc1\uff1b\u5fc5\u8981\u65f6\u521b\u5efa\u53d7\u9650 deploy \u7528\u6237\uff0c\u9650\u5236 sudo\u3001\u9650\u5236\u53ef\u6267\u884c\u547d\u4ee4\u3002</li> <li>\u6dfb\u52a0 .dockerignore \u51cf\u5c11\u4e0a\u4e0b\u6587\uff08\u793a\u4f8b\uff09\uff1a</li> </ul> <pre><code>.git\n.github\nnode_modules\n*.log\nsite.tgz\n</code></pre> <ul> <li>\u5e76\u53d1\u63a7\u5236\uff1a<code>concurrency</code> \u5df2\u542f\u7528\uff0c\u907f\u514d\u5e76\u53d1\u90e8\u7f72\u4e92\u76f8\u8986\u76d6\u3002</li> <li>\u5065\u5eb7\u68c0\u67e5\uff1aDockerfile \u5df2\u6dfb\u52a0\uff1b\u7ebf\u4e0a\u81ea\u68c0\u5931\u8d25\u65f6\u5bb9\u5668\u4f1a\u88ab\u91cd\u542f\u3002</li> </ul>"},{"location":"notes/ci-cd-github-actions-to-aliyun-ecs.html#ecs","title":"\u5341\u4e8c\u3001\u9a8c\u8bc1\u4e0e\u8fd0\u7ef4\u5feb\u6377\u547d\u4ee4\uff08ECS\uff09","text":"<pre><code># \u67e5\u770b\u5bb9\u5668\u4e0e\u5065\u5eb7\u72b6\u6001\ndocker ps --format 'table {{.Names}}\\t{{.Image}}\\t{{.Ports}}\\t{{.Status}}' | head -n 2\n# \u67e5\u770b\u6700\u8fd1\u65e5\u5fd7\ndocker logs --tail=100 static-site\n# \u91cd\u542f\u5bb9\u5668\uff08\u5982\u9700\uff09\ndocker restart static-site\n</code></pre> <p>\u4ee5\u4e0a\u5373\u4e3a\u201c\u672c\u5730 \u2014 GitHub \u2014 \u963f\u91cc\u4e91 ECS\u201d\u9759\u6001\u7ad9\u70b9\u7684 CI/CD \u65b9\u6848\u5728\u672c\u4ed3\u5e93\u7684\u5b8c\u6574\u914d\u7f6e\u4e0e\u64cd\u4f5c\u6307\u5f15\u3002</p>"},{"location":"notes/ci-cd-smoke-test.html","title":"CI/CD \u6d4b\u8bd5\u6587\u7ae0\uff08\u81ea\u52a8\u5316\u70df\u56f1\u6d4b\u8bd5\uff09","text":"<p>\u8fd9\u662f\u7531 Augment Agent \u81ea\u52a8\u521b\u5efa\u7684\u4e00\u7bc7\u6d4b\u8bd5\u6587\u7ae0\uff0c\u7528\u4e8e\u9a8c\u8bc1\uff1a - \u63d0\u4ea4\u5230 GitHub \u540e\u662f\u5426\u89e6\u53d1 Actions - GitHub Actions \u80fd\u5426\u5c06\u7ad9\u70b9\u5305\u4e0a\u4f20\u81f3\u963f\u91cc\u4e91 ECS \u5e76\u6210\u529f\u90e8\u7f72</p> <p>\u5982\u679c\u4f60\u80fd\u5728\u9996\u9875 Notes \u5217\u8868\u770b\u5230\u8fd9\u7bc7\u6587\u7ae0\uff0c\u8bf4\u660e\u9759\u6001\u7ad9\u6784\u5efa\u5df2\u5305\u542b\u8be5\u6587\u4ef6\uff1b \u5982\u679c\u5916\u7f51\u8bbf\u95ee\u7ad9\u70b9\u4e5f\u80fd\u770b\u5230\u5e76\u6253\u5f00\u672c\u6587\uff0c\u8bf4\u660e\u90e8\u7f72\u5df2\u5b8c\u6210\u3002</p> <p>\u66f4\u65b0\u65f6\u95f4\uff1a2025-11-13</p>"},{"location":"notes/ci-tools-jenkins-gitlabci-solutions.html","title":"Jenkins \u4e0e GitLab CI\uff1a\u4f01\u4e1a\u7ea7 CI/CD \u65b9\u6848\u4e0e\u5b9e\u6218\uff08\u542b\u9879\u76ee\u793a\u4f8b\u4e0e\u547d\u4ee4\uff09","text":"<p>\u9762\u5411\u4e2d\u5c0f\u4f01\u4e1a\u7684\u4e00\u5957\u201c\u80fd\u843d\u5730\u3001\u53ef\u590d\u5236\u201d\u7684 CI/CD \u65b9\u6848\uff0c\u5bf9\u6bd4 Jenkins \u4e0e GitLab CI\uff0c\u5e76\u7ed9\u51fa\u540c\u4e00\u793a\u4f8b\u9879\u76ee\u7684\u4e24\u5957\u6d41\u6c34\u7ebf\u914d\u7f6e\u4e0e\u5b8c\u6574\u547d\u4ee4\u3002</p>"},{"location":"notes/ci-tools-jenkins-gitlabci-solutions.html#0","title":"0. \u793a\u4f8b\u9879\u76ee\u4e0e\u76ee\u6807","text":"<ul> <li>\u8bed\u8a00/\u6846\u67b6\uff1aJava 17 + Spring Boot\uff08REST API\uff09</li> <li>\u6784\u5efa\u5de5\u5177\uff1aMaven 3.9+</li> <li>\u4ea4\u4ed8\u5236\u54c1\uff1aDocker \u955c\u50cf <code>demo-api:latest</code></li> <li>\u90e8\u7f72\u76ee\u6807\uff1a\u4e00\u53f0 Linux \u670d\u52a1\u5668\uff08\u793a\u4f8b\u4ee5 <code>root@your-ecs-ip</code> \u8868\u793a\uff09</li> <li>\u76ee\u5f55\u7ed3\u6784\uff08\u6700\u5c0f\u5316\uff09\uff1a</li> </ul> <pre><code>project-root/\n  pom.xml\n  src/main/java/com/example/demo/Application.java\n  src/test/java/com/example/demo/ApplicationTests.java\n  Dockerfile\n</code></pre> <ul> <li>\u793a\u4f8b Dockerfile\uff1a</li> </ul> <pre><code>FROM eclipse-temurin:17-jre\nWORKDIR /app\nCOPY target/demo-*.jar app.jar\nEXPOSE 8080\nENTRYPOINT [\"java\",\"-jar\",\"/app/app.jar\"]\n</code></pre>"},{"location":"notes/ci-tools-jenkins-gitlabci-solutions.html#1-jenkins","title":"1. Jenkins \u65b9\u6848","text":""},{"location":"notes/ci-tools-jenkins-gitlabci-solutions.html#11-linux-docker","title":"1.1 \u5b89\u88c5\u4e0e\u51c6\u5907\uff08Linux / Docker\uff09","text":"<ul> <li>\u521b\u5efa\u7f51\u7edc\u4e0e\u542f\u52a8 Jenkins\uff08\u5177\u5907\u4f7f\u7528 Docker \u7684\u80fd\u529b\uff09\uff1a</li> </ul> <pre><code>docker network create ci-net || true\n\ndocker run -d \\\n  --name jenkins \\\n  --user root \\\n  -p 8080:8080 -p 50000:50000 \\\n  -v jenkins_home:/var/jenkins_home \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -v /usr/bin/docker:/usr/bin/docker \\\n  --restart=always \\\n  jenkins/jenkins:lts\n</code></pre> <ul> <li>\u521d\u59cb\u5bc6\u7801\uff1a</li> </ul> <pre><code>docker exec -it jenkins bash -lc 'cat /var/jenkins_home/secrets/initialAdminPassword'\n</code></pre> <ul> <li>\u5efa\u8bae\u5b89\u88c5\u63d2\u4ef6\uff1aPipeline\u3001Git\u3001Blue Ocean\u3001Credentials\u3001Docker Pipeline\u3002</li> <li>\u5168\u5c40\u5de5\u5177\uff08\u53ef\u9009\uff09\uff1a\u914d\u7f6e JDK 17\u3001Maven 3.9\uff08\u4e5f\u53ef\u5728 Pipeline \u4e2d\u7528\u5bb9\u5668\u955c\u50cf\uff09\u3002</li> </ul>"},{"location":"notes/ci-tools-jenkins-gitlabci-solutions.html#12-jenkinsfile-pipeline","title":"1.2 Jenkinsfile\uff08\u58f0\u660e\u5f0f Pipeline\uff09","text":"<ul> <li>\u5c06\u4ee5\u4e0b <code>Jenkinsfile</code> \u653e\u5728\u9879\u76ee\u6839\u76ee\u5f55\uff1a</li> </ul> <pre><code>pipeline {\n  agent {\n    docker {\n      image 'maven:3.9.9-eclipse-temurin-17'\n      args  '-v /var/run/docker.sock:/var/run/docker.sock'\n    }\n  }\n\n  environment {\n    REGISTRY   = 'registry-1.docker.io' // \u6216\u79c1\u6709\u4ed3\u5e93\n    IMAGE_NAME = 'your_dockerhub_user/demo-api'\n    ECS_HOST   = 'your-ecs-ip'\n    ECS_USER   = 'root'\n  }\n\n  stages {\n    stage('Checkout') {\n      steps { checkout scm }\n    }\n\n    stage('Build &amp; Test') {\n      steps {\n        sh 'mvn -B -DskipTests=false clean test'\n        sh 'mvn -B -DskipTests=true  package'\n      }\n      post {\n        always { junit 'target/surefire-reports/*.xml' }\n      }\n    }\n\n    stage('Docker Build') {\n      steps { sh 'docker build -t ${IMAGE_NAME}:$BUILD_NUMBER .'\n      }\n    }\n\n    stage('Docker Login &amp; Push') {\n      steps {\n        withCredentials([usernamePassword(credentialsId: 'dockerhub-creds', usernameVariable: 'DOCKER_USER', passwordVariable: 'DOCKER_PASS')]) {\n          sh 'echo $DOCKER_PASS | docker login -u $DOCKER_USER --password-stdin ${REGISTRY}'\n          sh 'docker tag ${IMAGE_NAME}:$BUILD_NUMBER ${IMAGE_NAME}:latest'\n          sh 'docker push ${IMAGE_NAME}:$BUILD_NUMBER &amp;&amp; docker push ${IMAGE_NAME}:latest'\n        }\n      }\n    }\n\n    stage('Deploy to ECS') {\n      steps {\n        sshagent(credentials: ['ecs-ssh-key']) {\n          sh '''\n            ssh -o StrictHostKeyChecking=no ${ECS_USER}@${ECS_HOST} \\\n              \"docker rm -f demo-api || true &amp;&amp; \\\n               docker pull ${IMAGE_NAME}:latest &amp;&amp; \\\n               docker run -d --name demo-api --restart=always -p 8080:8080 ${IMAGE_NAME}:latest\"\n          '''\n        }\n      }\n    }\n  }\n}\n</code></pre> <ul> <li>Jenkins \u51ed\u636e\u9700\u8981\u63d0\u524d\u521b\u5efa\uff1a</li> <li><code>dockerhub-creds</code>\uff1aDocker \u4ed3\u5e93\u7528\u6237\u540d/\u5bc6\u7801</li> <li><code>ecs-ssh-key</code>\uff1a\u5230\u76ee\u6807\u4e3b\u673a\u7684 SSH \u79c1\u94a5</li> </ul>"},{"location":"notes/ci-tools-jenkins-gitlabci-solutions.html#13","title":"1.3 \u5e38\u7528\u547d\u4ee4","text":"<pre><code># Jenkins \u5bb9\u5668\u5185\u67e5\u770b\u65e5\u5fd7\ndocker logs -f jenkins\n\n# Jenkins \u8282\u70b9\u4e0a\u6e05\u7406 Docker \u955c\u50cf/\u5bb9\u5668\uff08\u793a\u4f8b\uff09\ndocker image prune -f &amp;&amp; docker container prune -f\n</code></pre>"},{"location":"notes/ci-tools-jenkins-gitlabci-solutions.html#2-gitlab-ci","title":"2. GitLab CI \u65b9\u6848","text":""},{"location":"notes/ci-tools-jenkins-gitlabci-solutions.html#21-runnerdocker","title":"2.1 \u5b89\u88c5/\u6ce8\u518c Runner\uff08Docker \u63a8\u8350\uff09","text":"<pre><code># \u542f\u52a8 GitLab Runner\uff08Docker \u65b9\u5f0f\uff09\ndocker run -d --name gitlab-runner --restart always \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -v gitlab-runner-config:/etc/gitlab-runner \\\n  gitlab/gitlab-runner:latest\n\n# \u6ce8\u518c Runner\uff08\u66ff\u6362 URL \u4e0e\u6ce8\u518c Token\uff09\ndocker exec -it gitlab-runner gitlab-runner register \\\n  --non-interactive \\\n  --url https://gitlab.example.com/ \\\n  --registration-token REG_TOKEN \\\n  --executor docker \\\n  --docker-image maven:3.9.9-eclipse-temurin-17 \\\n  --description \"docker-runner\" \\\n  --tag-list \"docker,maven\" \\\n  --run-untagged=true \\\n  --locked=false\n</code></pre>"},{"location":"notes/ci-tools-jenkins-gitlabci-solutions.html#22-gitlab-ciyml-jenkinsfile","title":"2.2 .gitlab-ci.yml\uff08\u4e0e Jenkinsfile \u540c\u7b49\u529f\u80fd\uff09","text":"<pre><code>image: maven:3.9.9-eclipse-temurin-17\n\nservices:\n  - name: docker:dind\n    command: [\"--tls=false\"]\n\nvariables:\n  DOCKER_HOST: tcp://docker:2375\n  DOCKER_TLS_CERTDIR: \"\"\n  IMAGE_NAME: your_dockerhub_user/demo-api\n  REGISTRY: registry-1.docker.io\n\ncache:\n  key: ${CI_COMMIT_REF_SLUG}\n  paths:\n    - .m2/repository\n\nstages:\n  - build\n  - docker\n  - deploy\n\nbuild:\n  stage: build\n  script:\n    - mvn -B -DskipTests=false clean test\n    - mvn -B -DskipTests=true package\n  artifacts:\n    paths:\n      - target/*.jar\n    expire_in: 1 week\n\ndocker:\n  stage: docker\n  script:\n    - echo \"$DOCKER_PASS\" | docker login -u \"$DOCKER_USER\" --password-stdin $REGISTRY\n    - docker build -t $IMAGE_NAME:$CI_COMMIT_SHORT_SHA .\n    - docker tag  $IMAGE_NAME:$CI_COMMIT_SHORT_SHA $IMAGE_NAME:latest\n    - docker push $IMAGE_NAME:$CI_COMMIT_SHORT_SHA\n    - docker push $IMAGE_NAME:latest\n  only:\n    - main\n\ndeploy:\n  stage: deploy\n  before_script:\n    - 'which ssh || apt-get update &amp;&amp; apt-get install -y openssh-client'\n  script:\n    - |\n      ssh -o StrictHostKeyChecking=no $ECS_USER@$ECS_HOST \\\n        \"docker rm -f demo-api || true &amp;&amp; \\\n         docker pull $IMAGE_NAME:latest &amp;&amp; \\\n         docker run -d --name demo-api --restart=always -p 8080:8080 $IMAGE_NAME:latest\"\n  only:\n    - tags\n  when: manual\n</code></pre> <ul> <li>\u9879\u76ee CI/CD \u53d8\u91cf\uff1a<code>DOCKER_USER</code>\u3001<code>DOCKER_PASS</code>\u3001<code>ECS_HOST</code>\u3001<code>ECS_USER</code> \u5728 GitLab \u9879\u76ee Settings \u2192 CI/CD \u2192 Variables \u914d\u7f6e\u3002</li> </ul>"},{"location":"notes/ci-tools-jenkins-gitlabci-solutions.html#23","title":"2.3 \u5e38\u7528\u547d\u4ee4","text":"<pre><code># Runner \u65e5\u5fd7\ndocker logs -f gitlab-runner\n\n# \u624b\u5de5\u5728 Runner \u4e3b\u673a\u9a8c\u8bc1 Docker \u662f\u5426\u53ef\u7528\ndocker info &amp;&amp; docker run --rm hello-world\n</code></pre>"},{"location":"notes/ci-tools-jenkins-gitlabci-solutions.html#3","title":"3. \u65b9\u6848\u5bf9\u6bd4\u4e0e\u9009\u578b","text":"<ul> <li>Jenkins\uff1a\u9ad8\u5ea6\u53ef\u5b9a\u5236\uff0c\u63d2\u4ef6\u751f\u6001\u4e30\u5bcc\uff1b\u9700\u81ea\u8fd0\u7ef4\uff08\u5907\u4efd\u3001\u5347\u7ea7\u3001HA\uff09\u3002</li> <li>GitLab CI\uff1a\u4e0e GitLab \u4ee3\u7801\u3001Issue\u3001MR \u65e0\u7f1d\u6574\u5408\uff1bRunner \u5f39\u6027\u597d\uff1bSaaS/\u81ea\u5efa\u5747\u53ef\u3002</li> <li>\u901a\u7528\u5efa\u8bae\uff1a</li> <li>\u4ee3\u7801\u6258\u7ba1\u5728 GitLab \u2192 \u4f18\u5148 GitLab CI\uff1b</li> <li>\u9700\u8de8\u591a\u6e90\u4ee3\u7801\u5e73\u53f0\u3001\u590d\u6742\u7f16\u6392 \u2192 Jenkins\uff1b</li> <li>\u751f\u4ea7\u955c\u50cf\u7edf\u4e00\u901a\u8fc7 Docker \u6784\u5efa\uff0c\u6d41\u6c34\u7ebf\u4e2d\u5c3d\u91cf\u91c7\u7528\u5bb9\u5668\u5316\u73af\u5883\u4fdd\u8bc1\u4e00\u81f4\u6027\u3002</li> </ul>"},{"location":"notes/ci-tools-jenkins-gitlabci-solutions.html#4","title":"4. \u6545\u969c\u6392\u67e5\u901f\u67e5\u8868","text":"<ul> <li>\u51ed\u636e\u5931\u8d25\uff1a\u68c0\u67e5 Jenkins/GitLab \u53d8\u91cf\u4e0e\u6743\u9650\uff1bDocker Hub \u901f\u7387\u9650\u5236\u3002</li> <li>\u6784\u5efa\u5931\u8d25\uff1a\u4f18\u5148\u67e5\u770b <code>target/surefire-reports</code> \u4e0e\u63a7\u5236\u53f0\u65e5\u5fd7\uff1b\u786e\u8ba4 JDK/Maven \u7248\u672c\u4e00\u81f4\u3002</li> <li>Docker \u5931\u8d25\uff1a\u786e\u8ba4 Runner/Agent \u6709\u6743\u8bbf\u95ee <code>/var/run/docker.sock</code> \u6216 dind\uff1b<code>DOCKER_HOST</code> \u8bbe\u7f6e\u6b63\u786e\u3002</li> <li>\u90e8\u7f72\u5931\u8d25\uff1a\u786e\u8ba4\u76ee\u6807\u4e3b\u673a\u80fd\u8bbf\u95ee\u955c\u50cf\u4ed3\u5e93\uff1bSSH \u8fde\u901a\u3001\u78c1\u76d8\u7aef\u53e3\u5360\u7528\u3001\u65e7\u5bb9\u5668\u6e05\u7406\u3002</li> </ul>"},{"location":"notes/clock-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html","title":"clock \u590d\u73b0\u4e0e\u91cd\u6784\u65b9\u6848","text":"<p>\u66f4\u65b0\u65f6\u95f4\uff1a2025-11-11  \u4f5c\u8005\uff1aLifu</p>"},{"location":"notes/clock-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_1","title":"\u6982\u8ff0","text":"<p>clock \u662f\u4e00\u4e2a Windows \u9632\u7761\u7720\u5de5\u5177\uff0c\u63d0\u4f9b CLI \u4e0e GUI \u4e24\u79cd\u5f62\u6001\uff0c\u652f\u6301\u4e24\u79cd\u9632\u7761\u7720\u65b9\u5f0f\uff08\u6a21\u62df\u9f20\u6807/\u7cfb\u7edf API\uff09\uff0c\u96c6\u6210\u7cfb\u7edf\u6258\u76d8\u3001\u914d\u7f6e\u7ba1\u7406\u3001\u65e5\u5fd7\u8bb0\u5f55\uff0c\u5e76\u65b0\u589e\u201c\u4efb\u52a1\u680f\u81ea\u52a8\u9690\u85cf\u201d\u63a7\u5236\u3002\u672c\u6587\u7ed9\u51fa\u590d\u73b0\u4e0e\u91cd\u6784\u7684\u53ef\u64cd\u4f5c\u8def\u7ebf\u3002</p>"},{"location":"notes/clock-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#readme","title":"\u76ee\u5f55\u4e0e\u6a21\u5757\uff08\u6765\u81ea\u6e90\u7801/README\uff09","text":"<ul> <li>keep_awake_core.py\uff1a\u6838\u5fc3\u5faa\u73af\u4e0e\u9632\u7761\u7720\u65b9\u6cd5\u9009\u62e9\uff08\u5b9a\u65f6\u5668\uff09</li> <li>keep_awake_gui.py / keep_awake_cli.py\uff1aGUI/CLI \u5165\u53e3</li> <li>config_manager.py\uff1a\u914d\u7f6e\u52a0\u8f7d/\u9ed8\u8ba4\u503c/\u517c\u5bb9\u5904\u7406</li> <li>log_manager.py\uff1a\u63a7\u5236\u53f0\u4e0e\u6587\u4ef6\u65e5\u5fd7\uff08\u6eda\u52a8\uff09</li> <li>taskbar_manager.py\uff1a\u4efb\u52a1\u680f\u81ea\u52a8\u9690\u85cf\u5f00\u5173\uff08\u6ce8\u518c\u8868+\u91cd\u542f Explorer\uff09</li> <li>system_activity_checker.py / power_activity_analyzer.py\uff1a\u7cfb\u7edf/\u7535\u6e90\u6d3b\u52a8\u68c0\u6d4b</li> <li>\u542f\u52a8\u811a\u672c\uff1astart_gui.bat\u3001start_cli.bat</li> <li>\u4f9d\u8d56\uff1aPyQt6\uff08GUI\uff09</li> </ul>"},{"location":"notes/clock-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_2","title":"\u73af\u5883\u4e0e\u4f9d\u8d56","text":"<pre><code>python -m venv .venv\n.\\.venv\\Scripts\\Activate.ps1\npip install -r requirements.txt\n# requirements.txt \u6458\u8981\uff1aPyQt6&gt;=6.4.0\uff08\u53ef\u9009\uff1apyautogui\uff09\n</code></pre>"},{"location":"notes/clock-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_3","title":"\u8fd0\u884c\u4e0e\u9a8c\u8bc1","text":"<ul> <li>GUI\uff1a<code>python keep_awake_gui.py</code></li> <li>CLI\uff1a<code>python keep_awake_cli.py</code></li> <li>\u6258\u76d8\uff1a\u5173\u95ed\u7a97\u53e3\u5e94\u6700\u5c0f\u5316\u5230\u6258\u76d8\uff1b\u53cc\u51fb\u6062\u590d</li> <li>\u4efb\u52a1\u680f\u81ea\u52a8\u9690\u85cf\uff1aGUI \u52fe\u9009\u540e\u5373\u65f6\u751f\u6548\uff1b\u5982\u9700\u91cd\u542f Explorer \u4f1a\u81ea\u52a8\u5904\u7406</li> <li>\u65e5\u5fd7\uff1a\u63a7\u5236\u53f0\u7cbe\u7b80\u3001\u6587\u4ef6\u8be6\u7ec6\uff08\u6eda\u52a8\u7b56\u7565\uff09</li> </ul>"},{"location":"notes/clock-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_4","title":"\u914d\u7f6e\u8981\u70b9","text":"<ul> <li>\u9ed8\u8ba4\u503c\u5065\u58ee\uff1a\u7f3a\u5931\u5b57\u6bb5\u6309\u9ed8\u8ba4\uff1b\u65e7\u7248\u914d\u7f6e\u5411\u540e\u517c\u5bb9</li> <li>\u5173\u952e\u9879\uff1a\u9632\u7761\u7720\u95f4\u9694\u3001\u65b9\u6cd5\u9009\u62e9\uff08\u9f20\u6807/\u7cfb\u7edf API/\u4e24\u8005\uff09\u3001\u4efb\u52a1\u680f\u81ea\u52a8\u9690\u85cf\u5f00\u5173\u3001\u65e5\u5fd7\u7ea7\u522b\u4e0e\u6587\u4ef6\u5927\u5c0f\u9650\u5236</li> </ul>"},{"location":"notes/clock-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_5","title":"\u91cd\u6784/\u590d\u73b0\u8ba1\u5212\uff08\u5efa\u8bae\u91cc\u7a0b\u7891\uff09","text":"<ul> <li>M1 \u6700\u5c0f\u53ef\u7528\uff081-2 \u5929\uff09</li> <li>\u590d\u73b0\u6838\u5fc3 KeepAwake \u4e0e CLI\uff1b\u4e24\u79cd\u65b9\u6cd5\u53ef\u5207\u6362\uff1b\u65e5\u5fd7\u4e0e\u9ed8\u8ba4\u914d\u7f6e</li> <li>\u5355\u6d4b\u8986\u76d6\u6838\u5fc3\u72b6\u6001\u6d41\u8f6c\uff08start/stop/is_running\uff09</li> <li>M2 GUI \u4e0e\u6258\u76d8\uff081-3 \u5929\uff09</li> <li>GUI \u4e3b\u9762\u677f\u4e0e\u6258\u76d8\u83dc\u5355\uff1b\u72b6\u6001\u5207\u6362\u3001\u65e5\u5fd7\u67e5\u770b\u3001\u914d\u7f6e\u4fdd\u5b58/\u52a0\u8f7d</li> <li>\u5f15\u5165 taskbar_manager \u63d0\u4f9b\u81ea\u52a8\u9690\u85cf\u5f00\u5173\uff0c\u7edf\u4e00\u5f02\u5e38\u63d0\u793a\u4e0e\u65e5\u5fd7</li> <li>M3 \u5de5\u7a0b\u5316\uff081-2 \u5929\uff09</li> <li>\u65e5\u5fd7\u6eda\u52a8\u4e0e\u7b49\u7ea7\u7edf\u4e00\uff1b\u6253\u5305\u811a\u672c\uff08pyinstaller \u53ef\u9009\uff09\uff1b\u9519\u8bef\u77e9\u9635\u4e0e\u6392\u969c</li> </ul>"},{"location":"notes/clock-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_6","title":"\u9a8c\u6536\u6e05\u5355","text":"<ul> <li>\u8fde\u7eed\u8fd0\u884c 30 \u5206\u949f\u7a33\u5b9a\uff0cCPU/\u5185\u5b58\u5360\u7528\u53ef\u63a5\u53d7</li> <li>\u4e24\u79cd\u9632\u7761\u7720\u65b9\u5f0f\u5747\u751f\u6548\uff1bGUI/\u6258\u76d8\u4ea4\u4e92\u6b63\u786e</li> <li>\u4efb\u52a1\u680f\u9690\u85cf/\u6062\u590d\u6210\u529f\uff0c\u8bbe\u7f6e\u53ef\u6301\u4e45\u5316</li> <li>\u5355\u6d4b\u901a\u8fc7\uff08\u6838\u5fc3\u903b\u8f91\u3001\u914d\u7f6e\u3001\u5173\u952e\u5f02\u5e38\uff09</li> </ul>"},{"location":"notes/clock-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_7","title":"\u4e00\u952e\u590d\u73b0\uff08\u793a\u4f8b\uff09","text":"<pre><code>cd C:\\Users\\lifu.liu\\clock\npython -m venv .venv\n.\\.venv\\Scripts\\Activate.ps1\npip install -r requirements.txt\npython keep_awake_gui.py\n</code></pre>"},{"location":"notes/clock-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_8","title":"\u4f9d\u8d56\u4e0e\u7248\u672c\uff08\u7cbe\u786e\uff09","text":"<pre><code># \u9632\u7761\u7720\u5de5\u5177\u4f9d\u8d56\u5217\u8868\n\n# GUI\u754c\u9762\u4f9d\u8d56\nPyQt6&gt;=6.4.0\n\n# \u53ef\u9009\uff1a\u5982\u679c\u9700\u8981\u66f4\u597d\u7684\u9f20\u6807\u63a7\u5236\uff0c\u53ef\u4ee5\u5b89\u88c5 pyautogui\n# pyautogui&gt;=0.9.54\n\n# \u5f00\u53d1\u548c\u6d4b\u8bd5\u4f9d\u8d56\uff08\u53ef\u9009\uff09\n# pytest&gt;=7.0.0\n# pytest-qt&gt;=4.2.0\n# black&gt;=22.0.0\n# flake8&gt;=5.0.0\n</code></pre>"},{"location":"notes/clock-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#keep_awake_configjson","title":"\u914d\u7f6e\u6587\u4ef6\uff08\u5f53\u524d\u793a\u4f8b\uff1akeep_awake_config.json\uff09","text":"<pre><code>{\n  \"interval\": 10,\n  \"method\": 0,\n  \"autostart\": false,\n  \"minimize_to_tray\": true,\n  \"taskbar_autohide\": false\n}\n</code></pre> <ul> <li>\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff1a\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u7684 <code>keep_awake_config.json</code></li> <li>\u517c\u5bb9\u6027\u8bf4\u660e\uff1a<code>config_manager</code> \u4f1a\u5bf9\u4e0d\u5408\u6cd5\u7684\u5b57\u6bb5\u8fdb\u884c\u6821\u6b63\u3002\u4f8b\u5982 <code>method</code> \u4ec5\u63a5\u53d7\u5b57\u7b26\u4e32\u503c\uff1a<code>mouse</code> / <code>api</code> / <code>both</code>\u3002\u5f53\u914d\u7f6e\u4e3a\u6570\u5b57\uff08\u5982 0\uff09\u6216\u5176\u4ed6\u975e\u6cd5\u503c\u65f6\uff0c\u4f1a\u81ea\u52a8\u8c03\u6574\u4e3a <code>both</code>\u3002</li> </ul>"},{"location":"notes/clock-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_9","title":"\u53c2\u6570\u4e0e\u9ed8\u8ba4\u503c\u8bf4\u660e","text":"<ul> <li>interval\uff08\u6267\u884c\u95f4\u9694\uff0c\u79d2\uff09</li> <li>\u9ed8\u8ba4\u503c\uff1a60\uff08\u4ee3\u7801\u9ed8\u8ba4\uff09\uff0c\u6700\u5c0f 10\uff0c\u6700\u5927 3600\uff1b\u793a\u4f8b\u6587\u4ef6\u4f7f\u7528 10</li> <li>method\uff08\u9632\u7761\u7720\u65b9\u6cd5\uff09</li> <li>\u53ef\u9009\uff1a<code>mouse</code>\uff08\u79fb\u52a8\u9f20\u6807\uff09/ <code>api</code>\uff08Windows API\uff09/ <code>both</code>\uff08\u4e24\u8005\uff09</li> <li>\u9ed8\u8ba4\u503c\uff1a<code>both</code></li> <li>autostart\uff08\u5f00\u673a\u81ea\u542f\uff09\uff1a\u9ed8\u8ba4 false</li> <li>minimize_to_tray\uff08\u6700\u5c0f\u5316\u5230\u6258\u76d8\uff09\uff1a\u9ed8\u8ba4 true</li> <li>start_minimized\uff08\u542f\u52a8\u5373\u6700\u5c0f\u5316\uff09\uff1a\u9ed8\u8ba4 false\uff08\u672a\u51fa\u73b0\u5728\u793a\u4f8b\u6587\u4ef6\u4e2d\u65f6\u6309\u9ed8\u8ba4\u5904\u7406\uff09</li> <li>taskbar_autohide\uff08\u4efb\u52a1\u680f\u81ea\u52a8\u9690\u85cf\u5f00\u5173\uff09\uff1a\u9ed8\u8ba4 false</li> </ul>"},{"location":"notes/deepsite_deployment.html","title":"How to build your own DeepSite","text":"<p>Building your own DeepSite instance on Hugging Face Spaces and integrating a custom AI model like DeepSeek V3 involves several steps, from setting up the environment to configuring the model and handling API keys. Below is a step-by-step guide based on available information, including how to manage API keys or alternative methods to connect DeepSite to your AI model. Since DeepSeek V3 is a massive model (671B parameters), running it locally or on Hugging Face may require significant resources or quantization for consumer-grade hardware. I'll also address how to increase usage caps and reduce limits by hosting your own instance.</p>"},{"location":"notes/deepsite_deployment.html#step-by-step-guide-to-build-deepsite-with-a-custom-ai-model-like-deepseek-v3","title":"Step-by-Step Guide to Build DeepSite with a Custom AI Model like DeepSeek V3","text":""},{"location":"notes/deepsite_deployment.html#1-understand-deepsite-and-deepseek-v3-requirements","title":"1. Understand DeepSite and DeepSeek V3 Requirements","text":"<ul> <li>DeepSite Overview: DeepSite is an open-source platform hosted on Hugging Face Spaces (e.g., <code>enzostvs/deepsite</code>) that generates websites from text prompts using the DeepSeek V3 model. It runs in a browser, producing HTML, CSS, and JavaScript without relying on predefined templates.</li> <li>DeepSeek V3 Specs: DeepSeek V3 is a 671B-parameter Mixture-of-Experts (MoE) model, with 37B active parameters per token, optimized for coding and web development. It requires substantial hardware (e.g., 80GB*8 GPUs for BF16 inference) unless quantized. Hugging Face\u2019s Transformers library isn\u2019t directly supported yet, but alternatives like vLLM or custom inference scripts are available.</li> <li>Hosting on Hugging Face Spaces: By creating your own Space, you can customize DeepSite\u2019s code, integrate your own model, and potentially increase usage limits (depending on your Hugging Face plan). Free Spaces have resource limits (e.g., CPU/GPU quotas), but paid plans (e.g., Pro or Enterprise) offer higher caps.</li> </ul>"},{"location":"notes/deepsite_deployment.html#2-clone-or-fork-deepsite-repository","title":"2. Clone or Fork DeepSite Repository","text":"<ul> <li>Locate DeepSite Source: The official DeepSite Space is at <code>https://huggingface.co/spaces/enzostvs/deepsite</code>. The codebase is open-source, and you can find it on GitHub (e.g., <code>https://github.com/MartinsMessias/deepsite-locally</code> for local setups, though the main repo may be linked in the Space).</li> <li>Fork or Clone:</li> <li>On Hugging Face: Go to <code>enzostvs/deepsite</code>, click the three dots in the top-right corner, and select \u201cDuplicate this Space\u201d to create your own copy. This requires a Hugging Face account (free or paid).</li> <li>On GitHub: If you want to modify the code locally first, clone the repository:     <code>bash     git clone https://github.com/MartinsMessias/deepsite-locally.git</code>     Check for the official DeepSite repo in the Hugging Face Space\u2019s \u201cFiles\u201d tab if it\u2019s not the above.</li> <li>Why Fork?: Forking lets you customize the code, integrate your model, and deploy it under your own Space, giving you control over quotas and configurations.</li> </ul>"},{"location":"notes/deepsite_deployment.html#3-set-up-deepseek-v3-model","title":"3. Set Up DeepSeek V3 Model","text":"<ul> <li>Download DeepSeek V3:</li> <li>DeepSeek V3 is available on Hugging Face at <code>deepseek-ai/DeepSeek-V3</code>. The model weights total 685B (671B main + 14B Multi-Token Prediction module).</li> <li>Clone the DeepSeek V3 repository for setup instructions:     <code>bash     git clone https://github.com/deepseek-ai/DeepSeek-V3.git</code></li> <li>Install dependencies:     <code>bash     cd DeepSeek-V3/inference     pip install -r requirements.txt</code></li> <li>Download model weights from Hugging Face (<code>deepseek-ai/DeepSeek-V3</code>) and place them in <code>/path/to/DeepSeek-V3</code>. This requires ~685GB of disk space.</li> <li>Quantize for Consumer Hardware (Optional):</li> <li>DeepSeek V3 is resource-intensive. For systems with limited hardware (e.g., &lt;48GB RAM), use quantized versions (2-bit to 8-bit) available via Unsloth or other tools. Minimum requirements for 2-bit quantization are 48GB RAM and 250GB disk space.</li> <li>Example quantization setup (using Unsloth):     <code>bash     pip install unsloth     # Follow Unsloth\u2019s guide to quantize DeepSeek-V3 to 4-bit or 2-bit</code>     See Unsloth\u2019s documentation for details: <code>https://github.com/unslothai/unsloth</code>.</li> <li>Convert Weights (Optional):</li> <li>DeepSeek V3 uses FP8 weights by default. For BF16 (better for some hardware), convert using the provided script:     <code>bash     cd DeepSeek-V3/inference     python fp8_cast_bf16.py --input-fp8-hf-path /path/to/fp8_weights --output-bf16-hf-path /path/to/bf16_weights</code> </li> <li>Local Testing:</li> <li>Test DeepSeek V3 locally using the provided inference script:     <code>bash     torchrun --nnodes 1 --nproc-per-node 8 generate.py --ckpt-path /path/to/DeepSeek-V3 --config configs/config_671B.json --interactive --temperature 0.7 --max-new-tokens 200</code>     Adjust <code>--nnodes</code> and <code>--nproc-per-node</code> based on your hardware.</li> </ul>"},{"location":"notes/deepsite_deployment.html#4-configure-deepsite-to-use-your-deepseek-v3-model","title":"4. Configure DeepSite to Use Your DeepSeek V3 Model","text":"<ul> <li>Modify DeepSite\u2019s Backend:</li> <li>DeepSite\u2019s default setup uses DeepSeek V3-0324 via a remote API or hosted model. To use your own model, you need to modify the backend to point to your local or hosted DeepSeek V3 instance.</li> <li>Open DeepSite\u2019s source code (in your cloned repo or Space\u2019s <code>Files</code> tab). Look for files handling model inference (likely in Python, e.g., <code>app.py</code> or <code>main.py</code>).</li> <li>Replace the default model call with your DeepSeek V3 instance. For example, if using vLLM for inference:     <code>python     from vllm import LLM, SamplingParams     model_name = \"/path/to/DeepSeek-V3\"  # Local path or Hugging Face model ID     tokenizer = AutoTokenizer.from_pretrained(model_name)     llm = LLM(model=model_name, tensor_parallel_size=8, max_model_len=8192, trust_remote_code=True)     sampling_params = SamplingParams(temperature=0.3, max_tokens=256, stop_token_ids=[tokenizer.eos_token_id])</code>     This code loads your local DeepSeek V3 model. Adjust <code>tensor_parallel_size</code> and <code>max_model_len</code> based on your hardware.</li> <li>Local Model Integration:</li> <li>If running DeepSeek V3 locally, ensure DeepSite\u2019s backend can access the model via a local server. Use tools like Ollama or LM Studio to host DeepSeek V3 locally and expose it via an API endpoint.</li> <li>Example with Ollama:<ul> <li>Install Ollama: <code>curl https://ollama.ai/install.sh | sh</code></li> <li>Load DeepSeek V3 (quantized): <code>ollama run deepseek-v3</code></li> <li>Update DeepSite\u2019s code to query <code>http://localhost:11434/api/generate</code> for model responses.</li> </ul> </li> <li>Hosted Model on Hugging Face:</li> <li>If hosting DeepSeek V3 on your own Hugging Face Space, upload the model weights to a private or public repository (e.g., <code>your-username/DeepSeek-V3-Custom</code>).</li> <li>Configure DeepSite to load the model from this repository using Hugging Face\u2019s API or vLLM.</li> </ul>"},{"location":"notes/deepsite_deployment.html#5-configure-api-key-or-alternative-connection-method","title":"5. Configure API Key or Alternative Connection Method","text":"<ul> <li>Using DeepSeek API (Optional):</li> <li>DeepSeek offers an API for V3, which can be used instead of local hosting to reduce resource demands. Visit <code>https://x.ai/api</code> for API access details (note: xAI\u2019s API page is referenced, but DeepSeek\u2019s official API is at <code>https://platform.deepseek.com/docs/api</code>).</li> <li>Sign up for an API key at <code>https://platform.deepseek.com</code>.</li> <li>In DeepSite\u2019s code, configure the API client to use your key. Example:     <code>python     import requests     API_KEY = \"your-deepseek-api-key\"     headers = {\"Authorization\": f\"Bearer {API_KEY}\"}     response = requests.post(\"https://api.deepseek.com/v3/generate\", json={\"prompt\": \"your prompt\"}, headers=headers)</code>     Add this logic to DeepSite\u2019s model inference function.</li> <li>Store the API key securely in a <code>.env</code> file:     <code>bash     # In DeepSite folder, create .env     DEEPSEEK_API_KEY=your-deepseek-api-key</code>     Load it in Python:     <code>python     from dotenv import load_dotenv     import os     load_dotenv()     API_KEY = os.getenv(\"DEEPSEEK_API_KEY\")</code></li> <li>Hugging Face Inference API:</li> <li>If hosting DeepSeek V3 on a Hugging Face Space, generate a Hugging Face token with inference permissions:<ul> <li>Go to <code>https://huggingface.co/settings/tokens/new?ownUserPermissions=repo.content.read&amp;ownUserPermissions=repo.write&amp;ownUserPermissions=inference.serverless.edit</code>.</li> <li>Create a fine-grained token and copy it.</li> <li>Store it in DeepSite\u2019s <code>.env</code> file:   <code>bash   HUGGINGFACE_TOKEN=your-hf-token</code></li> <li>Update DeepSite\u2019s code to use the Hugging Face Inference API:   <code>python   from huggingface_hub import InferenceClient   client = InferenceClient(token=os.getenv(\"HUGGINGFACE_TOKEN\"))   output = client.text_generation(\"your prompt\", model=\"your-username/DeepSeek-V3-Custom\")</code> </li> </ul> </li> <li>Local Model (No API Key):</li> <li>If running DeepSeek V3 locally via vLLM or Ollama, no API key is needed. DeepSite communicates directly with the local server (e.g., <code>http://localhost:8000</code> for vLLM). Update the backend to point to this endpoint.</li> </ul>"},{"location":"notes/deepsite_deployment.html#6-deploy-your-custom-deepsite-on-hugging-face-spaces","title":"6. Deploy Your Custom DeepSite on Hugging Face Spaces","text":"<ul> <li>Create a New Space:</li> <li>Go to <code>https://huggingface.co/spaces</code> and click \u201cCreate new Space.\u201d</li> <li>Choose a name (e.g., <code>your-username/MyDeepSite</code>).</li> <li>Select \u201cDocker\u201d or \u201cPython\u201d as the Space type (Docker is recommended for complex setups).</li> <li>Upload Modified Code:</li> <li>Push your modified DeepSite code to the Space\u2019s repository:     <code>bash     cd deepsite-locally     git add .     git commit -m \"Custom DeepSite with DeepSeek V3\"     git push origin main</code></li> <li>Alternatively, upload files directly via the Hugging Face Space\u2019s web interface.</li> <li>Configure Space Settings:</li> <li>In the Space\u2019s \u201cSettings\u201d tab, add environment variables for API keys:<ul> <li><code>DEEPSEEK_API_KEY=your-deepseek-api-key</code></li> <li><code>HUGGINGFACE_TOKEN=your-hf-token</code></li> </ul> </li> <li>If using a local model, ensure the Space has enough GPU resources (upgrade to a paid plan if needed).</li> <li>Build and Run:</li> <li>Hugging Face will automatically build and deploy your Space. Monitor the build logs for errors.</li> <li>Once running, access your DeepSite at <code>https://huggingface.co/spaces/your-username/MyDeepSite</code>.</li> </ul>"},{"location":"notes/deepsite_deployment.html#7-increase-caps-and-reduce-limits","title":"7. Increase Caps and Reduce Limits","text":"<ul> <li>Hugging Face Free Tier Limitations:</li> <li>Free Spaces have limited CPU/GPU hours and storage. DeepSeek V3\u2019s size (685GB) may exceed free tier limits, and inference is slow without GPUs.</li> <li>Upgrade to Paid Plan:</li> <li>Hugging Face Pro ($9/month) or Enterprise plans offer higher quotas, persistent storage, and GPU access (e.g., A100 or H100). Check <code>https://huggingface.co/pricing</code> for details.</li> <li>Paid plans allow longer runtime, more concurrent users, and faster inference, reducing limits compared to the public <code>enzostvs/deepsite</code> Space.</li> <li>Local Hosting Alternative:</li> <li>To avoid cloud limits entirely, host DeepSite and DeepSeek V3 on your own server:<ul> <li>Use Docker for easy setup:   <code>bash   docker pull martinsmessias/deepsite-locally   docker run -p 8000:8000 -v /path/to/DeepSeek-V3:/models martinsmessias/deepsite-locally</code></li> <li>Ensure your server has sufficient RAM (48GB+ for quantized models) and GPUs (e.g., 80GB*8 for full model).</li> </ul> </li> <li>Access DeepSite at <code>http://localhost:8000</code> or your server\u2019s IP.</li> <li>Optimize Model Usage:</li> <li>Use quantized models (e.g., 4-bit) to reduce memory needs.</li> <li>Implement batch processing in DeepSite\u2019s backend to handle multiple prompts efficiently, reducing API or inference calls.</li> </ul>"},{"location":"notes/deepsite_deployment.html#8-test-and-refine","title":"8. Test and Refine","text":"<ul> <li>Test Your DeepSite:</li> <li>Open your Space or local instance and enter a prompt (e.g., \u201cCreate a portfolio website with a dark theme\u201d).</li> <li>Verify the generated HTML, CSS, and JavaScript in the preview panel.</li> <li>Check for errors in model responses or rendering.</li> <li>Refine Prompts:</li> <li>DeepSeek V3 performs best with clear, detailed prompts. Example: \u201cGenerate a responsive e-commerce website with TailwindCSS, a sticky navbar, and product cards.\u201d</li> <li>Debug Issues:</li> <li>If the model fails to load, check memory usage and quantization settings.</li> <li>If API calls fail, verify your API key and endpoint configuration.</li> <li>Consult DeepSite\u2019s GitHub issues or DeepSeek\u2019s support (<code>service@deepseek.com</code>).</li> </ul>"},{"location":"notes/deepsite_deployment.html#where-to-configure-api-key-or-connect-deepsite-to-ai-model","title":"Where to Configure API Key or Connect DeepSite to AI Model","text":"<ul> <li>API Key Configuration:</li> <li>DeepSeek API: Store in <code>.env</code> as <code>DEEPSEEK_API_KEY</code> and load in DeepSite\u2019s backend code (see Step 5). Alternatively, set in Hugging Face Space\u2019s \u201cSettings\u201d &gt; \u201cEnvironment Variables.\u201d</li> <li>Hugging Face Inference API: Store in <code>.env</code> as <code>HUGGINGFACE_TOKEN</code> or set in Space settings.</li> <li>Local Model Connection:</li> <li>No API key is needed. Modify DeepSite\u2019s backend to query your local server (e.g., <code>http://localhost:8000</code> for vLLM or <code>http://localhost:11434</code> for Ollama). Update the model endpoint in the inference function (e.g., <code>app.py</code>).</li> <li>Hosted Model on Hugging Face:</li> <li>Upload DeepSeek V3 to your repository (<code>your-username/DeepSeek-V3-Custom</code>).</li> <li>Configure DeepSite to load the model using Hugging Face\u2019s InferenceClient or vLLM, authenticated with your Hugging Face token.</li> </ul>"},{"location":"notes/deepsite_deployment.html#additional-tips","title":"Additional Tips","text":"<ul> <li>Community Resources:</li> <li>Join Hugging Face\u2019s Discord or DeepSite\u2019s GitHub discussions for support.</li> <li>Check X posts for user tips (e.g., <code>@Thom_Wolf</code> announced DeepSite\u2019s capabilities).</li> <li>Performance Optimization:</li> <li>Use DeepSeek V3\u2019s Multi-Token Prediction (MTP) for faster inference if supported by your setup.</li> <li>Set temperature to 0.3\u20130.6 for coherent outputs (recommended by DeepSeek).</li> <li>Scaling Up:</li> <li>If you hit usage caps, consider DeepSeek\u2019s enterprise API or hosting on AWS/GCP with high-end GPUs (e.g., NVIDIA H100).</li> <li>Backup Code:</li> <li>Regularly save generated code, as DeepSite doesn\u2019t autosave. Export via the \u201cDownload\u201d button or copy from the editor.</li> </ul>"},{"location":"notes/deepsite_deployment.html#summary","title":"Summary","text":"<p>To build your own DeepSite on Hugging Face with DeepSeek V3: 1. Fork <code>enzostvs/deepsite</code> or clone its GitHub repo. 2. Set up DeepSeek V3 locally (quantized for lower resources) or host it on Hugging Face. 3. Modify DeepSite\u2019s backend to use your model (local, API, or Hugging Face-hosted). 4. Configure API keys in <code>.env</code> or Space settings for DeepSeek/Hugging Face APIs, or use local endpoints for direct model access. 5. Deploy to a new Hugging Face Space and upgrade to a paid plan for higher caps. 6. Test and refine your setup for optimal performance.</p> <p>For detailed pricing on Hugging Face plans, visit <code>https://huggingface.co/pricing</code>. For DeepSeek API details, see <code>https://platform.deepseek.com/docs/api</code>. If you need help with specific code changes or hardware setup, let me know</p>"},{"location":"notes/fengbi-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html","title":"fengbi PDF \u5de5\u5177\u5957\u4ef6\uff1a\u62bd\u53d6/\u6e05\u6d17/\u5206\u5272/\u504f\u79fb \u590d\u73b0\u4e0e\u91cd\u6784\u65b9\u6848","text":"<p>\u66f4\u65b0\u65f6\u95f4\uff1a2025-11-11  \u4f5c\u8005\uff1aLifu</p>"},{"location":"notes/fengbi-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_1","title":"\u6982\u8ff0","text":"<p>fengbi \u662f\u4e00\u7ec4\u9762\u5411 PDF \u76ee\u5f55\u62bd\u53d6\u4e0e\u6587\u6863\u5206\u5272\u7684\u5b9e\u7528\u811a\u672c\u96c6\u5408\uff0c\u6765\u6e90\u4e8e\u300a\u4e2d\u56fd\u836f\u5178\u300b\u7b49\u5927\u4f53\u91cf PDF \u7684\u5de5\u7a0b\u5b9e\u8df5\uff0c\u8986\u76d6\uff1a - \u76ee\u5f55\u62bd\u53d6\u4e0e\u6e05\u6d17\uff1a\u4ece PDF \u751f\u6210\u76ee\u5f55 JSON\uff0c\u6e05\u6d17/\u53bb\u91cd\uff0c\u5408\u5e76\u4e3a\u5168\u91cf combined_catalog.json - \u9a71\u52a8\u76ee\u5f55\u7684\u6279\u91cf\u5206\u5272\uff1a\u6309\u76ee\u5f55\u6807\u9898\u2192\u9875\u7801\u533a\u95f4\u62c6\u5206\u6574\u672c PDF - \u504f\u79fb\u5206\u5272\uff1a\u5f53\u201c\u76ee\u5f55\u9875\u7801\u201d\u548c\u201cPDF \u5b9e\u9645\u9875\u7801\u201d\u5b58\u5728\u504f\u79fb\u65f6\uff0c\u6309\u90e8\u8bbe\u7f6e offset \u540e\u518d\u5206\u5272 - \u4e09\u90e8\u4e13\u7528\u62c6\u5206\uff1a\u5bf9\u5df2\u505a\u8fc7\u9875\u7801\u6821\u51c6\u7684\u201c\u4e09\u90e8\u201dPDF\uff0c\u76f4\u63a5\u6309\u76ee\u5f55\u6587\u672c\u65e0\u504f\u79fb\u62c6\u5206 - GUI\uff1a\u63d0\u4f9b\u7b80\u5355 GUI \u5206\u5272\u5668\uff08tkinter\uff09</p>"},{"location":"notes/fengbi-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_2","title":"\u76ee\u5f55\u4e0e\u7ec4\u4ef6","text":"<ul> <li>pdf_content_extractor.py\uff1a\u76ee\u5f55\u6587\u5b57\u62bd\u53d6\uff0c\u751f\u6210 catalog_results.json</li> <li>pdf_catalog_cleaner.py\uff1a\u76ee\u5f55\u6e05\u6d17/\u53bb\u91cd/\u5408\u5e76\uff0c\u751f\u6210 cleaned_catalog.json\u3001combined_catalog.json</li> <li>catalog_viewer.py\uff1a\u67e5\u770b/\u641c\u7d22/\u7edf\u8ba1/\u5bfc\u51fa\u76ee\u5f55\u6570\u636e</li> <li>pdf_catalog_splitter.py\uff1a\u6309 cleaned_catalog.json \u6279\u91cf\u5206\u5272</li> <li>pdf_catalog_splitter_with_offset.py\uff1a\u6309 pianyi.txt \u504f\u79fb\u5206\u5272</li> <li>pdf_sanbu_splitter.py\uff1a\u4e09\u90e8\u4e13\u7528\u5206\u5272\uff08\u65e0\u504f\u79fb\uff0c\u4f7f\u7528 yaodian/\u4e09\u90e8\u76ee\u5f55.txt\uff09</li> <li>pdf_splitter_cli.py\uff1a\u901a\u7528 PDF \u6309\u9875\u533a\u95f4\u5206\u5272\u7684 CLI</li> <li>pdf_splitter_gui.py\uff1a\u901a\u7528 PDF \u5206\u5272 GUI</li> <li>\u5176\u5b83\uff1abulk_mtime_set.py\uff08\u6279\u91cf\u7edf\u4e00 mtime\uff09</li> </ul>"},{"location":"notes/fengbi-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#cpu","title":"\u73af\u5883\u4e0e\u4f9d\u8d56\uff08CPU\uff09","text":"<pre><code>Python 3.8+\nPyPDF2&gt;=3.0.0\n# GUI \u9700 tkinter\uff08\u5927\u591a\u6570\u5b98\u65b9 Python \u81ea\u5e26\uff09\n</code></pre> <p>\u5b89\u88c5\uff1a</p> <pre><code>pip install -r requirements.txt\n# \u6216\uff1apip install PyPDF2\n</code></pre>"},{"location":"notes/fengbi-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_3","title":"\u5feb\u901f\u4f7f\u7528","text":"<ul> <li>\u76ee\u5f55\u62bd\u53d6/\u6e05\u6d17/\u67e5\u770b</li> <li><code>python pdf_content_extractor.py</code></li> <li><code>python pdf_catalog_cleaner.py</code></li> <li><code>python catalog_viewer.py stats | list | search \u5173\u952e\u8bcd | export</code></li> <li>\u76ee\u5f55\u9a71\u52a8\u5206\u5272\uff08\u65e0\u504f\u79fb\uff09</li> <li><code>python pdf_catalog_splitter.py</code></li> <li>\u76ee\u5f55\u9a71\u52a8\u5206\u5272\uff08\u6709\u504f\u79fb\uff0c\u8bfb\u53d6 pianyi.txt\uff09</li> <li><code>python pdf_catalog_splitter_with_offset.py</code></li> <li>\u4e09\u90e8\u4e13\u7528\u5206\u5272\uff08\u5df2\u6253\u5305\u597d\u9875\u7801\u7684 PDF\uff09</li> <li><code>python pdf_sanbu_splitter.py</code></li> <li>\u901a\u7528 CLI \u5206\u5272\uff08\u6309\u533a\u95f4\uff09</li> <li><code>python pdf_splitter_cli.py input.pdf -r \"1-5,6-10,15-20\" -o output_folder</code></li> <li>GUI \u5206\u5272</li> <li><code>python pdf_splitter_gui.py</code>\uff08\u6216 <code>pythonw.exe pdf_splitter_gui.py</code>\uff09</li> </ul>"},{"location":"notes/fengbi-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_4","title":"\u6570\u636e\u4e0e\u914d\u7f6e","text":"<ul> <li>yaodian/\u4e09\u90e8\u76ee\u5f55.txt\uff08\u5e26\u8868\u5934\uff0c\u5236\u8868\u7b26\u5206\u9694\uff09</li> <li>\u5f62\u5982\uff1a<code>\u5e8f\u53f7\\t\u6807\u9898\\t\u9875\u7801</code>\uff0c\u5982 <code>14\\t\u67d0\u6807\u9898\\t57</code></li> <li>pianyi.txt\uff08\u6bcf\u884c\u201c\u90e8\u540d\uff1a\u504f\u79fb\u201d\uff09</li> <li>\u793a\u4f8b\uff1a<ul> <li><code>\u4e2d\u56fd\u836f\u5178\u4e00\u90e8\uff1a21</code></li> <li><code>\u4e2d\u56fd\u836f\u5178\u4e8c\u90e8\uff1a2</code></li> </ul> </li> <li>\u8f93\u51fa\u4e0e\u4e2d\u95f4\u6587\u4ef6</li> <li>\u76ee\u5f55 JSON\uff1acatalog_results.json\u3001cleaned_catalog.json\u3001combined_catalog.json</li> <li>\u5206\u5272\u7ed3\u679c\uff1asplit_output_test/\u3001split_sanbu_output/\u3001split_sanbu_output_correct/</li> </ul>"},{"location":"notes/fengbi-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_5","title":"\u4e00\u952e\u590d\u73b0\uff08\u793a\u4f8b\uff09","text":"<pre><code>cd C:\\Users\\lifu.liu\\OneDrive - [REDACTED]\\PortableSoftwareDir\\fengbi\npython -m venv .venv\n.\\.venv\\Scripts\\Activate.ps1\npip install -r requirements.txt\n# \u76ee\u5f55\u2192\u6e05\u6d17\u2192\u67e5\u770b\npython pdf_content_extractor.py\npython pdf_catalog_cleaner.py\npython catalog_viewer.py stats\n# \u6309\u76ee\u5f55\u5206\u5272\uff08\u65e0\u504f\u79fb\uff09\npython pdf_catalog_splitter.py\n</code></pre>"},{"location":"notes/fengbi-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_6","title":"\u91cd\u6784\u5efa\u8bae\uff08\u53ef\u9009\uff09","text":"<ul> <li>\u7edf\u4e00\u547d\u4ee4\u884c\u5165\u53e3\uff08typer/click\uff09\uff1aextract/clean/split/sanbu/offset/test</li> <li>\u914d\u7f6e\u6a21\u578b\u5316\uff08pydantic/dataclasses\uff09\uff0c\u652f\u6301 YAML/JSON \u914d\u7f6e\u6587\u4ef6</li> <li>\u7edf\u4e00\u65e5\u5fd7\uff08logging + \u6587\u4ef6/\u63a7\u5236\u53f0\u53cc\u901a\u9053\uff09\u4e0e\u7f16\u7801\uff08UTF-8\uff09</li> <li>\u9488\u5bf9\u5927 PDF \u7684\u6d41\u5f0f\u5904\u7406/\u5e76\u884c\u7b56\u7565\uff1b\u5fc5\u8981\u65f6\u5f15\u5165 PyMuPDF \u4ee5\u52a0\u901f</li> <li>\u5355\u5143\u6d4b\u8bd5\uff1a\u76ee\u5f55\u89e3\u6790/\u9875\u7801\u8ba1\u7b97/\u504f\u79fb\u5e94\u7528/\u6587\u4ef6\u547d\u540d\u89c4\u5219</li> </ul>"},{"location":"notes/gradle-usage-guide.html","title":"Gradle \u4f7f\u7528\u65b9\u6848\uff1a\u4ece\u5165\u95e8\u5230\u5b9e\u8df5\uff08\u542b\u9879\u76ee\u4e0e\u547d\u4ee4\uff09","text":"<p>\u76ee\u6807\uff1a\u7ed9\u51fa\u4e00\u5957\u53ef\u5728\u672c\u5730/CI \u76f4\u63a5\u4e0a\u624b\u7684 Gradle \u5b9e\u8df5\u65b9\u6848\uff0c\u8986\u76d6\u521d\u59cb\u5316\u3001\u6784\u5efa\u3001\u6d4b\u8bd5\u3001\u591a\u6a21\u5757\u4e0e CI \u96c6\u6210\u3002</p>"},{"location":"notes/gradle-usage-guide.html#1","title":"1. \u73af\u5883\u4e0e\u5b89\u88c5","text":"<ul> <li>\u5efa\u8bae\uff1aJDK 17\uff0cGradle 8.10+</li> <li>\u63a8\u8350\u4f7f\u7528 Gradle Wrapper\uff08gradlew\uff09\u786e\u4fdd CI \u4e0e\u672c\u5730\u7248\u672c\u4e00\u81f4\u3002</li> </ul> <p>\u5b89\u88c5\u4e0e\u68c0\u67e5\uff08Linux/macOS \u4e3e\u4f8b\uff09\uff1a</p> <pre><code># \u82e5\u4f7f\u7528 SDKMAN!\ncurl -s https://get.sdkman.io | bash\nsdk install java 17.0.10-tem\nsdk install gradle 8.10\n\n# \u4e5f\u53ef\u76f4\u63a5\u4e0b\u8f7d zip\uff1b\u9879\u76ee\u5185\u4f18\u5148\u4f7f\u7528 wrapper\njava -version &amp;&amp; gradle -v\n</code></pre> <p>Windows \u5efa\u8bae\u901a\u8fc7 Winget/Zip\uff0c\u5e76\u5728\u9879\u76ee\u4e2d\u4f7f\u7528 wrapper\u3002</p>"},{"location":"notes/gradle-usage-guide.html#2-java","title":"2. \u521d\u59cb\u5316\u4e00\u4e2a Java \u5e94\u7528","text":"<p>\u5728\u7a7a\u76ee\u5f55\u6267\u884c\uff1a</p> <pre><code>gradle init --type java-application --dsl kotlin --test-framework junit-jupiter \\\n  --project-name demo --package com.example\n</code></pre> <p>\u6838\u5fc3\u7ed3\u6784\uff1a</p> <pre><code>demo/\n  build.gradle.kts\n  settings.gradle.kts\n  gradle/wrapper/\n  gradlew  gradlew.bat\n  src/main/java/com/example/App.java\n  src/test/java/com/example/AppTest.java\n</code></pre>"},{"location":"notes/gradle-usage-guide.html#3-buildgradlekts","title":"3. \u5173\u952e\u6784\u5efa\u811a\u672c\uff08build.gradle.kts\uff09","text":"<p>\u4e0b\u9762\u662f\u4e00\u4e2a\u6700\u5c0f\u53ef\u7528\u3001\u542b\u6d4b\u8bd5\u4e0e\u5e94\u7528\u63d2\u4ef6\u7684\u793a\u4f8b\uff1a</p> <pre><code>plugins {\n  application\n  java\n}\n\ngroup = \"com.example\"\nversion = \"1.0.0\"\n\njava {\n  toolchain { languageVersion.set(JavaLanguageVersion.of(17)) }\n}\n\nrepositories { mavenCentral() }\n\ndependencies {\n  testImplementation(platform(\"org.junit:junit-bom:5.10.3\"))\n  testImplementation(\"org.junit.jupiter:junit-jupiter\")\n}\n\ntasks.test {\n  useJUnitPlatform()\n  testLogging { events(\"PASSED\", \"FAILED\", \"SKIPPED\") }\n}\n\napplication {\n  mainClass.set(\"com.example.App\")\n}\n</code></pre> <p>\u5e38\u7528\u547d\u4ee4\uff1a</p> <pre><code>./gradlew clean test build     # \u6e05\u7406\u3001\u6d4b\u8bd5\u3001\u6784\u5efa\n./gradlew run                  # \u8fd0\u884c\u5e94\u7528\uff08application \u63d2\u4ef6\uff09\n./gradlew tasks                # \u67e5\u770b\u53ef\u7528\u4efb\u52a1\n</code></pre>"},{"location":"notes/gradle-usage-guide.html#4","title":"4. \u4f9d\u8d56\u7ba1\u7406\u4e0e\u7248\u672c\u5bf9\u9f50","text":"<ul> <li>\u4f7f\u7528 BOM\uff1a\u7edf\u4e00\u6d4b\u8bd5\u6216 Spring \u4f9d\u8d56\u7248\u672c</li> </ul> <pre><code>dependencies {\n  implementation(platform(\"org.springframework.boot:spring-boot-dependencies:3.3.5\"))\n  implementation(\"org.springframework.boot:spring-boot-starter-web\")\n  testImplementation(\"org.springframework.boot:spring-boot-starter-test\")\n}\n</code></pre> <ul> <li>\u9501\u5b9a Java \u5de5\u5177\u94fe\u907f\u514d\u201c\u6211\u673a\u5668\u884c\u3001CI \u4e0d\u884c\u201d\u3002</li> </ul>"},{"location":"notes/gradle-usage-guide.html#5-multi-project","title":"5. \u591a\u6a21\u5757\uff08Multi-Project\uff09","text":"<p>\u76ee\u5f55\uff1a</p> <pre><code>root/\n  settings.gradle.kts\n  build.gradle.kts       # \u7236\u7ea7\u516c\u5171\u914d\u7f6e\n  app/                   # \u5e94\u7528\u6a21\u5757\n    build.gradle.kts\n  lib/                   # \u5e93\u6a21\u5757\n    build.gradle.kts\n</code></pre> <p>settings.gradle.kts\uff1a</p> <pre><code>rootProject.name = \"demo\"\ninclude(\":app\", \":lib\")\n</code></pre> <p>\u7236\u7ea7 build.gradle.kts\uff08\u516c\u5171\u7ea6\u5b9a\uff09\uff1a</p> <pre><code>plugins { java }\n\nsubprojects {\n  apply(plugin = \"java\")\n  group = \"com.example\"\n  version = \"1.0.0\"\n\n  repositories { mavenCentral() }\n  java { toolchain { languageVersion.set(JavaLanguageVersion.of(17)) } }\n\n  tasks.test { useJUnitPlatform() }\n}\n</code></pre> <p>\u6a21\u5757 lib/build.gradle.kts\uff1a</p> <pre><code>dependencies {\n  // \u4ec5\u793a\u4f8b\uff1a\u65e0\u7b2c\u4e09\u65b9\u4f9d\u8d56\n}\n</code></pre> <p>\u6a21\u5757 app/build.gradle.kts\uff1a</p> <pre><code>plugins { application }\n\ndependencies {\n  implementation(project(\":lib\"))\n}\n\napplication { mainClass.set(\"com.example.App\") }\n</code></pre> <p>\u6784\u5efa\u4e0e\u8fd0\u884c\uff1a</p> <pre><code>./gradlew :lib:build\n./gradlew :app:run\n</code></pre>"},{"location":"notes/gradle-usage-guide.html#6","title":"6. \u5e38\u89c1\u589e\u5f3a\uff1a\u4ee3\u7801\u8d28\u91cf\u4e0e\u8986\u76d6\u7387","text":"<ul> <li>Spotless\uff08\u683c\u5f0f\u5316\uff09\u3001Checkstyle/PMD\uff08\u9759\u6001\u68c0\u67e5\uff09\u3001Jacoco\uff08\u8986\u76d6\u7387\uff09 \u4ee5 Jacoco \u4e3a\u4f8b\uff1a</li> </ul> <pre><code>plugins { jacoco }\n\ntasks.jacocoTestReport {\n  dependsOn(tasks.test)\n  reports { xml.required.set(true); html.required.set(true) }\n}\n\n# \u751f\u6210\u8986\u76d6\u7387\u62a5\u544a\n./gradlew test jacocoTestReport\n</code></pre>"},{"location":"notes/gradle-usage-guide.html#7-spring-boot","title":"7. \u4e0e Spring Boot \u7684\u8f7b\u91cf\u96c6\u6210","text":"<p>\u5982\u9700 Spring Boot\uff1a</p> <pre><code>plugins {\n  id(\"org.springframework.boot\") version \"3.3.5\"\n  id(\"io.spring.dependency-management\") version \"1.1.6\"\n  java\n}\n\ndependencies {\n  implementation(\"org.springframework.boot:spring-boot-starter-web\")\n  testImplementation(\"org.springframework.boot:spring-boot-starter-test\")\n}\n\n# \u8fd0\u884c\u4e0e\u6784\u5efa\n./gradlew bootRun\n./gradlew bootJar\n</code></pre>"},{"location":"notes/gradle-usage-guide.html#8-ci-jenkinsgitlabgithub-actions","title":"8. CI \u96c6\u6210\uff08Jenkins/GitLab/GitHub Actions\uff09","text":"<p>\u901a\u7528\u5efa\u8bae\uff1a - \u56fa\u5316 JDK \u4e0e Gradle Wrapper\uff1a\u4ec5\u6267\u884c <code>./gradlew ...</code>\uff1b - \u5f00\u542f\u6784\u5efa\u7f13\u5b58\u4e0e\u4f9d\u8d56\u7f13\u5b58\uff08CI \u5c42\u7f13\u5b58 ~/.gradle \u4e0e wrapper\uff09\u3002</p> <p>Jenkins \u7247\u6bb5\uff1a</p> <pre><code>stage('Build &amp; Test') { sh './gradlew -S clean test build' }\n</code></pre> <p>GitLab CI \u7247\u6bb5\uff1a</p> <pre><code>image: gradle:8.10.0-jdk17\ncache: { paths: [ .gradle, .gradle/wrapper, build ] }\nscript:\n  - ./gradlew -S clean test build\n</code></pre> <p>GitHub Actions \u7247\u6bb5\uff1a</p> <pre><code>- uses: actions/setup-java@v4\n  with: { distribution: temurin, java-version: '17' }\n- uses: gradle/actions/setup-gradle@v3\n- run: ./gradlew -S clean test build\n</code></pre>"},{"location":"notes/gradle-usage-guide.html#9","title":"9. \u5e38\u89c1\u95ee\u9898\u901f\u67e5","text":"<ul> <li>Wrapper \u7248\u672c\u4e0d\u4e00\u81f4\uff1a\u5220\u9664\u672c\u5730 <code>.gradle</code> \u4e0e <code>gradle/wrapper</code> \u540e\u91cd\u7f6e\uff0c\u518d\u7531 CI \u4ea7\u51fa\u7684 wrapper \u4e3a\u51c6\uff1b</li> <li>JUnit \u672a\u6267\u884c\uff1a\u786e\u4fdd <code>useJUnitPlatform()</code>\uff1b</li> <li>\u4f9d\u8d56\u51b2\u7a81\uff1a\u4f7f\u7528 <code>./gradlew dependencies</code> \u4e0e <code>./gradlew dependencyInsight --dependency xxx</code> \u5b9a\u4f4d\uff1b</li> <li>\u6784\u5efa\u6162\uff1a\u5f00\u542f Gradle Daemon\uff08\u9ed8\u8ba4\uff09\u3001\u672c\u5730\u4e0e CI \u7f13\u5b58\u3001\u5e76\u884c <code>--parallel</code>\uff08\u591a\u6a21\u5757\uff09\u3002</li> </ul>"},{"location":"notes/maven-automation-tutorial.html","title":"Apache Maven \u81ea\u52a8\u5316\u6784\u5efa\u4e0e\u6d4b\u8bd5\uff1a\u6848\u4f8b\u6559\u5b66\u4e0e\u547d\u4ee4\u884c","text":"<p>\u9762\u5411\u201c\u96f6\u5230\u4e00\u201d\u7684\u5165\u95e8\u4e0e\u4f01\u4e1a\u5e38\u89c1\u7528\u6cd5\uff08\u542b\u5b8c\u6574\u547d\u4ee4\uff09\u3002</p>"},{"location":"notes/maven-automation-tutorial.html#1","title":"1. \u73af\u5883\u4e0e\u5b89\u88c5","text":"<ul> <li>\u64cd\u4f5c\u7cfb\u7edf\uff1aWindows/Linux/macOS \u4efb\u610f</li> <li>\u4f9d\u8d56\uff1aJDK 17\u3001Maven 3.9+</li> </ul> <p>\u5b89\u88c5\u5efa\u8bae\uff1a - Windows\uff08\u7ba1\u7406\u5458 PowerShell\uff09</p> <pre><code>winget install EclipseAdoptium.Temurin.17.JDK\nwinget install TheApacheSoftwareFoundation.Maven\nmvn -v &amp;&amp; java -version\n</code></pre> <ul> <li>Ubuntu/Debian</li> </ul> <pre><code>sudo apt-get update\nsudo apt-get install -y openjdk-17-jdk maven\nmvn -v &amp;&amp; java -version\n</code></pre> <ul> <li>\u4e5f\u53ef\u4f7f\u7528 SDKMAN!/Homebrew \u7b49\u65b9\u5f0f\uff0c\u6216\u5728 CI \u4e2d\u4f7f\u7528\u5bb9\u5668\u955c\u50cf\uff08maven:3.9.9-eclipse-temurin-17\uff09\u3002</li> </ul>"},{"location":"notes/maven-automation-tutorial.html#2-demo","title":"2. \u5feb\u901f\u5f00\u59cb\uff1a\u521b\u5efa Demo \u9879\u76ee","text":"<p>\u4f7f\u7528\u5b98\u65b9 archetype \u5feb\u901f\u751f\u6210\u9aa8\u67b6\uff1a</p> <pre><code>mvn -B archetype:generate \\\n  -DarchetypeGroupId=org.apache.maven.archetypes \\\n  -DarchetypeArtifactId=maven-archetype-quickstart \\\n  -DarchetypeVersion=1.4 \\\n  -DgroupId=com.example \\\n  -DartifactId=demo \\\n  -Dversion=1.0-SNAPSHOT\n</code></pre> <p>\u76ee\u5f55\u7ed3\u6784\uff08\u6838\u5fc3\uff09\uff1a</p> <pre><code>demo/\n  pom.xml\n  src/main/java/com/example/App.java\n  src/test/java/com/example/AppTest.java\n</code></pre> <p>\u5e38\u7528\u547d\u4ee4\uff1a</p> <pre><code>cd demo\nmvn clean            # \u6e05\u7406\nmvn test             # \u8fd0\u884c\u5355\u5143\u6d4b\u8bd5\uff08Surefire\uff09\nmvn package          # \u4ea7\u51fa jar\uff08target/*.jar\uff09\nmvn install          # \u5b89\u88c5\u5230\u672c\u5730\u4ed3\u5e93 ~/.m2\nmvn -T 1C -B package # \u5e76\u884c\u6784\u5efa\u4e0e\u6279\u5904\u7406\u6a21\u5f0f\n</code></pre>"},{"location":"notes/maven-automation-tutorial.html#3-pom","title":"3. POM \u5173\u952e\u914d\u7f6e\u793a\u4f8b","text":"<p>\u6700\u5c0f\u53ef\u7528\u7684\u7f16\u8bd1/\u6d4b\u8bd5\u914d\u7f6e\uff1a</p> <pre><code>&lt;project&gt;\n  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n  &lt;groupId&gt;com.example&lt;/groupId&gt;\n  &lt;artifactId&gt;demo&lt;/artifactId&gt;\n  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n  &lt;properties&gt;\n    &lt;maven.compiler.release&gt;17&lt;/maven.compiler.release&gt;\n    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n    &lt;maven.surefire.plugin.version&gt;3.2.5&lt;/maven.surefire.plugin.version&gt;\n  &lt;/properties&gt;\n  &lt;dependencies&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\n      &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt;\n      &lt;version&gt;5.10.3&lt;/version&gt;\n      &lt;scope&gt;test&lt;/scope&gt;\n    &lt;/dependency&gt;\n  &lt;/dependencies&gt;\n  &lt;build&gt;\n    &lt;plugins&gt;\n      &lt;plugin&gt;\n        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n        &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\n        &lt;version&gt;${maven.surefire.plugin.version}&lt;/version&gt;\n        &lt;configuration&gt;\n          &lt;useSystemClassLoader&gt;false&lt;/useSystemClassLoader&gt;\n        &lt;/configuration&gt;\n      &lt;/plugin&gt;\n    &lt;/plugins&gt;\n  &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>"},{"location":"notes/maven-automation-tutorial.html#jacoco-shade","title":"\u5e38\u89c1\u52a0\u5f3a\uff1aJacoco \u8986\u76d6\u7387\u4e0e Shade \u6253\u5305","text":"<pre><code>&lt;build&gt;\n  &lt;plugins&gt;\n    &lt;plugin&gt;\n      &lt;groupId&gt;org.jacoco&lt;/groupId&gt;\n      &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;\n      &lt;version&gt;0.8.11&lt;/version&gt;\n      &lt;executions&gt;\n        &lt;execution&gt;\n          &lt;goals&gt;\n            &lt;goal&gt;prepare-agent&lt;/goal&gt;\n          &lt;/goals&gt;\n        &lt;/execution&gt;\n        &lt;execution&gt;\n          &lt;id&gt;report&lt;/id&gt;\n          &lt;phase&gt;verify&lt;/phase&gt;\n          &lt;goals&gt;\n            &lt;goal&gt;report&lt;/goal&gt;\n          &lt;/goals&gt;\n        &lt;/execution&gt;\n      &lt;/executions&gt;\n    &lt;/plugin&gt;\n    &lt;plugin&gt;\n      &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n      &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;\n      &lt;version&gt;3.5.3&lt;/version&gt;\n      &lt;executions&gt;\n        &lt;execution&gt;\n          &lt;phase&gt;package&lt;/phase&gt;\n          &lt;goals&gt;&lt;goal&gt;shade&lt;/goal&gt;&lt;/goals&gt;\n          &lt;configuration&gt;\n            &lt;createDependencyReducedPom&gt;true&lt;/createDependencyReducedPom&gt;\n            &lt;transformers&gt;\n              &lt;transformer implementation=\"org.apache.maven.plugins.shade.resource.ManifestResourceTransformer\"&gt;\n                &lt;mainClass&gt;com.example.App&lt;/mainClass&gt;\n              &lt;/transformer&gt;\n            &lt;/transformers&gt;\n          &lt;/configuration&gt;\n        &lt;/execution&gt;\n      &lt;/executions&gt;\n    &lt;/plugin&gt;\n  &lt;/plugins&gt;\n&lt;/build&gt;\n</code></pre> <p>\u6253\u5305\u5e76\u8fd0\u884c\uff08\u82e5\u4f7f\u7528 Shade\uff09\uff1a</p> <pre><code>mvn -B -DskipTests package\njava -jar target/demo-1.0-SNAPSHOT-shaded.jar\n</code></pre>"},{"location":"notes/maven-automation-tutorial.html#4-spring-boot","title":"4. \u4e0e Spring Boot \u7684\u6700\u5c0f\u6574\u5408","text":"<p>\u5982\u9700 Spring Boot\uff1a</p> <pre><code>&lt;dependencies&gt;\n  &lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n    &lt;version&gt;3.3.5&lt;/version&gt;\n  &lt;/dependency&gt;\n  &lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n    &lt;version&gt;3.3.5&lt;/version&gt;\n    &lt;scope&gt;test&lt;/scope&gt;\n  &lt;/dependency&gt;\n&lt;/dependencies&gt;\n&lt;build&gt;\n  &lt;plugins&gt;\n    &lt;plugin&gt;\n      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n      &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n      &lt;version&gt;3.3.5&lt;/version&gt;\n    &lt;/plugin&gt;\n  &lt;/plugins&gt;\n&lt;/build&gt;\n</code></pre> <p>\u8fd0\u884c\uff1a</p> <pre><code>mvn -B -DskipTests package\njava -jar target/*.jar\n</code></pre>"},{"location":"notes/maven-automation-tutorial.html#5-monorepo","title":"5. \u591a\u6a21\u5757\uff08Monorepo\uff09\u793a\u4f8b","text":"<p>\u7ed3\u6784\uff1a</p> <pre><code>root/\n  pom.xml (packaging=pom)\n  app/\n    pom.xml\n  lib/\n    pom.xml\n</code></pre> <p>\u7236 POM \u5173\u952e\uff1a</p> <pre><code>&lt;project&gt;\n  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n  &lt;groupId&gt;com.example&lt;/groupId&gt;\n  &lt;artifactId&gt;root&lt;/artifactId&gt;\n  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n  &lt;packaging&gt;pom&lt;/packaging&gt;\n  &lt;modules&gt;\n    &lt;module&gt;lib&lt;/module&gt;\n    &lt;module&gt;app&lt;/module&gt;\n  &lt;/modules&gt;\n&lt;/project&gt;\n</code></pre> <p>\u6784\u5efa\u547d\u4ee4\uff1a</p> <pre><code>mvn -B -pl lib -am package   # \u4ec5\u6784\u5efa lib\uff08\u81ea\u52a8\u6784\u5efa\u4f9d\u8d56\uff09\nmvn -B -pl app -amd package  # \u6784\u5efa app\uff08\u542b\u5176\u4f9d\u8d56\uff09\n</code></pre>"},{"location":"notes/maven-automation-tutorial.html#6-ci-jenkinsgitlab-ci","title":"6. CI \u96c6\u6210\uff08\u4e0e Jenkins/GitLab CI\uff09","text":"<ul> <li>Jenkins\uff1a\u5728\u5bb9\u5668 agent \u4e2d\u6267\u884c <code>mvn -B clean test package</code>\uff0c\u4ea7\u51fa Surefire \u62a5\u544a\u4e0e\u5236\u54c1\uff1b\u4e4b\u540e Docker \u6784\u5efa\u4e0e\u63a8\u9001\u3002</li> <li>GitLab CI\uff1a\u4f7f\u7528 <code>image: maven:3.9.9-eclipse-temurin-17</code>\uff0c\u7f13\u5b58 <code>~/.m2/repository</code> \u63d0\u901f\u3002</li> </ul> <p>GitLab \u7247\u6bb5\uff1a</p> <pre><code>cache:\n  key: ${CI_COMMIT_REF_SLUG}\n  paths: [ .m2/repository ]\nscript:\n  - mvn -B -DskipTests=false clean test\n  - mvn -B -DskipTests=true package\n</code></pre>"},{"location":"notes/maven-automation-tutorial.html#7","title":"7. \u5e38\u89c1\u95ee\u9898\u901f\u67e5","text":"<ul> <li>\u6d4b\u8bd5\u672a\u8fd0\u884c\uff1aJupiter \u4f9d\u8d56\u7f3a\u5931\u6216\u5305\u540d/\u7c7b\u540d\u4e0d\u7b26\u5408\u7ea6\u5b9a\uff08\u4ee5 *Test \u7ed3\u5c3e\uff09\u3002</li> <li>JDK \u7248\u672c\u51b2\u7a81\uff1a\u4f7f\u7528 <code>&lt;maven.compiler.release&gt;</code> \u6216\u5728 CI \u955c\u50cf\u4e2d\u56fa\u5b9a\u5230 Temurin 17\u3002</li> <li>\u4f9d\u8d56\u4e0b\u8f7d\u6162\uff1a\u914d\u7f6e\u955c\u50cf\u4ed3\u5e93\uff08\u5982\u963f\u91cc\u4e91/\u534e\u4e3a\u4e91 Maven \u955c\u50cf\uff09\u3002</li> <li>\u6253\u5305\u4f53\u79ef\u5927\uff1a\u4f7f\u7528 Shade \u65f6\u5408\u7406\u6392\u9664\uff1b\u6216\u6539\u7528 Spring Boot Plugin \u7684\u5206\u5c42 jar\u3002</li> </ul>"},{"location":"notes/maven-automation-tutorial.html#8","title":"8. \u5e38\u7528\u547d\u4ee4\u901f\u67e5\u8868","text":"<pre><code>mvn -v                         # \u7248\u672c\nmvn clean                      # \u6e05\u7406\nmvn test                       # \u5355\u5143\u6d4b\u8bd5\nmvn package                    # \u6784\u5efa\u5236\u54c1\nmvn verify                     # \u542b\u96c6\u6210\u6d4b\u8bd5\u4e0e\u9a8c\u8bc1\nmvn install                    # \u5b89\u88c5\u5230\u672c\u5730\u4ed3\u5e93\nmvn dependency:tree            # \u4f9d\u8d56\u6811\nmvn help:effective-pom         # \u6700\u7ec8\u751f\u6548 POM\nmvn -T 1C -B package           # \u5e76\u884c+\u6279\u5904\u7406\n</code></pre>"},{"location":"notes/paddleocrproject-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html","title":"paddleocrproject \u590d\u73b0\u4e0e\u91cd\u6784\u65b9\u6848","text":"<p>\u66f4\u65b0\u65f6\u95f4\uff1a2025-11-11  \u4f5c\u8005\uff1aLifu</p>"},{"location":"notes/paddleocrproject-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_1","title":"\u6982\u8ff0","text":"<p>paddleocrproject \u63d0\u4f9b PDF\u2192TXT/JSON \u7684\u6279\u5904\u7406\u80fd\u529b\uff0c\u652f\u6301 CLI \u4e0e GUI \u9762\u677f\u3001\u53ef\u6682\u505c\u7684\u961f\u5217\u6267\u884c\u3001\u901f\u5ea6/\u8d28\u91cf\u62a5\u544a\uff0c\u9488\u5bf9 Windows/CPU \u73af\u5883\u505a\u4e86\u201c\u65e0\u9ed1\u7a97\u53e3\u201d\u4f18\u5316\uff08\u7edf\u4e00\u4f7f\u7528 pythonw.exe + CREATE_NO_WINDOW\uff09\u3002</p>"},{"location":"notes/paddleocrproject-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_2","title":"\u76ee\u5f55\u4e0e\u7ec4\u4ef6\uff08\u6765\u81ea\u4ed3\u5e93\uff09","text":"<ul> <li>\u9876\u5c42\u811a\u672c\uff1arestart_gui.py\u3001check_status.py\u3001start_gui.py\u3001start_worker.py</li> <li>\u6838\u5fc3/CLI\uff1aocr_app\uff08init/enqueue/run-worker/status/report/ocr-one\uff09</li> <li>\u811a\u672c\uff1ascripts/gui_panel.py\u3001run_batches.py\u3001queue_monitor.py\u3001sample_ocr.py\u3001small_batch_test.py</li> <li>\u5b58\u50a8\uff1astate/queue.db\u3001state/pause.flag</li> <li>\u8f93\u51fa\uff1aoutputs/pocr_txt\u3001outputs/runs/\u2026</li> <li>\u65e5\u5fd7\uff1alogs/worker\u3001logs/runner\u3001logs/monitor\u3001logs/failed</li> <li>\u62a5\u544a\uff1areports/*.md</li> <li>\u6d4b\u8bd5\uff1atests/test_layout_order.py\uff08\u53cc\u680f\u6392\u5e8f\u5355\u6d4b\u5168\u8fc7\uff09</li> </ul>"},{"location":"notes/paddleocrproject-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#cpu","title":"\u73af\u5883\u4e0e\u4f9d\u8d56\uff08CPU\uff09","text":"<pre><code>python -m venv .venv\n.\\.venv\\Scripts\\Activate.ps1\npython -m pip install -U pip\npython -m pip install -U paddlepaddle paddleocr pymupdf\npython -c \"import fitz; from paddleocr import PaddleOCR; print('OK')\"\n</code></pre>"},{"location":"notes/paddleocrproject-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_3","title":"\u5feb\u901f\u4f7f\u7528","text":"<ul> <li>\u542f\u52a8 GUI\uff1a<code>python restart_gui.py</code></li> <li>\u67e5\u770b\u72b6\u6001\uff1a<code>python check_status.py</code></li> <li>\u542f\u52a8 Worker\uff1a<code>python start_worker.py</code></li> </ul>"},{"location":"notes/paddleocrproject-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#cli-ocr_app","title":"CLI \u5e38\u7528\u547d\u4ee4\uff08ocr_app\uff09","text":"<pre><code>.\\.venv\\Scripts\\python -m ocr_app.cli init\n.\\.venv\\Scripts\\python -m ocr_app.cli ocr-one --pdf \"yaodian_2bu/\u793a\u4f8b.pdf\" --zoom 1.6 --header-ratio 0.06 --footer-ratio 0.08\n.\\.venv\\Scripts\\python -m ocr_app.cli enqueue --dir yaodian_2bu --limit 200 --dedup\n.\\.venv\\Scripts\\python -m ocr_app.cli run-worker --max-jobs 200 --zoom 1.6 --header-ratio 0.06 --footer-ratio 0.08 --job-timeout 240\n.\\.venv\\Scripts\\python -m ocr_app.cli report --out reports/queue_speed_report.md --fold-by-name\n</code></pre>"},{"location":"notes/paddleocrproject-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_4","title":"\u5173\u952e\u5b9e\u73b0\u8981\u70b9","text":"<ul> <li>GUI \u9762\u677f\uff1a500ms \u8ba1\u6570\u5237\u65b0 + 2s \u65e5\u5fd7\u805a\u5408\uff1b\u6253\u5f00\u76ee\u5f55/\u5e2e\u52a9\u83dc\u5355</li> <li>\u961f\u5217\u6a21\u578b\uff1aSQLite queue.db\uff1bstate/pause.flag \u53ef\u6682\u505c\uff1brun_batches \u81ea\u52a8\u5206\u6279</li> <li>OCR \u7b56\u7565\uff1aPaddleOCR mobile + PyMuPDF \u6e32\u67d3\uff1b\u9875\u7709\u8fc7\u6ee4\uff08header_ratio\uff09\u3001\u9875\u811a\u6355\u83b7\uff08footer_ratio\u2192JSON\uff09</li> <li>\u65e5\u5fd7\uff1a\u63a7\u5236\u53f0 INFO + \u6587\u4ef6 DEBUG\uff08utf-8-sig\uff0cPowerShell 5 \u517c\u5bb9\uff09</li> </ul>"},{"location":"notes/paddleocrproject-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_5","title":"\u91cd\u6784/\u590d\u73b0\u8ba1\u5212\uff08\u5efa\u8bae\u91cc\u7a0b\u7891\uff09","text":"<ul> <li>M1 \u6700\u5c0f\u6d41\u6c34\u7ebf\uff081-3 \u5929\uff09</li> <li>ocr-one + \u76ee\u5f55\u521d\u59cb\u5316 + \u57fa\u7840\u65e5\u5fd7\uff1b\u751f\u6210 txt \u4e0e page-footers JSON</li> <li>M2 \u961f\u5217\u4e0e\u9762\u677f\uff081-2 \u5929\uff09</li> <li>enqueue/run-worker/status/report\uff1bGUI \u9762\u677f\u3001\u9ed1\u7a97\u53e3\u4f18\u5316\u4e0e\u8fdb\u7a0b\u7ba1\u7406</li> <li>M3 \u5de5\u7a0b\u5316\uff081-2 \u5929\uff09</li> <li>run_batches \u6302\u673a\u5168\u5e93\uff1bTail/\u67e5\u8be2\u4f18\u5316\uff1b\u5f02\u5e38\u6062\u590d\u4e0e\u544a\u8b66\uff08\u53ef\u9009\uff09</li> </ul>"},{"location":"notes/paddleocrproject-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_6","title":"\u9a8c\u6536\u6e05\u5355","text":"<ul> <li>20 \u4e2a PDF \u5c0f\u6279\u91cf\u8dd1\u901a\uff0c\u751f\u6210\u62a5\u544a\u4e0e JSON\uff08\u9875\u7801/\u9875\u811a\uff09</li> <li>\u961f\u5217 200 \u4efb\u52a1\u6d41\u7545\u8fd0\u884c\uff0cGUI \u6307\u6807\u5237\u65b0\u65e0\u963b\u585e</li> <li>\u65e5\u5fd7\u7f16\u7801\u6b63\u786e\uff08\u65e0\u4e2d\u6587\u4e71\u7801\uff09</li> </ul>"},{"location":"notes/paddleocrproject-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_7","title":"\u4e00\u952e\u590d\u73b0\uff08\u793a\u4f8b\uff09","text":"<pre><code>cd C:\\Users\\lifu.liu\\code\\paddleocrproject\npython -m venv .venv\n.\\.venv\\Scripts\\Activate.ps1\npython -m pip install -U pip\npython -m pip install -U paddlepaddle paddleocr pymupdf\npython restart_gui.py\npython start_worker.py\n</code></pre>"},{"location":"notes/paddleocrproject-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_8","title":"\u4f9d\u8d56\u4e0e\u7248\u672c\uff08\u7cbe\u786e\uff09","text":"<pre><code># Core OCR stack\npaddlepaddle\npaddleocr\npymupdf\n\n# GUI (optional)\nPyQt6\n</code></pre>"},{"location":"notes/paddleocrproject-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_9","title":"\u63a8\u8350\u53c2\u6570\u4e0e\u9ed8\u8ba4\u503c","text":"<ul> <li>\u57fa\u7840\u653e\u5927\uff1a<code>--zoom 1.6</code></li> <li>\u9875\u7709\u8fc7\u6ee4\uff1a<code>--header-ratio 0.06</code></li> <li>\u9875\u811a\u6355\u83b7\uff1a<code>--footer-ratio 0.08</code> \u2192 \u751f\u6210 page-footers JSON</li> <li>\u4efb\u52a1\u8d85\u65f6\uff1a<code>--job-timeout 240</code></li> <li>\u5355\u6279\u6700\u5927\u4efb\u52a1\uff1a<code>--max-jobs 200</code></li> </ul>"},{"location":"notes/pc_monitor-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html","title":"pc_monitor \u590d\u73b0\u4e0e\u91cd\u6784\u65b9\u6848","text":"<p>\u66f4\u65b0\u65f6\u95f4\uff1a2025-11-11  \u4f5c\u8005\uff1aLifu</p>"},{"location":"notes/pc_monitor-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_1","title":"\u6982\u8ff0","text":"<p>pc_monitor \u662f\u4e00\u5957 Windows \u7535\u8111\u76d1\u63a7\u7cfb\u7edf\uff1a\u7535\u6e90/\u7cfb\u7edf/\u7f51\u7edc\u76d1\u63a7\uff0c\u7535\u6e90\u62d4\u51fa\u81ea\u52a8\u62cd\u7167\uff0c\u8be6\u7ec6\u65e5\u5fd7\u4e0e HTML \u62a5\u544a\uff0cGUI \u4e0e\u7cfb\u7edf\u6258\u76d8\uff0c\u5b8c\u6574\u914d\u7f6e\u7ba1\u7406\u4e0e\u5f00\u673a\u81ea\u542f\u52a8\u3002\u672c\u6587\u7ed9\u51fa\u53ef\u590d\u73b0\u4e0e\u91cd\u6784\u8def\u5f84\u3002</p>"},{"location":"notes/pc_monitor-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#readme","title":"\u529f\u80fd\u8981\u70b9\uff08\u6765\u81ea README\uff09","text":"<ul> <li>\u7535\u6e90\u76d1\u63a7\uff1a\u4ea4\u6d41/\u7535\u6c60\u3001\u5145\u653e\u7535\u3001\u62d4\u51fa\u4e8b\u4ef6\u3001\u4f4e\u7535\u91cf\u544a\u8b66</li> <li>\u81ea\u52a8\u62cd\u7167\uff1a\u76f8\u673a\u5ef6\u8fdf/\u8d28\u91cf/\u683c\u5f0f\u53ef\u914d\uff0c\u4fdd\u5b58\u5230\u76ee\u5f55</li> <li>\u7cfb\u7edf\u76d1\u63a7\uff1a\u5f00\u5173\u673a\u3001\u8fd0\u884c\u65f6\u957f\u3001CPU/\u5185\u5b58/\u78c1\u76d8</li> <li>\u7f51\u7edc\u76d1\u63a7\uff1aDNS \u8fde\u901a\u6027</li> <li>\u65e5\u5fd7\u7cfb\u7edf\uff1a\u591a\u7ea7\u522b\u3001\u6309\u5927\u5c0f\u6eda\u52a8</li> <li>\u62a5\u544a\u751f\u6210\uff1a\u6bcf\u65e5 HTML\uff0c\u542b 24h \u4e8b\u4ef6\u4e0e\u622a\u56fe/\u7167\u7247</li> <li>GUI \u4e0e\u6258\u76d8\uff1a\u4eea\u8868\u76d8/\u65e5\u5fd7/\u7167\u7247/\u8bbe\u7f6e\u3001\u6700\u5c0f\u5316\u5230\u6258\u76d8\u3001\u901a\u77e5</li> <li>\u914d\u7f6e\u7ba1\u7406\uff1aconfig.json \u5168\u91cf\u914d\u7f6e\uff0c\u652f\u6301\u81ea\u542f\u52a8</li> </ul>"},{"location":"notes/pc_monitor-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#readme_1","title":"\u76ee\u5f55\u4e0e\u6a21\u5757\uff08\u6765\u81ea README\uff09","text":"<pre><code>pc_monitor/\n\u251c\u2500\u2500 main.py                 # \u5165\u53e3\n\u251c\u2500\u2500 config.json             # \u914d\u7f6e\n\u251c\u2500\u2500 requirements.txt        # \u4f9d\u8d56\n\u251c\u2500\u2500 config_manager.py       # \u914d\u7f6e\u7ba1\u7406\n\u251c\u2500\u2500 logger.py               # \u65e5\u5fd7\n\u251c\u2500\u2500 power_monitor.py        # \u7535\u6e90\n\u251c\u2500\u2500 system_monitor.py       # \u7cfb\u7edf\n\u251c\u2500\u2500 camera_capture.py       # \u76f8\u673a\n\u251c\u2500\u2500 report_generator.py     # \u62a5\u544a\n\u251c\u2500\u2500 gui.py                  # GUI\n\u2514\u2500\u2500 autostart.py            # \u81ea\u542f\u52a8\n</code></pre>"},{"location":"notes/pc_monitor-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_2","title":"\u73af\u5883\u4e0e\u4f9d\u8d56","text":"<pre><code>cd C:\\Users\\lifu.liu\\code\\cmd\\pc_monitor\npip install -r requirements.txt\n</code></pre> <ul> <li>\u9996\u6b21\u8fd0\u884c\u9700\u5141\u8bb8\u76f8\u673a\u6743\u9650</li> </ul>"},{"location":"notes/pc_monitor-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_3","title":"\u8fd0\u884c\u4e0e\u9a8c\u8bc1","text":"<pre><code>python main.py\n</code></pre> <ul> <li>\u4eea\u8868\u76d8\uff1a\u7535\u6e90/CPU/\u5185\u5b58/\u65f6\u957f/\u6700\u8fd1\u4e8b\u4ef6</li> <li>\u4e8b\u4ef6\u65e5\u5fd7\uff1a\u6309\u65f6\u95f4\u987a\u5e8f\u5237\u65b0</li> <li>\u7167\u7247\uff1acaptures/ \u76ee\u5f55\u4e0e GUI \u5217\u8868</li> <li>\u62a5\u544a\uff1a\u624b\u52a8\u6309\u94ae\u6216\u5b9a\u65f6\u5230 reports/</li> <li>\u6258\u76d8\uff1a\u5173\u95ed\u7a97\u53e3\u2192\u5230\u6258\u76d8\uff1b\u53cc\u51fb\u6062\u590d\uff1b\u53f3\u952e\u83dc\u5355\u9000\u51fa</li> </ul>"},{"location":"notes/pc_monitor-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#configjson","title":"\u914d\u7f6e\u8981\u70b9\uff08config.json\uff09","text":"<ul> <li>general\uff1aauto_start\u3001minimize_to_tray\u3001start_minimized</li> <li>monitoring\uff1aenable_power_monitor/enable_camera_capture/enable_network_monitor/enable_system_events\u3001camera_delay_seconds</li> <li>camera\uff1acamera_index\u3001image_quality\u3001image_format\u3001save_path</li> <li>logging\uff1alog_level\u3001log_path\u3001max_log_size_mb\u3001backup_count</li> <li>report\uff1aenable_daily_report\u3001report_time\u3001report_path\u3001report_format\u3001include_screenshots</li> <li>notifications\uff1aenable_tray_notifications\u3001show_power_change/show_network_change/show_system_events</li> </ul>"},{"location":"notes/pc_monitor-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_4","title":"\u91cd\u6784/\u590d\u73b0\u8ba1\u5212\uff08\u5efa\u8bae\u91cc\u7a0b\u7891\uff09","text":"<ul> <li>M1 \u4e8b\u4ef6\u4e3b\u7ebf\u4e0e\u6700\u5c0f\u76d1\u63a7\uff081-2 \u5929\uff09</li> <li>\u642d\u5efa\u4e8b\u4ef6\u603b\u7ebf+\u7edf\u4e00\u65e5\u5fd7\uff1b\u7535\u6e90/\u7cfb\u7edf/\u7f51\u7edc\u6700\u5c0f\u95ed\u73af\uff1b\u76f8\u673a\u62cd\u7167\u6d41\u6c34\u7ebf</li> <li>\u9ed8\u8ba4\u914d\u7f6e/\u5411\u540e\u517c\u5bb9\uff1bGUI \u72b6\u6001\u4e0e\u65e5\u5fd7\u89c6\u56fe</li> <li>M2 \u62a5\u544a\u4e0e\u6258\u76d8\uff081-2 \u5929\uff09</li> <li>HTML \u62a5\u544a\u6a21\u677f/\u751f\u6210\uff1b\u6258\u76d8\u4ea4\u4e92/\u7cfb\u7edf\u901a\u77e5\uff1b\u65e5\u5fd7\u6eda\u52a8\u7b56\u7565</li> <li>M3 \u5065\u58ee\u6027\u4e0e\u751f\u6001\uff081-2 \u5929\uff09</li> <li>\u76f8\u673a\u5360\u7528\u4e0e\u5f02\u5e38\u6062\u590d\uff1b\u81ea\u542f\u52a8\u4e0e\u6743\u9650\u63d0\u793a\uff1b\u5355\u6d4b\u4e0e\u7aef\u5230\u7aef\u9a8c\u6536\u811a\u672c</li> </ul>"},{"location":"notes/pc_monitor-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_5","title":"\u9a8c\u6536\u6e05\u5355","text":"<ul> <li>\u7535\u6e90\u62d4\u51fa\u89e6\u53d1\u62cd\u7167\uff1b\u4f4e\u7535\u91cf\u544a\u8b66\u53ef\u89c1</li> <li>\u62a5\u544a\u6309\u65f6/\u6309\u9700\u751f\u6210\uff0c\u542b\u56fe\u7247\u4e0e\u7edf\u8ba1</li> <li>\u65e5\u5fd7\u6eda\u52a8\u4e0e\u5927\u5c0f\u9650\u5236\u751f\u6548</li> <li>GUI/\u6258\u76d8\u4ea4\u4e92\u4e0e\u901a\u77e5\u53ef\u9760</li> </ul>"},{"location":"notes/pc_monitor-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_6","title":"\u4e00\u952e\u590d\u73b0\uff08\u793a\u4f8b\uff09","text":"<pre><code>cd C:\\Users\\lifu.liu\\code\\cmd\\pc_monitor\npip install -r requirements.txt\npython main.py\n</code></pre>"},{"location":"notes/pc_monitor-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_7","title":"\u4f9d\u8d56\u4e0e\u7248\u672c\uff08\u7cbe\u786e\uff09","text":"<pre><code>PyQt6&gt;=6.6.0\nopencv-python&gt;=4.8.0\npsutil&gt;=5.9.0\nPillow&gt;=10.0.0\npywin32&gt;=306\nwmi&gt;=1.5.0\n</code></pre>"},{"location":"notes/pc_monitor-%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#configjson_1","title":"\u914d\u7f6e\u6587\u4ef6\uff08\u5f53\u524d\u9ed8\u8ba4/\u793a\u4f8b\uff1aconfig.json\uff09","text":"<pre><code>{\n    \"general\": {\n        \"app_name\": \"PC Monitor\",\n        \"version\": \"1.0.0\",\n        \"auto_start\": false,\n        \"minimize_to_tray\": true,\n        \"start_minimized\": false\n    },\n    \"monitoring\": {\n        \"enable_power_monitor\": true,\n        \"enable_camera_capture\": true,\n        \"enable_network_monitor\": true,\n        \"enable_system_events\": true,\n        \"camera_delay_seconds\": 3,\n        \"capture_mode\": \"video\"\n    },\n    \"camera\": {\n        \"camera_index\": 0,\n        \"image_quality\": 95,\n        \"image_format\": \"jpg\",\n        \"save_path\": \"captures\",\n        \"use_windows_camera\": false,\n        \"warmup_frames\": 15,\n        \"warmup_delay\": 3\n    },\n    \"video\": {\n        \"video_save_path\": \"videos\",\n        \"video_duration_seconds\": 20,\n        \"video_fps\": 30,\n        \"video_codec\": \"mp4v\",\n        \"video_quality\": 95\n    },\n    \"logging\": {\n        \"log_level\": \"INFO\",\n        \"log_path\": \"logs\",\n        \"max_log_size_mb\": 10,\n        \"backup_count\": 5\n    },\n    \"report\": {\n        \"enable_daily_report\": true,\n        \"report_time\": \"12:00\",\n        \"report_path\": \"reports\",\n        \"report_format\": \"html\",\n        \"include_screenshots\": true\n    },\n    \"notifications\": {\n        \"enable_tray_notifications\": true,\n        \"show_power_change\": true,\n        \"show_network_change\": true,\n        \"show_system_events\": true\n    }\n}\n</code></pre> <ul> <li>\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff1a\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u7684 <code>config.json</code></li> <li>\u5e38\u7528\u53c2\u6570\u5efa\u8bae\uff1a</li> <li>camera_delay_seconds\uff1a\u9ed8\u8ba4 3 \u79d2\u9884\u70ed\uff0c\u4f4e\u5149\u73af\u5883\u53ef\u589e\u5927</li> <li>image_quality\uff1a95\uff1bimage_format\uff1ajpg\uff1bsave_path\uff1acaptures</li> <li>video_duration_seconds\uff1a20\uff1bvideo_fps\uff1a30\uff1bvideo_codec\uff1amp4v</li> <li>report_time\uff1a12:00\uff1breport_format\uff1ahtml\uff1binclude_screenshots\uff1atrue</li> <li>log_level\uff1aINFO\uff1bmax_log_size_mb\uff1a10\uff1bbackup_count\uff1a5</li> <li>enable_* \u5f00\u5173\uff1a\u5747\u53ef\u6309\u9700\u5173\u95ed\u4ee5\u964d\u4f4e\u8d44\u6e90\u5360\u7528</li> </ul>"},{"location":"notes/skywalking-usage-ops.html","title":"Apache SkyWalking \u4f7f\u7528\u65b9\u6848\u4e0e\u8fd0\u7ef4\u7ecf\u9a8c","text":"<p>\u672c\u6587\u8986\u76d6\uff1a\u67b6\u6784\u539f\u7406\u3001Docker \u5feb\u901f\u90e8\u7f72\u3001Java \u5e94\u7528\u63a5\u5165\u3001\u91c7\u6837\u4e0e TTL \u7b56\u7565\u3001\u5e38\u89c1\u95ee\u9898\u4e0e\u8fd0\u7ef4\u7ecf\u9a8c\u3002</p>"},{"location":"notes/skywalking-usage-ops.html#1","title":"1. \u6982\u89c8\u4e0e\u67b6\u6784","text":"<ul> <li>\u7ec4\u4ef6\uff1aOAP Server\uff08\u6838\u5fc3\u540e\u7aef\uff09+ UI\uff08\u53ef\u89c6\u5316\uff09+ \u5b58\u50a8\uff08Elasticsearch/BanyanDB/H2 Demo\uff09+ Agent\uff08Java/Node/Go \u7b49\uff09</li> <li>\u6570\u636e\u6d41\uff1aAgent \u2192 OAP\uff08\u5206\u6790/\u805a\u5408/\u5ea6\u91cf/\u8ffd\u8e2a\uff09\u2192 \u5b58\u50a8 \u2192 UI \u67e5\u8be2</li> <li>\u5178\u578b\u7528\u9014\uff1a\u5206\u5e03\u5f0f\u8ffd\u8e2a\u3001\u6307\u6807\uff08Metrics\uff09\u3001\u65e5\u5fd7\uff08Logging\uff09\u3001\u544a\u8b66\uff08Alerting\uff09</li> </ul>"},{"location":"notes/skywalking-usage-ops.html#2-docker-compose","title":"2. Docker Compose \u5feb\u901f\u90e8\u7f72","text":"<p>\u4e0b\u9762\u7ed9\u51fa\u57fa\u4e8e Elasticsearch \u7684\u751f\u4ea7\u5c31\u7eea\u793a\u4f8b\uff08\u6700\u5e38\u89c1\uff09\uff1b\u5982\u4ec5\u5feb\u901f\u4f53\u9a8c\uff0c\u53ef\u5c06 ES \u6539\u4e3a\u5355\u673a H2\uff08\u4e0d\u63a8\u8350\u751f\u4ea7\uff09\u3002</p> <p>docker-compose.yml\uff1a</p> <pre><code>version: '3.8'\nservices:\n  elasticsearch:\n    image: docker.io/library/elasticsearch:8.15.3\n    environment:\n      - discovery.type=single-node\n      - xpack.security.enabled=false\n      - ES_JAVA_OPTS=-Xms1g -Xmx1g\n    ulimits: { memlock: { soft: -1, hard: -1 } }\n    volumes:\n      - es-data:/usr/share/elasticsearch/data\n    ports: [\"9200:9200\"]\n\n  oap:\n    image: apache/skywalking-oap-server:10.1.0\n    depends_on: [ elasticsearch ]\n    environment:\n      SW_STORAGE: elasticsearch\n      SW_STORAGE_ES_HTTP_SERVERS: http://elasticsearch:9200\n      JAVA_OPTS: \"-Xms1g -Xmx1g\"\n    ports:\n      - \"12800:12800\" # gRPC\n      - \"11800:11800\" # HTTP\n\n  ui:\n    image: apache/skywalking-ui:10.1.0\n    depends_on: [ oap ]\n    environment:\n      SW_OAP_ADDRESS: http://oap:12800\n    ports:\n      - \"8080:8080\"\n\nvolumes:\n  es-data:\n</code></pre> <p>\u542f\u52a8\u4e0e\u9a8c\u8bc1\uff1a</p> <pre><code>docker compose up -d\n# \u7b49\u5f85 ES/OAP/UI \u5c31\u7eea\u540e\nopen http://localhost:8080\n</code></pre> <p>\uff08\u4ec5\u6f14\u793a\uff09H2 \u6a21\u5f0f\uff1a</p> <pre><code>docker run -d --name oap -p 12800:12800 -p 11800:11800 \\\n  -e SW_STORAGE=h2 \\\n  apache/skywalking-oap-server:10.1.0\n\ndocker run -d --name ui -p 8080:8080 \\\n  -e SW_OAP_ADDRESS=http://host.docker.internal:12800 \\\n  apache/skywalking-ui:10.1.0\n</code></pre>"},{"location":"notes/skywalking-usage-ops.html#3-java-agent","title":"3. Java \u5e94\u7528\u63a5\u5165\uff08Agent\uff09","text":"<p>\u4e0b\u8f7d agent \u5305\u5e76\u901a\u8fc7 JVM \u9009\u9879\u6ce8\u5165\uff1a</p> <pre><code>wget https://archive.apache.org/dist/skywalking/java-agent/9.2.0/apache-skywalking-java-agent-9.2.0.tgz\nmkdir -p /opt/skywalking &amp;&amp; tar -xf apache-skywalking-java-agent-*.tgz -C /opt/skywalking\n</code></pre> <p>\u542f\u52a8\u53c2\u6570\uff08\u793a\u4f8b Spring Boot\uff09\uff1a</p> <pre><code>JAVA_AGENT_HOME=/opt/skywalking/skywalking-agent\njava \\\n  -javaagent:${JAVA_AGENT_HOME}/skywalking-agent.jar \\\n  -Dskywalking.agent.service_name=demo-api \\\n  -Dskywalking.collector.backend_service=127.0.0.1:11800 \\\n  -jar app.jar\n</code></pre> <p>Dockerfile \u65b9\u5f0f\uff1a</p> <pre><code>FROM eclipse-temurin:17-jre\nENV JAVA_AGENT_HOME=/opt/skywalking/skywalking-agent\nRUN mkdir -p /opt/skywalking \\\n &amp;&amp; curl -fsSL https://archive.apache.org/dist/skywalking/java-agent/9.2.0/apache-skywalking-java-agent-9.2.0.tgz \\\n | tar -xz -C /opt/skywalking\nWORKDIR /app\nCOPY target/demo-*.jar app.jar\nEXPOSE 8080\nENTRYPOINT [\"java\",\"-javaagent:/opt/skywalking/skywalking-agent/skywalking-agent.jar\",\"-Dskywalking.agent.service_name=demo-api\",\"-Dskywalking.collector.backend_service=oap:11800\",\"-jar\",\"/app/app.jar\"]\n</code></pre> <p>\u5e38\u7528\u63d2\u4ef6\uff08\u81ea\u52a8\u63a2\u9488\uff09\uff1aSpring MVC\u3001WebFlux\u3001JDBC\u3001MyBatis\u3001Kafka\u3001Jedis\u3001OKHttp\u3001Feign\u3001Dubbo \u7b49\uff0c\u9ed8\u8ba4\u6309\u89c4\u5219\u751f\u6548\u3002</p>"},{"location":"notes/skywalking-usage-ops.html#4","title":"4. \u6307\u6807/\u8ffd\u8e2a\u914d\u7f6e\u8981\u70b9","text":"<ul> <li>\u91c7\u6837\uff08Sampling\uff09</li> <li>\u9ed8\u8ba4\u6309\u6982\u7387\u91c7\u6837\uff1b\u9ad8\u5e76\u53d1\u573a\u666f\u5efa\u8bae 5\u2030\uff5e5% \u533a\u95f4\u8bd5\u70b9\uff0c\u517c\u987e\u6210\u672c\u4e0e\u53ef\u89c2\u6d4b\u6027\u3002</li> <li>\u53ef\u4f7f\u7528\u52a8\u6001\u914d\u7f6e\u4e2d\u5fc3\u70ed\u66f4\u65b0\u91c7\u6837\u7387\u3002</li> <li>\u6570\u636e TTL</li> <li>\u6307\u6807/\u8ffd\u8e2a/\u65e5\u5fd7\u4fdd\u7559\u671f\u6309\u4e1a\u52a1\u9700\u6c42\u5206\u5c42\uff08\u5982 3/7/30 \u5929\uff09\u3002</li> <li>Elasticsearch \u5efa\u8bae\u5f00\u542f ILM/\u5206\u533a\u7d22\u5f15\uff0c\u907f\u514d\u5355\u7d22\u5f15\u8fc7\u5927\u3002</li> <li>\u6807\u7b7e\uff08Tag\uff09\u4e0e\u57fa\u6570</li> <li>\u907f\u514d\u5728 Span Tag \u4e2d\u653e\u5165\u9ad8\u57fa\u6570\u5b57\u6bb5\uff08\u5982\u7528\u6237 ID\u3001\u8ba2\u5355\u53f7\u539f\u503c\uff09\uff1b\u5fc5\u8981\u65f6\u505a hash/\u5206\u6876\u3002</li> <li>\u544a\u8b66</li> <li>\u4f7f\u7528 OAL/\u544a\u8b66\u89c4\u5219\u5b9a\u4e49 SLO\uff08\u5982 95th \u5ef6\u8fdf\u3001\u9519\u8bef\u7387\uff09\uff0c\u8054\u52a8\u4f01\u4e1a\u5fae\u4fe1/\u98de\u4e66/\u90ae\u4ef6\u3002</li> </ul>"},{"location":"notes/skywalking-usage-ops.html#5","title":"5. \u751f\u4ea7\u8fd0\u7ef4\u7ecf\u9a8c","text":"<ul> <li>\u67b6\u6784\u4e0e\u5bb9\u91cf</li> <li>OAP \u53ef\u6a2a\u5411\u6269\u5c55\uff1bES \u5efa\u8bae\u6700\u5c11 3 \u8282\u70b9\u751f\u4ea7\u96c6\u7fa4\uff0c\u51b7\u70ed\u5206\u5c42\u4e0e\u526f\u672c\u7b56\u7565\u6309\u5bb9\u91cf\u8bbe\u8ba1\u3002</li> <li>OAP JVM\uff1aXms/Xmx \u4e0e GC\uff08G1/ZGC\uff09\u6309\u541e\u5410\u91cf\u538b\u6d4b\u540e\u56fa\u5316\uff1b\u542f\u7528\u5bb9\u5668\u5185\u5b58\u9650\u5236\u611f\u77e5\u3002</li> <li>\u7a33\u5b9a\u6027</li> <li>\u65f6\u95f4\u540c\u6b65\uff1a\u6240\u6709\u8282\u70b9\u542f\u7528 NTP\uff0c\u907f\u514d Trace \u65f6\u95f4\u7ebf\u9519\u4e71\u3002</li> <li>\u7f51\u7edc\uff1aOAP \u4e0e\u5e94\u7528\u95f4\u4fdd\u6301\u7a33\u5b9a\u5185\u7f51\u94fe\u8def\uff1b\u8de8\u673a\u623f\u9700\u4e13\u7ebf\u6216\u8fb9\u754c\u4ee3\u7406\u3002</li> <li>\u9650\u6d41\uff1a\u5bf9\u5165\u53e3\u7f51\u5173/\u6838\u5fc3\u670d\u52a1\u5f00\u542f\u9650\u6d41\u4e0e\u7194\u65ad\uff0c\u907f\u514d\u96ea\u5d29\u65f6\u76d1\u63a7\u7cfb\u7edf\u88ab\u653e\u5927\u6253\u7206\u3002</li> <li>\u5b58\u50a8\u6cbb\u7406</li> <li>ILM/\u5206\u533a\uff1a\u6309\u5929/\u5c0f\u65f6\u5206\u533a\uff1b\u65e7\u6570\u636e\u964d\u51b7\u70ed\u5b58\u50a8\u6216\u4e0b\u7ebf\uff1b\u5b9a\u671f\u6e05\u7406\u3002</li> <li>\u7d22\u5f15\u6a21\u677f\uff1a\u5408\u7406\u7684\u5206\u7247/\u526f\u672c\u6570\uff1b\u907f\u514d\u8fc7\u5927\u5206\u7247\uff08&gt;50GB\uff09\u3002</li> <li>\u5b89\u5168\u4e0e\u9694\u79bb</li> <li>UI \u53ea\u8bfb\u89d2\u8272\u3001OAP \u9274\u6743\u3001TLS\uff1b\u751f\u4ea7 UI \u4e0d\u66b4\u9732\u516c\u7f51\u6216\u505a VPN/\u96f6\u4fe1\u4efb\u3002</li> <li>\u5347\u7ea7\u4e0e\u53d8\u66f4</li> <li>\u5148\u7070\u5ea6 OAP/UI\uff0c\u518d\u7070\u5ea6 Agent\uff1b\u5173\u6ce8 Breaking Changes \u4e0e\u63a2\u9488\u517c\u5bb9\u77e9\u9635\u3002</li> </ul>"},{"location":"notes/skywalking-usage-ops.html#6","title":"6. \u6545\u969c\u6392\u67e5\u901f\u67e5","text":"<ul> <li>UI \u65e0\u6570\u636e\uff1a\u68c0\u67e5 OAP 11800/12800 \u7aef\u53e3\u8fde\u901a\uff1b\u786e\u8ba4 agent -javaagent \u53c2\u6570\u751f\u6548\uff08\u542f\u52a8\u65e5\u5fd7\uff09\u3002</li> <li>Trace \u4e22\u5931\uff1a\u91c7\u6837\u7387\u8fc7\u4f4e/\u6d41\u91cf\u8fc7\u5927\uff1bOAP/ES \u538b\u529b\u8fc7\u9ad8\uff1b\u67e5\u770b OAP \u65e5\u5fd7\u548c ES \u5199\u5165\u961f\u5217\u3002</li> <li>ES \u8d1f\u8f7d\u9ad8\uff1a\u70ed\u6570\u636e\u4e0e\u51b7\u6570\u636e\u5206\u5c42\uff1b\u5199\u5165\u6279\u91cf\u5c3a\u5bf8\uff1b\u5237\u65b0\u95f4\u9694\uff1b\u5206\u7247\u4e0e\u526f\u672c\u4f18\u5316\u3002</li> <li>\u6307\u6807\u4e0d\u51c6\uff1a\u65f6\u95f4\u672a\u540c\u6b65\uff1b\u81ea\u5b9a\u4e49 Span/Tag \u8fc7\u591a\uff1b\u805a\u5408\u7a97\u53e3\u4e0e\u7c92\u5ea6\u4e0d\u5339\u914d\u3002</li> </ul>"},{"location":"notes/skywalking-usage-ops.html#7-cicd","title":"7. \u4e0e CI/CD \u4e0e\u5bb9\u5668\u5e73\u53f0\u96c6\u6210","text":"<ul> <li>Kubernetes\uff1a\u4f7f\u7528 Operator \u6216 Helm Chart \u90e8\u7f72 OAP/UI/ES\uff1b\u4ee5 Sidecar/Init \u5bb9\u5668\u6ce8\u5165 Agent \u6216\u5728\u955c\u50cf\u4e2d\u9884\u7f6e\u3002</li> <li>CI/CD\uff1a\u5728\u6d41\u6c34\u7ebf\u4e2d\u5c06\u5e94\u7528\u955c\u50cf\u5e26\u4e0a agent \u5c42\uff08\u89c1 Dockerfile \u793a\u4f8b\uff09\uff0c\u90e8\u7f72\u65f6\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u914d\u7f6e service_name \u4e0e backend_service\u3002</li> </ul>"},{"location":"notes/skywalking-usage-ops.html#8","title":"8. \u53c2\u8003\u94fe\u63a5","text":"<ul> <li>\u5b98\u65b9\u6587\u6863\uff1ahttps://skywalking.apache.org/</li> <li>Docker \u955c\u50cf\uff1ahttps://hub.docker.com/u/apache</li> <li>GitHub \u4ed3\u5e93\uff1ahttps://github.com/apache/skywalking</li> </ul>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html","title":"\u4e00\u79cd\u6587\u4ef6\u52a0\u5bc6\u8bbe\u8ba1","text":"<p>A technical exploration and guide</p>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#content","title":"Content","text":""},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_2","title":"\u4e00\u79cd\u6587\u4ef6\u52a0\u5bc6\u8bbe\u8ba1","text":""},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_3","title":"\u9700\u6c42\u56de\u987e\uff1a","text":"<ol> <li>\u6587\u4ef6\u540d\u4fdd\u5bc6\uff1a\u4f60\u9700\u8981\u5bf9\u6587\u4ef6\u540d\u8fdb\u884c\u968f\u673a\u5316\uff0c\u4f7f\u5176\u4e0d\u80fd\u901a\u8fc7\u540d\u79f0\u8bc6\u522b\u51fa\u6587\u4ef6\u5185\u5bb9\u6216\u987a\u5e8f\u3002</li> <li>\u6620\u5c04\u8868\u8bb0\u5f55\uff1a\u6240\u6709\u7684\u539f\u59cb\u6587\u4ef6\u540d\u548c\u91cd\u547d\u540d\u540e\u7684\u6587\u4ef6\u540d\u5fc5\u987b\u5728\u4e00\u4e2a\u6620\u5c04\u8868\u4e2d\u5b8c\u6574\u8bb0\u5f55\uff0c\u5e76\u4e14\u4fdd\u7559\u64ad\u653e\u987a\u5e8f\u3002</li> <li>\u5206\u7ec4\u4fe1\u606f\uff1a\u9700\u8981\u901a\u8fc7\u6620\u5c04\u8868\u6765\u8868\u660e\u8fd9\u4e9b\u6587\u4ef6\u5c5e\u4e8e\u540c\u4e00\u7ec4\uff0c\u65b9\u4fbf\u7ba1\u7406\u3002</li> </ol>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_4","title":"\u8be6\u7ec6\u64cd\u4f5c\u6b65\u9aa4\u7684\u56de\u987e\u548c\u6539\u8fdb\uff1a","text":""},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#1","title":"1. \u83b7\u53d6\u539f\u59cb\u6587\u4ef6\u5e76\u6392\u5e8f\uff1a","text":"<ul> <li>\u904d\u5386\u76ee\u6807\u6587\u4ef6\u5939\uff0c\u8bfb\u53d6\u6240\u6709\u6587\u4ef6\u540d\uff0c\u5e76\u89e3\u6790\u51fa\u6587\u4ef6\u540d\u4e2d\u7684\u6570\u5b57\u5e8f\u53f7\u4ee5\u786e\u4fdd\u987a\u5e8f\u6b63\u786e\u3002</li> <li>\u5982\u679c\u6587\u4ef6\u540d\u4e2d\u5e26\u6709\u56fa\u5b9a\u683c\u5f0f\uff08\u5982\u201c\u6d4b\u8bd5\u6587\u4ef60001.txt\u201d\uff09\uff0c\u53ef\u4ee5\u63d0\u53d6\u51fa\u5176\u4e2d\u7684\u6570\u5b57\u90e8\u5206\u8fdb\u884c\u6392\u5e8f\uff0c\u8fd9\u6837\u5728\u91cd\u547d\u540d\u540e\uff0c\u4f9d\u7136\u53ef\u4ee5\u901a\u8fc7\u6620\u5c04\u8868\u8fd8\u539f\u6b63\u786e\u987a\u5e8f\u3002</li> </ul>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#2","title":"2. \u751f\u6210\u968f\u673a\u6587\u4ef6\u540d\uff1a","text":"<ul> <li>\u968f\u673a\u6587\u4ef6\u540d\u7684\u751f\u6210\u65b9\u5f0f\u53ef\u4ee5\u57fa\u4e8e\u5b57\u6bcd\u548c\u6570\u5b57\u7684\u7ec4\u5408\uff0c\u957f\u5ea6\u53ef\u4ee5\u63a7\u5236\u5728\u4e00\u5b9a\u8303\u56f4\uff08\u598216\u5b57\u7b26\u6216\u66f4\u591a\uff09\uff0c\u786e\u4fdd\u65e0\u6cd5\u901a\u8fc7\u6587\u4ef6\u540d\u63a8\u65ad\u51fa\u5185\u5bb9\u6216\u987a\u5e8f\u3002</li> <li>\u793a\u4f8b\u6587\u4ef6\u540d\u53ef\u4ee5\u662f <code>fk23432_2343.txt</code> \u6216 <code>zxmnm823mnvcn.txt</code>\uff0c\u5176\u4e2d\uff1a</li> <li>\u5b57\u6bcd\u90e8\u5206\u968f\u673a\u751f\u6210\uff0c\u4e0d\u5177\u6709\u4efb\u4f55\u5b9e\u9645\u610f\u4e49\u3002</li> <li>\u6570\u5b57\u90e8\u5206\u4e5f\u968f\u673a\u751f\u6210\uff0c\u8fdb\u4e00\u6b65\u589e\u52a0\u4e0d\u53ef\u9884\u6d4b\u6027\u3002</li> <li>\u6587\u4ef6\u6269\u5c55\u540d\u4fdd\u6301\u539f\u6837\uff0c\u4ee5\u786e\u4fdd\u6587\u4ef6\u683c\u5f0f\u4e0d\u53d8\u3002</li> </ul>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#3","title":"3. \u751f\u6210\u5e76\u4fdd\u5b58\u6620\u5c04\u8868\uff1a","text":"<ul> <li> <p>\u6620\u5c04\u8868\u5e94\u5305\u542b\u4ee5\u4e0b\u4fe1\u606f\uff1a</p> </li> <li> <p>\u539f\u6587\u4ef6\u540d\uff1a\u8bb0\u5f55\u539f\u59cb\u7684\u6587\u4ef6\u540d\uff0c\u4fbf\u4e8e\u8ffd\u6eaf\u3002</p> </li> <li>\u65b0\u6587\u4ef6\u540d\uff1a\u8bb0\u5f55\u6bcf\u4e2a\u6587\u4ef6\u91cd\u547d\u540d\u540e\u7684\u968f\u673a\u540d\u79f0\u3002</li> <li>\u987a\u5e8f\u4fe1\u606f\uff1a\u4fdd\u7559\u6587\u4ef6\u7684\u987a\u5e8f\uff0c\u786e\u4fdd\u64ad\u653e\u6216\u4f7f\u7528\u65f6\u80fd\u591f\u6309\u539f\u987a\u5e8f\u8fdb\u884c\u3002</li> <li>\u7ec4\u4fe1\u606f\uff1a\u5728\u6620\u5c04\u8868\u4e2d\u589e\u52a0\u4e00\u5217\uff0c\u7528\u6765\u6807\u8bc6\u6587\u4ef6\u7684\u7ec4\u3002\u4f8b\u5982\uff0c\u6240\u6709\u6587\u4ef6\u5c5e\u4e8e\u201cGroup1\u201d\u3002</li> </ul> <p>\u6620\u5c04\u8868\u7684\u793a\u4f8b\u53ef\u4ee5\u662f CSV \u683c\u5f0f\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>   \u7ec4\u540d, \u539f\u6587\u4ef6\u540d, \u65b0\u6587\u4ef6\u540d, \u987a\u5e8f\n   Group1, \u6d4b\u8bd5\u6587\u4ef60001.txt, fk23432_2343.txt, 1\n   Group1, \u6d4b\u8bd5\u6587\u4ef60002.txt, zxmnm823mnvcn.txt, 2\n   Group1, \u6d4b\u8bd5\u6587\u4ef60003.txt, qwerty09876.txt, 3\n   ...\n   Group1, \u6d4b\u8bd5\u6587\u4ef60068.txt, abcdefghi123.txt, 68\n</code></pre> <p>\u5173\u952e\u8981\u70b9\uff1a</p> <ul> <li>\u987a\u5e8f\u5b57\u6bb5\uff1a\u901a\u8fc7\u987a\u5e8f\u5b57\u6bb5\uff0c\u4f60\u53ef\u4ee5\u786e\u4fdd\u5373\u4fbf\u6587\u4ef6\u540d\u5df2\u88ab\u6253\u4e71\uff0c\u4ecd\u7136\u53ef\u4ee5\u6839\u636e\u6620\u5c04\u8868\u6309\u539f\u987a\u5e8f\u5904\u7406\u8fd9\u4e9b\u6587\u4ef6\u3002</li> <li>\u7ec4\u5b57\u6bb5\uff1a\u8868\u660e\u8fd9\u7ec4\u6587\u4ef6\u662f\u4e00\u8d77\u7684\uff0c\u65b9\u4fbf\u7ba1\u7406\u3002</li> </ul>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#4","title":"4. \u6587\u4ef6\u91cd\u547d\u540d\uff1a","text":"<ul> <li>\u4f7f\u7528\u6620\u5c04\u8868\u4e2d\u7684\u65b0\u6587\u4ef6\u540d\uff0c\u5bf9\u6587\u4ef6\u9010\u4e2a\u8fdb\u884c\u5b9e\u9645\u91cd\u547d\u540d\u3002</li> <li>\u786e\u4fdd\u6587\u4ef6\u7684\u6269\u5c55\u540d\u4fdd\u6301\u4e0d\u53d8\u3002</li> <li>\u6587\u4ef6\u91cd\u547d\u540d\u5b8c\u6210\u540e\uff0c\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u540d\u5e94\u5b8c\u5168\u968f\u673a\u5316\u4e14\u65e0\u89c4\u5f8b\u53ef\u5faa\u3002</li> </ul>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#5","title":"5. \u9a8c\u8bc1\u548c\u5b89\u5168\u6027\uff1a","text":"<ul> <li> <p>\u6620\u5c04\u8868\u7684\u5b89\u5168\u6027\uff1a\u56e0\u4e3a\u6620\u5c04\u8868\u5305\u542b\u4e86\u539f\u6587\u4ef6\u540d\u4e0e\u65b0\u6587\u4ef6\u540d\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u5b83\u662f\u6240\u6709\u6587\u4ef6\u7684\u6838\u5fc3\u3002\u5982\u679c\u6620\u5c04\u8868\u4e22\u5931\u6216\u6cc4\u9732\uff0c\u4fdd\u5bc6\u6027\u5c06\u53d7\u5230\u5f71\u54cd\u3002\u56e0\u6b64\uff1a</p> </li> <li> <p>\u52a0\u5bc6\u6620\u5c04\u8868\uff1a\u53ef\u4ee5\u5bf9\u6620\u5c04\u8868\u8fdb\u884c\u52a0\u5bc6\u5b58\u50a8\uff0c\u786e\u4fdd\u53ea\u6709\u6388\u6743\u7528\u6237\u80fd\u591f\u8bfb\u53d6\u5b83\u3002</p> </li> <li>\u5907\u4efd\u6620\u5c04\u8868\uff1a\u5c06\u6620\u5c04\u8868\u59a5\u5584\u5907\u4efd\uff0c\u786e\u4fdd\u5176\u4e0d\u4f1a\u610f\u5916\u4e22\u5931\u3002</li> <li>\u8bbf\u95ee\u63a7\u5236\uff1a\u9650\u5236\u6620\u5c04\u8868\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u786e\u4fdd\u53ea\u6709\u4f60\u6216\u6388\u6743\u4eba\u5458\u80fd\u591f\u8bfb\u53d6\u548c\u66f4\u65b0\u5b83\u3002</li> <li>\u91cd\u547d\u540d\u9a8c\u8bc1\uff1a\u5728\u91cd\u547d\u540d\u4e4b\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u6620\u5c04\u8868\u5bf9\u6587\u4ef6\u9010\u4e00\u9a8c\u8bc1\uff0c\u786e\u4fdd\u6240\u6709\u6587\u4ef6\u90fd\u5df2\u6b63\u786e\u91cd\u547d\u540d\uff0c\u5e76\u4e14\u987a\u5e8f\u6ca1\u6709\u9519\u4e71\u3002</li> </ul>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#6","title":"6. \u8fdb\u4e00\u6b65\u4f18\u5316\u7684\u5efa\u8bae\uff1a","text":"<ul> <li>\u6587\u4ef6\u540d\u51b2\u7a81\u68c0\u6d4b\uff1a\u786e\u4fdd\u751f\u6210\u7684\u968f\u673a\u6587\u4ef6\u540d\u4e0d\u4f1a\u4e0e\u5df2\u6709\u6587\u4ef6\u540d\u51b2\u7a81\u3002\u5982\u679c\u5b58\u5728\u6f5c\u5728\u7684\u51b2\u7a81\u60c5\u51b5\uff0c\u53ef\u4ee5\u5728\u751f\u6210\u6587\u4ef6\u540d\u65f6\u589e\u52a0\u51b2\u7a81\u68c0\u6d4b\u673a\u5236\uff0c\u907f\u514d\u91cd\u540d\u3002</li> <li>\u7a0b\u5e8f\u5316\u81ea\u52a8\u5316\uff1a\u4f60\u53ef\u4ee5\u901a\u8fc7\u811a\u672c\uff08\u5982 Python\u3001Lua \u7b49\uff09\u6765\u81ea\u52a8\u5b8c\u6210\u4e0a\u8ff0\u6d41\u7a0b\uff0c\u786e\u4fdd\u8fc7\u7a0b\u9ad8\u6548\u3001\u51c6\u786e\uff0c\u5e76\u51cf\u5c11\u4eba\u4e3a\u9519\u8bef\u3002</li> </ul>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_5","title":"\u793a\u4f8b\u6d41\u7a0b\u56fe\uff1a","text":"<pre><code>\u83b7\u53d6\u6587\u4ef6 -&gt; \u89e3\u6790\u6587\u4ef6\u540d\u987a\u5e8f -&gt; \u751f\u6210\u968f\u673a\u6587\u4ef6\u540d -&gt; \u66f4\u65b0\u6620\u5c04\u8868 -&gt; \u6267\u884c\u91cd\u547d\u540d -&gt; \u9a8c\u8bc1\u548c\u5b89\u5168\u7ba1\u7406\n</code></pre> <p>\u603b\u7ed3\uff1a</p> <p>\u4f60\u73b0\u5728\u6709\u4e00\u5957\u5b8c\u6574\u7684\u903b\u8f91\u6765\u7ba1\u7406\u8fd9\u6279\u6587\u4ef6\uff1a</p> <ul> <li>\u6587\u4ef6\u540d\u7684\u5b8c\u5168\u968f\u673a\u5316\u786e\u4fdd\u4fdd\u5bc6\u6027\u3002</li> <li>\u6620\u5c04\u8868\u4f5c\u4e3a\u6587\u4ef6\u987a\u5e8f\u548c\u539f\u59cb\u540d\u79f0\u7684\u552f\u4e00\u6865\u6881\uff0c\u786e\u4fdd\u4fdd\u7559\u6587\u4ef6\u7684\u672c\u8d28\u548c\u987a\u5e8f\u3002</li> <li>\u5206\u7ec4\u4fe1\u606f\u4fbf\u4e8e\u5c06\u8fd9\u4e9b\u6587\u4ef6\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u6765\u7ba1\u7406\u3002</li> </ul>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_6","title":"\u5bf9\u6587\u4ef6\u8fdb\u884c\u54c8\u5e0c\u5904\u7406","text":"<ol> <li> <p>\u5b8c\u6574\u6027\u9a8c\u8bc1\uff1a</p> </li> <li> <p>\u54c8\u5e0c\u503c\u53ef\u4ee5\u4f5c\u4e3a\u6bcf\u4e2a\u6587\u4ef6\u7684\u552f\u4e00\u6807\u8bc6\u7b26\uff0c\u786e\u4fdd\u6587\u4ef6\u5728\u91cd\u547d\u540d\u3001\u4f20\u8f93\u6216\u5b58\u50a8\u8fc7\u7a0b\u4e2d\u6ca1\u6709\u88ab\u7be1\u6539\u6216\u635f\u574f\u3002</p> </li> <li>\u5728\u4f60\u91cd\u547d\u540d\u6587\u4ef6\u540e\uff0c\u54c8\u5e0c\u503c\u53ef\u4ee5\u5e2e\u52a9\u4f60\u9a8c\u8bc1\u6587\u4ef6\u662f\u5426\u4e0e\u539f\u59cb\u6587\u4ef6\u4e00\u81f4\uff0c\u9632\u6b62\u56e0\u91cd\u547d\u540d\u6216\u5176\u4ed6\u64cd\u4f5c\u5bfc\u81f4\u6587\u4ef6\u5185\u5bb9\u610f\u5916\u53d1\u751f\u53d8\u5316\u3002</li> <li> <p>\u9632\u7be1\u6539\u6027\uff1a</p> </li> <li> <p>\u54c8\u5e0c\u503c\u4f7f\u5f97\u4efb\u4f55\u5bf9\u6587\u4ef6\u7684\u6539\u52a8\uff08\u4f8b\u5982\u6587\u4ef6\u5185\u5bb9\u7684\u4fee\u6539\uff09\u90fd\u80fd\u88ab\u5feb\u901f\u68c0\u6d4b\u5230\u3002\u5373\u4f7f\u6587\u4ef6\u540d\u5df2\u7ecf\u6539\u53d8\uff0c\u5982\u679c\u5185\u5bb9\u53d1\u751f\u4efb\u4f55\u53d8\u5316\uff0c\u54c8\u5e0c\u503c\u4e5f\u4f1a\u968f\u4e4b\u6539\u53d8\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u68c0\u67e5\u54c8\u5e0c\u503c\u786e\u8ba4\u6587\u4ef6\u662f\u5426\u906d\u5230\u7be1\u6539\u3002</p> </li> <li> <p>\u6587\u4ef6\u7684\u552f\u4e00\u6807\u8bc6\uff1a</p> </li> <li> <p>\u54c8\u5e0c\u503c\u53ef\u4ee5\u4f5c\u4e3a\u6587\u4ef6\u7684\u6307\u7eb9\uff0c\u5373\u4f7f\u6587\u4ef6\u540d\u88ab\u66f4\u6539\uff0c\u6587\u4ef6\u7684\u54c8\u5e0c\u503c\u4f9d\u7136\u552f\u4e00\uff0c\u80fd\u591f\u5e2e\u52a9\u8bc6\u522b\u91cd\u590d\u6587\u4ef6\u6216\u68c0\u6d4b\u6587\u4ef6\u7684\u51b2\u7a81\u3002</p> </li> <li> <p>\u8fdb\u4e00\u6b65\u4fdd\u62a4\u9690\u79c1\uff1a</p> </li> <li> <p>\u54c8\u5e0c\u503c\u53ef\u4ee5\u8ba9\u4f60\u5728\u6620\u5c04\u8868\u4e2d\u8fdb\u4e00\u6b65\u9690\u85cf\u6587\u4ef6\u7684\u5185\u5bb9\u3002\u5373\u4fbf\u5176\u4ed6\u4eba\u83b7\u5f97\u4e86\u6620\u5c04\u8868\uff0c\u4ed6\u4eec\u4e5f\u65e0\u6cd5\u901a\u8fc7\u54c8\u5e0c\u503c\u63a8\u65ad\u51fa\u6587\u4ef6\u7684\u5b9e\u9645\u5185\u5bb9\uff0c\u4f46\u4f60\u4f9d\u7136\u53ef\u4ee5\u901a\u8fc7\u54c8\u5e0c\u503c\u9a8c\u8bc1\u6587\u4ef6\u7684\u771f\u5b9e\u6027\u548c\u4e00\u81f4\u6027\u3002</p> </li> </ol>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_7","title":"\u4f55\u65f6\u8fdb\u884c\u54c8\u5e0c\u5904\u7406\uff1a","text":"<p>\u4f60\u53ef\u4ee5\u5728\u6587\u4ef6\u91cd\u547d\u540d\u4e4b\u524d\u6216\u4e4b\u540e\u5bf9\u6587\u4ef6\u8fdb\u884c\u54c8\u5e0c\u5904\u7406\uff0c\u5177\u4f53\u64cd\u4f5c\u53d6\u51b3\u4e8e\u9700\u6c42\uff1a</p> <ol> <li>\u91cd\u547d\u540d\u524d\u7684\u54c8\u5e0c\u5904\u7406\uff1a\u8fd9\u6837\u53ef\u4ee5\u786e\u4fdd\u54c8\u5e0c\u503c\u4e0e\u539f\u59cb\u6587\u4ef6\u4e00\u81f4\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u54c8\u5e0c\u503c\u6765\u9a8c\u8bc1\u539f\u59cb\u6587\u4ef6\u662f\u5426\u88ab\u66f4\u6539\u3002</li> <li>\u91cd\u547d\u540d\u540e\u7684\u54c8\u5e0c\u5904\u7406\uff1a\u5982\u679c\u4f60\u5e0c\u671b\u9a8c\u8bc1\u91cd\u547d\u540d\u540e\u7684\u6587\u4ef6\u662f\u5426\u4e0e\u539f\u6587\u4ef6\u4e00\u81f4\uff0c\u91cd\u547d\u540d\u540e\u8fdb\u884c\u54c8\u5e0c\u8ba1\u7b97\u4e5f\u53ef\u4ee5\u3002</li> </ol>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_8","title":"\u8bb0\u5f55\u54c8\u5e0c\u503c\u7684\u6620\u5c04\u8868\u7ed3\u6784\uff1a","text":"<p>\u6620\u5c04\u8868\u4e2d\u53ef\u4ee5\u589e\u52a0\u4e00\u5217\u54c8\u5e0c\u503c\uff0c\u8bb0\u5f55\u6587\u4ef6\u7684\u54c8\u5e0c\u503c\uff0c\u5f62\u6210\u5982\u4e0b\u7ed3\u6784\uff1a</p> <pre><code>\u7ec4\u540d, \u539f\u6587\u4ef6\u540d, \u65b0\u6587\u4ef6\u540d, \u987a\u5e8f, \u54c8\u5e0c\u503c\nGroup1, \u6d4b\u8bd5\u6587\u4ef60001.txt, fk23432_2343.txt, 1, 3d20e355a2b9ed3fd1621fd3b6a83572\nGroup1, \u6d4b\u8bd5\u6587\u4ef60002.txt, zxmnm823mnvcn.txt, 2, d3486ae9136e7856bc42212385ea7970\n...\nGroup1, \u6d4b\u8bd5\u6587\u4ef60068.txt, abcdefghi123.txt, 68, aab3238922bcc25a6f606eb525ffdc56\n</code></pre>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_9","title":"\u4f7f\u7528\u54c8\u5e0c\u7b97\u6cd5\uff1a","text":"<p>\u5e38\u89c1\u7684\u54c8\u5e0c\u7b97\u6cd5\u6709\uff1a</p> <ul> <li>MD5\uff1a\u751f\u6210\u8f83\u77ed\u7684\u54c8\u5e0c\u503c\uff0c\u901f\u5ea6\u5feb\uff0c\u4f46\u5b89\u5168\u6027\u8f83\u5f31\uff08\u53ef\u4ee5\u901a\u8fc7\u78b0\u649e\u653b\u51fb\u7834\u89e3\uff09\u3002</li> <li>SHA-256\uff1a\u751f\u6210\u66f4\u957f\u4e14\u66f4\u5b89\u5168\u7684\u54c8\u5e0c\u503c\uff0c\u9002\u7528\u4e8e\u9700\u8981\u9ad8\u5b89\u5168\u6027\u7684\u573a\u666f\u3002</li> </ul> <p>\u4f60\u53ef\u4ee5\u6839\u636e\u9700\u6c42\u9009\u62e9\u4e0d\u540c\u7684\u54c8\u5e0c\u7b97\u6cd5\u6765\u8ba1\u7b97\u6587\u4ef6\u7684\u54c8\u5e0c\u503c\u3002</p>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_10","title":"\u662f\u5426\u6709\u5fc5\u8981\u4f7f\u7528\u54c8\u5e0c\u503c\uff1a","text":"<ul> <li>\u5982\u679c\u4f60\u5e0c\u671b\u8fdb\u4e00\u6b65\u786e\u4fdd\u6587\u4ef6\u5728\u91cd\u547d\u540d\u548c\u7ba1\u7406\u8fc7\u7a0b\u4e2d\u4e0d\u4f1a\u88ab\u7be1\u6539\uff0c\u6216\u662f\u9700\u8981\u5bf9\u6587\u4ef6\u5b8c\u6574\u6027\u8fdb\u884c\u9a8c\u8bc1\uff0c\u54c8\u5e0c\u503c\u662f\u975e\u5e38\u6709\u7528\u7684\u3002</li> <li>\u5982\u679c\u4f60\u53ea\u5173\u5fc3\u6587\u4ef6\u540d\u7684\u4fdd\u5bc6\u6027\uff0c\u800c\u4e0d\u5173\u5fc3\u6587\u4ef6\u5185\u5bb9\u7684\u5b8c\u6574\u6027\u6216\u9632\u7be1\u6539\u6027\uff0c\u90a3\u4e48\u54c8\u5e0c\u5904\u7406\u53ef\u80fd\u4e0d\u662f\u7edd\u5bf9\u5fc5\u8981\u7684\u3002</li> </ul>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_11","title":"\u603b\u7ed3\uff1a","text":"<p>\u5bf9\u6587\u4ef6\u8fdb\u884c\u54c8\u5e0c\u5904\u7406\u5e76\u8bb0\u5f55\u5728\u6620\u5c04\u8868\u4e2d\uff0c\u53ef\u4ee5\u63d0\u5347\u6587\u4ef6\u7ba1\u7406\u8fc7\u7a0b\u4e2d\u7684\u5b89\u5168\u6027\u548c\u5b8c\u6574\u6027\u9a8c\u8bc1\u3002\u5982\u679c\u4f60\u8ba4\u4e3a\u6587\u4ef6\u7684\u5185\u5bb9\u5b8c\u6574\u6027\u548c\u7be1\u6539\u9632\u62a4\u662f\u91cd\u8981\u7684\uff0c\u8fd9\u4e2a\u6b65\u9aa4\u662f\u975e\u5e38\u503c\u5f97\u7684\u3002</p> <p>\u4f60\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u9700\u6c42\u9009\u62e9\u662f\u5426\u8fdb\u884c\u54c8\u5e0c\u5904\u7406\u3002\u5982\u679c\u4f60\u51b3\u5b9a\u6267\u884c\u54c8\u5e0c\u64cd\u4f5c\uff0c\u540e\u7eed\u6211\u4eec\u53ef\u4ee5\u8ba8\u8bba\u5982\u4f55\u96c6\u6210\u5230\u4f60\u73b0\u6709\u7684\u6d41\u7a0b\u4e2d\u3002</p>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#demo","title":"Demo","text":""},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_12","title":"\u6620\u5c04\u8868\u7684\u5b57\u6bb5\uff1a","text":"<ol> <li>\u7ec4\u540d\uff1a\u8868\u793a\u8fd9\u4e9b\u6587\u4ef6\u5c5e\u4e8e\u540c\u4e00\u7ec4\uff0c\u6bd4\u5982 Group1\u3002</li> <li>\u539f\u6587\u4ef6\u540d\uff1a\u6587\u4ef6\u7684\u539f\u59cb\u540d\u79f0\uff0c\u8bb0\u5f55\u6587\u4ef6\u7684\u5b9e\u9645\u5185\u5bb9\u548c\u6765\u6e90\u3002</li> <li>\u65b0\u6587\u4ef6\u540d\uff1a\u968f\u673a\u751f\u6210\u7684\u6587\u4ef6\u540d\uff0c\u786e\u4fdd\u65e0\u6cd5\u901a\u8fc7\u6587\u4ef6\u540d\u63a8\u6d4b\u5185\u5bb9\u6216\u987a\u5e8f\u3002</li> <li>\u6587\u4ef6\u987a\u5e8f\uff1a\u6587\u4ef6\u5728\u64ad\u653e\u6216\u5904\u7406\u65f6\u7684\u987a\u5e8f\uff0c\u7528\u4e8e\u4fdd\u6301\u539f\u6765\u7684\u987a\u5e8f\u3002</li> <li>\u54c8\u5e0c\u503c\uff1a\u901a\u8fc7\u54c8\u5e0c\u7b97\u6cd5\u751f\u6210\u7684\u552f\u4e00\u503c\uff0c\u786e\u4fdd\u6587\u4ef6\u5185\u5bb9\u6ca1\u6709\u88ab\u7be1\u6539\u3002\u5e38\u7528\u7684\u54c8\u5e0c\u7b97\u6cd5\u5305\u62ec MD5\u3001SHA-256 \u7b49\u3002</li> <li>\u52a0\u5bc6\u5bc6\u94a5/\u52a0\u5bc6\u4fe1\u606f\uff1a\u7528\u4e8e\u8bb0\u5f55\u6587\u4ef6\u52a0\u5bc6\u65f6\u4f7f\u7528\u7684\u5bc6\u94a5\u6216\u7b97\u6cd5\u3002\u5982\u679c\u4f60\u4f7f\u7528\u7684\u662f\u5bf9\u79f0\u52a0\u5bc6\uff08\u5982 AES\uff09\uff0c\u8fd9\u91cc\u53ef\u4ee5\u8bb0\u5f55\u52a0\u5bc6\u5bc6\u94a5\u3002\u5982\u679c\u4f7f\u7528\u7684\u662f\u975e\u5bf9\u79f0\u52a0\u5bc6\uff08\u5982 RSA\uff09\uff0c\u53ef\u4ee5\u8bb0\u5f55\u516c\u94a5/\u79c1\u94a5\u4fe1\u606f\u3002</li> <li>\u5206\u5757\u4fe1\u606f\uff08\u5982\u679c\u6587\u4ef6\u88ab\u5207\u5206\uff09\uff1a\u7528\u4e8e\u8bb0\u5f55\u6587\u4ef6\u88ab\u5206\u5757\u540e\u7684\u5757\u53f7\u53ca\u6bcf\u4e2a\u5757\u7684\u52a0\u5bc6\u4fe1\u606f\uff0c\u786e\u4fdd\u8fd8\u539f\u65f6\u80fd\u591f\u6b63\u786e\u7ec4\u88c5\u6587\u4ef6\u3002</li> <li>\u6587\u4ef6\u7c7b\u578b/\u6269\u5c55\u540d\uff1a\u5982\u679c\u4f60\u4f7f\u7528\u4e86\u81ea\u5b9a\u4e49\u6587\u4ef6\u7c7b\u578b\u6216\u9690\u85cf\u4e86\u6587\u4ef6\u7684\u6269\u5c55\u540d\uff0c\u53ef\u4ee5\u8bb0\u5f55\u539f\u59cb\u7684\u6587\u4ef6\u7c7b\u578b\uff0c\u786e\u4fdd\u89e3\u5bc6\u540e\u80fd\u591f\u6b63\u786e\u8bc6\u522b\u6587\u4ef6\u7c7b\u578b\u3002</li> </ol>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_13","title":"\u793a\u4f8b\u6620\u5c04\u8868\uff1a","text":"\u7ec4\u540d \u539f\u6587\u4ef6\u540d \u65b0\u6587\u4ef6\u540d \u6587\u4ef6\u987a\u5e8f \u54c8\u5e0c\u503c \u52a0\u5bc6\u5bc6\u94a5/\u52a0\u5bc6\u4fe1\u606f \u5206\u5757\u4fe1\u606f \u6587\u4ef6\u7c7b\u578b/\u6269\u5c55\u540d Group1 \u6d4b\u8bd5\u6587\u4ef60001.txt fk23432_2343.enc 1 3d20e355a2b9ed3fd1621fd3b6a83572 AES Key: abc123 \u65e0 .txt Group1 \u6d4b\u8bd5\u6587\u4ef60002.txt zxmnm823mnvcn.enc 2 d3486ae9136e7856bc42212385ea7970 AES Key: abc123 \u65e0 .txt Group1 \u6d4b\u8bd5\u6587\u4ef60003.txt qwerty09876.enc 3 9e107d9d372bb6826bd81d3542a419d6 AES Key: abc123 \u65e0 .txt Group1 \u6d4b\u8bd5\u6587\u4ef60004.txt abcdefghi123.enc 4 e4da3b7fbbce2345d7772b0674a318d5 AES Key: abc123 \u57571, \u57572 (\u52a0\u5bc6\u4fe1\u606f) .txt Group1 \u6d4b\u8bd5\u6587\u4ef60005.jpg pqrstuv12345.enc 5 f7c3bc1d808e04732adf679965ccc34ca7ae RSA Key: 2048-bit \u65e0 .jpg"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_14","title":"\u5b57\u6bb5\u89e3\u91ca\uff1a","text":"<ol> <li>\u7ec4\u540d\uff1a\u6bcf\u4e2a\u6587\u4ef6\u53ef\u4ee5\u5c5e\u4e8e\u4e00\u4e2a\u7279\u5b9a\u7684\u7ec4\uff0c\u4fbf\u4e8e\u7ba1\u7406\u548c\u533a\u5206\u4e0d\u540c\u7c7b\u578b\u7684\u6587\u4ef6\u3002</li> <li>\u539f\u6587\u4ef6\u540d\uff1a\u8bb0\u5f55\u6587\u4ef6\u7684\u539f\u59cb\u540d\u79f0\uff0c\u4fbf\u4e8e\u8ffd\u6eaf\u6587\u4ef6\u6765\u6e90\u548c\u5185\u5bb9\u3002</li> <li>\u65b0\u6587\u4ef6\u540d\uff1a\u751f\u6210\u7684\u968f\u673a\u6587\u4ef6\u540d\uff0c\u5e76\u5e26\u6709\u6269\u5c55\u540d <code>.enc</code> \u8868\u793a\u8be5\u6587\u4ef6\u5df2\u88ab\u52a0\u5bc6\u3002</li> <li>\u6587\u4ef6\u987a\u5e8f\uff1a\u8bb0\u5f55\u6587\u4ef6\u7684\u539f\u59cb\u987a\u5e8f\uff0c\u786e\u4fdd\u5728\u9700\u8981\u65f6\u80fd\u591f\u6309\u6b63\u786e\u7684\u987a\u5e8f\u64ad\u653e\u6216\u5904\u7406\u6587\u4ef6\u3002</li> <li>\u54c8\u5e0c\u503c\uff1a\u7528\u4e8e\u9a8c\u8bc1\u6587\u4ef6\u5b8c\u6574\u6027\uff0c\u786e\u4fdd\u6587\u4ef6\u5185\u5bb9\u672a\u88ab\u7be1\u6539\u3002\u6bcf\u4e2a\u6587\u4ef6\u7684\u54c8\u5e0c\u503c\u662f\u552f\u4e00\u7684\uff0c\u5373\u4f7f\u6587\u4ef6\u540d\u6539\u53d8\uff0c\u54c8\u5e0c\u503c\u4e5f\u4e0d\u4f1a\u53d8\u3002</li> <li>\u52a0\u5bc6\u5bc6\u94a5/\u52a0\u5bc6\u4fe1\u606f\uff1a\u5982\u679c\u6587\u4ef6\u662f\u901a\u8fc7\u5bf9\u79f0\u52a0\u5bc6\u65b9\u5f0f\u52a0\u5bc6\u7684\uff0c\u53ef\u4ee5\u8bb0\u5f55\u52a0\u5bc6\u5bc6\u94a5\u3002\u5982\u679c\u662f\u975e\u5bf9\u79f0\u52a0\u5bc6\uff0c\u53ef\u4ee5\u8bb0\u5f55\u516c\u94a5/\u79c1\u94a5\u7684\u76f8\u5173\u4fe1\u606f\u3002</li> <li>\u5206\u5757\u4fe1\u606f\uff1a\u5982\u679c\u6587\u4ef6\u88ab\u5206\u5272\u4e3a\u591a\u4e2a\u5757\u5e76\u52a0\u5bc6\uff0c\u8fd9\u91cc\u8bb0\u5f55\u6bcf\u4e2a\u5757\u7684\u5e8f\u53f7\u4ee5\u53ca\u76f8\u5e94\u7684\u52a0\u5bc6\u4fe1\u606f\uff0c\u4ee5\u786e\u4fdd\u5728\u6062\u590d\u65f6\u80fd\u591f\u6b63\u786e\u62fc\u88c5\u6587\u4ef6\u3002</li> <li>\u6587\u4ef6\u7c7b\u578b/\u6269\u5c55\u540d\uff1a\u8bb0\u5f55\u6587\u4ef6\u7684\u539f\u59cb\u7c7b\u578b\uff0c\u4ee5\u4fbf\u5728\u89e3\u5bc6\u548c\u8fd8\u539f\u65f6\u80fd\u591f\u6b63\u786e\u8bc6\u522b\u6587\u4ef6\u683c\u5f0f\u3002</li> </ol>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_15","title":"\u603b\u7ed3\uff1a","text":"<p>\u8fd9\u5f20\u6620\u5c04\u8868\u56ca\u62ec\u4e86\u6240\u6709\u5fc5\u8981\u7684\u4fe1\u606f\uff0c\u4f7f\u5f97\u5373\u4fbf\u6587\u4ef6\u540d\u548c\u5185\u5bb9\u88ab\u52a0\u5bc6\u5e76\u968f\u673a\u5316\uff0c\u4ecd\u7136\u80fd\u591f\u901a\u8fc7\u6620\u5c04\u8868\u6062\u590d\u6587\u4ef6\u7684\u987a\u5e8f\u3001\u7c7b\u578b\u548c\u5185\u5bb9\u3002\u4f60\u53ef\u4ee5\u6839\u636e\u9700\u6c42\u5c06\u8fd9\u4e9b\u4fe1\u606f\u5b58\u50a8\u5728 CSV \u6587\u4ef6\u6216\u6570\u636e\u5e93\u4e2d\uff0c\u4ee5\u786e\u4fdd\u7ba1\u7406\u548c\u67e5\u8be2\u7684\u4fbf\u6377\u6027\u3002\u5982\u679c\u6587\u4ef6\u5757\u6570\u91cf\u8f83\u591a\uff0c\u6700\u597d\u4f7f\u7528\u4e00\u4e2a\u6570\u636e\u5e93\u6765\u8fdb\u884c\u9ad8\u6548\u7ba1\u7406\u3002</p>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_16","title":"\u5173\u4e8e\u5206\u5757\u7684\u89e3\u91ca","text":"<p>\u56e0\u4e3a\u6d4b\u8bd5\u6587\u4ef60004.txt\u7ecf\u8fc7\u4e86\u5206\u5757\u5904\u7406\uff0c\u88ab\u5206\u5272\u4e3a\u591a\u4e2a\u52a0\u5bc6\u5757\uff0c\u56e0\u6b64\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u5b83\u5c06\u663e\u793a\u4e3a\u591a\u4e2a\u72ec\u7acb\u7684\u6587\u4ef6\u5757\u3002\u5982\u679c\u4f60\u5c06\u6bcf\u4e2a\u5206\u5757\u5b58\u50a8\u4e3a\u5355\u72ec\u7684\u6587\u4ef6\uff0c\u90a3\u4e48\u5b9e\u9645\u4e0a\u6574\u4e2a\u6587\u4ef6\u7cfb\u7edf\u4e2d\u5c06\u591a\u51fa\u51e0\u4e2a\u6587\u4ef6\u3002</p>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_17","title":"\u89e3\u91ca\uff1a","text":"<ul> <li>\u6d4b\u8bd5\u6587\u4ef60004.txt\u5728\u6620\u5c04\u8868\u4e2d\u8bb0\u5f55\u4e3a\u5206\u5757\u7684\u6587\u4ef6\uff0c\u5373\u201c\u57571\u201d\u548c\u201c\u57572\u201d\u3002\u8fd9\u610f\u5473\u7740\u6587\u4ef6\u88ab\u62c6\u5206\u4e3a\u4e24\u4e2a\u5757\uff0c\u5e76\u4e14\u6bcf\u4e2a\u5757\u5355\u72ec\u8fdb\u884c\u4e86\u52a0\u5bc6\u3002</li> <li>\u8fd9\u6837\u5904\u7406\u540e\uff0c\u6587\u4ef6\u7cfb\u7edf\u4e2d\u4f1a\u6709\u4e24\u4e2a\u72ec\u7acb\u7684\u6587\u4ef6\u5757\uff0c\u5206\u522b\u5bf9\u5e94\u4e8e\u201c\u57571\u201d\u548c\u201c\u57572\u201d\u3002</li> </ul>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_18","title":"\u663e\u793a\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u60c5\u51b5\uff1a","text":"<p>\u5047\u8bbe\u4f60\u5bf9\u201c\u6d4b\u8bd5\u6587\u4ef60004.txt\u201d\u8fdb\u884c\u4e86\u5206\u5757\u5e76\u4fdd\u5b58\u4e3a\u4e24\u4e2a\u52a0\u5bc6\u5757\uff0c\u90a3\u4e48\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u5b9e\u9645\u663e\u793a\u7684\u5c06\u662f 6\u4e2a\u6587\u4ef6\uff0c\u5176\u4e2d\u201c\u6d4b\u8bd5\u6587\u4ef60004.txt\u201d\u5c06\u5bf9\u5e942\u4e2a\u6587\u4ef6\u5757\u3002\u4f8b\u5982\uff1a</p> <pre><code>/\u6587\u4ef6\u5757\u6587\u4ef6\u5939/\n    fk23432_2343.enc      (\u6d4b\u8bd5\u6587\u4ef60001\u7684\u52a0\u5bc6\u6587\u4ef6)\n    zxmnm823mnvcn.enc     (\u6d4b\u8bd5\u6587\u4ef60002\u7684\u52a0\u5bc6\u6587\u4ef6)\n    qwerty09876.enc       (\u6d4b\u8bd5\u6587\u4ef60003\u7684\u52a0\u5bc6\u6587\u4ef6)\n    abcdefghi123_part1.enc  (\u6d4b\u8bd5\u6587\u4ef60004\u7684\u52a0\u5bc6\u57571)\n    abcdefghi123_part2.enc  (\u6d4b\u8bd5\u6587\u4ef60004\u7684\u52a0\u5bc6\u57572)\n    pqrstuv12345.enc      (\u6d4b\u8bd5\u6587\u4ef60005\u7684\u52a0\u5bc6\u6587\u4ef6)\n</code></pre>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_19","title":"\u8865\u5145\u6620\u5c04\u8868\uff1a","text":"<p>\u5728\u6620\u5c04\u8868\u4e2d\uff0c\u5206\u5757\u7684\u4fe1\u606f\u4e5f\u5e94\u53cd\u6620\u5728\u6bcf\u4e2a\u6587\u4ef6\u7684\u8bb0\u5f55\u4e0a\u3002\u5177\u4f53\u5230\u201c\u6d4b\u8bd5\u6587\u4ef60004.txt\u201d\u7684\u60c5\u51b5\uff0c\u6620\u5c04\u8868\u53ef\u80fd\u5982\u4e0b\uff1a</p> \u7ec4\u540d \u539f\u6587\u4ef6\u540d \u65b0\u6587\u4ef6\u540d \u6587\u4ef6\u987a\u5e8f \u54c8\u5e0c\u503c \u52a0\u5bc6\u5bc6\u94a5/\u52a0\u5bc6\u4fe1\u606f \u5206\u5757\u4fe1\u606f \u6587\u4ef6\u7c7b\u578b/\u6269\u5c55\u540d Group1 \u6d4b\u8bd5\u6587\u4ef60001.txt fk23432_2343.enc 1 3d20e355a2b9ed3fd1621fd3b6a83572 AES Key: abc123 \u65e0 .txt Group1 \u6d4b\u8bd5\u6587\u4ef60002.txt zxmnm823mnvcn.enc 2 d3486ae9136e7856bc42212385ea7970 AES Key: abc123 \u65e0 .txt Group1 \u6d4b\u8bd5\u6587\u4ef60003.txt qwerty09876.enc 3 9e107d9d372bb6826bd81d3542a419d6 AES Key: abc123 \u65e0 .txt Group1 \u6d4b\u8bd5\u6587\u4ef60004.txt abcdefghi123_part1.enc 4 e4da3b7fbbce2345d7772b0674a318d5 AES Key: abc123 \u57571\uff0c\u5206\u5757\u5927\u5c0f: 1MB .txt Group1 \u6d4b\u8bd5\u6587\u4ef60004.txt abcdefghi123_part2.enc 4 e4da3b7fbbce2345d7772b0674a318d5 AES Key: abc123 \u57572\uff0c\u5206\u5757\u5927\u5c0f: 1MB .txt Group1 \u6d4b\u8bd5\u6587\u4ef60005.jpg pqrstuv12345.enc 5 f7c3bc1d808e04732adf679965ccc34ca7ae RSA Key: 2048-bit \u65e0 .jpg"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_20","title":"\u603b\u7ed3\uff1a","text":"<ul> <li>\u6587\u4ef6\u7cfb\u7edf\u4e2d\u589e\u52a0\u7684\u6587\u4ef6\u6570\uff1a\u7531\u4e8e\u6587\u4ef6\u88ab\u5206\u5757\uff0c\u539f\u672c\u4e00\u4e2a\u6587\u4ef6\uff08\u5982\u201c\u6d4b\u8bd5\u6587\u4ef60004.txt\u201d\uff09\u73b0\u5728\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u663e\u793a\u4e3a\u4e24\u4e2a\u72ec\u7acb\u7684\u6587\u4ef6\u5757\uff0c\u5373 <code>abcdefghi123_part1.enc</code> \u548c <code>abcdefghi123_part2.enc</code>\u3002</li> <li>\u6620\u5c04\u8868\u8bb0\u5f55\uff1a\u6620\u5c04\u8868\u4e2d\u9700\u8981\u53cd\u6620\u6bcf\u4e2a\u6587\u4ef6\u7684\u5206\u5757\u4fe1\u606f\uff0c\u786e\u4fdd\u80fd\u591f\u6b63\u786e\u6062\u590d\u6587\u4ef6\u3002</li> <li>\u6587\u4ef6\u603b\u6570\uff1a\u539f\u672c 5 \u4e2a\u6587\u4ef6\uff0c\u7531\u4e8e\u5206\u5757\uff0c\u73b0\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u663e\u793a\u4e3a 6 \u4e2a\u6587\u4ef6\u3002</li> </ul> <p>\u5f53\u4f60\u5c06\u6587\u4ef6\u52a0\u5bc6\u5e76\u751f\u6210\u968f\u673a\u6587\u4ef6\u540d\u540e\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5757\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u8868\u73b0\u5f62\u5f0f\u4e0e\u666e\u901a\u6587\u4ef6\u6ca1\u6709\u672c\u8d28\u4e0a\u7684\u533a\u522b\uff0c\u5b83\u4eec\u4f9d\u7136\u662f\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u8bc6\u522b\u7684\u6587\u4ef6\uff0c\u4f46\u5176\u6587\u4ef6\u540d\u3001\u6269\u5c55\u540d\u548c\u5185\u5bb9\u90fd\u5df2\u7ecf\u88ab\u6df7\u6dc6\u6216\u52a0\u5bc6\uff0c\u4f7f\u5f97\u5916\u4eba\u65e0\u6cd5\u76f4\u63a5\u901a\u8fc7\u540d\u79f0\u6216\u5185\u5bb9\u4e86\u89e3\u6587\u4ef6\u7684\u5b9e\u9645\u7528\u9014\u3002</p>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_21","title":"\u6587\u4ef6\u5757\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u8868\u73b0\uff1a","text":"<ol> <li> <p>\u6587\u4ef6\u540d\u79f0\uff1a</p> </li> <li> <p>\u4f60\u5df2\u7ecf\u5c06\u6587\u4ef6\u7684\u540d\u79f0\u968f\u673a\u5316\uff0c\u6bd4\u5982 <code>fk23432_2343.enc</code>\u3001<code>zxmnm823mnvcn.enc</code> \u7b49\uff0c\u8fd9\u4e9b\u540d\u79f0\u770b\u4f3c\u65e0\u89c4\u5f8b\uff0c\u5916\u4eba\u65e0\u6cd5\u901a\u8fc7\u6587\u4ef6\u540d\u63a8\u65ad\u51fa\u4efb\u4f55\u6709\u7528\u4fe1\u606f\u3002</p> </li> <li>\u6587\u4ef6\u540d\u53ef\u80fd\u4e0d\u518d\u53cd\u6620\u6587\u4ef6\u7684\u771f\u5b9e\u5185\u5bb9\u6216\u683c\u5f0f\uff08\u5982 <code>.txt</code>\u3001<code>.jpg</code> \u7b49\uff09\uff0c\u800c\u662f\u4f60\u81ea\u884c\u5b9a\u4e49\u7684\u968f\u673a\u547d\u540d\u65b9\u5f0f\u548c\u6269\u5c55\u540d\uff08\u5982 <code>.enc</code> \u8868\u793a\u5df2\u52a0\u5bc6\uff09\u3002</li> <li> <p>\u6587\u4ef6\u5185\u5bb9\uff1a</p> </li> <li> <p>\u6587\u4ef6\u7684\u5185\u5bb9\u5df2\u7ecf\u7ecf\u8fc7\u52a0\u5bc6\u5904\u7406\uff0c\u56e0\u6b64\u5728\u666e\u901a\u7684\u6587\u672c\u7f16\u8f91\u5668\u6216\u67e5\u770b\u5de5\u5177\u4e2d\u4f1a\u663e\u793a\u4e3a\u65e0\u610f\u4e49\u7684\u4e71\u7801\u6216\u4e8c\u8fdb\u5236\u6570\u636e\u3002</p> </li> <li>\u5373\u4f7f\u6709\u4eba\u83b7\u53d6\u4e86\u8fd9\u4e9b\u6587\u4ef6\uff0c\u6253\u5f00\u540e\u4e5f\u53ea\u4f1a\u770b\u5230\u52a0\u5bc6\u540e\u7684\u6570\u636e\u6d41\uff0c\u65e0\u6cd5\u83b7\u53d6\u6587\u4ef6\u7684\u539f\u59cb\u4fe1\u606f\u3002</li> <li> <p>\u6587\u4ef6\u5927\u5c0f\uff1a</p> </li> <li> <p>\u52a0\u5bc6\u540e\u7684\u6587\u4ef6\u5927\u5c0f\u901a\u5e38\u4f1a\u7a0d\u5fae\u5927\u4e8e\u539f\u6587\u4ef6\u5927\u5c0f\uff08\u53d6\u51b3\u4e8e\u52a0\u5bc6\u7b97\u6cd5\uff09\uff0c\u4f46\u5bf9\u4e8e\u5206\u5757\u52a0\u5bc6\u7684\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5757\u7684\u5927\u5c0f\u53ef\u4ee5\u7531\u4f60\u81ea\u884c\u63a7\u5236\u3002</p> </li> <li>\u5982\u679c\u4f60\u5bf9\u6587\u4ef6\u8fdb\u884c\u4e86\u5206\u5757\u5904\u7406\uff0c\u6587\u4ef6\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u53ef\u80fd\u4f1a\u5206\u4e3a\u591a\u4e2a\u90e8\u5206\uff0c\u6bcf\u4e2a\u90e8\u5206\u4ee3\u8868\u539f\u6587\u4ef6\u7684\u4e00\u4e2a\u52a0\u5bc6\u5757\u3002</li> </ol>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_22","title":"\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u7ed3\u6784\u4e3e\u4f8b\uff1a","text":"<p>\u5047\u8bbe\u4f60\u6709\u4e00\u4e2a\u5305\u542b\u591a\u4e2a\u52a0\u5bc6\u6587\u4ef6\u5757\u7684\u6587\u4ef6\u5939\uff0c\u7ed3\u6784\u53ef\u80fd\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>/\u6587\u4ef6\u5757\u6587\u4ef6\u5939/\n    fk23432_2343.enc      (\u5df2\u52a0\u5bc6\u6587\u4ef6\u5757)\n    zxmnm823mnvcn.enc     (\u5df2\u52a0\u5bc6\u6587\u4ef6\u5757)\n    abcdefghi123.enc      (\u5df2\u52a0\u5bc6\u6587\u4ef6\u5757)\n    pqrstuv12345.enc      (\u5df2\u52a0\u5bc6\u6587\u4ef6\u5757)\n    ...\n</code></pre>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_23","title":"\u6587\u4ef6\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u53ef\u89c1\u6027\uff1a","text":"<ol> <li> <p>\u666e\u901a\u7528\u6237/\u5916\u90e8\u7528\u6237\u7684\u89c6\u89d2\uff1a</p> </li> <li> <p>\u5916\u4eba\u6253\u5f00\u6587\u4ef6\u5939\u65f6\uff0c\u53ea\u80fd\u770b\u5230\u968f\u673a\u540d\u79f0\u7684\u6587\u4ef6\uff0c\u5e76\u4e14\u6587\u4ef6\u7684\u6269\u5c55\u540d\u662f\u4f60\u81ea\u5b9a\u4e49\u7684\uff08\u5982 <code>.enc</code>\uff09\u3002</p> </li> <li>\u5916\u4eba\u5373\u4f7f\u5c1d\u8bd5\u6253\u5f00\u8fd9\u4e9b\u6587\u4ef6\uff0c\u770b\u5230\u7684\u4e5f\u662f\u52a0\u5bc6\u540e\u7684\u6570\u636e\uff0c\u65e0\u6cd5\u76f4\u63a5\u83b7\u53d6\u4efb\u4f55\u6709\u610f\u4e49\u7684\u4fe1\u606f\u3002</li> <li>\u6587\u4ef6\u540d\u3001\u6269\u5c55\u540d\u548c\u5185\u5bb9\u65e0\u6cd5\u53cd\u6620\u6587\u4ef6\u7684\u5b9e\u9645\u5185\u5bb9\u6216\u7ed3\u6784\u3002</li> <li> <p>\u901a\u8fc7\u6620\u5c04\u8868\u6062\u590d\u6587\u4ef6\uff1a</p> </li> <li> <p>\u53ea\u6709\u901a\u8fc7\u4f60\u751f\u6210\u7684\u6620\u5c04\u8868\uff0c\u624d\u80fd\u5c06\u8fd9\u4e9b\u968f\u673a\u6587\u4ef6\u540d\u4e0e\u539f\u6587\u4ef6\u540d\u5bf9\u5e94\u8d77\u6765\uff0c\u5e76\u901a\u8fc7\u6b63\u786e\u7684\u89e3\u5bc6\u5bc6\u94a5\u8fd8\u539f\u6587\u4ef6\u7684\u771f\u5b9e\u5185\u5bb9\u3002</p> </li> <li>\u6587\u4ef6\u7684\u987a\u5e8f\u3001\u5206\u7ec4\u3001\u539f\u59cb\u540d\u79f0\u4ee5\u53ca\u7c7b\u578b\u4fe1\u606f\u90fd\u4f9d\u8d56\u4e8e\u6620\u5c04\u8868\u6765\u6062\u590d\u3002</li> </ol>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_24","title":"\u6587\u4ef6\u5757\u7684\u64cd\u4f5c\u6027\uff1a","text":"<ul> <li>\u6b63\u5e38\u64cd\u4f5c\uff1a\u4f60\u4f9d\u7136\u53ef\u4ee5\u5bf9\u8fd9\u4e9b\u6587\u4ef6\u6267\u884c\u5e38\u89c4\u64cd\u4f5c\uff0c\u5982\u590d\u5236\u3001\u79fb\u52a8\u3001\u5220\u9664\u7b49\u3002\u6587\u4ef6\u7cfb\u7edf\u4f1a\u628a\u5b83\u4eec\u5f53\u4f5c\u666e\u901a\u6587\u4ef6\u5bf9\u5f85\u3002</li> <li>\u4f20\u8f93\u5b89\u5168\u6027\uff1a\u7531\u4e8e\u6587\u4ef6\u5df2\u7ecf\u88ab\u52a0\u5bc6\uff0c\u5373\u4fbf\u5728\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u88ab\u622a\u83b7\uff0c\u4e5f\u65e0\u6cd5\u76f4\u63a5\u8bfb\u53d6\u5185\u5bb9\u3002</li> <li>\u8fdb\u4e00\u6b65\u4f2a\u88c5\uff1a\u4f60\u8fd8\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u6587\u4ef6\u7684\u6269\u5c55\u540d\uff08\u5982 <code>.bin</code>\u3001<code>.dat</code>\uff09\u6765\u8fdb\u4e00\u6b65\u4f2a\u88c5\u8fd9\u4e9b\u6587\u4ef6\uff0c\u4f7f\u5b83\u4eec\u770b\u8d77\u6765\u50cf\u662f\u65e0\u5173\u7684\u6570\u636e\u6587\u4ef6\uff0c\u751a\u81f3\u4f7f\u7528\u9690\u5199\u672f\u5c06\u6587\u4ef6\u9690\u85cf\u5728\u56fe\u7247\u6216\u5176\u4ed6\u5a92\u4f53\u6587\u4ef6\u4e2d\u3002</li> </ul>"},{"location":"notes/%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%AE%BE%E8%AE%A1.html#_25","title":"\u603b\u7ed3\uff1a","text":"<p>\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u52a0\u5bc6\u540e\u7684\u6587\u4ef6\u5757\u8868\u73b0\u4e3a\u4e00\u7ec4\u968f\u673a\u547d\u540d\u7684\u6587\u4ef6\uff0c\u5916\u4eba\u65e0\u6cd5\u901a\u8fc7\u540d\u79f0\u6216\u5185\u5bb9\u8bc6\u522b\u51fa\u5b83\u4eec\u7684\u5b9e\u9645\u7528\u9014\u6216\u987a\u5e8f\u3002\u4f60\u9700\u8981\u4f9d\u9760\u6620\u5c04\u8868\u548c\u52a0\u5bc6\u5bc6\u94a5\u6765\u6062\u590d\u6587\u4ef6\u7684\u539f\u59cb\u5185\u5bb9\u548c\u987a\u5e8f\u3002\u6574\u4e2a\u8fc7\u7a0b\u786e\u4fdd\u4e86\u6587\u4ef6\u7684\u5b89\u5168\u6027\u548c\u9690\u79c1\u4fdd\u62a4\u3002</p>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html","title":"\u4e09\u9879\u76ee\u590d\u73b0\u4e0e\u91cd\u6784\u65b9\u6848\uff1aclock\u3001pc_monitor\u3001paddleocrproject","text":"<p>\u66f4\u65b0\u65f6\u95f4\uff1a2025-11-11  \u4f5c\u8005\uff1aLifu</p>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_1","title":"\u80cc\u666f\u4e0e\u76ee\u6807","text":"<ul> <li>\u76ee\u6807\uff1a\u57fa\u4e8e\u73b0\u6709\u4e09\u4e2a\u9879\u76ee\uff08clock\u3001pc_monitor\u3001paddleocrproject\uff09\u7684\u6587\u6863\u4e0e\u4ee3\u7801\u7ed3\u6784\uff0c\u5236\u5b9a\u4e00\u4efd\u201c\u53ef\u64cd\u4f5c\u3001\u53ef\u590d\u73b0\u3001\u53ef\u91cd\u6784\u201d\u7684\u5b9e\u65bd\u65b9\u6848\uff0c\u540e\u7eed\u53ef\u6309\u672c\u6587\u4e00\u6b65\u6b65\u590d\u73b0\u5b9e\u4f8b\u6216\u5bf9\u539f\u9879\u76ee\u8fdb\u884c\u5de5\u7a0b\u5316\u91cd\u6784\u3002</li> <li>\u4ea4\u4ed8\u7269\uff1a</li> <li>\u53ef\u6210\u529f\u8fd0\u884c\u7684\u4e09\u9879\u76ee\u6700\u5c0f\u53ef\u7528\u7248\u672c\uff08MVP\uff09\u4e0e\u6838\u5fc3\u529f\u80fd\u6e05\u5355</li> <li>\u6807\u51c6\u5316\u7684\u73af\u5883/\u4f9d\u8d56/\u8fd0\u884c\u811a\u672c</li> <li>\u57fa\u4e8e\u5355\u5143\u6d4b\u8bd5\u4e0e\u624b\u52a8\u9a8c\u6536\u6e05\u5355\u7684\u9a8c\u8bc1\u7ed3\u679c</li> <li>\u91cd\u6784\u8def\u7ebf\u56fe\uff08\u9636\u6bb5\u5212\u5206\u4e0e\u4f18\u5148\u7ea7\uff09</li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_2","title":"\u901a\u7528\u73af\u5883\u4e0e\u7ea6\u5b9a","text":"<ul> <li>\u64cd\u4f5c\u7cfb\u7edf\uff1aWindows 10/11</li> <li>Python\uff1a\u5efa\u8bae 3.10+\uff08\u6309\u9879\u76ee\u6700\u4f4e\u8981\u6c42\u517c\u5bb9\u8c03\u6574\uff09</li> <li>\u865a\u62df\u73af\u5883\uff1a<code>python -m venv .venv</code>\uff0c\u6fc0\u6d3b\u540e\u5b89\u88c5\u4f9d\u8d56</li> <li>\u76ee\u5f55\u7ea6\u5b9a\uff1a</li> <li>clock\uff1a<code>C:\\Users\\YourName\\clock</code></li> <li>pc_monitor\uff1a<code>C:\\Users\\YourName\\code\\cmd\\pc_monitor</code></li> <li>paddleocrproject\uff1a<code>C:\\Users\\YourName\\code\\paddleocrproject</code></li> <li>\u4f9d\u8d56\u5b89\u88c5\u4e00\u5f8b\u5728\u865a\u62df\u73af\u5883\u4e2d\u8fdb\u884c\uff0c\u907f\u514d\u6c61\u67d3\u5168\u5c40</li> <li>\u7edf\u4e00\u65e5\u5fd7\u4e0e\u914d\u7f6e\u4f4d\u7f6e\uff0c\u5c3d\u91cf\u4e0d\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u8fd0\u884c</li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#clockgui","title":"\u9879\u76ee\u4e00\uff1aclock\uff08\u9632\u7761\u7720/\u6258\u76d8/GUI\uff09","text":""},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#1","title":"1) \u9879\u76ee\u6982\u8ff0","text":"<ul> <li>\u76ee\u7684\uff1a\u9632\u6b62\u7cfb\u7edf\u4f11\u7720\uff08\u79fb\u52a8\u9f20\u6807/\u7cfb\u7edfAPI\uff09\uff0c\u63d0\u4f9b GUI \u4e0e CLI\uff0c\u96c6\u6210\u7cfb\u7edf\u6258\u76d8\u63a7\u5236\u4e0e\u4efb\u52a1\u680f\u81ea\u52a8\u9690\u85cf\u8bbe\u7f6e\uff0c\u542b\u65e5\u5fd7\u4e0e\u914d\u7f6e\u7ba1\u7406\u3002</li> <li>\u5173\u952e\u6a21\u5757\uff08\u81ea\u68c0\u81ea\u63cf\u8ff0\uff09\uff1a</li> <li>keep_awake_core.py\uff1a\u9632\u7761\u7720\u6838\u5fc3\u903b\u8f91\uff08\u5b9a\u65f6\u5668/\u65b9\u6cd5\u9009\u62e9\uff09</li> <li>keep_awake_gui.py / keep_awake_cli.py\uff1aGUI \u4e0e\u547d\u4ee4\u884c\u5165\u53e3</li> <li>config_manager.py\uff1a\u914d\u7f6e\u52a0\u8f7d/\u4fdd\u5b58\uff08\u9ed8\u8ba4\u4e0e\u517c\u5bb9\uff09</li> <li>log_manager.py\uff1a\u65e5\u5fd7\u8f93\u51fa\uff08\u63a7\u5236\u53f0/\u6587\u4ef6\uff09</li> <li>taskbar_manager.py\uff1a\u4efb\u52a1\u680f\u81ea\u52a8\u9690\u85cf\u5f00\u5173\uff08\u6ce8\u518c\u8868 + Explorer \u91cd\u542f\uff09</li> <li>system_activity_checker.py / power_activity_analyzer.py\uff1a\u7cfb\u7edf/\u7535\u6e90\u6d3b\u52a8\u68c0\u6d4b</li> <li>\u542f\u52a8\u811a\u672c\uff1astart_gui.bat\u3001start_cli.bat\uff1b\u56fe\u6807 keepico.ico</li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#2","title":"2) \u73af\u5883\u4e0e\u4f9d\u8d56","text":"<ul> <li>requirements.txt\uff08\u6458\u8981\uff09\uff1a</li> <li>PyQt6&gt;=6.4.0\uff08GUI\uff09</li> <li>\u53ef\u9009\uff1apyautogui\uff08\u66f4\u5f3a\u9f20\u6807\u63a7\u5236\uff09</li> <li>\u5b89\u88c5\uff1a</li> <li>\u521b\u5efa\u5e76\u6fc0\u6d3b venv</li> <li><code>pip install -r requirements.txt</code></li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#3","title":"3) \u8fd0\u884c\u4e0e\u9a8c\u8bc1","text":"<ul> <li>GUI\uff1a<code>python keep_awake_gui.py</code></li> <li>CLI\uff1a<code>python keep_awake_cli.py</code>\uff08\u5982\u63d0\u4f9b\u5b50\u547d\u4ee4\uff1astart/stop/status\uff09</li> <li>\u6258\u76d8\u9a8c\u8bc1\uff1a\u5173\u95ed\u7a97\u53e3\u5e94\u6700\u5c0f\u5316\u5230\u6258\u76d8\uff1b\u53cc\u51fb\u6258\u76d8\u56fe\u6807\u6062\u590d</li> <li>\u4efb\u52a1\u680f\u81ea\u52a8\u9690\u85cf\uff1aGUI \u52fe\u9009\u540e\u5e94\u7acb\u5373\u751f\u6548\uff08\u5fc5\u8981\u65f6\u91cd\u542f Explorer\uff09</li> <li>\u65e5\u5fd7\u9a8c\u8bc1\uff1a\u6eda\u52a8\u7b56\u7565\u3001\u751f\u5b58\u671f\u4e0e\u9519\u8bef\u8bb0\u5f55</li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#4","title":"4) \u91cd\u6784/\u590d\u73b0\u8ba1\u5212\uff08\u5efa\u8bae\u91cc\u7a0b\u7891\uff09","text":"<ul> <li>M1 \u6700\u5c0f\u53ef\u7528\uff081-2 \u5929\uff09</li> <li>\u590d\u73b0 core + CLI\uff1b\u652f\u6301\u4e24\u79cd\u9632\u7761\u7720\u65b9\u6cd5\uff1b\u901a\u8fc7\u65e5\u5fd7\u81ea\u68c0</li> <li>\u914d\u7f6e\u9ed8\u8ba4\u503c\u4e0e\u517c\u5bb9\u5904\u7406\uff1b\u6dfb\u52a0\u57fa\u672c\u5355\u6d4b\uff08\u6838\u5fc3\u5b9a\u65f6\u5668/\u72b6\u6001\uff09</li> <li>M2 GUI \u4e0e\u6258\u76d8\uff081-3 \u5929\uff09</li> <li>\u590d\u73b0 GUI \u4e3b\u9762\u677f\u4e0e\u6258\u76d8\u83dc\u5355\uff1b\u96c6\u6210 start/stop/\u72b6\u6001\u663e\u793a</li> <li>\u5f15\u5165 taskbar_manager\uff0c\u63d0\u4f9b\u81ea\u52a8\u9690\u85cf\u5f00\u5173\uff1b\u5f02\u5e38\u8def\u5f84\u5f39\u7a97 + \u65e5\u5fd7</li> <li>M3 \u5de5\u7a0b\u5316\uff081-2 \u5929\uff09</li> <li>\u65e5\u5fd7\u6eda\u52a8\u4e0e\u7b49\u7ea7\u7edf\u4e00\uff1b\u6253\u5305\u811a\u672c\uff08pyinstaller \u53ef\u9009\uff09</li> <li>\u5b8c\u6574 README + \u793a\u4f8b\u914d\u7f6e\uff1b\u9519\u8bef\u77e9\u9635\u4e0e\u6392\u969c\u6307\u5f15</li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#5","title":"5) \u9a8c\u6536\u6e05\u5355","text":"<ul> <li>30 \u5206\u949f\u7a33\u5b9a\u8fd0\u884c\uff0cCPU/\u5185\u5b58\u5360\u7528\u53ef\u63a5\u53d7</li> <li>\u4e24\u79cd\u9632\u7761\u7720\u65b9\u5f0f\u5747\u751f\u6548\uff1bGUI \u63a7\u4ef6\u4e0e\u6258\u76d8\u4ea4\u4e92\u6b63\u786e</li> <li>\u4efb\u52a1\u680f\u9690\u85cf/\u6062\u590d\u6210\u529f\u3001\u53ef\u6301\u4e45\u5316</li> <li>\u5355\u6d4b\u901a\u8fc7\uff08\u6838\u5fc3\u903b\u8f91\u3001\u914d\u7f6e\u3001\u5173\u952e\u5f02\u5e38\uff09</li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#pc_monitorgui","title":"\u9879\u76ee\u4e8c\uff1apc_monitor\uff08\u7535\u6e90/\u7cfb\u7edf/\u7f51\u7edc/\u76f8\u673a/\u62a5\u544a/GUI\uff09","text":""},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#1_1","title":"1) \u9879\u76ee\u6982\u8ff0","text":"<ul> <li>\u529f\u80fd\uff08\u6765\u6e90\uff1aREADME\uff09\uff1a</li> <li>\u7535\u6e90\u76d1\u63a7\uff08\u4ea4\u6d41/\u7535\u6c60\u3001\u62d4\u51fa\u4e8b\u4ef6\u3001\u4f4e\u7535\u91cf\u544a\u8b66\uff09</li> <li>\u7cfb\u7edf\u76d1\u63a7\uff08\u542f\u52a8/\u5173\u95ed\u3001\u8fd0\u884c\u65f6\u95f4\u3001CPU/\u5185\u5b58/\u78c1\u76d8\uff09</li> <li>\u7f51\u7edc\u76d1\u63a7\uff08DNS \u8fde\u901a\u6027\u68c0\u6d4b\uff09</li> <li>\u81ea\u52a8\u62cd\u7167\uff08\u4e8b\u4ef6\u89e6\u53d1\uff0c\u5ef6\u8fdf\u4e0e\u8d28\u91cf\u53ef\u914d\uff09</li> <li>\u65e5\u5fd7\u7cfb\u7edf\uff08\u8f6e\u8f6c/\u5927\u5c0f\u9650\u5236/\u591a\u7ea7\u522b\uff09</li> <li>\u62a5\u544a\u751f\u6210\uff08HTML\uff0c\u5305\u542b 24 \u5c0f\u65f6\u4e8b\u4ef6\u4e0e\u622a\u56fe\uff09</li> <li>GUI + \u6258\u76d8 + \u901a\u77e5\uff1b\u5b8c\u6574\u914d\u7f6e\u7ba1\u7406\u4e0e\u81ea\u542f\u52a8</li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#2_1","title":"2) \u76ee\u5f55\u4e0e\u6a21\u5757","text":"<pre><code>pc_monitor/\n\u251c\u2500\u2500 main.py               # \u5165\u53e3\n\u251c\u2500\u2500 config.json           # \u914d\u7f6e\n\u251c\u2500\u2500 requirements.txt      # \u4f9d\u8d56\n\u251c\u2500\u2500 config_manager.py     # \u914d\u7f6e\u7ba1\u7406\n\u251c\u2500\u2500 logger.py             # \u65e5\u5fd7\n\u251c\u2500\u2500 power_monitor.py      # \u7535\u6e90\u76d1\u63a7\n\u251c\u2500\u2500 system_monitor.py     # \u7cfb\u7edf\u76d1\u63a7\n\u251c\u2500\u2500 camera_capture.py     # \u76f8\u673a\n\u251c\u2500\u2500 report_generator.py   # \u62a5\u544a\n\u251c\u2500\u2500 gui.py                # GUI\n\u2514\u2500\u2500 autostart.py          # \u81ea\u542f\u52a8\n</code></pre>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#3_1","title":"3) \u73af\u5883\u4e0e\u4f9d\u8d56","text":"<ul> <li>\u5efa\u8bae Python 3.8+</li> <li><code>pip install -r requirements.txt</code></li> <li>Windows \u9996\u6b21\u8fd0\u884c\u9700\u5141\u8bb8\u76f8\u673a\u6743\u9650</li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#4_1","title":"4) \u8fd0\u884c\u4e0e\u9a8c\u8bc1","text":"<ul> <li><code>python main.py</code> \u6216 <code>start.bat</code></li> <li>\u4eea\u8868\u76d8\uff1a\u7535\u6e90/CPU/\u5185\u5b58/\u8fd0\u884c\u65f6\u957f/\u6700\u8fd1\u4e8b\u4ef6</li> <li>\u4e8b\u4ef6\u65e5\u5fd7\uff1a\u65f6\u95f4\u5e8f\u5217\u8868\uff1b\u5237\u65b0\u53ef\u89c1\u6700\u65b0</li> <li>\u62cd\u6444\u7167\u7247\uff1a\u5217\u8868\u4e0e\u201c\u6253\u5f00\u6587\u4ef6\u5939\u201d\uff1b\u4fdd\u5b58\u5230 captures/</li> <li>\u62a5\u544a\uff1a\u70b9\u51fb\u6309\u94ae\u6216\u5b9a\u65f6\u4efb\u52a1\u751f\u6210 HTML \u5230 reports/</li> <li>\u6258\u76d8\uff1a\u5173\u95ed\u7a97\u53e3 \u2192 \u6700\u5c0f\u5316\u5230\u6258\u76d8\uff1b\u53cc\u51fb\u6062\u590d\uff1b\u53f3\u952e\u83dc\u5355\u53ef\u9000\u51fa</li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#5_1","title":"5) \u91cd\u6784/\u590d\u73b0\u8ba1\u5212\uff08\u5efa\u8bae\u91cc\u7a0b\u7891\uff09","text":"<ul> <li>M1 \u6700\u5c0f\u53ef\u7528\uff081-2 \u5929\uff09</li> <li>\u4e8b\u4ef6\u603b\u7ebf + \u65e5\u5fd7\uff1b\u7535\u6e90/\u7cfb\u7edf/\u7f51\u7edc\u6700\u5c0f\u76d1\u63a7\uff1b\u76f8\u673a\u62cd\u7167\u6d41\u6c34\u7ebf</li> <li>\u914d\u7f6e\u4e0e\u9ed8\u8ba4\u503c\uff1b\u57fa\u7840 GUI \u9762\u677f\uff08\u72b6\u6001/\u65e5\u5fd7\uff09</li> <li>M2 \u62a5\u544a\u4e0e\u6258\u76d8\uff081-2 \u5929\uff09</li> <li>HTML \u62a5\u544a\u6a21\u677f\u4e0e\u751f\u6210\uff1b\u6258\u76d8\u4ea4\u4e92\u4e0e\u901a\u77e5\uff1b\u65e5\u5fd7\u8f6e\u8f6c</li> <li>M3 \u5065\u58ee\u6027\u4e0e\u751f\u6001\uff081-2 \u5929\uff09</li> <li>\u76f8\u673a\u5360\u7528/\u5f02\u5e38\u6062\u590d\uff1b\u81ea\u542f\u52a8/\u6743\u9650\u63d0\u793a\uff1b\u5355\u6d4b\u4e0e\u7aef\u5230\u7aef\u9a8c\u6536\u811a\u672c</li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#6","title":"6) \u9a8c\u6536\u6e05\u5355","text":"<ul> <li>\u7535\u6e90\u62d4\u51fa\u89e6\u53d1\u62cd\u7167\uff1b\u4f4e\u7535\u91cf\u544a\u8b66\u53ef\u89c1</li> <li>\u62a5\u544a\u6309\u65f6/\u6309\u9700\u53ef\u751f\u6210\uff0c\u5305\u542b\u622a\u56fe\u4e0e\u7edf\u8ba1</li> <li>\u65e5\u5fd7\u8f6e\u8f6c\u4e0e\u5927\u5c0f\u9650\u5236\u751f\u6548</li> <li>GUI/\u6258\u76d8\u4ea4\u4e92\u4e0e\u901a\u77e5\u53ef\u9760</li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#paddleocrprojectpdf-json-gui","title":"\u9879\u76ee\u4e09\uff1apaddleocrproject\uff08PDF \u2192 \u6587\u672c/JSON \u961f\u5217\u6279\u5904\u7406 + GUI \u76d1\u63a7\uff09","text":""},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#1-readme_md-md","title":"1) \u9879\u76ee\u6982\u8ff0\uff08\u6765\u6e90\uff1aREADME_\u4f7f\u7528\u8bf4\u660e.md / \u4f7f\u7528\u8bf4\u660e.md\uff09","text":"<ul> <li>\u4f7f\u547d\uff1a\u5728 CPU \u73af\u5883\u4e0b\u5bf9 PDF \u8fdb\u884c\u6279\u91cf OCR\uff0c\u8f93\u51fa txt \u4e0e\u9875\u811a/\u9875\u7801 JSON\uff1b\u63d0\u4f9b\u961f\u5217/\u76d1\u63a7/\u62a5\u544a\u80fd\u529b\uff1b\u4fee\u590d\u9ed1\u7a97\u53e3\u95ea\u70c1\uff08\u7edf\u4e00\u4f7f\u7528 pythonw + CREATE_NO_WINDOW\uff09\u3002</li> <li>\u4e3b\u8981\u76ee\u5f55\uff1a</li> <li>ocr_app\uff08CLI/\u6838\u5fc3\u903b\u8f91\uff0c\u5982 enqueue/run-worker/status/report \u7b49\uff09</li> <li>scripts\uff08gui_panel / run_batches / queue_monitor / sample_ocr / small_batch_test\uff09</li> <li>outputs\uff08pocr_txt\u3001runs/...\uff09/ logs\uff08worker/runner/monitor/failed\uff09/ state\uff08queue.db/pause.flag\uff09/ reports</li> <li>tests\uff08\u5e03\u5c40/\u53cc\u680f\u6392\u5e8f\u5355\u6d4b\uff09</li> <li>\u9876\u5c42\uff1arestart_gui.py / check_status.py / start_gui.py / start_worker.py</li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#2-cpu","title":"2) \u73af\u5883\u4e0e\u4f9d\u8d56\uff08CPU\uff09","text":"<pre><code>python -m venv .venv\n.\\.venv\\Scripts\\Activate.ps1\npython -m pip install -U pip\npython -m pip install -U paddlepaddle paddleocr pymupdf\npython -c \"import fitz; from paddleocr import PaddleOCR; print('OK')\"\n</code></pre>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#3_2","title":"3) \u5feb\u901f\u4f7f\u7528","text":"<ul> <li>\u542f\u52a8 GUI\uff1a<code>python restart_gui.py</code></li> <li>\u67e5\u770b\u72b6\u6001\uff1a<code>python check_status.py</code></li> <li>\u542f\u52a8 Worker\uff1a<code>python start_worker.py</code></li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#4-cli-ocr_app","title":"4) CLI \u5e38\u7528\u547d\u4ee4\uff08ocr_app\uff09","text":"<ul> <li>\u76ee\u5f55\u521d\u59cb\u5316\uff1a<code>.\\.venv\\Scripts\\python -m ocr_app.cli init</code></li> <li>\u5355\u6587\u4ef6 OCR\uff1a<code>.\\.venv\\Scripts\\python -m ocr_app.cli ocr-one --pdf &lt;file.pdf&gt; --zoom 1.6 --header-ratio 0.06 --footer-ratio 0.08</code></li> <li>\u5165\u961f\uff08\u53bb\u91cd\uff09\uff1a<code>.\\.venv\\Scripts\\python -m ocr_app.cli enqueue --dir yaodian_2bu --limit 200 --dedup</code></li> <li>\u8fd0\u884c Worker\uff1a<code>.\\.venv\\Scripts\\python -m ocr_app.cli run-worker --max-jobs 200 --zoom 1.6 --header-ratio 0.06 --footer-ratio 0.08 --job-timeout 240</code></li> <li>\u62a5\u544a\uff1a<code>.\\.venv\\Scripts\\python -m ocr_app.cli report --out reports/queue_speed_report.md --fold-by-name</code></li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#5_2","title":"5) \u8bbe\u8ba1\u8981\u70b9\uff08\u5df2\u5b9e\u73b0/\u9700\u590d\u73b0\uff09","text":"<ul> <li>GUI \u76d1\u63a7\uff1a500ms \u8ba1\u6570\u5237\u65b0 + 2s \u65e5\u5fd7\u805a\u5408\uff1b\u6253\u5f00\u76ee\u5f55/\u5e2e\u52a9\u83dc\u5355</li> <li>\u961f\u5217\u6a21\u578b\uff1aSQLite queue.db\uff1b\u53ef\u6682\u505c\uff08state/pause.flag\uff09\uff1brun_batches \u81ea\u52a8\u5206\u6279</li> <li>OCR \u7b56\u7565\uff1aPaddleOCR mobile\uff0cPyMuPDF \u6e32\u67d3\uff1b\u9875\u7709\u8fc7\u6ee4 header_ratio\uff1b\u9875\u811a\u6355\u83b7 footer_ratio \u2192 JSON</li> <li>\u65e5\u5fd7\uff1a\u63a7\u5236\u53f0 INFO + \u6587\u4ef6 DEBUG\uff08utf-8-sig\uff0cPowerShell 5 \u517c\u5bb9\uff09</li> <li>\u5355\u6d4b\uff1a\u53cc\u680f\u5e03\u5c40\u6392\u5e8f\uff08tests/test_layout_order.py\uff09100% \u901a\u8fc7</li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#6_1","title":"6) \u91cd\u6784/\u590d\u73b0\u8ba1\u5212\uff08\u5efa\u8bae\u91cc\u7a0b\u7891\uff09","text":"<ul> <li>M1 \u6700\u5c0f\u6d41\u6c34\u7ebf\uff081-3 \u5929\uff09</li> <li>ocr-one + \u76ee\u5f55\u521d\u59cb\u5316 + \u57fa\u7840\u65e5\u5fd7\uff1b\u751f\u6210 txt \u4e0e JSON</li> <li>M2 \u961f\u5217\u4e0e\u76d1\u63a7\uff081-2 \u5929\uff09</li> <li>enqueue/run-worker/status/report\uff1bGUI \u9762\u677f\u4e0e\u9ed1\u7a97\u4fee\u590d\u7b56\u7565</li> <li>M3 \u5de5\u7a0b\u5316\uff081-2 \u5929\uff09</li> <li>run_batches \u5168\u5e93\u6302\u673a\uff1b\u65e5\u5fd7 Tail \u4e0e\u67e5\u8be2\u4f18\u5316\uff1b\u6545\u969c\u6062\u590d\u4e0e\u544a\u8b66\uff08\u53ef\u9009\uff09</li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#7","title":"7) \u9a8c\u6536\u6e05\u5355","text":"<ul> <li>20 \u4e2a PDF \u5c0f\u6279\u91cf\u8dd1\u901a\uff0c\u62a5\u544a\u751f\u6210\uff1bJSON \u9875\u811a/\u9875\u7801\u6570\u636e\u5b8c\u5907</li> <li>\u961f\u5217\u6a21\u5f0f 200 \u4efb\u52a1\u6d41\u7545\uff0cGUI \u6307\u6807\u5237\u65b0\u65e0\u963b\u585e</li> <li>\u65e5\u5fd7\u7f16\u7801\u6b63\u786e\uff0cPowerShell 5/\u7ec8\u7aef\u4e0d\u4e71\u7801</li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_3","title":"\u901a\u7528\u5de5\u7a0b\u5316\u5efa\u8bae","text":"<ul> <li>\u7edf\u4e00\u65e5\u5fd7\u683c\u5f0f\uff1atime | level | module | message\uff1b\u6587\u4ef6\u6eda\u52a8\u7b56\u7565\u7edf\u4e00</li> <li>\u7edf\u4e00\u914d\u7f6e\u7b56\u7565\uff1a\u9ed8\u8ba4\u503c + schema \u6821\u9a8c + \u7248\u672c\u517c\u5bb9\uff1b\u793a\u4f8b\u914d\u7f6e\u968f\u4ed3\u5e93\u63d0\u4f9b</li> <li>\u6253\u5305\u4e0e\u542f\u52a8\u811a\u672c\uff1apyinstaller\uff08\u53ef\u9009\uff09\uff1bstart_gui/start_cli/start_worker \u6807\u51c6\u5316</li> <li>\u5355\u5143\u6d4b\u8bd5\u4f18\u5148\uff1a\u6838\u5fc3\u7b97\u6cd5/\u72b6\u6001\u673a/\u914d\u7f6e\uff1b\u518d\u8986\u76d6 GUI \u5173\u952e\u4ea4\u4e92\uff08pytest-qt\uff09</li> <li>\u6587\u6863\u5373\u4ee3\u7801\uff1aREADME \u66f4\u65b0\u89c4\u8303\uff1b\u65b0\u589e CHANGELOG\uff1b\u5173\u952e\u547d\u4ee4\u901f\u67e5\u8868</li> </ul>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#_4","title":"\u9644\u5f55\uff1a\u4e00\u952e\u590d\u73b0\u6e05\u5355\uff08\u793a\u4f8b\uff09","text":""},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#clockgui_1","title":"clock\uff08GUI\uff09","text":"<pre><code>cd C:\\Users\\YourName\\clock\npython -m venv .venv\n.\\.venv\\Scripts\\Activate.ps1\npip install -r requirements.txt\npython keep_awake_gui.py\n</code></pre>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#pc_monitor","title":"pc_monitor\uff08\u76d1\u63a7 + \u62a5\u544a\uff09","text":"<pre><code>cd C:\\Users\\YourName\\code\\cmd\\pc_monitor\npip install -r requirements.txt\npython main.py\n</code></pre>"},{"location":"notes/%E4%B8%89%E9%A1%B9%E7%9B%AE%E5%A4%8D%E7%8E%B0%E4%B8%8E%E9%87%8D%E6%9E%84%E6%96%B9%E6%A1%88.html#paddleocrproject-gui","title":"paddleocrproject\uff08\u961f\u5217\u6279\u5904\u7406 + GUI\uff09","text":"<pre><code>cd C:\\Users\\YourName\\code\\paddleocrproject\npython -m venv .venv\n.\\.venv\\Scripts\\Activate.ps1\npython -m pip install -U pip\npython -m pip install -U paddlepaddle paddleocr pymupdf\npython restart_gui.py\npython start_worker.py\n</code></pre> <p>\u2014 \u5b8c \u2014</p>"},{"location":"notes/%E6%9B%B4%E6%96%B0%E5%8D%9A%E5%AE%A2%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC.html","title":"\ud83d\udcdd \u535a\u5ba2\u81ea\u52a8\u5316\u5de5\u4f5c\u6d41\u7a0b","text":""},{"location":"notes/%E6%9B%B4%E6%96%B0%E5%8D%9A%E5%AE%A2%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC.html#_2","title":"\ud83c\udfaf \u4f7f\u7528\u65b9\u5f0f","text":"<p>\u73b0\u5728\u60a8\u53ea\u9700\u89813\u4e2a\u7b80\u5355\u6b65\u9aa4\uff1a</p>"},{"location":"notes/%E6%9B%B4%E6%96%B0%E5%8D%9A%E5%AE%A2%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC.html#1","title":"1. \ud83d\udcc4 \u7f16\u5199\u6587\u7ae0","text":"<ul> <li> <p>\u5728 <code>posts/</code> \u76ee\u5f55\u4e2d\u521b\u5efa\u6216\u7f16\u8f91 <code>.md</code> \u6587\u4ef6</p> </li> <li> <p>\u6587\u4ef6\u540d\u5efa\u8bae\u683c\u5f0f\uff1a<code>YYYY-MM-DD-\u6807\u9898.md</code> \uff08\u65e5\u671f\u4f1a\u81ea\u52a8\u63d0\u53d6\uff09</p> </li> <li> <p>\u5982\u679c\u4e0d\u6309\u65e5\u671f\u683c\u5f0f\u547d\u540d\u4e5f\u6ca1\u5173\u7cfb\uff0c\u811a\u672c\u4f1a\u4f7f\u7528\u6587\u4ef6\u521b\u5efa\u65f6\u95f4</p> </li> </ul>"},{"location":"notes/%E6%9B%B4%E6%96%B0%E5%8D%9A%E5%AE%A2%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC.html#2","title":"2. \ud83d\ude80 \u8fd0\u884c\u811a\u672c","text":"<pre><code>\npython generate_index.py\n\n</code></pre>"},{"location":"notes/%E6%9B%B4%E6%96%B0%E5%8D%9A%E5%AE%A2%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC.html#3","title":"3. \u2705 \u5b8c\u6210\uff01","text":"<ul> <li> <p>\u811a\u672c\u4f1a\u81ea\u52a8\u626b\u63cf\u6240\u6709 <code>.md</code> \u6587\u4ef6</p> </li> <li> <p>\u81ea\u52a8\u751f\u6210/\u66f4\u65b0 <code>posts/index.md</code> \u548c <code>posts/index.json</code></p> </li> <li> <p>\u81ea\u52a8\u63d0\u4ea4\u5230 Git \u5e76\u63a8\u9001\u5230 GitHub</p> </li> <li> <p>\u60a8\u7684\u535a\u5ba2\u7acb\u5373\u53ef\u7528\uff01</p> </li> </ul>"},{"location":"notes/%E6%9B%B4%E6%96%B0%E5%8D%9A%E5%AE%A2%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC.html#_3","title":"\ud83d\udee0\ufe0f \u811a\u672c\u529f\u80fd","text":""},{"location":"notes/%E6%9B%B4%E6%96%B0%E5%8D%9A%E5%AE%A2%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC.html#_4","title":"\u2728 \u5168\u81ea\u52a8\u529f\u80fd","text":"<ul> <li> <p>\u667a\u80fd\u626b\u63cf\uff1a\u81ea\u52a8\u53d1\u73b0 <code>posts/</code> \u76ee\u5f55\u4e2d\u7684\u6240\u6709 <code>.md</code> \u6587\u4ef6</p> </li> <li> <p>\u6807\u9898\u63d0\u53d6\uff1a\u4ece\u6587\u4ef6\u5185\u5bb9\u7684 <code># \u6807\u9898</code> \u6216\u6587\u4ef6\u540d\u81ea\u52a8\u63d0\u53d6\u6807\u9898</p> </li> <li> <p>\u65e5\u671f\u8bc6\u522b\uff1a\u4ece\u6587\u4ef6\u540d <code>YYYY-MM-DD-</code> \u683c\u5f0f\u6216\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\u63d0\u53d6\u65e5\u671f</p> </li> <li> <p>\u589e\u91cf\u66f4\u65b0\uff1a\u53ea\u5904\u7406\u65b0\u589e\u6216\u53d8\u66f4\u7684\u6587\u4ef6\uff0c\u4fdd\u7559\u73b0\u6709\u6761\u76ee</p> </li> <li> <p>\u81ea\u52a8\u6392\u5e8f\uff1a\u6309\u65e5\u671f\u964d\u5e8f\u6392\u5217\u6587\u7ae0</p> </li> <li> <p>Git\u96c6\u6210\uff1a\u81ea\u52a8\u63d0\u4ea4\u548c\u63a8\u9001\u66f4\u6539</p> </li> </ul>"},{"location":"notes/%E6%9B%B4%E6%96%B0%E5%8D%9A%E5%AE%A2%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC.html#_5","title":"\ud83c\udf9b\ufe0f \u547d\u4ee4\u9009\u9879","text":"<pre><code>\n# \u9ed8\u8ba4\u6a21\u5f0f\uff1a\u5168\u81ea\u52a8\u5904\u7406\n\npython generate_index.py\n\n\n\n# \u7981\u7528Git\u64cd\u4f5c\uff08\u4ec5\u672c\u5730\u66f4\u65b0\uff09\n\npython generate_index.py --no-git\n\n\n\n# \u4f20\u7edf\u6a21\u5f0f\uff08\u9700\u8981\u624b\u52a8\u7ef4\u62a4index.md\uff09\n\npython generate_index.py --legacy\n\n\n\n# \u67e5\u770b\u5e2e\u52a9\n\npython generate_index.py --help\n\n</code></pre>"},{"location":"notes/%E6%9B%B4%E6%96%B0%E5%8D%9A%E5%AE%A2%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC.html#_6","title":"\ud83d\udcca \u811a\u672c\u8f93\u51fa\u793a\u4f8b","text":"<pre><code>\n\ud83d\ude80 Starting automatic blog index generation...\n\n==================================================\n\n\ud83d\udcca Analysis:\n\n\u00a0 - Total MD files: 16\n\n\u00a0 - Existing entries: 15\n\n\u00a0 - New files: 1 ['2024-12-05-\u65b0\u6587\u7ae0.md']\n\n\u00a0 - Missing files: 0 []\n\n\n\n\u2705 Updated posts/index.md\n\n\u2705 Updated posts/index.json\n\n\u2705 Git operations completed: Auto-update blog: added 1 post(s)\n\n\n\n\ud83c\udf89 Blog index generation completed successfully!\n\n\ud83d\udcdd Total posts: 16\n\n\ud83c\udd95 New posts added: 2024-12-05-\u65b0\u6587\u7ae0.md\n\n</code></pre>"},{"location":"notes/%E6%9B%B4%E6%96%B0%E5%8D%9A%E5%AE%A2%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC.html#_7","title":"\ud83d\udd27 \u914d\u7f6e\u9009\u9879","text":"<p>\u5728 <code>generate_index.py</code> \u9876\u90e8\u53ef\u4ee5\u4fee\u6539\uff1a</p> <pre><code>\n# \u9ed8\u8ba4\u4f5c\u8005\n\nDEFAULT_AUTHOR = \"Lifu\"\n\n\n\n# \u9ed8\u8ba4\u8bb8\u53ef\u8bc1\n\nDEFAULT_LICENSE = \"MIT\"\n\n\n\n# \u6392\u9664\u7684\u6587\u4ef6\uff08\u4e0d\u4f5c\u4e3a\u535a\u5ba2\u6587\u7ae0\uff09\n\nEXCLUDED_FILES = {'index.md', 'about.md'}\n\n\n\n# Git\u81ea\u52a8\u63d0\u4ea4\u5f00\u5173\n\nGIT_ENABLED = True\n\n</code></pre>"},{"location":"notes/%E6%9B%B4%E6%96%B0%E5%8D%9A%E5%AE%A2%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC.html#_8","title":"\ud83c\udfa8 \u6587\u7ae0\u5143\u6570\u636e","text":"<p>\u811a\u672c\u4f1a\u81ea\u52a8\u4e3a\u6bcf\u7bc7\u6587\u7ae0\u751f\u6210\u57fa\u672c\u5143\u6570\u636e\uff1a</p> <ul> <li> <p>title: \u4ece\u6587\u4ef6\u5185\u5bb9\u6216\u6587\u4ef6\u540d\u63d0\u53d6</p> </li> <li> <p>date: \u4ece\u6587\u4ef6\u540d\u6216\u521b\u5efa\u65f6\u95f4\u63d0\u53d6</p> </li> <li> <p>file: \u6587\u4ef6\u540d</p> </li> <li> <p>author: \u4f7f\u7528\u9ed8\u8ba4\u4f5c\u8005</p> </li> </ul> <p>\u5982\u9700\u66f4\u591a\u5143\u6570\u636e\uff08excerpt\u3001version\u3001license\uff09\uff0c\u53ef\u4ee5\u624b\u52a8\u7f16\u8f91\u751f\u6210\u7684 <code>posts/index.md</code>\u3002</p>"},{"location":"notes/%E6%9B%B4%E6%96%B0%E5%8D%9A%E5%AE%A2%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC.html#_9","title":"\ud83d\udea8 \u6ce8\u610f\u4e8b\u9879","text":"<ol> <li> <p>\u5907\u4efd\u91cd\u8981\uff1a\u9996\u6b21\u4f7f\u7528\u524d\u5efa\u8bae\u5907\u4efd\u73b0\u6709\u7684 <code>posts/index.md</code></p> </li> <li> <p>Git\u4ed3\u5e93\uff1a\u786e\u4fdd\u5728Git\u4ed3\u5e93\u4e2d\u8fd0\u884c\uff0c\u5426\u5219\u4f1a\u8df3\u8fc7Git\u64cd\u4f5c</p> </li> <li> <p>\u6587\u4ef6\u7f16\u7801\uff1a\u786e\u4fdd <code>.md</code> \u6587\u4ef6\u4f7f\u7528 UTF-8 \u7f16\u7801</p> </li> <li> <p>\u6587\u4ef6\u540d\uff1a\u907f\u514d\u4f7f\u7528\u7279\u6b8a\u5b57\u7b26\uff0c\u5efa\u8bae\u4f7f\u7528\u82f1\u6587\u548c\u6570\u5b57</p> </li> </ol>"},{"location":"notes/%E6%9B%B4%E6%96%B0%E5%8D%9A%E5%AE%A2%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC.html#_10","title":"\ud83c\udf89 \u4f18\u52bf","text":"<ul> <li> <p>\u96f6\u914d\u7f6e\uff1a\u6dfb\u52a0\u6587\u7ae0\u540e\u76f4\u63a5\u8fd0\u884c\u811a\u672c\u5373\u53ef</p> </li> <li> <p>\u667a\u80fd\u5316\uff1a\u81ea\u52a8\u5904\u7406\u6807\u9898\u3001\u65e5\u671f\u3001\u6392\u5e8f\u7b49</p> </li> <li> <p>\u589e\u91cf\u5f0f\uff1a\u53ea\u5904\u7406\u53d8\u66f4\uff0c\u4e0d\u5f71\u54cd\u73b0\u6709\u6761\u76ee</p> </li> <li> <p>Git\u96c6\u6210\uff1a\u4e00\u952e\u53d1\u5e03\u5230GitHub Pages</p> </li> <li> <p>\u5411\u540e\u517c\u5bb9\uff1a\u4fdd\u7559\u539f\u6709\u7684\u624b\u52a8\u6a21\u5f0f</p> </li> </ul> <p>\u73b0\u5728\u60a8\u53ef\u4ee5\u4e13\u6ce8\u4e8e\u5199\u4f5c\uff0c\u6280\u672f\u7ec6\u8282\u4ea4\u7ed9\u811a\u672c\u5904\u7406\uff01 \ud83c\udfaf</p>"},{"location":"notes/%E6%9C%ACBlog%E6%9E%B6%E6%9E%84.html","title":"\u672cBlog\u67b6\u6784","text":""},{"location":"notes/%E6%9C%ACBlog%E6%9E%B6%E6%9E%84.html#obsidian-python","title":"\u4f7f\u7528 Obsidian \u548c Python \u7ba1\u7406\u9759\u6001\u535a\u5ba2\u7d22\u5f15","text":"<p>\u76ee\u6807\uff1a \u901a\u8fc7\u5728 Obsidian \u4e2d\u7ef4\u62a4\u4e00\u4e2a Markdown \u6587\u4ef6 (<code>posts/index.md</code>) \u6765\u7ba1\u7406\u535a\u5ba2\u6587\u7ae0\u5217\u8868\uff0c\u5e76\u4f7f\u7528\u4e00\u4e2a\u672c\u5730 Python \u811a\u672c\u81ea\u52a8\u5c06\u5176\u8f6c\u6362\u4e3a\u524d\u7aef JavaScript (<code>index.js</code>) \u6240\u9700\u7684 <code>posts/index.json</code> \u6587\u4ef6\u3002\u8fd9\u6837\u53ef\u4ee5\u5229\u7528 Obsidian \u7684\u7f16\u8f91\u548c Git \u529f\u80fd\u7b80\u5316\u535a\u5ba2\u7ef4\u62a4\u6d41\u7a0b\u3002</p> <p>\u6838\u5fc3\u6d41\u7a0b\uff1a</p> <ol> <li>\u5728 Obsidian \u4e2d\u7f16\u8f91\u6587\u7ae0 (<code>.md</code>) \u548c\u7d22\u5f15 (<code>posts/index.md</code>)\u3002</li> <li>\u5728\u672c\u5730\u8fd0\u884c Python \u811a\u672c (<code>generate_index.py</code>) \u5c06 <code>posts/index.md</code> \u8f6c\u6362\u4e3a <code>posts/index.json</code>\u3002</li> <li>\u4f7f\u7528 Git (\u901a\u8fc7 Obsidian \u63d2\u4ef6\u6216\u547d\u4ee4\u884c) \u63d0\u4ea4\u5e76\u63a8\u9001\u6240\u6709\u66f4\u6539\u5230 GitHub\u3002</li> </ol>"},{"location":"notes/%E6%9C%ACBlog%E6%9E%B6%E6%9E%84.html#1","title":"1. \u5148\u51b3\u6761\u4ef6","text":"<ul> <li>Python 3: \u786e\u4fdd\u4f60\u7684\u672c\u5730\u8ba1\u7b97\u673a\u5b89\u88c5\u4e86 Python 3\u3002\u53ef\u4ee5\u5728\u7ec8\u7aef\u8fd0\u884c <code>python --version</code> \u6216 <code>python3 --version</code> \u6765\u68c0\u67e5\u3002</li> <li>Obsidian: \u4f60\u6b63\u5728\u4f7f\u7528\u7684\u7b14\u8bb0\u8f6f\u4ef6\u3002</li> <li>Git: \u7248\u672c\u63a7\u5236\u7cfb\u7edf\uff0c\u7528\u4e8e\u5c06\u66f4\u6539\u63a8\u9001\u5230 GitHub\u3002</li> <li>(\u53ef\u9009) Obsidian Git \u63d2\u4ef6: \u65b9\u4fbf\u5728 Obsidian \u5185\u90e8\u8fdb\u884c Git \u64cd\u4f5c\u3002</li> </ul>"},{"location":"notes/%E6%9C%ACBlog%E6%9E%B6%E6%9E%84.html#2","title":"2. \u9879\u76ee\u8bbe\u7f6e","text":"<ol> <li> <p>\u76ee\u5f55\u7ed3\u6784: \u786e\u4fdd\u4f60\u7684\u535a\u5ba2\u9879\u76ee\u6839\u76ee\u5f55\u5927\u81f4\u5982\u4e0b\uff1a</p> <p><code>your-blog-root/ \u251c\u2500\u2500 .git/              # Git \u4ed3\u5e93\u76ee\u5f55 (\u53ef\u80fd\u9690\u85cf) \u251c\u2500\u2500 posts/             # \u5b58\u653e\u535a\u5ba2\u6587\u7ae0\u548c\u7d22\u5f15\u6587\u4ef6\u7684\u76ee\u5f55 \u2502   \u251c\u2500\u2500 index.md       # \u3010\u65b0\u589e\u3011\u7528 Markdown \u8868\u683c\u7ef4\u62a4\u7684\u6587\u7ae0\u7d22\u5f15\u6e90\u6587\u4ef6 \u2502   \u251c\u2500\u2500 index.json     # \u3010\u81ea\u52a8\u751f\u6210\u3011\u7ed9\u524d\u7aef\u4f7f\u7528\u7684 JSON \u7d22\u5f15\u6587\u4ef6 \u2502   \u251c\u2500\u2500 2023-10-28-your-post.md \u2502   \u2514\u2500\u2500 ... (\u5176\u4ed6 .md \u6587\u7ae0) \u251c\u2500\u2500 generate_index.py  # \u3010\u65b0\u589e\u3011Python \u8f6c\u6362\u811a\u672c \u251c\u2500\u2500 index.html         # \u535a\u5ba2\u4e3b\u9875 \u251c\u2500\u2500 index.js           # \u524d\u7aef JavaScript \u251c\u2500\u2500 index.css          # \u4e3b\u8981\u6837\u5f0f\u8868 \u251c\u2500\u2500 showdown.min.js    # Markdown \u6e32\u67d3\u5e93 \u2514\u2500\u2500 ... (\u5176\u4ed6\u8d44\u6e90\u6587\u4ef6\u5982 reset.css, \u56fe\u7247\u7b49)</code></p> </li> <li> <p>\u521b\u5efa Python \u811a\u672c (<code>generate_index.py</code>)</p> <p>\u5728\u4f60\u7684\u9879\u76ee\u6839\u76ee\u5f55 (<code>your-blog-root/</code>) \u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a <code>generate_index.py</code> \u7684\u6587\u4ef6\uff0c\u5e76\u5c06\u4ee5\u4e0b Python \u4ee3\u7801\u590d\u5236\u8fdb\u53bb\uff1a</p> <p>```python import json import re from pathlib import Path import datetime import sys</p> </li> <li> <p>\u521b\u5efa Markdown \u7d22\u5f15\u6587\u4ef6 (<code>posts/index.md</code>)</p> <p>\u5728 <code>posts/</code> \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a <code>index.md</code> \u7684\u6587\u4ef6\u3002\u4f60\u9700\u8981\u6309\u7167\u4ee5\u4e0b\u4e25\u683c\u7684 Markdown \u8868\u683c\u683c\u5f0f\u6765\u7ef4\u62a4\u4f60\u7684\u6587\u7ae0\u5217\u8868\uff1a</p> <p>```markdown</p> </li> </ol>"},{"location":"notes/%E6%9C%ACBlog%E6%9E%B6%E6%9E%84.html#-","title":"--- \u914d\u7f6e ---","text":""},{"location":"notes/%E6%9C%ACBlog%E6%9E%B6%E6%9E%84.html#_1","title":"\u83b7\u53d6\u811a\u672c\u6240\u5728\u7684\u76ee\u5f55","text":"<p>SCRIPT_DIR = Path(file).parent.resolve()</p>"},{"location":"notes/%E6%9C%ACBlog%E6%9E%B6%E6%9E%84.html#_2","title":"\u8f93\u5165\u548c\u8f93\u51fa\u6587\u4ef6\u76f8\u5bf9\u4e8e\u811a\u672c\u76ee\u5f55\u7684\u8def\u5f84","text":"<p>SOURCE_MD_FILE = SCRIPT_DIR / 'posts' / 'index.md' OUTPUT_JSON_FILE = SCRIPT_DIR / 'posts' / 'index.json'</p>"},{"location":"notes/%E6%9C%ACBlog%E6%9E%B6%E6%9E%84.html#markdown-json-key","title":"Markdown \u8868\u683c\u5934(\u5c0f\u5199)\u5230\u6700\u7ec8 JSON key \u7684\u6620\u5c04","text":""},{"location":"notes/%E6%9C%ACBlog%E6%9E%B6%E6%9E%84.html#key-indexjs","title":"\u786e\u4fdd\u8fd9\u91cc\u7684 key (\u503c) \u4e0e\u4f60\u7684 index.js \u8bfb\u53d6\u7684\u5b57\u6bb5\u540d\u4e00\u81f4","text":"<p>HEADER_MAP = {     'title': 'title',         # \u5fc5\u9700     'date': 'date',           # \u5fc5\u9700 (YYYY-MM-DD\u683c\u5f0f)     'file': 'file',           # \u5fc5\u9700 (markdown\u6587\u4ef6\u540d)     'excerpt': 'excerpt',     # \u53ef\u9009     'author': 'author',       # \u53ef\u9009     'version': 'version',     # \u53ef\u9009     'license': 'license',     # \u53ef\u9009     # \u4f60\u53ef\u4ee5\u6839\u636e\u9700\u8981\u6dfb\u52a0\u66f4\u591a\u6620\u5c04 } REQUIRED_HEADERS = ['title', 'date', 'file'] # \u5fc5\u987b\u5b58\u5728\u7684\u5217</p>"},{"location":"notes/%E6%9C%ACBlog%E6%9E%B6%E6%9E%84.html#-_1","title":"--- ---","text":"<p>def parse_markdown_table(md_content):     \"\"\"     \u4ece Markdown \u6587\u672c\u4e2d\u89e3\u6790\u7b2c\u4e00\u4e2a\u7b26\u5408\u683c\u5f0f\u7684\u8868\u683c\u3002     \u8981\u6c42\uff1a     - \u6807\u51c6 Markdown \u8868\u683c\u8bed\u6cd5 (| \u5206\u9694\u5217, \u7b2c\u4e8c\u884c\u4e3a\u5206\u9694\u884c |:---|)     - \u8868\u5934\u5fc5\u987b\u5305\u542b REQUIRED_HEADERS \u4e2d\u5b9a\u4e49\u7684\u5217\u540d (\u5927\u5c0f\u5199\u4e0d\u654f\u611f)\u3002     \"\"\"     posts = []     lines = md_content.strip().splitlines() # \u4f7f\u7528 splitlines \u4fdd\u7559\u6362\u884c\u7b26\u5dee\u5f02     headers = []     header_indices = {} # \u5b58\u50a8\u8868\u5934\u540d(\u5c0f\u5199)\u5230\u5217\u7d22\u5f15\u7684\u6620\u5c04     in_table_data = False # \u6807\u8bb0\u662f\u5426\u5728\u8bfb\u53d6\u8868\u683c\u6570\u636e\u884c</p> <pre><code>print(\"Starting table parsing...\")\n\nfor line_num, line in enumerate(lines):\n    line = line.strip()\n    if not line.startswith('|') or not line.endswith('|'):\n        # \u5982\u679c\u5df2\u7ecf\u5f00\u59cb\u89e3\u6790\u6570\u636e\u884c\uff0c\u9047\u5230\u975e\u8868\u683c\u884c\u5219\u505c\u6b62\n        if in_table_data:\n            print(f\"Stopped parsing table data at line {line_num + 1}.\")\n            break\n        continue # \u8df3\u8fc7\u975e\u8868\u683c\u683c\u5f0f\u7684\u884c\n\n    parts = [p.strip() for p in line.strip('|').split('|')]\n\n    # \u5c1d\u8bd5\u8bc6\u522b\u5206\u9694\u884c (\u5fc5\u987b\u5728\u8868\u5934\u884c\u4e4b\u540e)\n    if headers and re.match(r'^[:\\- ]+$', parts[0].replace(':', '')) and len(parts) == len(headers):\n        # \u68c0\u67e5\u662f\u5426\u6240\u6709\u5fc5\u9700\u7684\u8868\u5934\u90fd\u5df2\u627e\u5230\n        missing_headers = [h for h in REQUIRED_HEADERS if h not in header_indices]\n        if missing_headers:\n            print(f\"Error: Table is missing required header(s): {', '.join(missing_headers)}. Headers found: {list(header_indices.keys())}\")\n            return None # \u8868\u5934\u4e0d\u5b8c\u6574\uff0c\u8fd4\u56de None\n        in_table_data = True\n        print(f\"Table separator found at line {line_num + 1}. Headers mapped: {header_indices}\")\n        continue\n\n    # \u5c1d\u8bd5\u8bc6\u522b\u8868\u5934\u884c (\u5fc5\u987b\u662f\u627e\u5230\u7684\u7b2c\u4e00\u884c\u8868\u683c\u683c\u5f0f)\n    if not headers and not in_table_data:\n        raw_headers = parts\n        headers = [h.lower() for h in raw_headers]\n        # \u5efa\u7acb\u8868\u5934\u540d\u5230\u7d22\u5f15\u7684\u6620\u5c04\n        for i, h in enumerate(headers):\n            if h: # \u5ffd\u7565\u7a7a\u7684\u8868\u5934\u5355\u5143\u683c\n               header_indices[h] = i\n        print(f\"Potential header row found at line {line_num + 1}: {raw_headers}\")\n        continue # \u7ee7\u7eed\u5bfb\u627e\u5206\u9694\u884c\n\n    # \u89e3\u6790\u6570\u636e\u884c (\u5fc5\u987b\u5728\u5206\u9694\u884c\u4e4b\u540e)\n    if in_table_data and len(parts) == len(headers):\n        row_data = {}\n        is_valid_row = True\n\n        # \u63d0\u53d6\u5fc5\u9700\u5b57\u6bb5\u7684\u503c\n        required_values = {}\n        for req_h in REQUIRED_HEADERS:\n            header_index = header_indices.get(req_h)\n            if header_index is None or header_index &gt;= len(parts):\n                print(f\"Warning: Skipping row at line {line_num + 1}. Cannot find index for required header '{req_h}'. Row data: {parts}\")\n                is_valid_row = False\n                break\n            value = parts[header_index]\n            if not value:\n                print(f\"Warning: Skipping row at line {line_num + 1}. Required field '{req_h}' is empty. Row data: {parts}\")\n                is_valid_row = False\n                break\n            required_values[req_h] = value\n\n        if not is_valid_row:\n            continue\n\n        # \u586b\u5145 JSON \u5bf9\u8c61\uff0c\u4f7f\u7528 HEADER_MAP\n        for md_header_lower, json_key in HEADER_MAP.items():\n            header_index = header_indices.get(md_header_lower)\n            # \u68c0\u67e5\u8868\u5934\u662f\u5426\u5b58\u5728\u4e14\u7d22\u5f15\u6709\u6548\n            if header_index is not None and header_index &lt; len(parts):\n                value = parts[header_index]\n                if value: # \u53ea\u6709\u5f53\u5355\u5143\u683c\u975e\u7a7a\u65f6\u624d\u6dfb\u52a0\u8be5\u5b57\u6bb5\n                    row_data[json_key] = value\n\n        # \u518d\u6b21\u786e\u8ba4\u6838\u5fc3\u5b57\u6bb5\u88ab\u6b63\u786e\u586b\u5145 (\u7406\u8bba\u4e0a\u5e94\u8be5\u5df2\u7ecf\u901a\u8fc7\u524d\u9762\u7684\u68c0\u67e5)\n        if all(key in row_data for key in REQUIRED_HEADERS):\n            posts.append(row_data)\n        else:\n             print(f\"Warning: Skipping row at line {line_num + 1} due to processing issue. Data extracted: {row_data}. Original parts: {parts}\")\n\nif not in_table_data:\n     print(\"Error: Could not find a valid Markdown table structure (header + separator + data).\")\n     return None\nif not posts:\n     print(\"Warning: Table found, but no valid data rows could be parsed.\")\n\nprint(f\"Parsing finished. Found {len(posts)} valid post entries.\")\nreturn posts\n</code></pre> <p>def validate_and_sort_posts(posts):     \"\"\"\u9a8c\u8bc1\u65e5\u671f\u683c\u5f0f\u5e76\u6309\u65e5\u671f\u6392\u5e8f\"\"\"     valid_posts = []     print(\"Validating dates and preparing for sorting...\")     for post in posts:         try:             # \u5c1d\u8bd5\u89e3\u6790\u65e5\u671f\uff0c\u786e\u4fdd\u662f YYYY-MM-DD \u683c\u5f0f             datetime.datetime.strptime(post['date'], '%Y-%m-%d')             valid_posts.append(post)         except ValueError:             print(f\"Warning: Skipping post with invalid date format (expected YYYY-MM-DD): {post.get('file', 'N/A')} - Date: {post.get('date', 'N/A')}\")         except KeyError:              print(f\"Warning: Skipping post missing 'date' field: {post.get('file', 'N/A')}\")</p> <pre><code># \u6309\u65e5\u671f\u6392\u5e8f (\u964d\u5e8f)\nvalid_posts.sort(key=lambda p: datetime.datetime.strptime(p['date'], '%Y-%m-%d'), reverse=True)\nprint(f\"Sorting complete. {len(valid_posts)} posts remain after validation.\")\nreturn valid_posts\n</code></pre> <p>def generate_index():     \"\"\"\u4e3b\u51fd\u6570\uff1a\u8bfb\u53d6 MD\uff0c\u89e3\u6790\uff0c\u6392\u5e8f\uff0c\u5199\u5165 JSON\"\"\"     try:         print(f\"Attempting to read Markdown index from: {SOURCE_MD_FILE}\")         md_content = SOURCE_MD_FILE.read_text(encoding='utf-8')         print(\"Markdown file read successfully.\")</p> <pre><code>    parsed_posts = parse_markdown_table(md_content)\n\n    if parsed_posts is None:\n        print(\"Error during table parsing. Aborting JSON generation.\")\n        sys.exit(1) # \u9000\u51fa\u811a\u672c\uff0c\u8868\u793a\u5931\u8d25\n\n    sorted_posts = validate_and_sort_posts(parsed_posts)\n\n    print(f\"Attempting to write {len(sorted_posts)} posts to JSON: {OUTPUT_JSON_FILE}\")\n    with open(OUTPUT_JSON_FILE, 'w', encoding='utf-8') as f:\n        json.dump(sorted_posts, f, indent=4, ensure_ascii=False)\n\n    print(\"-\" * 30)\n    print(f\"Successfully generated {OUTPUT_JSON_FILE} with {len(sorted_posts)} entries.\")\n    print(\"-\" * 30)\n\nexcept FileNotFoundError:\n    print(f\"Error: Source Markdown file not found at: {SOURCE_MD_FILE}\")\n    print(\"Please ensure 'posts/index.md' exists in the correct location.\")\n    sys.exit(1)\nexcept Exception as e:\n    print(f\"\\nAn unexpected error occurred: {e}\")\n    import traceback\n    traceback.print_exc() # \u6253\u5370\u8be6\u7ec6\u7684\u9519\u8bef\u5806\u6808\n    sys.exit(1)\n</code></pre> <p>if name == \"main\":     generate_index()</p> <p>```</p>"},{"location":"notes/%E6%9C%ACBlog%E6%9E%B6%E6%9E%84.html#blog-post-index","title":"Blog Post Index","text":"Title Date File Excerpt Author Version License \u6211\u7684\u7b2c\u4e00\u7bc7\u535a\u5ba2 2023-10-27 2023-10-27-my-first-post.md \u8fd9\u662f\u6211\u535a\u5ba2\u7684\u7b2c\u4e00\u7bc7\u6587\u7ae0\uff0c\u4ecb\u7ecd\u535a\u5ba2\u7684\u642d\u5efa\u8fc7\u7a0b\u3002 \u793a\u4f8b\u7528\u6237 v1.0 CC BY-SA 4.0 \u5173\u4e8e Showdown.js \u7684\u4f7f\u7528 2023-10-26 2023-10-26-using-showdown.md \u5982\u4f55\u5728\u9759\u6001\u9875\u9762\u4e2d\u7528 Showdown \u6e32\u67d3 Markdown\u3002 MIT \u65b0\u7279\u6027\u53d1\u5e03 2023-10-28 2023-10-28-new-feature.md \u535a\u5ba2\u6dfb\u52a0\u4e86\u5206\u9875\u529f\u80fd\u3002 Lifu v0.1.1 \u53e6\u4e00\u7bc7\u5f88\u68d2\u7684\u6587\u7ae0 2023-10-29 2023-10-29-another-great-post.md \u8fd9\u53ea\u662f\u4e00\u4e2a\u5360\u4f4d\u7b26\u793a\u4f8b\u3002 <p>  ```</p> <p>\u5173\u952e\u8981\u6c42\uff1a *   \u8868\u5934\u884c: \u5fc5\u987b\u5b58\u5728\uff0c\u4e14\u5305\u542b\u81f3\u5c11 \"Title\", \"Date\", \"File\" \u8fd9\u51e0\u5217\uff08\u811a\u672c\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff09\u3002\u5217\u7684\u987a\u5e8f\u4e0d\u91cd\u8981\uff0c\u4f46\u540d\u5b57\u9700\u8981\u5339\u914d\u3002 *   \u5206\u9694\u884c: \u8868\u5934\u884c\u4e0b\u9762\u5fc5\u987b\u7d27\u8ddf\u683c\u5f0f\u4e3a <code>| :--- | :--- | ... |</code> \u7684\u5206\u9694\u884c\u3002\u5192\u53f7\u548c\u77ed\u6a2a\u7ebf\u7684\u6570\u91cf\u4e0d\u91cd\u8981\uff0c\u4f46\u5fc5\u987b\u6709 <code>|</code> \u548c <code>-</code>\u3002 *   \u6570\u636e\u884c: \u6bcf\u4e00\u884c\u4ee3\u8868\u4e00\u7bc7\u6587\u7ae0\u3002\u5355\u5143\u683c\u5185\u5bb9\u7528 <code>|</code> \u5206\u9694\u3002 *   \u5fc5\u9700\u5b57\u6bb5: <code>Title</code>, <code>Date</code>, <code>File</code> \u5bf9\u5e94\u7684\u5355\u5143\u683c\u4e0d\u80fd\u4e3a\u7a7a\u3002 *   \u65e5\u671f\u683c\u5f0f: <code>Date</code> \u5217\u5fc5\u987b\u662f <code>YYYY-MM-DD</code> \u683c\u5f0f\uff0c\u5426\u5219\u8be5\u884c\u4f1a\u88ab\u811a\u672c\u5ffd\u7565\u3002 *   \u6587\u4ef6\u540d: <code>File</code> \u5217\u5fc5\u987b\u662f <code>posts/</code> \u76ee\u5f55\u4e0b\u5b9e\u9645\u7684 Markdown \u6587\u4ef6\u540d\u3002 *   \u53ef\u9009\u5b57\u6bb5: <code>Excerpt</code>, <code>Author</code>, <code>Version</code>, <code>License</code> \u7b49\u662f\u53ef\u9009\u7684\u3002\u5982\u679c\u5bf9\u5e94\u7684\u5355\u5143\u683c\u4e3a\u7a7a\uff0c\u8be5\u5b57\u6bb5\u5c06\u4e0d\u4f1a\u88ab\u5305\u542b\u5728\u751f\u6210\u7684 JSON \u5bf9\u8c61\u4e2d\uff0c\u4f60\u7684 <code>index.js</code> \u5e94\u8be5\u80fd\u5904\u7406\u8fd9\u79cd\u60c5\u51b5\uff08\u4f7f\u7528\u9ed8\u8ba4\u503c\uff09\u3002</p>"},{"location":"notes/%E6%9C%ACBlog%E6%9E%B6%E6%9E%84.html#3","title":"3. \u65e5\u5e38\u5de5\u4f5c\u6d41","text":"<p>\u73b0\u5728\uff0c\u5f53\u4f60\u60f3\u8981\u6dfb\u52a0\u6216\u66f4\u65b0\u535a\u5ba2\u6587\u7ae0\u65f6\uff0c\u9075\u5faa\u4ee5\u4e0b\u6b65\u9aa4\uff1a</p> <ol> <li> <p>\u7f16\u5199/\u7f16\u8f91\u6587\u7ae0:</p> <ul> <li>\u5728 Obsidian \u4e2d\uff0c\u6253\u5f00\u6216\u521b\u5efa\u4f60\u7684 <code>.md</code> \u6587\u7ae0\u6587\u4ef6\uff0c\u5c06\u5176\u4fdd\u5b58\u5728 <code>posts/</code> \u76ee\u5f55\u4e0b\u3002</li> </ul> </li> <li> <p>\u66f4\u65b0 Markdown \u7d22\u5f15 (<code>posts/index.md</code>):</p> <ul> <li>\u5728 Obsidian \u4e2d\u6253\u5f00 <code>posts/index.md</code> \u6587\u4ef6\u3002</li> <li>\u5728\u8868\u683c\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u65b0\u884c\uff0c\u586b\u5165\u65b0\u6587\u7ae0\u7684 <code>Title</code>, <code>Date</code> (YYYY-MM-DD), <code>File</code> (\u6587\u4ef6\u540d)\uff0c\u4ee5\u53ca\u5176\u4ed6\u53ef\u9009\u4fe1\u606f (<code>Excerpt</code>, <code>Author</code> \u7b49)\u3002</li> <li>\u6216\u8005\uff0c\u5982\u679c\u4f60\u662f\u4fee\u6539\u73b0\u6709\u6587\u7ae0\u7684\u5143\u6570\u636e\uff08\u6bd4\u5982\u6807\u9898\uff09\uff0c\u76f4\u63a5\u7f16\u8f91\u5bf9\u5e94\u7684\u884c\u3002</li> <li>\u4ed4\u7ec6\u68c0\u67e5\u683c\u5f0f\uff01 \u786e\u4fdd\u65e5\u671f\u683c\u5f0f\u6b63\u786e\uff0c\u6587\u4ef6\u540d\u65e0\u8bef\uff0c\u8868\u683c\u7ed3\u6784\u6ca1\u6709\u7834\u574f\u3002</li> <li>\u4fdd\u5b58 <code>posts/index.md</code> \u6587\u4ef6\u3002</li> </ul> </li> <li> <p>\u8fd0\u884c Python \u811a\u672c\u751f\u6210 JSON:</p> <ul> <li>\u6253\u5f00\u4f60\u7684\u672c\u5730\u7ec8\u7aef\uff08\u547d\u4ee4\u884c\u5de5\u5177\uff09\u3002</li> <li>\u5207\u6362\u5230\u4f60\u7684\u535a\u5ba2\u9879\u76ee\u6839\u76ee\u5f55 (<code>your-blog-root/</code>)\u3002</li> <li>\u8fd0\u884c\u547d\u4ee4: <code>python generate_index.py</code> (\u6216\u8005 <code>python3 generate_index.py</code>\uff0c\u53d6\u51b3\u4e8e\u4f60\u7684\u7cfb\u7edf\u914d\u7f6e)\u3002</li> <li>\u811a\u672c\u4f1a\u8bfb\u53d6 <code>posts/index.md</code>\uff0c\u89e3\u6790\u8868\u683c\uff0c\u7136\u540e\u8986\u76d6\u5199\u5165 <code>posts/index.json</code>\u3002</li> <li>\u89c2\u5bdf\u7ec8\u7aef\u8f93\u51fa: \u811a\u672c\u4f1a\u6253\u5370\u8bfb\u53d6\u3001\u89e3\u6790\u548c\u5199\u5165\u7684\u8fc7\u7a0b\u4fe1\u606f\u3002\u6ce8\u610f\u662f\u5426\u6709\u4efb\u4f55 \"Warning\" \u6216 \"Error\" \u4fe1\u606f\u3002\u5982\u679c\u770b\u5230\u9519\u8bef\uff0c\u6839\u636e\u63d0\u793a\u68c0\u67e5 <code>posts/index.md</code> \u7684\u683c\u5f0f\u6216\u811a\u672c\u914d\u7f6e\u3002</li> </ul> </li> <li> <p>\u63d0\u4ea4\u548c\u63a8\u9001\u66f4\u6539:</p> <ul> <li>\u4f7f\u7528 Git \u63d0\u4ea4\u6240\u6709\u88ab\u4fee\u6539\u7684\u6587\u4ef6\u3002\u8fd9\u901a\u5e38\u5305\u62ec\uff1a<ul> <li>\u4f60\u65b0\u521b\u5efa\u6216\u7f16\u8f91\u7684\u6587\u7ae0 <code>.md</code> \u6587\u4ef6\u3002</li> <li>\u4f60\u624b\u52a8\u4fee\u6539\u8fc7\u7684 <code>posts/index.md</code> \u6587\u4ef6\u3002</li> <li>\u7531\u811a\u672c\u81ea\u52a8\u66f4\u65b0\u7684 <code>posts/index.json</code> \u6587\u4ef6\u3002</li> </ul> </li> <li>\u53ef\u4ee5\u901a\u8fc7 Obsidian Git \u63d2\u4ef6\u64cd\u4f5c\uff1a Staged\uff08\u6682\u5b58\uff09\u6240\u6709\u66f4\u6539 -&gt; Commit\uff08\u63d0\u4ea4\uff09-&gt; Push\uff08\u63a8\u9001\uff09\u3002</li> <li>\u6216\u8005\u5728\u7ec8\u7aef\u64cd\u4f5c\uff1a <code>bash     git add .  # \u6682\u5b58\u6240\u6709\u66f4\u6539 (\u6216\u8005\u6307\u5b9a\u5177\u4f53\u6587\u4ef6 git add posts/index.md posts/index.json your-new-post.md ...)     git commit -m \"Add new blog post: [\u4f60\u7684\u6587\u7ae0\u6807\u9898]\" # \u63d0\u4ea4\u66f4\u6539\uff0c\u5199\u6e05\u695a\u63d0\u4ea4\u4fe1\u606f     git push origin main # \u63a8\u9001\u5230 GitHub (\u4f60\u7684\u5206\u652f\u540d\u53ef\u80fd\u662f main \u6216 master)</code></li> </ul> </li> <li> <p>\u68c0\u67e5\u7ebf\u4e0a\u535a\u5ba2: \u7b49\u5f85 GitHub Pages \u66f4\u65b0\uff08\u901a\u5e38\u51e0\u79d2\u5230\u4e00\u5206\u949f\uff09\uff0c\u7136\u540e\u8bbf\u95ee\u4f60\u7684 <code>your-username.github.io</code> \u535a\u5ba2\uff0c\u786e\u8ba4\u65b0\u6587\u7ae0\u5217\u8868\u548c\u5185\u5bb9\u662f\u5426\u6309\u9884\u671f\u663e\u793a\u3002</p> </li> </ol>"},{"location":"notes/%E6%9C%ACBlog%E6%9E%B6%E6%9E%84.html#4","title":"4. (\u53ef\u9009) \u81ea\u5b9a\u4e49\u548c\u6545\u969c\u6392\u9664","text":"<ul> <li>\u4fee\u6539\u8868\u5934: \u5982\u679c\u4f60\u60f3\u5728 <code>index.md</code> \u4e2d\u4f7f\u7528\u4e0d\u540c\u7684\u8868\u5934\u540d\u79f0\uff08\u6bd4\u5982\u7528 \"\u6587\u7ae0\u6807\u9898\" \u4ee3\u66ff \"Title\"\uff09\uff0c\u4f60\u9700\u8981\u540c\u65f6\u4fee\u6539 <code>index.md</code> \u4e2d\u7684\u8868\u5934\u548c <code>generate_index.py</code> \u811a\u672c\u9876\u90e8\u7684 <code>HEADER_MAP</code> \u5b57\u5178\uff0c\u4fdd\u6301\u4e24\u8005\u5bf9\u5e94\u3002</li> <li>\u811a\u672c\u672a\u8fd0\u884c/\u62a5\u9519:<ul> <li>\u786e\u8ba4 Python 3 \u5df2\u5b89\u88c5\u5e76\u80fd\u5728\u7ec8\u7aef\u4e2d\u8fd0\u884c\u3002</li> <li>\u786e\u8ba4\u4f60\u5728\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u8fd0\u884c\u811a\u672c (<code>python generate_index.py</code>)\u3002</li> <li>\u786e\u8ba4 <code>posts/index.md</code> \u6587\u4ef6\u5b58\u5728\u4e14\u8def\u5f84\u6b63\u786e (\u811a\u672c\u4f1a\u81ea\u52a8\u67e5\u627e <code>posts/</code> \u5b50\u76ee\u5f55\u4e0b\u7684 <code>index.md</code>)\u3002</li> <li>\u4ed4\u7ec6\u9605\u8bfb\u7ec8\u7aef\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u5b83\u901a\u5e38\u4f1a\u6307\u51fa\u95ee\u9898\u6240\u5728\uff08\u6bd4\u5982\u6587\u4ef6\u627e\u4e0d\u5230\u3001\u8868\u683c\u683c\u5f0f\u9519\u8bef\u3001\u65e5\u671f\u683c\u5f0f\u9519\u8bef\u7b49\uff09\u3002</li> <li>\u68c0\u67e5 <code>posts/index.md</code> \u7684\u8868\u683c\u683c\u5f0f\u662f\u5426\u4e25\u683c\u9075\u5b88\u4e86\u8981\u6c42\u3002</li> </ul> </li> <li>JSON \u6587\u4ef6\u672a\u66f4\u65b0\u6216\u5185\u5bb9\u4e3a\u7a7a:<ul> <li>\u68c0\u67e5\u811a\u672c\u8fd0\u884c\u7684\u8f93\u51fa\uff0c\u770b\u662f\u5426\u6709\u8b66\u544a\u4fe1\u606f\uff08\u6bd4\u5982\u627e\u4e0d\u5230\u6709\u6548\u8868\u683c\u3001\u6240\u6709\u884c\u90fd\u56e0\u683c\u5f0f\u9519\u8bef\u88ab\u8df3\u8fc7\uff09\u3002</li> <li>\u786e\u8ba4 <code>posts/index.md</code> \u6587\u4ef6\u88ab\u6b63\u786e\u4fdd\u5b58\u4e86\u3002</li> <li>\u68c0\u67e5\u811a\u672c\u662f\u5426\u6709\u5199\u5165 <code>posts/index.json</code> \u7684\u6743\u9650\uff08\u901a\u5e38\u5728\u672c\u5730\u5f00\u53d1\u8fd9\u4e0d\u662f\u95ee\u9898\uff09\u3002</li> </ul> </li> <li>\u6587\u7ae0\u5217\u8868\u5728\u7ebf\u4e0a\u672a\u66f4\u65b0:<ul> <li>\u786e\u8ba4\u4f60\u5df2\u7ecf\u8fd0\u884c\u4e86 <code>python generate_index.py</code>\u3002</li> <li>\u786e\u8ba4\u4f60\u5df2\u7ecf <code>git add</code>, <code>git commit</code>, \u5e76\u4e14 <code>git push</code> \u4e86 <code>posts/index.json</code> \u6587\u4ef6\u7684\u6700\u65b0\u7248\u672c\u3002</li> <li>\u7ed9 GitHub Pages \u4e00\u70b9\u65f6\u95f4\u6765\u90e8\u7f72\u66f4\u65b0\u3002</li> </ul> </li> </ul> <p>\u8fd9\u4e2a\u65b9\u6848\u7ed3\u5408\u4e86 Obsidian \u7684\u6613\u7528\u6027\u548c Python \u7684\u81ea\u52a8\u5316\u80fd\u529b\uff0c\u5e94\u8be5\u80fd\u5f88\u597d\u5730\u6ee1\u8db3\u4f60\u7684\u9700\u6c42\u3002\u795d\u4f60\u535a\u5ba2\u5199\u4f5c\u6109\u5feb\uff01</p>"},{"location":"notes/%E6%9C%AC%E5%9C%B0-GitHub-%E9%98%BF%E9%87%8C%E4%BA%91ECS-%E9%9D%99%E6%80%81%E7%AB%99%E7%82%B9CI-CD%E6%96%B9%E6%A1%88.html","title":"\u672c\u5730\u2192GitHub\u2192\u963f\u91cc\u4e91 ECS\uff1a\u9759\u6001\u7ad9\u70b9 CI/CD \u65b9\u6848\uff08my-static-site\uff09","text":"<p>\u672c\u6587\u6574\u7406\u672c\u9879\u76ee\u91c7\u7528\u7684\u53d1\u5e03\u6280\u672f\u8def\u7ebf\uff1a\u672c\u5730\u5f00\u53d1 \u2192 \u63a8\u9001\u5230 GitHub \u2192 GitHub Actions \u901a\u8fc7 SSH \u5c06\u6e90\u7801\u4f20\u5230\u963f\u91cc\u4e91 ECS \u2192 \u5728 ECS \u4e0a\u6784\u5efa\u5e76\u4ee5 Docker \u5bb9\u5668\u65b9\u5f0f\u8fd0\u884c\uff0c\u6700\u540e\u5b8c\u6210\u81ea\u52a8\u5065\u5eb7\u68c0\u67e5\u4e0e\u4e0a\u7ebf\u3002</p>"},{"location":"notes/%E6%9C%AC%E5%9C%B0-GitHub-%E9%98%BF%E9%87%8C%E4%BA%91ECS-%E9%9D%99%E6%80%81%E7%AB%99%E7%82%B9CI-CD%E6%96%B9%E6%A1%88.html#_1","title":"\u4e00\u3001\u67b6\u6784\u4e0e\u6d41\u7a0b","text":"<p>\u5f00\u53d1\u8005\u672c\u5730\u6539\u52a8 \u2192 git push \u2192 GitHub Actions \u89e6\u53d1 \u2192 \u6253\u5305\u6e90\u7801\u5e76\u901a\u8fc7 SSH \u4e0a\u4f20\u81f3 ECS \u2192 \u8fdc\u7aef\u89e3\u538b\u4e0e docker build \u2192 \u91cd\u542f\u5bb9\u5668\uff08-p 80:80\u3001--restart=always\uff09\u2192 \u5065\u5eb7\u68c0\u67e5 \u2192 \u5bf9\u5916\u751f\u6548\u3002</p> <pre><code>[Local Dev] --push--&gt; [GitHub Repo]\n      |               (Actions Runner)\n      |                   |\n      |                   v\n      |            package &amp; upload (SSH/SCP)\n      |                   |\n      |                   v\n      |           [Aliyun ECS /root/deploy]\n      |                 docker build/run\n      |                   |\n      +----(verify) &lt;-----+\n</code></pre>"},{"location":"notes/%E6%9C%AC%E5%9C%B0-GitHub-%E9%98%BF%E9%87%8C%E4%BA%91ECS-%E9%9D%99%E6%80%81%E7%AB%99%E7%82%B9CI-CD%E6%96%B9%E6%A1%88.html#_2","title":"\u4e8c\u3001\u4ed3\u5e93\u7ed3\u6784\uff08\u5173\u952e\u6587\u4ef6\uff09","text":"<pre><code>my-static-site/\n\u251c\u2500 .github/workflows/deploy.yml      # \u90e8\u7f72\u5de5\u4f5c\u6d41\n\u251c\u2500 Dockerfile                        # Nginx \u9759\u6001\u7ad9\u955c\u50cf\n\u251c\u2500 index.html / index.js / *.css     # \u7ad9\u70b9\u5165\u53e3\u4e0e\u524d\u7aef\u903b\u8f91\n\u2514\u2500 posts/\n   \u251c\u2500 index.json                     # \u6587\u7ae0\u7d22\u5f15\n   \u2514\u2500 notes/...                      # Notes \u680f\u76ee\u6587\u7ae0\n</code></pre>"},{"location":"notes/%E6%9C%AC%E5%9C%B0-GitHub-%E9%98%BF%E9%87%8C%E4%BA%91ECS-%E9%9D%99%E6%80%81%E7%AB%99%E7%82%B9CI-CD%E6%96%B9%E6%A1%88.html#_3","title":"\u4e09\u3001\u524d\u7f6e\u6761\u4ef6","text":"<ul> <li>\u4e00\u53f0\u963f\u91cc\u4e91 ECS\uff08Ubuntu 22.04+\uff09\uff0c\u5df2\u5b89\u88c5 Docker\uff0c\u5141\u8bb8 80 \u7aef\u53e3\u5bf9\u5916\u8bbf\u95ee\uff08\u5b89\u5168\u7ec4\u653e\u884c TCP/80\uff09\u3002</li> <li>GitHub \u4ed3\u5e93\uff1ayour-username/your-repo\u3002</li> <li>\u53ea\u4f7f\u7528\u516c\u94a5\u767b\u5f55\uff08\u63a8\u8350\uff09\uff1aECS \u4e0a /root/.ssh/authorized_keys \u5df2\u914d\u7f6e\u90e8\u7f72\u516c\u94a5\u3002</li> </ul>"},{"location":"notes/%E6%9C%AC%E5%9C%B0-GitHub-%E9%98%BF%E9%87%8C%E4%BA%91ECS-%E9%9D%99%E6%80%81%E7%AB%99%E7%82%B9CI-CD%E6%96%B9%E6%A1%88.html#cicd","title":"\u56db\u3001\u751f\u6210\u201c\u90e8\u7f72\u5bc6\u94a5\u201d\uff08\u672c\u5730\uff0c\u4ec5\u4f9b CI/CD \u4f7f\u7528\uff09","text":"<ul> <li>PowerShell\uff08\u63a8\u8350\uff09\uff1a</li> </ul> <pre><code>ssh-keygen -t ed25519 -f \"$HOME/.ssh/github-actions-aliyun-ecs\" -N \"\" -C \"github-actions@example\"\n</code></pre> <ul> <li>CMD\uff1a</li> </ul> <pre><code>ssh-keygen -t ed25519 -f \"%USERPROFILE%\\.ssh\\github-actions-aliyun-ecs\" -N \"\" -C \"github-actions@example\"\n</code></pre> <p>\u5f97\u5230\uff1a - \u79c1\u94a5\uff1agithub-actions-aliyun-ecs\uff08\u7c98\u8d34\u5230 GitHub Secret\uff09 - \u516c\u94a5\uff1agithub-actions-aliyun-ecs.pub\uff08\u8ffd\u52a0\u5230 ECS \u7684 /root/.ssh/authorized_keys\uff09</p> <p>ECS \u4e0a\u6dfb\u52a0\u516c\u94a5\u793a\u4f8b\uff08\u5df2\u5b8c\u6210\u4e00\u6b21\uff09\uff1a</p> <pre><code>mkdir -p /root/.ssh &amp;&amp; chmod 700 /root/.ssh\ncat &gt;&gt; /root/.ssh/authorized_keys &lt;&lt;'EOF'\nssh-ed25519 AAAA...EXAMPLE_KEY_REDACTED github-actions@example\nEOF\nchmod 600 /root/.ssh/authorized_keys\n</code></pre>"},{"location":"notes/%E6%9C%AC%E5%9C%B0-GitHub-%E9%98%BF%E9%87%8C%E4%BA%91ECS-%E9%9D%99%E6%80%81%E7%AB%99%E7%82%B9CI-CD%E6%96%B9%E6%A1%88.html#github-secrets-settings-secrets-and-variables-actions","title":"\u4e94\u3001GitHub Secrets\uff08\u4ed3\u5e93 \u2192 Settings \u2192 Secrets and variables \u2192 Actions\uff09","text":"<ul> <li>ECS_HOST = 203.0.113.10</li> <li>ECS_USER = root</li> <li>ECS_SSH_PRIVATE_KEY = \u90e8\u7f72\u79c1\u94a5\u5168\u6587\uff08\u5305\u542b BEGIN/END \u884c\u4e0e\u6240\u6709\u6362\u884c\uff09</li> </ul>"},{"location":"notes/%E6%9C%AC%E5%9C%B0-GitHub-%E9%98%BF%E9%87%8C%E4%BA%91ECS-%E9%9D%99%E6%80%81%E7%AB%99%E7%82%B9CI-CD%E6%96%B9%E6%A1%88.html#deployyml","title":"\u516d\u3001\u5de5\u4f5c\u6d41 deploy.yml\uff08\u6838\u5fc3\u903b\u8f91\uff09","text":"<p>\u8981\u70b9\uff1a\u4f7f\u7528 git archive \u6253\u5305\u4ed3\u5e93\u5185\u5bb9\uff0c\u907f\u514d tar \u5728\u6253\u5305\u8fc7\u7a0b\u4e2d\u8bfb\u5230\u81ea\u8eab\u8f93\u51fa\u6587\u4ef6\u5bfc\u81f4\u7684\u62a5\u9519\uff1b\u901a\u8fc7 SSH \u628a\u538b\u7f29\u5305\u4f20\u5230 ECS \u5e76\u5728\u8fdc\u7aef\u6784\u5efa\u4e0e\u8fd0\u884c\u5bb9\u5668\u3002</p> <pre><code>name: Deploy my-static-site to Aliyun ECS\n\non:\n  push:\n    branches: [ main, master ]\n  workflow_dispatch:\n\nconcurrency:\n  group: deploy-ecs\n  cancel-in-progress: true\n\npermissions:\n  contents: read\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    timeout-minutes: 20\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n\n      - name: Create package (repo root)\n        run: git archive --format=tar.gz -o site.tgz HEAD\n\n      - name: Setup SSH\n        env:\n          ECS_SSH_PRIVATE_KEY: ${{ secrets.ECS_SSH_PRIVATE_KEY }}\n        run: |\n          mkdir -p ~/.ssh &amp;&amp; chmod 700 ~/.ssh\n          echo \"$ECS_SSH_PRIVATE_KEY\" &gt; ~/.ssh/id_ed25519\n          chmod 600 ~/.ssh/id_ed25519\n          ssh-keyscan -H \"${{ secrets.ECS_HOST }}\" &gt;&gt; ~/.ssh/known_hosts\n\n      - name: Upload package to ECS\n        run: scp -i ~/.ssh/id_ed25519 -o StrictHostKeyChecking=yes site.tgz \"${{ secrets.ECS_USER }}@${{ secrets.ECS_HOST }}:/root/deploy/site.tgz\"\n\n      - name: Remote build and deploy on ECS\n        run: |\n          ssh -i ~/.ssh/id_ed25519 -o StrictHostKeyChecking=yes \"${{ secrets.ECS_USER }}@${{ secrets.ECS_HOST }}\" bash -s &lt;&lt;'EOF'\n          set -euo pipefail\n          cd /root/deploy\n          rm -rf site &amp;&amp; mkdir site\n          tar -xzf site.tgz -C site\n          docker rm -f static-site &gt;/dev/null 2&gt;&amp;1 || true\n          docker rm -f augment-nginx &gt;/dev/null 2&gt;&amp;1 || true\n          docker build -t static-site:latest site\n          docker run -d --name static-site --restart=always -p 80:80 static-site:latest\n          docker ps --format 'table {{.Names}}\\t{{.Image}}\\t{{.Ports}}\\t{{.Status}}' | sed -n '1,2p'\n          (curl -sS --max-time 10 http://127.0.0.1/ || wget -q -O- http://127.0.0.1/) | head -n 2 || true\n          EOF\n</code></pre>"},{"location":"notes/%E6%9C%AC%E5%9C%B0-GitHub-%E9%98%BF%E9%87%8C%E4%BA%91ECS-%E9%9D%99%E6%80%81%E7%AB%99%E7%82%B9CI-CD%E6%96%B9%E6%A1%88.html#dockerfile","title":"\u4e03\u3001Dockerfile\uff08\u9759\u6001\u7ad9\u5bb9\u5668\uff09","text":"<pre><code>FROM nginx:alpine\nLABEL maintainer=\"augment-agent\" org.opencontainers.image.title=\"my-static-site\"\nCOPY . /usr/share/nginx/html\nHEALTHCHECK --interval=30s --timeout=3s --retries=3 CMD wget -qO- http://127.0.0.1/ &gt;/dev/null || exit 1\n</code></pre>"},{"location":"notes/%E6%9C%AC%E5%9C%B0-GitHub-%E9%98%BF%E9%87%8C%E4%BA%91ECS-%E9%9D%99%E6%80%81%E7%AB%99%E7%82%B9CI-CD%E6%96%B9%E6%A1%88.html#githubecs","title":"\u516b\u3001\u53d1\u5e03\u6d41\u7a0b\uff08\u672c\u5730\u2192GitHub\u2192ECS\uff09","text":"<p>1) \u5728\u672c\u5730\u4ed3\u5e93 my-static-site \u4fee\u6539\u4efb\u610f\u5185\u5bb9\uff08\u4f8b\u5982\u65b0\u589e\u4e00\u7bc7 Notes \u6587\u7ae0\u6216\u4fee\u8ba2 index.json\uff09\u3002 2) \u63d0\u4ea4\u5e76\u63a8\u9001\uff1a</p> <pre><code>git add -A\ngit commit -m \"docs: update notes\"\ngit push origin main\n</code></pre> <p>3) \u6253\u5f00 GitHub \u2192 Actions \u2192 \u9009\u62e9 \u201cDeploy my-static-site to Aliyun ECS\u201d\uff0c\u67e5\u770b\u8fd0\u884c\u65e5\u5fd7\uff08\u7ea6 1\u20133 \u5206\u949f\uff09\u3002 4) \u6210\u529f\u540e\u8bbf\u95ee http://203.0.113.10/ \u6216 <code>curl -I http://203.0.113.10/</code> \u9a8c\u8bc1\u8fd4\u56de 200\u3002</p> <p>\u53ef\u9009\uff1a\u4e5f\u53ef\u4ee5\u5728 Actions \u9875\u9762\u4f7f\u7528 \u201cRun workflow\u201d\uff08workflow_dispatch\uff09\u624b\u52a8\u89e6\u53d1\u4e00\u6b21\u90e8\u7f72\u3002</p>"},{"location":"notes/%E6%9C%AC%E5%9C%B0-GitHub-%E9%98%BF%E9%87%8C%E4%BA%91ECS-%E9%9D%99%E6%80%81%E7%AB%99%E7%82%B9CI-CD%E6%96%B9%E6%A1%88.html#_4","title":"\u4e5d\u3001\u56de\u6eda\u4e0e\u91cd\u8dd1","text":"<ul> <li>\u56de\u6eda\u5230\u4e0a\u4e00\u4e2a\u7248\u672c\uff1a</li> <li>Git \u4e0a\u5c06 HEAD \u56de\u9000\u5230\u67d0\u4e2a\u7a33\u5b9a\u63d0\u4ea4\uff1a<code>git revert &lt;commit&gt;</code> \u6216 <code>git reset --hard &lt;commit&gt; &amp;&amp; git push -f</code>\uff08\u8c28\u614e\u4f7f\u7528\uff09</li> <li>\u63a8\u9001\u540e Actions \u4f1a\u81ea\u52a8\u6309\u8be5\u5386\u53f2\u7248\u672c\u91cd\u65b0\u6784\u5efa\u5e76\u4e0a\u7ebf\u3002</li> <li>\u91cd\u8dd1\u672c\u6b21\uff1a\u5728\u5931\u8d25\u7684\u5de5\u4f5c\u6d41\u8fd0\u884c\u8be6\u60c5\u9875\u70b9\u51fb \u201cRe-run jobs\u201d\u3002</li> </ul>"},{"location":"notes/%E6%9C%AC%E5%9C%B0-GitHub-%E9%98%BF%E9%87%8C%E4%BA%91ECS-%E9%9D%99%E6%80%81%E7%AB%99%E7%82%B9CI-CD%E6%96%B9%E6%A1%88.html#_5","title":"\u5341\u3001\u5e38\u89c1\u95ee\u9898\u4e0e\u6392\u67e5","text":"<ul> <li>tar: file changed as we read it\uff1a</li> <li>\u89e3\u51b3\uff1a\u4f7f\u7528 <code>git archive</code> \u6253\u5305\uff08\u672c\u65b9\u6848\u5df2\u91c7\u7528\uff09\u3002</li> <li>\u65e0\u6cd5\u8bbf\u95ee 80 \u7aef\u53e3\uff1a</li> <li>\u68c0\u67e5\u963f\u91cc\u4e91\u5b89\u5168\u7ec4\u3001ECS \u4e0a <code>docker ps</code> \u6620\u5c04\u662f\u5426\u6709 <code>0.0.0.0:80-&gt;80/tcp</code>\u3002</li> <li>SSH \u8fde\u63a5\u5931\u8d25\uff1a</li> <li>\u786e\u8ba4 Secrets \u4e2d\u79c1\u94a5\u5b8c\u6574\u4e14\u6743\u9650\u5728\u6b65\u9aa4\u4e2d\u5df2 600\uff1bECS authorized_keys \u6b63\u786e\uff0c\u4e14\u53ea\u5141\u8bb8 publickey \u767b\u5f55\u3002</li> <li>\u6784\u5efa\u8d85\u65f6\uff1a</li> <li>\u67e5\u770b Dockerfile \u6784\u5efa\u8f93\u51fa\uff1b\u5fc5\u8981\u65f6\u542f\u7528\u955c\u50cf\u52a0\u901f\u6216\u5728 ECS \u4e0a\u9884\u62c9\u53d6\u57fa\u7840\u955c\u50cf\u3002</li> <li>CRLF \u8b66\u544a\uff1a</li> <li>Windows \u73af\u5883\u6b63\u5e38\u73b0\u8c61\uff0c\u4e0d\u5f71\u54cd\u90e8\u7f72\uff1b\u53ef\u5728\u4ed3\u5e93\u5c42\u9762\u7edf\u4e00 <code>* text=auto</code>\u3002</li> </ul>"},{"location":"notes/%E6%9C%AC%E5%9C%B0-GitHub-%E9%98%BF%E9%87%8C%E4%BA%91ECS-%E9%9D%99%E6%80%81%E7%AB%99%E7%82%B9CI-CD%E6%96%B9%E6%A1%88.html#_6","title":"\u5341\u4e00\u3001\u5b89\u5168\u4e0e\u7ef4\u62a4\u5efa\u8bae","text":"<ul> <li>\u90e8\u7f72\u5bc6\u94a5\u4e0e\u4eba\u5de5\u767b\u5f55\u5bc6\u94a5\u5206\u79bb\uff08\u5df2\u5b8c\u6210\uff09\u3002</li> <li>\u4ec5\u5141\u8bb8\u516c\u94a5\u8ba4\u8bc1\uff1b\u5fc5\u8981\u65f6\u521b\u5efa\u53d7\u9650 deploy \u7528\u6237\uff0c\u9650\u5236 sudo\u3001\u9650\u5236\u53ef\u6267\u884c\u547d\u4ee4\u3002</li> <li>\u6dfb\u52a0 .dockerignore \u51cf\u5c11\u4e0a\u4e0b\u6587\uff08\u793a\u4f8b\uff09\uff1a</li> </ul> <pre><code>.git\n.github\nnode_modules\n*.log\nsite.tgz\n</code></pre> <ul> <li>\u5e76\u53d1\u63a7\u5236\uff1a<code>concurrency</code> \u5df2\u542f\u7528\uff0c\u907f\u514d\u5e76\u53d1\u90e8\u7f72\u4e92\u76f8\u8986\u76d6\u3002</li> <li>\u5065\u5eb7\u68c0\u67e5\uff1aDockerfile \u5df2\u6dfb\u52a0\uff1b\u7ebf\u4e0a\u81ea\u68c0\u5931\u8d25\u65f6\u5bb9\u5668\u4f1a\u88ab\u91cd\u542f\u3002</li> </ul>"},{"location":"notes/%E6%9C%AC%E5%9C%B0-GitHub-%E9%98%BF%E9%87%8C%E4%BA%91ECS-%E9%9D%99%E6%80%81%E7%AB%99%E7%82%B9CI-CD%E6%96%B9%E6%A1%88.html#ecs","title":"\u5341\u4e8c\u3001\u9a8c\u8bc1\u4e0e\u8fd0\u7ef4\u5feb\u6377\u547d\u4ee4\uff08ECS\uff09","text":"<pre><code># \u67e5\u770b\u5bb9\u5668\u4e0e\u5065\u5eb7\u72b6\u6001\ndocker ps --format 'table {{.Names}}\\t{{.Image}}\\t{{.Ports}}\\t{{.Status}}' | head -n 2\n\n# \u67e5\u770b\u6700\u8fd1\u65e5\u5fd7\ndocker logs --tail=100 static-site\n\n# \u91cd\u542f\u5bb9\u5668\uff08\u5982\u9700\uff09\ndocker restart static-site\n</code></pre> <p>\u4ee5\u4e0a\u5373\u4e3a\u201c\u672c\u5730 \u2014 GitHub \u2014 \u963f\u91cc\u4e91 ECS\u201d\u9759\u6001\u7ad9\u70b9\u7684 CI/CD \u65b9\u6848\u5728\u672c\u4ed3\u5e93\u7684\u5b8c\u6574\u914d\u7f6e\u4e0e\u64cd\u4f5c\u6307\u5f15\u3002</p>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html","title":"\u6784\u5efaPYTHON\u5f00\u53d1\u73af\u5883","text":"<p>A technical exploration and guide</p>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#content","title":"Content","text":""},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#docker-desktop-python-vs-code-remote-development-dev-containers-python","title":"\u4f7f\u7528 Docker Desktop + Python \u955c\u50cf + VS Code + Remote Development (Dev Containers) \u6784\u5efa Python \u5f00\u53d1\u73af\u5883","text":"<p>\u672c\u6587\u6863\u63cf\u8ff0\u4e86\u5982\u4f55\u4f7f\u7528 Docker Desktop\u3001Python \u5b98\u65b9\u955c\u50cf\u3001VS Code \u548c Remote Development (Dev Containers) \u63d2\u4ef6\u6765\u6784\u5efa\u4e00\u4e2a\u5b8c\u6574\u7684 Python \u5f00\u53d1\u73af\u5883\uff0c\u5e76\u6f14\u793a\u5982\u4f55\u7f16\u5199\u3001\u8fd0\u884c Python \u4ee3\u7801\u3002</p>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#1","title":"1. \u73af\u5883\u51c6\u5907","text":""},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#11-docker-desktop","title":"1.1 \u5b89\u88c5 Docker Desktop","text":"<p>\u786e\u4fdd\u4f60\u5df2\u7ecf\u5b89\u88c5\u4e86 Docker Desktop\u3002\u5b89\u88c5\u540e\uff0c\u786e\u4fdd Docker \u6b63\u5728\u8fd0\u884c\uff0c\u5e76\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u884c\u8bbf\u95ee\u3002</p>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#12-vs-code","title":"1.2 \u5b89\u88c5 VS Code","text":"<p>\u4e0b\u8f7d\u5e76\u5b89\u88c5 VS Code\uff0c\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u6d41\u884c\u7684\u8de8\u5e73\u53f0\u7f16\u8f91\u5668\u3002</p>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#13-remote-development","title":"1.3 \u5b89\u88c5 Remote Development \u63d2\u4ef6\u5305","text":"<p>\u5728 VS Code \u4e2d\uff0c\u5b89\u88c5 Remote Development \u63d2\u4ef6\u5305\u3002\u5b83\u5305\u62ec\uff1a</p> <ul> <li>Remote - SSH</li> <li>Remote - WSL</li> <li>Dev Containers</li> </ul>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#_1","title":"\u5b89\u88c5\u6b65\u9aa4\uff1a","text":"<ol> <li>\u6253\u5f00 VS Code\uff0c\u6309\u4e0b <code>Ctrl+Shift+X</code> \u6253\u5f00\u6269\u5c55\u9762\u677f\u3002</li> <li>\u5728\u641c\u7d22\u680f\u4e2d\u8f93\u5165 Remote Development\u3002</li> <li>\u627e\u5230\u7531 Microsoft \u53d1\u5e03\u7684 Remote Development\uff0c\u70b9\u51fb\u5b89\u88c5\u3002</li> </ol>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#2-python-docker","title":"2. \u62c9\u53d6 Python Docker \u955c\u50cf","text":"<p>\u4f7f\u7528 Docker \u5b98\u65b9\u7684 <code>python</code> \u955c\u50cf\u6765\u4f5c\u4e3a\u5f00\u53d1\u73af\u5883\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u6765\u62c9\u53d6\u955c\u50cf\uff1a</p> <pre><code>docker pull python:latest\n</code></pre> <p>\u62c9\u53d6\u540e\uff0c<code>python</code> \u955c\u50cf\u5c06\u53ef\u4ee5\u5728\u4f60\u7684\u672c\u5730 Docker \u4e2d\u4f7f\u7528\u3002</p>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#3-docker","title":"3. \u521b\u5efa\u5e76\u8fd0\u884c Docker \u5bb9\u5668","text":"<p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u521b\u5efa\u5e76\u542f\u52a8\u5bb9\u5668\uff0c\u540c\u65f6\u5c06\u672c\u5730\u5de5\u4f5c\u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u4e2d\uff0c\u4ee5\u4fbf\u5728\u5bb9\u5668\u4e2d\u8fdb\u884c\u5f00\u53d1\uff1a</p> <pre><code>docker run -it -v ${PWD}:/workspace -w /workspace python:latest bash\n</code></pre> <ul> <li><code>-it</code>\uff1a\u542f\u52a8\u4ea4\u4e92\u6a21\u5f0f\u3002</li> <li><code>-v ${PWD}:/workspace</code>\uff1a\u5c06\u672c\u5730\u5de5\u4f5c\u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u7684 <code>/workspace</code> \u76ee\u5f55\u3002</li> <li><code>-w /workspace</code>\uff1a\u5bb9\u5668\u542f\u52a8\u65f6\u7684\u5de5\u4f5c\u76ee\u5f55\u3002</li> <li><code>python:latest</code>\uff1a\u4f7f\u7528\u6700\u65b0\u7248\u672c\u7684 <code>python</code> \u955c\u50cf\u3002</li> <li><code>bash</code>\uff1a\u8fdb\u5165\u5bb9\u5668\u7684 Bash shell\u3002</li> </ul> <p>\u8fd9\u6761\u547d\u4ee4\u542f\u52a8\u540e\uff0c\u4f60\u5c06\u8fdb\u5165\u5bb9\u5668\u7684 Bash \u73af\u5883\uff0c\u53ef\u4ee5\u5728\u5176\u4e2d\u7f16\u5199\u548c\u8fd0\u884c Python \u4ee3\u7801\u3002</p>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#4-vs-code-dev-containers","title":"4. \u5728 VS Code \u4e2d\u4f7f\u7528 Dev Containers \u8fde\u63a5\u5bb9\u5668","text":""},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#41-dev-containers","title":"4.1 \u4f7f\u7528 Dev Containers \u63d2\u4ef6\u8fde\u63a5\u5bb9\u5668","text":"<ol> <li>\u5728 VS Code \u4e2d\u6309\u4e0b <code>F1</code> \u6216 <code>Ctrl+Shift+P</code>\uff0c\u8c03\u51fa\u547d\u4ee4\u9762\u677f\u3002</li> <li>\u8f93\u5165\u5e76\u9009\u62e9 Dev Containers: Attach to Running Container\u3002</li> <li>VS Code \u4f1a\u5217\u51fa\u6240\u6709\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668\uff0c\u9009\u62e9\u4f60\u4f7f\u7528 <code>python</code> \u955c\u50cf\u542f\u52a8\u7684\u5bb9\u5668\u3002</li> <li>\u8fde\u63a5\u540e\uff0c\u4f60\u5c06\u53ef\u4ee5\u5728 VS Code \u4e2d\u50cf\u5e73\u5e38\u4e00\u6837\u7f16\u8f91\u5bb9\u5668\u4e2d\u7684\u6587\u4ef6\u3002</li> </ol>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#42","title":"4.2 \u9a8c\u8bc1\u8fde\u63a5","text":"<p>\u6210\u529f\u8fde\u63a5\u5bb9\u5668\u540e\uff0cVS Code \u5de6\u4e0b\u89d2\u4f1a\u663e\u793a\u4e00\u4e2a\u7eff\u8272\u7684 \"Dev Container\" \u6807\u5fd7\uff0c\u8868\u793a\u4f60\u6b63\u5728\u5bb9\u5668\u73af\u5883\u4e2d\u5f00\u53d1\u3002</p>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#5-python","title":"5. \u7f16\u5199\u3001\u8fd0\u884c Python \u4ee3\u7801","text":""},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#51","title":"5.1 \u521b\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u6587\u4ef6","text":"<p>\u5728\u5bb9\u5668\u4e2d\u6216\u5728 VS Code \u4e2d\uff0c\u521b\u5efa\u4e00\u4e2a Python \u6587\u4ef6\uff0c\u4f8b\u5982 <code>hello.py</code>\uff1a</p> <pre><code>print(\"Hello, Docker and VS Code!\")\n</code></pre>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#52-python","title":"5.2 \u8fd0\u884c Python \u6587\u4ef6","text":"<p>\u5728 VS Code \u7684\u7ec8\u7aef\u4e2d\uff0c\u4f7f\u7528 Python \u6765\u8fd0\u884c\u6587\u4ef6\uff1a</p> <pre><code>python hello.py\n</code></pre> <p>\u4f60\u5e94\u8be5\u4f1a\u770b\u5230\u8f93\u51fa\uff1a</p> <pre><code>Hello, Docker and VS Code!\n</code></pre>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#6-docker-compose","title":"6. \u4f7f\u7528 <code>docker-compose</code> \u7ba1\u7406\u5bb9\u5668","text":"<p>\u4e3a\u4e86\u7b80\u5316\u5bb9\u5668\u7ba1\u7406\uff0c\u60a8\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a <code>docker-compose.yml</code> \u6587\u4ef6\uff0c\u4ee5\u4fbf\u66f4\u65b9\u4fbf\u5730\u542f\u52a8\u548c\u7ba1\u7406\u5bb9\u5668\u3002\u793a\u4f8b\u5982\u4e0b\uff1a</p> <pre><code>version: \"3\"\nservices:\n  python-dev:\n    image: python:latest\n    container_name: python_dev_container\n    volumes:\n      - ./mytest:/workspace\n    working_dir: /workspace\n    stdin_open: true\n    tty: true\n</code></pre> <ul> <li>\u5728\u9879\u76ee\u76ee\u5f55\u4e0b\u521b\u5efa <code>docker-compose.yml</code> \u6587\u4ef6\u3002</li> <li>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u542f\u52a8\u5bb9\u5668\uff1a</li> </ul> <pre><code>docker-compose up -d\n</code></pre> <p>\u8be5\u914d\u7f6e\u6587\u4ef6\u4f1a\u81ea\u52a8\u6302\u8f7d\u5f53\u524d\u76ee\u5f55\u7684 <code>./mytest</code> \u6587\u4ef6\u5939\u5230\u5bb9\u5668\u4e2d\u7684 <code>/workspace</code> \u76ee\u5f55\u3002</p>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#python-docker-compose","title":"Python \u5bb9\u5668\u4e0e Docker Compose \u914d\u7f6e\u6307\u5357","text":""},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#1-docker-docker-compose","title":"1. \u5b89\u88c5 Docker \u548c Docker Compose","text":"<p>\u786e\u4fdd\u5df2\u7ecf\u5b89\u88c5\u4e86 Docker \u548c Docker Compose\u3002\u5982\u679c\u8fd8\u672a\u5b89\u88c5\uff0c\u53ef\u4ee5\u53c2\u8003 Docker \u5b98\u65b9\u7f51\u7ad9 \u8fdb\u884c\u5b89\u88c5\u3002</p>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#2-dockerfile","title":"2. \u521b\u5efa <code>Dockerfile</code>","text":"<p>\u9996\u5148\uff0c\u521b\u5efa\u4e00\u4e2a <code>Dockerfile</code> \u7528\u4e8e\u5b9a\u4e49 Python \u5bb9\u5668\u7684\u6784\u5efa\u6d41\u7a0b\u3002</p> <pre><code># \u4f7f\u7528\u5b98\u65b9 Python \u57fa\u7840\u955c\u50cf\nFROM python:3.9-slim\n\n# \u8bbe\u7f6e\u5de5\u4f5c\u76ee\u5f55\nWORKDIR /app\n\n# \u590d\u5236\u5f53\u524d\u76ee\u5f55\u7684\u5185\u5bb9\u5230\u5bb9\u5668\u7684 /app \u76ee\u5f55\nCOPY . /app\n\n# \u5b89\u88c5\u4f9d\u8d56\nRUN pip install --upgrade pip\nRUN pip install -r requirements.txt\n\n# \u66b4\u9732\u7aef\u53e3\nEXPOSE 5000\n\n# \u8fd0\u884c\u5e94\u7528\nCMD [\"python\", \"app.py\"]\n</code></pre>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#3-requirementstxt","title":"3. \u521b\u5efa <code>requirements.txt</code>","text":"<p><code>requirements.txt</code> \u6587\u4ef6\u8bb0\u5f55\u9879\u76ee\u6240\u9700\u7684 Python \u5e93\u3002\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u751f\u6210\uff1a</p> <pre><code>pip freeze &gt; requirements.txt\n</code></pre> <p>\u8be5\u547d\u4ee4\u5c06\u5f53\u524d Python \u73af\u5883\u4e2d\u7684\u6240\u6709\u4f9d\u8d56\u5e93\u5bfc\u51fa\u5230 <code>requirements.txt</code> \u4e2d\u3002</p>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#4-docker-composeyml","title":"4. \u521b\u5efa <code>docker-compose.yml</code>","text":"<p><code>docker-compose.yml</code> \u662f Docker Compose \u7684\u914d\u7f6e\u6587\u4ef6\u3002\u5b83\u5b9a\u4e49\u4e86\u670d\u52a1\u3001\u7f51\u7edc\u548c\u5377\u7b49\u5185\u5bb9\u3002\u521b\u5efa\u4ee5\u4e0b\u5185\u5bb9\u7684 <code>docker-compose.yml</code> \u6587\u4ef6\uff1a</p> <pre><code>version: \"3\"\n\nservices:\n  app:\n    build: .\n    ports:\n      - \"5000:5000\"\n    volumes:\n      - .:/app\n    environment:\n      - PYTHONUNBUFFERED=1\n    depends_on:\n      - db\n\n  db:\n    image: postgres:13\n    environment:\n      POSTGRES_USER: exampleuser\n      POSTGRES_PASSWORD: examplepass\n      POSTGRES_DB: exampledb\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n\nvolumes:\n  postgres_data:\n</code></pre> <ul> <li><code>app</code> \u670d\u52a1\u4f7f\u7528 Dockerfile \u6765\u6784\u5efa\uff0c\u5e76\u5c06\u9879\u76ee\u76ee\u5f55\u6620\u5c04\u5230\u5bb9\u5668\u5185\u7684 <code>/app</code> \u76ee\u5f55\uff0c\u786e\u4fdd\u5728\u672c\u5730\u66f4\u6539\u4ee3\u7801\u540e\uff0c\u5bb9\u5668\u5185\u7684\u4ee3\u7801\u4e5f\u4f1a\u81ea\u52a8\u66f4\u65b0\u3002</li> <li><code>db</code> \u670d\u52a1\u4f7f\u7528 Postgres \u6570\u636e\u5e93\u4f5c\u4e3a\u793a\u4f8b\uff0c\u5e76\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u6765\u8bbe\u7f6e\u6570\u636e\u5e93\u7528\u6237\u540d\u3001\u5bc6\u7801\u548c\u6570\u636e\u5e93\u540d\u3002</li> </ul>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#5-docker-compose","title":"5. \u4f7f\u7528 Docker Compose \u6784\u5efa\u548c\u542f\u52a8\u5bb9\u5668","text":"<p>\u5728\u9879\u76ee\u76ee\u5f55\u4e0b\uff0c\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u6784\u5efa\u5e76\u542f\u52a8\u670d\u52a1\uff1a</p> <pre><code>docker-compose up --build\n</code></pre> <ul> <li><code>--build</code> \u9009\u9879\u7528\u4e8e\u5728\u542f\u52a8\u5bb9\u5668\u4e4b\u524d\u91cd\u65b0\u6784\u5efa\u955c\u50cf\u3002</li> <li>\u8fd9\u5c06\u542f\u52a8 <code>app</code> \u548c <code>db</code> \u4e24\u4e2a\u5bb9\u5668\uff0cPython \u5e94\u7528\u4f1a\u901a\u8fc7 5000 \u7aef\u53e3\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u3002</li> </ul>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#6","title":"6. \u540e\u7eed\u64cd\u4f5c\u548c\u4f9d\u8d56\u7ba1\u7406","text":"<p>\u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u9700\u8981\u6dfb\u52a0\u65b0\u7684\u4f9d\u8d56\u5e93\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5\u65b0\u5e93\uff1a</p> <pre><code>pip install new-package\n</code></pre> <p>\u7136\u540e\u66f4\u65b0 <code>requirements.txt</code>\uff1a</p> <pre><code>pip freeze &gt; requirements.txt\n</code></pre> <p>\u63a5\u7740\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u91cd\u65b0\u6784\u5efa\u5e76\u542f\u52a8\u5bb9\u5668\uff1a</p> <pre><code>docker-compose up --build\n</code></pre>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#7-docker-compose","title":"7. \u5e38\u7528 Docker Compose \u547d\u4ee4","text":"<ul> <li>\u542f\u52a8\u670d\u52a1\uff08\u5728\u540e\u53f0\u8fd0\u884c\uff09\uff1a</li> </ul> <pre><code>docker-compose up -d\n</code></pre> <ul> <li>\u505c\u6b62\u670d\u52a1\uff1a</li> </ul> <pre><code>docker-compose down\n</code></pre> <ul> <li>\u67e5\u770b\u670d\u52a1\u65e5\u5fd7\uff1a</li> </ul> <pre><code>docker-compose logs\n</code></pre> <ul> <li>\u53ea\u91cd\u65b0\u6784\u5efa\u5e94\u7528\u670d\u52a1\uff1a</li> </ul> <pre><code>docker-compose up --build app\n</code></pre> <ul> <li>\u8fdb\u5165\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668\uff1a</li> </ul> <pre><code>docker-compose exec app bash\n</code></pre>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#docker-compose","title":"\u5982\u679c\u53ea\u4f7f\u7528 Docker Compose","text":"<p>\u800c\u4e0d\u4f7f\u7528 Dockerfile\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 <code>docker-compose.yml</code> \u6587\u4ef6\u76f4\u63a5\u914d\u7f6e\u670d\u52a1\uff0c\u5e76\u5728\u5bb9\u5668\u542f\u52a8\u65f6\u5b89\u88c5 <code>requirements.txt</code> \u4e2d\u7684\u4f9d\u8d56\u3002\u867d\u7136\u4e0d\u4f7f\u7528 Dockerfile \u6709\u4e9b\u9650\u5236\uff0c\u4f46\u8fd9\u79cd\u65b9\u5f0f\u4ecd\u7136\u53ef\u884c\u3002</p> <p>\u4ee5\u4e0b\u662f\u5982\u4f55\u5728\u4e0d\u4f7f\u7528 Dockerfile \u7684\u60c5\u51b5\u4e0b\uff0c\u4ec5\u901a\u8fc7 <code>docker-compose.yml</code> \u6587\u4ef6\u5b9e\u73b0\u4f9d\u8d56\u5b89\u88c5\u7684\u6b65\u9aa4\uff1a</p>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#1-docker-composeyml","title":"1. \u521b\u5efa <code>docker-compose.yml</code> \u6587\u4ef6","text":"<p>\u4f60\u53ef\u4ee5\u5728 <code>docker-compose.yml</code> \u6587\u4ef6\u4e2d\u5b9a\u4e49\u670d\u52a1\uff0c\u5e76\u5728\u542f\u52a8\u65f6\u81ea\u52a8\u5b89\u88c5 <code>requirements.txt</code> \u4e2d\u7684\u4f9d\u8d56\u3002\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u914d\u7f6e\u793a\u4f8b\uff1a</p> <pre><code>version: \"3\"\n\nservices:\n  app:\n    image: python:3.9-slim # \u76f4\u63a5\u4f7f\u7528\u5b98\u65b9 Python \u955c\u50cf\n    volumes:\n      - .:/app # \u5c06\u5f53\u524d\u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u4e2d\u7684 /app \u76ee\u5f55\n    working_dir: /app # \u8bbe\u7f6e\u5de5\u4f5c\u76ee\u5f55\u4e3a /app\n    command: bash -c \"pip install --upgrade pip &amp;&amp; pip install -r requirements.txt &amp;&amp; python app.py\"\n    ports:\n      - \"5000:5000\"\n    environment:\n      - PYTHONUNBUFFERED=1\n</code></pre>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#2","title":"2. \u89e3\u91ca\u914d\u7f6e\u5185\u5bb9","text":"<ul> <li><code>image: python:3.9-slim</code>\uff1a\u4f7f\u7528\u5b98\u65b9\u7684 Python \u955c\u50cf\uff0c\u800c\u4e0d\u518d\u9700\u8981\u5355\u72ec\u7684 Dockerfile\u3002</li> <li><code>volumes: - .:/app</code>\uff1a\u5c06\u672c\u5730\u9879\u76ee\u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u7684 <code>/app</code> \u76ee\u5f55\u4e2d\uff0c\u786e\u4fdd\u4ee3\u7801\u548c\u4f9d\u8d56\u53ef\u4ee5\u5728\u5bb9\u5668\u4e2d\u8bbf\u95ee\u3002</li> <li><code>working_dir: /app</code>\uff1a\u8bbe\u7f6e\u5bb9\u5668\u7684\u5de5\u4f5c\u76ee\u5f55\u4e3a <code>/app</code>\uff0c\u5373\u6302\u8f7d\u7684\u672c\u5730\u9879\u76ee\u76ee\u5f55\u3002</li> <li><code>command: bash -c \"pip install --upgrade pip &amp;&amp; pip install -r requirements.txt &amp;&amp; python app.py\"</code>\uff1a\u5bb9\u5668\u542f\u52a8\u65f6\u6267\u884c\u7684\u547d\u4ee4\uff0c\u9996\u5148\u5347\u7ea7 <code>pip</code>\uff0c\u7136\u540e\u5b89\u88c5 <code>requirements.txt</code> \u4e2d\u7684\u4f9d\u8d56\uff0c\u6700\u540e\u8fd0\u884c <code>app.py</code>\u3002</li> <li><code>ports: - \"5000:5000\"</code>\uff1a\u5c06\u5bb9\u5668\u7684 5000 \u7aef\u53e3\u6620\u5c04\u5230\u4e3b\u673a\u7684 5000 \u7aef\u53e3\uff0c\u786e\u4fdd\u5e94\u7528\u53ef\u4ee5\u4ece\u5916\u90e8\u8bbf\u95ee\u3002</li> </ul>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#3-requirementstxt_1","title":"3. \u521b\u5efa <code>requirements.txt</code>","text":"<p>\u5982\u4e4b\u524d\u63d0\u5230\u7684\uff0c\u751f\u6210 <code>requirements.txt</code> \u6587\u4ef6\uff1a</p> <pre><code>pip freeze &gt; requirements.txt\n</code></pre> <p>\u8fd9\u5c06\u751f\u6210\u4e00\u4e2a\u5305\u542b\u5f53\u524d Python \u73af\u5883\u4f9d\u8d56\u7684 <code>requirements.txt</code> \u6587\u4ef6\uff0c\u786e\u4fdd\u5728\u542f\u52a8\u5bb9\u5668\u65f6\uff0c\u4f9d\u8d56\u80fd\u591f\u88ab\u6b63\u786e\u5b89\u88c5\u3002</p>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#4","title":"4. \u542f\u52a8\u5bb9\u5668","text":"<p>\u5f53 <code>docker-compose.yml</code> \u548c <code>requirements.txt</code> \u6587\u4ef6\u51c6\u5907\u597d\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u542f\u52a8\u5bb9\u5668\uff1a</p> <pre><code>docker-compose up\n</code></pre> <p>\u6b64\u547d\u4ee4\u4f1a\uff1a</p> <ul> <li>\u62c9\u53d6\u5b98\u65b9\u7684 <code>python:3.9-slim</code> \u955c\u50cf\u3002</li> <li>\u6302\u8f7d\u5f53\u524d\u76ee\u5f55\u5230\u5bb9\u5668\u4e2d\u3002</li> <li>\u5b89\u88c5 <code>requirements.txt</code> \u4e2d\u7684\u6240\u6709\u4f9d\u8d56\u3002</li> <li>\u8fd0\u884c <code>app.py</code>\u3002</li> </ul>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#5","title":"5. \u9a8c\u8bc1","text":"<p>\u542f\u52a8\u5b8c\u6210\u540e\uff0c\u5e94\u7528\u5e94\u8be5\u53ef\u4ee5\u901a\u8fc7\u672c\u5730\u7684 <code>5000</code> \u7aef\u53e3\u8bbf\u95ee\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u8fdb\u5165\u5bb9\u5668\uff0c\u68c0\u67e5\u5df2\u5b89\u88c5\u7684\u4f9d\u8d56\uff1a</p> <pre><code>docker-compose exec app bash\n</code></pre> <p>\u8fdb\u5165\u5bb9\u5668\u540e\uff0c\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u5df2\u5b89\u88c5\u7684\u5e93\uff1a</p> <pre><code>pip list\n</code></pre> <p>\u8fd9\u5c06\u5217\u51fa\u6240\u6709\u5df2\u7ecf\u5b89\u88c5\u7684 Python \u5e93\u3002</p>"},{"location":"notes/%E6%9E%84%E5%BB%BAPython%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html#docker-compose_1","title":"\u5e38\u7528 Docker Compose \u547d\u4ee4","text":"<ul> <li>\u542f\u52a8\u670d\u52a1\uff1a</li> </ul> <pre><code>docker-compose up\n</code></pre> <ul> <li>\u5728\u540e\u53f0\u8fd0\u884c\u670d\u52a1\uff1a</li> </ul> <pre><code>docker-compose up -d\n</code></pre> <ul> <li>\u505c\u6b62\u5e76\u5220\u9664\u5bb9\u5668\uff1a</li> </ul> <pre><code>docker-compose down\n</code></pre> <ul> <li>\u67e5\u770b\u5bb9\u5668\u65e5\u5fd7\uff1a</li> </ul> <pre><code>docker-compose logs\n</code></pre> <p>\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u4f60\u4e0d\u9700\u8981\u7f16\u5199 Dockerfile \u5c31\u53ef\u4ee5\u4f7f\u7528 Docker Compose \u5b89\u88c5\u4f9d\u8d56\u5e76\u8fd0\u884c\u5e94\u7528\u3002\u6240\u6709\u4f9d\u8d56\u7684\u5b89\u88c5\u90fd\u662f\u901a\u8fc7 <code>docker-compose.yml</code> \u4e2d\u7684 <code>command</code> \u90e8\u5206\u5b9e\u73b0\u7684\u3002\u8fd9\u6837\u7684\u65b9\u6cd5\u9002\u7528\u4e8e\u7b80\u5355\u7684\u9879\u76ee\u914d\u7f6e\uff0c\u4f46\u5bf9\u4e8e\u590d\u6742\u7684\u9879\u76ee\uff0c\u63a8\u8350\u4f7f\u7528 Dockerfile \u6765\u589e\u52a0\u7075\u6d3b\u6027\u548c\u53ef\u7ef4\u62a4\u6027\u3002</p>"},{"location":"notes/%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2%E7%9A%84%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E9%97%AE%E9%A2%98.html","title":"\u9759\u6001\u535a\u5ba2\u7684\u6d4f\u89c8\u5668\u7f13\u5b58\u95ee\u9898","text":"<p>\u9759\u6001\u535a\u5ba2\u7684\u6d4f\u89c8\u5668\u7f13\u5b58\u95ee\u9898\u786e\u5b9e\u5f88\u5e38\u89c1\u4e5f\u5f88\u70e6\u4eba\uff01\u8fd9\u4e3b\u8981\u662f\u56e0\u4e3a\u6d4f\u89c8\u5668\u4e3a\u4e86\u63d0\u9ad8\u52a0\u8f7d\u901f\u5ea6\uff0c\u4f1a\u5c3d\u53ef\u80fd\u5730\u7f13\u5b58\u9759\u6001\u8d44\u6e90\uff08HTML, CSS, JS, \u56fe\u7247\u7b49\uff09\u3002\u5f53\u4f60\u7684\u5185\u5bb9\u66f4\u65b0\u540e\uff0c\u6d4f\u89c8\u5668\u53ef\u80fd\u4ecd\u7136\u5728\u4f7f\u7528\u65e7\u7684\u7f13\u5b58\u7248\u672c\u3002</p> <p>\u8fd9\u91cc\u6709\u51e0\u79cd\u89e3\u51b3\u7b56\u7565\uff0c\u53ef\u4ee5\u4ece\u7528\u6237\u7aef\uff08\u4e34\u65f6\u89e3\u51b3\uff09\u548c\u5f00\u53d1\u8005\u7aef\uff08\u957f\u4e45\u89e3\u51b3\uff09\u4e24\u65b9\u9762\u5165\u624b\uff1a</p> <p>\u4e00\u3001 \u7528\u6237\u7aef\uff08\u4e34\u65f6\u67e5\u770b\u66f4\u65b0\uff09</p> <p>\u8fd9\u4e9b\u65b9\u6cd5\u4e3b\u8981\u662f\u8ba9\u4f60\u81ea\u5df1\u80fd\u5feb\u901f\u770b\u5230\u66f4\u65b0\uff0c\u4f46\u4e0d\u80fd\u4fdd\u8bc1\u8bbf\u95ee\u8005\u4e5f\u80fd\u7acb\u5373\u770b\u5230\u3002</p> <ol> <li> <p>\u5f3a\u5236\u5237\u65b0 (Hard Refresh): \u8fd9\u662f\u6700\u5e38\u7528\u7684\u65b9\u6cd5\u3002</p> <ul> <li>Windows/Linux: \u6309 <code>Ctrl + Shift + R</code> \u6216 <code>Ctrl + F5</code>\u3002</li> <li>Mac: \u6309 <code>Cmd + Shift + R</code>\u3002</li> <li>\u8fd9\u4f1a\u5f3a\u5236\u6d4f\u89c8\u5668\u5ffd\u7565\u5f53\u524d\u9875\u9762\u7684\u7f13\u5b58\uff0c\u91cd\u65b0\u4ece\u670d\u52a1\u5668\u4e0b\u8f7d\u6240\u6709\u8d44\u6e90\u3002</li> </ul> </li> <li> <p>\u6e05\u9664\u6d4f\u89c8\u5668\u7f13\u5b58:</p> <ul> <li>\u8fdb\u5165\u6d4f\u89c8\u5668\u8bbe\u7f6e\uff0c\u627e\u5230\u6e05\u9664\u6d4f\u89c8\u6570\u636e\u7684\u9009\u9879\uff0c\u9009\u62e9\u6e05\u9664\u201c\u7f13\u5b58\u7684\u56fe\u7247\u548c\u6587\u4ef6\u201d\uff08Cached images and files\uff09\u3002\u5177\u4f53\u4f4d\u7f6e\u56e0\u6d4f\u89c8\u5668\u800c\u5f02\uff08Chrome, Firefox, Edge, Safari\uff09\u3002</li> <li>\u8fd9\u79cd\u65b9\u6cd5\u6bd4\u8f83\u5f7b\u5e95\uff0c\u4f46\u4f1a\u6e05\u9664\u6240\u6709\u7f51\u7ad9\u7684\u7f13\u5b58\uff0c\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u7f51\u7ad9\u52a0\u8f7d\u53d8\u6162\u3002</li> </ul> </li> <li> <p>\u4f7f\u7528\u65e0\u75d5/\u9690\u79c1\u6a21\u5f0f (Incognito/Private Window):</p> <ul> <li>\u65e0\u75d5\u6a21\u5f0f\u901a\u5e38\u4e0d\u4f1a\u4f7f\u7528\u73b0\u6709\u7684\u7f13\u5b58\u548c Cookie\uff08\u6216\u8005\u8bf4\u5b83\u6709\u81ea\u5df1\u72ec\u7acb\u7684\u4e34\u65f6\u7f13\u5b58\uff09\uff0c\u6253\u5f00\u4e00\u4e2a\u65b0\u7684\u65e0\u75d5\u7a97\u53e3\u8bbf\u95ee\u4f60\u7684\u535a\u5ba2\uff0c\u901a\u5e38\u80fd\u770b\u5230\u6700\u65b0\u7248\u672c\u3002</li> </ul> </li> <li> <p>\u6d4f\u89c8\u5668\u5f00\u53d1\u8005\u5de5\u5177:</p> <ul> <li>\u6309 <code>F12</code> \u6253\u5f00\u5f00\u53d1\u8005\u5de5\u5177\u3002</li> <li>\u5207\u6362\u5230 \"Network\" (\u7f51\u7edc) \u6807\u7b7e\u9875\u3002</li> <li>\u901a\u5e38\u4f1a\u6709\u4e00\u4e2a\u9009\u9879\u53eb\u505a \"Disable cache\" (\u7981\u7528\u7f13\u5b58)\u3002\u52fe\u9009\u5b83\u3002</li> <li>\u6ce8\u610f\uff1a \u8fd9\u4e2a\u9009\u9879\u901a\u5e38\u53ea\u5728\u5f00\u53d1\u8005\u5de5\u5177\u6253\u5f00\u7684\u72b6\u6001\u4e0b\u624d\u751f\u6548\u3002\u5237\u65b0\u9875\u9762\u5373\u53ef\u770b\u5230\u6700\u65b0\u5185\u5bb9\u3002\u8fd9\u662f\u5f00\u53d1\u8c03\u8bd5\u65f6\u975e\u5e38\u6709\u7528\u7684\u65b9\u6cd5\u3002</li> </ul> </li> </ol> <p>\u4e8c\u3001 \u5f00\u53d1\u8005\u7aef\uff08\u4e3a\u6240\u6709\u8bbf\u95ee\u8005\u4f18\u5316\uff09</p> <p>\u8fd9\u4e9b\u65b9\u6cd5\u9700\u8981\u4f60\u5728\u6784\u5efa\u548c\u90e8\u7f72\u535a\u5ba2\u65f6\u8fdb\u884c\u914d\u7f6e\uff0c\u76ee\u7684\u662f\u8ba9\u6240\u6709\u8bbf\u95ee\u8005\u7684\u6d4f\u89c8\u5668\u80fd\u66f4\u667a\u80fd\u5730\u5904\u7406\u7f13\u5b58\u3002</p> <ol> <li> <p>Cache Busting (\u7f13\u5b58\u7834\u574f): \u8fd9\u662f\u6700\u6709\u6548\u3001\u6700\u63a8\u8350\u7684\u957f\u671f\u7b56\u7565\u3002</p> <ul> <li>\u539f\u7406: \u901a\u8fc7\u66f4\u6539\u9759\u6001\u8d44\u6e90\uff08CSS, JS \u6587\u4ef6\uff09\u7684\u6587\u4ef6\u540d\u6765\u5f3a\u5236\u6d4f\u89c8\u5668\u4e0b\u8f7d\u65b0\u7248\u672c\u3002\u56e0\u4e3a\u6587\u4ef6\u540d\u53d8\u4e86\uff0c\u6d4f\u89c8\u5668\u4f1a\u8ba4\u4e3a\u8fd9\u662f\u4e00\u4e2a\u5168\u65b0\u7684\u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u53bb\u67e5\u627e\u65e7\u6587\u4ef6\u540d\u7684\u7f13\u5b58\u3002</li> <li>\u5b9e\u73b0\u65b9\u5f0f:<ul> <li>\u5185\u5bb9\u54c8\u5e0c (Content Hashing): \u5728\u6587\u4ef6\u540d\u4e2d\u52a0\u5165\u6587\u4ef6\u5185\u5bb9\u7684\u54c8\u5e0c\u503c\uff08\u4e00\u4e32\u57fa\u4e8e\u6587\u4ef6\u5185\u5bb9\u751f\u6210\u7684\u552f\u4e00\u5b57\u7b26\uff09\uff0c\u4f8b\u5982 <code>style.css</code> -&gt; <code>style.a1b2c3d4.css</code>\u3002\u6bcf\u6b21\u6587\u4ef6\u5185\u5bb9\u6539\u53d8\uff0c\u54c8\u5e0c\u503c\u5c31\u4f1a\u6539\u53d8\uff0c\u6587\u4ef6\u540d\u4e5f\u968f\u4e4b\u6539\u53d8\u3002\u8fd9\u662f\u6700\u4f73\u5b9e\u8df5\u3002</li> <li>\u7248\u672c\u53f7: \u5728\u6587\u4ef6\u540d\u4e2d\u52a0\u5165\u7248\u672c\u53f7\uff0c\u4f8b\u5982 <code>style.v2.css</code>\u3002\u6216\u8005\u5728 URL \u540e\u9644\u52a0\u67e5\u8be2\u53c2\u6570\uff0c\u4f8b\u5982 <code>style.css?v=2</code>\u3002\u4f46\u67e5\u8be2\u53c2\u6570\u7684\u65b9\u5f0f\u53ef\u80fd\u4e0d\u88ab\u6240\u6709 CDN \u6216\u4ee3\u7406\u670d\u52a1\u5668\u5f88\u597d\u5730\u652f\u6301\uff0c\u5b83\u4eec\u6709\u65f6\u4f1a\u5ffd\u7565\u67e5\u8be2\u53c2\u6570\u8fdb\u884c\u7f13\u5b58\uff0c\u6240\u4ee5\u6587\u4ef6\u540d\u54c8\u5e0c\u901a\u5e38\u66f4\u53ef\u9760\u3002</li> </ul> </li> <li>\u5de5\u5177: \u5927\u591a\u6570\u73b0\u4ee3\u9759\u6001\u7f51\u7ad9\u751f\u6210\u5668 (like Hugo, Jekyll with plugins, Gatsby, Next.js) \u6216\u6784\u5efa\u5de5\u5177 (like Webpack, Vite, Parcel) \u90fd\u6709\u5185\u7f6e\u6216\u63d2\u4ef6\u652f\u6301\u81ea\u52a8\u5b9e\u73b0\u6587\u4ef6\u540d\u54c8\u5e0c\uff0c\u5e76\u66f4\u65b0 HTML \u6587\u4ef6\u4e2d\u7684\u5f15\u7528\u3002\u4f60\u9700\u8981\u68c0\u67e5\u4f60\u4f7f\u7528\u7684\u5de5\u5177\u7684\u6587\u6863\uff0c\u542f\u7528\u6216\u914d\u7f6e\u8fd9\u4e2a\u529f\u80fd\u3002</li> </ul> </li> <li> <p>\u914d\u7f6e HTTP \u7f13\u5b58\u5934 (HTTP Cache Headers):</p> <ul> <li>\u539f\u7406: \u5728\u4f60\u7684\u670d\u52a1\u5668\u6216\u6258\u7ba1\u5e73\u53f0\uff08\u5982 Netlify, Vercel, GitHub Pages, Cloudflare, Nginx, Apache\uff09\u4e0a\u914d\u7f6e\uff0c\u544a\u8bc9\u6d4f\u89c8\u5668\u5982\u4f55\u7f13\u5b58\u4f60\u7684\u6587\u4ef6\u3002</li> <li>\u5173\u952e\u5934\u90e8:<ul> <li><code>Cache-Control</code>: \u8fd9\u662f\u6700\u91cd\u8981\u7684\u7f13\u5b58\u6307\u4ee4\u3002<ul> <li>\u5bf9\u4e8e HTML \u6587\u4ef6 (\u901a\u5e38\u662f\u4f60\u535a\u5ba2\u7684\u5165\u53e3\u6587\u4ef6\uff0c\u6bd4\u5982 <code>index.html</code>)\uff1a\u4f60\u53ef\u80fd\u5e0c\u671b\u5b83\u4e0d\u88ab\u5f3a\u7f13\u5b58\uff0c\u6216\u8005\u7f13\u5b58\u65f6\u95f4\u5f88\u77ed\uff0c\u4ee5\u4fbf\u7528\u6237\u80fd\u5c3d\u5feb\u83b7\u53d6\u5230\u6700\u65b0\u7684\u9875\u9762\u7ed3\u6784\u548c\u8d44\u6e90\u5f15\u7528\u3002\u53ef\u4ee5\u8bbe\u7f6e\u4e3a <code>Cache-Control: no-cache</code> (\u8868\u793a\u6bcf\u6b21\u4f7f\u7528\u7f13\u5b58\u524d\u5fc5\u987b\u4e0e\u670d\u52a1\u5668\u9a8c\u8bc1\u6587\u4ef6\u662f\u5426\u6709\u66f4\u65b0) \u6216 <code>Cache-Control: max-age=0, must-revalidate</code>\u3002<code>no-store</code> \u5219\u5b8c\u5168\u7981\u6b62\u7f13\u5b58\uff0c\u4f46\u53ef\u80fd\u5f71\u54cd\u6027\u80fd\u3002</li> <li>\u5bf9\u4e8e\u5e26\u54c8\u5e0c\u503c\u7684\u6587\u4ef6\u540d (CSS, JS)\uff1a\u7531\u4e8e\u6587\u4ef6\u540d\u6bcf\u6b21\u66f4\u6539\u90fd\u4f1a\u53d8\uff0c\u4f60\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e2a\u975e\u5e38\u957f\u7684\u7f13\u5b58\u65f6\u95f4\uff0c\u4f8b\u5982 <code>Cache-Control: public, max-age=31536000, immutable</code> (\u7f13\u5b58\u4e00\u5e74\uff0c\u5e76\u4e14\u544a\u8bc9\u6d4f\u89c8\u5668\u8fd9\u4e2a\u6587\u4ef6\u5185\u5bb9\u6c38\u8fdc\u4e0d\u4f1a\u53d8)\u3002</li> </ul> </li> <li><code>ETag</code> \u548c <code>Last-Modified</code>: \u8fd9\u4e9b\u662f\u9a8c\u8bc1\u5934\u90e8\u3002\u5f53\u8bbe\u7f6e\u4e86 <code>Cache-Control: no-cache</code> \u6216\u7f13\u5b58\u8fc7\u671f\u540e\uff0c\u6d4f\u89c8\u5668\u4f1a\u5e26\u4e0a\u8fd9\u4e9b\u4fe1\u606f\u8be2\u95ee\u670d\u52a1\u5668\u6587\u4ef6\u662f\u5426\u6709\u66f4\u65b0\u3002\u5982\u679c\u6ca1\u66f4\u65b0\uff0c\u670d\u52a1\u5668\u8fd4\u56de <code>304 Not Modified</code>\uff0c\u6d4f\u89c8\u5668\u5c31\u4f7f\u7528\u672c\u5730\u7f13\u5b58\uff0c\u8282\u7701\u4e86\u4e0b\u8f7d\u6d41\u91cf\u3002</li> </ul> </li> <li>\u5b9e\u73b0: \u5982\u4f55\u914d\u7f6e\u8fd9\u4e9b\u5934\u90e8\u53d6\u51b3\u4e8e\u4f60\u7684\u6258\u7ba1\u73af\u5883\u3002<ul> <li>GitHub Pages: \u5bf9\u7f13\u5b58\u63a7\u5236\u6709\u9650\uff0c\u4f46\u5b83\u901a\u5e38\u4f1a\u4e3a\u8d44\u6e90\u8bbe\u7f6e\u5408\u7406\u7684 ETag\uff0c\u5e76\u5bf9 HTML \u8bbe\u7f6e\u8f83\u77ed\u7684\u7f13\u5b58\u65f6\u95f4\u3002\u7ed3\u5408 Cache Busting \u6548\u679c\u6700\u597d\u3002</li> <li>Netlify/Vercel: \u901a\u5e38\u5728\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u7684\u914d\u7f6e\u6587\u4ef6\uff08\u5982 <code>netlify.toml</code> \u6216 <code>vercel.json</code>\uff09\u4e2d\u53ef\u4ee5\u81ea\u5b9a\u4e49\u5934\u90e8\u89c4\u5219\u3002\u5b83\u4eec\u9ed8\u8ba4\u7684\u7f13\u5b58\u7b56\u7565\u901a\u5e38\u5df2\u7ecf\u6bd4\u8f83\u667a\u80fd\u3002</li> <li>Cloudflare: \u53ef\u4ee5\u5728 Cloudflare \u7684\u4eea\u8868\u76d8\u4e2d\u8bbe\u7f6e\u7f13\u5b58\u89c4\u5219\u548c\u6d4f\u89c8\u5668\u7f13\u5b58 TTL (Time To Live)\u3002</li> <li>\u81ea\u6258\u7ba1 (Nginx/Apache): \u9700\u8981\u5728\u670d\u52a1\u5668\u914d\u7f6e\u6587\u4ef6\u4e2d\u6dfb\u52a0\u76f8\u5e94\u7684 <code>add_header</code> (Nginx) \u6216 <code>Header set</code> (Apache) \u6307\u4ee4\u3002</li> </ul> </li> </ul> </li> </ol> <p>\u603b\u7ed3\u5efa\u8bae\uff1a</p> <ol> <li>\u5f00\u53d1/\u6d4b\u8bd5\u65f6: \u4f7f\u7528\u5f00\u53d1\u8005\u5de5\u5177\u7684\u201c\u7981\u7528\u7f13\u5b58\u201d\u6216\u5f3a\u5236\u5237\u65b0 (<code>Ctrl+Shift+R</code>)\u3002</li> <li>\u957f\u671f\u89e3\u51b3:<ul> <li>\u9996\u9009: \u5728\u4f60\u7684\u6784\u5efa\u8fc7\u7a0b\u4e2d\u5b9e\u65bd\u6587\u4ef6\u540d\u54c8\u5e0c (Cache Busting)\u3002\u8fd9\u662f\u89e3\u51b3 CSS/JS/\u56fe\u7247\u7b49\u9759\u6001\u8d44\u6e90\u7f13\u5b58\u95ee\u9898\u7684\u6839\u672c\u65b9\u6cd5\u3002</li> <li>\u914d\u5408: \u5728\u4f60\u7684\u6258\u7ba1\u5e73\u53f0\u4e0a\u914d\u7f6e\u5408\u7406\u7684 <code>Cache-Control</code> HTTP \u5934\u90e8\u3002\u5bf9 HTML \u6587\u4ef6\u8bbe\u7f6e\u77ed\u7f13\u5b58\u6216 <code>no-cache</code>\uff0c\u5bf9\u5e26\u54c8\u5e0c\u7684\u6587\u4ef6\u8bbe\u7f6e\u957f\u7f13\u5b58\u3002</li> </ul> </li> </ol> <p>\u901a\u8fc7\u7ed3\u5408\u4f7f\u7528 Cache Busting \u548c \u6b63\u786e\u7684 HTTP \u7f13\u5b58\u5934\uff0c\u4f60\u53ef\u4ee5\u6700\u5927\u7a0b\u5ea6\u5730\u786e\u4fdd\u7528\u6237\u603b\u80fd\u83b7\u53d6\u5230\u6700\u65b0\u7684\u5185\u5bb9\uff0c\u540c\u65f6\u4e5f\u80fd\u6709\u6548\u5229\u7528\u6d4f\u89c8\u5668\u7f13\u5b58\u6765\u63d0\u9ad8\u7f51\u7ad9\u6027\u80fd\u3002</p>"},{"location":"tool/index.html","title":"\u5de5\u5177\u603b\u89c8\uff08Tool\uff09","text":"<p>\u73b0\u5728\u5de5\u5177\u5217\u8868\u5df2\u7ecf\u79fb\u5230\u4e86\u5de6\u4fa7\u5bfc\u822a\u680f\u3002 \u53ef\u4ee5\u4ece\u5de6\u4fa7\u4f9d\u6b21\u9009\u62e9\u5177\u4f53\u5de5\u5177\u540d\u79f0\uff08Gobang\u3001Python Interpreter\u3001Unit Conversion \u7b49\uff09\uff0c\u9875\u9762\u4f1a\u81ea\u52a8\u8df3\u8f6c\u5230\u5bf9\u5e94\u7684\u5de5\u5177\u9875\u9762\u3002</p> <p></p> <p></p> <p>\u4e0b\u9762\u662f\u6240\u6709\u5de5\u5177\u7684\u5217\u8868\uff08\u70b9\u51fb\u540d\u79f0\u4f1a\u5148\u6253\u5f00\u4e00\u4e2a\u8fc7\u6e21\u9875\u9762\uff0c\u518d\u8df3\u8f6c\u5230\u771f\u6b63\u7684\u5de5\u5177 HTML \u9875\u9762\uff09\uff1a</p> <ul> <li>Gobang\uff08\u4e94\u5b50\u68cb\uff09</li> <li>Python Interpreter</li> <li>Unit Conversion</li> <li>RMB Converter</li> <li>RGB Color Picker</li> <li>Insurance Calculator</li> <li>VAT Calculator</li> <li>Sterilization Guide</li> <li>Cron Designer</li> <li>Password Generator</li> </ul>"},{"location":"tool/cron-designer.html","title":"Cron Designer\uff08\u8ba1\u5212\u4efb\u52a1\u8868\u8fbe\u5f0f\u8bbe\u8ba1\uff09","text":"<p>\u6b63\u5728\u8df3\u8f6c\u5230\u5de5\u5177\u9875\u9762\u2026\u2026</p> <p>\u5982\u679c\u6ca1\u6709\u81ea\u52a8\u8df3\u8f6c\uff0c\u8bf7\u70b9\u51fb\u8fd9\u91cc\u6253\u5f00\u5de5\u5177\u9875\u9762\uff1a</p> <p>\u6253\u5f00 Cron Designer \u5de5\u5177\u9875\u9762</p> <p></p>"},{"location":"tool/gobang.html","title":"Gobang\uff08\u4e94\u5b50\u68cb\uff09","text":"<p>\u6b63\u5728\u8df3\u8f6c\u5230\u5de5\u5177\u9875\u9762\u2026\u2026</p> <p>\u5982\u679c\u6ca1\u6709\u81ea\u52a8\u8df3\u8f6c\uff0c\u8bf7\u70b9\u51fb\u8fd9\u91cc\u6253\u5f00\u5de5\u5177\u9875\u9762\uff1a</p> <p>\u6253\u5f00 Gobang \u5de5\u5177\u9875\u9762</p> <p></p>"},{"location":"tool/insurance-calculator.html","title":"Insurance Calculator\uff08\u4e94\u9669\u4e00\u91d1\u8ba1\u7b97\u5668\uff09","text":"<p>\u6b63\u5728\u8df3\u8f6c\u5230\u5de5\u5177\u9875\u9762\u2026\u2026</p> <p>\u5982\u679c\u6ca1\u6709\u81ea\u52a8\u8df3\u8f6c\uff0c\u8bf7\u70b9\u51fb\u8fd9\u91cc\u6253\u5f00\u5de5\u5177\u9875\u9762\uff1a</p> <p>\u6253\u5f00 Insurance Calculator \u5de5\u5177\u9875\u9762</p> <p></p>"},{"location":"tool/password-generator.html","title":"Password Generator\uff08\u5bc6\u7801\u751f\u6210\u5668\uff09","text":"<p>\u6b63\u5728\u8df3\u8f6c\u5230\u5de5\u5177\u9875\u9762\u2026\u2026</p> <p>\u5982\u679c\u6ca1\u6709\u81ea\u52a8\u8df3\u8f6c\uff0c\u8bf7\u70b9\u51fb\u8fd9\u91cc\u6253\u5f00\u5de5\u5177\u9875\u9762\uff1a</p> <p>\u6253\u5f00 Password Generator \u5de5\u5177\u9875\u9762</p> <p></p>"},{"location":"tool/python-interpreter.html","title":"Python Interpreter","text":"<p>\u6b63\u5728\u8df3\u8f6c\u5230\u5de5\u5177\u9875\u9762\u2026\u2026</p> <p>\u5982\u679c\u6ca1\u6709\u81ea\u52a8\u8df3\u8f6c\uff0c\u8bf7\u70b9\u51fb\u8fd9\u91cc\u6253\u5f00\u5de5\u5177\u9875\u9762\uff1a</p> <p>\u6253\u5f00 Python Interpreter \u5de5\u5177\u9875\u9762</p> <p></p>"},{"location":"tool/rgb-color-picker.html","title":"RGB Color Picker\uff08\u989c\u8272\u9009\u62e9\u5668\uff09","text":"<p>\u6b63\u5728\u8df3\u8f6c\u5230\u5de5\u5177\u9875\u9762\u2026\u2026</p> <p>\u5982\u679c\u6ca1\u6709\u81ea\u52a8\u8df3\u8f6c\uff0c\u8bf7\u70b9\u51fb\u8fd9\u91cc\u6253\u5f00\u5de5\u5177\u9875\u9762\uff1a</p> <p>\u6253\u5f00 RGB Color Picker \u5de5\u5177\u9875\u9762</p> <p></p>"},{"location":"tool/rmb-converter.html","title":"RMB Converter\uff08\u4eba\u6c11\u5e01\u5927\u5c0f\u5199\u8f6c\u6362\uff09","text":"<p>\u6b63\u5728\u8df3\u8f6c\u5230\u5de5\u5177\u9875\u9762\u2026\u2026</p> <p>\u5982\u679c\u6ca1\u6709\u81ea\u52a8\u8df3\u8f6c\uff0c\u8bf7\u70b9\u51fb\u8fd9\u91cc\u6253\u5f00\u5de5\u5177\u9875\u9762\uff1a</p> <p>\u6253\u5f00 RMB Converter \u5de5\u5177\u9875\u9762</p> <p></p>"},{"location":"tool/sterilization-guide.html","title":"Sterilization Guide\uff08\u706d\u83cc\u6307\u5357\uff09","text":"<p>\u6b63\u5728\u8df3\u8f6c\u5230\u5de5\u5177\u9875\u9762\u2026\u2026</p> <p>\u5982\u679c\u6ca1\u6709\u81ea\u52a8\u8df3\u8f6c\uff0c\u8bf7\u70b9\u51fb\u8fd9\u91cc\u6253\u5f00\u5de5\u5177\u9875\u9762\uff1a</p> <p>\u6253\u5f00 Sterilization Guide \u5de5\u5177\u9875\u9762</p> <p></p>"},{"location":"tool/unit-conversion.html","title":"Unit Conversion\uff08\u5355\u4f4d\u6362\u7b97\uff09","text":"<p>\u6b63\u5728\u8df3\u8f6c\u5230\u5de5\u5177\u9875\u9762\u2026\u2026</p> <p>\u5982\u679c\u6ca1\u6709\u81ea\u52a8\u8df3\u8f6c\uff0c\u8bf7\u70b9\u51fb\u8fd9\u91cc\u6253\u5f00\u5de5\u5177\u9875\u9762\uff1a</p> <p>\u6253\u5f00 Unit Conversion \u5de5\u5177\u9875\u9762</p> <p></p>"},{"location":"tool/vat-calculator.html","title":"VAT Calculator\uff08\u589e\u503c\u7a0e\u8ba1\u7b97\u5668\uff09","text":"<p>\u6b63\u5728\u8df3\u8f6c\u5230\u5de5\u5177\u9875\u9762\u2026\u2026</p> <p>\u5982\u679c\u6ca1\u6709\u81ea\u52a8\u8df3\u8f6c\uff0c\u8bf7\u70b9\u51fb\u8fd9\u91cc\u6253\u5f00\u5de5\u5177\u9875\u9762\uff1a</p> <p>\u6253\u5f00 VAT Calculator \u5de5\u5177\u9875\u9762</p> <p></p>"}]}